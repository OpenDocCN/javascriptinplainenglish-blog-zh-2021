<html>
<head>
<title>How to Handle Errors in Express.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何处理Express.js中的错误</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-handle-errors-in-express-js-9fe2522ccc53?source=collection_archive---------9-----------------------#2021-03-05">https://javascript.plainenglish.io/how-to-handle-errors-in-express-js-9fe2522ccc53?source=collection_archive---------9-----------------------#2021-03-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/0dde4aae5cdc1a333981f72abd52f0b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*z4_z5iOBEKMFlqAY"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@picsbyjameslee?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">James Lee</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="bef9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">经验不足的开发人员一次又一次地忽略了错误处理，但这对应用程序的稳定性、监控和性能有着重大影响。我将继续讲述如何在您的<code class="fe ky kz la lb b">express</code>应用程序中有效地处理错误。</p><p id="4e84" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">没有明确的方法来处理错误，但有些方法比其他方法更好。让我们深入研究一下。</p><h1 id="26c6" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">处理控制器中的错误(糟糕的方法):</h1><p id="e2b2" class="pw-post-body-paragraph ka kb in kc b kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt me kv kw kx ig bi translated">在这种方法中，我们处理控制器中的错误。对于每个失败的条件/异常，控制器本身将在响应中引发并返回错误。<br/>例如:</p><figure class="mf mg mh mi gt jo"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">app.js ( Controller Level Error handling )</figcaption></figure><p id="8f64" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这里，我们有一个路由<code class="fe ky kz la lb b">/post</code>，它在数据库中添加了一个新的帖子。在每个条件和返回响应时，错误都被显式处理。<br/>这种设计有多种警告，会增加系统的复杂性，例如:如果你想跟踪系统抛出的所有错误，你必须到处调用这段代码(跟踪器)，甚至在单个控制器中多次调用。😑这是你从未想过要做的事！</p><p id="3a88" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">注意:</strong>这种类型的应用程序架构会阻碍应用程序的扩展，并且很难跟踪所有的错误。</p><h1 id="c95b" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated"><strong class="ak">处理应用程序中的错误(更好的方法):</strong></h1><p id="54a9" class="pw-post-body-paragraph ka kb in kc b kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt me kv kw kx ig bi translated">在这种方法中，我们为整个应用程序使用一个通用的错误处理程序。是啊！所有的错误都在同一个地方处理。为了使这个过程更加顺利，我们将使用<code class="fe ky kz la lb b"><a class="ae jz" href="https://www.npmjs.com/package/@hapi/boom" rel="noopener ugc nofollow" target="_blank">@hapi/boom</a></code> npm库来生成错误和相应的代码。</p><figure class="mf mg mh mi gt jo"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">app.js ( Application Level Error Handler )</figcaption></figure><p id="9d92" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这可能看起来有点复杂，但它比前面的方法好得多。<br/>在Express中，我们在每个控制器中获取<code class="fe ky kz la lb b">next</code>作为第三个参数，我们简单地使用它将任何生成的错误传递给我们的错误处理程序。</p><p id="0dbc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这样，所有的错误都将通过这个处理程序，您可以轻松地跟踪生成的错误，并采取措施来应对系统故障。<br/>此外，这种设计将帮助您扩展您的应用程序，您不需要为每个条件返回错误，而只需使用<code class="fe ky kz la lb b">next</code>将产生的任何错误传递给错误处理程序，其余的就可以在那里处理了。</p><p id="1774" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您还可以在系统中集成类似<code class="fe ky kz la lb b">Sentry</code>的错误监控工具，以跟踪可能导致系统停机的关键错误。</p><h1 id="2dfb" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结论</h1><p id="8c31" class="pw-post-body-paragraph ka kb in kc b kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt me kv kw kx ig bi translated">设计系统的基本原则应该是使事情尽可能简单，这也支持更大范围的扩展。</p><p id="7a67" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">检查我为Express，Mongoose创建的样板文件。你会喜欢它的。</p><div class="ml mm gp gr mn mo"><a href="https://github.com/dhruv479/node" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd io gy z fp mt fr fs mu fu fw im bi translated">DH ruv 479/节点</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">节点快递猫鼬样板。在GitHub上创建一个帐户，为dhruv479/node开发做出贡献。</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">github.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc jt mo"/></div></div></a></div><p id="7ad0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我希望你喜欢这篇文章，并发现它很有价值。可以关注我上 <a class="ae jz" href="https://dhruv479.medium.com" rel="noopener"> <em class="nd">中</em> </a> <em class="nd">和</em> <a class="ae jz" href="https://twitter.com/dhruv479" rel="noopener ugc nofollow" target="_blank"> <em class="nd">推特</em> </a> <em class="nd">。感谢支持！</em></p></div></div>    
</body>
</html>