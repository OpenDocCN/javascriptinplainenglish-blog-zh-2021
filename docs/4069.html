<html>
<head>
<title>Should You Load Scripts with Async or Defer?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">应该用Async还是Defer加载脚本？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/loading-scripts-with-async-and-defer-dfc9dc46077b?source=collection_archive---------17-----------------------#2021-08-13">https://javascript.plainenglish.io/loading-scripts-with-async-and-defer-dfc9dc46077b?source=collection_archive---------17-----------------------#2021-08-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="bd29" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在浏览器中加载JavaScript脚本的速成课程</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/158e63729262dce14bb295f600116c86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y701av0xboGb4ZgG5y6Rsw.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">photo by <a class="ae ks" href="https://unsplash.com/@lucasmiguel" rel="noopener ugc nofollow" target="_blank">Lucas Migue</a>l via <a class="ae ks" href="https://unsplash.com/photos/SdMuKn6KKaA" rel="noopener ugc nofollow" target="_blank">unsplash.com</a></figcaption></figure><p id="814a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">任何有web开发经验的人都知道交互式网站的基础是JavaScript。我们通过在HTML文件中放置脚本标签来访问外部JavaScript文件，然后浏览器在解析HTML时加载并执行这些标签。</p><p id="3018" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">有些人可能不知道的是，有几种方法可以控制我们的浏览器何时加载和执行这些脚本。在没有指定我们希望它如何加载的情况下，现代浏览器将开始把HTML解析为DOM，直到它到达一个脚本标签。然后，在继续解析HTML之前，它将加载并执行该脚本。</p><p id="ed3e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为什么这很重要？因为这可能会对用户体验和他们在页面加载时看到的内容以及我们网站的加载时间产生重大影响。加载时间可以说是大多数开发人员跟踪的最重要的指标之一，因为如果站点加载太慢，我们不希望用户离开。</p><p id="8586" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">那么，我们能做些什么来帮助缩短加载时间呢？幸运的是，脚本标签有两个重要的属性，我们可以用来帮助控制当浏览器到达脚本标签时发生的事情，async和defer。在这篇文章中，我希望向你展示这三种加载类型之间的区别，以及什么时候你应该考虑使用每一种。</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><p id="db14" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">不使用async或defer的标准加载方法暂停HTML解析以加载脚本文件，然后在继续解析剩余的HTML之前执行脚本。相当直接。我认为这就像一个交通灯。浏览器必须停下来等待，直到灯变绿或者脚本完全下载并执行，然后浏览器才能向前移动。</p><p id="fb2f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当我们开始深入研究可用于脚本标记的async和defer属性时，事情才真正变得有趣起来。</p><p id="e61a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">例如，当浏览器看到一个包含async的脚本标记时，它会并行下载脚本文件，同时继续解析HTML。直到脚本文件完全下载后，它才会暂停解析HTML并执行脚本文件。你可以把异步看作一个停止标志。浏览器只需暂停足够长的时间，让脚本在前进之前执行。</p><p id="abbc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">另一方面，defer标记也会并行下载脚本文件，但会等到HTML文件完全加载后再执行脚本。把这想象成一个最佳的环岛，在那里浏览器根本不需要停下来。它看到一个十字路口，就径直穿过去，没有停下来。这不是我最好的比喻，但你会明白的。</p><p id="1b4e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我快速绘制了一张图表来帮助形象化这三个不同的过程。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lw"><img src="../Images/7fad0ca743efc178ba4e185841c85d96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ko9l3yD2uWKSXatM15fgDw.png"/></div></div></figure><p id="0181" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">既然您已经知道了这三种方法的工作原理以及它们之间的区别，那么您可能想知道何时应该使用每一种方法？</p><p id="a7f9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">其中一些取决于你在哪里放置你的脚本标签。在async和defer之前，许多开发人员将它们放在body部分的末尾。这允许在浏览器开始下载和解析脚本文件之前解析所有的HTML。</p><p id="d0bf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">只要它们是最后加载的，假设你的脚本顺序正确，使用一个简单的不带任何属性的脚本标签应该没问题。</p><p id="911f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我不喜欢把脚本标签放在正文中，这感觉很不对，因为它们不是页面格式的一部分，而这正是正文部分的目的。相反，我更喜欢把我所有的脚本放在head部分。</p><p id="ed56" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，如果我们在head部分使用不带async或defer的简单脚本标记，那会严重延迟我们的HTML开始被解析的时间。这就引出了一个问题，异步还是延迟？</p><p id="6ace" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">答案是视情况而定。如果你的脚本依赖于特定的DOM元素，你应该使用defer。这将允许在脚本执行之前完全解析HTML。考虑向某些DOM元素添加事件处理程序。如果这些元素还没有被添加，那么在它们出现之前执行脚本是没有意义的。Defer实现了这一点。</p><p id="8dfd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">defer做的另一件事是尊重脚本被调用的顺序。因此，如果一个脚本依赖于另一个脚本，defer也是一种方法。</p><p id="e9dc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果您的脚本不满足这两个标准，那么您应该对脚本使用async属性。请记住，这将减慢整个解析过程，这就是为什么我通常坚持使用defer。</p><p id="4170" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这就是关于用async和defer加载脚本的速成课程。欢迎在下面给我留言，告诉我你是如何选择使用哪种加载方式的！</p><p id="c6d9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="lx">更多内容看</em><a class="ae ks" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="lx">plain English . io</em></strong></a></p></div></div>    
</body>
</html>