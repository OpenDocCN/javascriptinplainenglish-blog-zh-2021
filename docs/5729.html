<html>
<head>
<title>Vue 3 Composition API in a Nutshell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单地说，Vue 3组合API</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/vue-3-composition-api-in-a-nutshell-8144244942c1?source=collection_archive---------10-----------------------#2021-12-03">https://javascript.plainenglish.io/vue-3-composition-api-in-a-nutshell-8144244942c1?source=collection_archive---------10-----------------------#2021-12-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5308" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">与options API相比的区别和优势。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cb2d63804e8b139bdcc2a646d7ae58f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kHnhxkQ3i7xptVgu"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@clark_fransa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Arnold Francisca</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a928" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Vue3中引入了组合API，可以选择替换选项API来创建组件。</p><h2 id="eabb" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">前身options API有什么问题？</h2><p id="b0ac" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在composition API之前，创建组件的唯一选择是options API。然而，在更大的应用中，<a class="ae kv" href="https://youtu.be/bwItFdPt-6M?t=165" rel="noopener ugc nofollow" target="_blank">选项API有两个主要缺点</a>:</p><ul class=""><li id="f082" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">逻辑上属于一起的代码被分割成多个选项(数据、方法、计算)。</li><li id="c06f" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">跨组件重用逻辑可能很棘手或者很麻烦。混合不是好的解决方案/替代方案，因为不清楚混合来自哪里。</li></ul><p id="942b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，引入了<a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#introduction" rel="noopener ugc nofollow" target="_blank">组合API </a>。</p><p id="848c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ne">创建Vue组件允许我们将接口的可重复部分及其功能提取到可重复使用的代码中。仅这一点就可以让我们的应用程序在可维护性和灵活性方面走得更远。然而，我们的集体经验已经证明，仅仅这样可能还不够，尤其是当您的应用程序变得非常大时——想想几百个组件。当处理这样的大型应用程序时，共享和重用代码变得尤为重要。</em> <a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#why-composition-api" rel="noopener ugc nofollow" target="_blank"> <em class="ne">(为什么组成API？)</em> </a></p><h2 id="8fca" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">组合API由什么组成？</h2><p id="7d54" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">组合API由一个</p><ul class=""><li id="0ccf" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated"><code class="fe nf ng nh ni b"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#setup-component-option" rel="noopener ugc nofollow" target="_blank">setup</a></code> <a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#setup-component-option" rel="noopener ugc nofollow" target="_blank">组件选项，</a></li><li id="a90c" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#reactive-variables-with-ref" rel="noopener ugc nofollow" target="_blank">无功变量有</a> <code class="fe nf ng nh ni b"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#reactive-variables-with-ref" rel="noopener ugc nofollow" target="_blank">ref</a></code> <a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#reactive-variables-with-ref" rel="noopener ugc nofollow" target="_blank">、</a></li><li id="2dc6" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#lifecycle-hook-registration-inside-setup" rel="noopener ugc nofollow" target="_blank">生命周期挂钩注册在</a> <code class="fe nf ng nh ni b"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#lifecycle-hook-registration-inside-setup" rel="noopener ugc nofollow" target="_blank">setup</a></code> <a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#lifecycle-hook-registration-inside-setup" rel="noopener ugc nofollow" target="_blank">、</a>内</li><li id="c3da" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#reacting-to-changes-with-watch" rel="noopener ugc nofollow" target="_blank">用</a> <code class="fe nf ng nh ni b"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#reacting-to-changes-with-watch" rel="noopener ugc nofollow" target="_blank">watch</a></code> <a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#reacting-to-changes-with-watch" rel="noopener ugc nofollow" target="_blank">、</a>对变化做出反应</li><li id="f832" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#standalone-computed-properties" rel="noopener ugc nofollow" target="_blank">单机</a> <code class="fe nf ng nh ni b"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#standalone-computed-properties" rel="noopener ugc nofollow" target="_blank">computed</a></code> <a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-introduction.html#standalone-computed-properties" rel="noopener ugc nofollow" target="_blank">属性。</a></li></ul><p id="000f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nf ng nh ni b"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-setup.html#setup" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">setup</strong></a></code> <a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-setup.html#setup" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">函数</strong> </a>有两个参数，<code class="fe nf ng nh ni b">props</code>和<code class="fe nf ng nh ni b">context</code>。</p><p id="7978" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nf ng nh ni b"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-setup.html#props" rel="noopener ugc nofollow" target="_blank">props</a></code>是电抗的，如果需要，可以使用<code class="fe nf ng nh ni b">toRef</code>或<code class="fe nf ng nh ni b">toRefs</code>转换为<code class="fe nf ng nh ni b">refs</code>。</p><p id="5c73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nf ng nh ni b"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-setup.html#context" rel="noopener ugc nofollow" target="_blank">context</a></code>是一个非反应性的JS对象，它公开了<code class="fe nf ng nh ni b">attrs</code>、<code class="fe nf ng nh ni b">props</code>、<code class="fe nf ng nh ni b">slots</code>、<code class="fe nf ng nh ni b">emit</code>。您将无法访问组件选项<code class="fe nf ng nh ni b">data</code>、<code class="fe nf ng nh ni b">computed</code>、<code class="fe nf ng nh ni b">methods</code>、(模板)<code class="fe nf ng nh ni b">refs</code>。</p><p id="5d90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的例子展示了<a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-setup.html#usage-with-templates" rel="noopener ugc nofollow" target="_blank">如何在组件的(HTML)模板</a>中使用 <code class="fe nf ng nh ni b"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-setup.html#usage-with-templates" rel="noopener ugc nofollow" target="_blank">setup</a></code> <a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-setup.html#usage-with-templates" rel="noopener ugc nofollow" target="_blank">。或者，</a><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-setup.html#usage-with-render-functions" rel="noopener ugc nofollow" target="_blank">可以使用</a> <code class="fe nf ng nh ni b"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-setup.html#usage-with-render-functions" rel="noopener ugc nofollow" target="_blank">setup</a></code> <a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-setup.html#usage-with-render-functions" rel="noopener ugc nofollow" target="_blank">和渲染功能</a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/8ab374a072ac0a016786034db67640f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*_eb1i8FJ2QThH9J_hUC1eg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-setup.html#usage-with-templates" rel="noopener ugc nofollow" target="_blank">Usage of setup with template.</a></figcaption></figure><p id="b989" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://v3.vuejs.org/guide/composition-api-lifecycle-hooks.html" rel="noopener ugc nofollow" target="_blank">生命周期挂钩</a>必须在<code class="fe nf ng nh ni b">setup</code>函数中调用。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/0be2fce25e8d304e42364f2b32a2aa17.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*ThLcGSPcDQi3v2HAMLJ6wg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Lifecycle hook called in the setup function.</figcaption></figure><p id="8338" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于可用函数，请考虑下表:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/411e32175788eebbf38647e905fdcb42.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*VNJWXVOrZsJdfmSUjwKKqQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Conversion table for Options API (left) to Composition API (right) hooks.</figcaption></figure><p id="927d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于将数据从父组件传递到深层嵌套组件，我们不想使用<code class="fe nf ng nh ni b">props</code>。幸运的是，用于该用例的<a class="ae kv" href="https://v3.vuejs.org/guide/component-provide-inject.html#provide-inject" rel="noopener ugc nofollow" target="_blank">提供/注入概念</a>也适用于组合API。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/0ab5c0bcae00c353c3d2dd472d059c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*Sf42DAGjkq-948_qTDFmaw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://v3.vuejs.org/guide/component-provide-inject.html#provide-inject" rel="noopener ugc nofollow" target="_blank">Visualization of the provide/inject concept.</a></figcaption></figure><p id="335c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该示例传递来自<code class="fe nf ng nh ni b">MyMap.vue</code>父组件的数据:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/4ac99efb933b6e2bd81b4b05149f9622.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*jkNVj7U9VNVU9cT-8JJ5Wg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Provide in the parent component.</figcaption></figure><p id="7b5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">进入子组件<code class="fe nf ng nh ni b">MyMarker.vue</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/47c82dd5d6c75370011dc0b77992264c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*ILNTZxqXD47fVLDINMKsWg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Inject in the child component.</figcaption></figure><p id="c1de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了给提供/注入模式增加反应性，可以使用<code class="fe nf ng nh ni b"><a class="ae kv" href="https://v3.vuejs.org/guide/reactivity-fundamentals.html#creating-standalone-reactive-values-as-refs" rel="noopener ugc nofollow" target="_blank">refs</a></code>或<code class="fe nf ng nh ni b"><a class="ae kv" href="https://v3.vuejs.org/guide/reactivity-fundamentals.html#declaring-reactive-state" rel="noopener ugc nofollow" target="_blank">reactive</a></code>。修改后的示例显示了两个选项，<code class="fe nf ng nh ni b">location</code> → <code class="fe nf ng nh ni b">ref</code>和<code class="fe nf ng nh ni b">geolocation</code> → <code class="fe nf ng nh ni b">reactive</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/6121af8bb863a296a2ca7eca49c9af72.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*9FXEkporInr1TgacOrbv9w.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Provide into the reactive parent component.</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/4330fc62287432a0b852c3201da6c4e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*l8YzdNMAHpfylVTq6PHq1Q.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Inject in the reactive child component.</figcaption></figure><h2 id="1c79" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated"><strong class="ak">如何将options API组件重构为composition API组件？</strong></h2><p id="ca2a" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">下面的视频展示了如何将options API组件重构为composition API组件的一些方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://youtu.be/bwItFdPt-6M?t=233" rel="noopener ugc nofollow" target="_blank">Vue 3 Composition API Introduction [FULL TUTORIAL] (3:53).</a></figcaption></figure><p id="b972" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ne">更多内容看</em> <a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ne">说白了。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ne">免费周报</em> </strong> </a> <em class="ne">。关注我们关于</em><a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ne">Twitter</em></strong></a><em class="ne">和</em><a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ne">LinkedIn</em></strong></a><em class="ne">。查看我们的</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ne">社区不和谐</em> </strong> </a> <em class="ne">加入我们的</em> <a class="ae kv" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ne">人才集体</em> </strong> </a> <em class="ne">。</em></strong></a></p></div></div>    
</body>
</html>