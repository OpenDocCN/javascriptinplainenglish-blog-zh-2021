<html>
<head>
<title>Why You Might Want To Switch Your React App to Preact</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么您可能想将React应用程序切换到Preact</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/preact-vs-react-56f9571d32de?source=collection_archive---------5-----------------------#2021-08-25">https://javascript.plainenglish.io/preact-vs-react-56f9571d32de?source=collection_archive---------5-----------------------#2021-08-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="61ea" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">以下是原因和方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/18d0fc79825d652dc20606974ecbe86f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dvRAmbILRRbAa6HIUZkvfA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: the author</figcaption></figure><p id="b6f0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">他们说，最终，最好的技术会占上风。</p><p id="f8ef" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，在构建React.js应用程序时，我们经常犯一个错误:<br/>我们没有使用Preact。我在这里不是要说“React已死”或<br/>“我们应该抛弃React”之类的废话</p><p id="c423" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我在这里让你知道一个很酷的替代反应。</p><p id="594a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">大多数React开发人员已经听说过它。然而，在我看来，它没有得到充分利用。Preact提供了与react几乎相同的API和语法，但导致了更小的包大小和性能。</p><p id="ce30" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">与此同时，Preact还支持react支持的几乎所有东西——因此，是时候考虑将你的应用程序切换到Preact了。</p><p id="248f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是原因和方法。</p><h1 id="528a" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">将我的应用程序切换到Preact的结果</h1><p id="fb6a" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">首先，给你一点动力。</p><p id="b219" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我主要是React.js开发者。因此，我也用它来建立我的个人项目。像许多其他react开发人员一样，我忘记了Preact确实存在的事实——并且用React实现了一些个人项目。当意识到，我可以节省大量的包大小，我变得焦虑。</p><p id="3321" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我确信完全转换到Preact不会那么容易。尽管如此，我还是尝试了一下——并感到惊讶。</p><p id="57ef" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我将Astro中基于React的页面切换到Preact。这是现成的，因为Astro完美地支持这两个库。</p><p id="a014" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">包大小的变化:从333千字节到54千字节。<br/>差别真大！我也很震惊。</p><p id="003e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下一个应用是我在Gatsby做的一个老项目。该页面基于React.js，大小为403千字节。将它切换到Preact导致了205千字节的包大小——再次节省了大量空间。</p><p id="c07c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">希望你现在更有动力给Preact一个机会——以下是你需要了解的关于转换的信息。如果您想了解Preact与react在性能方面的更多信息，请查看以下内容:</p><div class="mo mp gp gr mq mr"><a rel="noopener  ugc nofollow" target="_blank" href="/i-built-the-same-app-with-react-and-preact-here-are-the-differences-b0da382a6f72"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd ir gy z fp mw fr fs mx fu fw ip bi translated">我用React和Preact构建了相同的应用程序。以下是不同之处</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">以及测量的大小、性能和实现</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="na l"><div class="nb l nc nd ne na nf kp mr"/></div></div></a></div><h1 id="a5d5" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">将我的应用程序移动到Preact可以吗？</h1><p id="43b7" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">Preact并不打算取代React.js。然而，这是一个相当完整的React.js <em class="ng">替代方案</em>。虽然，由于它的规模，它有只提供少数功能的名声，但这是不正确的。Preact文档让我们更详细地了解Preact缺少哪些功能:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/9dd1b18bdcf6dfa858df5248b1c2e477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gcXoSSxUmwMIO3yThDMR8A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: <a class="ae ni" href="https://preactjs.com/guide/v8/differences-to-react/" rel="noopener ugc nofollow" target="_blank">preactjs.org</a></figcaption></figure><p id="9e8c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如你所看到的，根据Preact本身的说法，差别并不太大。甚至我们从React中知道的所有钩子都可以通过特定于Preact的导入来使用，例如<code class="fe nj nk nl nm b">import { useState } from "preact/hooks"</code>。</p><p id="580a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那么，所列出的缺失功能呢？嗯，正如Preact声明的那样，例如，PropTypes在<code class="fe nj nk nl nm b">preact-compat</code>中是完全支持的。这个工具帮助我们将应用程序迁移到Preact，基本上不需要改变我们的代码库(我们稍后会看到)。</p><h1 id="75b0" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">那么，我如何将我的React应用程序切换到Preact？</h1><p id="0dc4" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">切换到Preact并不困难，取决于您已经存在的设置。尤其是在Gatsby和Next.js这两个当今构建React应用最常用的工具中，切换并不复杂。两者都将preact-compat用于交换机。这意味着您现有的特定于React的代码库将被转换为Preact。您可以使用React导入和功能，preact-compat支持您。</p><p id="00cf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">关于如何在Gatsby和Next.js中切换，我做了两个额外的指南:</p><div class="mo mp gp gr mq mr"><a rel="noopener  ugc nofollow" target="_blank" href="/gatsby-preact-bfe5543bf27b"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd ir gy z fp mw fr fs mx fu fw ip bi translated">如何通过启用Preact支持来缩减Gatsby包的大小</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">无需重写您的代码库</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="na l"><div class="nn l nc nd ne na nf kp mr"/></div></div></a></div><div class="mo mp gp gr mq mr"><a rel="noopener  ugc nofollow" target="_blank" href="/next-js-preact-f993c95a3f93"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd ir gy z fp mw fr fs mx fu fw ip bi translated">想让你的Next.js App更快？启用预先支持(方法如下)</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">如何在你的Next.js应用上启用Preact支持，并几乎免费节省几千字节。</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="na l"><div class="no l nc nd ne na nf kp mr"/></div></div></a></div><p id="e865" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将我们的CRA React应用程序切换到Preact也并不困难，这要感谢一个很酷的第三方工具:<code class="fe nj nk nl nm b">cra-preact</code>，它是Preact兼容层<code class="fe nj nk nl nm b">preact/compat</code>的包装器。我们可以用<code class="fe nj nk nl nm b">yarn add cra-preact</code>安装。</p><p id="a2ae" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，我们需要做的一切就是像这样替换<code class="fe nj nk nl nm b">package.json</code>中的脚本部分:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="3541" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，只需运行<code class="fe nj nk nl nm b">yarn run build</code>——preact compat应该会自动处理您的react-imports并将它们重定向到Preact，在引擎盖下。为了测试这一点，我使用<code class="fe nj nk nl nm b">useState</code>和<code class="fe nj nk nl nm b">PropTypes</code>构建了一个小的React应用程序。</p><p id="bc0d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">React应用的生产版本是140千字节，在用<code class="fe nj nk nl nm b">cra-preact</code>切换到Preact后，只剩下30.2千字节——然而，一切都正常。</p><p id="54af" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于React.js中的大多数生产应用程序，create-react-app不是首选工具。自从我们介绍了Next和Gatsby之后，仍然缺少使用Webpack或package之类的工具进行切换。谢天谢地，Preact的文档为这些开关提供了很好的指导。</p><h1 id="849a" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">从头开始使用Preact</h1><p id="f15a" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">到目前为止，我展示了如何从React切换到Preact。这个过程的好处是，你可以在React中编写一切，preact-compat应该处理一切。当你想从一开始就用Preact编写你的应用程序时，还需要知道几个不同之处:</p><p id="ce70" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">差异:</p><ul class=""><li id="7e17" class="nr ns iq kx b ky kz lb lc le nt li nu lm nv lq nw nx ny nz bi translated">可以用<code class="fe nj nk nl nm b">class</code>代替<code class="fe nj nk nl nm b">className</code>作为属性来提供CSS类。</li><li id="75ad" class="nr ns iq kx b ky oa lb ob le oc li od lm oe lq nw nx ny nz bi translated">传递道具的工作方式不同:</li><li id="3319" class="nr ns iq kx b ky oa lb ob le oc li od lm oe lq nw nx ny nz bi translated">Preact使用浏览器的本地全局事件处理程序来处理事件。因此，Preact使用<code class="fe nj nk nl nm b">onInput</code>而不是<code class="fe nj nk nl nm b">onChange</code>作为输入字段。(浏览器的原生<code class="fe nj nk nl nm b">onchange</code>并不像React那样每次按键都会触发。只有当您在更改了输入的情况下离开文本字段时，它才会被触发。)</li><li id="2266" class="nr ns iq kx b ky oa lb ob le oc li od lm oe lq nw nx ny nz bi translated">本地全局事件处理程序的不同也会影响<code class="fe nj nk nl nm b">onDoubleClick</code>。Preact使用的本地实现是<code class="fe nj nk nl nm b">onDblClick</code>。</li></ul><h1 id="d754" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">最终想法</h1><p id="ab81" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">Preact越来越演变成一个很好的React.js替代品。尽管它声称不是替代品，但在许多情况下，我会称之为替代品。是的，对我来说，Preact似乎是更好的选择。</p><p id="c972" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于它方便的迁移工具，我们可以像往常一样构建React.js应用程序，然后尝试将它们迁移到Preact以节省包的大小。或者，你也可以用Preact从头开始构建你的应用程序，取代CRA或者只是在你的捆绑包中打开Preact支持。</p><p id="3890" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢您的阅读！</p><h2 id="d8dd" class="of ls iq bd lt og oh dn lx oi oj dp mb le ok ol md li om on mf lm oo op mh oq bi translated"><a class="ae ni" href="https://twitter.com/louispetrik" rel="noopener ugc nofollow" target="_blank">在Twitter上关注我，了解最新消息</a></h2></div><div class="ab cl or os hu ot" role="separator"><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow"/></div><div class="ij ik il im in"><p id="5f73" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ng">更多内容请看</em><a class="ae ni" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="ng">plain English . io</em></strong></a></p></div></div>    
</body>
</html>