<html>
<head>
<title>Export Data Using the JavaScript &amp;&amp; Tabulator</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用JavaScript &amp;&amp;制表器导出数据</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/export-data-using-the-javascript-tabulator-5814fa5c6e0f?source=collection_archive---------5-----------------------#2021-08-17">https://javascript.plainenglish.io/export-data-using-the-javascript-tabulator-5814fa5c6e0f?source=collection_archive---------5-----------------------#2021-08-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e0ab" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何以1比10的比例减小生成的文件大小</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ad4e326cd193d22c28d46d47952c8188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sh_u0WRjiLJlypEr4gcDNQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://undraw.co/search" rel="noopener ugc nofollow" target="_blank">https://undraw.co/</a></figcaption></figure><p id="ee50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="http://tabulator.info/" rel="noopener ugc nofollow" target="_blank">制表器</a>是一个很棒的JavaScript库，它允许我们从JavaScript Array、AJAX数据源、HTML或JSON格式的数据中在几秒钟内创建<strong class="ky ir">交互式</strong>表格。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/e9aedbe3eb4ad9ed32701da21beb8ea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*GEBTiLOP313tJMTpNHvZPA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Html table created with Tabulator and JavaScript</figcaption></figure><h1 id="4c52" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">问题是</h1><p id="4db0" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">制表软件直接允许我们下载不同格式的数据，如CSV、XLSX或PDF，但是当我们将数据导出到XLSX文件时，我们会得到一个不愉快的惊喜。</p><p id="4382" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们不打算导出大量数据，这是没有问题的，但是当我们想要导出一个大的数据集时，我们会看到结果文件非常大。</p><p id="7151" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，如果我们从一个XLSX格式的原始文件开始，有30000行40列，大小大约为6 MB，提取这些数据并使用制表器使用，然后使用制表器再次将其导出为XLSX格式，我们将会看到生成的文件将增长到60MB左右。</p><p id="8d31" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们打开这个文件，我们可以看到它与原始内容相同，但是大小非常不同。</p><p id="603e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，如果我们再次用<a class="ae kv" href="https://en.wikipedia.org/wiki/Microsoft_Excel" rel="noopener ugc nofollow" target="_blank"> Microsoft Excel </a>保存它，我们将会看到尺寸是如何神奇地再次缩小的。</p><h2 id="c32e" class="mq lu iq bd lv mr ms dn lz mt mu dp md lf mv mw mf lj mx my mh ln mz na mj nb bi translated">那么，发生了什么事？</h2><p id="1d29" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">发生的情况是，当您用Microsoft Excel保存文件时，会应用一种压缩算法来压缩文件，这是制表程序无法做到的。</p><p id="1d1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">制表器内部使用<a class="ae kv" href="https://sheetjs.com/" rel="noopener ugc nofollow" target="_blank"> SheetJs </a>将您的表格数据导出到XLSX，但不允许我们配置SheetJs内部使用的数据压缩算法。</p><h2 id="bf15" class="mq lu iq bd lv mr ms dn lz mt mu dp md lf mv mw mf lj mx my mh ln mz na mj nb bi translated">例子</h2><p id="554c" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">首先，让我们创建一个例子，我们将使用制表器和JavaScript创建一个交互式html表格。</p><p id="0c6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一种方法是直接使用制表器创建表格，并将其数据导出到XLSX文件中。</p><p id="892f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在第二个方案中，我们将使用制表器创建表格，但我们将修改制表器导出到XLSX格式的方式，以直接使用SheetJs，但不会失去制表器默认提供的导出数据的功能。</p><h2 id="77b2" class="mq lu iq bd lv mr ms dn lz mt mu dp md lf mv mw mf lj mx my mh ln mz na mj nb bi translated">第一种方法</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Initial solution.</figcaption></figure><h2 id="721e" class="mq lu iq bd lv mr ms dn lz mt mu dp md lf mv mw mf lj mx my mh ln mz na mj nb bi translated">结果</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/95689085691f66fd172e4ed16ce59a1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tly-RcYQx69pFLG_-oBX9A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Html table in the browser.</figcaption></figure><p id="dd18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们可以通过点击“下载XLSX”按钮将表格数据导出为XLSX格式的文件，结果得到一个20KB大小的data.xlsx文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/ed7158b88bb4dd94e2a601aa9e00de95.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*SjN0IA4yhwHkARiD1YE7wg.png"/></div></figure><p id="cc77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们现在用Microsoft Excel打开并保存该文件，大小将减少到只有9 KB。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/75f0dbd5c43989e932c6390e60b7600f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QaxEqI4fzHJfTHOKZ1fJlw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/41cd013880202a15c07c621a0637282c.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*rkTuTaYCMuEIUzZmXxrIwg.png"/></div></figure><p id="68f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">出现这种情况是因为Microsoft Excel在保存文件时使用了压缩算法，而制表程序没有。</p><h1 id="df9e" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">解决方案</h1><p id="b0b4" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">解决这个问题并使用SheetJS压缩算法通过制表器导出到XLSX的方法之一是使用以下技巧:</p><p id="b784" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们修改我们调用的导出到XLSX的函数，这样它生成JSON代码作为响应，而不是XLSX。我们这样做是为了不丢失任何行和列的格式。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Download xlsx listener</figcaption></figure><p id="fa6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当文件下载准备就绪时，我们截取调用，而不是返回带有下载内容的blob(请记住，我们已经将其修改为json)，我们使用SheetJS从json直接生成XLSX，但告诉它在创建文件时使用压缩算法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Download ready function</figcaption></figure><h2 id="22de" class="mq lu iq bd lv mr ms dn lz mt mu dp md lf mv mw mf lj mx my mh ln mz na mj nb bi translated">最终代码</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Final solution</figcaption></figure><p id="d1f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您现在再次尝试导出，您会看到文件从20KB变成9KB。如果要导出的数据量很大，这种差异会更大。</p><h1 id="404a" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">最后的想法</h1><p id="474e" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在这篇文章中，我们已经看到了如何改进如何制表导出到XLSX格式，避免文件占用过大的大小。如您所见，它非常简单，几乎不需要任何代码。</p><p id="c385" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望你觉得有用！当然，代码还可以改进，但是我打算简单地展示我们开始时的问题的解决方案。</p><p id="0b32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ni">更多内容尽在</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="ni">plain English . io</em></a></p></div></div>    
</body>
</html>