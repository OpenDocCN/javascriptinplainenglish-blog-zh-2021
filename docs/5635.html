<html>
<head>
<title>How to Add Drag and Drop in React with React Beautiful DnD</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何添加拖放在反应与反应美丽的DnD</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-add-drag-and-drop-in-react-with-react-beautiful-dnd-2bed93b2b7f8?source=collection_archive---------1-----------------------#2021-11-25">https://javascript.plainenglish.io/how-to-add-drag-and-drop-in-react-with-react-beautiful-dnd-2bed93b2b7f8?source=collection_archive---------1-----------------------#2021-11-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/f10e91a34e1dc76c5b824159a9c44576.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2A7bT72TpDhmSej0.gif"/></div></div></figure><p id="3545" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">嘿，你好！这是一个使用拖放的简单例子，我们使用的是<a class="ae kt" href="https://www.npmjs.com/package/react-beautiful-dnd" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="ku">react-beautiful-dnd</em></strong></a>。</p><p id="9bf0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，我们用<strong class="jx io"><em class="ku">react-beautiful-dnd</em></strong>构建，所以我们需要在代码中安装它。您需要从它导入{ <strong class="jx io"> DragDropContext，Droppable，Draggable </strong> }，其中每个组件扮演不同的角色，正如您可以从它们的名称中理解的那样。</p><ol class=""><li id="8d17" class="kv kw in jx b jy jz kc kd kg kx kk ky ko kz ks la lb lc ld bi translated"><strong class="jx io"> DragDropContext </strong>是一个包装器，帮助你在重新排列列表后替换并生成新的列表。</li><li id="8031" class="kv kw in jx b jy le kc lf kg lg kk lh ko li ks la lb lc ld bi translated"><strong class="jx io">drop able</strong>为您提供了将项目拖放到列表中的功能，在该列表中，项目的属性在ref的帮助下被继承，我们将它们传递给子项目。</li><li id="3243" class="kv kw in jx b jy le kc lf kg lg kk lh ko li ks la lb lc ld bi translated"><strong class="jx io">可拖动</strong>允许你用光标选择项目并将其拖动到列表中。</li></ol></div><div class="ab cl lj lk hr ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ig ih ii ij ik"><h2 id="2ad1" class="lq lr in bd ls lt lu dn lv lw lx dp ly kg lz ma mb kk mc md me ko mf mg mh mi bi translated">履行</h2><blockquote class="mj mk ml"><p id="bd46" class="jv jw ku jx b jy jz ka kb kc kd ke kf mm kh ki kj mn kl km kn mo kp kq kr ks ig bi translated"><strong class="jx io"> <em class="in">第一步:</em> </strong> <br/> <em class="in">我们需要一个</em> <strong class="jx io"> <em class="in">的对象数组</em> </strong> <em class="in">在这里我们可以执行</em><strong class="jx io"><em class="in">【DnD】</em></strong><em class="in">。</em></p></blockquote><pre class="mp mq mr ms gt mt mu mv bn mw mx bi"><span id="6b02" class="my lr in mu b be mz na l nb nc">const Arr = [<br/>  {<br/>    name: "North",<br/>    key: "12353",<br/>  },<br/>  {<br/>    name: "South",<br/>    key: "23463",<br/>  },<br/>  {<br/>    name: "East",<br/>    key: "54643",<br/>  },<br/>  {<br/>    name: "West",<br/>    key: "4435",<br/>  },<br/>]</span></pre><blockquote class="mj mk ml"><p id="4717" class="jv jw ku jx b jy jz ka kb kc kd ke kf mm kh ki kj mn kl km kn mo kp kq kr ks ig bi translated"><strong class="jx io"> <em class="in">第二步:</em> </strong> <em class="in"> <br/>我们需要初始化</em><strong class="jx io"><em class="in">arr</em></strong><em class="in">为状态以便我们可以使用执行DnD操作。</em></p></blockquote><pre class="mp mq mr ms gt mt mu mv bn mw mx bi"><span id="2f27" class="my lr in mu b be mz na l nb nc">const [project, setProject] = useState(Arr)</span></pre><blockquote class="mj mk ml"><p id="0a8b" class="jv jw ku jx b jy jz ka kb kc kd ke kf mm kh ki kj mn kl km kn mo kp kq kr ks ig bi translated"><strong class="jx io"> <em class="in">第三步:</em> </strong> <br/> <em class="in">我们将需要函数来执行DnD，并在执行</em>  <em class="in">操作后生成</em> <strong class="jx io"> <em class="in">新的结果。</em></strong></p></blockquote><pre class="mp mq mr ms gt mt mu mv bn mw mx bi"><span id="4e6f" class="my lr in mu b be mz na l nb nc">// we'll pass this function into DragDropContext<br/>// inside the component<br/>const onDragEnd = (result) =&gt; {<br/>    if (!result.destination) return;<br/>    if (result.destination.index === result.source.index) return;<br/>const projects = reorder(<br/>      project, // project is state <br/>      result.source.index,<br/>      result.destination.index<br/>    );<br/>    //store reordered state.<br/>    setProject(projects)<br/>  }<br/>// outside the component <br/>const reorder = (list, startIndex, endIndex) =&gt; {<br/>  const result = Array.from(list);<br/>  const [removed] = result.splice(startIndex, 1);<br/>  result.splice(endIndex, 0, removed);<br/>return result;<br/>};</span></pre><blockquote class="mj mk ml"><p id="06aa" class="jv jw ku jx b jy jz ka kb kc kd ke kf mm kh ki kj mn kl km kn mo kp kq kr ks ig bi translated"><strong class="jx io"> <em class="in">第四步:</em> </strong> <em class="in"> <br/>我们将把组件扭曲成</em><strong class="jx io"><em class="in">JSX</em></strong><em class="in">并把状态映射到它上面，就像这样</em></p></blockquote><pre class="mp mq mr ms gt mt mu mv bn mw mx bi"><span id="9751" class="my lr in mu b be mz na l nb nc">&lt;DragDropContext onDragEnd={onDragEnd}&gt;<br/>  &lt;Droppable droppableId="list"&gt;<br/>    {(provided) =&gt; (<br/>      &lt;div<br/>        ref={provided.innerRef}<br/>        {...provided.droppableProps}<br/>      &gt;<br/>        {project &amp;&amp; project.map((item, index) =&gt;<br/>          // draggableId should be string, index is also require, key props should be unique to prevent from unnecassary re-rendering  <br/>          &lt;Draggable draggableId={item.key} key={item.key} index={index}&gt;<br/>            {(provided) =&gt; (<br/>              &lt;div<br/>                ref={provided.innerRef}<br/>                {...provided.draggableProps}<br/>                {...provided.dragHandleProps}<br/>              &gt;<br/>                &lt;p style={{ color: "green" }}&gt;{item.name}&lt;/p&gt;<br/>              &lt;/div&gt;<br/>            )}<br/>          &lt;/Draggable&gt;)}<br/>        {provided.placeholder}<br/>      &lt;/div&gt;<br/>    )}<br/>  &lt;/Droppable&gt;<br/>&lt;/DragDropContext&gt;</span></pre><p id="fc53" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是完整的代码:</p><pre class="mp mq mr ms gt mt mu mv bn mw mx bi"><span id="e60d" class="my lr in mu b be mz na l nb nc">import React, { useState } from 'react'<br/>import { DragDropContext, Droppable, Draggable } from "react-beautiful-dnd";<br/>const reorder = (list, startIndex, endIndex) =&gt; {<br/>  const result = Array.from(list);<br/>  const [removed] = result.splice(startIndex, 1);<br/>  result.splice(endIndex, 0, removed);<br/>return result;<br/>};<br/>const Arr = [<br/>  {<br/>    name: "North",<br/>    key: "12353",<br/>  },<br/>  {<br/>    name: "South",<br/>    key: "23463",<br/>  },<br/>  {<br/>    name: "East",<br/>    key: "54643",<br/>  },<br/>  {<br/>    name: "West",<br/>    key: "4435",<br/>  },<br/>]<br/>const Projects = () =&gt; {<br/>  const [project, setProject] = useState(Arr)<br/>const onDragEnd = (result) =&gt; {<br/>    if (!result.destination) return;<br/>    if (result.destination.index === result.source.index) return;<br/>const projects = reorder(<br/>      project,<br/>      result.source.index,<br/>      result.destination.index<br/>    );<br/>    //store reordered state.<br/>    setProject(projects)<br/>  }<br/>return (<br/>    &lt;DragDropContext onDragEnd={onDragEnd}&gt;<br/>      &lt;Droppable droppableId="list"&gt;<br/>        {(provided) =&gt; (<br/>          &lt;div<br/>            ref={provided.innerRef}<br/>            {...provided.droppableProps}<br/>            style={{ border: "1px solid #242424", opacity: 0.5, borderRadius: "5px" }}<br/>          &gt;<br/>            {project &amp;&amp; project.map((item, index) =&gt;<br/>              &lt;Draggable draggableId={item.key} key={item.key} index={index}&gt;<br/>                {(provided) =&gt; (<br/>                  &lt;div<br/>                    ref={provided.innerRef}<br/>                    {...provided.draggableProps}<br/>                    {...provided.dragHandleProps}<br/>                  &gt;<br/>                    &lt;p style={{ color: "green" }}&gt;{item.name}&lt;/p&gt;<br/>                  &lt;/div&gt;<br/>                )}<br/>              &lt;/Draggable&gt;)}<br/>            {provided.placeholder}<br/>          &lt;/div&gt;<br/>        )}<br/>      &lt;/Droppable&gt;<br/>    &lt;/DragDropContext&gt;<br/>  )<br/>}<br/>export default Projects</span></pre><p id="9080" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在把所有代码捆绑起来，看看之后的结果！</p><p id="25ed" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="ku">快乐编码兄台</em> </strong> ❤</p><p id="efbf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="ku">更多内容请看</em><a class="ae kt" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="ku">plain English . io</em></strong></a><em class="ku">。报名参加我们的</em><strong class="jx io"><em class="ku"/></strong><a class="ae kt" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="ku">免费每周简讯在这里</em> </strong> </a> <em class="ku">。</em></p></div></div>    
</body>
</html>