<html>
<head>
<title>How to Add a File Input Button and Display a Preview Image With React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何添加一个文件输入按钮并用React显示一个预览图像</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-add-a-file-input-button-and-display-a-preview-image-with-react-2568d9d849f5?source=collection_archive---------1-----------------------#2021-08-06">https://javascript.plainenglish.io/how-to-add-a-file-input-button-and-display-a-preview-image-with-react-2568d9d849f5?source=collection_archive---------1-----------------------#2021-08-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f3bb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用材质用户界面库和URL对象</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/566b6ab3db82583f2f07d6a18c9bc6c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MnYS80XbHOkVSXrn"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@viktortalashuk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Viktor Talashuk</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2005" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您经常想要从设备上传图像、视频、pdf或其他文档。我们可以通过设置<code class="fe ls lt lu lv b">type="file"</code>使用HTML <code class="fe ls lt lu lv b">input</code>元素轻松实现这一点。这将导致屏幕上显示以下元素。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/fce24bf7cd796ab93d6936bbbb0d279f.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*Z57GWBlUJMOzobeRd67zKQ.png"/></div></figure><p id="f816" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是可行的，但在我看来不太好。难道你不想要一个更有风格的元素，可能还有上传图片的预览吗？像下面这样的怎么样？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/7b2fdaa6d6e5a8d2201e13cdc8705e99.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*al4WpdhwJKEYN9kGpuj5Jg.png"/></div></figure><p id="9522" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将了解如何使用React创建这个文件输入。在本文结束时，您应该对如何执行以下操作有所了解:</p><ul class=""><li id="4e0f" class="ly lz iq ky b kz la lc ld lf ma lj mb ln mc lr md me mf mg bi translated">用Material-UI创建文件输入按钮</li><li id="8d19" class="ly lz iq ky b kz mh lc mi lf mj lj mk ln ml lr md me mf mg bi translated">使用React存储文件数据</li><li id="88df" class="ly lz iq ky b kz mh lc mi lf mj lj mk ln ml lr md me mf mg bi translated">使用URL对象显示图像的预览</li></ul></div><div class="ab cl mm mn hu mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="ij ik il im in"><h1 id="9524" class="mt mu iq bd mv mw mx my mz na nb nc nd jw ne jx nf jz ng ka nh kc ni kd nj nk bi translated">建立</h1><p id="75c6" class="pw-post-body-paragraph kw kx iq ky b kz nl jr lb lc nm ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">对于这个例子，我们将在一个<code class="fe ls lt lu lv b">create-react-app</code>项目中工作。我已经安装了<a class="ae kv" href="https://www.npmjs.com/package/@material-ui/core" rel="noopener ugc nofollow" target="_blank"> Material-UI </a>核心包。如果您是使用Material-UI的新手，请查看下面的文章开始使用。</p><div class="nq nr gp gr ns nt"><a href="https://medium.com/swlh/create-a-customized-color-theme-in-material-ui-7205163e541f" rel="noopener follow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">在材质界面中创建自定义的颜色主题</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">为下一个React项目定制颜色主题很容易</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">medium.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh kp nt"/></div></div></a></div><p id="d8f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我创建了一个组件，它将一个基本的输入元素呈现到屏幕上。我加了<code class="fe ls lt lu lv b">type="file"</code>和<code class="fe ls lt lu lv b">accept="image/*"</code>。这些属性将允许用户从他们的设备中选择任何图像文件。</p><pre class="kg kh ki kj gt oi lv oj ok aw ol bi"><span id="8a57" class="om mu iq lv b gy on oo l op oq">const FileInput = () =&gt; {<br/>  return &lt;input <em class="or">accept</em>="image/*" <em class="or">type</em>="file" <em class="or">id</em>="select-image" /&gt;;<br/>};</span><span id="e803" class="om mu iq lv b gy os oo l op oq">export default FileInput;</span></pre><h1 id="3f07" class="mt mu iq bd mv mw ot my mz na ou nc nd jw ov jx nf jz ow ka nh kc ox kd nj nk bi translated">用Material-UI创建文件输入按钮</h1><p id="c55f" class="pw-post-body-paragraph kw kx iq ky b kz nl jr lb lc nm ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">第一步是创建按钮。我们需要从Material-UI导入按钮组件。</p><pre class="kg kh ki kj gt oi lv oj ok aw ol bi"><span id="4540" class="om mu iq lv b gy on oo l op oq">import Button from '@material-ui/core/Button';</span></pre><p id="ec0f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们将在输入的标签元素中呈现按钮组件。记住，标签上的<code class="fe ls lt lu lv b">htmlFor</code>属性应该与输入的<code class="fe ls lt lu lv b">id</code>相匹配。</p><pre class="kg kh ki kj gt oi lv oj ok aw ol bi"><span id="258e" class="om mu iq lv b gy on oo l op oq">&lt;&gt;<br/>  &lt;input <em class="or">accept</em>="image/*" <em class="or">type</em>="file" <em class="or">id</em>="select-image" /&gt;<br/>  <strong class="lv ir">&lt;label <em class="or">htmlFor</em>="select-image"&gt;<br/>    &lt;<em class="or">Button</em> <em class="or">variant</em>="contained" <em class="or">color</em>="primary"&gt;<br/>      Upload Image<br/>    &lt;/<em class="or">Button</em>&gt;<br/>  &lt;/label&gt;</strong><br/>&lt;/&gt;</span></pre><p id="0a06" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们检查输出，它将不是我们所希望的。我们将看到输入元素和按钮都呈现在屏幕上。此外，按钮不能按预期工作。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/c0af296da41daafaea2ab3908502ce15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*v2U9yieB-MATt5rpbTOjEg.png"/></div></figure><p id="31f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有两件事我们需要解决。</p><p id="2d77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们需要隐藏输入元素。因此，访问输入的唯一方式是通过标签。我们可以通过向input元素添加一个内联样式<code class="fe ls lt lu lv b">style={{ display: ‘none’ }}</code>来实现这一点。</p><p id="ff4d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其次，我们需要改变按钮的组件类型。目前，它是一个按钮元素，但我们需要将其更改为一个span元素。我们可以通过向按钮组件添加一个<code class="fe ls lt lu lv b">component=”span”</code>道具来实现这一点。</p><pre class="kg kh ki kj gt oi lv oj ok aw ol bi"><span id="81b4" class="om mu iq lv b gy on oo l op oq">&lt;&gt;<br/>  &lt;input <br/>    <em class="or">accept</em>="image/*" <br/>    <em class="or">type</em>="file" <br/>    <em class="or">id</em>="select-image"<br/>    <strong class="lv ir"><em class="or">style</em>={{ display: 'none' }}</strong><br/>  /&gt;<br/>  &lt;label <em class="or">htmlFor</em>="select-image"&gt;<br/>    &lt;<em class="or">Button</em> <em class="or">variant</em>="contained" <em class="or">color</em>="primary" <strong class="lv ir">component="span"</strong>&gt;<br/>      Upload Image<br/>    &lt;/<em class="or">Button</em>&gt;<br/>  &lt;/label&gt;<br/>&lt;/&gt;</span></pre><p id="64e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们将只看到按钮。如果我们点击它，我们的文件选择屏幕将打开，并允许我们选择一个图像。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/f77e3c690462c7ac89020375fd98a61b.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*8iWU-lp0_sjyow2iUC1INw.png"/></div></figure><h1 id="332b" class="mt mu iq bd mv mw ot my mz na ou nc nd jw ov jx nf jz ow ka nh kc ox kd nj nk bi translated">使用React存储文件数据</h1><p id="bf22" class="pw-post-body-paragraph kw kx iq ky b kz nl jr lb lc nm ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">下一步将是处理文件数据。我们将使用React中的<code class="fe ls lt lu lv b">useState</code>钩子并创建一个名为<code class="fe ls lt lu lv b">selectedImage</code>的状态变量。</p><pre class="kg kh ki kj gt oi lv oj ok aw ol bi"><span id="2942" class="om mu iq lv b gy on oo l op oq">const [selectedImage, setSelectedImage] = useState(null);</span></pre><p id="1b0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们将向输入元素添加一个<code class="fe ls lt lu lv b">onChange</code>监听器。每当输入文件改变时，我们都要将<code class="fe ls lt lu lv b">selectedImage</code>变量设置为所选的文件。数据将以数组的形式出现，所以一定要使用<code class="fe ls lt lu lv b">e.target.files[0]</code> <strong class="ky ir">获取数组中的第一项。</strong></p><pre class="kg kh ki kj gt oi lv oj ok aw ol bi"><span id="3b6e" class="om mu iq lv b gy on oo l op oq">&lt;input<br/>  <em class="or">accept</em>="image/*"<br/>  <em class="or">type</em>="file"<br/>  <em class="or">id</em>="select-image"<br/>  <em class="or">style</em>={{ display: 'none' }}<br/>  <strong class="lv ir"><em class="or">onChange</em>={<em class="or">e</em> =&gt; setSelectedImage(<em class="or">e</em>.target.files[0])}</strong><br/>/&gt;</span></pre><p id="234d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们添加一个图像并将<code class="fe ls lt lu lv b">selectedImage</code>变量记录到控制台，我们将会看到以下内容。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pa"><img src="../Images/7a12a1fb430134314303615540aa1938.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*28hAb3bg0zXOa2aNc-WvEw.png"/></div></div></figure><p id="34ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们存储在<code class="fe ls lt lu lv b">selectedImage</code>变量中的是一个文件对象。你可以在这里阅读更多关于文件对象<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/File" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><h1 id="b501" class="mt mu iq bd mv mw ot my mz na ou nc nd jw ov jx nf jz ow ka nh kc ox kd nj nk bi translated">使用URL对象显示图像的预览</h1><p id="eb46" class="pw-post-body-paragraph kw kx iq ky b kz nl jr lb lc nm ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">最后一步是显示我们上传的图片预览。我们可以使用React中的<code class="fe ls lt lu lv b">useEffect</code>钩子和URL对象上的<code class="fe ls lt lu lv b">createObjectURL</code>方法来实现这一点。</p><p id="65a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们首先需要另一个状态变量，我们称之为<code class="fe ls lt lu lv b">imageUrl</code>。</p><pre class="kg kh ki kj gt oi lv oj ok aw ol bi"><span id="4426" class="om mu iq lv b gy on oo l op oq">const [imageUrl, setImageUrl] = useState(null);</span></pre><p id="c597" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们将使用<code class="fe ls lt lu lv b">useEffect</code>钩子并监听<code class="fe ls lt lu lv b">selectedImage</code>变量的变化。如果有一个选定的图像，那么我们将希望创建一个图像的网址。</p><p id="9b6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用URL对象上的<code class="fe ls lt lu lv b">createObjectURL</code>方法从文件对象创建一个URL。这个函数接受一个文件、Blob或MediaSource对象，并创建一个对象URL。你可以在这里阅读更多关于这个<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL" rel="noopener ugc nofollow" target="_blank">的内容</a>。</p><pre class="kg kh ki kj gt oi lv oj ok aw ol bi"><span id="cc68" class="om mu iq lv b gy on oo l op oq">useEffect(() =&gt; {<br/>  if (selectedImage) {<br/>    setImageUrl(<em class="or">URL</em>.createObjectURL(selectedImage));<br/>  }<br/>}, [selectedImage]);</span></pre><p id="c473" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们将使用<code class="fe ls lt lu lv b">img</code>元素通过将我们创建的URL添加到源中来显示图像。为了让它看起来更好，我还使用了Material-UI中的Box组件来添加上边距并使文本居中。</p><pre class="kg kh ki kj gt oi lv oj ok aw ol bi"><span id="1e7b" class="om mu iq lv b gy on oo l op oq">{imageUrl &amp;&amp; selectedImage &amp;&amp; (<br/>  &lt;<em class="or">Box</em> <em class="or">mt</em>={2} <em class="or">textAlign</em>="center"&gt;<br/>    &lt;div&gt;Image Preview:&lt;/div&gt;<br/>    &lt;img <em class="or">src</em>={imageUrl} <em class="or">alt</em>={selectedImage.name} <em class="or">height</em>="100px" /&gt;<br/>  &lt;/<em class="or">Box</em>&gt;<br/>)}</span></pre><p id="f20d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想从Material-UI了解更多关于盒子组件的信息，请查看下面的文章。</p><div class="nq nr gp gr ns nt"><a href="https://levelup.gitconnected.com/using-the-box-component-in-material-ui-to-easily-style-your-project-532894edd205" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">使用Material-UI中的Box组件轻松设置项目样式</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">不使用CSS文件、CSS-in-JS或内联样式来设计您的应用程序</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oc l"><div class="pb l oe of og oc oh kp nt"/></div></div></a></div><p id="da00" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的组件现在完成了！当我们上传图像时，我们会在按钮下方看到图像的预览。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/7b2fdaa6d6e5a8d2201e13cdc8705e99.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*al4WpdhwJKEYN9kGpuj5Jg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://gist.github.com/chadmuro/e770ade905c27eb76f44559e6c4eb6be" rel="noopener ugc nofollow" target="_blank">Link to GitHub Gist</a></figcaption></figure></div><div class="ab cl mm mn hu mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="ij ik il im in"><h1 id="87b3" class="mt mu iq bd mv mw mx my mz na nb nc nd jw ne jx nf jz ng ka nh kc ni kd nj nk bi translated">结论</h1><p id="dadf" class="pw-post-body-paragraph kw kx iq ky b kz nl jr lb lc nm ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">您可以在下面查看该组件的完整源代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pc pd l"/></div></figure><p id="1604" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！我希望这篇文章对你用Material-UI创建一个文件输入按钮有所帮助。我认为让用户看到一个有风格的按钮，以及他们上传的图片预览是一种更好的体验。</p><p id="f760" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想继续学习Material-UI，可以看看下面的文章。</p><div class="nq nr gp gr ns nt"><a href="https://medium.com/geekculture/what-really-happens-when-you-use-the-textfield-component-in-material-ui-1e62652196f" rel="noopener follow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">在Material-UI中使用TextField组件时，实际会发生什么？</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">让我们更深入地调查一下</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">medium.com</p></div></div><div class="oc l"><div class="pe l oe of og oc oh kp nt"/></div></div></a></div><div class="nq nr gp gr ns nt"><a rel="noopener  ugc nofollow" target="_blank" href="/the-easiest-way-to-style-your-material-ui-components-the-makestyles-function-a66ab7b9fe01"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">样式化你的材质UI组件的最简单的方法:makeStyles函数</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">如何在Material-UI中使用makeStyles函数</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="oc l"><div class="pf l oe of og oc oh kp nt"/></div></div></a></div><p id="28ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="or">更多内容看</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="or">plain English . io</em></strong></a></p></div></div>    
</body>
</html>