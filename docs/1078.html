<html>
<head>
<title>Add Network Diagrams and Streamgraphs into Our React App with the Visx Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Visx库将网络图和流图添加到React应用程序中</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/add-network-diagrams-and-streamgraphs-into-our-react-app-with-the-visx-library-15c1b561cdd6?source=collection_archive---------12-----------------------#2021-03-06">https://javascript.plainenglish.io/add-network-diagrams-and-streamgraphs-into-our-react-app-with-the-visx-library-15c1b561cdd6?source=collection_archive---------12-----------------------#2021-03-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b366f2c391bbeb08d49e267f09a423f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZdztMBLzF8XeqQXu"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@pmayor?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Patrick Mayor</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="828d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Visx是一个库，让我们可以轻松地将图形添加到React应用程序中。</p><p id="ee07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用它将雷达图添加到React应用程序中。</p><h1 id="396e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">安装所需的软件包</h1><p id="2968" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们必须安装一些模块。</p><p id="61e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="89df" class="mn lc iq mj b gy mo mp l mq mr">npm i @visx/responsive @visx/network</span></pre><p id="8e2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装网络图的软件包。</p><p id="9bff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2dee" class="mn lc iq mj b gy mo mp l mq mr">npm i @visx/responsive @visx/pattern @visx/scale @visx/shape</span></pre><p id="b78f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装流图的软件包。</p><h1 id="fac1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">网络图</h1><p id="1db8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过编写以下内容来添加网络图:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="be9d" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { Graph } from "@visx/network";</span><span id="cb5c" class="mn lc iq mj b gy ms mp l mq mr">const nodes = [<br/>  { x: 50, y: 20 },<br/>  { x: 200, y: 300 },<br/>  { x: 300, y: 40 }<br/>];</span><span id="6fc2" class="mn lc iq mj b gy ms mp l mq mr">const links = [<br/>  { source: nodes[0], target: nodes[1] },<br/>  { source: nodes[1], target: nodes[2] },<br/>  { source: nodes[2], target: nodes[0] }<br/>];</span><span id="12da" class="mn lc iq mj b gy ms mp l mq mr">const graph = {<br/>  nodes,<br/>  links<br/>};</span><span id="4ef0" class="mn lc iq mj b gy ms mp l mq mr">const background = "#272b4d";</span><span id="bfe7" class="mn lc iq mj b gy ms mp l mq mr">function Example({ width, height }) {<br/>  return width &lt; 10 ? null : (<br/>    &lt;svg width={width} height={height}&gt;<br/>      &lt;rect width={width} height={height} rx={14} fill={background} /&gt;<br/>      &lt;Graph graph={graph} /&gt;<br/>    &lt;/svg&gt;<br/>  );<br/>}</span><span id="8bc2" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Example width={500} height={300} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="a6f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们所要做的就是将<code class="fe mt mu mv mj b">nodes</code>传递给<code class="fe mt mu mv mj b">Graph</code>组件来创建网络图。</p><p id="0d28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个<code class="fe mt mu mv mj b">nodes</code>条目都有<code class="fe mt mu mv mj b">x</code>和<code class="fe mt mu mv mj b">y</code>属性来设置每个节点的坐标。</p><h1 id="5d0c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">流图</h1><p id="21d2" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过编写以下内容来创建流图:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1ec5" class="mn lc iq mj b gy mo mp l mq mr">import React, { useState } from "react";<br/>import { Stack } from "<a class="ae kc" href="http://twitter.com/visx/shape" rel="noopener ugc nofollow" target="_blank">@visx/shape</a>";<br/>import { PatternCircles, PatternWaves } from "<a class="ae kc" href="http://twitter.com/visx/pattern" rel="noopener ugc nofollow" target="_blank">@visx/pattern</a>";<br/>import { scaleLinear, scaleOrdinal } from "<a class="ae kc" href="http://twitter.com/visx/scale" rel="noopener ugc nofollow" target="_blank">@visx/scale</a>";<br/>import { transpose } from "d3-array";<br/>import { animated, useSpring } from "react-spring";</span><span id="52ff" class="mn lc iq mj b gy ms mp l mq mr">function useForceUpdate() {<br/>  const [, setValue] = useState(0);<br/>  return () =&gt; setValue((value) =&gt; value + 1); // update state to force render<br/>}</span><span id="e97f" class="mn lc iq mj b gy ms mp l mq mr">const getPoints = (array, pointCount) =&gt; {<br/>  const x = 1 / (0.1 + Math.random());<br/>  const y = 2 * Math.random() - 0.5;<br/>  const z = 10 / (0.1 + Math.random());<br/>  for (let i = 0; i &lt; pointCount; i += 1) {<br/>    const w = (i / pointCount - y) * z;<br/>    array[i] += x * Math.exp(-w * w);<br/>  }<br/>};</span><span id="dd0b" class="mn lc iq mj b gy ms mp l mq mr">const generateData = (pointCount, bumpCount) =&gt; {<br/>  const arr = [];<br/>  let i;<br/>  for (i = 0; i &lt; pointCount; i += 1) arr[i] = 0;<br/>  for (i = 0; i &lt; bumpCount; i += 1) getPoints(arr, pointCount);<br/>  return arr;<br/>};</span><span id="e007" class="mn lc iq mj b gy ms mp l mq mr"><br/>const NUM_LAYERS = 20;<br/>const SAMPLES_PER_LAYER = 200;<br/>const BUMPS_PER_LAYER = 10;<br/>const BACKGROUND = "#ffdede";<br/>const range = (n) =&gt; Array.from(new Array(n), (_, i) =&gt; i);</span><span id="13b3" class="mn lc iq mj b gy ms mp l mq mr">const keys = range(NUM_LAYERS);</span><span id="ceae" class="mn lc iq mj b gy ms mp l mq mr"><br/>const xScale = scaleLinear({<br/>  domain: [0, SAMPLES_PER_LAYER - 1]<br/>});<br/>const yScale = scaleLinear({<br/>  domain: [-30, 50]<br/>});<br/>const colorScale = scaleOrdinal({<br/>  domain: keys,<br/>  range: [<br/>    "#ffc409",<br/>    "#f14702",<br/>    "#262d97",<br/>    "white",<br/>    "#036ecd",<br/>    "#9ecadd",<br/>    "#51666e"<br/>  ]<br/>});<br/>const patternScale = scaleOrdinal({<br/>  domain: keys,<br/>  range: [<br/>    "mustard",<br/>    "cherry",<br/>    "navy",<br/>    "circles",<br/>    "circles",<br/>    "circles",<br/>    "circles"<br/>  ]<br/>});</span><span id="6286" class="mn lc iq mj b gy ms mp l mq mr">const getY0 = (d) =&gt; yScale(d[0]) ?? 0;<br/>const getY1 = (d) =&gt; yScale(d[1]) ?? 0;</span><span id="d044" class="mn lc iq mj b gy ms mp l mq mr">function Example({ width, height, animate = true }) {<br/>  const forceUpdate = useForceUpdate();<br/>  const handlePress = () =&gt; forceUpdate();</span><span id="c157" class="mn lc iq mj b gy ms mp l mq mr">  if (width &lt; 10) return null;</span><span id="ab18" class="mn lc iq mj b gy ms mp l mq mr">  xScale.range([0, width]);<br/>  yScale.range([height, 0]);<br/>  const layers = transpose(<br/>    keys.map(() =&gt; generateData(SAMPLES_PER_LAYER, BUMPS_PER_LAYER))<br/>  );</span><span id="2cfa" class="mn lc iq mj b gy ms mp l mq mr">  return (<br/>    &lt;svg width={width} height={height}&gt;<br/>      &lt;PatternCircles<br/>        id="mustard"<br/>        height={40}<br/>        width={40}<br/>        radius={5}<br/>        fill="#036ecf"<br/>        complement<br/>      /&gt;<br/>      &lt;PatternWaves<br/>        id="cherry"<br/>        height={12}<br/>        width={12}<br/>        fill="transparent"<br/>        stroke="#232493"<br/>        strokeWidth={1}<br/>      /&gt;<br/>      &lt;PatternCircles<br/>        id="navy"<br/>        height={60}<br/>        width={60}<br/>        radius={10}<br/>        fill="white"<br/>        complement<br/>      /&gt;<br/>      &lt;PatternCircles<br/>        complement<br/>        id="circles"<br/>        height={60}<br/>        width={60}<br/>        radius={10}<br/>        fill="transparent"<br/>      /&gt;</span><span id="52ed" class="mn lc iq mj b gy ms mp l mq mr">     &lt;g onClick={handlePress} onTouchStart={handlePress}&gt;<br/>        &lt;rect<br/>          x={0}<br/>          y={0}<br/>          width={width}<br/>          height={height}<br/>          fill={BACKGROUND}<br/>          rx={14}<br/>        /&gt;<br/>        &lt;Stack<br/>          data={layers}<br/>          keys={keys}<br/>          offset="wiggle"<br/>          color={colorScale}<br/>          x={(_, i) =&gt; xScale(i) ?? 0}<br/>          y0={getY0}<br/>          y1={getY1}<br/>        &gt;<br/>          {({ stacks, path }) =&gt;<br/>            stacks.map((stack) =&gt; {<br/>              // Alternatively use renderprops &lt;Spring to={{ d }}&gt;{tweened =&gt; ...}&lt;/Spring&gt;<br/>              const tweened = animate<br/>                ? useSpring({ d: path(stack) })<br/>                : { d: path(stack) };<br/>              const color = colorScale(stack.key);<br/>              const pattern = patternScale(stack.key);<br/>              return (<br/>                &lt;g key={`series-${stack.key}`}&gt;<br/>                  &lt;animated.path d={tweened.d || ""} fill={color} /&gt;<br/>                  &lt;animated.path<br/>                    d={tweened.d || ""}<br/>                    fill={`url(#${pattern})`}<br/>                  /&gt;<br/>                &lt;/g&gt;<br/>              );<br/>            })<br/>          }<br/>        &lt;/Stack&gt;<br/>      &lt;/g&gt;<br/>    &lt;/svg&gt;<br/>  );<br/>}</span><span id="e59c" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Example width={500} height={300} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="ef2f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个<code class="fe mt mu mv mj b">useForceUpdate</code>钩子，当我们点击它时，它会更新流图。</p><p id="098f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">getPoints</code>操作流图的点。</p><p id="8931" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据由<code class="fe mt mu mv mj b">genereateData</code>功能生成。</p><p id="eae6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">常量用于控制我们生成的数据类型。</p><p id="84a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">xScale</code>和<code class="fe mt mu mv mj b">yScale</code>的值介于x和y尺寸的极值之间。</p><p id="bd15" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">colorScale</code>让颜色范围内生成的颜色值填充streamgraph分区。</p><p id="0317" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">patternScale</code>有流图分区的模式，。</p><p id="cce2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">getY0</code>和<code class="fe mt mu mv mj b">getY1</code>让我们获得流图所需的y维值。</p><p id="59d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了呈现图形，我们使用<code class="fe mt mu mv mj b">PatternCircles</code>组件来呈现流图中的圆圈。</p><p id="604b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了呈现其他形状，我们使用<code class="fe mt mu mv mj b">Stack</code>组件返回<code class="fe mt mu mv mj b">animated.path</code>组件来呈现分区形状的路径。</p><p id="ade2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们点击形状时，运行<code class="fe mt mu mv mj b">forceUpdate</code>用新数据重新渲染流图。</p><h1 id="916f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="afed" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用Visx库在React应用程序中添加网络图和流图。</p><p id="e76f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mw">更多内容请看</em><a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mw">plain English . io</em></strong></a></p></div></div>    
</body>
</html>