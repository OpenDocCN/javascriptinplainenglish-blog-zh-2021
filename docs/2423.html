<html>
<head>
<title>How to Cache API Calls in Next.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Next.js中缓存API调用</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-cache-api-calls-in-next-js-f4b6aefa84f1?source=collection_archive---------2-----------------------#2021-05-19">https://javascript.plainenglish.io/how-to-cache-api-calls-in-next-js-f4b6aefa84f1?source=collection_archive---------2-----------------------#2021-05-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/c7fb41f8168651e32dd8d25b7b66bec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HGrri-32sYHxWyK05KZGOA.png"/></div></div></figure><h1 id="2c8d" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">简介</strong></h1><p id="f997" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">Next.js应用程序对同一API的冗余调用是典型的行为。在更新组件或从一个页面转到另一个页面时，可能会发生这种情况。重复调用同一个API会花费我们更多的钱，也会影响应用程序的性能。我们可以通过缓存初始调用本身的API来避免这种不必要的API调用。</p><p id="d3ad" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">通过缓存，我们将特定的API调用响应存储在本地内存中，每当再次触发相同的调用时，我们就从本地存储中发送它；因此，我们可以避免调用服务器。</p><h1 id="4ddc" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">缓存流量</strong></h1><figure class="lx ly lz ma gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lw"><img src="../Images/e28d925330dd83bf599e3649866bbf73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A4nEMHHuvLhpIal9_FTTNQ.png"/></div></div></figure><p id="a9cf" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">当我们进行API调用时，我们首先在缓存内存中检查对应API调用的响应是否在内存中。如果响应存在，我们从缓存中获取响应，然后将其发送回客户端。如果特定API调用的响应不在缓存内存中，我们将直接调用服务器来获得HTTP响应。来自服务器的HTTP响应首先保存在高速缓存中，然后将响应发送回客户端。</p><h1 id="f8b1" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">履行</h1><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="23b9" class="mg jw in mc b gy mh mi l mj mk">npm i memory-cache                                                    </span></pre><p id="24a9" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">为了在Next.js应用程序上实现缓存，必须将memory-cache包安装到项目中。下面的代码片段演示了如何用这个包进行API缓存。</p><figure class="lx ly lz ma gt jo"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="c2fa" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">这里我们有两个按钮，一个名为缓存API调用，另一个是常规API调用。这两个按钮执行相同的过程，从服务器获取一些数据。按钮Cached API触发了一个函数，在该函数中实现了用于获取数据的缓存。另一方面，常规API按钮只对数据进行常规提取。了解实际打开的开发人员控制台中的差异，并在反复单击常规API按钮的同时检查网络，您可以看到对服务器的频繁调用。尽管如此，如果我们重复点击缓存的API按钮，您只会看到一个服务器调用。</p><h1 id="b41c" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">缓存时的注意事项</h1><p id="25c9" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在缓存API时，我们必须遵循一些注意事项。考虑一个API调用，它提供一场板球比赛的实况比分；如果我们将这个API响应缓存在本地内存中，更新后的匹配分数将不会从服务器中检索到，这将导致填充错误的信息。尽管如此，我们可以缓存一个API来获取之前匹配的分数，因为数据在这里是永久的。</p><h1 id="23ba" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">结论</h1><p id="587f" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">感谢您的阅读。我希望您发现这很有帮助，并对了解如何在Next.js中缓存API调用有所了解。</p><p id="4c4a" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><em class="mn">更多内容尽在</em><a class="ae mo" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="mn">plain English . io</em></a></p></div></div>    
</body>
</html>