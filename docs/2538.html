<html>
<head>
<title>Swagger Codegen: From Server to Client</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swagger Codegen:从服务器到客户端</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/swagger-codegen-from-server-to-client-d6a13910ed1f?source=collection_archive---------4-----------------------#2021-05-25">https://javascript.plainenglish.io/swagger-codegen-from-server-to-client-d6a13910ed1f?source=collection_archive---------4-----------------------#2021-05-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1fdf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">OpenAPI规范是服务器和客户端的标准。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/bd0f1702e34356b92c88657224b646ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZwQaQblGHf7kiJCn22XNtQ.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Image credit: Author</figcaption></figure><p id="9698" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lb" href="https://swagger.io/specification/" rel="noopener ugc nofollow" target="_blank"> OpenAPI规范</a> (OAS)是机器可读接口文件的规范，用于描述、生产、消费和可视化RESTful web服务。它是服务器和客户机的标准。开发人员不需要编写、维护或担心自动生成的代码的一致性。此外，Swagger UI生成漂亮的文档，并充当API端点的测试环境。</p><p id="d065" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">除了<a class="ae lb" href="https://betterprogramming.pub/should-ui-developers-learn-swagger-d3890c4fdbe8" rel="noopener ugc nofollow" target="_blank">open API规范、Swagger编辑器和Swagger UI </a>之外，Swagger Codegen还执行以下两个操作:</p><ul class=""><li id="91ca" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">生成服务器存根。</li><li id="9a60" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">生成客户端SDK。</li></ul><p id="b954" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将展示它是如何从服务器到客户端工作的。</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="38ad" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">OpenAPI规范</h1><p id="f1ba" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">OpenAPI规范为HTTP APIs定义了一个标准的、与语言无关的接口。在整篇文章中，我们将使用下面的<a class="ae lb" href="https://betterprogramming.pub/is-yaml-ready-for-javascript-b501c7a087c6" rel="noopener ugc nofollow" target="_blank"> YAML </a>对宠物店的定义。这是OpenAPI规范3.0 中的一个官方例子。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="9b2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">复制粘贴到web上的Swagger编辑器:<code class="fe nc nd ne nf b"><a class="ae lb" href="https://editor.swagger.io/" rel="noopener ugc nofollow" target="_blank">https://editor.swagger.io/</a></code>。</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="654e" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">服务器存根的代码生成</h1><p id="1c30" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">Codegen采用设计优先的方法。它从一个YAML或JSON文件开始，然后为进一步的编码生成服务器存根。设计优先方法和代码优先方法各有利弊。一般来说，Swagger社区推荐设计优先的方法。</p><p id="8325" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<a class="ae lb" href="https://medium.com/codex/exploring-swagger-codegen-and-swagger-plugins-a8d507b9fd5e" rel="noopener">之前的文章</a>中，我们已经描述了如何使用Swagger编辑器生成服务器存根。点击Swagger编辑器的菜单，<code class="fe nc nd ne nf b">Generate Server</code>，里面显示了很多服务器/框架的选择，比如Go server、Java server、Scala server、<a class="ae lb" href="https://betterprogramming.pub/whats-new-in-node-js-15-fc24e87e2590" rel="noopener ugc nofollow" target="_blank">节点</a>服务器。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ng"><img src="../Images/32892cd17ddd811e2fd307ed8aeb9d27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kkPAJavQ0oJKFISB.png"/></div></div></figure><p id="8455" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们选择<code class="fe nc nd ne nf b">nodejs-server</code>作为例子。点击<code class="fe nc nd ne nf b">nodejs-server</code>后，<code class="fe nc nd ne nf b">nodejs-server-server-generated.zip</code>作为节点/JavaScript项目下载。它充当CRUD操作的简单服务器。</p><p id="e1a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可以在<a class="ae lb" href="https://github.com/JenniferFuBook/nodejs-server-server-generated" rel="noopener ugc nofollow" target="_blank">服务器仓库</a>获取服务器代码。</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="002b" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">客户端SDK的Codegen</h1><p id="a7ef" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">相同的Swagger编辑器可以用于生成客户端SDK。通常，这些API由前端调用来创建用户界面。</p><p id="036f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点击<code class="fe nc nd ne nf b">Generate Client</code>菜单，显示C#、Dart、Go、Java、JavaScript、TypeScript等多种语言选择。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nh"><img src="../Images/13ee7ff0fd267a9c2154183f6ce2b270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OYvnpeujgtpq9UmPTi1BSg.png"/></div></div></figure><p id="7af6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">选择您构建前端的语言。我们选择<code class="fe nc nd ne nf b">typescript-axios</code>作为例子。点击<code class="fe nc nd ne nf b">typescript-axios</code>后，在<code class="fe nc nd ne nf b">Downloads</code>文件夹中生成<code class="fe nc nd ne nf b">typescript-axios-client-generated.zip</code>。</p><p id="0c3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开zip文件，在<a class="ae lb" href="https://betterprogramming.pub/10-useful-plugins-for-visual-studio-code-6ab62c0b14ee" rel="noopener ugc nofollow" target="_blank"> VS代码</a>中显示这个TypeScript/Axios项目。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ni"><img src="../Images/bbd8e69c20532e6ae6679a5e6a4da8bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1qK7_6kemisG8H09Orz3yg.png"/></div></div></figure><p id="a659" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nc nd ne nf b">apis/pets-api.ts</code>是处理<code class="fe nc nd ne nf b">createPets</code>(第51行)、<code class="fe nc nd ne nf b">listPets</code>(第62行)和<code class="fe nc nd ne nf b">showPetById</code>(第73行)的客户端SDK。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="808c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lb" href="https://github.com/JenniferFuBook/typescript-axios-client-generated/blob/main/apis/pets-api.ts" rel="noopener ugc nofollow" target="_blank">上述代码</a>的完整版本可在<a class="ae lb" href="https://github.com/JenniferFuBook/typescript-axios-client-generated" rel="noopener ugc nofollow" target="_blank">客户端回购</a>获取。</p><p id="d608" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nc nd ne nf b">models</code>文件夹捕获API数据结构。</p><p id="75d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nc nd ne nf b">models/pet.ts</code>定义了<code class="fe nc nd ne nf b">Pet</code>接口:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="1d1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nc nd ne nf b">models/pets.ts</code>将<code class="fe nc nd ne nf b">Pets</code>接口定义为<code class="fe nc nd ne nf b">Pet</code>的数组:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="f7f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">添加第1行是为了修复一个编译错误。由于Swagger支持如此多的语言，它可能不会对每个版本的所有用例进行全面测试。</p><p id="9448" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">按照<code class="fe nc nd ne nf b">README</code>中的说明构建包。</p><pre class="km kn ko kp gt nj nf nk nl aw nm bi"><span id="45bc" class="nn ly iq nf b gy no np l nq nr">npm install<br/>npm run build</span></pre><p id="95c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们必须通过添加第1行来修复<code class="fe nc nd ne nf b">models/pets.ts</code>。否则，<code class="fe nc nd ne nf b">npm install</code>失败。</p><pre class="km kn ko kp gt nj nf nk nl aw nm bi"><span id="a32c" class="nn ly iq nf b gy no np l nq nr">$ npm install<br/>npm WARN deprecated axios@0.19.2: Critical security vulnerability fixed in v0.21.1. For more information, see <a class="ae lb" href="https://github.com/axios/axios/pull/3410" rel="noopener ugc nofollow" target="_blank">https://github.com/axios/axios/pull/3410</a><br/>npm notice created a lockfile as package-lock.json. You should commit this file.<br/>npm WARN typescript-axios-client-generated No repository field.</span><span id="becb" class="nn ly iq nf b gy ns np l nq nr">added 6 packages from 45 contributors and audited 6 packages in 5.767s<br/>found 1 high severity vulnerability<br/>  run `npm audit fix` to fix them, or `npm audit` for details<br/>jenniferfu@Jennifers-MBP typescript-axios-client-generated % npm run build</span><span id="532d" class="nn ly iq nf b gy ns np l nq nr">&gt; @ build /Users/jenniferfu/typescript-axios-client-generated<br/>&gt; tsc --outDir dist/</span><span id="011e" class="nn ly iq nf b gy ns np l nq nr">models/pets.ts:19:37 - error TS2304: Cannot find name 'Pet'.</span><span id="ab9d" class="nn ly iq nf b gy ns np l nq nr">19 export interface Pets extends Array&lt;Pet&gt; {<br/>                                       ~~~</span><span id="0475" class="nn ly iq nf b gy ns np l nq nr">models/pets.ts:19:37 - error TS4022: 'extends' clause of exported interface 'Pets' has or is using private name 'Pet'.</span><span id="09cf" class="nn ly iq nf b gy ns np l nq nr">19 export interface Pets extends Array&lt;Pet&gt; {<br/>                                       ~~~</span><span id="feac" class="nn ly iq nf b gy ns np l nq nr">Found 2 errors.</span><span id="a4ad" class="nn ly iq nf b gy ns np l nq nr">npm ERR! code ELIFECYCLE<br/>npm ERR! errno 1<br/>npm ERR! @ build: `tsc --outDir dist/`<br/>npm ERR! Exit status 1<br/>npm ERR! <br/>npm ERR! Failed at the @ build script.<br/>npm ERR! This is probably not a problem with npm. There is likely additional logging output above.</span><span id="a704" class="nn ly iq nf b gy ns np l nq nr">npm ERR! A complete log of this run can be found in:<br/>npm ERR!     /Users/jenniferfu/.npm/_logs/2021-05-16T05_05_14_045Z-debug.log</span></pre><p id="d963" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过修复，我们能够制作软件包:</p><pre class="km kn ko kp gt nj nf nk nl aw nm bi"><span id="9798" class="nn ly iq nf b gy no np l nq nr">$ npm run build</span><span id="3555" class="nn ly iq nf b gy ns np l nq nr">&gt; @ build /Users/jenniferfu/typescript-axios-client-generated<br/>&gt; tsc --outDir dist/</span></pre><p id="5c3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有两种方法可以使用这个SDK:发布软件包或将其用作未发布的软件包。</p><p id="f66f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于已发布的包，执行<code class="fe nc nd ne nf b">npm install @ —-save</code>。</p><p id="07e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于未发布的包，执行<code class="fe nc nd ne nf b">npm install PATH_TO_GENERATED_PACKAGE —-save</code>。</p><p id="8f4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">发布包是官方途径。但是我们将通过一个未发布的包走捷径。</p><p id="b05c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们需要解决未发布包的两个问题。</p><p id="d8d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.<code class="fe nc nd ne nf b">package.json</code>错过一个包名:</p><pre class="km kn ko kp gt nj nf nk nl aw nm bi"><span id="2e46" class="nn ly iq nf b gy no np l nq nr">$ npm install ~/typescript-axios-client-generated/<br/>npm ERR! Can't install /Users/jenniferfu/typescript-axios-client-generated/: Missing package name</span><span id="5e86" class="nn ly iq nf b gy ns np l nq nr">npm ERR! A complete log of this run can be found in:<br/>npm ERR!     /Users/jenniferfu/.npm/_logs/2021-05-16T05_16_42_020Z-debug.log</span></pre><p id="577e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.<code class="fe nc nd ne nf b">package.json</code>缺少版本号:</p><pre class="km kn ko kp gt nj nf nk nl aw nm bi"><span id="b757" class="nn ly iq nf b gy no np l nq nr">$ npm install ~/typescript-axios-client-generated/<br/>npm ERR! Can't install /Users/jenniferfu/typescript-axios-client-generated/: Missing package version</span><span id="9922" class="nn ly iq nf b gy ns np l nq nr">npm ERR! A complete log of this run can be found in:<br/>npm ERR!     /Users/jenniferfu/.npm/_logs/2021-05-16T05_18_34_562Z-debug.log</span></pre><p id="ea5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是固定的<code class="fe nc nd ne nf b">package.json</code>:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="5f92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此时，生成的客户端SDK就可以使用了。</p><p id="afe8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">客户代码可在<a class="ae lb" href="https://github.com/JenniferFuBook/typescript-axios-client-generated" rel="noopener ugc nofollow" target="_blank">客户回购</a>获取。</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="5ade" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">端到端示例</h1><p id="3885" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">我们使用<a class="ae lb" href="https://betterprogramming.pub/upgrade-create-react-app-based-projects-to-version-4-cra-4-d7962aee11a6" rel="noopener ugc nofollow" target="_blank"> Create React App </a>来试用客户端SDK。</p><pre class="km kn ko kp gt nj nf nk nl aw nm bi"><span id="8b5b" class="nn ly iq nf b gy no np l nq nr">npx create-react-app react-app<br/>cd react-app</span></pre><p id="46e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装未发布的软件包:</p><pre class="km kn ko kp gt nj nf nk nl aw nm bi"><span id="3041" class="nn ly iq nf b gy no np l nq nr">npm install PATH_TO_GENERATED_PACKAGE —-save</span></pre><p id="b189" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的例子中，<code class="fe nc nd ne nf b">PATH_TO_GENERATED_PACKAGE</code>就是<code class="fe nc nd ne nf b">~/typescript-axios-client-generated</code>。</p><p id="4f46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个新包是<code class="fe nc nd ne nf b">package.json</code>中<code class="fe nc nd ne nf b"><a class="ae lb" href="https://betterprogramming.pub/package-jsons-dependencies-in-depth-a1f0637a3129" rel="noopener ugc nofollow" target="_blank">dependencies</a></code>的一部分(下图，右)。<code class="fe nc nd ne nf b">PetStore</code>安装在<code class="fe nc nd ne nf b">node_modules</code>中(左下)，随时可以使用。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nt"><img src="../Images/9122360e21261e1bc826cfadf5a1fff7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*POTce73ryscYNfaouk4veA.png"/></div></div></figure><p id="d92d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是改编后的<code class="fe nc nd ne nf b">src/App.js</code>:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="6f22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第1行导入了<code class="fe nc nd ne nf b">PetStore</code>API。</p><p id="2fa4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第9–19行调用<code class="fe nc nd ne nf b">listPets</code>来检索宠物列表。</p><p id="c7be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第25行显示了宠物列表。</p><p id="cc79" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">确保节点/JavaScript服务器项目正在运行。在<code class="fe nc nd ne nf b">nodejs-server-server-generated</code>处，在<code class="fe nc nd ne nf b">localhost:8080</code>处运行<code class="fe nc nd ne nf b">npm start</code>。</p><p id="b08d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">确保TypeScript/Axios项目已经构建并可在<code class="fe nc nd ne nf b">typescript-axios-client-generated</code>访问。</p><p id="8ecb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在修改后的Create React应用程序中，在<code class="fe nc nd ne nf b">localhost:3000</code>处运行<code class="fe nc nd ne nf b">npm start</code>。</p><p id="57c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们同时运行服务器和客户端。为什么我们会在浏览器控制台上看到以下错误？</p><pre class="km kn ko kp gt nj nf nk nl aw nm bi"><span id="952e" class="nn ly iq nf b gy no np l nq nr">Access to XMLHttpRequest at '<a class="ae lb" href="http://localhost:8080/v1/pets'" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/v1/pets'</a> from origin '<a class="ae lb" href="http://localhost:3000'" rel="noopener ugc nofollow" target="_blank">http://localhost:3000'</a> has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource.</span></pre><p id="0dd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lb" href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy" rel="noopener ugc nofollow" target="_blank">同源策略</a>是一种关键的安全机制，它限制从一个源加载的文档或脚本如何与另一个源的资源交互。如果两个URL的协议、端口和主机相同，则这两个URL具有相同的来源。<code class="fe nc nd ne nf b">localhost:8080</code>和<code class="fe nc nd ne nf b">localhost:3000</code>端口不同。因此，浏览器限制客户端获取数据。</p><p id="5080" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lb" href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing" rel="noopener ugc nofollow" target="_blank">跨源资源共享</a> (CORS)是一种机制，允许从提供第一资源的域之外的另一个域请求网页上的受限资源。</p><p id="cd88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有许多方法可以设置CORS。我们使用一个Chrome扩展，<code class="fe nc nd ne nf b">Allow CORS: Access-Control-Allow-Origin</code>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/8c3a033cc781abbe50dd9445990de446.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*7pl66mdsnrgCZyB5gxZAjw.png"/></div></figure><p id="fba2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它可以打开或关闭CROS。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/e30500fa9394b9128d53dee77e13da32.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*ZQaoWJaqaJcxgsXNpDu1xA.png"/></div></figure><p id="89e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常情况下，CROS因网络安全而关闭。当它打开时，C图标变成红色作为警告。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/d79008c3966fc5872b9d372a055cc6fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*av4YO4FRe4SH29XcLS54-w.png"/></div></figure><p id="8109" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当CORS选项打开时，控制台上的访问错误消失。我们在用户界面上看到检索到的宠物列表。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/9adaded77c264daf4f5ab51a85854c6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*g-z7ZvkSjDgYzGpOPaCCIQ.png"/></div></figure><p id="4dd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">端到端的例子有效！</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="8bc4" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">Codegen CLI命令</h1><p id="deb1" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">我们使用图形用户界面来生成服务器存根和客户端SDK。Codegen提供了CLI命令来完成同样的事情。CLI命令要求系统上安装Java。</p><pre class="km kn ko kp gt nj nf nk nl aw nm bi"><span id="501b" class="nn ly iq nf b gy no np l nq nr">sudo apt install default-jdk</span></pre><p id="4aa0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nc nd ne nf b">swagger-codegen-cli</code>可以从<a class="ae lb" href="https://jar-download.com/?search_box=swagger-codegen-cli" rel="noopener ugc nofollow" target="_blank">jar下载页面</a>下载。目前，最新版本是<code class="fe nc nd ne nf b">swagger-codegen-cli-3.0.25.jar</code>。它支持以下语言和web/应用服务器:</p><pre class="km kn ko kp gt nj nf nk nl aw nm bi"><span id="54f4" class="nn ly iq nf b gy no np l nq nr">dart, aspnetcore, csharp, csharp-dotnet2, go, go-server, dynamic-html, html, html2, java, jaxrs-cxf-client, jaxrs-cxf, inflector, jaxrs-cxf-cdi, jaxrs-spec, jaxrs-jersey, jaxrs-di, jaxrs-resteasy-eap, jaxrs-resteasy, micronaut, spring, nodejs-server, openapi, openapi-yaml, kotlin-client, kotlin-server, php, python, python-flask, r, ruby, scala, scala-akka-http-server, swift3, swift4, swift5, typescript-angular, typescript-axios, typescript-fetch, javascript</span></pre><p id="afcb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该列表是服务器存根和客户端SDK的组合。它与图形用户界面选项略有不同。</p><p id="671e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Codegen CLI有许多选项。其中，以下选项至关重要:</p><ul class=""><li id="acbd" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><code class="fe nc nd ne nf b">-i</code>:swagger规范的位置，如URL或文件(必需)</li><li id="f25c" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated"><code class="fe nc nd ne nf b">-l</code>:生成的客户端语言(必填)</li><li id="b9e8" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated"><code class="fe nc nd ne nf b">-o</code>:生成文件的写入位置(默认为当前目录)</li></ul><p id="843c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是一个从<code class="fe nc nd ne nf b">~/petstore.yaml</code>中读取YAML文件并在<code class="fe nc nd ne nf b">swagger-codegen-client</code>文件夹中生成Java代码的例子。</p><pre class="km kn ko kp gt nj nf nk nl aw nm bi"><span id="d5f6" class="nn ly iq nf b gy no np l nq nr">java -jar swagger-codegen-cli-3.0.25.jar generate -i ~/petstore.yaml <!-- -->-l java -o swagger-codegen-client</span></pre></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="5f6b" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">结论</h1><p id="5bb6" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">OpenAPI规范是服务器和客户端的标准。我们已经展示了如何使用Swagger Codegen从服务器到客户端生成代码。它提供了一种标准化和加速web应用程序开发的系统方法。</p><p id="263c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Swagger Codegen支持主要语言和web/app服务器。它带有图形界面和CLI命令。</p><p id="d3bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢马克西姆·库兹涅佐夫和朱利奥·卡波利诺向我展示了斯瓦格的迷人之处！</p><p id="7dda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读。我希望这有所帮助。你可以在这里看到我的其他媒体出版物<a class="ae lb" href="https://medium.com/@jenniferfubook/jennifer-fus-web-development-publications-1a887e4454af" rel="noopener"/>。</p><p id="c150" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nx">更多内容尽在</em><a class="ae lb" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank">T5】plain English . ioT7】</a></p></div></div>    
</body>
</html>