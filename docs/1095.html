<html>
<head>
<title>How to Test a Redux-Connected React Component</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何测试冗余连接的React组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-test-a-redux-connected-react-component-242d6a58b9be?source=collection_archive---------14-----------------------#2021-03-07">https://javascript.plainenglish.io/how-to-test-a-redux-connected-react-component-242d6a58b9be?source=collection_archive---------14-----------------------#2021-03-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/e75ca0fc7dd3c8770b5e3d2e39c5b4af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Sdcc8Dj99emMBoZb"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@battlecreekcoffeeroasters?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Battlecreek Coffee Roasters</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ee36" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Redux是一个处理全局状态的强大库。有人讨厌，有人喜欢。有一件事我可以肯定，如果你在React代码库中使用redux，你会希望对它进行测试。如果你不这样做，它会削弱你自信地发布新特性的能力。在这篇文章中，我将描述一种简单而强大的方法来使用<a class="ae jz" href="https://testing-library.com/docs/react-testing-library/intro/" rel="noopener ugc nofollow" target="_blank"> React测试库</a>测试Redux连接的React组件。</p><h1 id="50e3" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">演示应用程序</h1><p id="c779" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">为了设置一些背景，我准备了一个简单的演示应用程序。在代码示例中，我将使用来自<code class="fe mb mc md me b">react-redux</code> lib的hooks API，因为这是现在<a class="ae jz" href="https://react-redux.js.org/api/hooks" rel="noopener ugc nofollow" target="_blank">推荐的方法</a>。</p><p id="f965" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们从创建商店开始。这非常简单，它允许添加和删除列表中的项目。</p><figure class="mf mg mh mi gt jo"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="d6c7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请注意，我正在导出<code class="fe mb mc md me b">createApplicationStore</code>函数。我将在以后的测试中使用它。</p><p id="f8bd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">该应用程序本身只显示商店中的商品，并允许添加新商品以及删除现有商品。在现实生活中的应用程序中，你可能想把它分成更小的组件，但是为了演示的目的，它会工作得很好。</p><figure class="mf mg mh mi gt jo"><div class="bz fp l di"><div class="mj mk l"/></div></figure><h1 id="ed1b" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">测试</h1><p id="faf5" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">有了所有的设置，让我们考虑测试方法。注意，<code class="fe mb mc md me b">App</code>组件使用<code class="fe mb mc md me b">useSelector</code>和<code class="fe mb mc md me b">useDispatch</code>钩子来集成应用程序商店。这给了我两个选择:</p><ul class=""><li id="7f87" class="ml mm in kc b kd ke kh ki kl mn kp mo kt mp kx mq mr ms mt bi translated">嘲笑他们</li><li id="f83f" class="ml mm in kc b kd mu kh mv kl mw kp mx kt my kx mq mr ms mt bi translated">使用<code class="fe mb mc md me b">Provider</code>组件提供商店</li></ul><p id="14ac" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我认为嘲笑<code class="fe mb mc md me b">useSelector</code>函数是一个非常糟糕的主意，原因如下:</p><ul class=""><li id="e479" class="ml mm in kc b kd ke kh ki kl mn kp mo kt mp kx mq mr ms mt bi translated">它不测试选择器功能</li><li id="d73d" class="ml mm in kc b kd mu kh mv kl mw kp mx kt my kx mq mr ms mt bi translated">它不测试商店</li><li id="d94c" class="ml mm in kc b kd mu kh mv kl mw kp mx kt my kx mq mr ms mt bi translated">每次一个新的<code class="fe mb mc md me b">useSelector</code>调用被添加到组件测试中时都必须被更新</li><li id="e70f" class="ml mm in kc b kd mu kh mv kl mw kp mx kt my kx mq mr ms mt bi translated">在添加了更多的<code class="fe mb mc md me b">useSelector</code>调用之后，测试将会按照它们被执行的顺序进行</li></ul><p id="1aea" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">维护这样的测试将是一场噩梦，所以我选择第二种方法。</p><figure class="mf mg mh mi gt jo"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="79b2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这个测试很容易阅读，它类似于一个真实的用户与应用程序的交互。</p><ol class=""><li id="35e4" class="ml mm in kc b kd ke kh ki kl mn kp mo kt mp kx mz mr ms mt bi translated">查找新的项目输入</li><li id="3785" class="ml mm in kc b kd mu kh mv kl mw kp mx kt my kx mz mr ms mt bi translated">键入一个名称</li><li id="120c" class="ml mm in kc b kd mu kh mv kl mw kp mx kt my kx mz mr ms mt bi translated">单击提交按钮</li><li id="b592" class="ml mm in kc b kd mu kh mv kl mw kp mx kt my kx mz mr ms mt bi translated">期望项目出现在列表中</li><li id="3091" class="ml mm in kc b kd mu kh mv kl mw kp mx kt my kx mz mr ms mt bi translated">单击删除按钮</li><li id="7eab" class="ml mm in kc b kd mu kh mv kl mw kp mx kt my kx mz mr ms mt bi translated">预计该项目将消失</li></ol><p id="0858" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这个测试与实际的商店交互(注意，我调用了<code class="fe mb mc md me b">createApplicationStore</code>)，所以我只用一个简单的测试就获得了很好的测试覆盖率。此外，测试根本不在乎我使用<code class="fe mb mc md me b">useSelector</code>挂钩，我可以切换到<a class="ae jz" href="https://react-redux.js.org/api/connect" rel="noopener ugc nofollow" target="_blank">连接</a>特设在它仍然会工作，没有任何变化。</p><h1 id="b0c9" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">摘要</h1><p id="d207" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">我希望这篇文章对你有用。这里有一些关于测试的更好的资源。如果你喜欢这篇文章，我强烈推荐你去看看。</p><ul class=""><li id="0af3" class="ml mm in kc b kd ke kh ki kl mn kp mo kt mp kx mq mr ms mt bi translated"><a class="ae jz" href="https://hacks.mozilla.org/2018/04/testing-strategies-for-react-and-redux/" rel="noopener ugc nofollow" target="_blank">https://hacks . Mozilla . org/2018/04/testing-strategies-for-react-and-redux/</a></li><li id="9c1c" class="ml mm in kc b kd mu kh mv kl mw kp mx kt my kx mq mr ms mt bi translated"><a class="ae jz" href="https://www.youtube.com/watch?v=u5senBJUkPc" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=u5senBJUkPc</a></li></ul></div></div>    
</body>
</html>