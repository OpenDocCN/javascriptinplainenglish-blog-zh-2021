<html>
<head>
<title>Send Automatic WhatsApp Messages Using JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用JavaScript自动发送WhatsApp信息</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/sending-automatic-whatsapp-messages-using-javascript-9860ba96d486?source=collection_archive---------0-----------------------#2021-09-06">https://javascript.plainenglish.io/sending-automatic-whatsapp-messages-using-javascript-9860ba96d486?source=collection_archive---------0-----------------------#2021-09-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/ddf2c77f61f0c571cd3cfd95545d8334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*g1EQhusLbZfdUbX7PEvviw.jpeg"/></div></figure><p id="e7b1" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">→ <strong class="jt io"> WhatsApp </strong>，是脸书公司旗下的一款美国免费软件，跨平台集中式即时通讯和IP语音服务。</p><p id="f676" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">→它允许用户发送文本消息和语音消息，进行语音和视频通话，以及共享图像、文档、用户位置和其他内容。</p><p id="a775" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">→我们可以用Node.js发送WhatsApp消息，回复即时自动消息</p><h1 id="57a1" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">安装:</h1><ol class=""><li id="8825" class="ln lo in jt b ju lp jy lq kc lr kg ls kk lt ko lu lv lw lx bi translated">node . js https://nodejs.org/en/download/<a class="ae ly" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank"/></li></ol><p id="d946" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">2.Whatsapp-web.js:是连接Whatsapp的Node.js客户端库。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="57d1" class="mi kq in me b gy mj mk l ml mm">npm install whatsapp-web.js</span></pre><p id="9b6e" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">3.QR码生成器</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="6100" class="mi kq in me b gy mj mk l ml mm">npm i qrcode-terminal</span></pre><p id="742e" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">→我们将在下面的数据变量中添加一个<strong class="jt io">自动回复列表</strong></p><h1 id="ccb0" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">代码:(server.js)</h1><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="0582" class="mi kq in me b gy mj mk l ml mm">const { <strong class="me io">Client</strong> } = <strong class="me io">require</strong>('whatsapp-web.js');<br/>const qrcode = <strong class="me io">require</strong>('qrcode-terminal');</span><span id="7d2f" class="mi kq in me b gy mn mk l ml mm">const client = new <strong class="me io">Client</strong>();</span><span id="9ad4" class="mi kq in me b gy mn mk l ml mm"><em class="mo">// Get QR code to scan WhatsAPP</em></span><span id="c877" class="mi kq in me b gy mn mk l ml mm">client.<strong class="me io">on</strong>('qr', qr =&gt; {</span><span id="d94c" class="mi kq in me b gy mn mk l ml mm">    qrcode.<strong class="me io">generate</strong>(qr, {small: true});</span><span id="e40b" class="mi kq in me b gy mn mk l ml mm">});</span><span id="4f85" class="mi kq in me b gy mn mk l ml mm">client.<strong class="me io">on</strong>('ready', () =&gt; {<br/>    console.<strong class="me io">log</strong>('Client is ready!');<br/>});</span><span id="7c27" class="mi kq in me b gy mn mk l ml mm">client.<strong class="me io">on</strong>('message', message =&gt; {<br/>    console.<strong class="me io">log</strong>(message.body);<br/>});</span><span id="a6cc" class="mi kq in me b gy mn mk l ml mm"><em class="mo">// List of data for automatic reply<br/></em>var data = [</span><span id="9ba9" class="mi kq in me b gy mn mk l ml mm">{ id: 1, received: 'Hello', reply: 'Hi'},</span><span id="1bac" class="mi kq in me b gy mn mk l ml mm">{ id: 2, received: 'Sorry', reply: 'No problem'},</span><span id="16d1" class="mi kq in me b gy mn mk l ml mm">{ id: 3, received: 'Can we have a call?', reply: 'Please leave a voicemail. Let us connect in an hour. Kind Reards, Amir Mustafa'},</span><span id="4c63" class="mi kq in me b gy mn mk l ml mm">{ default: 'Please leave a voicemail. Let us connect in an hour. Kind Reards, Amir Mustafa' }</span><span id="f53d" class="mi kq in me b gy mn mk l ml mm">];</span><span id="4f36" class="mi kq in me b gy mn mk l ml mm">client.<strong class="me io">on</strong>('message', message =&gt; {<br/>  var selectedData = data.<strong class="me io">find</strong>((msg) =&gt; {<br/>  if(msg.received === message.body) {<br/>    return true<br/>  }<br/>});</span><span id="556a" class="mi kq in me b gy mn mk l ml mm">var sourceMsg, targetMsg;</span><span id="2c0b" class="mi kq in me b gy mn mk l ml mm">if(selectedData &amp;&amp; <strong class="me io">Object</strong>.<strong class="me io">keys</strong>(selectedData).length !== 0 &amp;&amp; selectedData.constructor === <strong class="me io">Object</strong>) {</span><span id="2aa4" class="mi kq in me b gy mn mk l ml mm">  sourceMsg = selectedData.received;<br/>  targetMsg = selectedData.reply;</span><span id="9f03" class="mi kq in me b gy mn mk l ml mm">}</span><span id="3395" class="mi kq in me b gy mn mk l ml mm"><em class="mo">// test data<br/>// const sourceMsg = 'Hello';<br/>// const targetMsg = 'I am occupied at present. You can leave me SMS here, will call you shortly.';</em></span><span id="0294" class="mi kq in me b gy mn mk l ml mm"><em class="mo">// send message</em></span><span id="8ad4" class="mi kq in me b gy mn mk l ml mm">if(message.body === sourceMsg) {</span><span id="0067" class="mi kq in me b gy mn mk l ml mm">  message.<strong class="me io">reply</strong>(targetMsg);</span><span id="c23e" class="mi kq in me b gy mn mk l ml mm">} else {</span><span id="9ca3" class="mi kq in me b gy mn mk l ml mm">  message.<strong class="me io">reply</strong>(data.default);</span><span id="e70f" class="mi kq in me b gy mn mk l ml mm">}</span><span id="1dcf" class="mi kq in me b gy mn mk l ml mm">});</span><span id="0bba" class="mi kq in me b gy mn mk l ml mm">client.<strong class="me io">initialize</strong>();</span></pre><p id="9dc9" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">→在代码中打开终端并运行。将生成二维码，如下图所示:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="4cd4" class="mi kq in me b gy mj mk l ml mm">nodemon server.js</span></pre><figure class="lz ma mb mc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mp"><img src="../Images/7c06a845113a5c62034d1359f26bc834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gU_blxv_ollWop7ktoBS-A.png"/></div></div></figure><p id="66e5" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">→我们需要从WhatsApp mobile 应用程序获取来自WhatsAPPWeb的QR。</p><p id="ce38" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">→一旦<strong class="jt io"> node.js服务器运行</strong>并扫描<strong class="jt io">二维码</strong>，所有的WhatsApp消息都可以在终端读取<strong class="jt io"/></p><figure class="lz ma mb mc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mp"><img src="../Images/2314b98ffc80e95e43876fe8fa1bcd63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FjhwEFhk-yGhwSK08tfWKg.png"/></div></div></figure><p id="2dd4" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">→在代码中，我们设置了自动回复数据。我们在下面设置了所有可能的自动回复，如果阅读了特定的邮件，就会触发自动回复😄</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="7445" class="mi kq in me b gy mj mk l ml mm">var data = [</span><span id="d511" class="mi kq in me b gy mn mk l ml mm">{ id: 1, received: 'Hello', reply: 'Hi'},</span><span id="0172" class="mi kq in me b gy mn mk l ml mm">{ id: 2, received: 'Sorry', reply: 'No problem'},</span><span id="1c6f" class="mi kq in me b gy mn mk l ml mm">{ id: 3, received: 'Can we have a call?', reply: 'Please leave a voicemail. Let us connect in an hour. Kind Reards, Amir Mustafa'},</span><span id="6ced" class="mi kq in me b gy mn mk l ml mm">{ default: 'Please leave a voicemail. Let us connect in an hour. Kind Reards, Amir Mustafa' }</span><span id="3b01" class="mi kq in me b gy mn mk l ml mm">];</span></pre><p id="59bd" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">→查看下面的详细视频，其中<strong class="jt io">将WhatsApp与终端</strong>连接，<strong class="jt io">读取所有消息</strong>并且<strong class="jt io">向用户发送自动回复</strong>。</p><figure class="lz ma mb mc gt jo"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="3360" class="kp kq in bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">结束语:</h1><p id="eb65" class="pw-post-body-paragraph jr js in jt b ju lp jw jx jy lq ka kb kc mw ke kf kg mx ki kj kk my km kn ko ig bi translated">在本文中，我们已经成功地将Node.js应用程序与<a class="ae ly" href="https://docs.wwebjs.dev/" rel="noopener ugc nofollow" target="_blank"> whatsapp-web.js </a>包连接起来。</p><p id="4d54" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">我们已经向给我们发消息的用户发送了<strong class="jt io">自动回复</strong>，<strong class="jt io">能够阅读来自终端的所有消息</strong>。使用这个图书馆很有趣😄。</p><p id="4257" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated">我希望你今天学到了一些有趣的东西。复制粘贴上面的代码，添加一些你的自动回复，并尝试一下。</p><div class="mz na gp gr nb nc"><a href="https://twitter.com/amir__mustafa" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd io gy z fp nh fr fs ni fu fw im bi translated">关注Amir Mustafa的JavaScript、TypeScript和AWS内容。</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">twitter.com</h3></div></div><div class="nk l"><div class="nl l nm nn no nk np jp nc"/></div></div></a></div><p id="76b7" class="pw-post-body-paragraph jr js in jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ig bi translated"><em class="mo">更多内容请看</em><a class="ae ly" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jt io"><em class="mo">plain English . io</em></strong></a></p></div></div>    
</body>
</html>