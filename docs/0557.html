<html>
<head>
<title>Vue Konva — Events, Images, and Filters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue Konva —事件、图像和过滤器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/vue-konva-events-images-and-filters-f1e2008bdf3e?source=collection_archive---------16-----------------------#2021-02-02">https://javascript.plainenglish.io/vue-konva-events-images-and-filters-f1e2008bdf3e?source=collection_archive---------16-----------------------#2021-02-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b8308e195a7b0d920c315555821f4d74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zL67dW6rwqcpZ9kg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@busedoay?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Buse Doga Ay</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d055" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">借助Vue Konva库，我们可以在Vue应用程序中更轻松地使用HTML画布。</p><p id="f6bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用Vue Konva来简化Vue应用程序中的HTML画布。</p><h1 id="3ede" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">事件</h1><p id="caa8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有了Vue Konva，我们可以轻松地聆听来自输入设备的事件。</p><p id="23ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7e6e" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;v-stage ref="stage" :config="stageSize"&gt;<br/>    &lt;v-layer ref="layer"&gt;<br/>      &lt;v-circle<br/>        @mousemove="handleMouseMove"<br/>        @mouseout="handleMouseOut"<br/>        :config="configCircle"<br/>      /&gt;<br/>      &lt;v-text<br/>        ref="text"<br/>        :config="{<br/>          x: 10,<br/>          y: 10,<br/>          fontFamily: 'Calibri',<br/>          fontSize: 24,<br/>          text: text,<br/>          fill: 'black',<br/>        }"<br/>      /&gt;<br/>    &lt;/v-layer&gt;<br/>  &lt;/v-stage&gt;<br/>&lt;/template&gt;</span><span id="070c" class="mn lc iq mj b gy ms mp l mq mr">&lt;script&gt;<br/>const width = window.innerWidth;<br/>const height = window.innerHeight;</span><span id="778c" class="mn lc iq mj b gy ms mp l mq mr">export default {<br/>  data() {<br/>    return {<br/>      stageSize: {<br/>        width: width,<br/>        height: height,<br/>      },<br/>      text: "",<br/>      configCircle: {<br/>        x: 200,<br/>        y: 200,<br/>        radius: 70,<br/>        fill: "red",<br/>        stroke: "black",<br/>        strokeWidth: 4,<br/>      },<br/>    };<br/>  },<br/>  methods: {<br/>    writeMessage(message) {<br/>      this.text = message;<br/>    },<br/>    handleMouseOut(event) {<br/>      this.writeMessage("Mouseout circle");<br/>    },<br/>    handleMouseMove(event) {<br/>      const mousePos = this.$refs.stage.getNode().getPointerPosition();<br/>      const x = mousePos.x - 190;<br/>      const y = mousePos.y - 40;<br/>      this.writeMessage(`(${x}, ${y})`);<br/>    },<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="ff2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们加了一个圈，听圈的<code class="fe mt mu mv mj b">mouseover</code>和<code class="fe mt mu mv mj b">mouseout</code>事件。</p><p id="3e25" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe mt mu mv mj b">handleMouseMove</code>方法中，我们获取<code class="fe mt mu mv mj b">v-stage</code>的ref并从中获取鼠标位置。</p><p id="482b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以用<code class="fe mt mu mv mj b">this.writeMessage</code>来设置<code class="fe mt mu mv mj b">text</code>的无功属性，这个属性用在<code class="fe mt mu mv mj b">v-text</code>组件中。</p><p id="aa7a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还使用<code class="fe mt mu mv mj b">handleMouseOut</code>方法来监听<code class="fe mt mu mv mj b">mouseout</code>事件。</p><h1 id="d90d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">形象</h1><p id="a8bd" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe mt mu mv mj b">v-image</code>组件将图像添加到画布中。</p><p id="bb17" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="6ff6" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;v-stage ref="stage" :config="stageSize"&gt;<br/>    &lt;v-layer ref="layer"&gt;<br/>      &lt;v-image<br/>        :config="{<br/>          image,<br/>        }"<br/>      /&gt;<br/>    &lt;/v-layer&gt;<br/>  &lt;/v-stage&gt;<br/>&lt;/template&gt;</span><span id="7ca9" class="mn lc iq mj b gy ms mp l mq mr">&lt;script&gt;<br/>const width = window.innerWidth;<br/>const height = window.innerHeight;</span><span id="86ce" class="mn lc iq mj b gy ms mp l mq mr">export default {<br/>  data() {<br/>    return {<br/>      stageSize: {<br/>        width,<br/>        height,<br/>      },<br/>      image: null,<br/>    };<br/>  },<br/>  created() {<br/>    const image = new window.Image();<br/>    image.src =<br/>      "https://i.picsum.photos/id/100/200/200.jpg?hmac=-Ffd_UnIv9DLflvK15Fq_1gRuN8t2wWU4UiuwAu4Rqs";<br/>    image.onload = () =&gt; {<br/>      this.image = image;<br/>    };<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="fd2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">来增加我们的形象。</p><p id="e10a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe mt mu mv mj b">stageSize</code>设置为窗口的高度和宽度。</p><p id="e3e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在<code class="fe mt mu mv mj b">created</code>钩子中创建一个<code class="fe mt mu mv mj b">Image</code>实例来加载图像。</p><p id="79cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">config</code>被设置为我们想要显示的图像。</p><h1 id="c8db" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">过滤</h1><p id="7fa0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以添加滤镜作为形状的背景。</p><p id="5449" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="759e" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;v-stage ref="stage" :config="stageSize"&gt;<br/>    &lt;v-layer ref="layer"&gt;<br/>      &lt;v-circle<br/>        ref="circle"<br/>        <a class="ae kc" href="http://twitter.com/mousemove" rel="noopener ugc nofollow" target="_blank">@mousemove</a>="handleMouseMove"<br/>        :config="{<br/>          filters,<br/>          noise: 1,<br/>          x: 40,<br/>          y: 40,<br/>          width: 50,<br/>          height: 50,<br/>          fill: color,<br/>          shadowBlur: 10,<br/>        }"<br/>      /&gt;<br/>    &lt;/v-layer&gt;<br/>  &lt;/v-stage&gt;<br/>&lt;/template&gt;</span><span id="705a" class="mn lc iq mj b gy ms mp l mq mr">&lt;script&gt;<br/>const width = window.innerWidth;<br/>const height = window.innerHeight;<br/>import Konva from "konva";</span><span id="30d2" class="mn lc iq mj b gy ms mp l mq mr">export default {<br/>  data() {<br/>    return {<br/>      stageSize: {<br/>        width: width,<br/>        height: height,<br/>      },<br/>      color: "green",<br/>      filters: [Konva.Filters.Noise],<br/>    };<br/>  },<br/>  methods: {<br/>    handleMouseMove() {<br/>      this.color = Konva.Util.getRandomColor();<br/>    },<br/>  },<br/>  mounted() {<br/>    const circleNode = this.$refs.circle.getNode();<br/>    circleNode.cache();<br/>    circleNode.getLayer().batchDraw();<br/>  },<br/>  updated() {<br/>    const circleNode = this.$refs.circle.getNode();<br/>    circleNode.cache();<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="768f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加了我们的<code class="fe mt mu mv mj b">v-circle</code>组件。</p><p id="d0eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">filters</code> reactive属性拥有我们想要设置的过滤器数组。</p><p id="489e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们通过将<code class="fe mt mu mv mj b">handleMouseMove</code>方法设置为<code class="fe mt mu mv mj b">mousemove</code>事件处理程序来监听它上面的<code class="fe mt mu mv mj b">mousemove</code>事件。</p><p id="372a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe mt mu mv mj b">handleMouseMove</code>方法中，我们将<code class="fe mt mu mv mj b">color</code>反应属性设置为随机颜色。</p><p id="f1a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将圆圈缓存在<code class="fe mt mu mv mj b">updated</code>钩子中。</p><p id="2b08" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并在<code class="fe mt mu mv mj b">mounted</code>钩上画圆。</p><p id="3ac4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，当我们将鼠标移到圆圈上时，我们会看到滤镜的颜色发生了变化。</p><h1 id="d5e9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="2afc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过Vue Konva收听事件，并轻松添加图像和滤镜。</p></div></div>    
</body>
</html>