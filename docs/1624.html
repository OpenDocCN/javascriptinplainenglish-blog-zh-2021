<html>
<head>
<title>How to Reload State from Props in a Component Created with React Hooks?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在用React钩子创建的组件中从Props重新加载状态？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-reload-state-from-props-in-a-component-created-with-react-hooks-b882b2e54c2c?source=collection_archive---------9-----------------------#2021-04-07">https://javascript.plainenglish.io/how-to-reload-state-from-props-in-a-component-created-with-react-hooks-b882b2e54c2c?source=collection_archive---------9-----------------------#2021-04-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d91702a0af4609b1572599b64ed769f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vL3_ZTOn3HCGsaAE"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@asiaculturecenter?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">ASIA CULTURECENTER</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="53d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有时，我们必须根据传入的属性值重新加载一个状态。</p><p id="3a23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何在使用React钩子创建的组件中从props重新加载状态。</p><h1 id="e103" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">观看道具随着使用效果而变化</h1><p id="069a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">挂钩让我们观察反应值的变化，包括道具。</p><p id="9337" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们可以使用<code class="fe me mf mg mh b">useEffect</code>钩子来观察属性值的变化，并相应地更新我们的状态。</p><p id="5310" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7300" class="mq lc iq mh b gy mr ms l mt mu">import { useEffect, useState } from "react";</span><span id="5fea" class="mq lc iq mh b gy mv ms l mt mu">const Counter = ({ count }) =&gt; {<br/>  const [countState, setCountState] = useState(count);</span><span id="201c" class="mq lc iq mh b gy mv ms l mt mu">  useEffect(() =&gt; {<br/>    setCountState(count);<br/>  }, [count]);</span><span id="9efe" class="mq lc iq mh b gy mv ms l mt mu">  return &lt;p&gt;{countState}&lt;/p&gt;;<br/>};</span><span id="54fb" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  const [count, setCount] = useState(0);</span><span id="8512" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;button onClick={() =&gt; setCount((c) =&gt; c + 1)}&gt;increment&lt;/button&gt;<br/>      &lt;Counter count={count} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="b089" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有带<code class="fe me mf mg mh b">count</code>道具的<code class="fe me mf mg mh b">Counter</code>组件。</p><p id="9e94" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在组件内部，我们将<code class="fe me mf mg mh b">countState</code>状态设置为<code class="fe me mf mg mh b">count</code>的值作为初始值。</p><p id="eacc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们用回调函数调用<code class="fe me mf mg mh b">useEffect</code>钩子，回调函数用<code class="fe me mf mg mh b">count</code>调用<code class="fe me mf mg mh b">setCountState</code>，将<code class="fe me mf mg mh b">countState</code>的值设置为与<code class="fe me mf mg mh b">count</code>的值相同。</p><p id="c6e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">useEffect</code>的第二个参数中，我们传入一个带有<code class="fe me mf mg mh b">count</code>属性的数组来观察<code class="fe me mf mg mh b">count</code>属性的变化，并触发要调用的<code class="fe me mf mg mh b">useEffect</code>回调。</p><p id="274c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">App</code>组件中，我们将<code class="fe me mf mg mh b">count</code>状态初始设置为0。</p><p id="3eaa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个按钮，它调用一个函数，这个函数调用<code class="fe me mf mg mh b">setCount</code>来更新<code class="fe me mf mg mh b">count</code>状态，方法是用我们传入的回调将它加1。</p><p id="09a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回调获取当前值<code class="fe me mf mg mh b">count</code>作为参数，并返回增加了1的新值。</p><p id="216a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在按钮下方，我们显示了<code class="fe me mf mg mh b">Counter</code>组件，我们通过将<code class="fe me mf mg mh b">count</code>道具设置为<code class="fe me mf mg mh b">count</code>状态作为其值来传入该组件。</p><p id="dbc0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，当我们点击增量按钮时，我们看到通过<code class="fe me mf mg mh b">count</code>道具渲染的最新<code class="fe me mf mg mh b">countState</code>。</p><h1 id="cf0f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="3703" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以根据道具的变化来更新状态，方法是用<code class="fe me mf mg mh b">useEffect</code>钩子观察道具，然后调用状态改变函数，根据<code class="fe me mf mg mh b">useEffect</code>回调中的道具值来更新状态。</p><p id="3b8e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mw">更多内容请看</em><a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mw">plain English . io</em></strong></a></p></div></div>    
</body>
</html>