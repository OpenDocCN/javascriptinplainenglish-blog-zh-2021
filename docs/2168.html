<html>
<head>
<title>2 Ways to Trigger the onPaste Event with Testing-Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用测试库触发onPaste事件的两种方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/2-ways-to-trigger-the-onpaste-event-with-testing-library-1502c5fdb9e?source=collection_archive---------5-----------------------#2021-05-07">https://javascript.plainenglish.io/2-ways-to-trigger-the-onpaste-event-with-testing-library-1502c5fdb9e?source=collection_archive---------5-----------------------#2021-05-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1dbf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用粘贴事件测试组件不再麻烦。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1cf80d1f3865b08e8963dded2f60f093.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-ks055YlV0Ip8Pvw"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@matnapo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mat Napo</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3ed8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您正在构建一个使用粘贴事件来触发某个事件的组件，您可能还希望构建测试来确保它按照预期的方式并且始终如一地工作。</p><p id="09af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我遇到了一些测试库不触发粘贴操作的问题，或者如果它触发了，它触发了类似<code class="fe ls lt lu lv b">ClipboardEvent is not defined</code>和<code class="fe ls lt lu lv b">TypeError: Cannot read property 'getData' of undefined</code>的错误，虽然答案分散在互联网上，但没有一个地方可以将它们集中在一起。所以我们在这里。</p><p id="5ac8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是两个如何使用testing-library和React测试粘贴事件的工作示例，它们都触发粘贴事件并能够返回粘贴的文本。这些例子都是用Typescript编写的，所以如果你是一个普通的Javascript爱好者，只需去掉这些类型，你就可以开始了。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lw lx l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">A simple component. When onPaste is triggered, it calls this.pasteEvent which extracts the data (the content you pasted) and passes it back to the paste property (so it can be used outside the component — e.g in a test).</figcaption></figure><p id="92ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可能值得注意的是，第一个测试确实在Typescript的第20行触发了一个<code class="fe ls lt lu lv b">Property 'clipboardData' does not exist on type 'Event'</code>错误。我试图通过将类型改为<code class="fe ls lt lu lv b">const clipboardEvent:ClipboardEvent = new ClipboardEvent(...)</code>来解决这个问题，但这导致了错误<code class="fe ls lt lu lv b">Cannot assign to 'clipboardData' because it is a read-only property</code>。因此，如果您正在使用Typescript，并且不希望出现错误，就使用第二个选项。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lw lx l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Two examples (you only need one) showing how we render the paste component, trigger the on paste event and then test that it calls the paste event and passes the content back.</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ly"><img src="../Images/8a444d536618490a74b44b6e5a5c22c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*onDfpNsmEn2iCCMo2RTCDQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The proof in the pudding — shows both tests passing successfully</figcaption></figure><p id="4fc0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您花时间阅读本文。希望这是有帮助的。</p><p id="1529" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">—大卫</p><p id="2651" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="lz">高级前端开发者@</em><a class="ae kv" href="https://tripactions.com/" rel="noopener ugc nofollow" target="_blank"><em class="lz">TripActions</em></a><em class="lz">(通常是</em> <a class="ae kv" href="https://grnh.se/cbeb241d1" rel="noopener ugc nofollow" target="_blank"> <em class="lz">招聘</em> </a> <em class="lz">！)</em></p><p id="dee4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="lz">更多内容请看</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="lz">plain English . io</em></a></p></div></div>    
</body>
</html>