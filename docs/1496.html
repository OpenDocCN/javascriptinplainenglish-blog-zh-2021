<html>
<head>
<title>How the React useState Hook Works in TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React useState挂钩在TypeScript中如何工作</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-the-react-usestate-hook-works-in-typescript-418a68ca22a0?source=collection_archive---------11-----------------------#2021-03-30">https://javascript.plainenglish.io/how-the-react-usestate-hook-works-in-typescript-418a68ca22a0?source=collection_archive---------11-----------------------#2021-03-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="0b02" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">了解如何通过使用TypeScript进行自动完成和错误捕获来充分利用useState</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi kc"><img src="../Images/8d7e78852be7c43f9c58f7d9076f6642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*ReKIMaRVo5enmCE4Jp9PgA.png"/></div></figure><p id="d902" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">我觉得TypeScript真正释放了React钩子的潜力。使用带有React钩子的TypeScript感觉很好。它开启了高度精确的自动补全功能，以及在错误发生前捕捉错误的能力。我们将通过一些例子来了解React钩子和TypeScript是如何完美匹配的。</p></div><div class="ab cl lg lh hr li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ig ih ii ij ik"><h1 id="eeec" class="ln lo in bd lp lq lr ls lt lu lv lw lx jt ly ju lz jw ma jx mb jz mc ka md me bi translated">我们开始吧</h1><p id="b70f" class="pw-post-body-paragraph kk kl in km b kn mf jo kp kq mg jr ks kt mh kv kw kx mi kz la lb mj ld le lf ig bi translated">在我们进入这些例子之前，我想更详细地了解一下useState钩子如何与TypeScript一起工作(可以说是它的来龙去脉)。</p><p id="5eb2" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">TypeScript总是试图推断变量的类型，这对我们来说真是个好消息。基本上这意味着我们可以像在JavaScript中一样使用useState钩子。当有可能出现多种类型时，事情就会发生变化。例如，如果有一个变量可能是未定义的或者是T2字符串。在这种情况下，TypeScript将需要一点帮助。这就是TypeScript泛型发挥作用的地方，也是在TypeScript中使用useState钩子的关键。</p></div><div class="ab cl lg lh hr li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ig ih ii ij ik"><h1 id="b60f" class="ln lo in bd lp lq lr ls lt lu lv lw lx jt ly ju lz jw ma jx mb jz mc ka md me bi translated">是时候举些例子了</h1><p id="7f14" class="pw-post-body-paragraph kk kl in km b kn mf jo kp kq mg jr ks kt mh kv kw kx mi kz la lb mj ld le lf ig bi translated">如果您愿意，可以通过运行以下命令来遵循这些示例。我只是要替换掉<strong class="km io"> App.tsx </strong>文件中的内容。现在让我们来看例子。</p><pre class="kd ke kf kg gt ml mm mn mo aw mp bi"><span id="219d" class="mq lo in mm b gy mr ms l mt mu">npx create-react-app demo-app --template typescript</span></pre><h2 id="8a95" class="mq lo in bd lp mv mw dn lt mx my dp lx kt mz na lz kx nb nc mb lb nd ne md nf bi translated">示例1:带有类型推断的useState挂钩</h2><p id="d10f" class="pw-post-body-paragraph kk kl in km b kn mf jo kp kq mg jr ks kt mh kv kw kx mi kz la lb mj ld le lf ig bi translated">就像我上面说的，这种情况经常发生，在这种情况下，代码看起来和JavaScript代码一样。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="f2ff" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">你会注意到，在上面的例子中，这看起来像完全正常的JavaScript React代码，这是因为它是。TypeScript将推断出放置在useState函数中的任何内容的类型。在这种情况下，它是一个<em class="mk">字符串</em>，但是如果我将一个<em class="mk">布尔值</em>放入useState中，那么推断出的类型将是一个<em class="mk">布尔值</em>。</p><h2 id="f71d" class="mq lo in bd lp mv mw dn lt mx my dp lx kt mz na lz kx nb nc mb lb nd ne md nf bi translated">示例2:不带类型推断的useState挂钩</h2><p id="32aa" class="pw-post-body-paragraph kk kl in km b kn mf jo kp kq mg jr ks kt mh kv kw kx mi kz la lb mj ld le lf ig bi translated">有些情况下，TypeScript不能推断出正确的类型，这就是我将在下面演示的内容。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="b8c7" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">就像我上面说的，TypeScript会推断出useState函数中的类型。在这种情况下，我没有传递任何东西，所以它将推断未定义。这显然是一个问题，因为在useEffect钩子中，我们将greetingMessage的状态设置为一个字符串。输入TypeScript泛型。你会在第4 行的<strong class="km io">上看到，在useState函数初始化之前，我使用了一个<strong class="km io"> &lt; &gt; </strong>语法。这明确地告诉TypeScript，greetingMessage的类型可以是<em class="mk">未定义的</em>或<em class="mk">字符串</em>，允许我们将greeting message的类型设置为<em class="mk">字符串</em>，而不会扰乱TypeScript编译器。</strong></p><p id="3c78" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">下面是一个例子，如果我试图在不使用TypeScript泛型的情况下将问候消息的类型设置为一个<em class="mk">字符串</em>会发生什么。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/ae280d3b8b2f780ad127b91f87332289.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*n2IOz-BOyZZ8Ga9VbFyAPg.gif"/></div></figure><h2 id="723a" class="mq lo in bd lp mv mw dn lt mx my dp lx kt mz na lz kx nb nc mb lb nd ne md nf bi translated">示例3:带有接口/类型的useState挂钩</h2><p id="d75f" class="pw-post-body-paragraph kk kl in km b kn mf jo kp kq mg jr ks kt mh kv kw kx mi kz la lb mj ld le lf ig bi translated">让我们看看如何在TypeScript中将复杂类型(例如todo列表的类型)与useState挂钩一起使用。我们将看到，设置与上面的示例相同。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="a600" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">我们告诉TypeScript，are todoList的类型是一个类型为<em class="mk"> Todo </em>的数组，然后简单地将一个空数组传递给useState。它将推断该类型是一个类型为<em class="mk"> Todo </em>的空数组。</p><h1 id="7b52" class="ln lo in bd lp lq nj ls lt lu nk lw lx jt nl ju lz jw nm jx mb jz nn ka md me bi translated">结论</h1><p id="119d" class="pw-post-body-paragraph kk kl in km b kn mf jo kp kq mg jr ks kt mh kv kw kx mi kz la lb mj ld le lf ig bi translated">这就是事情的全部。在TypeScript中使用useState就像确保我们可以推断类型一样简单，当我们不能推断类型时，我们就在泛型中指定类型。</p><p id="58be" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><em class="mk">更多内容请看</em><a class="ae no" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="km io"><em class="mk">plain English . io</em></strong></a></p></div></div>    
</body>
</html>