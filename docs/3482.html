<html>
<head>
<title>Create a JavaScript Flow Map in 4 Easy Steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过4个简单的步骤创建一个JavaScript流程图</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-a-javascript-flow-map-in-4-easy-steps-424f9a80b628?source=collection_archive---------22-----------------------#2021-07-13">https://javascript.plainenglish.io/create-a-javascript-flow-map-in-4-easy-steps-424f9a80b628?source=collection_archive---------22-----------------------#2021-07-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="75dd" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">演示如何创建交互式JavaScript流图的分步教程。通过向美国移民的可视化数据来说明。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/4430b7e5a72d7826ada1d56950aab397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n3rJUbwHI5ZEPZQs9JSh-w.png"/></div></div></figure><p id="5f9a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">使用JavaScript为Web创建交互式流程图似乎很复杂。但其实不是！这个简单易懂的教程将向你展示如何不用太多的努力就能构建漂亮的JS流程图。</p><p id="e803" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在疫情的困难时期，人们对世界各地的移民身份感到困惑和担忧。我决定看看美国的移民数据，美国的移民比世界上任何其他国家都多。在这里，我探讨了这些移民来自哪里，并代表了2019年向美国贡献最多移民的前15个国家。</p><p id="8948" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">流动地图似乎是展示移民从不同国家流入美国的最佳方式。在继续之前，让我给你一个关于流程图及其用途的简单想法。</p><h1 id="733e" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">什么是流程图？</h1><p id="c643" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated"><a class="ae mh" href="https://www.anychart.com/chartopedia/chart-type/flow-map/" rel="noopener ugc nofollow" target="_blank">流程图</a>从地理上可视化对象的移动，例如，从一个位置到另一个位置的人员或货物及其数量。</p><p id="71b3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">流向图是一种连接图，它通过直线或曲线连接地图上的点，并带有指示流向的箭头或标记来绘制。一般来说，流量的大小用线条的粗细来表示。</p><p id="91e1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这些地图中连接器的起点和终点是由纬度和经度参数定义的，因此有必要为每个连接器设置这些参数。注意，应该首先定义点的纬度，然后定义每个点的经度。</p><p id="e215" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">例如，<a class="ae mh" href="https://codepen.io/shacheeswadia/pen/abJJxvx" rel="noopener ugc nofollow" target="_blank">这是</a>我将在本教程结束时创建的流程图。[现在也可以在<a class="ae mh" href="https://playground.anychart.com/a8W1R42d/" rel="noopener ugc nofollow" target="_blank"> AnyChart游乐场</a>上找到。]</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mi"><img src="../Images/c99ce74e89cb1fadbb10ab225a07d090.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*my9sTcsQ0tGTsLDR.png"/></div></div></figure><h1 id="0ae7" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">使用JavaScript创建流程图</h1><p id="5cd7" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">有很多好的<a class="ae mh" href="https://en.wikipedia.org/wiki/Comparison_of_JavaScript_charting_libraries" rel="noopener ugc nofollow" target="_blank"> JavaScript图表库</a>可以用来创建引人注目的数据可视化。它们中的许多都提供了构建地图的功能，并且各有所长。因此您可以使用最适合您的项目需求的库。</p><p id="0f0f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在本教程中，我使用的是<a class="ae mh" href="https://www.anychart.com/" rel="noopener ugc nofollow" target="_blank"> AnyChart </a>。它看起来最适合在这里用现成的流程图选项和深入的<a class="ae mh" href="https://docs.anychart.com/" rel="noopener ugc nofollow" target="_blank">文档</a>来理解流程。</p><p id="339c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">流程图比条形图或饼图等基本图表稍微复杂一些，但我会带您浏览代码行，使其更容易理解。一些关于HTML和JavaScript的背景知识会帮助你更快地理解，但这并不太难。看看如何通过4个简单的步骤创建一个漂亮的交互式JavaScript流图。</p><h2 id="75e3" class="mj ll in bd lm mk ml dn lq mm mn dp lu kx mo mp lw lb mq mr ly lf ms mt ma mu bi translated">1.创建HTML页面</h2><p id="135f" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">第一步是创建一个空白的HTML页面来保存交互流程图。向该页面添加一个具有唯一id的<code class="fe mv mw mx my b">div</code>元素，稍后将引用该元素。</p><p id="8cdf" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我将div的宽度和高度设置为100%,以便地图显示在整个屏幕上。这可以根据需求和偏好进行修改。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="806a" class="mj ll in my b gy nd ne l nf ng">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;JavaScript Flow Map&lt;/title&gt;<br/>    &lt;style type="text/css"&gt;      <br/>      html, body, #container { <br/>        width: 100%; height: 100%; margin: 0; padding: 0; <br/>      } <br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="4761" class="mj ll in bd lm mk ml dn lq mm mn dp lu kx mo mp lw lb mq mr ly lf ms mt ma mu bi translated">2.添加必要的脚本</h2><p id="f27f" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">要使用图表库来构建数据可视化，您需要链接您正在使用的库的适当JS脚本。所有这些脚本文件都包含在HTML页面中。</p><p id="36cb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为了创建JS流程图，我将添加AnyChart的'<a class="ae mh" href="https://docs.anychart.com/Quick_Start/Modules#core" rel="noopener ugc nofollow" target="_blank"> core </a>和'<a class="ae mh" href="https://docs.anychart.com/Quick_Start/Modules#geo_maps" rel="noopener ugc nofollow" target="_blank"> geo maps </a>模块。</p><p id="cc2c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">由于地图是整个世界的，我从图书馆的地图收藏中链接了包含世界地理数据的文件，这些地图也可以在图书馆的<a class="ae mh" href="https://cdn.anychart.com/" rel="noopener ugc nofollow" target="_blank"> CDN </a>上找到。</p><p id="79f2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">此外，我将使用另一个JavaScript库— <a class="ae mh" href="http://proj4js.org/" rel="noopener ugc nofollow" target="_blank"> Proj4js </a> —简而言之，它负责绘制各个地理区域的坐标。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="ddc3" class="mj ll in my b gy nd ne l nf ng">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;JavaScript Flow Map&lt;/title&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-map.min.js"&gt;&lt;/script&gt;</span><span id="0cfd" class="mj ll in my b gy nh ne l nf ng">    &lt;script src="https://cdn.anychart.com/geodata/latest/custom/world/world.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.15/proj4.js"&gt;&lt;/script&gt;</span><span id="b803" class="mj ll in my b gy nh ne l nf ng">    &lt;style type="text/css"&gt;      <br/>      html, body, #container { <br/>        width: 100%; height: 100%; margin: 0; padding: 0; <br/>      } <br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;  <br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>    &lt;script&gt;<br/>      <strong class="my io"><em class="ni">// All the code for the JS flow map will come here</em></strong><br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="4673" class="mj ll in bd lm mk ml dn lq mm mn dp lu kx mo mp lw lb mq mr ly lf ms mt ma mu bi translated">3.连接数据</h2><p id="6cd1" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">对于地图，数据需要显示纬度和经度坐标以及其他信息。我通过整理来自维基百科的移民信息并添加来自一个名为Latlong的网站的坐标创建了这个数据集。</p><p id="b080" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">对于流程图，我需要源国家和目的国家的经纬度。这里，所有数据点的目的地国家都是美国。要查看数据集的外观，您可以在这里找到文件<a class="ae mh" href="https://gist.githubusercontent.com/shacheeswadia/a20ba5b62cef306ccc1a8e8857e5316a/raw/0337b16fa8dc4de97263bc0a4ededf935a529c35/migration-data.json" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="a40f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为了加载数据文件，我将在HTML页面的<code class="fe mv mw mx my b">&lt;head&gt;</code>部分包含AnyChart的<a class="ae mh" href="https://docs.anychart.com/Quick_Start/Modules#data_adapter" rel="noopener ugc nofollow" target="_blank">数据适配器模块</a>[并利用HTML页面主体中<code class="fe mv mw mx my b">&lt;script&gt;</code>标签内的<code class="fe mv mw mx my b">loadJsonFile()</code>方法加载带有用于流图可视化的JSON数据的文件]。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="e209" class="mj ll in my b gy nd ne l nf ng">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;JavaScript Flow Map&lt;/title&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-map.min.js"&gt;&lt;/script&gt;</span><span id="fdfa" class="mj ll in my b gy nh ne l nf ng">    &lt;script src="https://cdn.anychart.com/geodata/latest/custom/world/world.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.15/proj4.js"&gt;&lt;/script&gt;</span><span id="08a8" class="mj ll in my b gy nh ne l nf ng">    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-data-adapter.min.js"&gt;&lt;/script&gt;</span><span id="c3e7" class="mj ll in my b gy nh ne l nf ng">    &lt;style type="text/css"&gt;      <br/>      html, body, #container { <br/>        width: 100%; height: 100%; margin: 0; padding: 0; <br/>      } <br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;  <br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>    &lt;script&gt;</span><span id="a152" class="mj ll in my b gy nh ne l nf ng">anychart.data.loadJsonFile('https://gist.githubusercontent.com/shacheeswadia/a20ba5b62cef306ccc1a8e8857e5316a/raw/0337b16fa8dc4de97263bc0a4ededf935a529c35/migration-data.json', function (data) {</span><span id="d139" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">  // The JS flow map's code will come here</em></strong></span><span id="3dbd" class="mj ll in my b gy nh ne l nf ng">});</span><span id="605f" class="mj ll in my b gy nh ne l nf ng">    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="133b" class="mj ll in bd lm mk ml dn lq mm mn dp lu kx mo mp lw lb mq mr ly lf ms mt ma mu bi translated">4.写JS代码画流程图</h2><p id="934c" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">首先，我将把所有代码放在<code class="fe mv mw mx my b">anychart.onDocumentReady()</code>函数中，这将确保在执行任何操作之前页面被完全加载。接下来，我将使用<code class="fe mv mw mx my b">anychart.data.loadJsonFile()</code>函数加载数据。</p><p id="5dfa" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，我使用连接器函数创建流地图，因为这是一种连接器地图，然后设置地理数据和设置，以确保世界上的所有区域都清晰可见。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="51b2" class="mj ll in my b gy nd ne l nf ng">anychart.onDocumentReady(function () {</span><span id="0ae9" class="mj ll in my b gy nh ne l nf ng">anychart.data.loadJsonFile('https://gist.githubusercontent.com/shacheeswadia/a20ba5b62cef306ccc1a8e8857e5316a/raw/0337b16fa8dc4de97263bc0a4ededf935a529c35/migration-data.json', function (data) {</span><span id="be16" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">  // сreate a connector map chart instance<br/></em></strong>  var map = anychart.connector();</span><span id="9ac9" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">  // include the world map geodata<br/></em></strong>  map.geoData('anychart.maps.world');</span><span id="a3c7" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">  // darken all regions<br/></em></strong>  map<br/>   .unboundRegions()<br/>   .enabled(true)<br/>   .fill('#E1E1E1')<br/>   .stroke('#D2D2D2');</span><span id="ef74" class="mj ll in my b gy nh ne l nf ng">})</span><span id="d2d3" class="mj ll in my b gy nh ne l nf ng">});</span></pre><p id="96ed" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我给图表添加了一个标题，并允许重叠，这样所有的数据点及其标签都可以在地图上看到，即使它们重叠了。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="fa12" class="mj ll in my b gy nd ne l nf ng"><strong class="my io"><em class="ni">// set the map chart title<br/></em></strong>map<br/>  .title('Migrations to the USA from the top 15 countries');</span><span id="eec6" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">// display all labels even if there is an overlap<br/></em></strong>map <br/>  .overlapMode("allow-overlap");</span></pre><p id="8576" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在是创建代表各种连接的连接器系列的主要部分。</p><p id="9211" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为此，我创建了一个以数据为参数的助手函数。在函数中，我创建了将形成连接线的序列，并在100%位置添加了箭头标记，这是目的地，因为我们的流是从各个来源国到目的地国—美国。</p><p id="c187" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，我添加显示来源国家名称的标签。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="25a4" class="mj ll in my b gy nd ne l nf ng"><strong class="my io"><em class="ni">// a helper function to create the series<br/>// that will form the connector lines</em></strong><br/>var createSeries = function (data) {</span><span id="4bb5" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">  // create and customize the connector series</em></strong><br/>  var connectorSeries = map<br/>    .connector(data);</span><span id="19bd" class="mj ll in my b gy nh ne l nf ng">  connectorSeries<br/>    .markers()<br/>    .position('100%')<br/>    .size(10);</span><span id="ab52" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">  // set the labels for the source countries<br/></em></strong>  connectorSeries<br/>    .labels()<br/>    .enabled(true)<br/>    .format(function () {<br/>      return this.getData('from');<br/>    });</span><span id="57b5" class="mj ll in my b gy nh ne l nf ng">};</span></pre><p id="0cb4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我现在设置数据，并调用我用该数据集作为参数创建的函数。最后一步是设置容器来引用之前添加的div并绘制地图。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="0bdb" class="mj ll in my b gy nd ne l nf ng"><strong class="my io"><em class="ni">// create a dataset from the data<br/></em></strong>var dataSet = anychart.data.set(data).mapAs();</span><span id="003d" class="mj ll in my b gy nh ne l nf ng">createSeries(dataSet);</span><span id="daa4" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">// set the container<br/></em></strong>map.container('container');</span><span id="61f9" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">// draw the map<br/></em></strong>map.draw();</span></pre><p id="6663" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">瞧啊！一个漂亮的、功能性的、基于JavaScript的流程图就完成了！创建这样一个交互式数据可视化并不困难，不是吗？</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nj"><img src="../Images/a44e474e3f4e378f90c1f8e400a24901.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PuvPcKpKGb6feoLDLrINPw.png"/></div></div></figure><blockquote class="nk nl nm"><p id="11c0" class="ko kp ni kq b kr ks jo kt ku kv jr kw nn ky kz la no lc ld le np lg lh li lj ig bi translated"><strong class="kq io"> <em class="in">看看这个初始版本上的</em></strong><a class="ae mh" href="https://codepen.io/shacheeswadia/pen/gOmwpXP" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="in">CodePen</em></strong></a><strong class="kq io"><em class="in">【或者</em> </strong> <a class="ae mh" href="https://playground.anychart.com/yR1yOY6X/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="in">游乐场</em> </strong> </a> <strong class="kq io"> <em class="in">】。</em> </strong></p></blockquote><h1 id="cba9" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">定制JS流程图</h1><p id="b6a9" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">刚刚使用JavaScript构建的现有流程图很好地展示了大多数移民来自哪里。但是没有显示每个国家的移民数量。因此，我将自定义地图来显示这一点，并使用一些额外的代码使地图更具洞察力。我还会改进视觉审美，做一些其他的小改动。</p><h2 id="92b9" class="mj ll in bd lm mk ml dn lq mm mn dp lu kx mo mp lw lb mq mr ly lf ms mt ma mu bi translated">A.设置连接器的颜色和大小以及图例</h2><p id="adc8" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">我决定用连接线的粗细和调色板来表示从每个国家流向美国的移民数量。没有必要两者都做，因为任何一个指标都可以使用，但我喜欢当两者都存在时，洞察力更容易阅读。</p><p id="df61" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我修改了助手函数，使其包含名称和颜色参数以及数据。我将使用名称来标识连接器系列并管理线条的粗细，而颜色变量将指示我将在为每个系列调用函数时指定的颜色。</p><p id="2a57" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，我将名称和颜色添加到连接器系列，并添加悬停在线条和标记上的设置。</p><p id="cc5d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来，我根据系列的名称设置线条的粗细。这种命名是基于迁移者的数量，一旦函数被调用，这将变得更加清楚。</p><p id="e41a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">因为连接器系列根据数据有不同的颜色，所以我添加了一个颜色图例。</p><p id="15dd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果这一切听起来很复杂，不要不知所措。一旦你看了代码和注释以及每一个片段，它会更有意义。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="1ad5" class="mj ll in my b gy nd ne l nf ng"><strong class="my io"><em class="ni">// a helper function to create the series<br/>// that will form the connector lines</em></strong><br/>var createSeries = function (name, data, color) {</span><span id="7a82" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">  // create and customize the connector series<br/></em></strong>  var connectorSeries = map<br/>    .connector(data)<br/>    .name(name)<br/>    .fill(color)<br/>    .stroke({<br/>      color: color,<br/>      thickness: 2<br/>    });<br/>  <br/><strong class="my io"><em class="ni">  // change the coloring of the connector line in the hovered state<br/></em></strong>  connectorSeries<br/>    .hovered()<br/>    .stroke('1.5 #212121')<br/>    .fill('#212121');</span><span id="94f4" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">  // configure the arrow marker<br/></em></strong>  connectorSeries<br/>    .markers()<br/>    .position('100%')<br/>    .fill(color)<br/>    .stroke({<br/>      color: color<br/>    })<br/>    .size(8);</span><span id="1e05" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">  // configure the arrow marker in the hovered state<br/></em></strong>  connectorSeries<br/>    .hovered()<br/>    .markers()<br/>    .position('100%')<br/>    .size(10)<br/>    .fill('#212121')<br/>    .stroke('2 #455a64');</span><span id="5d49" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">  // set the labels for the source countries<br/></em></strong>  connectorSeries<br/>    .labels()<br/>    .enabled(true)<br/>    .format(function () {<br/>      return this.getData('from');<br/>    });</span><span id="08d2" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">  // set the thickness of the connector line based on the series<br/></em></strong>  if (name === 'More than 50,000') {<br/>    connectorSeries.startSize(5).endSize(2);<br/>  } else if (name === '40,000 to 50,000') {<br/>    connectorSeries.startSize(3.5).endSize(1.5);<br/>  } else if (name === '20,000 to 40,000') {<br/>    connectorSeries.startSize(3).endSize(1);<br/>  } else if (name === '16,000 to 20,000') {<br/>    connectorSeries.startSize(2).endSize(0.5);<br/>  } else {<br/>    connectorSeries.startSize(1).endSize(0);<br/>  }</span><span id="9d92" class="mj ll in my b gy nh ne l nf ng"><strong class="my io"><em class="ni">  // configure the settings for the legend items<br/></em></strong>  connectorSeries<br/>    .legendItem()<br/>    .iconType('square')<br/>    .iconFill(color)<br/>    .iconStroke(false);</span><span id="5cac" class="mj ll in my b gy nh ne l nf ng">};</span></pre><p id="32f0" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在继续之前，我将创建另一个助手函数，它是一个过滤函数，用于分离每个系列中的数据。我将在代码的最后添加这个函数。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="0cfe" class="mj ll in my b gy nd ne l nf ng"><strong class="my io"><em class="ni">// a helper function to bind the data field to the local var.<br/></em></strong>function filterFunction(val1, val2) {<br/>  if (val2) {<br/>    return function (fieldVal) {<br/>      return val1 &lt;= fieldVal &amp;&amp; fieldVal &lt; val2;<br/>    };<br/>  }<br/>  return function (fieldVal) {<br/>    return val1 &lt;= fieldVal;<br/>  };<br/>}</span></pre><p id="33ab" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，我根据全部移民数据创建5个不同的序列，为每个序列指定一个唯一的名称，根据数据集中的合计字段为每个序列筛选数据，并将唯一的颜色值作为第三个参数。这将根据总迁移数据创建具有不同厚度和颜色的5个连接器系列组。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="f857" class="mj ll in my b gy nd ne l nf ng"><strong class="my io"><em class="ni">// create five series filtering the data<br/>// by the absolute values of the migration numbers</em></strong><br/>createSeries(<br/>  'Less than 16,000',<br/>  dataSet.filter('total', filterFunction(0, 16000)),<br/>  '#fed693'<br/>);<br/>createSeries(<br/>  '16,000 to 20,000',<br/>  dataSet.filter('total', filterFunction(16000, 20000)),<br/>  '#f5ad52'<br/>);<br/>createSeries(<br/>  '20,000 to 40,000',<br/>  dataSet.filter('total', filterFunction(20000, 40000)),<br/>  '#3fb8c5'<br/>);<br/>createSeries(<br/>  '40,000 to 50,000',<br/>   dataSet.filter('total', filterFunction(40000, 50000)),<br/>   '#1792c0'<br/>);<br/>createSeries(<br/>  'More than 50,000',<br/>  dataSet.filter('total', filterFunction(50000, 1000000)),<br/>  '#1c5eaa'<br/>);</span></pre><p id="64b7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">因为我添加了图例，所以我为地图启用了它，并为图例添加了标题。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="f641" class="mj ll in my b gy nd ne l nf ng"><strong class="my io"><em class="ni">// set up the legend for the sample<br/></em></strong>map<br/>  .legend()<br/>  .enabled(true)<br/>  .position('center')<br/>  .padding([20, 0, 20, 0])<br/>  .fontSize(10);</span><span id="e74a" class="mj ll in my b gy nh ne l nf ng">map<br/>  .legend()<br/>  .title()<br/>  .enabled(true)<br/>  .fontSize(13)<br/>  .padding([0, 0, 5, 0])<br/>  .text('Number of Migrants (in the year 2019)');</span></pre><p id="354b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">请注意，图例是交互式的。因此，您可以将鼠标悬停在图例的每个元素上，相应的系列组将突出显示。您还可以单击图例元素来添加或删除该特定系列组。这都是JS图表库的内置功能。印象深刻，对吧？</p><blockquote class="nk nl nm"><p id="4565" class="ko kp ni kq b kr ks jo kt ku kv jr kw nn ky kz la no lc ld le np lg lh li lj ig bi translated"><strong class="kq io"> <em class="in">在这里看看这个中间定制版的流程图，查看一下</em></strong><a class="ae mh" href="https://codepen.io/shacheeswadia/pen/qBrqVRe" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="in">CodePen</em></strong></a><strong class="kq io"><em class="in">【或者</em> </strong> <a class="ae mh" href="https://playground.anychart.com/3l10CsJB/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="in">游乐场</em> </strong> </a> <strong class="kq io"> <em class="in">上的全部代码。</em> </strong></p></blockquote><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nq"><img src="../Images/08688624a2ec95ff53d79fb3d328241e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C-zO6h6HYk7P-JH0yXf8yw.png"/></div></div></figure><h2 id="2d91" class="mj ll in bd lm mk ml dn lq mm mn dp lu kx mo mp lw lb mq mr ly lf ms mt ma mu bi translated">B.改进工具提示信息</h2><p id="76db" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">JavaScript流图的默认工具提示显示了源和目的地的纬度和经度。这条信息对我们没有任何用处。因此，我定制了工具提示来显示国家的名称和来自该国家的移民总数。</p><p id="53b5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我使用HTML作为工具提示，使我能够格式化文本。这使得工具提示更具信息性和吸引力。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="8916" class="mj ll in my b gy nd ne l nf ng"><strong class="my io"><em class="ni">// configure the tooltip setting for the series<br/></em></strong>connectorSeries<br/>  .tooltip()<br/>  .useHtml(true)<br/>  .format(function () {<br/>    return (<br/>      '&lt;h4 style="font-size:14px; font-weight:400; margin: 0.25rem 0;"&gt;From:&lt;b&gt; ' + this.getData('from') + '&lt;/b&gt;&lt;/h4&gt;' +<br/>      '&lt;h4 style="font-size:14px; font-weight:400; margin: 0.25rem 0;"&gt;Total Migrants::&lt;b&gt;' + this.getData('total').toLocaleString() + '&lt;/b&gt;&lt;/h4&gt;'<br/>    );<br/>  });</span></pre><h2 id="ec94" class="mj ll in bd lm mk ml dn lq mm mn dp lu kx mo mp lw lb mq mr ly lf ms mt ma mu bi translated">C.增强标题和标签</h2><p id="00c6" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">最后，我做了一些简单的修改，以增强地图的美感，并为标题添加一些见解。</p><p id="e59c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我格式化了标题，并再次使用HTML添加了一个副标题，以使文本的样式可定制。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="11b1" class="mj ll in my b gy nd ne l nf ng"><strong class="my io"><em class="ni">// set the map chart title</em></strong><br/>map<br/>  .title()<br/>  .enabled(true)<br/>  .useHtml(true)<br/>  .padding([0, 0, 40, 0])<br/>  .text(<br/>    '&lt;span style="color:#212121;"&gt;Migrations to the USA from the top 15 countries&lt;/span&gt;&lt;br/&gt;' +<br/>    '&lt;span style="font-size: 14px;"&gt;Majority of the migrants come from Mexico, Asia and South America&lt;/span&gt;'<br/>  );</span></pre><p id="d4bd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">最后，我将地图图例移到底部，并将标签颜色变暗以使它们更加突出。</p><pre class="kd ke kf kg gt mz my na nb aw nc bi"><span id="1bc9" class="mj ll in my b gy nd ne l nf ng">map<br/>  .legend()<br/>  .position('bottom')</span></pre><p id="9324" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">搞定了。一张精美的互动JS流程图，随时可以说明移民美国的数据。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nr"><img src="../Images/4c3d1ee12042a88132650647fca7747c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Y26zTAkaqFDkIjic6l3Fw.png"/></div></div></figure><blockquote class="nk nl nm"><p id="c87b" class="ko kp ni kq b kr ks jo kt ku kv jr kw nn ky kz la no lc ld le np lg lh li lj ig bi translated"><strong class="kq io"> <em class="in">最后完成版本的全部代码都在</em></strong><a class="ae mh" href="https://codepen.io/shacheeswadia/pen/abJJxvx" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="in">CodePen</em></strong></a><strong class="kq io"><em class="in">【还有</em> </strong> <a class="ae mh" href="https://playground.anychart.com/a8W1R42d/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="in">游乐场</em> </strong> </a> <strong class="kq io"> <em class="in">】</em> </strong></p></blockquote><h1 id="20bb" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">结论</h1><p id="c351" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">用JavaScript构建交互式地图可能很困难，但是使用JS图表库可以使创建这种可视化变得更加简单快捷。any chart中有许多可用的图表类型，您可以查看这里的<a class="ae mh" href="https://docs.anychart.com/Quick_Start/Supported_Charts_Types" rel="noopener ugc nofollow" target="_blank">或查看其他的</a><a class="ae mh" href="https://en.wikipedia.org/wiki/Comparison_of_JavaScript_charting_libraries" rel="noopener ugc nofollow" target="_blank"> JavaScript图表库</a>以找到更多关于它们的信息。</p><p id="c13f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我希望本教程已经揭开了为您创建流程图的神秘面纱，并让您对使用JavaScript库探索更多图表感到兴奋。无论你是本地人还是移民，家是每个人都更快乐的地方，JS图表库是图表创建更容易的地方！</p><p id="8488" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">请提出任何问题或让我知道你的任何建议。</p></div><div class="ab cl ns nt hr nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ig ih ii ij ik"><p id="6e0a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> <em class="ni">经沙奇·斯瓦迪亚许可出版。原载于</em></strong><a class="ae mh" href="https://www.codementor.io/@shacheeswadia/building-an-interactive-flow-map-in-javascript-1j7az1a58r" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="ni">code mentor</em></strong></a><strong class="kq io"><em class="ni">2021年6月28日标题为“用JavaScript构建交互式流图”。</em>T41】</strong></p></div><div class="ab cl ns nt hr nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ig ih ii ij ik"><p id="89a7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> <em class="ni">在</em> </strong> <a class="ae mh" href="https://www.anychart.com/chartopedia/chart-type/flow-map/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="ni">上查找更多关于血流图的信息</em> </strong> </a> <strong class="kq io"> <em class="ni">。不要错过其他</em></strong><a class="ae mh" href="https://www.anychart.com/blog/category/javascript-chart-tutorials/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="ni">JavaScript图表教程</em> </strong> </a> <strong class="kq io"> <em class="ni">。</em> </strong></p></div><div class="ab cl ns nt hr nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ig ih ii ij ik"><p id="4325" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> <em class="ni">如果您已经准备好为我们的博客做一个很酷的客座博文，请不要犹豫</em> </strong> <a class="ae mh" href="https://www.anychart.com/support/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="ni">联系</em> </strong> </a> <strong class="kq io"> <em class="ni">。</em> </strong></p></div><div class="ab cl ns nt hr nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ig ih ii ij ik"><p id="1de9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="ni">原为发表于</em><a class="ae mh" href="https://www.anychart.com/blog/2021/07/13/flow-map-js/" rel="noopener ugc nofollow" target="_blank"><em class="ni">https://www.anychart.com</em></a><em class="ni">2021年7月13日。</em></p></div><div class="ab cl ns nt hr nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ig ih ii ij ik"><p id="c85a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="ni">更多内容参见</em> <a class="ae mh" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="ni">浅显易懂</em></strong></a></p></div></div>    
</body>
</html>