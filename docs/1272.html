<html>
<head>
<title>Mic Audio Visualizer Using React and Canvas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用“反应”和“画布”的麦克风音频可视化工具</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/mic-audio-visualizer-using-react-and-canvas-4e89905141ac?source=collection_archive---------3-----------------------#2021-03-17">https://javascript.plainenglish.io/mic-audio-visualizer-using-react-and-canvas-4e89905141ac?source=collection_archive---------3-----------------------#2021-03-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="f4fc" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">从浏览器实时可视化麦克风音频的简单方法</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/f42abc211c593d7f8327529a7dd9a96c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5kjDZVVS97Pw1fzwGF6xtw.png"/></div></div></figure></div><div class="ab cl ko kp hr kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="ig ih ii ij ik"><p id="171b" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">最近，在我正在做的项目中，我得到了一个极好的机会，可以使用React和canvas创建一个音频可视化工具。我非常喜欢实现音频可视化工具，所以我想在第一篇博客文章中分享我的经验。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/31c5e3e72c3163e61a1ad0459f9a2836.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*ueKWw6Zu4ZzXtTDEgefe7Q.gif"/></div></figure><blockquote class="ls lt lu"><p id="d43d" class="kv kw lv kx b ky kz jo la lb lc jr ld lw lf lg lh lx lj lk ll ly ln lo lp lq ig bi translated">谷歌搜索“带麦克风的web音频api可视化工具”显然应该为您带来一些不错的结果:)</p><p id="5af0" class="kv kw lv kx b ky kz jo la lb lc jr ld lw lf lg lh lx lj lk ll ly ln lo lp lq ig bi translated">本地麦克风流+网络音频api +画布是这里的主要要求！</p></blockquote><p id="8a6a" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated"><em class="lv">如果您从未使用过Create React App，</em> <a class="ae lz" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank"> <em class="lv">单击此处</em> </a> <em class="lv">访问facebooks github了解如何使用。</em></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/58cd9ca8c320e91734a6b5c3225ceed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*sG03h6BIBXF5N36yP9l8DA.gif"/></div></figure><p id="e6d4" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">首先，让我们拥有Canvas元素，然后在Canvas元素的<code class="fe mb mc md me b">ref</code>属性内传递启动的<code class="fe mb mc md me b">useRef</code>钩子。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="6860" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">现在让我们创建一个方法，提示用户允许使用一个媒体输入，这个媒体输入会产生一个带有包含所请求的媒体类型的轨道的<code class="fe mb mc md me b"><a class="ae lz" href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStream" rel="noopener ugc nofollow" target="_blank">MediaStream</a></code>。在这里，我们请求只使用音频输入。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="f207" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">“音频测试”方法将首先检查用户设备中媒体设备的可用性，然后请求音频输入访问。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="5cfe" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">“<a class="ae lz" href="https://developer.mozilla.org/en-US/docs/Web/API/AudioContext" rel="noopener ugc nofollow" target="_blank"> AudioContext() </a>”构造器创建了一个新的<code class="fe mb mc md me b"><a class="ae lz" href="https://developer.mozilla.org/en-US/docs/Web/API/AudioContext" rel="noopener ugc nofollow" target="_blank">AudioContext</a></code>对象，该对象表示一个音频处理图，由链接在一起的音频模块构建而成，每个模块都由一个<code class="fe mb mc md me b"><a class="ae lz" href="https://developer.mozilla.org/en-US/docs/Web/API/AudioNode" rel="noopener ugc nofollow" target="_blank">AudioNode</a></code>表示。</p><p id="673d" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated"><code class="fe mb mc md me b"><a class="ae lz" href="https://developer.mozilla.org/en-US/docs/Web/API/BaseAudioContext" rel="noopener ugc nofollow" target="_blank">BaseAudioContext</a></code>界面的“createAnalyser()”方法创建一个<code class="fe mb mc md me b">AnalyserNode</code>，可用于展示音频时间和频率数据并创建数据可视化。</p><p id="cb47" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">“analyser.fftSize”接口是一个无符号长值，表示执行快速傅立叶变换(FFT)以获取频域数据时使用的样本窗口大小。</p><p id="9544" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">“createMediaStreamSource()”创建与代表音频流的<code class="fe mb mc md me b">MediaStream</code>相关联的<code class="fe mb mc md me b"><a class="ae lz" href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamAudioSourceNode" rel="noopener ugc nofollow" target="_blank">MediaStreamAudioSourceNode</a></code>，该音频流可能来自本地计算机麦克风或其他源。</p><p id="8046" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated"><code class="fe mb mc md me b">AnalyserNode</code>接口的“analyser.frequencyBinCount”只读属性是一个无符号整数，是<code class="fe mb mc md me b"><a class="ae lz" href="https://developer.mozilla.org/en-US/docs/Web/API/AnalyserNode/fftSize" rel="noopener ugc nofollow" target="_blank">AnalyserNode.fftSize</a></code>的一半。这通常等同于您必须处理的可视化数据值的数量。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/9ba6b7f0c85b7cf1f14b15e7b349af95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/1*5b5EZIxYES-lC_YGxLvtDQ.gif"/></div></figure><p id="05af" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">现在我们准备用一点数学绘制频率数据，用魔法包裹，我们的可视化工具将在画布上可视化。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="4a00" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated"><code class="fe mb mc md me b">analyserCanvas.current.<a class="ae lz" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/getContext" rel="noopener ugc nofollow" target="_blank">getContext</a>(‘2d’)</code>方法返回画布上的绘图上下文，或者如果上下文标识符不被支持，或者画布已经被设置为不同的上下文模式，则返回<code class="fe mb mc md me b">null</code>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/744f11f67719a9255f4827fcbb9d72d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*ckktTUKqaAZ-_8IrUQlbfw.gif"/></div></figure><p id="6c21" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">这些线将创建我们的音频可视化工具，并根据输入音频实时将它们绘制到画布中。</p><h2 id="18c5" class="mj mk in bd ml mm mn dn mo mp mq dp mr le ms mt mu li mv mw mx lm my mz na nb bi translated">结论</h2><p id="4495" class="pw-post-body-paragraph kv kw in kx b ky nc jo la lb nd jr ld le ne lg lh li nf lk ll lm ng lo lp lq ig bi translated">如果你想知道更多关于这个话题的信息，欢迎在下面的评论区问我任何问题。我将感谢你的建议和意见。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/3c3ac587865c1802f949eda2ecab93e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/1*DmKi04ncwU-o-vaNOivYAA.gif"/></div></figure><p id="e69a" class="pw-post-body-paragraph kv kw in kx b ky kz jo la lb lc jr ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">感谢阅读！</p></div></div>    
</body>
</html>