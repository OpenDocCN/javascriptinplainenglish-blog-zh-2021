<html>
<head>
<title>How to Build Complex DOM Elements Quickly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何快速构建复杂的DOM元素</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-build-complex-dom-elements-quickly-b3ead8e09647?source=collection_archive---------4-----------------------#2021-07-28">https://javascript.plainenglish.io/how-to-build-complex-dom-elements-quickly-b3ead8e09647?source=collection_archive---------4-----------------------#2021-07-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/09ab4c4b3f61015cbf615644e7150164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4e7NMFM9xePNT24yYTH9Yg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@pankajpatel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Pankaj Patel</a> on <a class="ae kc" href="https://unsplash.com/s/photos/html-tool?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c304" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">DOM，即文档对象模型，是web开发人员工作中不可或缺的一部分。因为它代表了网页中的元素树，所以它决定了浏览器向用户提供的底层结构。</p><p id="9c98" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然您可以用JavaScript添加和操作DOM元素，但是如果元素有许多属性，那么为它编写逻辑代码可能会很麻烦而且重复。在本教程中，我们将创建一个方法，让您更紧凑地添加复杂的元素。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="05f8" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">HTML DOM结构示例</h1><p id="8b9f" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">对于那些不熟悉DOM概念的人来说，它是网页上HTML元素的层次结构。下面是一个简单的例子。</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="mp mq l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">A sample HTML DOM.</figcaption></figure></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="ebff" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">用JavaScript添加DOM元素</h1><p id="1dc9" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">除了手工编写如上所示的页面或要求使用数据库的站点呈现DOM服务器端之外，我们还可以编写JavaScript来添加DOM元素并赋予其属性。让我们来看三种方法。</p><h2 id="364f" class="mr lj iq bd lk ms mt dn lo mu mv dp ls ko mw mx lw ks my mz ma kw na nb me nc bi translated">方法1:没有其他方法</h2><p id="2df1" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">在下面的代码示例中，我们添加了一个<code class="fe nd ne nf ng b">section</code>元素，并赋予它几个属性(<code class="fe nd ne nf ng b">id</code>、<code class="fe nd ne nf ng b">className</code>和<code class="fe nd ne nf ng b">innerHTML</code>)以及三个属性(<code class="fe nd ne nf ng b">data-foo</code>、<code class="fe nd ne nf ng b">data-baz</code>和<code class="fe nd ne nf ng b">onclick</code>)。</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="mp mq l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Creating an element with Vanilla JavaScript.</figcaption></figure><p id="1f71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然这样做了，但是我们必须写六次<code class="fe nd ne nf ng b">section</code>，我们必须写三次<code class="fe nd ne nf ng b">setAttribute</code>。而更多的属性或性质将意味着更多的重复。</p><h2 id="4e95" class="mr lj iq bd lk ms mt dn lo mu mv dp ls ko mw mx lw ks my mz ma kw na nb me nc bi translated">方法2:调用实用方法</h2><p id="d395" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">也就是说，我们可以通过编写一个定制的实用方法来消除重复，该方法允许我们以更紧凑的方式创建DOM元素:</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="mp mq l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Sample creatEl method call. Let’s make this possible!</figcaption></figure><p id="f0e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的例子中，我们调用了一个属于新的<code class="fe nd ne nf ng b">dom_utils</code>对象的<code class="fe nd ne nf ng b">createEl</code>方法。这样做时，我们传入一个对象，该对象具有应该在结果元素中显示的属性。</p><p id="f627" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然属性直接在我们的对象上，但是属性在对应于<code class="fe nd ne nf ng b">attrs</code>键的嵌套对象中。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="f896" class="mr lj iq ng b gy nl nm l nn no">attrs: { <br/>   dataFoo:'bar',<br/>   dataBaz:'garply,<br/>   onclick:'showModal()'<br/>}</span></pre><p id="a597" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还要注意，这些属性使用的是came case(<code class="fe nd ne nf ng b">dataFoo</code>)而不是破折号语法(<code class="fe nd ne nf ng b">data-foo</code>)。我稍后会解释原因。</p><h2 id="84ae" class="mr lj iq bd lk ms mt dn lo mu mv dp ls ko mw mx lw ks my mz ma kw na nb me nc bi translated">方法3:创建对象，然后调用方法</h2><p id="2cce" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">为了帮助我们区分传入的对象和方法，如果我们提前初始化对象，下面是我们的逻辑。</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="8c28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在涉及<code class="fe nd ne nf ng b">dom_utils</code>的任一方法中，与方法1相比，重复较少。</p><p id="bab9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在下一节中，我们将编写<code class="fe nd ne nf ng b">dom_utils</code>和它的<code class="fe nd ne nf ng b">createEl</code>方法。您可以使用包含HTML和JavaScript文件的本地目录，也可以使用JSFiddle或CodePen之类的编码沙箱。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="8285" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">起始代码</h1><p id="f706" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">在我们的HTML中，让我们创建一个可以添加内容的元素。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="6563" class="mr lj iq ng b gy nl nm l nn no">&lt;div id="root"&gt;&lt;/div&gt;</span></pre><p id="2c57" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用JavaScript，让我们创建一个空对象。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="6d64" class="mr lj iq ng b gy nl nm l nn no">let utils = {};</span></pre><p id="69d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们创建一个初始包装器，它将为我们的<code class="fe nd ne nf ng b">utils</code>对象提供我们创建的方法。在本教程之后，您可以编写其他方法进入这个包装器。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="0fed" class="mr lj iq ng b gy nl nm l nn no">(function(context) {</span><span id="4e4a" class="mr lj iq ng b gy np nm l nn no">  // methods go here</span><span id="763a" class="mr lj iq ng b gy np nm l nn no">})(utils);</span></pre></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="8448" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">创建HTML元素</h1><p id="30a3" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">让我们首先为<code class="fe nd ne nf ng b">createEl</code>方法写一个框架。它现在所做的就是将一个对象(<code class="fe nd ne nf ng b">o</code>)作为参数，并返回一个HTML DOM元素。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="f0ca" class="mr lj iq ng b gy nl nm l nn no">let utils = {};</span><span id="95d0" class="mr lj iq ng b gy np nm l nn no">(function(context) {</span><span id="e64d" class="mr lj iq ng b gy np nm l nn no"><strong class="ng ir">      context.createEl = function(o) {</strong></span><span id="8265" class="mr lj iq ng b gy np nm l nn no"><strong class="ng ir">      let el = null;</strong></span><span id="167a" class="mr lj iq ng b gy np nm l nn no">      // additional code will go here.</span><span id="0f48" class="mr lj iq ng b gy np nm l nn no"><strong class="ng ir">      return el;  </strong>        <br/>   };</span><span id="6f55" class="mr lj iq ng b gy np nm l nn no">})(utils);</span></pre><p id="dd9f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看起来很整齐，但是到目前为止，没用！</p><h2 id="5711" class="mr lj iq bd lk ms mt dn lo mu mv dp ls ko mw mx lw ks my mz ma kw na nb me nc bi translated">设置元素类型</h2><p id="ab3d" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">为了创建我们的元素，我们将使用<code class="fe nd ne nf ng b">document.createElement</code>。因为对象属性<code class="fe nd ne nf ng b">type</code>是必需的，如果它不在对象中，我们设置一个默认值。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="6a93" class="mr lj iq ng b gy nl nm l nn no">let utils = {};</span><span id="3d36" class="mr lj iq ng b gy np nm l nn no">(function(context) {</span><span id="04f3" class="mr lj iq ng b gy np nm l nn no"><strong class="ng ir">     </strong>   context.createEl = function(o) {</span><span id="fea6" class="mr lj iq ng b gy np nm l nn no"><strong class="ng ir">        let type = o.type || 'div';</strong></span><span id="dc6d" class="mr lj iq ng b gy np nm l nn no"><strong class="ng ir">        let el = document.createElement(type);</strong></span><span id="774b" class="mr lj iq ng b gy np nm l nn no"><strong class="ng ir">       </strong> return el; <strong class="ng ir"> </strong>        <br/>    };</span><span id="4b7b" class="mr lj iq ng b gy np nm l nn no">})(utils);</span></pre><p id="2e13" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我使用一个<code class="fe nd ne nf ng b">div</code>作为默认值，但是它可以是任何适合你需要的东西。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="6c5f" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">添加属性和特性</h1><p id="582c" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">现在让我们添加一个添加属性和特性的方法。在JavaScript中，可以直接添加<code class="fe nd ne nf ng b">id</code>、<code class="fe nd ne nf ng b">className</code>等属性。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="63ce" class="mr lj iq ng b gy nl nm l nn no">el.className = 'myClass';<br/>el.id = 'myClass-2';</span></pre><p id="3ca7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">相比之下，必须通过<code class="fe nd ne nf ng b">setAttribute</code>添加属性。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="9169" class="mr lj iq ng b gy nl nm l nn no">el.setAttribute('data-user','Nevin');</span></pre><h2 id="04e3" class="mr lj iq bd lk ms mt dn lo mu mv dp ls ko mw mx lw ks my mz ma kw na nb me nc bi translated">添加属性</h2><p id="331a" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">让我们首先编写基于传入对象中的属性设置元素属性的逻辑(<code class="fe nd ne nf ng b">o</code>)。为此，我们可以使用<code class="fe nd ne nf ng b">Object.keys</code>方法获得对象键的数组，并使用<code class="fe nd ne nf ng b">for...of</code>循环遍历它们。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="fadb" class="mr lj iq ng b gy nl nm l nn no">let el = document.createElement(type);</span><span id="6b47" class="mr lj iq ng b gy np nm l nn no"><strong class="ng ir">for (const key of (Object.keys(o))) {<br/><br/>}</strong></span></pre><p id="99bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有两个键我们不想处理:<code class="fe nd ne nf ng b">type</code>和<code class="fe nd ne nf ng b">attrs</code>。所以让我们添加逻辑来排除那些。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="ab9b" class="mr lj iq ng b gy nl nm l nn no">for (const key of (Object.keys(o))) {<strong class="ng ir"><br/>   if (key != 'attrs' &amp;&amp; key != 'type') {<br/><br/>   }<br/></strong>}</span></pre><p id="fc1f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们添加一行代码，为元素提供对象的当前键值对。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="a763" class="mr lj iq ng b gy nl nm l nn no">for (const key of (Object.keys(o))) {<strong class="ng ir"><br/></strong>   if (key != 'attrs' &amp;&amp; key != 'type') {<strong class="ng ir"><br/>         el[key] = o[key];<br/></strong>   }<strong class="ng ir"><br/></strong>}</span></pre><p id="4e59" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以你可以检查你的工作，这是我们目前的JavaScript。</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h2 id="cfe0" class="mr lj iq bd lk ms mt dn lo mu mv dp ls ko mw mx lw ks my mz ma kw na nb me nc bi translated">添加属性</h2><p id="d23b" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">在我们添加属性之前，让我们首先检查一个<code class="fe nd ne nf ng b">attrs</code>属性是否存在。我们将在<code class="fe nd ne nf ng b">return el</code>之前添加它。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="00a3" class="mr lj iq ng b gy nl nm l nn no"><strong class="ng ir">if (o.attrs) {<br/>}</strong><br/>return el;</span></pre><p id="4a68" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们浏览一下属性键。我们没有在<code class="fe nd ne nf ng b">o</code>上使用<code class="fe nd ne nf ng b">Object.keys</code>，而是钻入更深的一层，并在<code class="fe nd ne nf ng b">o.attrs</code>上使用。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="a17d" class="mr lj iq ng b gy nl nm l nn no">if (o.attrs) {<br/>   for (let key of (Object.keys(o.attrs))) {<br/><br/>    }<br/>}</span></pre><p id="28a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">需要注意的是:这里我用的是<code class="fe nd ne nf ng b">let</code>而不是<code class="fe nd ne nf ng b">const</code>。现在我想知道为什么会这样…</p><h2 id="7f71" class="mr lj iq bd lk ms mt dn lo mu mv dp ls ko mw mx lw ks my mz ma kw na nb me nc bi translated">dash困境</h2><p id="9890" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">需要注意的是，在HTML中，数据属性通常以破折号语法出现:</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="7aef" class="mr lj iq ng b gy nl nm l nn no">&lt;div data-user="Nevin"&gt;&lt;/div&gt;</span></pre><p id="c7f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为JavaScript键中的破折号会抛出<code class="fe nd ne nf ng b">Unexpected token</code>错误，所以需要用引号来设置这些属性名，而不要在<code class="fe nd ne nf ng b">createEl</code>中出错。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="56bc" class="mr lj iq ng b gy nl nm l nn no">let el = dom_utils.createEl({<br/>    type:'div',<br/>    attrs: {<br/>       <strong class="ng ir">'data-user':</strong>'Nevin'<br/>    }<br/>});</span></pre><p id="3666" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我不喜欢那些引语。请记住，在展示了<code class="fe nd ne nf ng b">createEl</code>应该如何工作的方法2和3中，我使用了came case(<code class="fe nd ne nf ng b">dataFoo</code>)而不是dash语法(<code class="fe nd ne nf ng b">data-foo</code>)。</p><p id="19e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们可以在方法调用中编写camelCase，让我们添加逻辑，将对象中的camelCase更改为元素的dash语法。首先，让我们使用逻辑NOT ( <code class="fe nd ne nf ng b">!</code>)运算符检查任何大写字母。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="7820" class="mr lj iq ng b gy nl nm l nn no">if (o.attrs) {<br/>   for (let key of (Object.keys(o.attrs))) {</span><span id="34e5" class="mr lj iq ng b gy np nm l nn no">    <strong class="ng ir"> if (key != key.toLowerCase()) {<br/>  </strong>      // coming soon<strong class="ng ir"><br/>     }</strong><br/>   }<br/>}</span></pre><p id="9ace" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果<code class="fe nd ne nf ng b">key</code>不同于<code class="fe nd ne nf ng b">key.toLowerCase</code>，那意味着我们至少有一个大写字母。让我们用下面的一行程序来处理大写字母。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="2111" class="mr lj iq ng b gy nl nm l nn no">if (key != key.toLowerCase()) {<br/><strong class="ng ir">    key = key.replace(/[A-Z]/g, m =&gt; "-" + m.toLowerCase());</strong><br/>}</span></pre><p id="6e2d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是这一行代码的工作原理:</p><ul class=""><li id="3e93" class="nr ns iq kf b kg kh kk kl ko nt ks nu kw nv la nw nx ny nz bi translated">我们在<code class="fe nd ne nf ng b">key</code>上调用<code class="fe nd ne nf ng b">replace</code>方法，并使用正则表达式<code class="fe nd ne nf ng b">/[A-Z]/g</code>来寻找所有大写字母的实例。</li><li id="1de7" class="nr ns iq kf b kg oa kk ob ko oc ks od kw oe la nw nx ny nz bi translated">如果我们找到一个大写字母，我们在回调中将它赋给变量<code class="fe nd ne nf ng b">m</code>。</li><li id="83af" class="nr ns iq kf b kg oa kk ob ko oc ks od kw oe la nw nx ny nz bi translated">我们使用<code class="fe nd ne nf ng b">m =&gt; "-" + m.toLowerCase</code>将大写字母转换成破折号(<code class="fe nd ne nf ng b">-</code>)，后跟小写字母。</li><li id="7458" class="nr ns iq kf b kg oa kk ob ko oc ks od kw oe la nw nx ny nz bi translated">例如，<code class="fe nd ne nf ng b">dataFoo</code>变为<code class="fe nd ne nf ng b">data-foo</code>，因为<code class="fe nd ne nf ng b">F</code>被替换为<code class="fe nd ne nf ng b">-f</code>。</li></ul><p id="7f23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nq">先不说:关于这种逻辑如何工作的更多细节，请查看我的文章</em> <a class="ae kc" href="https://nevkatz.medium.com/from-camel-case-to-dash-syntax-in-javascript-c685206ee682?sk=26e6070335ec3db8ece2c49ac321b9f5" rel="noopener"> <em class="nq">中关于它如何将camelCase转换为dash语法的内容。</em></a></p><p id="b7ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在检查了camelCase并根据需要采取行动之后，我们通过一个<code class="fe nd ne nf ng b">setAttribute</code>调用将属性-值对添加到元素中。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="604d" class="mr lj iq ng b gy nl nm l nn no">if (key != key.toLowerCase()) {<br/>    key = key.replace(/[A-Z]/g, m =&gt; "-" + m.toLowerCase());<br/>}</span><span id="70ea" class="mr lj iq ng b gy np nm l nn no"><strong class="ng ir">el.setAttribute(key, o.attrs[key]);</strong></span></pre><p id="d2c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是所有属性的逻辑组合:</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="mp mq l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">attribute logic</figcaption></figure><p id="0f94" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回到前面提到的<em class="nq">注意</em>的一些东西:改变<code class="fe nd ne nf ng b">key</code>到破折号语法的潜在需要是我们使用<code class="fe nd ne nf ng b">let</code>而不是<code class="fe nd ne nf ng b">const</code>来初始化它的原因——因为我们可以在键被创建后<em class="nq">改变</em>键。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="6208" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">终点线</h1><p id="9cc6" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">万岁！现在我们可以用属性和特性来定义元素了。下面是完整的<code class="fe nd ne nf ng b">createEl</code>方法。</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="mp mq l"/></div></figure></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="bd07" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">演示</h1><p id="42df" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">下面是一个非常基本的演示，所以你可以看到这个方法的工作原理。当你点击我的名字时，字体的颜色应该会改变。这是因为添加了一个带有值<code class="fe nd ne nf ng b">changeColor()</code>的<code class="fe nd ne nf ng b">onclick</code>属性，我在这里添加了一个额外的函数来证明添加了该属性。</p><p id="8056" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，如果您研究CSS，您还可以看到添加了另外两个<code class="fe nd ne nf ng b">data-</code>属性和元素的类——显示了相应的CSS样式。</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="of mq l"/></div></figure><p id="95f1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以防你好奇，我用的<code class="fe nd ne nf ng b">changeColor()</code>函数如下。</p><pre class="ml mm mn mo gt nh ng ni nj aw nk bi"><span id="5687" class="mr lj iq ng b gy nl nm l nn no">function changeColor(el) {<br/>  let color = Math.floor(Math.random()*16777215).toString(16);<br/>  el.style.color = '#' + color;<br/>}</span></pre><p id="74b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">非常感谢CSS Tricks 的Chris Coyier提供的便利功能！</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="e233" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，只需一点点努力，您就可以编写自己的DOM实用方法迷你库，这将消除一些重复，并使在JavaScript中添加元素更加高效。感谢阅读！</p><h1 id="bc59" class="li lj iq bd lk ll og ln lo lp oh lr ls lt oi lv lw lx oj lz ma mb ok md me mf bi translated">在别处</h1><p id="39e7" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">这是我对camelCase/dash语法转换逻辑的深入研究。</p><div class="ol om gp gr on oo"><a rel="noopener  ugc nofollow" target="_blank" href="/from-camel-case-to-dash-syntax-in-javascript-c685206ee682"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd ir gy z fp ot fr fs ou fu fw ip bi translated">JavaScript中从骆驼大小写到破折号的语法</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">仔细看看一个概念丰富的代码片段。</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc jw oo"/></div></div></a></div><p id="6af0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而<code class="fe nd ne nf ng b">changeColor</code>方法来自于这个CSS窍门。</p><div class="ol om gp gr on oo"><a href="https://css-tricks.com/snippets/javascript/random-hex-color/" rel="noopener  ugc nofollow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd ir gy z fp ot fr fs ou fu fw ip bi translated">如何在JavaScript中生成随机颜色</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">这里有一个quicky(也有PHP版本):var random color = math . floor(math . random()* 16777215)。toString(16)；看…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">css-tricks.com</p></div></div><div class="ox l"><div class="pd l oz pa pb ox pc jw oo"/></div></div></a></div><p id="8f39" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nq">更多内容请看</em><a class="ae kc" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="nq">plain English . io</em></strong></a></p></div></div>    
</body>
</html>