<html>
<head>
<title>How to Use the Vue 3 Suspense Component and Create Async Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Vue 3暂记组件和创建异步组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-the-vue-3-suspense-component-and-create-async-components-77a6c617df4c?source=collection_archive---------12-----------------------#2021-05-23">https://javascript.plainenglish.io/how-to-use-the-vue-3-suspense-component-and-create-async-components-77a6c617df4c?source=collection_archive---------12-----------------------#2021-05-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9ba26668b0246a7c540e8a558c626c99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*U56kzBmXAu1yJ7fm"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@andasta?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Andy Li</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="64d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了只在需要的时候加载组件，我们可以异步加载组件。</p><p id="209f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以使用<code class="fe lb lc ld le b">Suspense</code>组件来呈现组件，组件加载时会显示回退消息。</p><p id="bc9d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何创建异步组件并使用<code class="fe lb lc ld le b">Suspense</code>组件来呈现它们。</p><h1 id="96f9" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">Vue 3暂记组件和创建异步组件</h1><p id="1bb2" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">Vue 3 <code class="fe lb lc ld le b">Suspense</code>有<code class="fe lb lc ld le b">default</code>插槽来呈现我们想要的动态组件。</p><p id="d39c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">fallback</code>插槽让我们显示组件加载时呈现的回退消息。</p><p id="b671" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe lb lc ld le b">defineAsyncComponent</code>函数定义异步组件。</p><p id="892d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要一起使用它们，我们可以编写以下代码:</p><p id="2946" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">main.js</code></p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="ba6f" class="mq lg iq le b gy mr ms l mt mu">import { createApp, defineAsyncComponent } from "vue";<br/>import App from "./App.vue";</span><span id="7da7" class="mq lg iq le b gy mv ms l mt mu">const sleep = (ms) =&gt; new Promise((resolve) =&gt; setTimeout(resolve, ms));</span><span id="1e28" class="mq lg iq le b gy mv ms l mt mu">const app = createApp(App);<br/>const HelloWorldAsync = defineAsyncComponent(async () =&gt; {<br/>  await sleep(2000);<br/>  return import("./components/HelloWorld.vue");<br/>});</span><span id="28d8" class="mq lg iq le b gy mv ms l mt mu">app.component("hello-world", HelloWorldAsync);</span><span id="4555" class="mq lg iq le b gy mv ms l mt mu">app.mount("#app");</span></pre><p id="7588" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">App.vue</code></p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="8d1e" class="mq lg iq le b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;Suspense&gt;<br/>    &lt;template #default&gt;<br/>      &lt;hello-world /&gt;<br/>    &lt;/template&gt;<br/>    &lt;template #fallback&gt;<br/>      &lt;div&gt;Loading...&lt;/div&gt;<br/>    &lt;/template&gt;<br/>  &lt;/Suspense&gt;<br/>&lt;/template&gt;</span><span id="97c0" class="mq lg iq le b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  name: "App",<br/>};<br/>&lt;/script&gt;</span></pre><p id="c771" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">components/HelloWorld.vue</code></p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="14ad" class="mq lg iq le b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div class="hello"&gt;hello world&lt;/div&gt;<br/>&lt;/template&gt;</span><span id="2e5c" class="mq lg iq le b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  name: "HelloWorld",<br/>  props: {<br/>    msg: String,<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="3830" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe lb lc ld le b">main.js</code>文件中，我们有<code class="fe lb lc ld le b">sleep</code>函数来模拟加载组件的延迟。</p><p id="4661" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe lb lc ld le b">createApp</code>函数创建Vue app。</p><p id="1b0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们调用<code class="fe lb lc ld le b">defineAsyncComponenty</code>函数，该函数接受返回解析组件的承诺的函数。</p><p id="a4ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe lb lc ld le b">sleep</code>来添加2000 ms的延迟。</p><p id="a0e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们返回带有组件的承诺，这是通过带有组件路径的<code class="fe lb lc ld le b">import</code>函数得到的。</p><p id="bb2e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe lb lc ld le b">app.component</code>方法注册组件。</p><p id="d1c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，在<code class="fe lb lc ld le b">App.vue</code>中，我们添加带有<code class="fe lb lc ld le b">default</code>槽的<code class="fe lb lc ld le b">Suspense</code>组件，该槽具有我们想要显示的主要内容。</p><p id="3964" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而<code class="fe lb lc ld le b">fallback</code>槽中的内容是在<code class="fe lb lc ld le b">default</code>槽中的组件加载时显示的。</p><p id="71f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">HelloWorld.vue</code>有我们想要显示的内容。</p><p id="52c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们应该看到“正在加载…”消息显示2秒钟，然后看到“hello world”显示。</p><h1 id="5348" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="8c4d" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们可以将Vue 3 <code class="fe lb lc ld le b">Suspense</code>组件与异步组件一起使用，以异步方式动态加载组件。</p><p id="5578" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">组件让我们在加载异步组件时向用户显示加载消息。</p><p id="e6d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mw">更多内容请看</em><a class="ae kc" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mw">plain English . io</em></strong></a></p></div></div>    
</body>
</html>