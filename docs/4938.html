<html>
<head>
<title>Monorepo with JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带JavaScript的Monorepo</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/monorepo-with-javascript-9605f8354b11?source=collection_archive---------9-----------------------#2021-10-05">https://javascript.plainenglish.io/monorepo-with-javascript-9605f8354b11?source=collection_archive---------9-----------------------#2021-10-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="06f5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">“全栈”JavaScript项目的开发策略</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2933a4405ce20c3d2ad74f733caf5319.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4eIrkrPumkKSTT4b"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@6heinz3r?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Gabriel Heinzer</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0d1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">管理多个存储库可能会令人沮丧，尤其是当您涉及到这些存储库的时候。例如，<strong class="ky ir">回购A </strong>和<strong class="ky ir">回购B </strong>在业务逻辑上可能有30%的相似性。当你需要修理或改变它的时候，你需要做两次。</p><p id="692a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们开始之前，您可能需要看看这篇文章，以便有一个更清晰的思路:</p><div class="ls lt gp gr lu lv"><a href="https://betterprogramming.pub/3-libraries-i-use-in-most-javascript-frontend-projects-555387be69c" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">我在大多数JavaScript前端项目中使用的3个库</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">提升您的web应用程序的性能</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">better编程. pub</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><h1 id="07dd" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">什么是monorepo？</h1><p id="18ec" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf ne lh li lj nf ll lm ln ng lp lq lr ij bi translated">与多回购不同，单回购是存储多个项目代码和资产的单一存储库。允许您在不同的项目之间共享业务逻辑。</p><p id="0d57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">想象一下使用全栈JavaScript: <em class="nh">桌面</em> — ElectronJS、<em class="nh">后端</em> — NodeJS、<em class="nh">移动应用</em> — React Native、<em class="nh">管理门户</em> — ReactJS、<em class="nh"> Web应用</em> — SvelteJS。您只需要一个存储库来存储所有这些项目。</p><p id="57f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">文件夹结构如下所示:</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="dcea" class="nn ml iq nj b gy no np l nq nr">apps/<br/>├── admin<br/>│   └── package.json<br/>├── api<br/>│   └── package.json<br/>├── desktop<br/>│   └── package.json<br/>├── mobile<br/>│   └── package.json<br/>└── web<br/>    └── package.json</span><span id="c84d" class="nn ml iq nj b gy ns np l nq nr">public/<br/>├── styles<br/>│   └── global.css<br/>├── images<br/>│   └── a.png<br/>|   └── b.png<br/>└── favicon.ico</span><span id="8ba1" class="nn ml iq nj b gy ns np l nq nr">shared/<br/>└── utils<br/>    └── index.ts</span></pre><p id="1f05" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">目前有<a class="ae kv" href="https://lerna.js.org/" rel="noopener ugc nofollow" target="_blank"> lerna </a>，<a class="ae kv" href="https://pnpm.io/" rel="noopener ugc nofollow" target="_blank"> pnpm </a>，<a class="ae kv" href="https://bazel.build/" rel="noopener ugc nofollow" target="_blank"> Bazel </a>等。，是JavaScript monorepo的构建工具。然而，在本文中，我将仅使用<code class="fe nt nu nv nj b">pnpm</code>作为示例。</p><h1 id="66bb" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">谁在使用monorepo？</h1><ol class=""><li id="5f15" class="nw nx iq ky b kz nc lc nd lf ny lj nz ln oa lr ob oc od oe bi translated"><strong class="ky ir">像谷歌、脸书、推特、微软等大公司。正在使用monorepo，他们的代码库非常庞大。</strong></li><li id="6283" class="nw nx iq ky b kz of lc og lf oh lj oi ln oj lr ob oc od oe bi translated">开源库通常使用monorepo作为文档站点和插件等。然而，有时也可能是多次回购。</li></ol><h1 id="f4f1" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">优点和缺点</h1><p id="e1bf" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf ne lh li lj nf ll lm ln ng lp lq lr ij bi translated">Monorepo很好，但有时会适得其反。</p><h2 id="2029" class="nn ml iq bd mm ok ol dn mq om on dp mu lf oo op mw lj oq or my ln os ot na ou bi translated">优势</h2><ol class=""><li id="a6bd" class="nw nx iq ky b kz nc lc nd lf ny lj nz ln oa lr ob oc od oe bi translated"><strong class="ky ir">代码一次— </strong>同样的业务逻辑不用多次编写。编写一次代码，在同一个存储库中的多个项目之间共享。</li><li id="dfcd" class="nw nx iq ky b kz of lc og lf oh lj oi ln oj lr ob oc od oe bi translated"><strong class="ky ir">简化的依赖管理</strong> —在多回购中，你可能需要多次下载同一个第三方依赖，多次发布包；Monorepo允许您在一个地方一次性管理依赖性。</li><li id="23f9" class="nw nx iq ky b kz of lc og lf oh lj oi ln oj lr ob oc od oe bi translated"><strong class="ky ir">原子变化</strong> —你可以改变一段代码，影响多个项目。例如，当重构一个<strong class="ky ir">共享的</strong>函数时，它也会影响其他项目。</li></ol><h2 id="d51e" class="nn ml iq bd mm ok ol dn mq om on dp mu lf oo op mw lj oq or my ln os ot na ou bi translated"><strong class="ak">缺点</strong></h2><ol class=""><li id="9f1d" class="nw nx iq ky b kz nc lc nd lf ny lj nz ln oa lr ob oc od oe bi translated"><strong class="ky ir">访问控制</strong> —用户可以对所有项目进行读取、写入和删除。例如，John是前端Web开发人员，他应该只为React web应用程序工作，但是他也可以访问后端、桌面等。</li><li id="daac" class="nw nx iq ky b kz of lc og lf oh lj oi ln oj lr ob oc od oe bi translated"><strong class="ky ir">需要更多存储空间</strong> —它适合从事大多数项目的全栈开发人员。然而，如果在monorepo中有五个项目，而你只做一个，那么其他四个项目就是在浪费你的存储空间。</li><li id="16c2" class="nw nx iq ky b kz of lc og lf oh lj oi ln oj lr ob oc od oe bi translated"><strong class="ky ir">原子变化</strong>——是的，这可能既是优势也是劣势。重构一段代码要么成功，要么彻底失败。你可能会搞砸别人的项目。</li><li id="ef5d" class="nw nx iq ky b kz of lc og lf oh lj oi ln oj lr ob oc od oe bi translated"><strong class="ky ir"> IDE的自动导入</strong>——总是仔细检查你的IDE的自动导入。有时它会从其他项目中导入模块，这些模块不会包含在产品中。请不要依赖IDE的智能重构，因为JS不是类型安全的语言；这会制造一场噩梦。</li><li id="3282" class="nw nx iq ky b kz of lc og lf oh lj oi ln oj lr ob oc od oe bi translated"><strong class="ky ir">版本控制— </strong>当您有一个大团队参与其中时，跟踪提交日志将会非常困难。</li></ol><p id="79d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要盲目跟风。如果上面提到的优势是你所寻找的，你应该考虑转投monorepo。否则，坚持使用多重回购。</p><p id="e2a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">点击查看Github repo <a class="ae kv" href="https://github.com/OysterD3/js-monorepo-example" rel="noopener ugc nofollow" target="_blank">示例。</a></p><p id="cae4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nh">更多内容请看</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="nh">plain English . io</em></strong></a></p></div></div>    
</body>
</html>