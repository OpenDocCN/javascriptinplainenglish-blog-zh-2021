<html>
<head>
<title>Create a React Horizontal Grouped Bar Chart with the Visx Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Visx库创建一个React水平分组条形图</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-a-react-horizontal-grouped-bar-chart-with-the-visx-library-da9a0efaa866?source=collection_archive---------15-----------------------#2021-03-15">https://javascript.plainenglish.io/create-a-react-horizontal-grouped-bar-chart-with-the-visx-library-da9a0efaa866?source=collection_archive---------15-----------------------#2021-03-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0ede457d9a36f4741bb54654338167c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UcRAC5BJuFQyK16M"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@fourcolourblack?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Adam Wilson</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="821f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Visx是一个库，让我们可以轻松地将图形添加到React应用程序中。</p><p id="5429" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用它将水平分组条形图添加到React应用程序中。</p><h1 id="8636" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">安装所需的软件包</h1><p id="cb1c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们必须安装一些模块来创建分组条形图。</p><p id="61e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="89df" class="mn lc iq mj b gy mo mp l mq mr">npm i @visx/axis @visx/group @visx/mock-data @visx/responsive @visx/scale @visx/shape</span></pre><p id="8e2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装软件包。</p><h1 id="4761" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建图表</h1><p id="04ad" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过添加模块提供的项目来创建图表。</p><p id="7bc9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用来自<code class="fe ms mt mu mj b">@visx/mock-data</code>模块的数据。</p><p id="d6a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了创建图表，我们编写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f79f" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { BarGroupHorizontal, Bar } from "@visx/shape";<br/>import { Group } from "@visx/group";<br/>import { AxisLeft } from "@visx/axis";<br/>import cityTemperature from "@visx/mock-data/lib/mocks/cityTemperature";<br/>import { scaleBand, scaleLinear, scaleOrdinal } from "@visx/scale";<br/>import { timeParse, timeFormat } from "d3-time-format";</span><span id="73cf" class="mn lc iq mj b gy mv mp l mq mr">const blue = "#aeeef8";<br/>const green = "#e5fd3d";<br/>const purple = "#9caff6";<br/>const background = "#612efb";<br/>const defaultMargin = { top: 20, right: 20, bottom: 20, left: 50 };</span><span id="6e1a" class="mn lc iq mj b gy mv mp l mq mr">const parseDate = timeParse("%Y-%m-%d");<br/>const format = timeFormat("%b %d");<br/>const formatDate = (date) =&gt; format(parseDate(date));<br/>function max(arr, fn) {<br/>  return Math.max(...arr.map(fn));<br/>}</span><span id="4fee" class="mn lc iq mj b gy mv mp l mq mr">const data = cityTemperature.slice(0, 4);<br/>const keys = Object.keys(data[0]).filter((d) =&gt; d !== "date");</span><span id="4687" class="mn lc iq mj b gy mv mp l mq mr">const getDate = (d) =&gt; d.date;</span><span id="81a1" class="mn lc iq mj b gy mv mp l mq mr">const dateScale = scaleBand({<br/>  domain: data.map(getDate),<br/>  padding: 0.2<br/>});<br/>const cityScale = scaleBand({<br/>  domain: keys,<br/>  padding: 0.1<br/>});<br/>const tempScale = scaleLinear({<br/>  domain: [0, max(data, (d) =&gt; max(keys, (key) =&gt; Number(d[key])))]<br/>});<br/>const colorScale = scaleOrdinal({<br/>  domain: keys,<br/>  range: [blue, green, purple]<br/>});</span><span id="0201" class="mn lc iq mj b gy mv mp l mq mr">function Example({ width, height, margin = defaultMargin, events = false }) {<br/>  const xMax = width - margin.left - margin.right;<br/>  const yMax = height - margin.top - margin.bottom;</span><span id="23dd" class="mn lc iq mj b gy mv mp l mq mr">dateScale.rangeRound([0, yMax]);<br/>  cityScale.rangeRound([0, dateScale.bandwidth()]);<br/>  tempScale.rangeRound([0, xMax]);</span><span id="c688" class="mn lc iq mj b gy mv mp l mq mr">return width &lt; 10 ? null : (<br/>    &lt;svg width={width} height={height}&gt;<br/>      &lt;rect<br/>        x={0}<br/>        y={0}<br/>        width={width}<br/>        height={height}<br/>        fill={background}<br/>        rx={14}<br/>      /&gt;<br/>      &lt;Group top={margin.top} left={margin.left}&gt;<br/>        &lt;BarGroupHorizontal<br/>          data={data}<br/>          keys={keys}<br/>          width={xMax}<br/>          y0={getDate}<br/>          y0Scale={dateScale}<br/>          y1Scale={cityScale}<br/>          xScale={tempScale}<br/>          color={colorScale}<br/>        &gt;<br/>          {(barGroups) =&gt;<br/>            barGroups.map((barGroup) =&gt; (<br/>              &lt;Group<br/>                key={`bar-group-horizontal-${barGroup.index}-${barGroup.y0}`}<br/>                top={barGroup.y0}<br/>              &gt;<br/>                {barGroup.bars.map((bar) =&gt; (<br/>                  &lt;Bar<br/>                    key={`${barGroup.index}-${bar.index}-${bar.key}`}<br/>                    x={bar.x}<br/>                    y={bar.y}<br/>                    width={bar.width}<br/>                    height={bar.height}<br/>                    fill={bar.color}<br/>                    rx={4}<br/>                    onClick={() =&gt; {<br/>                      if (events)<br/>                        alert(<br/>                          `${bar.key} (${bar.value}) - ${JSON.stringify(bar)}`<br/>                        );<br/>                    }}<br/>                  /&gt;<br/>                ))}<br/>              &lt;/Group&gt;<br/>            ))<br/>          }<br/>        &lt;/BarGroupHorizontal&gt;<br/>        &lt;AxisLeft<br/>          scale={dateScale}<br/>          stroke={green}<br/>          tickStroke={green}<br/>          tickFormat={formatDate}<br/>          hideAxisLine<br/>          tickLabelProps={() =&gt; ({<br/>            fill: green,<br/>            fontSize: 11,<br/>            textAnchor: "end",<br/>            dy: "0.33em"<br/>          })}<br/>        /&gt;<br/>      &lt;/Group&gt;<br/>    &lt;/svg&gt;<br/>  );<br/>}</span><span id="78d9" class="mn lc iq mj b gy mv mp l mq mr">export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Example width="500" height="300" /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="1d20" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mj b">blue</code>、<code class="fe ms mt mu mj b">green</code>和<code class="fe ms mt mu mj b">purple</code>变量设置条形的颜色。</p><p id="f9cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">background</code>变量有背景色。</p><p id="0700" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">defaultMargin</code>有默认边距。</p><p id="4ae0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">parseDate</code>和<code class="fe ms mt mu mj b">format</code>具有日期解析和格式化功能。</p><p id="0b72" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们从模拟数据中解析日期，这样我们就可以将它们格式化以显示在图表中。</p><p id="7590" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">data</code>有图表的数据。</p><p id="454b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">keys</code>有x轴的数据。</p><p id="4c35" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">dateScale</code>有日期刻度。</p><p id="9f14" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">cityScale</code>有城市数据。</p><p id="f1d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">tempScale</code>具有条形的温度值。</p><p id="7619" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">colorScale</code>有条块的颜色。</p><p id="805f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们计算了<code class="fe ms mt mu mj b">xMax</code>和<code class="fe ms mt mu mj b">yMax</code>值，以获得x轴和y轴的最大值。</p><p id="57ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe ms mt mu mj b">rangeRound</code>来设置x和y轴范围的最大值。</p><p id="5cc8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们返回<code class="fe ms mt mu mj b">svg</code>元素，并在其中添加图表部分以添加条形图。</p><p id="5724" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">Group</code>组件是杆件的容器。</p><p id="56e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">BarGroupHorizontal</code>让我们水平显示条形组。</p><p id="55f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mj b">y0</code>、<code class="fe ms mt mu mj b">y0Scale</code>和<code class="fe ms mt mu mj b">y1Scale</code>道具设置<code class="fe ms mt mu mj b">color</code>、<code class="fe ms mt mu mj b">width</code>和横杠的刻度。</p><p id="c6d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">xScale</code>设置x轴刻度，即条形刻度。</p><p id="4b44" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们映射<code class="fe ms mt mu mj b">barGroups</code>来返回<code class="fe ms mt mu mj b">map</code>回调中的<code class="fe ms mt mu mj b">Bar</code>。</p><p id="b590" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mj b">width</code>支柱设定杆的长度。</p><p id="bbe8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们添加<code class="fe ms mt mu mj b">AxisLeft</code>组件来渲染y轴。</p><h1 id="2856" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="77bc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用Visx提供的模块在React应用程序中创建一个水平分组条形图。</p><p id="c569" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p><p id="075a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mw">更多内容请看</em><a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mw">plain English . io</em></strong></a></p></div></div>    
</body>
</html>