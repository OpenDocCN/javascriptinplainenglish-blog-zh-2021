<html>
<head>
<title>Real-Time Charts with Plotly.js in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Plotly.js以角度显示的实时图表</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/real-time-charts-with-plotly-js-in-angular-4a46c4c56eb5?source=collection_archive---------3-----------------------#2021-11-15">https://javascript.plainenglish.io/real-time-charts-with-plotly-js-in-angular-4a46c4c56eb5?source=collection_archive---------3-----------------------#2021-11-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="0e3d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">仪表板应用程序是很棒的工具，根据流数据更新的图表是其效用的一大部分。这篇文章演示了如何使用Plotly.js和Angular创建流数据图表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/84b531469c257af295d7be51476300a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikS3WYwyPzxilyxfUpBv6Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Angular + Plotly.js (image by author)</figcaption></figure><p id="adba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你从直接跳到回购协议中学到了更好的东西，给你。</p><p id="6f98" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">任何实时仪表板的基本架构都是:</p><ol class=""><li id="0952" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh ld le lf lg bi translated">实时数据源，最好是WebSocket。</li><li id="373c" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh ld le lf lg bi translated">一种显示实时数据的方式。</li></ol><p id="a55e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你在找1，我会给你介绍<a class="ae lm" href="https://javascript-conference.com/blog/real-time-in-angular-a-journey-into-websocket-and-rxjs/" rel="noopener ugc nofollow" target="_blank">这个极好的资源</a>。在这里，我将重点放在Angular项目的2上。如果你正在寻找设置Plotly和Angular的基础知识，<a class="ae lm" href="https://medium.com/analytics-vidhya/dynamic-data-visualization-in-angular-with-plotly-js-events-22b524e2e097" rel="noopener">我有一个关于这个的教程</a>。</p><p id="069a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了创建一个动态图表，我们想要创建一个Plotly traces的<code class="fe ln lo lp lq b"><a class="ae lm" href="https://rxjs.dev/guide/observable" rel="noopener ugc nofollow" target="_blank">Observable</a></code>,它响应我们的数据更新而发出。首先，我们将创建一个<code class="fe ln lo lp lq b">DataService</code>，在本例中，它模拟WebSocket功能。</p><p id="f4e1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们的服务:</p><pre class="kj kk kl km gt lr lq ls lt aw lu bi"><span id="5ade" class="lv lw in lq b gy lx ly l lz ma">export class DataService {<br/><br/>  _x: number[] = [];<br/>  _y: number[] = [];<br/>  _iter = 0;<br/>  data$: Observable&lt;{x: number[], y:number[]} | null&gt; = of(null);<br/><br/>  constructor() {}<br/><br/>  connect() {<br/>    // Connect to a websocket that regularly pushes data. <br/>    // Reformat to x/y data to plot.</span><span id="f092" class="lv lw in lq b gy mb ly l lz ma">    this.data$ = interval(100)<br/>      .pipe(<br/>        map(() =&gt; {<br/>          // We will show the 20 most recent values<br/>          this._x.push(this._iter); <br/>          this._iter = this._iter + 1;<br/><br/>          this._y.push(<strong class="lq io"><em class="mc">Math</em></strong>.random()+3); // Random data<br/>          if (this._y.length &gt; 20) {<br/>            this._x = this._x.slice(1, -1);<br/>            this._y = this._y.slice(1, -1);<br/>          }<br/>          return {<br/>            x: this._x,<br/>            y: this._y<br/>          };<br/>        })<br/>      );<br/><br/>    return this.data$;<br/>  }<br/>}</span></pre><p id="68f0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe ln lo lp lq b">AppComponent</code>从<code class="fe ln lo lp lq b">DataService</code>获得可观测的数据，然后将<code class="fe ln lo lp lq b">x</code>和<code class="fe ln lo lp lq b">y</code>数据转换成绘图轨迹。</p><pre class="kj kk kl km gt lr lq ls lt aw lu bi"><span id="9b25" class="lv lw in lq b gy lx ly l lz ma">export class AppComponent implements OnInit{<br/>  title = 'streaming-data';<br/><br/>  trace$: Observable&lt;any&gt; = of(null);<br/>  layout = {<br/>    yaxis: {<br/>      range: [0, 5],<br/>    }<br/>  }<br/><br/>  constructor(private dataService: DataService) {<br/>  }<br/><br/>  ngOnInit() {<br/>    this.trace$ = this.dataService.connect()<br/>      .pipe(<br/>        map( (data) =&gt; {<br/>          return {<br/>            ...data,<br/>            type: 'scatter'<br/>          };<br/>        }<br/>      )<br/>    )<br/>  }<br/>}</span></pre><p id="0787" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">重要的是，如果没有定义跟踪，就不要呈现<code class="fe ln lo lp lq b">plotly-plot</code>。</p><pre class="kj kk kl km gt lr lq ls lt aw lu bi"><span id="e425" class="lv lw in lq b gy lx ly l lz ma">&lt;div <em class="mc">*ngIf</em>="trace$ | async as <strong class="lq io"><em class="mc">trace</em></strong>"&gt;<br/>  &lt;plotly-plot<br/>    [data]="[<strong class="lq io"><em class="mc">trace</em></strong>]"<br/>    [layout]="layout"&gt;<br/>  &lt;/plotly-plot&gt;<br/>&lt;/div&gt;</span></pre><p id="8dd3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">仅这一点，我们就获得了以下功能:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi md"><img src="../Images/d54ad34fd1c6db07a21b29bd7e60e53a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*X9OfjUnPGQ1NUQTPBfb-Gg.gif"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Real Time Chart in Angular with Plotly (image by author)</figcaption></figure><p id="0cdd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">关注更多JavaScript、绘图和数据分析。</p><p id="7d38" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mc">更多内容请看</em><a class="ae lm" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mc">plain English . io</em></strong></a></p></div></div>    
</body>
</html>