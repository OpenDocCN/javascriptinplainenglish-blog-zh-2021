<html>
<head>
<title>Build Your Own Developer tools in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Node.js中构建自己的开发人员工具</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/build-your-own-developer-tools-in-node-js-7dab8328e582?source=collection_archive---------14-----------------------#2021-05-13">https://javascript.plainenglish.io/build-your-own-developer-tools-in-node-js-7dab8328e582?source=collection_archive---------14-----------------------#2021-05-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="418f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用Node.js来构建可以为命令行快速构建的开发人员工具。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/109d2432b1c624c268002888fa56a8f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R_ttZMhT1i4FcAE6khzLKw.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Photo courtesy of Cesar Carlevarino on Unsplash</figcaption></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lb lc l"/></div></figure><p id="9fad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ld">最初发布于</em><a class="ae le" href="https://fek.io/blog/build-your-own-developer-tools-in-node-js" rel="noopener ugc nofollow" target="_blank"><em class="ld">https://fek . io</em></a><em class="ld">。</em></p><p id="ebaf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">几年前，我向JaxNode用户组做了一个关于构建自己的工具的演示。作为用户，经常会发现自己一遍又一遍地重复同样的命令。在软件开发中，你经常听说<a class="ae le" href="https://www.baeldung.com/solid-principles" rel="noopener ugc nofollow" target="_blank">坚实的原则</a>。其中一个原则是干原则，代表不要重复自己。</p><p id="2242" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你不想重复自己是一个开发者，为什么你会想做一个用户呢？这也是我自己搭建工具的原因之一。以下是我在构建自己的工具时遇到的一些任务示例。</p><ul class=""><li id="9e4d" class="lf lg iq jp b jq jr ju jv jy lh kc li kg lj kk lk ll lm ln bi translated">我创建了一个命令行工具，用于为iOS和Android应用程序生成缩略图</li><li id="4b4a" class="lf lg iq jp b jq lo ju lp jy lq kc lr kg ls kk lk ll lm ln bi translated">我还创建了一个工具，为新的博客文章生成一个markdown文件夹</li><li id="1436" class="lf lg iq jp b jq lo ju lp jy lq kc lr kg ls kk lk ll lm ln bi translated">然后我创建了一个工具来生成一个新的Node.js项目</li></ul><h1 id="5ebb" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">命令行工具</h1><p id="9a81" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">我已经使用了几个不同的框架来用Node.js创建命令行工具。您不必使用node . js。Python和Shell脚本也很流行用于创建命令行工具。甚至可以用c。</p><p id="8ef2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当使用Node.js作为命令行工具时，有两个流行的框架。第一部走红的是TJ Holowaychuk的<a class="ae le" href="https://github.com/tj/commander.js" rel="noopener ugc nofollow" target="_blank">指挥官</a>。Commander仍然是一个非常流行的框架。</p><h1 id="a527" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">奥克里夫</h1><p id="3975" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">最近一直在用<a class="ae le" href="https://oclif.io" rel="noopener ugc nofollow" target="_blank"> Oclif </a>。这是由Heroku为他们的命令行工具开发的。他们的母公司Salesforce随后用它打造了SFDX。</p><p id="dfb4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Oclif功能丰富，能够创建多个命令，添加插件，并使用TypeScript或JavaScript来开发您的实用程序。在本文中，我将使用Oclif作为例子。</p><h1 id="9014" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">在Node.js中创建新应用程序</h1><p id="a412" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">当我测试一个我可能想要使用的新NPM包或者测试Node.js中的一个新JavaScript特性时，我通常会做一些事情来建立一个新项目。我经历的任务通常如下:</p><ol class=""><li id="ca27" class="lf lg iq jp b jq jr ju jv jy lh kc li kg lj kk mw ll lm ln bi translated">创建一个目录并切换到该目录</li><li id="ae83" class="lf lg iq jp b jq lo ju lp jy lq kc lr kg ls kk mw ll lm ln bi translated">使用NPM初始化一个新项目</li><li id="3808" class="lf lg iq jp b jq lo ju lp jy lq kc lr kg ls kk mw ll lm ln bi translated">创建自述文件</li><li id="bc04" class="lf lg iq jp b jq lo ju lp jy lq kc lr kg ls kk mw ll lm ln bi translated">创建一个. gitignore文件</li><li id="da84" class="lf lg iq jp b jq lo ju lp jy lq kc lr kg ls kk mw ll lm ln bi translated">为我的应用程序的启动创建一个index.js文件</li><li id="7110" class="lf lg iq jp b jq lo ju lp jy lq kc lr kg ls kk mw ll lm ln bi translated">初始化git repo，并提交所有文件</li></ol><p id="7c51" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我在shell中从命令行执行所有这些命令，它将如下所示；</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mx lc l"/></div></figure><p id="f580" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在做了足够多的次数之后，我决定创建一个命令行工具来生成一个新项目。</p><p id="1bc0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以使用<code class="fe my mz na nb b">npx</code>生成一个新的oclif应用程序。Oclif为您提供了单命令或多命令工具的选项。对于我们的示例应用程序，我们将只使用一个命令。</p><pre class="km kn ko kp gt nc nb nd ne aw nf bi"><span id="e992" class="ng lu iq nb b gy nh ni l nj nk">&gt; npx oclif single mytestconsole</span></pre><p id="987c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将生成一个具有以下目录结构的新项目；</p><pre class="km kn ko kp gt nc nb nd ne aw nf bi"><span id="c238" class="ng lu iq nb b gy nh ni l nj nk">MYTESTCONSOLE<br/>--bin<br/>  --run<br/>  --run.cmd<br/>--node_modules<br/>--src<br/>  --index.js<br/>.editorconfig<br/>.gitignore<br/>package-lock.json<br/>package.json</span></pre><p id="ed8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe my mz na nb b">index.js</code>文件将包含设置和命令行应用程序的主要入口点。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mx lc l"/></div></figure><p id="359d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从上面生成的文件中可以看到，它包含一个用异步<code class="fe my mz na nb b">run</code>函数扩展命令类的类。它还包含描述和标志配置。<code class="fe my mz na nb b">run</code>功能是我们控制台app的主要功能和起点。</p><p id="423c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe my mz na nb b">description</code>属性是oclif的自文档部分的一部分。您在该属性中输入的任何文本都将显示在应用程序的帮助中。</p><p id="74b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe my mz na nb b">flags</code>对象属性是您配置不同标志的地方，用于从命令行控制逻辑。</p><h1 id="dd65" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">SetupNodeProject (snp)</h1><p id="ca39" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">对于我的<code class="fe my mz na nb b">Setupnodeproject</code>应用程序，我添加了一个标志，用于在生成新应用程序时创建新文件夹。最终的对象定义将如下所示；</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mx lc l"/></div></figure><p id="12a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你在上面的例子中看到的,<code class="fe my mz na nb b">folder</code>标志被定义为一个布尔值。如果用户不使用该标志，它将默认为false。</p><p id="90d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们需要定义创建文件夹的函数。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mx lc l"/></div></figure><p id="4942" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了创建这个文件夹，我使用Node.js fs/promises模块，并在我的“index.js”文件的开头需要它。</p><pre class="km kn ko kp gt nc nb nd ne aw nf bi"><span id="53ba" class="ng lu iq nb b gy nh ni l nj nk">const fsPromises = require('fs/promises');</span></pre><p id="203b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了创建<code class="fe my mz na nb b">.gitignore</code>文件，我将从我的项目的根级别的一个模板中复制它。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mx lc l"/></div></figure><p id="361e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于其余的命令，我需要使用Node.js中的<code class="fe my mz na nb b">exec</code>模块来对系统执行命令行工具。为此，我将创建一个异步函数，它可以执行我的命令。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mx lc l"/></div></figure><p id="a9d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe my mz na nb b">execPromise</code>函数是一个返回承诺的箭头函数。在JavaScript中，承诺和异步/等待函数是可以互换的。现在我可以在我的<code class="fe my mz na nb b">createGitIgnore</code>函数中使用这个函数了。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mx lc l"/></div></figure><p id="34e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从上面的函数中我们可以看到，我们执行了<code class="fe my mz na nb b">npm init -y</code>命令。这将生成package.json文件。我想做一个小的修改，允许我使用Node.js中可用的导入/导出语法。我需要添加一个值为“module”的“type”键。为此，我将使用以下函数:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mx lc l"/></div></figure><p id="aa84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我需要做的最后三件事是创建一个空白的“index.js”文件，一个“README.md”文件，并初始化git存储库，以便将我的项目保存到git源代码控制中。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mx lc l"/></div></figure><p id="161f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们可以从<code class="fe my mz na nb b">run</code>函数中调用所有这些函数来创建我们的应用程序。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mx lc l"/></div></figure><p id="fe00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您查看我们创建文件夹的逻辑，我有一个命令将工作目录更改为我们刚刚创建的目录。如果我们没有为我们的新应用程序创建目录，我们可以让工作目录保持不变，这样它就可以使用与我们运行命令行时相同的目录。</p><p id="3678" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们甚至可以通过NPM在全球安装来测试和运行它。</p><pre class="km kn ko kp gt nc nb nd ne aw nf bi"><span id="0a7f" class="ng lu iq nb b gy nh ni l nj nk">&gt; npm i -g</span></pre><p id="0bc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我可以在<a class="ae le" href="https://github.com/davidfekke/setupnodeproject" rel="noopener ugc nofollow" target="_blank"> Github </a>上查看这个当前的项目。</p><div class="nl nm gp gr nn no"><a href="https://github.com/davidfekke/setupnodeproject" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd ir gy z fp nt fr fs nu fu fw ip bi translated">davidfekke/setupnodeproject</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">通过在GitHub上创建帐户，为davidfekke/setupnodeproject开发做贡献。</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">github.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc kv no"/></div></div></a></div><p id="5799" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">已经有很多不同的项目用于生成一个节点项目。一个受欢迎的项目叫做约曼，或“约”。但是正如你所看到的，使用Node.js创建我们自己的自动化工作流工具是非常容易的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi od"><img src="../Images/ad66ee719d34d8941bfbf6729fded99e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*TFlPoed6rP1ZlyWNo-zH6Q.gif"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Creating a simple Node.js project using ‘snp’</figcaption></figure><p id="b9b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ld">更多内容尽在</em><a class="ae le" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="ld">plain English . io</em></a></p></div></div>    
</body>
</html>