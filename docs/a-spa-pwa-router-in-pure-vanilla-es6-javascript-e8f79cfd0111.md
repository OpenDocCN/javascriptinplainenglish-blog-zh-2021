# çº¯æ™®é€š ES6 JavaScript çš„ SPA/PWA è·¯ç”±å™¨

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/a-spa-pwa-router-in-pure-vanilla-es6-javascript-e8f79cfd0111?source=collection_archive---------0----------------------->

![](img/fabc41af2f263bcd90632ff7695f1e2b.png)

Photo by [Arnold Francisca](https://unsplash.com/@clark_fransa?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

äººä»¬é€‰æ‹©è¯¸å¦‚ Angularã€Vue æˆ– React ä¹‹ç±»çš„ JavaScript æ¡†æ¶ç”¨äº SPAs/PWAs çš„ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯æœ€é‡è¦çš„åŸå› ä¹‹ä¸€æ˜¯ï¼Œ **JavaScript æ²¡æœ‰å†…ç½®çš„è·¯ç”±å™¨**ã€‚

çœ‹ç€æˆ‘çš„è°·æ­Œæœç´¢ç»“æœï¼Œæˆ‘å†³å®šè‡ªå·±ç”¨æ™®é€šçš„ ES6 JavaScript å†™ä¸€ä¸ªã€‚

ä½œä¸ºæˆ‘è‡ªå·±ï¼Œæˆ‘å¯¹æˆ‘çš„æ™®é€šè·¯ç”±å™¨æœ‰ä¸€äº›è¦æ±‚:

1.  åº”è¯¥æ˜¯ ES6 ç±»æ¨¡å—
2.  å®ƒåº”è¯¥æ”¯æŒå†å²(`pushState` / `popState`)å’ŒåŸºäºæ•£åˆ—(`hashchange`)çš„è·¯ç”±
3.  å®ƒåº”è¯¥éå¸¸å®¹æ˜“ä½¿ç”¨
4.  å®ƒåº”è¯¥æä¾›çœŸå®çš„ JavaScript äº‹ä»¶æ¥ä¸ä¹‹äº¤äº’
5.  å®ƒåº”è¯¥ä¸ä»»ä½•ç»„ä»¶æ¶æ„å®Œå…¨åˆ†ç¦»ï¼Œè¿™æ ·å¼€å‘äººå‘˜å°±æœ‰å……åˆ†çš„è‡ªç”±æ¥åº”å¯¹è·¯ç”±å˜æ›´
6.  å®ƒåº”è¯¥å°½å¯èƒ½çš„ç®€æ´æ˜äº†ã€‚

# ä½¿ç”¨

æˆ‘å¯ä»¥åœ¨è¿™é‡Œåˆ—å‡ºæ‰€æœ‰çš„ä»£ç (æ­£å¦‚æˆ‘æ‰€è¯´çš„ï¼Œè¿™å¹¶ä¸å¤š)ï¼Œä½†æˆ‘è®¤ä¸ºä»ç”¨æ³•å¼€å§‹æ›´æœ‰æ„ä¹‰ï¼ŒåŒæ—¶æŸ¥çœ‹éœ€æ±‚:

![](img/212d028dedfc814a575522ff3c28f5c2.png)

Using the VanillaRouter Component

äº‹å®ä¸Šï¼Œä»ä½¿ç”¨æ¨¡å¼å¼€å§‹æ˜¯æµ‹è¯•é©±åŠ¨è®¾è®¡çš„åŸºçŸ³ï¼Œå¹¶ä¸”è¢«è®¤ä¸ºæ˜¯æœ€ä½³å®è·µï¼Œæ­£å¦‚ä¼˜ç§€çš„å¼€å‘äººå‘˜æ‰€çŸ¥é“çš„ğŸ˜‰ã€‚

ä¸Šé¢æ˜¾ç¤ºçš„ä»£ç è¿˜è¯´æ˜äº†å¦‚ä½•æ»¡è¶³ 6 ä¸ªéœ€æ±‚ä¸­çš„ 5 ä¸ªã€‚ç¬¬ 6 ä¸ªè¦æ±‚ï¼Œå¥½å§ï¼Œæˆ‘é‚€è¯·ä½ çœ‹çœ‹ä»£ç (ä¸‹é¢)ã€‚

# å±¥è¡Œ

è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹åŸºæœ¬è®¾ç½®:

```
class VanillaRouter {
   constructor(options = {}) {
     // ...
   }
}
```

listen æ–¹æ³•éœ€è¦è¿”å›ä¸€ä¸ªå¯¹è·¯ç”±å™¨çš„å¼•ç”¨ï¼Œå…è®¸é“¾æ¥(å‚è§ on() æ–¹æ³•ä¸­çš„

```
*listen() {
   // ...
   return this;
}*
```

## *æ ¸å¿ƒ*

*å¯¹äºåŸºäºå†å²çš„è·¯ç”±ï¼Œ*window . history . pushstate()*å’Œ*çª—å£*ä¸Šçš„ *popstate* äº‹ä»¶æ˜¯ä½ çš„å¥½å‹ã€‚æ‚¨å¯ä»¥åœ¨ [MDN](https://developer.mozilla.org/en-US/) ä¸­æŸ¥æ‰¾å®ƒä»¬ã€‚*

*å¯¹äºåŸºäºæ•£åˆ—çš„è·¯ç”±ï¼Œæˆ‘ä»¬ä¾èµ–äº*çª—å£*ä¸Šçš„ *hashchange* äº‹ä»¶ã€‚*

*å…¶ä»–æœ‰è¶£çš„éƒ¨åˆ†æ˜¯å¯åŠ¨æ—¶è®¾ç½®çš„ *routeHash* ã€‚è¿™æœ‰åŠ©äºæœ‰æ•ˆåœ°å°†ä¼ å…¥çš„ URL ä¸é…ç½®çš„è·¯ç”±è¿›è¡ŒåŒ¹é…ã€‚*

*æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œäº‹ä»¶ç³»ç»Ÿ(å®Œå…¨ç»„ä»¶åŒ–å’Œå¯é‡ç”¨)ä½¿ç”¨ document . createdocumentfragment()èƒ½å¤Ÿç®€å•åœ°é‡ç”¨ HTML äº‹ä»¶è°ƒåº¦å’Œç›‘å¬ã€‚å¾ˆç®¡ç”¨ã€‚æˆ‘åœ¨ä»»ä½•åœ°æ–¹éƒ½ç”¨è¿™ä¸ªã€‚*

# *å¼€æºä»£ç åº“*

*ä½ å¯ä»¥åœ¨ https://github.com/mvneerven/vanillarouter çš„[æ‰¾åˆ°æ¥æº](https://github.com/mvneerven/vanillarouter)*

*[](https://github.com/mvneerven/vanillarouter) [## GitHub - mvneerven/vanillarouter

### äººä»¬ä¸º spa/PWAs é€‰æ‹© JavaScript æ¡†æ¶çš„ç¬¬ä¸€ä¸ªåŸå› æ˜¯ JavaScript æ²¡æœ‰ä¸€ä¸ªâ€¦

github.com](https://github.com/mvneerven/vanillarouter) 

# æ¼”ç¤º

çœ‹ä¸€ä¸ªå·¥ä½œä¸­çš„[æ¼”ç¤º](https://vanillaroute.z6.web.core.windows.net/)ï¼Œä½œä¸ºä¸€ä¸ªæ— æœåŠ¡å™¨çš„é™æ€ç½‘ç«™æ‰˜ç®¡åœ¨ Azure Blob å­˜å‚¨ä¸Šã€‚

# æœ€ä¸Šä¹˜çš„ç™½å…°åœ°é…’ï¼ˆç‰¹é™ˆçº§ï¼‰

è¿™é‡Œå±•ç¤ºçš„æ™®é€šè·¯ç”±å™¨æ˜¯æˆ‘çš„ [XO-JS ç»„ä»¶åº“](https://www.xo-js.dev/)ä¸­è·¯ç”±å™¨ç»„ä»¶çš„ç‹¬ç«‹å‰¯æœ¬ã€‚

# æœ€åçš„è¯

å¦‚æœä½ å–œæ¬¢è¿™ä¸ªï¼Œç»™ç‚¹æŒå£°å’Œ/æˆ–[åœ¨ GitHub](https://github.com/mvneerven/vanillarouter) ä¸Šå¼€å§‹å›è´­ã€‚

*æ›´å¤šå†…å®¹å°½åœ¨*[***plain English . io***](http://plainenglish.io/)*