<html>
<head>
<title>Adding Graphics to a Vue App with D3 — Drag and Drop, Zoom, and CSV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用D3向Vue应用添加图形—拖放、缩放和CSV</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/adding-graphics-to-a-vue-app-with-d3-drag-and-drop-zoom-and-csv-2c1404379e9a?source=collection_archive---------9-----------------------#2021-01-31">https://javascript.plainenglish.io/adding-graphics-to-a-vue-app-with-d3-drag-and-drop-zoom-and-csv-2c1404379e9a?source=collection_archive---------9-----------------------#2021-01-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4d62af93833a332dc9550cc022843c3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*utP4VeLa_J7K0eTW"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@autofan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Auto Fan</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9dd0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">D3让我们可以轻松地向前端web应用添加图形。</p><p id="461d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue是一个流行的前端web框架。</p><p id="55a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们合作得很好。在本文中，我们将了解如何使用D3为Vue应用添加图形。</p><h1 id="2231" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">拖放</h1><p id="870f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用D3轻松地将拖放操作添加到我们的Vue应用程序中。</p><p id="e251" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1fca" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;svg&gt;<br/>      &lt;g&gt;<br/>        &lt;rect x="40" y="10" width="50" height="50" fill="teal"&gt;&lt;/rect&gt;<br/>      &lt;/g&gt;<br/>    &lt;/svg&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>import * as d3 from "d3";<br/>import Vue from "vue";</span><span id="1d2c" class="mn lc iq mj b gy ms mp l mq mr">export default {<br/>  name: "App",<br/>  mounted() {<br/>    Vue.nextTick(() =&gt; {<br/>      d3.select("g")<br/>        .datum({<br/>          x: 0,<br/>          y: 0,<br/>        })<br/>        .call(<br/>          d3.drag().on("drag", function (d) {<br/>            d3.select(this).attr("transform", `translate(${d.x} , ${d.y})`);<br/>          })<br/>        );<br/>    });<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="7b43" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个内部为矩形的SVG。</p><p id="a4c2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe mt mu mv mj b">nextTick</code>回调中，我们调用<code class="fe mt mu mv mj b">d3.select</code>来获取<code class="fe mt mu mv mj b">g</code>元素。</p><p id="d184" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe mt mu mv mj b">datum</code>来设置左上角的<code class="fe mt mu mv mj b">x</code>和<code class="fe mt mu mv mj b">y</code>坐标。</p><p id="7564" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们通过将<code class="fe mt mu mv mj b">d3.drag().on</code>方法传入<code class="fe mt mu mv mj b">call</code>方法来调用<code class="fe mt mu mv mj b">call</code>方法。</p><p id="66b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回调得到我们用<code class="fe mt mu mv mj b">this</code>拖动的元素。</p><p id="e554" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将<code class="fe mt mu mv mj b">transform</code>属性设置为拖动位置。</p><h1 id="5893" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">变焦</h1><p id="a31f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以给形状添加缩放功能。</p><p id="03bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有了它，我们可以使用鼠标滚轮来放大和缩小SVG。</p><p id="c8e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ebb3" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;div id="zoom"&gt;&lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>import * as d3 from "d3";<br/>import Vue from "vue";</span><span id="e143" class="mn lc iq mj b gy ms mp l mq mr">export default {<br/>  name: "App",<br/>  mounted() {<br/>    Vue.nextTick(() =&gt; {<br/>      const svg = d3<br/>        .select("#zoom")<br/>        .append("svg")<br/>        .attr("width", 460)<br/>        .attr("height", 460)<br/>        .call(<br/>          d3.zoom().on("zoom", function (d) {<br/>            svg.attr("transform", d.transform);<br/>          })<br/>        )<br/>        .append("g");</span><span id="985c" class="mn lc iq mj b gy ms mp l mq mr">      svg<br/>        .append("circle")<br/>        .attr("cx", 100)<br/>        .attr("cy", 100)<br/>        .attr("r", 40)<br/>        .style("fill", "#68b2a1");<br/>    });<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="3f0c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个ID为<code class="fe mt mu mv mj b">zoom</code>的div。</p><p id="d431" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe mt mu mv mj b">nextTick</code>回调中，我们获取div，然后将<code class="fe mt mu mv mj b">svg</code>元素添加到其中。</p><p id="7ec7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe mt mu mv mj b">d3.zoom</code>方法调用<code class="fe mt mu mv mj b">call</code>方法，这样我们就可以监视缩放。</p><p id="4125" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">d.transform</code>有一根线可以根据我们放大或缩小的程度来改变尺寸。</p><p id="bc6e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们加上可以放大和缩小的圆圈。</p><p id="99aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">cx</code>和<code class="fe mt mu mv mj b">cy</code>有中心的x和y坐标。</p><p id="0a06" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">r</code>有半径。</p><p id="2c78" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">style</code>有填充样式。</p><h1 id="9458" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">读取逗号分隔的值</h1><p id="ebf4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以直接从格式化数据中读取数据。</p><p id="9b47" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3d2a" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;div id="app"&gt;&lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>import * as d3 from "d3";<br/>const string = `year,population\n2011,10\n2012,20\n2013,30\n`;<br/>export default {<br/>  name: "App",<br/>  mounted() {<br/>    const data = d3.csvParse(string, function (d) {<br/>      return {<br/>        year: new Date(+d.year, 0, 1),<br/>        population: d.population,<br/>      };<br/>    });<br/>    console.log(data);<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="4487" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用<code class="fe mt mu mv mj b">d3.csvParse</code>解析CSV字符串。</p><p id="9bae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回调让我们在读取数据后返回转换后的数据。</p><p id="61e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">读取条目后，我们返回我们想要的条目的新值。</p><h1 id="9ec0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="fb25" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在我们的Vue应用程序中添加拖放、缩放和用D3读取CSV字符串。</p></div></div>    
</body>
</html>