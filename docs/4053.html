<html>
<head>
<title>Jest Spies and Mocks Explained via Examples</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">笑话间谍和嘲笑通过例子解释</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/jest-spies-and-mocks-in-explained-via-examples-71229077277f?source=collection_archive---------0-----------------------#2021-08-13">https://javascript.plainenglish.io/jest-spies-and-mocks-in-explained-via-examples-71229077277f?source=collection_archive---------0-----------------------#2021-08-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><h2 id="ad81" class="il im in bd b dl io ip iq ir is it dk iu translated" aria-label="kicker paragraph">测试</h2><div class=""/><div class=""><h2 id="3ce0" class="pw-subtitle-paragraph jt iw in bd b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk dk translated">用这两个Jest方法让您的JavaScript测试更深入、更精简、更快速</h2></div><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/25880bc085307c2e1367ae3de3d72399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WhKLjQZrj_cQPrloA35jRA.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Photo by <a class="ae lb" href="https://unsplash.com/@pheiskan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Petri Heiskanen</a> on <a class="ae lb" href="https://unsplash.com/s/photos/eye?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/93ae78e3dd413735abbd217723983a62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ms_dxMuy3rg_taorztILzA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">TL;DR</figcaption></figure><h1 id="3767" class="ld le in bd lf lg lh li lj lk ll lm ln kc lo kd lp kf lq kg lr ki ls kj lt lu bi translated">👁发现</h1><p id="e389" class="pw-post-body-paragraph lv lw in lx b ly lz jx ma mb mc ka md me mf mg mh mi mj mk ml mm mn mo mp mq ig bi translated"><code class="fe mr ms mt mu b">jest.spyOn( PROTOTYPE_OR_CLASS, METHOD_NAME )</code></p><p id="6393" class="pw-post-body-paragraph lv lw in lx b ly mv jx ma mb mw ka md me mx mg mh mi my mk ml mm mz mo mp mq ig bi translated">监视是在不改变方法本身的情况下观察对方法的调用。</p><h2 id="940b" class="na le in bd lf nb nc dn lj nd ne dp ln me nf ng lp mi nh ni lr mm nj nk lt it bi translated">窥探一种方法</h2><p id="3c10" class="pw-post-body-paragraph lv lw in lx b ly lz jx ma mb mc ka md me mf mg mh mi mj mk ml mm mn mo mp mq ig bi translated">假设您在一个模块中有一个类:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/d475d1efb50235a1a20bbefab06d8d6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mobcVlxqYl_RdPhC3_3P2Q.png"/></div></div></figure><p id="eba2" class="pw-post-body-paragraph lv lw in lx b ly mv jx ma mb mw ka md me mx mg mh mi my mk ml mm mz mo mp mq ig bi translated">这就是你如何窥探<strong class="lx ix">实例</strong>和<strong class="lx ix">静态</strong>方法:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/1ac4c1a3fde34ae47061afdf35d8baa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pnonw9n2K5LobPwrLX7jCA.png"/></div></div></figure><p id="5396" class="pw-post-body-paragraph lv lw in lx b ly mv jx ma mb mw ka md me mx mg mh mi my mk ml mm mz mo mp mq ig bi translated">如果<strong class="lx ix"> spy被分配给一个变量</strong>，你也可以通过一个变量访问它(而不是通过被监视的方法):</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/c39ceb8bdd67de3149f033365f4d1b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mHXHJ1o8_TwuVTul06AH9w.png"/></div></div></figure><p id="2a87" class="pw-post-body-paragraph lv lw in lx b ly mv jx ma mb mw ka md me mx mg mh mi my mk ml mm mz mo mp mq ig bi translated">以下是一些可以和spyOn一起使用的<strong class="lx ix">Jest matcher</strong>:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/98bea5541fe0e44c4fdaf9c82979e954.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C2LK5jJ_-v6odE1GOvK9TA.png"/></div></div></figure><h2 id="0af6" class="na le in bd lf nb nc dn lj nd ne dp ln me nf ng lp mi nh ni lr mm nj nk lt it bi translated">窥探内置方法</h2><p id="7c20" class="pw-post-body-paragraph lv lw in lx b ly lz jx ma mb mc ka md me mf mg mh mi mj mk ml mm mn mo mp mq ig bi translated">内置方法对于间谍来说也不安全。你可以这样监视他们:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/268134179158e6d183d42c07a82755b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OoQAPwK8AhbEbQSvh1jxOw.png"/></div></div></figure><h2 id="aba0" class="na le in bd lf nb nc dn lj nd ne dp ln me nf ng lp mi nh ni lr mm nj nk lt it bi translated">更改被监视的方法的实现</h2><p id="1a14" class="pw-post-body-paragraph lv lw in lx b ly lz jx ma mb mc ka md me mf mg mh mi mj mk ml mm mn mo mp mq ig bi translated">这被称为“模仿”，因为我们可以用这种方式模仿一个方法的行为，从而“模仿”这个方法。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/9ae02d05957fb013a418e8807f15492c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tF5bRoav-5ZFM2HmpE7loA.png"/></div></div></figure><p id="2491" class="pw-post-body-paragraph lv lw in lx b ly mv jx ma mb mw ka md me mx mg mh mi my mk ml mm mz mo mp mq ig bi translated">您也可以使用<code class="fe mr ms mt mu b">jest.fn()</code>替换方法的内容</p><h1 id="9e81" class="ld le in bd lf lg lh li lj lk ll lm ln kc lo kd lp kf lq kg lr ki ls kj lt lu bi translated">👻嘲弄的</h1><p id="7b40" class="pw-post-body-paragraph lv lw in lx b ly lz jx ma mb mc ka md me mf mg mh mi mj mk ml mm mn mo mp mq ig bi translated"><code class="fe mr ms mt mu b">METHOD = fn( () =&gt; {...} )</code></p><p id="53c4" class="pw-post-body-paragraph lv lw in lx b ly mv jx ma mb mw ka md me mx mg mh mi my mk ml mm mz mo mp mq ig bi translated">你可以用Jest mocks临时替换一个方法的内容。</p><h2 id="8c1d" class="na le in bd lf nb nc dn lj nd ne dp ln me nf ng lp mi nh ni lr mm nj nk lt it bi translated">模仿一种方法</h2><p id="effc" class="pw-post-body-paragraph lv lw in lx b ly lz jx ma mb mc ka md me mf mg mh mi mj mk ml mm mn mo mp mq ig bi translated">假设您在一个模块中有一个类:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/72c69649219215dee77a04974044c03b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CddX8idF-oMLrJ8u0Ut2Gg.png"/></div></div></figure><p id="73f4" class="pw-post-body-paragraph lv lw in lx b ly mv jx ma mb mw ka md me mx mg mh mi my mk ml mm mz mo mp mq ig bi translated">您可以这样替换其方法的内容:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/7258515533f1216a15d97970f3aad7e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4CPFIWd5LQUQqIxWZhl3_Q.png"/></div></div></figure><h2 id="ec69" class="na le in bd lf nb nc dn lj nd ne dp ln me nf ng lp mi nh ni lr mm nj nk lt it bi translated">模仿内置方法</h2><p id="31d9" class="pw-post-body-paragraph lv lw in lx b ly lz jx ma mb mc ka md me mf mg mh mi mj mk ml mm mn mo mp mq ig bi translated">替换。带有模拟方法的addEventListener方法:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/322deb685eddc6b013b3d9d67ef69076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UbjKfE75ltyT8pdg6AFyUw.png"/></div></div></figure><h1 id="b034" class="ld le in bd lf lg lh li lj lk ll lm ln kc lo kd lp kf lq kg lr ki ls kj lt lu bi translated">最后</h1><p id="8658" class="pw-post-body-paragraph lv lw in lx b ly lz jx ma mb mc ka md me mf mg mh mi mj mk ml mm mn mo mp mq ig bi translated">我们已经看到了两种在代码中监视方法的方法。您可以使用<code class="fe mr ms mt mu b"><strong class="lx ix">jest.spyOn</strong></code>以一种非侵入式的方式来记录通话。或者，你可以使用<code class="fe mr ms mt mu b"><strong class="lx ix">jest.fn</strong></code>用一个方法的假版本来完全替换它，这叫做‘模仿’。</p><p id="ef53" class="pw-post-body-paragraph lv lw in lx b ly mv jx ma mb mw ka md me mx mg mh mi my mk ml mm mz mo mp mq ig bi translated">编码快乐！</p><p id="89a5" class="pw-post-body-paragraph lv lw in lx b ly mv jx ma mb mw ka md me mx mg mh mi my mk ml mm mz mo mp mq ig bi translated"><em class="nl">更多内容请看</em><a class="ae lb" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lx ix"><em class="nl">plain English . io</em></strong></a></p></div></div>    
</body>
</html>