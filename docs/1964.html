<html>
<head>
<title>Functional JavaScript: Writing a Simple Command-line Game (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">函数式JavaScript:编写简单的命令行游戏(第1部分)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/functional-javascript-writing-a-simple-command-line-game-335ab9fcc005?source=collection_archive---------10-----------------------#2021-04-24">https://javascript.plainenglish.io/functional-javascript-writing-a-simple-command-line-game-335ab9fcc005?source=collection_archive---------10-----------------------#2021-04-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/33fb98b12ac055d4d72d34c65ac98f28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KrrYTU5xKZOvsLXg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@ilyapavlov?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ilya Pavlov</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><figure class="kb kc kd ke gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ka"><img src="../Images/00b1d0c019b6caad8cd7cf07527a3c5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TSRHSyfDu4YFK5LT_zVMqA.png"/></div></div></figure><p id="a3d3" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">如果您读过我以前的一篇关于使用闭包在JavaScipt中定义对象的文章，我认为一个可行的例子可能会有所帮助。这是基于我和我儿子一起写的一些代码，帮助他理解编程，并使之成为一种有趣的体验。他选择建立一个简单的命令行冒险，非常80年代风格，你必须逃离一个迷宫，同时寻找物品和与怪物战斗。</p><p id="0f19" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">首先，我们定义一个玩家对象。玩家有一个经验等级，一个装物品的袋子，并且携带一件武器。最初，武器是他们的手——玩家最好不要碰到任何危险的东西！我们也定义了一些武器以及它们的威力。</p><pre class="kb kc kd ke gt ld le lf lg aw lh bi"><span id="ae34" class="li lj in le b gy lk ll l lm ln">const character = function(who, attrib) {<br/>    attrib = attrib || {};<br/>    const _name = who;<br/>    const dv = (value,def ) <br/>           =&gt; (typeof value === "undefined")?def:value;<br/>    let _hp = dv( attrib.hp, 10 );<br/>    let _level = dv( attrib.level, 1 );<br/>    const _bag = [];<br/>    let _weapon =  dv( attrib.weapon, "hand");<br/><br/>    const weapons = {<br/>        "hand": 1,<br/>        "Iron Sword" : 2,<br/>        "Diamond Sword" : 5,<br/>        "Hammer" : 2<br/>    }<br/><br/>    function name() {<br/>        return _name;<br/>    }<br/>    function hit() {<br/>        _hp -= 1;<br/>    }<br/>    function dead() {<br/>        return _hp === 0<br/>    }<br/>    function stash( item ) {<br/>        if( weapons[item])<br/>        {<br/>            <strong class="le io"><em class="lo">console</em></strong>.log( "You found the " + item );<br/>            setWeapon( item )<br/>        }<br/>        else {<br/>            <strong class="le io"><em class="lo">console</em></strong>.log("You found the " + item <br/>                + " and placed it in your bag");<br/>            _bag.push( item );<br/>        }<br/>    }<br/>    function has( item ) {<br/>        return _bag.includes( item );<br/>    }<br/>    function getWeapon() {<br/>        return _weapon;<br/>    }<br/>    function getWeaponStat() {<br/>        return weapons[_weapon]<br/>    }<br/>    function setWeapon( item ) {<br/>        if (weapons[_weapon] &lt; weapons[item]) {<br/>            <strong class="le io"><em class="lo">console</em></strong>.log("You use the " + item);<br/>            _weapon = item;<br/>        }<br/>    }<br/>    function level() {<br/>        return _level;<br/>    }<br/>    function levelUp() {<br/>        _level += 1;<br/>    }<br/>    return { name, stash, has, getWeapon, getWeaponStat, <br/>             hit, dead, level, levelUp }<br/>}</span></pre><p id="35ea" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">我们还实现了几个助手方法；我们可以问玩家:“你死了吗？”，“你什么水平？”，我们可以“隐藏”一个物品，我们可以通过调用hit来造成一些伤害。如果藏起来的东西碰巧是武器，我们会检查它是否比我们的旧武器“更好”,然后换掉它。还有几个助手，我们稍后会讲到。</p><p id="c349" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">如果我在这里编写生产代码，我也会编写一组测试用例来证明逻辑工作正常，同样重要的是，代码处理糟糕的输入。</p><p id="fc49" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">由于我们不希望所有的字符都有相同的属性，我们将通过构造函数来设置这些属性。为此，我们将传递一个结构。您会注意到，我定义了一个小的帮助者匿名函数(lambda)来检查attrib结构是否提供了覆盖。这就是这段代码的顶部所做的。我也默认为空属性的情况。</p><pre class="kb kc kd ke gt ld le lf lg aw lh bi"><span id="1186" class="li lj in le b gy lk ll l lm ln">const character = function(who, attrib) {<br/>    attrib = attrib || {};<br/>    const _name = who;<br/>    const dv = (value,def ) =&gt; <br/>          (typeof value === "undefined")?def:value;<br/>    let _hp = dv( attrib.hp, 10 );</span></pre><p id="89eb" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">现在我们可以创建几个角色。</p><pre class="kb kc kd ke gt ld le lf lg aw lh bi"><span id="0409" class="li lj in le b gy lk ll l lm ln">const person = character( “You” );<br/>const npc = character( “Grump Ork”, { hp : 5, weapon : “Hammer” } );</span></pre><p id="a09c" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">让我们假设你不喜欢“坏脾气的Ork”，或者他们可能会攻击你。我们需要一套格斗套路。</p><p id="81b0" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">我们创建了一个模拟掷骰子的小例程，d12 +修改器</p><pre class="kb kc kd ke gt ld le lf lg aw lh bi"><span id="8593" class="li lj in le b gy lk ll l lm ln">// dieroll simulates a die roll, d12 + a modifier<br/>function dieroll( level )<br/>{<br/>    const rand = ( num ) =&gt; <strong class="le io"><em class="lo">Math</em></strong>.floor( <strong class="le io"><em class="lo">Math</em></strong>.random() * num )<br/>    return rand( 12 ) + rand( level );<br/>}</span></pre><p id="006a" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">接下来，我们定义一个函数，给定两个角色模拟他们之间的战斗。</p><pre class="kb kc kd ke gt ld le lf lg aw lh bi"><span id="0ff2" class="li lj in le b gy lk ll l lm ln">function fight( char1, char2 ) {<br/>    while (true) {<br/>        const c1roll = dieroll(char1.level()) + char1.getWeaponStat();<br/>        const c2roll = dieroll(char2.level()) + char2.getWeaponStat();<br/><br/>        if (c1roll &lt; c2roll) {<br/>            char1.hit();<br/>            <strong class="le io"><em class="lo">console</em></strong>.log( char2.name() <br/>                   + " strikes the " + char1.name());<br/>        } else if ( c1roll &gt; c2roll ) {<br/>            char2.hit()<br/>            <strong class="le io"><em class="lo">console</em></strong>.log( char1.name() <br/>                   + " strikes the " + char2.name());<br/>        } else {<br/>            <strong class="le io"><em class="lo">console</em></strong>.log( " again " );<br/>        }<br/><br/>        if (char1.dead()) {<br/>            <strong class="le io"><em class="lo">console</em></strong>.log( char1.name() <br/>                   + " is dead, killed by the " + char2.name());<br/>            return true;<br/>        }<br/>        if (char2.dead()) {<br/>            <strong class="le io"><em class="lo">console</em></strong>.log( char2.name() <br/>                   + " is dead, killed by the " + char1.name());<br/>            return false;<br/>        }<br/>    }<br/>}</span></pre><p id="b7eb" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">最后一步是创建几个角色并让他们战斗。</p><pre class="kb kc kd ke gt ld le lf lg aw lh bi"><span id="6914" class="li lj in le b gy lk ll l lm ln">const <strong class="le io"><em class="lo">you </em></strong>= character( “Player” );<br/>const <strong class="le io"><em class="lo">npc </em></strong>= character( “Grump Ork”, { hp : 5, weapon : “Hammer” } );<br/>fight( <strong class="le io"><em class="lo">you</em></strong>, <strong class="le io"><em class="lo">npc </em></strong>);</span></pre><p id="a89d" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">将所有这些代码放在一个脚本中，并在Node.js下运行。</p><pre class="kb kc kd ke gt ld le lf lg aw lh bi"><span id="ef24" class="li lj in le b gy lk ll l lm ln">Grump Ork strikes the Player</span><span id="a1aa" class="li lj in le b gy lp ll l lm ln">Player strikes the Grump Ork</span><span id="e3d2" class="li lj in le b gy lp ll l lm ln">Player strikes the Grump Ork</span><span id="d244" class="li lj in le b gy lp ll l lm ln">Player strikes the Grump Ork</span><span id="0161" class="li lj in le b gy lp ll l lm ln">Player strikes the Grump Ork</span><span id="f9c4" class="li lj in le b gy lp ll l lm ln">Grump Ork strikes the Player</span><span id="b1f1" class="li lj in le b gy lp ll l lm ln">Grump Ork strikes the Player</span><span id="5eba" class="li lj in le b gy lp ll l lm ln">Player strikes the Grump Ork</span><span id="705b" class="li lj in le b gy lp ll l lm ln">Grump Ork is dead, killed by the Player</span></pre><p id="3a80" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">如果你想确定自己更有可能赢，那就给自己一个更好的武器。</p><pre class="kb kc kd ke gt ld le lf lg aw lh bi"><span id="3089" class="li lj in le b gy lk ll l lm ln"><strong class="le io"><em class="lo">you</em></strong>.stash( “Iron Sword”);<br/>fight( <strong class="le io"><em class="lo">you</em></strong>, <strong class="le io"><em class="lo">npc </em></strong>);</span></pre><p id="2bbd" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">并再次运行；你仍然可能会输。</p><pre class="kb kc kd ke gt ld le lf lg aw lh bi"><span id="7eb2" class="li lj in le b gy lk ll l lm ln">You found the Iron Sword</span><span id="5dba" class="li lj in le b gy lp ll l lm ln">Player strikes the Grump Ork</span><span id="71a5" class="li lj in le b gy lp ll l lm ln">Grump Ork strikes the Player</span><span id="c09e" class="li lj in le b gy lp ll l lm ln">Player strikes the Grump Ork</span><span id="edc2" class="li lj in le b gy lp ll l lm ln">again</span><span id="89df" class="li lj in le b gy lp ll l lm ln">Player strikes the Grump Ork</span><span id="5b6b" class="li lj in le b gy lp ll l lm ln">Player strikes the Grump Ork</span><span id="a0de" class="li lj in le b gy lp ll l lm ln">Grump Ork strikes the Player</span><span id="7dbd" class="li lj in le b gy lp ll l lm ln">Grump Ork strikes the Player</span><span id="1214" class="li lj in le b gy lp ll l lm ln">Player strikes the Grump Ork</span><span id="428f" class="li lj in le b gy lp ll l lm ln">Grump Ork is dead, killed by the Player</span></pre><p id="34e7" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">暂时就这样了；在下一期，我们将添加一个迷宫，并开始构建游戏的其他交互。</p><p id="88b0" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated"><em class="lo">更多内容尽在</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="lo">plain English . io</em></a></p><p id="cba6" class="pw-post-body-paragraph kf kg in kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ig bi translated">有关所用样式的介绍</p><div class="lq lr gp gr ls lt"><a rel="noopener  ugc nofollow" target="_blank" href="/functional-javascript-classes-without-the-class-keyword-6e2de50a3698"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd io gy z fp ly fr fs lz fu fw im bi translated">函数式JavaScript:没有“class”关键字的类</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">了解如何在不使用class关键字的情况下使用函数式JavaScript来定义类。根据…中使用的样式</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="mc l"><div class="md l me mf mg mc mh jt lt"/></div></div></a></div></div></div>    
</body>
</html>