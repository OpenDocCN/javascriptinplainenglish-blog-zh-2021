<html>
<head>
<title>How to create a Location-based App with Firebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Firebase创建基于位置的应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-a-location-based-app-with-firebase-f8427d4bd6f7?source=collection_archive---------6-----------------------#2021-04-14">https://javascript.plainenglish.io/how-to-create-a-location-based-app-with-firebase-f8427d4bd6f7?source=collection_archive---------6-----------------------#2021-04-14</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="e359" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">使用Firebase实时数据库和Firestore浏览附近的地方</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/ebaa7c20b7a239529c787f87c6c42f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z6lbiYKaxLwRvuMw"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@cardmapr?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">CardMapr.nl</a> on <a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="858d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">想象一下，你需要创建一个应用程序，在地图上显示用户周围的一些地方。比如Foursquare或附近有自动取款机的银行应用。这个应用程序的主要功能是地理查询。你可以在特定坐标周围的半径范围内搜索物体。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj lt"><img src="../Images/405b9c532277a1df7e708baccb38ae04.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*nHaqPlPl9IF1sWKeYgImhQ.gif"/></div></figure><p id="1222" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">Firebase可以解决这样的任务。你可以打开关于地理查询的<a class="ae kw" href="https://firebase.google.com/docs/firestore/solutions/geoqueries" rel="noopener ugc nofollow" target="_blank">官方文档</a>，按照说明进行操作。你会问，这篇文章的原因是什么？我会告诉你。为了合理的定价，构建一个可扩展的定位器应用程序并不是那么简单。</p><p id="a898" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您可以对两个数据库使用地理查询:<strong class="kz is">实时数据库</strong>和<strong class="kz is"> Firestore </strong>。但是他们两个都会有陷阱:</p><ol class=""><li id="6f3e" class="lu lv ir kz b la lb ld le lg lw lk lx lo ly ls lz ma mb mc bi translated">用<strong class="kz is">实时DB </strong>跑步需要支付流量。所以当用户观看关于这个地方的细节时，他加载了数据，你需要为这个(流量)付费。</li><li id="bb9f" class="lu lv ir kz b la md ld me lg mf lk mg lo mh ls lz ma mb mc bi translated"><strong class="kz is"> Firestore </strong>数据库为您的读/写操作收费。因此，当用户浏览附近的地点时，即使他没有打开详细信息，每个地方都算作一个单独的文档阅读。</li></ol><p id="2a0a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">对于第一种观点，看起来他们两个都会榨干你的钱。但是这是一个很好的例子，它表明您并不局限于只为项目选择一个数据库。</p><p id="f904" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">选择这两个地点，使用实时数据库在地图上显示标记，使用Firestore数据库显示地点的详细信息。它将以合理的价格提供最佳的性能和可扩展性。</p><h2 id="1122" class="mi mj ir bd mk ml mm dn mn mo mp dp mq lg mr ms mt lk mu mv mw lo mx my mz na bi translated">构建应用程序</h2><p id="fcbd" class="pw-post-body-paragraph kx ky ir kz b la nb js lc ld nc jv lf lg nd li lj lk ne lm ln lo nf lq lr ls ik bi translated">让我向您展示一个简单的演示，并实现一个用户周围的位置应用程序。</p><p id="2dfa" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">首先，让我们定义最小的HTML和CSS文件。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ng nh l"/></div></figure><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ng nh l"/></div></figure><p id="ceea" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在HTML中，我们从CDN加载了几乎所有的脚本，但是对于GeoFire，我们需要用npm安装，从node_modules加载。</p><pre class="kh ki kj kk gu ni nj nk nl aw nm bi"><span id="b20f" class="mi mj ir nj b gz nn no l np nq">npm install geofire firebase</span></pre><p id="4639" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">使用google maps SDK，我们在查询参数中指定了回调名称。当SDK准备好时，Google maps将调用它。让我们定义这个回调和其余的逻辑。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ng nh l"/></div></figure><blockquote class="nr ns nt"><p id="c197" class="kx ky nu kz b la lb js lc ld le jv lf nv lh li lj nw ll lm ln nx lp lq lr ls ik bi translated"><strong class="kz is">注意:</strong> GeoFire是Firebase的一个轻量级附加组件。GeoFire在Firebase实时数据库中以其格式和位置存储数据，以保持简单。</p></blockquote><p id="e075" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因此我们可以将标记存储为GeoFire对象。在填充数据库期间，我们可以用相同的密钥保存Firestore中的文档的全部细节。如果我们需要在地图上显示小型场馆模型，我们可以在实时数据库中存储小型场馆的详细信息。向实时数据库发出几十个小请求是没问题的。它不会影响项目绩效。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj ny"><img src="../Images/603d64e8bf2325991cf14f076b20539a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_oUu3BGKvJ8Ty-8h_VvmA.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Location app database structure</figcaption></figure><p id="3807" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这是我们的简单演示看起来的样子。我们从查询地火接收标记。这个对象将包括坐标和一个键。通过按键，当用户点击场地时，我们可以从Firestore加载完整的细节。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nz"><img src="../Images/389d624ca0b890eddf6b4b79821050f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fTv64G2TgzBLFk2OiMUYJA.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Realtime location app demo</figcaption></figure><h2 id="1d8e" class="mi mj ir bd mk ml mm dn mn mo mp dp mq lg mr ms mt lk mu mv mw lo mx my mz na bi translated">结论</h2><p id="d77e" class="pw-post-body-paragraph kx ky ir kz b la nb js lc ld nc jv lf lg nd li lj lk ne lm ln lo nf lq lr ls ik bi translated">这种架构使用户能够以非常高效和廉价的方式浏览附近的场馆。甚至可能是免费的。如果你的应用平均每次搜索显示40-50个位置，那么免费层将足够每天进行50 000次搜索。这足以启动一个MVP，并以零成本测试你的项目。</p><p id="a069" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">感谢阅读！</p><p id="16a8" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><em class="nu">更多内容尽在</em><a class="ae kw" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="nu">plain English . io</em></a></p></div></div>    
</body>
</html>