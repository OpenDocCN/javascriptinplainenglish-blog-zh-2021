<html>
<head>
<title>Create User Acceptance Testing Environments on Pull Request for React Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">根据React应用程序的拉式请求创建用户验收测试环境</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-user-acceptance-testing-environments-on-pull-request-for-react-apps-4c75b3fbbe18?source=collection_archive---------8-----------------------#2021-09-10">https://javascript.plainenglish.io/create-user-acceptance-testing-environments-on-pull-request-for-react-apps-4c75b3fbbe18?source=collection_archive---------8-----------------------#2021-09-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/b57437a6eba6692c36d6beb098b9306d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bwlpPnDgaVWqPHEXz4lQQg.png"/></div></div></figure><h2 id="8089" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">处理灾难的最好方法是避免它。</h2><p id="5798" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">让我用一个例子来解释一下。如果你在建一栋房子，发现建筑材料不合格，除了重新建造，你还可以做点什么来修复它。否则继续花血汗钱每6个月修理东西。</p><p id="a773" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">软件工程也是如此。一旦有问题的/不合格的代码被合并到您的默认分支中，处理它就成了一个大问题。在这种情况下，你可以做两件事之一</p><ol class=""><li id="d18c" class="lr ls in kt b ku lm ky ln ke lt ki lu km lv ll lw lx ly lz bi translated">你花时间重构低效的代码。如果所讨论的代码是其他特性的基础，这将变得越来越困难，并且可能会使时间表偏离轨道。</li><li id="c1a5" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">第二个选择是你决定继续前进。修复QA报告的错误，并不断在顶部添加功能，以满足时间表。这种方法可能会在短期内帮助您满足时间表，但会导致大量的技术债务。这甚至会导致产品不稳定。</li></ol><p id="a6f7" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">不管怎样，处理这种情况的最好方法是避免它们！</p><p id="9370" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">那你是怎么做到的呢？</p><ul class=""><li id="045b" class="lr ls in kt b ku lm ky ln ke lt ki lu km lv ll mf lx ly lz bi translated">把棉绒放在适当的位置。现在整个团队都遵循同样的惯例。</li><li id="2918" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll mf lx ly lz bi translated">强制单元测试并设置高测试覆盖率阈值。</li><li id="f4bb" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll mf lx ly lz bi translated">至少包含以下阶段的强大CI渠道</li></ul><ol class=""><li id="778e" class="lr ls in kt b ku lm ky ln ke lt ki lu km lv ll lw lx ly lz bi translated">检验</li><li id="a2a1" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">安装依赖项</li><li id="6284" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">线头</li><li id="1c6b" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">建设</li><li id="807f" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">试验</li></ol><ul class=""><li id="65ad" class="lr ls in kt b ku lm ky ln ke lt ki lu km lv ll mf lx ly lz bi translated">进行集成测试确实很有帮助，但是在许多情况下，时间表和业务优先级不允许这样做。</li></ul><p id="8381" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">以上是减少失败概率的有效方法。然而，在处理前端应用时，美学和风格在验收标准中扮演着重要角色。即使是这种自动化也是可能的，但是你花在编写测试上的时间越多，在适应用户反馈和以真正敏捷的方式开发软件时，你的灵活性就越小。每次你基于用户研究和反馈进行迭代，你都会有一堆失败的测试，你会花时间重写/修复看似无意义的测试。</p><p id="c555" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">编写自动化可视化测试的另一种方法是在代码合并之前手动测试代码。从传统意义上来说，要做到这一点，评审人员/测试人员需要</p><ol class=""><li id="a485" class="lr ls in kt b ku lm ky ln ke lt ki lu km lv ll lw lx ly lz bi translated">取出源代码</li><li id="4efe" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">确保他们的环境设置正确。</li><li id="9b65" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">在本地安装依赖项。</li><li id="521d" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">运行应用程序</li><li id="a791" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">手动测试应用程序。</li></ol><p id="a7e2" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">看起来工作量很大，而且要花很多时间。所以我们自动化了步骤1到4。</p><p id="1391" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">在本教程中，我将带您了解如何在每次为默认分支创建PR时为React应用程序创建UAT环境。在我的例子中，默认分支是<code class="fe mg mh mi mj b">develop</code></p><p id="f682" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">本教程假设您对以下内容有很好的理解:</p><ul class=""><li id="4a50" class="lr ls in kt b ku lm ky ln ke lt ki lu km lv ll mf lx ly lz bi translated"><a class="ae mk" href="https://reactjs.org/docs/getting-started.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kt io">反应过来</strong> </a></li><li id="52e0" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll mf lx ly lz bi translated"><a class="ae mk" href="https://docs.github.com/en/actions" rel="noopener ugc nofollow" target="_blank"> <strong class="kt io"> Github动作</strong> </a></li><li id="d3bf" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll mf lx ly lz bi translated"><a class="ae mk" href="https://docs.aws.amazon.com/s3/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kt io"> AWS S3 </strong> </a></li></ul><p id="835a" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">在本教程中，您将:</p><ul class=""><li id="184f" class="lr ls in kt b ku lm ky ln ke lt ki lu km lv ll mf lx ly lz bi translated">配置react-router使用相对路径而不是绝对路径。</li><li id="ded6" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll mf lx ly lz bi translated">设置将托管UAT环境的S3存储区。对于每个分支，我们将创建一个单独的文件夹，并将工件复制到该文件夹中。</li><li id="53e6" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll mf lx ly lz bi translated">创建一个工作流，在开发分支创建PR时处理UAT部署。</li></ul><h1 id="5ac5" class="ml jw in bd jx mm mn mo ka mp mq mr kd ms mt mu kh mv mw mx kl my mz na kp nb bi translated">启动项目</h1><p id="72de" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">请克隆以下存储库:<a class="ae mk" href="https://github.com/wednesday-solutions/react-uat-on-pr" rel="noopener ugc nofollow" target="_blank">https://github.com/wednesday-solutions/react-uat-on-pr</a></p><p id="df8d" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">创建新分支:</p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="1746" class="jv jw in mj b gy nk nl l nm nn">git checkout -b feat/uat</span></pre><h1 id="3091" class="ml jw in bd jx mm mn mo ka mp mq mr kd ms mt mu kh mv mw mx kl my mz na kp nb bi translated">配置react-router以添加对相对路径的支持</h1><p id="53d2" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">将下面的代码片段复制到<code class="fe mg mh mi mj b">utils/history.js</code>文件中</p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="c841" class="jv jw in mj b gy nk nl l nm nn">import { createBrowserHistory } from 'history';<br/>import routeConstants from '<a class="ae mk" href="http://twitter.com/utils/routeConstants" rel="noopener ugc nofollow" target="_blank">@utils/routeConstants</a>';<br/>const routes = Object.keys(routeConstants);<br/>const pathname = window.location.pathname;<br/>let baseUrl = '';<br/>if (process.env.ENVIRONMENT_NAME === 'uat') {<br/>  routes.forEach(routeKey =&gt; {<br/>    const route = routeConstants[routeKey].route;<br/>    if (pathname.includes(route)) {<br/>      if (pathname.substring(pathname.length - route.length, pathname.length) === route) {<br/>        baseUrl = pathname.substring(0, pathname.length - route.length);<br/>      }<br/>      if (pathname.substring(pathname.length - route.length, pathname.length - 1) === `${route}/`) {<br/>        baseUrl = pathname.substring(0, pathname.length - route.length - 1);<br/>      }<br/>    }<br/>  });<br/>}</span><span id="ccb2" class="jv jw in mj b gy no nl l nm nn">const history = createBrowserHistory({ basename: baseUrl });<br/>export default history;</span></pre><h1 id="6cb2" class="ml jw in bd jx mm mn mo ka mp mq mr kd ms mt mu kh mv mw mx kl my mz na kp nb bi translated">在package.json中添加一个UAT构建脚本</h1><p id="1d83" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">将<code class="fe mg mh mi mj b">build:uat</code>添加到package.json中的脚本中</p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="4032" class="jv jw in mj b gy nk nl l nm nn">{<br/>  ...<br/>  "license": "MIT",<br/>  "scripts": {<br/>    ...<br/>   "build": "cross-env NODE_ENV=production webpack --config internals/webpack/webpack.config.prod.js --color --progress --stats-children --stats-error-details",<br/>    "build:uat": "export ENVIRONMENT_NAME=uat &amp;&amp; cross-env NODE_ENV=production webpack --config internals/webpack/webpack.config.prod.js --color --progress",<br/>    "build:dev": "cross-env NODE_ENV=development webpack --config internals/webpack/webpack.config.dev.js --color --progress",<br/>    ...<br/>    }<br/>}</span></pre><h1 id="c945" class="ml jw in bd jx mm mn mo ka mp mq mr kd ms mt mu kh mv mw mx kl my mz na kp nb bi translated">添加内部实用程序</h1><p id="7dc0" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">创建internalUtils文件。</p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="2808" class="jv jw in mj b gy nk nl l nm nn">touch internals/utils.js</span></pre><p id="95a6" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">将以下代码复制到新创建的文件中</p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="2579" class="jv jw in mj b gy nk nl l nm nn">function isUAT() {<br/>  return process.env.ENVIRONMENT_NAME === 'uat';<br/>}<br/>function getBasePublicPath() {<br/>  return isUAT() ? './' : '/';<br/>}</span><span id="570b" class="jv jw in mj b gy no nl l nm nn">module.exports = { getBasePublicPath, isUAT };</span></pre><ul class=""><li id="770b" class="lr ls in kt b ku lm ky ln ke lt ki lu km lv ll mf lx ly lz bi translated"><code class="fe mg mh mi mj b">isUAT</code>将用于验证当前环境名是否为<code class="fe mg mh mi mj b">uat</code></li><li id="f79c" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll mf lx ly lz bi translated"><code class="fe mg mh mi mj b">getBasePublicPath</code>如果<code class="fe mg mh mi mj b">isUAT</code>返回真，该函数返回相对基本路径。</li></ul><h1 id="77ab" class="ml jw in bd jx mm mn mo ka mp mq mr kd ms mt mu kh mv mw mx kl my mz na kp nb bi translated">配置webpack以处理相对路径</h1><h2 id="efef" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第一步</strong></h2><p id="583e" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">将这段代码添加到<code class="fe mg mh mi mj b">internals/webpack/webpack.base.config.js</code></p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="4862" class="jv jw in mj b gy nk nl l nm nn">const { getBasePublicPath } = require('../utils');<br/>const publicPath = getBasePublicPath();<br/>...<br/>module.exports = options =&gt; ({<br/>  ...,<br/>  output: Object.assign(<br/>    {<br/>      // Compile into js/build.js<br/>      path: path.resolve(process.cwd(), 'build'),<br/>      publicPath<br/>    },<br/>    ...,<br/>  ),<br/>...<br/>});</span></pre><h2 id="976f" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第二步</strong></h2><p id="15ac" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">将这段代码添加到<code class="fe mg mh mi mj b">internals/webpack/webpack.prod.config.js</code></p><p id="4493" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">确保<code class="fe mg mh mi mj b">OfflinePlugin</code>配置正确，并且不会在非uat环境中中断。</p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="d7e0" class="jv jw in mj b gy nk nl l nm nn">...<br/>const { getBasePublicPath, isUAT } = require('../utils');<br/>const publicPath = getBasePublicPath();<br/>...<br/>module.exports = require('./webpack.config.base')({<br/> ...<br/> plugins: [<br/>    new OfflinePlugin({<br/>          relativePaths: isUAT(),<br/>          publicPath,<br/>          ...<br/>    }),<br/> ...<br/> ],<br/>...<br/>});</span></pre><h2 id="14e0" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第三步</strong></h2><p id="41d8" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">现在，我们将添加一条新路线，以确保一旦应用程序被挂起，路线就能正确工作。</p><p id="6b63" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">在<code class="fe mg mh mi mj b">app/utils/routeConstants.js</code>中添加新路线</p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="d58e" class="jv jw in mj b gy nk nl l nm nn">import React from 'react';<br/>newHomePath: {<br/>    component: () =&gt; &lt;h1&gt;New Home path&lt;/h1&gt;,<br/>    ...routeConstants.newHomePath<br/>  },</span></pre><p id="65fc" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">将此片段添加到<code class="fe mg mh mi mj b">containers/App/index.js</code></p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="46a0" class="jv jw in mj b gy nk nl l nm nn">{<br/>  ...,<br/>  newHomePath: {<br/>    route: '/new-home-path',<br/>    exact: true<br/>  },<br/>};</span></pre><p id="5655" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">将这段代码添加到<code class="fe mg mh mi mj b">app/routeConfig.js</code></p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="a543" class="jv jw in mj b gy nk nl l nm nn">...<br/>export const routeConfig = {<br/>  ...,<br/>  newHomePath: {<br/>    component: () =&gt; &lt;h1&gt;New Home path&lt;/h1&gt;,<br/>    ...routeConstants.newHomePath<br/>  },<br/>  ...<br/>};</span></pre><p id="a81e" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">现在我们已经设置了新的路线，让我们添加一个按钮来导航到它。</p><p id="2d28" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">将下面的片段添加到<code class="fe mg mh mi mj b">app/containers/App/index.js</code></p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="229d" class="jv jw in mj b gy nk nl l nm nn">...<br/>export function App({ history, location }) {<br/>  return (<br/>    &lt;ThemeProvider theme={theme}&gt;<br/>      &lt;Header /&gt;<br/>      &lt;Layout.Content&gt;<br/>        &lt;button<br/>          style={{ margin: '20px' }}<br/>          onClick={() =&gt; {<br/>            history.push(routeConfig.newHomePath.route);<br/>          }}<br/>        &gt;<br/>          Go to the new route<br/>        &lt;/button&gt;<br/>        &lt;For<br/>...</span><span id="99db" class="jv jw in mj b gy no nl l nm nn">App.propTypes = {<br/>  location: PropTypes.object,<br/>  history: PropTypes.object<br/>};</span></pre><h2 id="4686" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第四步</strong></h2><p id="0724" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">现在运行<code class="fe mg mh mi mj b">build:uat</code>脚本</p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="b6a7" class="jv jw in mj b gy nk nl l nm nn">yarn build:uat</span></pre><h2 id="4be1" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第五步</strong></h2><p id="10ce" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">将构建文件夹的内容复制到其中的子文件夹中。这是模拟工作流程中将要发生的事情。我们将为每个分支使用单独的目录。</p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="0649" class="jv jw in mj b gy nk nl l nm nn">cd build<br/>mkdir test-relative-route<br/>mv -v * test-relative-route/</span></pre><p id="d1d2" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">现在运行应用程序</p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="d8d8" class="jv jw in mj b gy nk nl l nm nn">yarn start:prod</span></pre><p id="f5fa" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">前往<a class="ae mk" href="http://localhost:3000/test-relative-route" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/test-relative-route</a></p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/ac7ed75e600c77cfeba63186581b4d85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-kmya66RoWL1aFRaFiSrgw.png"/></div></div></figure><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/6d32b09051c5fa7698c3941f20b5f485.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TtF0de_ljnGvlBlSLWbnTQ.png"/></div></div></figure><p id="74cb" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">现在，我们已经验证了我们的逻辑在本地工作，让我们设置工作流来自动部署到S3。</p><h1 id="7f38" class="ml jw in bd jx mm mn mo ka mp mq mr kd ms mt mu kh mv mw mx kl my mz na kp nb bi translated">设置S3时段</h1><h2 id="059d" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第一步</strong></h2><p id="3eef" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">登录AWS控制台。<a class="ae mk" href="https://console.aws.amazon.com/console/home" rel="noopener ugc nofollow" target="_blank">https://console.aws.amazon.com/console/home</a></p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/cf8f2fa4c05fcd1bbcb84aff182b7c0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dqcfdsF-xZxjW2QqxqljPQ.png"/></div></div></figure><h2 id="90f3" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第二步</strong></h2><p id="8cd0" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">去S3。<a class="ae mk" href="https://s3.console.aws.amazon.com/s3/home?region=ap-south-1" rel="noopener ugc nofollow" target="_blank">https://s3.console.aws.amazon.com/s3/home?region=ap-south-1</a></p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ns"><img src="../Images/7d41ab503e7c533b17482bb2b77e4b29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oJ8PuKg35W2K7ZFpDDd8hw.png"/></div></div></figure><h2 id="3b94" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第三步</strong></h2><p id="0ddf" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">创建新的存储桶。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/001d776194f8897e15ae221e3b217461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1SIpqgbybSRbLLVoxwzdPg.png"/></div></div></figure><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/f9bc7b181254cf40dfd4fb6f405853da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MirEvl0DJu6Wri8SBzUzcw.png"/></div></div></figure><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/71f7c13f0990413d60cd743d29891c70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_Gfvxs9dDbEnPzJFJrNag.png"/></div></div></figure><h1 id="22fe" class="ml jw in bd jx mm mn mo ka mp mq mr kd ms mt mu kh mv mw mx kl my mz na kp nb bi translated">启用静态网站托管</h1><h2 id="9134" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第一步</strong></h2><p id="b600" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">导航到新创建的存储桶，并转到属性选项卡</p><h2 id="a1aa" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第二步</strong></h2><p id="0066" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">在页面底部，您会看到<code class="fe mg mh mi mj b">Static Web Hosting</code>选项。编辑并启用它。保存更改。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/5a59a633a5df626dc8ef07da59ade515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JHPnjRIfBENws7IcnW-1Rw.png"/></div></div></figure><h2 id="8420" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第三步</strong></h2><p id="0e9a" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">保存更改后，您将看到指向存储桶的链接。把它抄下来，放在手边。几分钟后你会需要它。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/3a71edf4e1b3162e3bcdc5e205a770d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*baTlzfNakeNwqLD3bQ8vsQ.png"/></div></div></figure><h1 id="84d6" class="ml jw in bd jx mm mn mo ka mp mq mr kd ms mt mu kh mv mw mx kl my mz na kp nb bi translated">设置秘密</h1><h2 id="825a" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">第一步</h2><p id="1c92" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">转到设置选项卡</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nv"><img src="../Images/c85cdfc597c0dba236adfd4fadc3670e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HzqnwKb2IXeAa7Em2e41hg.png"/></div></div></figure><h2 id="83f2" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第二步</strong></h2><p id="c584" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">转到机密部分</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/912d741fbd2339ed503333fc200f524b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DoVk2AkFBymnG7ATTzgq_g.png"/></div></div></figure><h2 id="6c31" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">第三步</h2><p id="8220" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">为<strong class="kt io"> AWS_REGION </strong>、<strong class="kt io"> AWS_SECRET_ACCESS_KEY </strong>、<strong class="kt io"> AWS_ACCESS_KEY_ID </strong>和<strong class="kt io"> AWS_S3_BUCKET </strong>添加秘密</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nw"><img src="../Images/6afcc717bc55f4756bae9841e967bc2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qofbAHHLhGUnGVO5r15dtA.png"/></div></div></figure><h1 id="9f18" class="ml jw in bd jx mm mn mo ka mp mq mr kd ms mt mu kh mv mw mx kl my mz na kp nb bi translated">为UAT部署创建新的工作流</h1><h2 id="5c9d" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第一步</strong></h2><p id="30f6" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">创建新文件</p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="5275" class="jv jw in mj b gy nk nl l nm nn">touch .github/workflows/uat.yml</span></pre><h2 id="64f0" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">第二步</strong></h2><p id="627e" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">将下面的片段复制到新创建的文件中</p><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="3468" class="jv jw in mj b gy nk nl l nm nn">name: Continuous Deployment on PR<br/># 1<br/>on:<br/>  pull_request:<br/>    branches:<br/>      - develop</span><span id="e53e" class="jv jw in mj b gy no nl l nm nn">jobs:<br/>  deploy:<br/>    name: Deploy<br/>    runs-on: ubuntu-latest<br/>    strategy:<br/>      matrix:<br/>        node-version: [12.x]<br/>    env: #2<br/>      SOURCE_DIR: './build/'<br/>      AWS_REGION: ${{ secrets.AWS_REGION }}<br/>      AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}<br/>      AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}<br/>      PATHS: '/*'<br/>      AWS_S3_BUCKET: ${{ secrets.AWS_S3_BUCKET }}</span></pre><ol class=""><li id="6bd9" class="lr ls in kt b ku lm ky ln ke lt ki lu km lv ll lw lx ly lz bi translated">每当为“开发”分支创建PR时，都会触发此工作流</li><li id="0b0e" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">在react-template中，构建工件存储在<code class="fe mg mh mi mj b">build</code>目录中。AWS_REGION、AWS_SECRET_ACCESS_KEY、AWS_ACCESS_KEY_ID和AWS_S3_BUCKET使用Github secrets设置。</li></ol><pre class="nc nd ne nf gt ng mj nh ni aw nj bi"><span id="1812" class="jv jw in mj b gy nk nl l nm nn">...<br/>  steps:<br/>      - uses: actions/checkout@v1 #1<br/>      - name: Get branch name #2<br/>        id: vars<br/>    run: echo ::set-output name=branch::${{github.event.pull_request.head.ref}}<br/>      - name: Install dependencies #3<br/>        run: yarn<br/>      - name: Build # 4<br/>        run: export BRANCH_NAME=${{ steps.vars.outputs.branch }} &amp;&amp; yarn build:uat<br/>      - name: AWS Deploy #5<br/>        uses: jakejarvis/s3-sync-action@v0.5.0<br/>        with:<br/>          args: --acl public-read --follow-symlinks<br/>        env:<br/>          DEST_DIR: ${{steps.vars.outputs.branch}}</span></pre><ol class=""><li id="338a" class="lr ls in kt b ku lm ky ln ke lt ki lu km lv ll lw lx ly lz bi translated">检查代码</li><li id="d52f" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">获取分支的名称</li><li id="4da2" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">安装所有依赖项</li><li id="d5a6" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">创建UAT版本</li><li id="2633" class="lr ls in kt b ku ma ky mb ke mc ki md km me ll lw lx ly lz bi translated">把藏物复制到S3。目标目录与分支名称相同。</li></ol><h1 id="d32c" class="ml jw in bd jx mm mn mo ka mp mq mr kd ms mt mu kh mv mw mx kl my mz na kp nb bi translated">推动您的代码并创建一个公关</h1><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nx"><img src="../Images/2459912bb9ee8a61f3818a7badbc55e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VWva7778jUJrEGcU1Sg41g.png"/></div></div></figure><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ny"><img src="../Images/bafca99c8c15b9a89c041e653ff98cbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDphVPI8DTyZUPm1MLU32w.png"/></div></div></figure><p id="5c72" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">部署成功后，前往您的S3桶。现在，您将会看到一个与您的分支同名的文件夹。</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nz"><img src="../Images/0db467c4fd0bc19e7a029b96e28cebd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i_7UEOhLFnMnIP-mhsuYfA.png"/></div></div></figure><p id="377f" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">现在使用您的S3部署的基本链接，与您在启用静态托管后复制的链接相同。</p><p id="6579" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">我的是:<a class="ae mk" href="http://uat-on-pr.s3-website.ap-south-1.amazonaws.com/" rel="noopener ugc nofollow" target="_blank">http://uat-on-pr.s3-website.ap-south-1.amazonaws.com/</a></p><p id="b1e0" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">将您的分支机构的名称添加到这个基本URL中，如下所示:<a class="ae mk" href="http://uat-on-pr.s3-website.ap-south-1.amazonaws.com/feat/uat" rel="noopener ugc nofollow" target="_blank">http://UAT-on-pr . S3-website . AP-south-1 . amazonaws . com/feat/UAT</a></p><p id="214d" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">现在去那个链接和维奥拉！</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ny"><img src="../Images/cf8af7efb25511f192b9bfcef953fc24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NQI8b3bKRrspRysn91QIqg.png"/></div></div></figure><h1 id="47c8" class="ml jw in bd jx mm mn mo ka mp mq mr kd ms mt mu kh mv mw mx kl my mz na kp nb bi translated">从这里去哪里</h1><p id="d761" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">我希望你喜欢这篇关于如何为UAT创建一个React应用程序的PR环境的教程。如果您有任何问题或意见，请加入下面的论坛讨论。</p><p id="e06d" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">我强烈建议看一看starter项目附带的CI管道</p><div class="oa ob gp gr oc od"><a href="https://github.com/wednesday-solutions/react-uat-on-pr/blob/master/.github/workflows/ci.yml" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd io gy z fp oi fr fs oj fu fw im bi translated">react-UAT-on-pr/ci . yml at master weekly-solutions/react-UAT-on-pr</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">在GitHub上创建一个帐户，为周三解决方案/react-uat-on-pr开发做出贡献。</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">github.com</p></div></div><div class="om l"><div class="on l oo op oq om or jt od"/></div></div></a></div></div><div class="ab cl os ot hr ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="ig ih ii ij ik"><p id="846d" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">这篇博客最初发表在<a class="ae mk" href="https://wednesday.is/" rel="noopener ugc nofollow" target="_blank"><strong class="kt io">https://星期三。是</strong> </a></p><p id="5d56" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">要了解更多关于周三工作的感受，请关注我们的<br/><a class="ae mk" href="https://www.instagram.com/wednesday.sol/" rel="noopener ugc nofollow" target="_blank"><strong class="kt io"><em class="oz">insta gram</em></strong></a><strong class="kt io"><em class="oz">|</em></strong><a class="ae mk" href="https://twitter.com/wednesdaysol" rel="noopener ugc nofollow" target="_blank"><strong class="kt io"><em class="oz">Twitter</em></strong></a><strong class="kt io"><em class="oz">|</em></strong><a class="ae mk" href="https://www.linkedin.com/company/wednesday-solutions/" rel="noopener ugc nofollow" target="_blank"><strong class="kt io"><em class="oz">LinkedIn</em></strong></a></p></div></div>    
</body>
</html>