<html>
<head>
<title>How To Do Dynamic Routing With Next.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Next.js做动态路由</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-do-dynamic-routing-with-next-js-9cd85abd9083?source=collection_archive---------10-----------------------#2021-04-07">https://javascript.plainenglish.io/how-to-do-dynamic-routing-with-next-js-9cd85abd9083?source=collection_archive---------10-----------------------#2021-04-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/106ae9ecaeb4d6e90283b44fd0c655f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OSdSUtVeGdV34V4hl_4U7g.png"/></div></div></figure><p id="ea36" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">动态路由意味着我们不想为页面指定静态路由；它将使用来自API或其他方式的数据动态生成。考虑你建立一个组合网站，它可能有网页，如关于，联系，和主页，我们需要为每个网页静态定义路线。然而，在博客的情况下，每篇文章都有一个主页、分类页面和详细页面；这个详细的页面不能用静态路由器定义，因为可能会找到数百个博客帖子，并且不可能为每个帖子定义单独的路由器。在这种情况下，我们为每个post使用一个动态路由器，然后在运行时为每个post生成一个路由器。</p><h1 id="0131" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">实施动态路由</h1><p id="9b83" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">我们将借助一个示例项目来实现动态路由。该项目将不得不显示一个特定的股票名称及其价格。在这个例子中，每只股票都有其相应的页面，这意味着如果你导航到这个链接<a class="ae lw" href="http://localhost:3000/apple" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/Apple</a>，该页面将显示苹果公司的股票名称和价格。</p><p id="fdf6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第一步是设置在终端上运行相应代码的项目。</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="b4f6" class="mg ku in mc b gy mh mi l mj mk">npx create-next-app</span></pre><p id="c8ec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">之后，您的工作区中将会有一个Next.js样板文件。在项目的文件结构中，您可以看到一个名为pages的文件夹，在pages内部创建一个名为[stock].js的文件。</p><p id="c15f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">将下面的代码片段复制到[stock]中。js文件；您可以看到两个函数，getStaticPaths和getAllStockPaths。Next.js提供了用于实现动态路由的函数getStaticPaths，函数getAllStockPaths获取所有要在URL上显示的路径名。</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="b573" class="mg ku in mc b gy mh mi l mj mk">export async function getStaticPaths() {<br/>    const paths = getAllStockPaths()<br/>    return {<br/>      paths,<br/>      fallback: false<br/>    }<br/>  }</span><span id="c8ff" class="mg ku in mc b gy ml mi l mj mk">/*<br/> *  File Name: [stock].js<br/> *  Description: This function retrieves all the stock name from<br/> *  API.                                  <br/> */</span><span id="67bf" class="mg ku in mc b gy ml mi l mj mk">const getAllStockPaths = () =&gt; {<br/>      return    [<br/>          {<br/>            params: {<br/>              stock : 'apple'<br/>            }<br/>          },<br/>          {<br/>            params: {<br/>              stock: 'facebook'<br/>            }<br/>          }<br/>        ];<br/>  }</span></pre><p id="a1fb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">将下面的代码片段添加到[stock]中。这里有两个函数，getStaticProps和getStockData。Next.js提供了getStaticProps函数，用于在初始页面加载期间调用函数，这里我们调用getStockData函数，它将获取所有股票信息。</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="a7cf" class="mg ku in mc b gy mh mi l mj mk">export async function getStaticProps({ params }) {<br/>    const postData = getStockData(params.stock)<br/>    return {<br/>      props: {<br/>        postData<br/>      }<br/>    }<br/>  }</span><span id="2ec0" class="mg ku in mc b gy ml mi l mj mk">/*<br/> * File Name: [stock].js<br/> * Description: This function retrieves all the stock information<br/> * from API. <br/> */<br/>  const getStockData = (stock) =&gt; {<br/>    const stockInfo =     {<br/>        apple : {<br/>            stock : 'apple',<br/>            price : '100$'<br/>        },<br/>        facebook : {<br/>            stock: 'facebook',<br/>            price : '200$'<br/>        }<br/>    };</span><span id="a03c" class="mg ku in mc b gy ml mi l mj mk">return stockInfo[stock];<br/>}</span></pre><p id="2fa4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最后，我们可以添加render方法，并将所有这些代码片段打包到一个文件中。编译完代码后，当你访问<a class="ae lw" href="http://localhost:3000/facebook" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/Facebook</a>时，你可以看到脸书的股票价格，而访问<a class="ae lw" href="http://localhost:3000/apple" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/Apple</a>时，你可以看到苹果公司的股票价格。</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="c96f" class="mg ku in mc b gy mh mi l mj mk">export default function Home({ postData }) {<br/>    return (<br/>      &lt;div&gt;<br/>        {`Stock is ${postData.stock}`}<br/>        &lt;div/&gt;<br/>        {`price is ${postData.price}`}<br/>      &lt;/div&gt;<br/>    )<br/>  }</span><span id="58c8" class="mg ku in mc b gy ml mi l mj mk">export async function getStaticPaths() {<br/>    const paths = getAllStockPaths()<br/>    return {<br/>      paths,<br/>      fallback: false<br/>    }<br/>  }</span><span id="2d55" class="mg ku in mc b gy ml mi l mj mk">export async function getStaticProps({ params }) {<br/>    const postData = getStockData(params.stock)<br/>    return {<br/>      props: {<br/>        postData<br/>      }<br/>    }<br/>  }</span><span id="f20d" class="mg ku in mc b gy ml mi l mj mk">/*<br/> * File Name: [stock].js<br/> * Description: This function retrieves all the stock name from API. <br/> */<br/>  const getAllStockPaths = () =&gt; {<br/>      return    [<br/>          {<br/>            params: {<br/>              stock : 'apple'<br/>            }<br/>          },<br/>          {<br/>            params: {<br/>              stock: 'facebook'<br/>            }<br/>          }<br/>        ];<br/>  }</span><span id="6098" class="mg ku in mc b gy ml mi l mj mk">/*<br/> * File Name: [stock].js<br/> * Description: This function retrieves all the stock information<br/> *  from API. <br/> */<br/>  const getStockData = (stock) =&gt; {<br/>    const stockInfo =     {<br/>        apple : {<br/>            stock : 'apple',<br/>            price : '100$'<br/>        },<br/>        facebook : {<br/>            stock: 'facebook',<br/>            price : '200$'<br/>        }<br/>    };</span><span id="3388" class="mg ku in mc b gy ml mi l mj mk">return stockInfo[stock];<br/>}</span></pre><h2 id="2855" class="mg ku in bd kv mm mn dn kz mo mp dp ld kg mq mr lh kk ms mt ll ko mu mv lp mw bi translated">结论</h2><p id="59ba" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">感谢您的阅读。我希望您发现这很有用，并且对了解如何使用Next.js创建动态路线有所了解。</p><p id="5f45" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mx">更多内容请看</em><a class="ae lw" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="mx">plain English . io</em></strong></a></p></div></div>    
</body>
</html>