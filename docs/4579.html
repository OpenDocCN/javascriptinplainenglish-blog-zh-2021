<html>
<head>
<title>React Query vs SWR</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应查询vs SWR</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-query-vs-swr-36743c14ba7e?source=collection_archive---------2-----------------------#2021-09-13">https://javascript.plainenglish.io/react-query-vs-swr-36743c14ba7e?source=collection_archive---------2-----------------------#2021-09-13</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="a71e" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">你的下一个项目应该选择哪一个？</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/12a6b6ffc707a852ded5e92781cb55e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3KqhA03U1xBkNGx7cr5riA.jpeg"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Photo by <a class="ae kw" href="https://www.pexels.com/@vera-arsic-304265?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Vera Arsic</a> from <a class="ae kw" href="https://www.pexels.com/photo/man-and-woman-wearing-brown-leather-jackets-984950/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><p id="8ebf" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">大多数现代web应用程序都依赖于一些外部数据源。在React中，我们通常使用<code class="fe lt lu lv lw b">fetch</code>或<code class="fe lt lu lv lw b">axios</code>从远程端点获取数据。</p><p id="6127" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">然而，这两个库只能做这么多。我们仍然需要自己实现加载状态、错误处理、缓存、分页、重新验证所有这些东西。</p><p id="901b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是有两个流行的库可以解决这些问题。它们是:</p><h2 id="d326" class="lx ly ir bd lz ma mb dn mc md me dp mf lg mg mh mi lk mj mk ml lo mm mn mo mp bi translated">反应查询</h2><p id="8ca9" class="pw-post-body-paragraph kx ky ir kz b la mq js lc ld mr jv lf lg ms li lj lk mt lm ln lo mu lq lr ls ik bi translated">根据<a class="ae kw" href="https://react-query.tanstack.com/" rel="noopener ugc nofollow" target="_blank">文档</a>该图书馆提供的是</p><blockquote class="mv mw mx"><p id="1a0c" class="kx ky my kz b la lb js lc ld le jv lf mz lh li lj na ll lm ln nb lp lq lr ls ik bi translated">获取、缓存和更新React和React本地应用程序中的数据，而无需触及任何“全局状态”。</p></blockquote><p id="36db" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">另一个图书馆是</p><h2 id="a4e6" class="lx ly ir bd lz ma mb dn mc md me dp mf lg mg mh mi lk mj mk ml lo mm mn mo mp bi translated">SWR</h2><p id="5fd3" class="pw-post-body-paragraph kx ky ir kz b la mq js lc ld mr jv lf lg ms li lj lk mt lm ln lo mu lq lr ls ik bi translated">这个库将自己识别为</p><blockquote class="mv mw mx"><p id="a474" class="kx ky my kz b la lb js lc ld le jv lf mz lh li lj na ll lm ln nb lp lq lr ls ik bi translated">用于数据获取的React挂钩</p></blockquote><p id="a6cd" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">今天，我们将比较这两种解决方案，看看哪种方案更好。</p><h1 id="09e7" class="nc ly ir bd lz nd ne nf mc ng nh ni mf jx nj jy mi ka nk kb ml kd nl ke mo nm bi translated">常见的事情</h1><p id="57b3" class="pw-post-body-paragraph kx ky ir kz b la mq js lc ld mr jv lf lg ms li lj lk mt lm ln lo mu lq lr ls ik bi translated">先说共同特点。这两个库都可以执行常见的任务，如</p><ul class=""><li id="7523" class="nn no ir kz b la lb ld le lg np lk nq lo nr ls ns nt nu nv bi translated">询问</li><li id="05cc" class="nn no ir kz b la nw ld nx lg ny lk nz lo oa ls ns nt nu nv bi translated">贮藏</li><li id="7919" class="nn no ir kz b la nw ld nx lg ny lk nz lo oa ls ns nt nu nv bi translated">投票</li><li id="dabe" class="nn no ir kz b la nw ld nx lg ny lk nz lo oa ls ns nt nu nv bi translated">并行查询</li><li id="1c38" class="nn no ir kz b la nw ld nx lg ny lk nz lo oa ls ns nt nu nv bi translated">原始数据</li><li id="c697" class="nn no ir kz b la nw ld nx lg ny lk nz lo oa ls ns nt nu nv bi translated">窗口焦点重新获取</li><li id="4105" class="nn no ir kz b la nw ld nx lg ny lk nz lo oa ls ns nt nu nv bi translated">网络状态重新获取</li></ul><p id="c1c9" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在我们来谈谈它们之间的区别</p><h1 id="4504" class="nc ly ir bd lz nd ne nf mc ng nh ni mf jx nj jy mi ka nk kb ml kd nl ke mo nm bi translated">开发工具</h1><p id="22a0" class="pw-post-body-paragraph kx ky ir kz b la mq js lc ld mr jv lf lg ms li lj lk mt lm ln lo mu lq lr ls ik bi translated">这是一个大的。React query提供了非常棒的Devtools。我们必须在根里面传递它。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ob oc l"/></div></figure><p id="474e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">不幸的是，SWR没有任何开发工具。有一些第三方软件包可以做到这一点。</p><p id="0230" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">所以这是react-query的一大胜利。</p><h1 id="a714" class="nc ly ir bd lz nd ne nf mc ng nh ni mf jx nj jy mi ka nk kb ml kd nl ke mo nm bi translated">全局错误处理程序</h1><p id="96ce" class="pw-post-body-paragraph kx ky ir kz b la mq js lc ld mr jv lf lg ms li lj lk mt lm ln lo mu lq lr ls ik bi translated">在<code class="fe lt lu lv lw b">SWRConfig</code>的帮助下，我们可以在SWR启用全局错误处理。</p><p id="cada" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">为了启用它，我们像下面这样包装我们的根</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ob oc l"/></div></figure><p id="0992" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是由于一些奇怪的原因，React query没有这个特性。我们可以通过自己创造一个特殊的挂钩来实现这一点，但如果有官方的支持，那就太棒了。</p><h2 id="1cae" class="lx ly ir bd lz ma mb dn mc md me dp mf lg mg mh mi lk mj mk ml lo mm mn mo mp bi translated">更新</h2><p id="80c8" class="pw-post-body-paragraph kx ky ir kz b la mq js lc ld mr jv lf lg ms li lj lk mt lm ln lo mu lq lr ls ik bi translated">显然，react-query对全局错误处理有官方支持。您必须在全局配置中使用查询缓存的<code class="fe lt lu lv lw b">onError</code>。像下面这样。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ob oc l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">GlobalErrorHandler.jsx</figcaption></figure><p id="1e3a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">所以这一轮是平局:P</p><p id="6721" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">感谢<a class="od oe ep" href="https://medium.com/u/a2fa50dd5795?source=post_page-----36743c14ba7e--------------------------------" rel="noopener" target="_blank">张秀坤·多夫迈斯特</a>的更正。你可以在这里查看他关于这个话题的文章<a class="ae kw" href="https://tkdodo.eu/blog/react-query-error-handling" rel="noopener ugc nofollow" target="_blank"/></p><h1 id="dd27" class="nc ly ir bd lz nd ne nf mc ng nh ni mf jx nj jy mi ka nk kb ml kd nl ke mo nm bi translated">变异钩</h1><p id="744f" class="pw-post-body-paragraph kx ky ir kz b la mq js lc ld mr jv lf lg ms li lj lk mt lm ln lo mu lq lr ls ik bi translated">在React查询中，默认情况下我们有变异挂钩。它们大概是这样的</p><pre class="kh ki kj kk gu of lw og oh aw oi bi"><span id="0786" class="lx ly ir lw b gz oj ok l ol om">const mutation = useMutation(newTodo =&gt; axios.post('/todos', newTodo))</span></pre><p id="ff94" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但在SWR，我们没有任何变异挂钩，而是可以选择手动操作数据，这不像变异挂钩那样方便。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ob oc l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">mutation.tsx</figcaption></figure><p id="d4b4" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因此，这显然是React Query的巨大胜利</p><h1 id="e8d8" class="nc ly ir bd lz nd ne nf mc ng nh ni mf jx nj jy mi ka nk kb ml kd nl ke mo nm bi translated">捆绑大小</h1><p id="b4db" class="pw-post-body-paragraph kx ky ir kz b la mq js lc ld mr jv lf lg ms li lj lk mt lm ln lo mu lq lr ls ik bi translated">根据<a class="ae kw" href="https://bundlephobia.com/" rel="noopener ugc nofollow" target="_blank"> BundlePhobia </a>的说法，SWR的包大小为15kb，而React Query的包大小为50kb。哪是<strong class="kz is">的3倍以上！</strong></p><div class="kh ki kj kk gu ab cb"><figure class="on kl oo op oq or os paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><img src="../Images/dae75912fb742334d9643753addf44e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*9t_yGN013Z7BEssC0RgCqw.png"/></div></figure><figure class="on kl oo op oq or os paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><img src="../Images/50331d6d2f861ba38dec4d51c22b16af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*V_5cVTmtCeoSszdAUHwuQQ.png"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk ot di ou ov">SWR vs React Query</figcaption></figure></div><p id="974d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">所以如果你考虑规模，那么很明显SWR在这里以很大优势获胜！</p><h1 id="0e1d" class="nc ly ir bd lz nd ne nf mc ng nh ni mf jx nj jy mi ka nk kb ml kd nl ke mo nm bi translated">碎片帐集</h1><p id="7d1d" class="pw-post-body-paragraph kx ky ir kz b la mq js lc ld mr jv lf lg ms li lj lk mt lm ln lo mu lq lr ls ik bi translated">根据react-query文档，如果任何查询在5分钟内保持非活动状态，所有缓存的数据都将被垃圾收集。</p><p id="eda9" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">此外，我们还可以通过更改配置选项中的<code class="fe lt lu lv lw b">cacheTime</code>来根据我们的需求进行配置。</p><p id="4c78" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是在SWR没有垃圾收集。所以如果你想的话，你必须手动操作缓存。</p><p id="eee0" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因此，这是React查询的一个胜利</p><h1 id="04ac" class="nc ly ir bd lz nd ne nf mc ng nh ni mf jx nj jy mi ka nk kb ml kd nl ke mo nm bi translated">定论</h1><p id="f11d" class="pw-post-body-paragraph kx ky ir kz b la mq js lc ld mr jv lf lg ms li lj lk mt lm ln lo mu lq lr ls ik bi translated">在我看来，这两个库都非常好，并且可以通过提高应用程序的性能来简化开发人员的工作。</p><p id="46b4" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">然而，很明显，react-query有一些SWR没有的非常强大的功能。但是随之而来的是增加束尺寸的成本。</p><p id="5558" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因此，如果您正在构建一个简单的应用程序，并且想要一个现成的简单解决方案，那么SWR应该是您的选择。</p><p id="e001" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是如果你需要更多的控制和定制，并且想从开发者工具中获得最大的收益，那么一定要选择react-query。</p></div><div class="ab cl ow ox hv oy" role="separator"><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb"/></div><div class="ik il im in io"><p id="b90f" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">今天到此为止。希望现在您对这两个库的相互比较有了更好的理解。</p><p id="c6ee" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">祝你有美好的一天！</p><p id="3790" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is">通过</strong><a class="ae kw" href="https://www.linkedin.com/in/56faisal/" rel="noopener ugc nofollow" target="_blank"><strong class="kz is">LinkedIn</strong></a><strong class="kz is">或我的</strong> <a class="ae kw" href="https://www.mohammadfaisal.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is">个人网站</strong> </a> <strong class="kz is">与我取得联系。</strong></p><p id="d622" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/45-npm-packages-to-solve-16-react-problems-a9ab18946224">https://JavaScript . plain English . io/45-NPM-packages-to-solve-16-react-problems-a9ab 18946224</a></p></div></div>    
</body>
</html>