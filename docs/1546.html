<html>
<head>
<title>Make a Pinterest Chrome Extension</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">制作Pinterest Chrome扩展</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/make-a-pinterest-chrome-extension-bc4900c76414?source=collection_archive---------10-----------------------#2021-04-02">https://javascript.plainenglish.io/make-a-pinterest-chrome-extension-bc4900c76414?source=collection_archive---------10-----------------------#2021-04-02</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="a6e5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将你浏览的网站保存在Pinterest板上。</p><p id="9000" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这篇文章假设你知道如何从头开始创建一个JavaScript Pinterest克隆。如果你不知道如何，在这里观看教程<a class="ae ki" rel="noopener ugc nofollow" target="_blank" href="/create-a-javascript-pinterest-clone-68b8ca786b66"><strong class="jm io"/></a><strong class="jm io">。</strong></p><p id="f46c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于本教程，我们只是升级了JavaScript Pinterest克隆的功能，并将其集成到Chrome扩展中。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/b100c6a3d397ebf20ff975d1946accab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hcuqM67EdB1NESUl.png"/></div></div></figure><h1 id="9e77" class="kv kw in bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated"><strong class="ak">第一部分。整合</strong></h1><h2 id="7920" class="lt kw in bd kx lu lv dn lb lw lx dp lf jv ly lz lj jz ma mb ln kd mc md lr me bi translated">让我们回顾一下我们的文件结构。</h2><p id="a126" class="pw-post-body-paragraph jk jl in jm b jn mf jp jq jr mg jt ju jv mh jx jy jz mi kb kc kd mj kf kg kh ig bi translated">我们将从<strong class="jm io"> manifest.json </strong>开始。</p><pre class="kk kl km kn gt mk ml mm mn aw mo bi"><span id="f6fb" class="lt kw in ml b gy mp mq l mr ms">{</span><span id="e38e" class="lt kw in ml b gy mt mq l mr ms">  “name”: “Pinterest Chrome Extension”,</span><span id="00e8" class="lt kw in ml b gy mt mq l mr ms">  “description”: “Pinterest Chrome Extension”,</span><span id="cd63" class="lt kw in ml b gy mt mq l mr ms">  “version”: “0.1.0”,</span><span id="d4cf" class="lt kw in ml b gy mt mq l mr ms">  “manifest_version”: 2,</span><span id="3c62" class="lt kw in ml b gy mt mq l mr ms">  “icons”: {</span><span id="7bf0" class="lt kw in ml b gy mt mq l mr ms">    “16”: “./images/icon-16x16.png”,</span><span id="2e94" class="lt kw in ml b gy mt mq l mr ms">    “32”: “./images/icon-32x32.png”,</span><span id="82ab" class="lt kw in ml b gy mt mq l mr ms">    “48”: “./images/icon-48x48.png”,</span><span id="882e" class="lt kw in ml b gy mt mq l mr ms">    “128”: “./images/icon-128x128.png”</span><span id="34c8" class="lt kw in ml b gy mt mq l mr ms">  },</span><span id="dfc2" class="lt kw in ml b gy mt mq l mr ms">  “background”: {</span><span id="5a36" class="lt kw in ml b gy mt mq l mr ms">    “scripts”: [“./scripts/background.js”]</span><span id="3d33" class="lt kw in ml b gy mt mq l mr ms">  },</span><span id="18fb" class="lt kw in ml b gy mt mq l mr ms">  “browser_action”: {</span><span id="c1ee" class="lt kw in ml b gy mt mq l mr ms">    “default_popup”: “popup.html”</span><span id="632c" class="lt kw in ml b gy mt mq l mr ms">  },</span><span id="7bcf" class="lt kw in ml b gy mt mq l mr ms">  “permissions”: [</span><span id="d8d3" class="lt kw in ml b gy mt mq l mr ms">    “tabs”,</span><span id="8e1c" class="lt kw in ml b gy mt mq l mr ms">    “storage”,</span><span id="99a7" class="lt kw in ml b gy mt mq l mr ms">    “unlimitedStorage”,</span><span id="d72f" class="lt kw in ml b gy mt mq l mr ms">    “https://*/*png",</span><span id="9b71" class="lt kw in ml b gy mt mq l mr ms">    “https://*/*jpg",</span><span id="f0ab" class="lt kw in ml b gy mt mq l mr ms">    “https://*/*jpeg",</span><span id="2516" class="lt kw in ml b gy mt mq l mr ms">    “https://*/*gif"</span><span id="bb7b" class="lt kw in ml b gy mt mq l mr ms">  ]</span><span id="de26" class="lt kw in ml b gy mt mq l mr ms">}</span></pre><p id="2f28" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注意事项:</strong></p><ul class=""><li id="5b6a" class="mu mv in jm b jn jo jr js jv mw jz mx kd my kh mz na nb nc bi translated">我们需要一个背景脚本来协调我们的整个扩展。</li><li id="72c2" class="mu mv in jm b jn nd jr ne jv nf jz ng kd nh kh mz na nb nc bi translated">我们需要<strong class="jm io">选项卡权限</strong>，这样我们就可以保存网站的网址。</li><li id="8799" class="mu mv in jm b jn nd jr ne jv nf jz ng kd nh kh mz na nb nc bi translated">我们需要<strong class="jm io">存储</strong>和<strong class="jm io">无限存储权限</strong>，这样我们就可以保存Pin数据(包括图像数据)。</li><li id="8bc0" class="mu mv in jm b jn nd jr ne jv nf jz ng kd nh kh mz na nb nc bi translated">我们需要以图像扩展结尾的<strong class="jm io">域/主机权限，以允许我们的扩展下载图像。</strong></li></ul><p id="be85" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">我们的popup.html</strong>将是一个简单的页面，为用户提供选项<strong class="jm io">基于他们正在访问的当前站点添加新的Pin码</strong>或<strong class="jm io">打开他们的Pin码板并手动添加Pin码</strong>。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ni"><img src="../Images/63ed428bf14c16a507fac63952902617.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zjxnw-In4em0MYqC.png"/></div></div></figure><p id="6b93" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">为了将我们实际的Pinterest板集成到扩展中，我们只需在用户浏览器中用我们的Pinterest板打开一个新标签。</strong></p><p id="589d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，当用户点击我们的<strong class="jm io">popup.html</strong>中的一个按钮时，我们执行一个<strong class="jm io"> popup_script.js </strong>脚本，告诉我们的<strong class="jm io"> background.js </strong>打开我们的开发板或添加一个Pin。</p><pre class="kk kl km kn gt mk ml mm mn aw mo bi"><span id="e469" class="lt kw in ml b gy mp mq l mr ms">chrome.runtime.onMessage.addListener((request, sender, sendResponse) =&gt; {</span><span id="baf7" class="lt kw in ml b gy mt mq l mr ms">  if (request.message === ‘add_pin’) {</span><span id="88b2" class="lt kw in ml b gy mt mq l mr ms">    new_pin_data = { …request.payload };</span><span id="86ac" class="lt kw in ml b gy mt mq l mr ms">    chrome.tabs.create({</span><span id="0157" class="lt kw in ml b gy mt mq l mr ms">      active: true,</span><span id="2894" class="lt kw in ml b gy mt mq l mr ms">      url: ‘./board.html’</span><span id="7e06" class="lt kw in ml b gy mt mq l mr ms">    }, tab =&gt; recent_tab = tab.id);</span><span id="7139" class="lt kw in ml b gy mt mq l mr ms">  } else if (request.message === ‘my_board’) {</span><span id="c179" class="lt kw in ml b gy mt mq l mr ms">    chrome.tabs.create({</span><span id="46f3" class="lt kw in ml b gy mt mq l mr ms">      active: true,</span><span id="920a" class="lt kw in ml b gy mt mq l mr ms">      url: ‘./board.html’</span><span id="82d9" class="lt kw in ml b gy mt mq l mr ms">    });</span><span id="4bb1" class="lt kw in ml b gy mt mq l mr ms">  }</span><span id="7e45" class="lt kw in ml b gy mt mq l mr ms">}</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/9eaad2bf62b2f5ef91d10579369667c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/0*e2yHtlEFDu2o9ZDh.gif"/></div></figure></div><div class="ab cl nk nl hr nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ig ih ii ij ik"><h1 id="5aab" class="kv kw in bd kx ky nr la lb lc ns le lf lg nt li lj lk nu lm ln lo nv lq lr ls bi translated"><strong class="ak">第二部分。升级</strong></h1><h2 id="3dc0" class="lt kw in bd kx lu lv dn lb lw lx dp lf jv ly lz lj jz ma mb ln kd mc md lr me bi translated"><strong class="ak">让我们添加从URL保存图像的功能。</strong></h2><p id="5f9a" class="pw-post-body-paragraph jk jl in jm b jn mf jp jq jr mg jt ju jv mh jx jy jz mi kb kc kd mj kf kg kh ig bi translated">当用户点击我们的“<strong class="jm io">从站点</strong>保存”按钮时，我们将打开一个<strong class="jm io">输入</strong>并获取一个URL。</p><p id="2aba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将使用一个<strong class="jm io">获取</strong>来获取图像，并以与从本地硬盘中选择图像相同的方式对其进行处理。</p><pre class="kk kl km kn gt mk ml mm mn aw mo bi"><span id="5052" class="lt kw in ml b gy mp mq l mr ms">&lt;!-- board.html --&gt;</span><span id="6bf2" class="lt kw in ml b gy mt mq l mr ms">&lt;div class=”save_from_site”&gt;</span><span id="8cf6" class="lt kw in ml b gy mt mq l mr ms">  &lt;span style=”pointer-events: none;”&gt;Save From Site&lt;/span&gt;</span><span id="426c" class="lt kw in ml b gy mt mq l mr ms">  &lt;input placeholder=”Past a URL to an image” type=”text” <br/>    name=”save_from_site_input” id=”save_from_site_input”&gt;</span><span id="2ea6" class="lt kw in ml b gy mt mq l mr ms">  &lt;div class=”upload_image_url”&gt;Upload&lt;/div&gt;</span><span id="b4ac" class="lt kw in ml b gy mt mq l mr ms">  &lt;div class=”cancel_image_url”&gt;Cancel&lt;/div&gt;</span><span id="1f27" class="lt kw in ml b gy mt mq l mr ms">&lt;/div&gt;</span><span id="838f" class="lt kw in ml b gy mt mq l mr ms">// board.js</span><span id="69a9" class="lt kw in ml b gy mt mq l mr ms">if (event.target === save_from_site) {</span><span id="cf18" class="lt kw in ml b gy mt mq l mr ms">  // hide the ‘save from site’ button</span><span id="673b" class="lt kw in ml b gy mt mq l mr ms">  // show the input for taking a url</span><span id="f7be" class="lt kw in ml b gy mt mq l mr ms">  // show the upload button</span><span id="869f" class="lt kw in ml b gy mt mq l mr ms">  // show the cancel button</span><span id="d1b1" class="lt kw in ml b gy mt mq l mr ms">} else if (event.target === upload_image_url) {</span><span id="1fe8" class="lt kw in ml b gy mt mq l mr ms">  // fetch the image from the url</span><span id="28e0" class="lt kw in ml b gy mt mq l mr ms">  // parse the image as a blob</span><span id="e279" class="lt kw in ml b gy mt mq l mr ms">  // read the image into our Pinterest board</span><span id="e792" class="lt kw in ml b gy mt mq l mr ms">} else if (event.target === cancel_image_url) {</span><span id="bdbb" class="lt kw in ml b gy mt mq l mr ms">  // show the ‘save from site’ button</span><span id="a568" class="lt kw in ml b gy mt mq l mr ms">  // hide the input for taking a url</span><span id="c69b" class="lt kw in ml b gy mt mq l mr ms">  // hide the upload button</span><span id="b5d2" class="lt kw in ml b gy mt mq l mr ms">  // hide the cancel button</span><span id="c9b1" class="lt kw in ml b gy mt mq l mr ms">}</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/3a5f9b4687e978d0ae96e448fccb3e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/0*8MpkdmJhTp2At9bq.gif"/></div></figure></div><div class="ab cl nk nl hr nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ig ih ii ij ik"><h1 id="e6a6" class="kv kw in bd kx ky nr la lb lc ns le lf lg nt li lj lk nu lm ln lo nv lq lr ls bi translated"><strong class="ak">第三部分。存储</strong></h1><h2 id="39ad" class="lt kw in bd kx lu lv dn lb lw lx dp lf jv ly lz lj jz ma mb ln kd mc md lr me bi translated"><strong class="ak">让我们使用Chrome的‘local storage’API。</strong></h2><p id="462b" class="pw-post-body-paragraph jk jl in jm b jn mf jp jq jr mg jt ju jv mh jx jy jz mi kb kc kd mj kf kg kh ig bi translated">将数据保存到用户的硬盘非常简单。我们将把信息保存为一个<strong class="jm io">对象数组</strong>。</p><p id="fed0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">通过使用“存储”API的两次调用，我们可以获得先前保存的<strong class="jm io">引脚</strong>:</p><pre class="kk kl km kn gt mk ml mm mn aw mo bi"><span id="460d" class="lt kw in ml b gy mp mq l mr ms">chrome.storage.local.get(‘pins’, data =&gt; {});</span></pre><p id="dbfe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将新的<strong class="jm io">引脚</strong>添加到数据集中。</p><pre class="kk kl km kn gt mk ml mm mn aw mo bi"><span id="1b7b" class="lt kw in ml b gy mp mq l mr ms">const new_pins = data.pins ? […data.pins, new_pin_data] : [new_pin_data];</span></pre><p id="32c8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">并保存更新后的<strong class="jm io">引脚</strong>。</p><pre class="kk kl km kn gt mk ml mm mn aw mo bi"><span id="1a30" class="lt kw in ml b gy mp mq l mr ms">chrome.storage.local.set({ pins: new_pins });</span></pre><p id="ebb3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，当请求时，我们可以将保存的pin提供给Pinterest板。</p><pre class="kk kl km kn gt mk ml mm mn aw mo bi"><span id="dc36" class="lt kw in ml b gy mp mq l mr ms">// board.js</span><span id="1b7f" class="lt kw in ml b gy mt mq l mr ms">chrome.runtime.sendMessage({</span><span id="6208" class="lt kw in ml b gy mt mq l mr ms">  message: ‘get_pins’</span><span id="caea" class="lt kw in ml b gy mt mq l mr ms">}, response =&gt; {</span><span id="7bae" class="lt kw in ml b gy mt mq l mr ms">  if (response.message === ‘success’) {</span><span id="5a74" class="lt kw in ml b gy mt mq l mr ms">    response.payload.forEach(pin_data =&gt; {</span><span id="0813" class="lt kw in ml b gy mt mq l mr ms">      create_pin(pin_data);</span><span id="2abd" class="lt kw in ml b gy mt mq l mr ms">    });</span><span id="0838" class="lt kw in ml b gy mt mq l mr ms">  }</span><span id="a343" class="lt kw in ml b gy mt mq l mr ms">});</span><span id="502b" class="lt kw in ml b gy mt mq l mr ms">// background.js</span><span id="5631" class="lt kw in ml b gy mt mq l mr ms">…</span><span id="51b2" class="lt kw in ml b gy mt mq l mr ms">} else if (request.message === ‘get_pins’) {</span><span id="21b0" class="lt kw in ml b gy mt mq l mr ms">  chrome.storage.local.get(‘pins’, data =&gt; {</span><span id="e53b" class="lt kw in ml b gy mt mq l mr ms">    if (chrome.runtime.lastError) {</span><span id="2819" class="lt kw in ml b gy mt mq l mr ms">      sendResponse({ message: ‘fail’ });</span><span id="de76" class="lt kw in ml b gy mt mq l mr ms">      return;</span><span id="1747" class="lt kw in ml b gy mt mq l mr ms">    }</span><span id="bba8" class="lt kw in ml b gy mt mq l mr ms">    sendResponse({</span><span id="e1c3" class="lt kw in ml b gy mt mq l mr ms">      message: ‘success’,</span><span id="e41f" class="lt kw in ml b gy mt mq l mr ms">      payload: data.pins ? data.pins : []</span><span id="c2f2" class="lt kw in ml b gy mt mq l mr ms">    });</span><span id="fb39" class="lt kw in ml b gy mt mq l mr ms">  });</span><span id="16cb" class="lt kw in ml b gy mt mq l mr ms">return true;</span><span id="9d0f" class="lt kw in ml b gy mt mq l mr ms">}</span></pre></div><div class="ab cl nk nl hr nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ig ih ii ij ik"><h2 id="65b6" class="lt kw in bd kx lu lv dn lb lw lx dp lf jv ly lz lj jz ma mb ln kd mc md lr me bi translated">这个项目有更多的细微差别。</h2><p id="b25c" class="pw-post-body-paragraph jk jl in jm b jn mf jp jq jr mg jt ju jv mh jx jy jz mi kb kc kd mj kf kg kh ig bi translated">你可以在这里 获得源文件<a class="ae ki" href="https://github.com/an-object-is-a/chrome-ext-pinterest" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">，你也可以跟随下面的视频教程。</strong></a></p></div><div class="ab cl nk nl hr nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ig ih ii ij ik"><p id="1ddd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你想要更深入的指导，可以看看我在YouTube上的完整视频教程，<a class="ae ki" href="https://www.youtube.com/c/anobjectisa" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">一个物体是一个</strong> </a>。</p><p id="8cbf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一定要在<a class="ae ki" href="https://www.instagram.com/an_object_is_a/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> Instagram </strong> </a>和<a class="ae ki" href="https://twitter.com/anobjectisa1" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> Twitter </strong> </a>上关注我们，及时了解我们最新的<strong class="jm io"> Web开发教程</strong>。</p><h2 id="1b41" class="lt kw in bd kx lu lv dn lb lw lx dp lf jv ly lz lj jz ma mb ln kd mc md lr me bi translated"><strong class="ak">做一个Pinterest谷歌Chrome扩展</strong></h2><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nw nx l"/></div></figure></div></div>    
</body>
</html>