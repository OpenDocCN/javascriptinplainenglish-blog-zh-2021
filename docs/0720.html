<html>
<head>
<title>The easy way to create a unique array of JSON Objects in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在JavaScript中创建唯一的JSON对象数组的简单方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-easy-way-to-create-a-unique-array-of-json-objects-in-javascript-5634254b17aa?source=collection_archive---------1-----------------------#2021-02-14">https://javascript.plainenglish.io/the-easy-way-to-create-a-unique-array-of-json-objects-in-javascript-5634254b17aa?source=collection_archive---------1-----------------------#2021-02-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1c21" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">没有过滤器，没有回调，没有依赖，没有“for”循环🙌 🎉</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/f3de88233d456a212568ece3926b7218.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*yqtcpMMsAQQl6kmBzQcCPQ.png"/></div></figure><p id="2b5d" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">Google <em class="lj"> " </em> <a class="ae lk" href="https://www.google.com/search?q=JS+array+of+unique+JSON+Objects" rel="noopener ugc nofollow" target="_blank"> <em class="lj"> JS唯一JSON对象数组</em> </a> <em class="lj"> " </em>你会陷入一个惊慌失措的StackOverflow答案的世界，答案从多余到荒谬——第三方库、自定义迭代器函数、难以阅读的不可移植代码…</p><p id="b3ab" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">你什么都不需要！</p><p id="cf34" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">是的，我完全理解这篇文章现在出现在谷歌搜索的第一页的讽刺意味。我早该料到会有这一天🤦🏻‍♂️</p><p id="77d1" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在我继续之前，让我明确一下我们试图解决的确切问题。考虑下面的JSON数组:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="8d31" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">如您所见，我们为名为<code class="fe ln lo lp lq b">John</code>的人创建了一个重复的对象。如果您的应用程序需要一组唯一的对象，您需要找到一种方法来过滤掉重复的条目。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="91bf" class="ly lz iq bd ma mb mc dn md me mf dp mg kw mh mi mj la mk ml mm le mn mo mp mq bi translated">介绍器械包()</h2><p id="934a" class="pw-post-body-paragraph kn ko iq kp b kq mr jr ks kt ms ju kv kw mt ky kz la mu lc ld le mv lg lh li ij bi translated">对于大多数数组，我们可以使用<code class="fe ln lo lp lq b"><a class="ae lk" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" rel="noopener ugc nofollow" target="_blank">Set</a></code>来解决这个问题，它是一个JavaScript全局对象，强制其每个值都是唯一的，并丢弃任何重复的值。请参见下面的示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="d628" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">然而，如果我们在一组JSON对象上使用<code class="fe ln lo lp lq b">Set</code>,它不会删除重复的对象。这是因为<code class="fe ln lo lp lq b">Set</code>基于原语的严格子集(字符串、数字、布尔等)评估一个项目是否是重复的。)但这并不包括完整的对象。<code class="fe ln lo lp lq b">Set</code>不遍历对象来检查数组中其他地方的属性和值是否完全匹配。相反，它假设它们是唯一的，并跳过它们。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/c61f66fb7ad7350ec4f61fd5f7fec14f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GYRDaoRtRk4IFmge6AtmuA.jpeg"/></div></div></figure><p id="20fd" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">显然，我们需要遍历数组中的每个对象，并找到某种方法来确定它是否是重复的。也许你的对象有一个唯一的标识符(比如<code class="fe ln lo lp lq b">"id"</code>)。但也许，就像我们的例子一样，他们没有。即使他们这样做了，我们需要编写的使用这个属性的解决方案也不是可移植的。</p><p id="0cd5" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们需要的是一种将对象转换成原语的方法，这种原语可以有效地进行评估，但不破坏对象的数据结构，也不依赖于任何短暂的东西(比如特定的属性名或数据结构)。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="fd7d" class="ly lz iq bd ma mb mc dn md me mf dp mg kw mh mi mj la mk ml mm le mn mo mp mq bi translated">JSON.stringify()和JSON.parse()来拯救！</h2><p id="8fec" class="pw-post-body-paragraph kn ko iq kp b kq mr jr ks kt ms ju kv kw mt ky kz la mu lc ld le mv lg lh li ij bi translated"><code class="fe ln lo lp lq b"><a class="ae lk" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify" rel="noopener ugc nofollow" target="_blank">JSON.stringify()</a></code>将对象转换成字符串，然后<code class="fe ln lo lp lq b">Set</code>可以评估这些字符串是否重复。我们需要做的就是映射我们的数组，并将<code class="fe ln lo lp lq b">JSON.stringify</code>定义为回调函数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="892d" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在我们可以使用<code class="fe ln lo lp lq b">JSON.parse()</code>将这些字符串转换回JSON对象:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="3c87" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">如果您在控制台中继续操作，您会注意到一个错误:</p><pre class="kg kh ki kj gt nb lq nc nd aw ne bi"><span id="230c" class="ly lz iq lq b gy nf ng l nh ni">Uncaught TypeError: uniquePeopleStrings.map is not a function</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/8765908de8e394cdd38240af42b5a508.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/1*yrh7xPaHy8dpb-sSQUMqdQ.gif"/></div></figure><p id="ca12" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">还记得我们说过<code class="fe ln lo lp lq b">Set</code>创建了一个<strong class="kp ir">对象</strong>吗？这意味着它不是一个数组，所以我们不能覆盖它的值。我们需要做的是从我们的集合中创建一个数组:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="bc0d" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在我们有了一系列独特的对象！</p><p id="bf6f" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">如果简洁和可读性是您的目标(它们应该是)，那么您会很高兴地知道我们实际上可以将这些方法链接在一起，并使用一点速记在一行中执行整个操作。参见下面的完整解决方案:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ll lm l"/></div></figure></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="cb52" class="ly lz iq bd ma mb mc dn md me mf dp mg kw mh mi mj la mk ml mm le mn mo mp mq bi translated">警告</h2><p id="247a" class="pw-post-body-paragraph kn ko iq kp b kq mr jr ks kt ms ju kv kw mt ky kz la mu lc ld le mv lg lh li ij bi translated">这种方法适用于任何JSON对象数组，但是有一个很大的警告:如果数据结构不一致，重复的数据将会丢失。例如，考虑以下对象:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="0424" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">正如我们所看到的，这个数组中的两个项目是重复的，但是属性的顺序不同。当我们使用<code class="fe ln lo lp lq b">JSON.stringify()</code>时，属性顺序被保留，这意味着<code class="fe ln lo lp lq b">Set</code>不会识别重复的。如果您从API或数据库中提取数据，您可能会收到具有一致结构的干净的数据，因此您可以相当自信地认为这不是问题。但是，如果您对一致性有任何疑问，您需要执行以下操作:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="27f7" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">第一行从数组中的第一个对象(在本例中是<code class="fe ln lo lp lq b">["name", "age"]</code>)创建一个属性键数组，第二行映射我们的JSON数组，并使用<code class="fe ln lo lp lq b">keys</code>数组作为属性添加的顺序返回一个对象。当然，如果您有一个更深层次的嵌套数据结构，您可能希望这个过程是递归的。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="c888" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我希望这种技术能在您下次尝试创建一个独特的JSON数组时节省一些时间！<strong class="kp ir">如果您从这篇文章中获得了任何价值，请关注、回复并分享🙏</strong></p><p id="58cd" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><em class="lj">发现我的代码有问题？知道更干净的方法来达到同样的效果吗？请在评论中告诉我！👇</em></p></div></div>    
</body>
</html>