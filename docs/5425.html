<html>
<head>
<title>React Context: Do You Really Need It? This Will Help You Decide!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应上下文:你真的需要它吗？这将帮助你决定！</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-context-do-you-really-need-it-this-will-help-you-decide-bcbdae589f70?source=collection_archive---------15-----------------------#2021-11-09">https://javascript.plainenglish.io/react-context-do-you-really-need-it-this-will-help-you-decide-bcbdae589f70?source=collection_archive---------15-----------------------#2021-11-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="e7d2" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">如何创建一个反应上下文</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/975fb4eafe592e2ca8d3409e39a62a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Kqv_Y6o0EiXYd79Q"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@casparrubin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Caspar Camille Rubin</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="kt ku kv"><p id="6b69" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">创建一个无bug的React App的核心是通过状态和道具有效地管理数据。</p></blockquote><p id="4f55" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">在很多情况下，我们需要在组件树中的不同组件之间共享数据。例如，下拉列表中的用户选择或API调用中的数据。在这种情况下，首先，您需要找到最近的公共父组件，并将状态提升到该父组件。这叫做<a class="ae ks" href="https://reactjs.org/docs/lifting-state-up.html" rel="noopener ugc nofollow" target="_blank">提升状态上升</a>。然后，您需要将这种状态传递给需要它作为道具的组件。该数据通过源组件和目的组件之间的每个中间组件。</p><p id="2b8d" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">这种情况一直持续到组件的深度为2或3。除此之外，随着应用程序规模的扩大，维护和调试成为真正的挑战，这可能导致代码难以阅读，并且在规模扩大时变得脆弱。这种道具的深传叫做‘道具钻’。</p><div class="lw lx gp gr ly lz"><a href="https://kentcdodds.com/blog/prop-drilling" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd io gy z fp me fr fs mf fu fw im bi translated">支柱钻井</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">这篇文章的目的不仅仅是帮助你理解什么是道具训练(有些人也称之为“穿线”)…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">kentcdodds.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn km lz"/></div></div></a></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/c0017c53b9d043ac568823b7cffacbd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*UbZUTC60XrBeQDdJQbV8lw.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Prop Drilling</figcaption></figure><p id="c668" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">避免钻柱的解决方案之一是<a class="ae ks" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank">上下文API </a>。在组件之间共享状态的简单明了的方法。本文的目标是分享一个简单的上下文API框架。这个框架可以根据需要进一步增强。最好用功能组件创建上下文。所以我们会关注这一点。</p><h1 id="7f18" class="mp mq in bd mr ms mt mu mv mw mx my mz jt na ju nb jw nc jx nd jz ne ka nf ng bi translated">创建上下文的步骤:</h1><ol class=""><li id="a734" class="nh ni in kz b la nj ld nk lt nl lu nm lv nn ls no np nq nr bi translated">创建上下文文件。</li><li id="fbcb" class="nh ni in kz b la ns ld nt lt nu lu nv lv nw ls no np nq nr bi translated">用上下文提供者包围上下文状态的消费者。</li><li id="4950" class="nh ni in kz b la ns ld nt lt nu lu nv lv nw ls no np nq nr bi translated">然后，您可以在包装在上下文提供程序中的任何组件中使用这个上下文状态。</li></ol><p id="76c1" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">代码中使用了TypeScript。它可以很容易地转换成JavaScript。现在让我们开始吧。</p><h1 id="b7d6" class="mp mq in bd mr ms mt mu mv mw mx my mz jt na ju nb jw nc jx nd jz ne ka nf ng bi translated"><strong class="ak"> 1。创建上下文文件。</strong></h1><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="8a8b" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">用createContext钩子创建一个上下文。然后创建一个提供者组件，该组件返回一个带有共享属性的上下文提供者组件。该组件包含可以作为props传递给提供者的状态。这里的图书列表是静态的，但是我们可以使用useEffect钩子并与API交互来获取图书列表。</p><h1 id="b4eb" class="mp mq in bd mr ms mt mu mv mw mx my mz jt na ju nb jw nc jx nd jz ne ka nf ng bi translated"><strong class="ak"> 2。用上下文提供者包围上下文状态的消费者</strong></h1><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="181b" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">这里，您需要用上下文提供者包装消费者组件。</p><h1 id="8e6b" class="mp mq in bd mr ms mt mu mv mw mx my mz jt na ju nb jw nc jx nd jz ne ka nf ng bi translated"><strong class="ak"> 3。在消费者组件中使用上下文</strong></h1><p id="a2f6" class="pw-post-body-paragraph kw kx in kz b la nj jo lc ld nk jr lf lt nz li lj lu oa lm ln lv ob lq lr ls ig bi translated">是的，现在您可以通过使用useContext钩子来使用上下文状态，该钩子将上下文作为一个参数。干得好！</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h1 id="ef6b" class="mp mq in bd mr ms mt mu mv mw mx my mz jt na ju nb jw nc jx nd jz ne ka nf ng bi translated"><strong class="ak">结论</strong></h1><p id="47c8" class="pw-post-body-paragraph kw kx in kz b la nj jo lc ld nk jr lf lt nz li lj lu oa lm ln lv ob lq lr ls ig bi translated"><a class="ae ks" href="https://codesandbox.io/s/simple-context-api-jz7pv?file=/src/BookContext.tsx" rel="noopener ugc nofollow" target="_blank">这里是工作代码沙盒链接！</a></p><p id="a387" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">何时使用上下文:<strong class="kz io">避免深支柱钻孔。</strong></p><p id="254b" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">您不必将上下文提供者包装在整个组件树中。识别消费者并用上下文提供者包装他们。</p><p id="46f6" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">提供者也可以单独包装。这里有一个例子:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="a74a" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">现在，去创造你需要的环境吧！祝你好运！</p><p id="a48c" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">感谢你的阅读！</p><p id="d22a" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">参考资料:</p><p id="55a3" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated">如果你需要React context的视频指南，你会发现这个播放列表很有帮助:<br/> <a class="ae ks" href="https://youtube.com/playlist?list=PL4cUxeGkcC9hNokByJilPg5g9m2APUePI" rel="noopener ugc nofollow" target="_blank"> React Context &amp; Hooks教程</a></p><p id="4d8c" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated"><a class="ae ks" href="https://dmitripavlutin.com/react-context-and-usecontext/" rel="noopener ugc nofollow" target="_blank">我找到的更多相关资料</a></p><p id="414b" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf lt lh li lj lu ll lm ln lv lp lq lr ls ig bi translated"><em class="ky">更多内容请看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kz io"><em class="ky">plain English . io</em></strong></a></p></div></div>    
</body>
</html>