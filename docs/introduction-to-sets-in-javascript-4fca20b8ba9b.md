# JavaScript 中的集合简介

> 原文：<https://javascript.plainenglish.io/introduction-to-sets-in-javascript-4fca20b8ba9b?source=collection_archive---------17----------------------->

![](img/07a041de62acecaa23b4dae039a2f039.png)

Photo by [Danielle MacInnes](https://unsplash.com/@dsmacinnes?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

在 JavaScript 中，集合仍然相对较新，我仍然没有看到人们充分利用它们。

在本文中，我们将探索集合的特性，并研究一些集合可以让我们的生活更容易的例子。

# 一般概念

集合是保持插入顺序的元素集合，并且只允许唯一的元素。如果您在一行中插入五个 1，将只插入一个。插入时，使用`===`比较元素，决定是否插入。

我们需要意识到这个事实，因为完全相同但具有不同引用的对象实际上会被插入，因为它们是通过引用进行比较的。

# 向集合添加值

我们如何创建一个集合？最简单的方法是使用 Set 构造函数。

现在，我们可以使用返回并存储在`mySet`中的内容来访问一个可以帮助我们添加值的方法。

我们可以调用集合的`add`方法，并传递一个值，该值将尝试将其添加到集合中，假设它当前还不存在。这个方法确实返回了`this`上下文，所以我们也能够像下面一样将`add`链接在一起。

链接允许将多个值背靠背相加，并且还要注意，在这个例子中，我们已经重复插入了 3 次，但是我们的最终结果仍然是相同的。这是很好的能够链，但如果你有一个清单的价值，以插入到一个集，我们有更好的方法来实现这一点。

如果我们有一个数据列表，并且正在初始化一个集合，我们可以直接传入数组。这非常方便。如果我们已经有了集合，并且需要插入一个项目数组，仔细检查这些例子，我们必须使用循环，或者如果数组长度已知，使用链接来完成。我们不能使用数组上的扩展运算符来执行`add`方法的插入。

# 从集合中移除值

与`add`相反，我们也提供`delete`方法。它需要一个参数，这个参数就是您想要删除的项目。Set 将使用`===`比较来尝试匹配该值。如果找到，该项目将从集合中移除，并且`true`将从功能中返回。如果不匹配，则对集合没有影响，并返回 false。

如前所述，在使用集合中的对象和删除时要小心。集合试图匹配一个引用，所以再次传递一个不同引用的匹配对象将不会对集合产生影响，并且`delete`返回 false。让我们看看这个案例，以确保我们完全理解这一点。

这里，因为我们是内联定义对象，每个对象都有一个单独的引用，因此集合不能匹配这两个对象。如果我们需要删除一个值列表，与`add`不同的是，不会返回`this`上下文，因为我们返回的是值是否被删除。这导致将多个删除链接在一起会失败。为此，我们必须使用 for 循环。

让我们一个一个地看一下。链接失败是因为我们之前讨论过，我们没有得到返回给我们的`this`上下文。当我们尝试使用一个项目数组和 spread 操作符进行删除时，我们得到了奇怪的函数`true`,就好像集合被修改了一样，但是快速查看一下就可以发现它并没有改变。最后，循环遍历我们的项，并简单地对每个项调用 delete，这样做是可行的，并做出了预期的更改。如果您需要删除集合中的所有内容，该怎么办？

我们能够简单地调用`clear`方法一次从集合中删除所有项目。这比遍历并删除所有内容要方便得多。

# 查找元素是否在集合中

查找一个元素是否存在于一个集合中就像使用提供的`has`方法一样简单。该方法也使用与`delete`相同的`===`比较。根据值是否匹配，它返回 true 或 false。这其实是一个非常有帮助的方法。

我认为第一个例子，是相当不言自明的。最后一个例子演示了我们在 delete 中看到的同样的问题，即引用已经改变，因此不匹配。

# 遍历集合

集合是元素的有序列表。对我来说，仅仅因为事物的本质是有序的，就表明应该有方法以这种有序的方式来看待元素。我们有几种方法可以用器械包实现这一点，我们将一一介绍。这些方法是`values`、`entries`和`forEach`。先说`values`。

注意，`values`方法返回一个迭代器。这意味着我们能够继续调用迭代器上的`next`方法，并且我们将继续获得一个带有两个属性的对象，value 和 done。虽然 done 不等于 true，但迭代器中仍有值要查看。在第一组例子中，我们手动调用下一个方法。在第二个集合中，您会看到一个使用 while 循环迭代迭代器的常见实现。现在我们来看一下`entries`方法。

语法非常类似于`values`方法，它也返回一个集合迭代器。这里的主要区别是条目，而不仅仅是值，以`[value, value]`的形式返回一个数组。您可能想知道为什么，因为拥有两次该值几乎没有任何用处。

根据 MDN 文档:*" entries()方法返回一个新的 Iterator 对象，该对象包含一个数组，该数组包含* `*Set*` *对象中每个元素的[value，value]，按插入顺序排列。对于* `*Set*` *对象来说没有* `*key*` *像在* `*Map*` *对象中。但是，为了保持 API 类似于* `*Map*` *对象，每个条目在这里的键和值都是相同的，因此返回一个数组* `*[value, value]*`

*这绝对是迭代器方法中最没用的，很难想象需要这种方法的情况。现在我们来看看`forEach`。*

*`The forEach` method 是迭代方法中比较有用的一种，因为感觉比较熟悉。*

*注意回调函数的 API 实际上类似于`entries` API。第一个和第二个参数，它们类似于 entries 数组中的位置 0 和 1。这意味着它们实际上总是相同的。这是一个类似的论点，这个位置表示键，以保持 API 类似于 Map 构造函数，并且由于集合中没有键，所以提供值来代替。*

# *结论*

*现在你知道了集合的 API。在 JavaScript 中，它们是非常有用的数据结构。如果需要使数组具有唯一性，可以考虑将其转换为集合，然后再转换回数组。这将删除所有重复的值(记住我们关于在这方面处理对象的对话)。*

*假设你有两个数组。一个是允许执行某些操作的用户标识列表，另一个是用户列表。现在我们需要过滤用户列表，只包括 id 在第一个列表中的用户。一种方法是每次查看数组以确定 id 是否存在。这导致运行时间复杂度为 O(N ),这是不理想的。如果您将 id 数组转换成一个集合，那么您可以调用`has`方法。*

*基于关于集合的文档，我们可以了解到以下内容:“*集合对象必须使用散列表或其他机制来实现，平均来说，这些机制提供的访问时间与集合中的元素数量呈次线性关系。”**

*集合实际上是作为散列表实现的，这意味着使用这种技术会导致常量时间查找，从而将运行时复杂性降低到 O(N)。*

*当集合可以帮助您的代码时，还有许多其他情况可以发现。如果您发现自己在考虑使用一个对象，但是当您引用它时，您只关心值是否未定义，那么您也可以从使用集合中受益。*

**更多内容尽在*[***plain English . io***](http://plainenglish.io)*