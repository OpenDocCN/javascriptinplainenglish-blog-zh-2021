<html>
<head>
<title>TypeORM Tutorial for Beginners: CRUD in Express.js (TypeScript)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向初学者的TypeORM教程:Express.js中的CRUD(typerscript)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/typeorm-tutorial-for-beginner-crud-in-express-js-typescript-b447f1fd7622?source=collection_archive---------2-----------------------#2021-03-15">https://javascript.plainenglish.io/typeorm-tutorial-for-beginner-crud-in-express-js-typescript-b447f1fd7622?source=collection_archive---------2-----------------------#2021-03-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="beac" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">TypeORM是一款备受关注的<a class="ae ki" href="https://en.wikipedia.org/wiki/Object-relational_mapping" rel="noopener ugc nofollow" target="_blank"> ORM </a>。与TypeScript的本机集成使开发人员能够将TypeORM有效地集成到他们的TypeScript项目中。在本教程中，我将介绍Express.js (Node.js)中的CRUD函数/API。在本教程中不需要前端，因为我们将使用swag来测试我们的API。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/f602e5a5f1f7b0e2939270d93303d8c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hKdoQ6JWuRadSsiyeFmj0w.png"/></div></div></figure></div><div class="ab cl kv kw hr kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ig ih ii ij ik"><h1 id="21a7" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">介绍</h1><p id="b496" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">在本教程中，您将学习在Node.js中设置Express + TypeScript应用程序，主要用于后端目的。最常见的后端服务之一是CRUD(创建、读取、更新、删除)服务。这些服务需要数据持久性，因此，Express应用程序必须能够有效和高效地执行这些功能。在体验和比较了Sequelize、Prisma和LoopBack等不同的ORM库之后，我决定安定下来使用TypeORM。我喜欢TypeORM的一个主要原因是它与typerscript和TSOA(typerscript Open API)库的无缝集成，因为它使用的是装饰器设计。</p></div><div class="ab cl kv kw hr kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ig ih ii ij ik"><h1 id="cb56" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">入门指南</h1><p id="cf65" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">首先，我们将使用create-express-type script-application库来生成结构良好的express应用程序。</p><h2 id="69d7" class="mf ld in bd le mg mh dn li mi mj dp lm jv mk ml lq jz mm mn lu kd mo mp ly mq bi translated">先决条件</h2><p id="8fab" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">在运行create-express-type script-application命令之前，请确保在本地计算机上安装了以下软件包。它们是npm、节点和git。</p><h2 id="108d" class="mf ld in bd le mg mh dn li mi mj dp lm jv mk ml lq jz mm mn lu kd mo mp ly mq bi translated">创建快速类型脚本应用程序</h2><p id="5ebd" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">准备就绪后，将终端目录更改为要创建项目的目录。然后，运行以下命令。</p><pre class="kk kl km kn gt mr ms mt mu aw mv bi"><span id="9011" class="mf ld in ms b gy mw mx l my mz">$ npx create-express-typescript-application my-app -t typeorm</span></pre><p id="a73b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦你看到成功的消息“应用程序已创建与类型表单模板！”，你准备走了。转到“我的应用程序”目录，然后使用您最喜欢的代码编辑器(在我的示例中为Visual Studio Code)打开该文件夹。</p><pre class="kk kl km kn gt mr ms mt mu aw mv bi"><span id="6d6b" class="mf ld in ms b gy mw mx l my mz">$ cd my-app<br/>$ code .</span></pre><p id="5510" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您应该看到以下项目结构。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi na"><img src="../Images/574cfdca95b1c23bfb0326860d7d418a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e1gEpOpXILyjcsJN3dY7hg.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Project Structure of CETA (with TypeORM Template)</figcaption></figure><p id="a529" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要开始，可以运行以下命令。</p><pre class="kk kl km kn gt mr ms mt mu aw mv bi"><span id="cfdc" class="mf ld in ms b gy mw mx l my mz">$ npm run dev</span></pre><p id="ce6d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这将在<code class="fe nf ng nh ms b">http://localhost:8080</code>开始应用。由于在初始项目创建过程中集成了swag文档，因此您可以在浏览器中打开一个新选项卡并转到<code class="fe nf ng nh ms b"><a class="ae ki" href="http://localhost:8080/docs" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/docs</a></code>。你会看到下面的画面。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ni"><img src="../Images/691f31a47e69eb092d581fbe4b2c02db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-wrBp1Y5iXzBigx3Zk-uvg.png"/></div></div></figure><p id="d26d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请注意，这些是create-express-type script-应用程序创建的默认路由，供您在开发下一条路由时参考。在本教程中，我将带您完成创建新路线的过程。</p><h2 id="9f76" class="mf ld in bd le mg mh dn li mi mj dp lm jv mk ml lq jz mm mn lu kd mo mp ly mq bi translated">数据库的选择</h2><p id="e3db" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">有许多可用的数据库，无论是关系数据库还是非关系数据库。在本教程中，我们将使用sqlite(一个轻量级本地关系数据库)。不过，您始终可以在<code class="fe nf ng nh ms b">src/database/index.ts</code>文件中更改数据库类型和连接详细信息。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="5aad" class="mf ld in bd le mg mh dn li mi mj dp lm jv mk ml lq jz mm mn lu kd mo mp ly mq bi translated">创建数据库实体和CRUD服务</h2><p id="a31c" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">在本节中，您将创建待办事项列表的CRUD服务。要创建数据库实体(表)，您需要在<code class="fe nf ng nh ms b">src/database/entity/todo.ts</code>中创建一个实体文件。在TypeORM中，我们可以通过<a class="ae ki" href="https://typeorm.io/index.html#/active-record-data-mapper/what-is-the-data-mapper-pattern" rel="noopener ugc nofollow" target="_blank"> DataMapper </a>和<a class="ae ki" href="https://typeorm.io/index.html#/active-record-data-mapper/what-is-the-active-record-pattern" rel="noopener ugc nofollow" target="_blank"> ActiveRecord </a>来定义一个对象。在本教程中，我们将坚持使用ActiveRecord设计，因为它允许通过实体而不是连接管理器直接访问数据库。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="23c2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦创建了任务实体，我们就可以创建与数据库交互的服务了。创建<code class="fe nf ng nh ms b">src/app/todo/todo.service.ts</code>并编写以下函数。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="df6e" class="mf ld in bd le mg mh dn li mi mj dp lm jv mk ml lq jz mm mn lu kd mo mp ly mq bi translated">创建控制器文件</h2><p id="61a7" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">接下来，我们将把所有这些函数封装在一个控制器中，以注册到express app routes并生成swagger文档。创建<code class="fe nf ng nh ms b">src/app/todo/todo.router.ts</code>并编写下面的类。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="11fa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此时，您的项目应该是这样的…</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nl"><img src="../Images/2d13bb140a49529f1ba9c068fe218acf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-FlSZdGaa4neBgHY3bYb-A.png"/></div></div></figure><p id="947f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请注意，三个绿色文件是新创建的文件。确保<code class="fe nf ng nh ms b">npm run dev</code>运行无误后，您就可以在<code class="fe nf ng nh ms b"><a class="ae ki" href="http://localhost:8080/docs" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/docs</a></code>刷新swagger文档了。一旦你刷新，你会看到所有的待办事项路线出现在你的招摇文件。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nm"><img src="../Images/ba8f08034e488a233ff9a3fe426b7d11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_DwOo815usZXdw4UP3gv2w.png"/></div></div></figure><h2 id="fa25" class="mf ld in bd le mg mh dn li mi mj dp lm jv mk ml lq jz mm mn lu kd mo mp ly mq bi translated">测试路线</h2><p id="2572" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">您可以使用swagger文件来测试您新创建的API。例如，你可以点击创建todo上的立即尝试并编辑主体JSON。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nn"><img src="../Images/04d96229a4a69a52a6cefdd04b984be1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Q09h144kndiKgLFxv3kBg.png"/></div></div></figure><p id="fa62" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">单击execute后，应该会显示curl命令以及响应细节。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi no"><img src="../Images/bc27fe969caa8f30388aa24fe52debf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c9N6OvhFrifzpS-bFsVxLw.png"/></div></div></figure><p id="d6e6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有了这个，你就可以开发你自己的API，开始下一个十亿美元的公司了！</p></div><div class="ab cl kv kw hr kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ig ih ii ij ik"><h1 id="9293" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结论</h1><p id="e548" class="pw-post-body-paragraph jk jl in jm b jn ma jp jq jr mb jt ju jv mc jx jy jz md kb kc kd me kf kg kh ig bi translated">在本教程中，我已经介绍了TypeORM非常基本的CRUD服务。如果你有兴趣学习更多关于创建关系的知识(例如，一对多关系，多对一关系)，你可以看看<code class="fe nf ng nh ms b">src/database/entity/role.ts</code>和<code class="fe nf ng nh ms b">src/database/entity/user.ts</code>中的代码。我还在<code class="fe nf ng nh ms b">src/app/user</code>下包含了这些关系实体的CRUDs。我希望你从本教程中学到了很多，并花时间去理解代码，而不只是复制和粘贴。除此之外，您还应该理解create-express-typescript-application的整个文件夹结构！</p><p id="48a1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你有任何分享的想法，或者如果你有想要建立的项目但不知道如何开始，请联系我！万事如意！</p><p id="db31" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="np">代表</em> <a class="ae ki" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="np">团队，感谢阅读。</em></strong></a></p></div></div>    
</body>
</html>