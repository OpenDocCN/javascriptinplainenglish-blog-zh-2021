<html>
<head>
<title>Download HTML as a PDF in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React中下载PDF格式的HTML</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/download-html-as-a-pdf-in-react-fc86114c9095?source=collection_archive---------2-----------------------#2021-02-19">https://javascript.plainenglish.io/download-html-as-a-pdf-in-react-fc86114c9095?source=collection_archive---------2-----------------------#2021-02-19</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="43a7" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">比你想象的容易！</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/66752b1daad1087cc50dfc812bd7f3c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O8-4g6U42idrmOffH2Xwtw.jpeg"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Credit: Google</figcaption></figure><p id="f574" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">下载PDF是现代前端应用中的常见用例。但是在客户端构建PDF可能会很痛苦。在React中，我们有一些很棒的库，比如<code class="fe ls lt lu lv b"><a class="ae lw" href="https://www.npmjs.com/package/@react-pdf/renderer" rel="noopener ugc nofollow" target="_blank">react-pdf/renderer</a></code>来帮助我们。</p><h2 id="c1fe" class="lx ly ir bd lz ma mb dn mc md me dp mf lf mg mh mi lj mj mk ml ln mm mn mo mp bi translated">传统图书馆的问题</h2><p id="3eec" class="pw-post-body-paragraph kw kx ir ky b kz mq js lb lc mr jv le lf ms lh li lj mt ll lm ln mu lp lq lr ik bi translated"><code class="fe ls lt lu lv b">react-pdf/renderer</code>是一个很棒的库，提供了很多定制。但是它有自己的成本。例如</p><ul class=""><li id="e56f" class="mv mw ir ky b kz la lc ld lf mx lj my ln mz lr na nb nc nd bi translated">您必须为您的PDF文档设计一个单独的组件</li><li id="37a2" class="mv mw ir ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated">如果你没有正确处理边缘情况，有时渲染会失败</li><li id="e504" class="mv mw ir ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated">你必须根据他们的规格分别设计。</li></ul><p id="beba" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">如果您想构建一个数据量大的定制PDF，所有这些都没问题。但是如果你想要更简单的呢？</p><blockquote class="nj"><p id="571b" class="nk nl ir bd nm nn no np nq nr ns lr dk translated">如果您只想按原样打印正在呈现的组件，该怎么办？</p></blockquote><p id="83d5" class="pw-post-body-paragraph kw kx ir ky b kz nt js lb lc nu jv le lf nv lh li lj nw ll lm ln nx lp lq lr ik bi translated">让我们看看如何使用一个巧妙的技巧和一些JavaScript知识下载PDF格式的组件。</p><h1 id="bc6f" class="ny ly ir bd lz nz oa ob mc oc od oe mf jx of jy mi ka og kb ml kd oh ke mo oi bi translated">概观</h1><p id="989f" class="pw-post-body-paragraph kw kx ir ky b kz mq js lb lc mr jv le lf ms lh li lj mt ll lm ln mu lp lq lr ik bi translated">我们要遵循的过程是将HTML元素转换成图像，然后将图像放入另一个强大的PDF库中。</p><blockquote class="nj"><p id="ab38" class="nk nl ir bd nm nn no np nq nr ns lr dk translated">HTML文档-&gt;图像-&gt; PDF</p></blockquote><p id="db86" class="pw-post-body-paragraph kw kx ir ky b kz nt js lb lc nu jv le lf nv lh li lj nw ll lm ln nx lp lq lr ik bi translated">为此，我们需要两个库。</p><ol class=""><li id="e059" class="mv mw ir ky b kz la lc ld lf mx lj my ln mz lr oj nb nc nd bi translated"><code class="fe ls lt lu lv b"><a class="ae lw" href="https://www.npmjs.com/package/html2canvas" rel="noopener ugc nofollow" target="_blank">html2canvas</a></code> - &gt;将我们的HTML文档转换成图像</li><li id="bc16" class="mv mw ir ky b kz ne lc nf lf ng lj nh ln ni lr oj nb nc nd bi translated"><code class="fe ls lt lu lv b"><a class="ae lw" href="https://www.npmjs.com/package/jspdf" rel="noopener ugc nofollow" target="_blank">jspdf</a></code> - &gt;将生成的图像插入PDF文件</li></ol><p id="d686" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><em class="ok">完整代码在底部。如果你只对那个感兴趣，直接去那里。否则请原谅我。用不了多久</em></p></div><div class="ab cl ol om hv on" role="separator"><span class="oo bw bk op oq or"/><span class="oo bw bk op oq or"/><span class="oo bw bk op oq"/></div><div class="ik il im in io"><h2 id="e770" class="lx ly ir bd lz ma mb dn mc md me dp mf lf mg mh mi lj mj mk ml ln mm mn mo mp bi translated">第一步。安装依赖项</h2><p id="c544" class="pw-post-body-paragraph kw kx ir ky b kz mq js lb lc mr jv le lf ms lh li lj mt ll lm ln mu lp lq lr ik bi translated">首先，安装所需的依赖项。</p><pre class="kh ki kj kk gu os lv ot ou aw ov bi"><span id="85a4" class="lx ly ir lv b gz ow ox l oy oz">yarn add jspdf html2canvas</span></pre><h2 id="7d56" class="lx ly ir bd lz ma mb dn mc md me dp mf lf mg mh mi lj mj mk ml ln mm mn mo mp bi translated">第二步:添加下载器功能</h2><p id="07c2" class="pw-post-body-paragraph kw kx ir ky b kz mq js lb lc mr jv le lf ms lh li lj mt ll lm ln mu lp lq lr ik bi translated">现在要么为您的<code class="fe ls lt lu lv b">GenericPdfdownloader</code>创建一个单独的组件，要么将下面的代码放入您想要下载的组件中。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="pa pb l"/></div></figure></div><div class="ab cl ol om hv on" role="separator"><span class="oo bw bk op oq or"/><span class="oo bw bk op oq or"/><span class="oo bw bk op oq"/></div><div class="ik il im in io"><h1 id="2e65" class="ny ly ir bd lz nz pc ob mc oc pd oe mf jx pe jy mi ka pf kb ml kd pg ke mo oi bi translated">代码在做什么</h1><ul class=""><li id="ed98" class="mv mw ir ky b kz mq lc mr lf ph lj pi ln pj lr na nb nc nd bi translated"><code class="fe ls lt lu lv b">Input</code> - &gt;该功能以<code class="fe ls lt lu lv b">rootElementId</code>为输入。这将是可下载组件的id。我们可以像下面这样定义任何元素的id</li></ul><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="pa pb l"/></div></figure><p id="bab9" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">因此，如果我们想用<code class="fe ls lt lu lv b">id=”divToDownload”</code>下载<code class="fe ls lt lu lv b">div</code>中的组件，那么我们必须将<code class="fe ls lt lu lv b">”divToDownload”</code>传递给函数</p><h2 id="80dc" class="lx ly ir bd lz ma mb dn mc md me dp mf lf mg mh mi lj mj mk ml ln mm mn mo mp bi translated"><code class="fe ls lt lu lv b">1. Getting the HTML Element</code></h2><p id="5237" class="pw-post-body-paragraph kw kx ir ky b kz mq js lb lc mr jv le lf ms lh li lj mt ll lm ln mu lp lq lr ik bi translated">在下一步中，我们将使用传递的Id获取HTML元素。</p><pre class="kh ki kj kk gu os lv ot ou aw ov bi"><span id="59c5" class="lx ly ir lv b gz ow ox l oy oz">const input = document.getElementById(rootElementId);</span></pre><h2 id="8981" class="lx ly ir bd lz ma mb dn mc md me dp mf lf mg mh mi lj mj mk ml ln mm mn mo mp bi translated"><code class="fe ls lt lu lv b">2. Converting HTML to Image</code></h2><p id="d737" class="pw-post-body-paragraph kw kx ir ky b kz mq js lb lc mr jv le lf ms lh li lj mt ll lm ln mu lp lq lr ik bi translated">接下来，我们将该元素传递给<code class="fe ls lt lu lv b">html2canvas</code>,它会返回一个图像</p><pre class="kh ki kj kk gu os lv ot ou aw ov bi"><span id="9a28" class="lx ly ir lv b gz ow ox l oy oz"><strong class="lv is"><em class="ok">html2canvas</em></strong>(input)<br/>    .then((canvas) =&gt; {<br/>        const imgData = canvas.toDataURL('image/png');<br/>    })</span></pre><h2 id="bdd7" class="lx ly ir bd lz ma mb dn mc md me dp mf lf mg mh mi lj mj mk ml ln mm mn mo mp bi translated"><code class="fe ls lt lu lv b">3. Putting The Image into PDF</code></h2><p id="49a7" class="pw-post-body-paragraph kw kx ir ky b kz mq js lb lc mr jv le lf ms lh li lj mt ll lm ln mu lp lq lr ik bi translated">接下来，我们创建一个新的PDF文档，并将图像放入其中。</p><pre class="kh ki kj kk gu os lv ot ou aw ov bi"><span id="ad75" class="lx ly ir lv b gz ow ox l oy oz">const pdf = new jsPDF();<br/>pdf.addImage(imgData, 'JPEG', 0, 0);<br/>pdf.save("download.pdf");</span></pre><p id="c3e9" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">这里的两个零是生成的PDF文档的<code class="fe ls lt lu lv b">padding</code>。你可以随意改变它们。</p><p id="ef0f" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">此外，您可以修改可下载的文件名。</p><h2 id="06ce" class="lx ly ir bd lz ma mb dn mc md me dp mf lf mg mh mi lj mj mk ml ln mm mn mo mp bi translated">完全码</h2><p id="75e6" class="pw-post-body-paragraph kw kx ir ky b kz mq js lb lc mr jv le lf ms lh li lj mt ll lm ln mu lp lq lr ik bi translated">下面是一个自定义PDF下载器的完整代码，它有两个参数:</p><ol class=""><li id="a2bb" class="mv mw ir ky b kz la lc ld lf mx lj my ln mz lr oj nb nc nd bi translated">根元素标识为<code class="fe ls lt lu lv b">rootElementId</code></li><li id="12c0" class="mv mw ir ky b kz ne lc nf lf ng lj nh ln ni lr oj nb nc nd bi translated">下载文件名<code class="fe ls lt lu lv b">downloadFileName</code></li></ol><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="pa pb l"/></div></figure><p id="3ae3" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">现在，您可以将该组件放在项目中的任何位置，如下所示:</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="pa pb l"/></div></figure><h2 id="a3be" class="lx ly ir bd lz ma mb dn mc md me dp mf lf mg mh mi lj mj mk ml ln mm mn mo mp bi translated">结论</h2><p id="4e7b" class="pw-post-body-paragraph kw kx ir ky b kz mq js lb lc mr jv le lf ms lh li lj mt ll lm ln mu lp lq lr ik bi translated">这就对了。现在你有了你的自定义PDF下载器，可以在你的项目中的任何地方使用。感谢您的阅读！</p><p id="f06d" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><strong class="ky is">有什么话要说？</strong></p><p id="f0ee" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><strong class="ky is">通过</strong><a class="ae lw" href="https://www.linkedin.com/in/56faisal/" rel="noopener ugc nofollow" target="_blank"><strong class="ky is">LinkedIn</strong></a><strong class="ky is">或我的</strong> <a class="ae lw" href="https://www.mohammadfaisal.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky is">个人网站</strong> </a> <strong class="ky is">与我取得联系。</strong></p><h2 id="0325" class="lx ly ir bd lz ma mb dn mc md me dp mf lf mg mh mi lj mj mk ml ln mm mn mo mp bi translated">资源:</h2><ul class=""><li id="03e1" class="mv mw ir ky b kz mq lc mr lf ph lj pi ln pj lr na nb nc nd bi translated"><a class="ae lw" href="https://stackoverflow.com/questions/44989119/generating-a-pdf-file-from-react-components" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/44989119/generating-a-pdf-file-from-react-components</a></li></ul></div></div>    
</body>
</html>