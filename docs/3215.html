<html>
<head>
<title>Validating Input with Zod in TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在TypeScript中用Zod验证输入</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/validating-input-with-zod-in-typescript-6d0e04677123?source=collection_archive---------2-----------------------#2021-07-01">https://javascript.plainenglish.io/validating-input-with-zod-in-typescript-6d0e04677123?source=collection_archive---------2-----------------------#2021-07-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d3e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个能引起很多讨论的话题:<em class="kl">“在Node.js中解析和验证用户输入的最好方法是什么？”</em></p><p id="7472" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗯，根据我的说法，它是<a class="ae km" href="https://github.com/colinhacks/zod" rel="noopener ugc nofollow" target="_blank"> Zod </a>，今天我将向你展示如何开始使用Zod，以及为什么它是绝对最好的！</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/99ca9803a95b66321058e9a4da292796.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pGPDIXCumwp5JgVIU0aX5g.jpeg"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">Picture by FLY:D (<a class="ae km" href="https://unsplash.com/@flyd2069" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/@flyd2069</a>)</figcaption></figure><h1 id="2dac" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">🌱创建您的第一个模式</h1><p id="7fef" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">首先，我们必须安装佐德。你可以用你最喜欢的包管理器来做这件事。</p><pre class="ko kp kq kr gt mg mh mi mj aw mk bi"><span id="0c3e" class="ml le iq mh b gy mm mn l mo mp">npm install zod<br/>// OR<br/>yarn add zod</span></pre><p id="e388" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的第一个模式中，我们将为一个简单的字符串创建一个。<br/>不要担心，我们将在本文后面讨论更复杂的验证。</p><p id="ab02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你需要做的就是:</p><ul class=""><li id="57cd" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk mv mw mx my bi translated">导入Zod</li><li id="5988" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">创建模式</li><li id="619e" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">对比！</li></ul><p id="0ad9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设我们想要一个模式来解析一个名字。我们想对这个名字做一些限制。我们希望它:是一个字符串，至少2个字符长，最大长度为20个字符。</p><p id="dfae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们将这些约束转换成一个模式，它看起来会像这样。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="d97a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您通过用<code class="fe ng nh ni mh b">tsc</code>或像<code class="fe ng nh ni mh b">ts-node</code>这样的库构建这段代码来运行它，您会在您的终端中看到一个异常。不要慌，因为这其实是意料之中的结果！</p><p id="3326" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">仔细看看输出，您会看到Zod抛出了一个错误，因为我们的第二个输入不符合最小长度标准。万岁！</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/a52653e8fcecef4eeedb094461a213ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*2cc8mju34T39fEbOM-Kaew.png"/></div></figure><h1 id="a349" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">🌳更复杂一点的东西</h1><p id="acb4" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">既然您已经创建了您的第一个Zod模式，让我们增加难度。让我们创建一个Zod模式来验证整个对象。<br/>例如，我们期望来自前端框架的API调用将用户的新帖子添加到数据库中。我们期望一个对象有字段:<code class="fe ng nh ni mh b">user</code>、<code class="fe ng nh ni mh b">content</code>和<code class="fe ng nh ni mh b">date</code>。让我们把它变成一个模式！</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="de37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行这段代码，您会看到一个不同的错误。这一次让我们知道我们试图解析的对象不包括一个必需的字段！<br/>是不是很神奇？</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/8450a57f175094401789e56b5de57013.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*5WiWgacDbZ-Te2fONRkknA.png"/></div></figure><h1 id="febd" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">🤔到此为止了吗？</h1><p id="7e60" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">它没有！Zod有很多你可以在应用程序中使用的特性。你可以在他们自己的<a class="ae km" href="https://github.com/colinhacks/zod" rel="noopener ugc nofollow" target="_blank">文档</a>中找到完整的列表，但是我也在这里整理了一个小列表供你探索！</p><h2 id="2626" class="ml le iq bd lf nl nm dn lj nn no dp ln jy np nq lr kc nr ns lv kg nt nu lz nv bi translated">z.string()。url()</h2><p id="d875" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">这个在<code class="fe ng nh ni mh b">.string()</code>之上的额外函数确保了给定的字符串也是一个URL。</p><h2 id="f870" class="ml le iq bd lf nl nm dn lj nn no dp ln jy np nq lr kc nr ns lv kg nt nu lz nv bi translated">z.string()。电子邮件()</h2><p id="f885" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">这个在<code class="fe ng nh ni mh b">.string()</code>之上的额外函数确保了给定的字符串也是一封电子邮件。</p><h2 id="7f5e" class="ml le iq bd lf nl nm dn lj nn no dp ln jy np nq lr kc nr ns lv kg nt nu lz nv bi translated">z.infer <typeof schema=""/></h2><p id="068d" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">对于打字用户来说，这是一个非常酷的工具。使用infer，您可以从模式中提取类型。你需要做的就是像这样叫它！</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h2 id="ba9c" class="ml le iq bd lf nl nm dn lj nn no dp ln jy np nq lr kc nr ns lv kg nt nu lz nv bi translated">严格型()</h2><p id="8a8b" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">使用<code class="fe ng nh ni mh b">strict()</code>可以让Zod知道它应该只允许模式中指定的键。如果对象中存在任何未知的键，它将抛出一个Zod错误。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h1 id="25e0" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">🙋‍♂️:还有其他选择吗？</h1><p id="deea" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">是啊！佐德还有很多替代品。其中最受欢迎的是Joi和Yup，这两个已经存在很长时间了。</p><p id="23bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我更喜欢Zod的原因是因为它是为TypeScript构建的。如果你不知道，TypeScript是JavaScript的强类型变体。</p><p id="9a46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">佐德优越的其他原因！</p><ul class=""><li id="863b" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk mv mw mx my bi translated">非常小(10kB)</li><li id="769d" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">没有依赖关系</li><li id="8677" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">适用于浏览器和Node.js</li></ul><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nw"><img src="../Images/23b5f6a69773c9bc9e7af984e99bd1c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_T-6sQMl3pIiGBIPw31bDg.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">Downloads for Joi, Yup and Zod compared</figcaption></figure></div><div class="ab cl nx ny hu nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ij ik il im in"><p id="08ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">祝你有创意的一天！🧡</p><p id="a8fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">更多内容尽在</em><a class="ae km" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="kl">plain English . io</em></strong></a></p></div></div>    
</body>
</html>