<html>
<head>
<title>Let’s Build A Full Stack App With The Spotify Algorithm + API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们用Spotify算法+ API构建一个全栈应用</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/part-2-lets-build-a-full-stack-app-with-the-spotify-algorithm-and-api-frontend-development-463c6c232219?source=collection_archive---------4-----------------------#2021-01-13">https://javascript.plainenglish.io/part-2-lets-build-a-full-stack-app-with-the-spotify-algorithm-and-api-frontend-development-463c6c232219?source=collection_archive---------4-----------------------#2021-01-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="c953" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">第2部分:前端开发</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/196c58898a11d796bcb7b4a90145591f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UV4Tmvnt6sta5DgA-VLUTA.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@ipuriagram?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Puria Berenji</a> on <a class="ae ks" href="https://unsplash.com/s/photos/spotify?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e9f2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">欢迎来到使用Spotify的推荐API端点构建全栈应用程序的第2部分。在上一个教程中，我们回顾了如何创建后端，并使用Spotify开发仪表板设置我们的项目。</p><p id="72e0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在本教程中，我们将通过创建我们的前端！</p><p id="3732" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果您是这个系列的新手，请点击这里查看第1部分！</p><h1 id="cabe" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">规划我们的组件</h1><p id="beec" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">我们不想在没有对我们想要创建的组件有一个可靠的计划的情况下就开始开发我们的react前端。我要找的是:</p><ol class=""><li id="0db7" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated">一个搜索栏，我们可以在那里查找艺术家，选择他们作为推荐API的“种子”。(最多3个)</li><li id="41f4" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">一组滑块，代表我们可以为每个查询更改的所有值。</li><li id="8622" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">发送我们的查询的按钮</li><li id="3df4" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">作为服务器播放列表响应的歌曲列表</li></ol><h1 id="36b5" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">制造前端</h1><p id="ad5c" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">如果你已经阅读了我的“安全服务器”文章，你将已经创建了一个用于演示登录/注销状态的前端。这与我们现在要创建的起始前端非常相似。</p><p id="6909" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">首先，我们使用npx来初始化我们的项目:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="10f1" class="nf lq in nb b gy ng nh l ni nj">$ npx create-react-app client</span></pre><p id="db00" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们安装一些前端依赖项。</p><ol class=""><li id="3dd1" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated">Material-UI 是一个优秀的前端react组件库，我们可以将其用于我们前端中的不同组件。如果你以前从未使用过material-ui，如果你有任何问题，请访问他们的网站并浏览文档。</li><li id="8c59" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated"><code class="fe nm nn no nb b">axios</code>是一个库，我们可以用它向我们的后端和Spotify API发送web请求。</li><li id="64b9" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated"><code class="fe nm nn no nb b">http-proxy-middleware</code>是一个包，它将允许我们在开发过程中从前端代理请求到后端服务器。</li></ol><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="5ad8" class="nf lq in nb b gy ng nh l ni nj">$ cd client<br/>$ yarn add @material-ui/core <a class="ae ks" href="http://twitter.com/material" rel="noopener ugc nofollow" target="_blank">@material</a>-ui/icons axios http-proxy-middleware</span></pre><p id="3492" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们现在将添加我们的代理，以便我们可以轻松地请求我们的后端，看看我们是否登录。这被添加到我们的<code class="fe nm nn no nb b">src</code>文件夹的根目录下，在我们的<code class="fe nm nn no nb b">client</code>文件夹(client/src)内:</p><p id="4378" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">setupProxy.js</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="9ab4" class="nf lq in nb b gy ng nh l ni nj">const proxy = require('http-proxy-middleware').createProxyMiddleware;</span><span id="316d" class="nf lq in nb b gy np nh l ni nj">module.exports = function (app) {<br/>    app.use(proxy(`/auth/**`, { target: 'http://localhost:8080' }));<br/>};</span></pre><p id="01b8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">同样在<code class="fe nm nn no nb b">src</code>文件夹中，让我们创建几个其他文件:</p><p id="caff" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Home.js:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="f235" class="nf lq in nb b gy ng nh l ni nj">import <strong class="nb io"><em class="nq">React </em></strong>from 'react';<br/>import './App.css';<br/><br/>function Home() {<br/>    return (<br/>        &lt;div className="App"&gt;<br/>            &lt;header className="App-header"&gt;<br/>                &lt;p&gt;<br/>                    You are not logged in to Spotify<br/>                &lt;/p&gt;<br/>                &lt;a<br/>                    className="App-link"<br/>                    href={"/auth/login"}<br/>                &gt;<br/>                    Login Here<br/>                &lt;/a&gt;<br/>            &lt;/header&gt;<br/>        &lt;/div&gt;<br/>    );<br/>}<br/><br/>export default Home;</span></pre><p id="809e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Loading.js:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="12bb" class="nf lq in nb b gy ng nh l ni nj">import <strong class="nb io"><em class="nq">React </em></strong>from 'react';<br/>import './App.css';<br/><br/>function Loading() {<br/>    return (<br/>        &lt;div className="App"&gt;<br/>            &lt;header className="App-header"&gt;<br/>                &lt;p&gt;<br/>                    Loading...<br/>                &lt;/p&gt;<br/>            &lt;/header&gt;<br/>        &lt;/div&gt;<br/>    );<br/>}<br/><br/>export default Loading;</span></pre><p id="0d54" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">SpotifyRecommender.js:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="ec50" class="nf lq in nb b gy ng nh l ni nj">import React from 'react'</span><span id="8203" class="nf lq in nb b gy np nh l ni nj">const SpotifyRecommender = () =&gt; {<br/> return ( &lt;div&gt;Hello Yes I'm logged in&lt;/div&gt; )<br/>}</span><span id="6a8e" class="nf lq in nb b gy np nh l ni nj">export default SpotifyRecommender;</span></pre><p id="3c19" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后，让我们对App.js进行更改，以便它能够反映我们希望在应用程序中使用的导航:</p><p id="a17d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">App.js:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="792d" class="nf lq in nb b gy ng nh l ni nj">import <strong class="nb io"><em class="nq">React</em></strong>, {useState, useEffect} from 'react';<br/>import <strong class="nb io"><em class="nq">axios </em></strong>from 'axios';<br/>import './App.css';<br/>import Home from "./Home";<br/>import Loading from "./Loading";<br/>import SpotifyRecommender from "./SpotifyRecommender";<br/><br/>function App() {<br/>  const [auth, setAuth] = useState(null);<br/><br/>  useEffect(() =&gt; {<br/>    <strong class="nb io"><em class="nq">axios</em></strong>.get('/auth/current-session').then(({data}) =&gt; {<br/>      setAuth(data);<br/>    })<br/>  }, []);<br/><br/>  if (auth === null) {<br/>    return &lt;Loading/&gt;<br/>  }<br/>  if (auth) {<br/>    return &lt;SpotifyRecommender auth={auth}/&gt;<br/>  }<br/>  return &lt;Home/&gt;<br/>}<br/><br/>export default App;</span></pre><p id="7c90" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这和<a class="ae ks" href="https://medium.com/javascript-in-plain-english/secure-react-express-apps-jsonwebtoken-cookie-session-auth0-and-passport-tutorial-e58d6dce6c91" rel="noopener">我的安全服务器教程</a>几乎完全一样，但是要刷新一下:</p><ol class=""><li id="485f" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated">当应用程序加载时，它将向我们的后端“当前会话”端点发送一个请求，在那里它将获取数据并设置身份验证状态。</li><li id="6f51" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">这意味着当我们的auth状态为null(这是它的初始状态)时，将返回加载屏幕，上面只写着“正在加载…”</li><li id="fa07" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">如果auth存在并且不是false，那么我们返回我们的Spotify推荐者屏幕。我们还传入了auth状态，以便以后使用它！</li><li id="f190" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">如果auth为false，这是我们没有登录时会发生的情况，那么我们的应用程序会显示主屏幕，为我们的用户提供登录。幸运的是，我们的登录端点已经连接到我们的Spotify认证工作流！</li></ol><h1 id="270e" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">搜索栏</h1><p id="83b4" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">搜索栏是我们需要在<code class="fe nm nn no nb b">SpotifyRecommender</code>屏幕中创建的组件列表中的第一个，所以让我们直接进入它。我们真正需要的是一个带有搜索按钮的文本字段。我们可以用下面的大纲创建我们需要的东西:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="c3f5" class="nf lq in nb b gy ng nh l ni nj">import React, {useState} from 'react';<br/>import './App.css';</span><span id="48e5" class="nf lq in nb b gy np nh l ni nj">import {Grid, TextField, Button} from '@material-ui/core';<br/>import {Search} from '@material-ui/icons';</span><span id="6270" class="nf lq in nb b gy np nh l ni nj">const SpotifyRecommender = ({auth}) =&gt; {<br/>  const {token} = auth;<br/>  const [searchResults, setSearchResults] = useState([]);<br/>  const [searchString, setSearchString] = useState('');</span><span id="8695" class="nf lq in nb b gy np nh l ni nj">  return (<br/>    &lt;div className={"App"}&gt;<br/>        &lt;Grid container style={{padding: 20}} spacing={1}&gt;<br/>          &lt;Grid item xs={12}&gt;<br/>            Spotify Recommender<br/>          &lt;/Grid&gt;<br/>          &lt;Grid item xs={6}&gt;<br/>            &lt;Grid item xs={12} style={{display: 'flex', flexDirection: 'row'}}&gt;<br/>              &lt;TextField<br/>                variant={'outlined'}<br/>                label={"Search"}<br/>                style={{backgroundColor: 'white'}}<br/>                fullWidth<br/>                onChange={event =&gt; setSearchString(event.target.value)}<br/>                value={searchString}<br/>              /&gt;<br/>              &lt;Button style={{backgroundColor: '#ff905b'}}&gt;<br/>                &lt;Search/&gt;<br/>              &lt;/Button&gt;<br/>            &lt;/Grid&gt;<br/>          &lt;/Grid&gt;<br/>          &lt;Grid item xs={12}&gt;<br/>          &lt;/Grid&gt;<br/>        &lt;/Grid&gt;<br/>    &lt;/div&gt;</span><span id="167d" class="nf lq in nb b gy np nh l ni nj">  );<br/>};</span><span id="7ffa" class="nf lq in nb b gy np nh l ni nj">export default SpotifyRecommender</span></pre><p id="e10e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">对这里所做工作的简要说明:</p><ol class=""><li id="6524" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated">仍然使用我们的starter项目给我们的css，主要组件使用类“App”包装在一个div中。</li><li id="9c66" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">我使用来自<a class="nk nl ep" href="https://medium.com/u/9d99f1b2974b?source=post_page-----463c6c232219--------------------------------" rel="noopener" target="_blank"> Material-UI </a>的网格组件来给我们的页面一些格式。它非常简单，可以与flex-box风格相提并论。</li><li id="803a" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">你可以看到“Spotify推荐者”作为页面标题</li><li id="9073" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">material-ui中的TextField组件与一个状态变量<code class="fe nm nn no nb b">searchString</code>一起使用，这样我们就可以获取输入到文本字段中的值，并在用户单击搜索按钮时保存它</li><li id="2331" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">最后，当用户想要提交他们的搜索时，添加一个按钮。</li></ol><p id="6d52" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">目前不追求任何漂亮的东西，只追求功能性:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nr"><img src="../Images/b91b975b4bb4b97a0eb5ea111b172429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WAxKgn6bPregtNf3G2-SxQ.png"/></div></div></figure><p id="6731" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果您查看上面的代码，您还会看到我们正在使用从App.js文件传递到组件中的auth属性。如果您还记得本系列教程第1部分中auth对象的样子，您会记得保存了一个访问令牌。我们实际上需要这个令牌，以便向Spotify API发送重要的请求，这就是为什么我们从组件顶部的auth对象中解构它:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="c21d" class="nf lq in nb b gy ng nh l ni nj">const {token} = auth;</span></pre><p id="5a27" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了进行搜索，我们可以看一下<a class="ae ks" href="https://developer.spotify.com/documentation/web-api/reference/search/search/" rel="noopener ugc nofollow" target="_blank"> Spotify Web API </a>上提供的文档，但这里有一个简短的概述:</p><p id="9e74" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">获取请求:<a class="ae ks" href="https://api.spotify.com/v1/search" rel="noopener ugc nofollow" target="_blank">https://api.spotify.com/v1/search</a><br/>所需标题:授权<br/>查询参数:<br/> 1。q —搜索关键词，<br/> 2。类型—专辑、艺术家、播放列表、曲目、节目、剧集</p><p id="c9a0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们可以获取这些信息，并在组件中创建一个函数。我们所做的就是使用输入到文本字段中的搜索字符串来查找我们想要播种的艺术家:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="d992" class="nf lq in nb b gy ng nh l ni nj">const searchSpotify = async () =&gt; {<br/>  const url = 'https://api.spotify.com/v1/search';<br/>  const searchQuery = encodeURIComponent(searchString);<br/>  const typeQuery = `type=artist`;<br/>  const {data} = await axios.get(`${url}?q=${searchQuery}&amp;${typeQuery}`, {<br/>    headers: {<br/>      Authorization: `Bearer ${token}`,<br/>    }<br/>  });<br/>  console.log(data);</span><span id="8f65" class="nf lq in nb b gy np nh l ni nj">  if (data &amp;&amp; data.artists) {<br/>    setSearchResults(data.artists.items);<br/>  }<br/>}</span></pre><p id="6008" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们可以将它添加到我们的按钮点击:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="1ae2" class="nf lq in nb b gy ng nh l ni nj">&lt;Button style={{backgroundColor: '#ff905b'}} onClick={searchSpotify}&gt;<br/>  &lt;Search/&gt;<br/>&lt;/Button&gt;</span></pre><p id="66df" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果我们做了这些更改并打开我们的web控制台，我们应该能够键入一个查询，并在我们点击搜索按钮时看到来自Spotify API的响应。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ns"><img src="../Images/b760a249049d88e67e3666b2714aaecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yCZwQ17QzsWk8OwK1OLO9w.png"/></div></div></figure><p id="eb95" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">太美了。我们现在唯一需要做的就是在文本字段下面呈现搜索结果列表。</p><h2 id="4323" class="nf lq in bd lr nt nu dn lv nv nw dp lz lc nx ny mb lg nz oa md lk ob oc mf od bi translated">搜索结果</h2><p id="c2ca" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">因为如果我们将每个组件都放在SpotifyRecommender.js文件中，事情可能会变得有点混乱，所以如果我们创建一个可以从中导入的组件库，将会对我们有所帮助。只需在<code class="fe nm nn no nb b">src</code>目录中创建一个文件夹<code class="fe nm nn no nb b">components</code>。然后我们可以添加我们的第一个组件，<code class="fe nm nn no nb b">SearchResults.js</code>。</p><p id="a10f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">该组件的目标是为我们的搜索结果提供一个可选列表，用户可以在其中选择最多3位艺术家:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="d4cc" class="nf lq in nb b gy ng nh l ni nj">// components/SearchResults.js</span><span id="fef2" class="nf lq in nb b gy np nh l ni nj">import React from 'react';<br/>import {ListItem, List, ListItemIcon, ListItemText, Checkbox} from '@material-ui/core';</span><span id="8372" class="nf lq in nb b gy np nh l ni nj">const SearchResults = ({results, onChange}) =&gt; {<br/>  const [checked, setChecked] = React.useState([]);</span><span id="a07b" class="nf lq in nb b gy np nh l ni nj">  const handleToggle = (value) =&gt; () =&gt; {<br/>    const currentIndex = checked.indexOf(value);<br/>    const newChecked = [...checked];</span><span id="2d24" class="nf lq in nb b gy np nh l ni nj">    if (currentIndex === -1) {<br/>      if (checked.length &lt; 3) {<br/>        newChecked.push(value);<br/>      }<br/>    } else {<br/>      newChecked.splice(currentIndex, 1);<br/>    }</span><span id="6cbc" class="nf lq in nb b gy np nh l ni nj">    setChecked(newChecked);<br/>    onChange(newChecked)<br/>  };</span><span id="f3e8" class="nf lq in nb b gy np nh l ni nj">  return (<br/>    &lt;List&gt;<br/>    {results.map((item, index) =&gt; (<br/>      &lt;ListItem key={item.id} dense button onClick={handleToggle(item.id)}&gt;<br/>        &lt;ListItemIcon&gt;<br/>          &lt;Checkbox<br/>            edge={"start"}<br/>            checked={checked.indexOf(item.id) !== -1}<br/>            tabIndex={-1}<br/>            disableRipple<br/>            /&gt;<br/>        &lt;/ListItemIcon&gt;<br/>        &lt;ListItemText&gt;<br/>          {item.name}<br/>        &lt;/ListItemText&gt;<br/>      &lt;/ListItem&gt;<br/>      ))}<br/>    &lt;/List&gt;<br/>  );<br/>}</span><span id="8b1b" class="nf lq in nb b gy np nh l ni nj">export default SearchResults</span></pre><p id="0508" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们来分解一下:</p><ol class=""><li id="b355" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated">我们正在创建一个名为SearchResults的功能组件，它有两个传入的属性:Results，这是我们从搜索中返回的结果列表onChange，这是我们选择一个结果时运行的函数。</li><li id="b49c" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">我们创建了<code class="fe nm nn no nb b">checked</code>和<code class="fe nm nn no nb b">setChecked</code>作为一个反应状态获取器/设置器，这样我们就可以记录我们选择了哪些艺术家。</li><li id="4c21" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated"><code class="fe nm nn no nb b">handleToggle</code>功能是检查以确保我们还没有检查3个项目。在函数结束时，我们用选中的项目设置本地状态，并将选中的项目传递到<code class="fe nm nn no nb b">onChange</code>函数属性中。</li><li id="b886" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">剩下的只是一个使用material-ui组件的可选列表，在这里我们获取从查询中返回的结果，并显示每个项目的名称。当我们选择一个项目时，我们将歌曲的Spotify ID传递给我们的<code class="fe nm nn no nb b">handleToggle </code>方法。</li></ol><p id="8734" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">回到我们的SpotifyRecommender.js:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="6f3f" class="nf lq in nb b gy ng nh l ni nj">import SearchResults from './components/SearchResults';<br/>....<br/>const [selectedArtists, setSelectedArtists] = useState([]);<br/>....<br/>&lt;Grid item xs={12}&gt;<br/>  &lt;SearchResults onChange={setSelectedArtists} results={searchResults}/&gt;<br/>&lt;/Grid&gt;</span></pre><p id="de1a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们已经将组件传递到我们的主屏幕。为了将选中的项目返回到父组件，我们将<code class="fe nm nn no nb b">setSelectedArtists</code>作为<code class="fe nm nn no nb b">onChange</code>函数传递到SearchResults中，以便稍后可以在SpotifyRecommender文件中使用该状态。让我们来测试一下:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oe"><img src="../Images/27020b617ce39773e0561f4c608d915d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*45-VDRTengzK2HihMxSoIQ.png"/></div></div></figure><p id="c925" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">但是，如果你想通过不同的搜索来搜索和选择三个不同的艺术家，当你搜索下一个人时，复选标记不会消失吗？如果需要，您可以在搜索框上方添加一些视觉反馈，列出您当前选择的内容:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="ebc7" class="nf lq in nb b gy ng nh l ni nj">//SpotifyRecommender:</span><span id="ed3b" class="nf lq in nb b gy np nh l ni nj">&lt;Grid item xs={12}&gt;<br/>  {selectedArtists.map((artist, index) =&gt; (<br/>    &lt;Typography&gt;<br/>      {index+1}. {artist}<br/>    &lt;/Typography&gt;<br/>  ))}<br/>&lt;/Grid&gt;</span></pre><h1 id="3c78" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">创建滑块</h1><p id="70aa" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">因此，在我们的组件列表的下一步，我们将需要一个部分，它有一堆滑块来表示我们可以为推荐端点调整的每个自定义值，如能量、声音、流行度等。让我们创建一个新的组件，它可以代表所有这些nobs的板(我已经意识到开发后，这应该被命名为<code class="fe nm nn no nb b">SliderBoard.js</code>，但我很累，并把这些与Nobs lol关联起来):</p><p id="a4bf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><code class="fe nm nn no nb b">components/NobBoard.js</code></p><p id="4c91" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果我们想一想这应该如何工作，并且如果您看一看API文档中不同的可用值，您将会看到与每个指标相关联的不同的最小值和最大值，有些只接受0和1、1和100之间的数字，等等。因此，从逻辑上讲，我们应该创建一个对象数组来保存nob的最小值和最大值:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="3e0c" class="nf lq in nb b gy ng nh l ni nj">//NobBoard.js</span><span id="e140" class="nf lq in nb b gy np nh l ni nj">//imports that will be used in the actual component later:<br/>import <strong class="nb io"><em class="nq">React</em></strong>, {useState, useEffect} from 'react';<br/>import {<strong class="nb io"><em class="nq">Grid</em></strong>, <strong class="nb io"><em class="nq">Typography</em></strong>, <strong class="nb io"><em class="nq">Slider</em></strong>, Checkbox} from '@material-ui/core';</span><span id="f4e3" class="nf lq in nb b gy np nh l ni nj">// initial state for our nobs:</span><span id="6caf" class="nf lq in nb b gy np nh l ni nj">const nobs = {<br/>  'acousticness': {<br/>    value: [0, 1],<br/>    enabled: false,<br/>    min: 0,<br/>    max: 1,<br/>    step: 0.01<br/>  },<br/>  'danceability': {<br/>    value: [0, 1],<br/>    enabled: false,<br/>    min: 0,<br/>    max: 1,<br/>    step: 0.01<br/>  },<br/>  'energy': {<br/>    value: [0, 1],<br/>    enabled: false,<br/>    min: 0,<br/>    max: 1,<br/>    step: 0.01<br/>  },<br/>  'instrumentalness': {<br/>    value: [0, 1],<br/>    enabled: false,<br/>    min: 0,<br/>    max: 1,<br/>    step: 0.01<br/>  },<br/>  'liveness': {<br/>    value: [0, 1],<br/>    enabled: false,<br/>    min: 0,<br/>    max: 1,<br/>    step: 0.01<br/>  },<br/>  'loudness': {<br/>    value: [-60, 0],<br/>    enabled: false,<br/>    min: -60,<br/>    max: 0<br/>  },<br/>  'popularity': {<br/>    value: [0, 100],<br/>    enabled: false,<br/>    min: 0,<br/>    max: 100,<br/>    step: 1,<br/>  },<br/>  'speechiness': {<br/>    value: [0, 1],<br/>    enabled: false,<br/>    min: 0,<br/>    max: 1,<br/>    step: 0.01<br/>  },<br/>  'tempo': {<br/>    value: [0, 200],<br/>    enabled: false,<br/>    min: 0,<br/>    max: 200,<br/>    step: 1,<br/>  },<br/>  'valence': {<br/>    value: [0, 1],<br/>    enabled: false,<br/>    min: 0,<br/>    max: 1,<br/>    step: 0.01<br/>  },<br/>};</span></pre><p id="5af5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这些值的简要说明:</p><ol class=""><li id="a368" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated">对象的关键字是我们的度量的名称</li><li id="95b5" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">value:指定nob的当前设定值</li><li id="ac6f" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">启用:是否启用此nob(用户是否希望在其搜索中包含此指标)</li><li id="1c0b" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">min:这个nob的最小值是多少</li><li id="b06e" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">max:这个nob的最大值是多少</li><li id="763f" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">步骤:滑块改变值的增量是多少</li></ol><p id="4f74" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们想做的只是简单地用一个函数来遍历这个nob数组并呈现它们。此外，我们希望有一个复选框，允许用户启用/禁用他们想要激活的nob。最后，我们需要一个<code class="fe nm nn no nb b">onChange </code>函数，将我们的nob设置返回给我们的父组件:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="1d7f" class="nf lq in nb b gy ng nh l ni nj">const NobBoard = ({onChange}) =&gt; {<br/>  const [boardValues, setBoardValues] = useState(nobs);<br/><br/>  const handleChange = (nob, value) =&gt; {<br/>    const newBoardValues = {...boardValues};<br/>    newBoardValues[nob].value = value;<br/>    setBoardValues(newBoardValues);<br/>  };<br/><br/>  const toggleNob = (nob, value) =&gt; {<br/>    const newBoardValues = {...boardValues};<br/>    newBoardValues[nob].enabled = value;<br/>    setBoardValues(newBoardValues);<br/>  };<br/><br/>  useEffect(() =&gt; {<br/>    onChange(boardValues);<br/>  }, [onChange, boardValues]);<br/><br/>  return (<br/>   &lt;Grid container spacing={2} style={{padding: 10}}&gt;<br/>     {<strong class="nb io"><em class="nq">Object</em></strong>.keys(nobs).map(nob =&gt; (<br/>       &lt;Grid item xs={12}&gt;<br/>         &lt;div style={{display: 'flex', flexDirection: 'row'}}&gt;<br/>           &lt;Checkbox<br/>             checked={boardValues[nob].enabled}<br/>             onChange={(event, newValue) =&gt; toggleNob(nob, newValue)}<br/>           /&gt;<br/>           &lt;div style={{flex: 1}}&gt;<br/>             &lt;Typography&gt;<br/>               {nob}<br/>             &lt;/Typography&gt;<br/>             &lt;Grid container spacing={1}&gt;<br/>               &lt;Grid item&gt;<br/>                 &lt;Typography&gt;<br/>                   Min<br/>                 &lt;/Typography&gt;<br/>               &lt;/Grid&gt;<br/>               &lt;Grid item xs&gt;<br/>                 &lt;Slider<br/>                   disabled={!boardValues[nob].enabled}<br/>                   value={boardValues[nob].value}<br/>                   onChange={(event, newValue) =&gt; handleChange(nob, newValue)}<br/>                   valueLabelDisplay={"on"}<br/>                   aria-labelledby={"range-slider"}<br/>                   min={nobs[nob].min}<br/>                   max={nobs[nob].max}<br/>                   step={nobs[nob].step}<br/>                 /&gt;<br/>               &lt;/Grid&gt;<br/>               &lt;Grid item&gt;<br/>                 &lt;Typography&gt;<br/>                   Max<br/>                 &lt;/Typography&gt;<br/>               &lt;/Grid&gt;<br/>             &lt;/Grid&gt;<br/>           &lt;/div&gt;<br/>         &lt;/div&gt;<br/>       &lt;/Grid&gt;<br/>     ))}<br/>   &lt;/Grid&gt;<br/>  );<br/>};<br/><br/>export default NobBoard</span></pre><p id="f1e4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果我们将旋钮板和一个状态变量添加到父组件SpotifyRecommender:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="e5be" class="nf lq in nb b gy ng nh l ni nj">...<br/>const [nobValues, setNobValues] = useState({});<br/>...</span><span id="4dee" class="nf lq in nb b gy np nh l ni nj">&lt;Grid item xs={6}&gt;<br/>  &lt;NobBoard onChange={setNobValues}/&gt;<br/>&lt;/Grid&gt;<br/>...</span></pre><p id="7dd3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是我们将在整个页面上看到的内容:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi of"><img src="../Images/aab3a77a2e9b78a6376ae8d4842ccd30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OUxrXchpxhWpgQ0cQfdkRw.png"/></div></div></figure><p id="d3e1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">假设我们启用并更改其中一个旋钮的值，同时搜索并选择一些艺术家:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi og"><img src="../Images/c58d12d4b130fdac3c8e5316ccaf5ef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AkJsQBUT_5wcXF1E95faCA.png"/></div></div></figure><p id="fbb7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">不错！现在我们需要的是发送请求和呈现结果的逻辑！</p><h1 id="1b7f" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">创建并发送我们的请求</h1><p id="6360" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">在这一点上，我们有我们的搜索和滑块控制我们的领域的完整页面。当我们对选择进行更改时，它会以不同的状态保存在SpotifyRecommender组件中。我们现在需要编写逻辑，在请求中将该信息整齐地发送到Spotify推荐API端点。我们的目标是获取我们的信息，并将其转换成如下形式:</p><p id="5718" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><code class="fe nm nn no nb b">GET <a class="ae ks" href="https://api.spotify.com/v1/recommendations" rel="noopener ugc nofollow" target="_blank">https://api.spotify.com/v1/recommendations</a>?seed_artists=someArtistID,anotherArtistID&amp;min_popularity=50&amp;min_popularity=100</code></p><p id="141e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">请记住，我们还需要我们的授权头！</p><p id="7c0a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们可以放在SpotifyRecommender中的漂亮函数如下所示:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="37e6" class="nf lq in nb b gy ng nh l ni nj">const getRecommendations = async () =&gt; {<br/>  const url = 'https://api.spotify.com/v1/recommendations';<br/><br/>  // get artists<br/>  let selectedArtistsString;<br/>  if (selectedArtists.length &lt; 0) {<br/>    return;<br/>  } else {<br/>    selectedArtistsString = `seed_artists=${selectedArtists.join(',')}`;<br/>  }<br/><br/>  // getnobs<br/>  let min = [];<br/>  let max = [];<br/>  <strong class="nb io"><em class="nq">Object</em></strong>.keys(nobValues).forEach(nob =&gt; {<br/>    if (nobValues[nob].enabled) {<br/>      // then we add our min and max values<br/>      min.push(`min_${nob}=${nobValues[nob].value[0]}`);<br/>      max.push(`max_${nob}=${nobValues[nob].value[1]}`);<br/>    }<br/>  });<br/>  const minString = min.join('&amp;');<br/>  const maxString = max.join('&amp;');<br/><br/><br/>  const {data} = await <strong class="nb io"><em class="nq">axios</em></strong>.get(`${url}?${selectedArtistsString}&amp;${minString}&amp;${maxString}`, {<br/>    headers: {<br/>      Authorization: `Bearer ${token}`,<br/>    }<br/>  });<br/>  <strong class="nb io"><em class="nq">console</em></strong>.log(data);<br/>};<br/>....<br/>.....<br/>// meanwhile in our return:<br/>&lt;Button variant={'contained'} onClick={getRecommendations}&gt;<br/>  Get Recommendations<br/>&lt;/Button&gt;</span></pre><p id="2224" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们来分解一下:</p><ol class=""><li id="c8ae" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated">我们首先将我们的推荐端点url设置为一个<code class="fe nm nn no nb b">const </code>,以便以后使用</li><li id="5e5f" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">然后，我们将选定的艺术家连接在一起，中间用逗号隔开。</li><li id="b711" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">我们遍历nob并创建两个数组，一个包含最小值，一个包含最大值。然后我们把这些旋钮连接成串，中间有&amp;。</li><li id="5f87" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">最后，我们将这些值一起插入到一个漂亮的url中，我们可以在axios GET请求中发送该URL，同时还可以传入我们的授权头。</li><li id="daf9" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">然后我们打印出结果！</li></ol><p id="f3d6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">所以我们的要求有以下几点:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oh"><img src="../Images/51b2a36687d442406a86ed1613bd0650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3GdH1cMW73ooe_06bZxmeQ.png"/></div></div></figure><p id="1650" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">看起来像这样:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="a5e5" class="nf lq in nb b gy ng nh l ni nj"><a class="ae ks" href="https://api.spotify.com/v1/recommendations?seed_artists=4UXqAaa6dQYAk18Lv7PEgX&amp;min_acousticness=0.33&amp;max_acousticness=0.8" rel="noopener ugc nofollow" target="_blank">https://api.spotify.com/v1/recommendations?seed_artists=4UXqAaa6dQYAk18Lv7PEgX&amp;min_acousticness=0.33&amp;max_acousticness=0.8</a></span></pre><p id="6767" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">点击“获取推荐”按钮后，我们的结果如下所示:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oi"><img src="../Images/9799f9f6b8bc8aaf9a2d38a1286e3d41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*YCBCiJ9S83ks41X6JjEegg.png"/></div></div></figure><p id="86ed" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">看来我们找回了5首曲目！</p><p id="dff0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">所以，现在我们需要做的是获取这些信息，并很好地展示给我们的用户！</p><h1 id="99fd" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">显示结果</h1><p id="4600" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">这是我们前端旅程的简单结束，我们只需要显示原始查询的结果。就像这样简单:</p><ol class=""><li id="5ed0" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated">向我们的主页添加一个州来存储结果:</li></ol><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="d336" class="nf lq in nb b gy ng nh l ni nj">// SpotifyRecommender.js<br/>....<br/>const [results, setResults] = useState(null)<br/>....<br/>// and then at the end of our getRecommendations function we set the // state for the results:</span><span id="0258" class="nf lq in nb b gy np nh l ni nj">setResults(data)<br/>...</span></pre><p id="e97a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">2.我们为搜索结果创建了一个新组件:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="58d6" class="nf lq in nb b gy ng nh l ni nj">// components: ResultsList.js<br/>import <strong class="nb io"><em class="nq">React </em></strong>from 'react';<br/>import {<strong class="nb io"><em class="nq">Typography</em></strong>, <strong class="nb io"><em class="nq">List</em></strong>, <strong class="nb io"><em class="nq">ListItem</em></strong>, ListItemText} from "@material-ui/core";<br/><br/>const ResultsList = ({results}) =&gt; {<br/>    <strong class="nb io"><em class="nq">console</em></strong>.log(results)<br/>    if (!results.tracks || results.tracks.length === 0) {<br/>        return (<br/>            &lt;Typography&gt;<br/>                No Results!<br/>            &lt;/Typography&gt;<br/>        )<br/>    }<br/>    return (<br/>        &lt;List&gt;<br/>            {results.tracks.map(track =&gt; (<br/>                &lt;ListItem item xs={12} key={track.id}&gt;<br/>                    &lt;ListItemText&gt;<br/>                        {track.name} - {track.artists ? track.artists[0].name : ''}<br/>                    &lt;/ListItemText&gt;<br/>                &lt;/ListItem&gt;<br/>            ))}<br/>        &lt;/List&gt;<br/>    )<br/>}<br/><br/>export default ResultsList;</span></pre><p id="0acc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们只是简单地检查是否有结果，如果有，我们就打印出名字和艺术家！否则我们就说我们没有结果。</p><p id="3ee8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">3.我们在SpotifyRecommender组件的底部导入并使用它:</p><pre class="kd ke kf kg gt na nb nc nd aw ne bi"><span id="d90d" class="nf lq in nb b gy ng nh l ni nj">&lt;Grid item xs={12}&gt;<br/>  {results &amp;&amp; &lt;ResultsList results={results}/&gt; }<br/>&lt;/Grid&gt;</span></pre><p id="fec3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">条件就是说，如果结果为null，我们不显示任何内容。●看看当我们搜索让我们想起fall out boy的原声歌曲时会发生什么:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oj"><img src="../Images/8a7c84f2e482a65c831a41987da44d69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WPXLsIar5qAvuDbWk6NM8g.png"/></div></div></figure><h1 id="2d03" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">结论+额外学分</h1><p id="ea04" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">是的，我们的代码有点乱，可能有点低效，可能还有一两个bug，但这是一个很好的开始，可以制作一个真正可靠的小型实用web应用程序，可以用来发现一些新的音乐！在本系列的下一部分中，我们将看看如何将这个代码库转换成模块化的和组织良好的。我们将添加一些开发依赖，以帮助维护我们的项目，我们可以通过部署这样的东西到网络的步骤！</p><p id="83ea" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">请记住，当搜索推荐时，如果您能够输入最大种子，您将获得更多结果。测试各种艺术家和滑块值，看看你能得到什么样的模糊结果！</p><p id="6f06" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">一些额外积分！！你可以自己做很多事情来加强这个小项目，这里有一些想法:</strong></p><ol class=""><li id="a17c" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated">在结束时显示的歌曲旁边添加图像</li><li id="bc23" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">让这个项目更时尚一点</li><li id="8b48" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">创建一个按钮，将结果添加到用户Spotify帐户的播放列表中。</li></ol><p id="3250" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">或者如果你想变得更高级:</strong></p><ol class=""><li id="4c4f" class="mm mn in kv b kw kx kz la lc mo lg mp lk mq lo mr ms mt mu bi translated">当我们登录时，Spotify API提供的用户令牌在一个小时后过期，如果用户仍在使用该网站，编写一些逻辑来刷新该令牌。</li><li id="99c1" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">允许用户搜索在播种过程中使用的专辑和曲目</li><li id="1a9a" class="mm mn in kv b kw mv kz mw lc mx lg my lk mz lo mr ms mt mu bi translated">添加Spotify Web Player SDK，允许用户直接从该页面播放歌曲</li></ol><p id="ef49" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">非常感谢您的阅读，敬请期待第三集！</p><p id="6926" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">以下是这篇文章的所有更新代码:</p><p id="afb3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://github.com/jdstregz/spotify-recommendations" rel="noopener ugc nofollow" target="_blank">https://github.com/jdstregz/spotify-recommendations</a></p></div></div>    
</body>
</html>