<html>
<head>
<title>PureScript: A Functional Language That Compiles to JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PureScript:编译成JavaScript的函数式语言</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/purescript-cheatsheet-9ba7da3d393f?source=collection_archive---------10-----------------------#2021-09-23">https://javascript.plainenglish.io/purescript-cheatsheet-9ba7da3d393f?source=collection_archive---------10-----------------------#2021-09-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0f11" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">PureScript基础:对象、递归、映射等等</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c951390e1006b2cc80d00a0f26b6652e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j9dqogFLMLW8Hrm6eofFkw.png"/></div></div></figure><p id="65f3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我说过我有多爱PureScript吗？</p><p id="346b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该项目完全在Node.js上运行，代码被编译成JavaScript——然而它使用了一种完全不同的编程语言:一种非常类似Haskell的语言。</p><p id="6609" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">只是在Haskell的传统中，PureScript是一种纯函数式编程语言。正如我之前给出的介绍和安装指南一样，现在我将介绍这门语言的基础知识。</p><p id="7335" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要了解PureScript是什么，如何安装和运行它，请查看以下内容:</p><div class="ln lo gp gr lp lq"><a rel="noopener  ugc nofollow" target="_blank" href="/purescript-3ee759ce05aa"><div class="lr ab fo"><div class="ls ab lt cl cj lu"><h2 class="bd ir gy z fp lv fr fs lw fu fw ip bi translated">用PureScript为Web带来强大的函数式编程</h2><div class="lx l"><h3 class="bd b gy z fp lv fr fs lw fu fw dk translated">就像JavaScript的Haskell</h3></div><div class="ly l"><p class="bd b dl z fp lv fr fs lw fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="lz l"><div class="ma l mb mc md lz me kp lq"/></div></div></a></div><p id="25be" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，随时回来学习基础知识。如果您已经安装并运行了PureScript，没有什么可以阻止我们——让我们学习PureScript的基础知识吧！</p><h1 id="e8ac" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">在控制台中打印东西</h1><p id="ce18" class="pw-post-body-paragraph kr ks iq kt b ku mx jr kw kx my ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">最强大的调试工具？肯定是主机！然而，由于PureScript不是那么容易使用，这可能会感觉很麻烦。让我们揭开主机的神秘面纱。</p><p id="1742" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">登录主函数就像这样简单:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="931d" class="nh mg iq nd b gy ni nj l nk nl">main = log "Hello World!"</span></pre><p id="f07b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">默认情况下，log函数只能接收字符串。变量、数字和所有其他类型需要首先用show-function进行转换:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="4a03" class="nh mg iq nd b gy ni nj l nk nl">main = log (show(10))</span></pre><p id="bbf7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">打印一个函数调用(因此，它的返回值)也是一样的:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="21ab" class="nh mg iq nd b gy ni nj l nk nl">double x = x * 2<br/><br/>main = log (show (double 2))</span></pre><p id="5354" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">用于打印的连接可以这样完成:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="1158" class="nh mg iq nd b gy ni nj l nk nl">printNumber x = "Number: "&lt;&gt; (show (x)) &lt;&gt; "cool, "</span><span id="2862" class="nh mg iq nd b gy nm nj l nk nl">main = log (printNumber 2)</span></pre><p id="d16d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">上面印着:“数字:2酷，嗯？”。</p><p id="74f0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是如果登录一个不是主函数的函数呢？<br/>这个有点麻烦。</p><p id="3dfb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">重要的是要理解登录到控制台是一个副作用。引起副作用会使函数变得不纯，而不纯的函数违背了PureScript和Haskell的哲学。然而，我们可以从每个函数中记录日志——但是我们需要一个技巧来这样做。</p><p id="7b2f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要使用在终端中打印的日志功能，我们需要使用“效果单元”类型。我们可以将函数返回值的类型设置为:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="8fb4" class="nh mg iq nd b gy ni nj l nk nl">saySomething :: String -&gt; Effect Unit</span><span id="905c" class="nh mg iq nd b gy nm nj l nk nl">saySomething msg = log msg</span><span id="7719" class="nh mg iq nd b gy nm nj l nk nl">main = saySomething "My message"</span></pre><h1 id="ddaf" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">记录—就像JavaScript对象一样</h1><p id="ee1a" class="pw-post-body-paragraph kr ks iq kt b ku mx jr kw kx my ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">人们可以将PureScript中的记录看作对象。这些对象的行为就像在JavaScript中一样。唯一的区别是:记录是不可变的。</p><p id="3795" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在初始化记录之前，最佳实践是首先提供它的类型。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="2610" class="nh mg iq nd b gy ni nj l nk nl">type Person =<br/>{ name :: String,<br/>  age :: Int }<br/><br/>max :: Person<br/>max = { name: "Max", age: 22 }<br/><br/>main = log (show max)</span></pre><p id="a9bc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，变量“max”属于“Person”类型，它需要一个名字和一个年龄。main函数记录该记录，我们可以看到与JavaScript中相同的输出:<code class="fe nn no np nd b">{ age: 22, name: "Max" }</code>。</p><p id="2017" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通过点运算符，访问属性也像在JavaScript中一样:</p><p id="2fdf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nn no np nd b">max.name</code>会返回“Max”。</p><h1 id="8eca" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">条件式</h1><p id="d2c3" class="pw-post-body-paragraph kr ks iq kt b ku mx jr kw kx my ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">条件句？是啊，那个如果-否则-的东西。因为PureScript是围绕函数进行解析的，所以我们现在只关注它。</p><p id="0ed4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以下函数接收两个数字作为参数，并且只返回较大的一个:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="777e" class="nh mg iq nd b gy ni nj l nk nl">greatestNum :: Int -&gt; Int -&gt; Int<br/>greatestNum a b =<br/>  <em class="nq">if</em> a &gt; b<br/>  <em class="nq">then</em> a<br/>  <em class="nq">else</em> b</span><span id="dafc" class="nh mg iq nd b gy nm nj l nk nl">main = log (show (greatestNum 2 4))</span></pre><p id="afa6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们可以将现有条件作为参数传递，而不是在函数体内编写比较:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="a401" class="nh mg iq nd b gy ni nj l nk nl">test condition =<br/>  <em class="nq">if</em> condition<br/>  <em class="nq">then</em> "true"<br/>  <em class="nq">else</em> "false"</span><span id="b694" class="nh mg iq nd b gy nm nj l nk nl">main = log (test(2 &gt; 1))</span></pre><p id="abb7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因为2大于1，所以该函数返回“真”。</p><h1 id="7150" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">数组</h1><p id="bb65" class="pw-post-body-paragraph kr ks iq kt b ku mx jr kw kx my ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">就像记录一样，数组在PureScript中是不可变的。</p><p id="4f71" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">初始化数组的方法不止一种。我们可以使用每一个表达式，它返回一个数组来这样做——任何自定义函数，一个映射，一个过滤器，一个范围，或者只是硬编码的数组。我们来看两种方式。</p><p id="5782" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">硬编码:<code class="fe nn no np nd b">nums = [1, 2, 3]</code></p><p id="a5b0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用范围生成数组:<code class="fe nn no np nd b">nums = range 1 3</code></p><p id="3337" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">两者都生成下面的数组:<code class="fe nn no np nd b">[1, 2, 3]</code>。</p><p id="6b0b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">确保首先导入必要的包。将此写在您的文件顶部:<code class="fe nn no np nd b">import Data.Array</code>。</p><p id="01d9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">串联数组不会改变将被串联的数组。因此，函数返回的都是新数组。关于<code class="fe nn no np nd b">concact</code>的特别之处在于，我们将想要添加的数组传递到一个数组中——结果是一个数组的数组作为函数参数。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="031c" class="nh mg iq nd b gy ni nj l nk nl">nums = concat [[1, 2], [3, 4]]</span><span id="1164" class="nh mg iq nd b gy nm nj l nk nl">-- nums now is: [1, 2, 3, 4] </span></pre><h1 id="7b4c" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">地图和过滤器</h1><p id="b721" class="pw-post-body-paragraph kr ks iq kt b ku mx jr kw kx my ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">这两个函数在函数式编程中都是绝对必要的。这两个函数都根据提供的模式转换数据结构——但是，它们不会改变原始结构。</p><p id="43ad" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">地图可以想象成for-each。过滤器可以想象成for-each，只返回符合我们模式的条目。</p><p id="936e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们用map将数字数组中的每个值加倍:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="2852" class="nh mg iq nd b gy ni nj l nk nl">map (\n -&gt; n * 2) [1, 2, 3]</span><span id="24ed" class="nh mg iq nd b gy nm nj l nk nl">-- [2, 4, 6]</span></pre><p id="a6f0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">变量“n”代表数组中的每一个值。我们在值翻倍后返回它。如您所见，函数图的第一个参数是我们使用的模式——这个模式就是函数本身。<br/>第二个参数是我们要映射的数组。</p><p id="af1f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们为所有偶数筛选一个数组:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="2cde" class="nh mg iq nd b gy ni nj l nk nl">filter (\n -&gt; mod n 2 == 0) [1, 2, 3, 4, 5, 6]</span><span id="909e" class="nh mg iq nd b gy nm nj l nk nl">-- [2, 4, 6]</span></pre><p id="51bc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Filter的工作原理是一样的:第一个参数是模式函数，第二个是数组。</p><h1 id="4a73" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">高级函数概念</h1><p id="5866" class="pw-post-body-paragraph kr ks iq kt b ku mx jr kw kx my ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">正如我在之前的文章中介绍了函数的基础一样，让我们来看看更高级的概念:递归和do关键字。</p><h2 id="5353" class="nh mg iq bd mh nr ns dn ml nt nu dp mp la nv nw mr le nx ny mt li nz oa mv ob bi translated">递归</h2><p id="301d" class="pw-post-body-paragraph kr ks iq kt b ku mx jr kw kx my ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">所有开发人员都应该知道递归的概念。这是一种编写可读代码的强大技术。在PureScript中使用递归并不困难——它严重依赖于条件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><h2 id="4205" class="nh mg iq bd mh nr ns dn ml nt nu dp mp la nv nw mr le nx ny mt li nz oa mv ob bi translated">do关键字</h2><p id="90e3" class="pw-post-body-paragraph kr ks iq kt b ku mx jr kw kx my ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">为了理解这个关键字，让我们构建一个小函数来记录一些东西。由于登录到控制台会使我们的函数不纯，我们必须通过类型来注意这一点:效果单元类型。通过使用它，犯副作用作为回报是允许的。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="df5a" class="nh mg iq nd b gy ni nj l nk nl">saySomething :: String -&gt; Effect Unit<br/>saySomething n = log n</span><span id="6072" class="nh mg iq nd b gy nm nj l nk nl">main = saySomething "My message"</span></pre><p id="eb1a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将在控制台中打印“我的消息”。但是如果我们想要做不止一件事呢？比如我们要多次登录？由于我们的函数基本上返回“log”函数，因此多次编写这样的代码是没有用的——函数只能返回一个函数。</p><p id="fca2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">do关键字有助于解决这个问题。突然间，我们可以在“saySomething”的函数体中调用多个函数。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="8f76" class="nh mg iq nd b gy ni nj l nk nl">saySomething :: String -&gt; Effect Unit</span><span id="09e6" class="nh mg iq nd b gy nm nj l nk nl">saySomething n = <em class="nq">do<br/>  </em>log n<br/>  log "Another message"</span><span id="edd6" class="nh mg iq nd b gy nm nj l nk nl">main = saySomething "My message"</span></pre><p id="102a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是PureScript的基础知识！</p><p id="2354" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">万一你有问题，记住语法和功能:<br/> <a class="ae oe" href="https://codingcheats.io/purescript/" rel="noopener ugc nofollow" target="_blank">这里有一个小的纯脚本备忘单</a></p><p id="9358" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢您的阅读！</p><p id="d258" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="nq">更多内容尽在</em><a class="ae oe" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="nq">plain English . io</em></strong></a></p></div></div>    
</body>
</html>