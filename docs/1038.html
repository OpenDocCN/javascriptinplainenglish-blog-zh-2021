<html>
<head>
<title>Embed YouTube Video in a React Native App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将YouTube视频嵌入React本机应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/embed-youtube-video-in-a-react-native-app-7edbf38bbe36?source=collection_archive---------12-----------------------#2021-03-04">https://javascript.plainenglish.io/embed-youtube-video-in-a-react-native-app-7edbf38bbe36?source=collection_archive---------12-----------------------#2021-03-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/25b4b2a5d66d12887f53ad3f1ca273a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Mm0CYt2usVkBlLrC.png"/></div></div></figure><p id="1e3c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">视频支持是一项让你的应用更生动、更具互动性、更有趣的功能。到本文结束时，您将能够轻松地在React Native应用程序中嵌入您选择的任何YouTube视频。为了理解本教程，你应该熟悉React Native中<a class="ae kt" href="https://reactjs.org/docs/hooks-reference.html#useref" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> useRef </strong> </a>和<a class="ae kt" href="https://reactjs.org/docs/hooks-state.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> useState </strong> </a>的用法。</p><p id="8283" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了在React Native中播放YouTube视频，我们将使用名为<a class="ae kt" href="https://www.npmjs.com/package/react-native-youtube-iframe" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">React-Native-YouTube-iframe</strong></a><strong class="jx io">的npm依赖项。</strong>我们将通过将该库完全集成到应用程序中来使用它。</p><h2 id="3551" class="ku kv in bd kw kx ky dn kz la lb dp lc kg ld le lf kk lg lh li ko lj lk ll lm bi translated">装置</h2><p id="9c8f" class="pw-post-body-paragraph jv jw in jx b jy ln ka kb kc lo ke kf kg lp ki kj kk lq km kn ko lr kq kr ks ig bi translated">你需要先安装<strong class="jx io"> react-native-webview </strong>。只需运行:</p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="4d0d" class="ku kv in lx b gy mb mc l md me">yarn add react-native-webview<br/><br/>or<br/><br/>npm install react-native-webview</span></pre><p id="4e41" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后安装<strong class="jx io">react-native-YouTube-iframe:</strong></p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="cf08" class="ku kv in lx b gy mb mc l md me">yarn add react-native-youtube-iframe<br/><br/>or <br/><br/>npm install react-native-youtube-iframe</span></pre><h2 id="8753" class="ku kv in bd kw kx ky dn kz la lb dp lc kg ld le lf kk lg lh li ko lj lk ll lm bi translated">使用</h2><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="7afc" class="ku kv in lx b gy mb mc l md me">/**<br/> * Sample React Native App<br/> * https://github.com/facebook/react-native<br/> *<br/> * @format<br/> * @flow strict-local<br/> */<br/><br/>import React from 'react';<br/>import {View} from 'react-native';<br/>import YoutubePlayer from 'react-native-youtube-iframe';<br/><br/>const App = () =&gt; {<br/><br/>  return (<br/>    &lt;View&gt;<br/>      &lt;YoutubePlayer<br/>        height={300}<br/>        play={true}<br/>        videoId={'84WIaK3bl_s'}<br/>      /&gt;<br/>    &lt;/View&gt;<br/>  );<br/>};</span></pre><p id="d3eb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里需要的道具是<strong class="jx io"> <em class="mf">身高</em> </strong> <em class="mf"> </em>和你打算在React原生应用中播放的YouTube视频的<strong class="jx io"> <em class="mf"> videoId </em> </strong>正如在下面的应用中看到的，我们展示了一个Casey Neistat旅行vlog:</p><figure class="ls lt lu lv gt jo gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/611e8bc6a55628e526fc44883a0772d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:276/format:webp/0*EP6n7qBpP58QsqbA.jpg"/></div></figure><p id="6157" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="mf">播放</em> </strong>道具设置为true，所以让我们更进一步，控制播放和暂停动作:</p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="ebb9" class="ku kv in lx b gy mb mc l md me">/**<br/> * Sample React Native App<br/> * <a class="ae kt" href="https://github.com/facebook/react-native" rel="noopener ugc nofollow" target="_blank">https://github.com/facebook/react-native</a><br/> *<br/> * @format<br/> * @flow strict-local<br/> */</span><span id="7134" class="ku kv in lx b gy mh mc l md me">import React, {useState, useCallback} from 'react';<br/>import {Button, View, Alert} from 'react-native';<br/>import YoutubePlayer from 'react-native-youtube-iframe';</span><span id="d59f" class="ku kv in lx b gy mh mc l md me">const App = () =&gt; {<br/>  const [playing, setPlaying] = useState(false);</span><span id="a7c3" class="ku kv in lx b gy mh mc l md me">  const togglePlaying = () =&gt; {<br/>    setPlaying((prev) =&gt; !prev);<br/>  }</span><span id="a7fb" class="ku kv in lx b gy mh mc l md me">  return (<br/>    &lt;View&gt;<br/>      &lt;YoutubePlayer<br/>        height={300}<br/>        play={playing}<br/>        videoId={'84WIaK3bl_s'}<br/>      /&gt;<br/>      &lt;Button title={playing ? 'pause' : 'play'} onPress={togglePlaying} /&gt;<br/>    &lt;/View&gt;<br/>  );<br/>};</span></pre><p id="2307" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们可以控制YouTube视频的播放和暂停。最好添加一个功能，通过传递依赖项提供的<strong class="jx io"><em class="mf">onChangeState</em></strong>prop等回调来告诉用户视频已经播放完毕:</p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="0b13" class="ku kv in lx b gy mb mc l md me">/**<br/> * Sample React Native App<br/> * <a class="ae kt" href="https://github.com/facebook/react-native" rel="noopener ugc nofollow" target="_blank">https://github.com/facebook/react-native</a><br/> *<br/> * @format<br/> * @flow strict-local<br/> */</span><span id="d82d" class="ku kv in lx b gy mh mc l md me">import React, {useState} from 'react';<br/>import {Button, View, Alert} from 'react-native';<br/>import YoutubePlayer from 'react-native-youtube-iframe';</span><span id="3677" class="ku kv in lx b gy mh mc l md me">const App = () =&gt; {<br/>  const [playing, setPlaying] = useState(false);</span><span id="dfc7" class="ku kv in lx b gy mh mc l md me">  const onStateChange = (state) =&gt; {<br/>    if (state === 'ended') {<br/>      setPlaying(false);<br/>      Alert.alert('video has finished playing!');<br/>    }<br/>  }</span><span id="aae6" class="ku kv in lx b gy mh mc l md me">  const togglePlaying = () =&gt; {<br/>    setPlaying((prev) =&gt; !prev);<br/>  }</span><span id="c853" class="ku kv in lx b gy mh mc l md me">  return (<br/>    &lt;View&gt;<br/>      &lt;YoutubePlayer<br/>        height={300}<br/>        play={playing}<br/>        videoId={'84WIaK3bl_s'}<br/>        onChangeState={onStateChange}<br/>      /&gt;<br/>      &lt;Button title={playing ? 'pause' : 'play'} onPress={togglePlaying} /&gt;<br/>    &lt;/View&gt;<br/>  );<br/>};</span></pre><figure class="ls lt lu lv gt jo gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/ecec8bf407455e44d81622fda2df0a7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:276/0*97FyaaQ_QMCbBxk0.gif"/></div></figure><p id="233c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">既然我们已经学习了这个YouTube播放器依赖项的基本用法，让我们继续为我们的视频播放器建立播放、暂停、跳过和静音的完全控制。</p><pre class="ls lt lu lv gt lw lx ly lz aw ma bi"><span id="7f04" class="ku kv in lx b gy mb mc l md me">import React, {useState, useRef} from 'react';<br/>import {View, Alert, StyleSheet} from 'react-native';<br/>import YoutubePlayer from 'react-native-youtube-iframe';<br/>import {Icon} from 'react-native-elements';</span><span id="85ea" class="ku kv in lx b gy mh mc l md me">const App = () =&gt; {<br/>  const [playing, setPlaying] = useState(false);<br/>  const [isMute, setMute] = useState(false);<br/>  const controlRef = useRef();</span><span id="5227" class="ku kv in lx b gy mh mc l md me">  const onStateChange = (state) =&gt; {<br/>    if (state === 'ended') {<br/>      setPlaying(false);<br/>      Alert.alert('video has finished playing!');<br/>    }<br/>    if (state !== 'playing') {<br/>      setPlaying(false);<br/>    }<br/>  };</span><span id="2c54" class="ku kv in lx b gy mh mc l md me">  const togglePlaying = () =&gt; {<br/>    setPlaying((prev) =&gt; !prev);<br/>  };</span><span id="f531" class="ku kv in lx b gy mh mc l md me">  const seekBackAndForth = (control) =&gt; {<br/>    console.log('currentTime');<br/>    controlRef.current?.getCurrentTime().then((currentTime) =&gt; {<br/>      control === 'forward'<br/>        ? controlRef.current?.seekTo(currentTime + 15, true)<br/>        : controlRef.current?.seekTo(currentTime - 15, true);<br/>    });<br/>  };</span><span id="f888" class="ku kv in lx b gy mh mc l md me">  const muteVideo = () =&gt; setMute(!isMute);</span><span id="f38d" class="ku kv in lx b gy mh mc l md me">  const ControlIcon = ({name, onPress}) =&gt; (<br/>    &lt;Icon onPress={onPress} name={name} size={40} color="#fff" /&gt;<br/>  );</span><span id="5560" class="ku kv in lx b gy mh mc l md me">  return (<br/>    &lt;View style={styles.container}&gt;<br/>      &lt;YoutubePlayer<br/>        height={300}<br/>        ref={controlRef}<br/>        play={playing}<br/>        mute={isMute}<br/>        videoId={'84WIaK3bl_s'}<br/>        onChangeState={onStateChange}<br/>      /&gt;<br/>      &lt;View style={styles.controlContainer}&gt;<br/>        &lt;ControlIcon<br/>          onPress={() =&gt; seekBackAndForth('rewind')}<br/>          name="skip-previous"<br/>        /&gt;<br/>        &lt;ControlIcon<br/>          onPress={togglePlaying}<br/>          name={playing ? 'pause' : 'play-arrow'}<br/>        /&gt;<br/>        &lt;ControlIcon<br/>          onPress={() =&gt; seekBackAndForth('forward')}<br/>          name="skip-next"<br/>        /&gt;<br/>      &lt;/View&gt;<br/>      &lt;ControlIcon<br/>        onPress={muteVideo}<br/>        name={isMute ? 'volume-up' : 'volume-off'}<br/>      /&gt;<br/>    &lt;/View&gt;<br/>  );<br/>};</span><span id="0cd3" class="ku kv in lx b gy mh mc l md me">const styles = StyleSheet.create({<br/>  container: {<br/>    flex: 1,<br/>    backgroundColor: 'darkblue',<br/>  },<br/>  controlContainer: {<br/>    flexDirection: 'row',<br/>    justifyContent: 'space-around',<br/>  },<br/>});</span></pre><p id="a07b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们在之前已经拥有的原始组件中添加了更多自定义控件，并添加了回调以使用<strong class="jx io"><em class="mf">player ref</em></strong>ref向前和向后查找。静音控制基本上由<strong class="jx io"> <em class="mf"> isMute </em> </strong>状态管理，但值得注意的是，依赖关系提供了一个方法<strong class="jx io"> <em class="mf"> isMuted </em> </strong>(如果视频静音，则返回解析为true的承诺，否则为false)来确定视频是否静音。</p><figure class="ls lt lu lv gt jo gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/27b1e498d18e366509b33ca09c0c9762.png" data-original-src="https://miro.medium.com/v2/resize:fit:276/format:webp/0*2b72kR_dpe9TN2_0.jpg"/></div></figure><h2 id="0d9b" class="ku kv in bd kw kx ky dn kz la lb dp lc kg ld le lf kk lg lh li ko lj lk ll lm bi translated">结论</h2><p id="0080" class="pw-post-body-paragraph jv jw in jx b jy ln ka kb kc lo ke kf kg lp ki kj kk lq km kn ko lr kq kr ks ig bi translated">在React原生应用中嵌入和播放YouTube视频是无缝的，也是在应用中显示视频的更经济的方式，因为YouTube将支持托管视频本身的成本。我们描述的npm依赖项非常容易使用，并且高度可定制，正如我们在上面添加了前进和后退控件的代码片段中看到的那样。</p><p id="4e96" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下次你想添加YouTube视频支持来反应本地应用时，请参考本教程。如果你喜欢这个项目，请考虑与你的朋友和社区分享这个链接。干杯！</p><p id="37ac" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><a class="ae kt" href="https://www.instamobile.io/react-native-tutorials/play-youtube-videos-react-native/" rel="noopener ugc nofollow" target="_blank">最初发布于instamobile.io </a></p></div></div>    
</body>
</html>