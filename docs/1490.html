<html>
<head>
<title>How to Serve Static Files using Express: A Step-by-step Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Express提供静态文件:分步指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/expressjs-serving-static-files-e0efdda3731c?source=collection_archive---------5-----------------------#2021-03-30">https://javascript.plainenglish.io/expressjs-serving-static-files-e0efdda3731c?source=collection_archive---------5-----------------------#2021-03-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e4e464c35b4d01ca8191ea1129635b1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AJ_LqiqegWyxlbe7.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Express</figcaption></figure><h2 id="69b0" class="kc kd iq bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">为什么使用Express提供静态文件？</h2><p id="690c" class="pw-post-body-paragraph ky kz iq la b lb lc ld le lf lg lh li kl lj lk ll kp lm ln lo kt lp lq lr ls ij bi translated">在web开发中，从服务器端提供静态文件非常重要。这些是创建您的web应用程序的文件。静态文件可以是图像、CSS、JavaScript、HTML、pdf和许多其他文件类型。</p><p id="bd3a" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">如果您刚刚开始使用Express进行开发，我建议您阅读我的另一篇文章:</p><div class="ly lz gp gr ma mb"><a rel="noopener  ugc nofollow" target="_blank" href="/express-js-getting-started-basic-routing-938d8b629fe2"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd ir gy z fp mg fr fs mh fu fw ip bi translated">快速入门和基本路线</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">什么是Express.js？Express.js &amp; installation入门，并学习如何使用实现基本路由…</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="mk l"><div class="ml l mm mn mo mk mp jw mb"/></div></div></a></div><h2 id="0ad3" class="kc kd iq bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">如何在Express.js中提供静态文件</h2><p id="8985" class="pw-post-body-paragraph ky kz iq la b lb lc ld le lf lg lh li kl lj lk ll kp lm ln lo kt lp lq lr ls ij bi translated">Express中有一个内置的中间件，使我们能够通过指定特定的路径和选项来提供静态文件。如下图所示:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="3576" class="kc kd iq mv b gy mz na l nb nc">express.static(root, [options])</span></pre><p id="59a3" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated"><strong class="la ir"> express.static </strong>中间件将<strong class="la ir">根目录</strong>作为服务静态资产的第一个参数。<strong class="la ir">选项</strong>是另一个参数。关于静态文件如何送达，可以在官方<a class="ae nd" href="http://expressjs.com/en/4x/api.html#express.static" rel="noopener ugc nofollow" target="_blank"> express.static </a>网站找到更多信息。</p><h2 id="5ddc" class="kc kd iq bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">express.static示例</h2><p id="ef5d" class="pw-post-body-paragraph ky kz iq la b lb lc ld le lf lg lh li kl lj lk ll kp lm ln lo kt lp lq lr ls ij bi translated">在名为<code class="fe ne nf ng mv b">public</code>的目录中提供静态文件。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="62a6" class="kc kd iq mv b gy mz na l nb nc">app.use(express.static('public'))</span></pre><p id="8e74" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">现在，我们可以访问<code class="fe ne nf ng mv b">public</code>文件夹中的静态文件，如下所示:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="d185" class="kc kd iq mv b gy mz na l nb nc">http://localhost:3000/images/woof.jpg<br/>http://localhost:3000/css/styles.css<br/>http://localhost:3000/js/app.js<br/>http://localhost:3000/images/background.png<br/>http://localhost:3000/hello.html</span></pre><p id="a76e" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">让我们在您的本地express应用程序上测试它。</p><p id="7456" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated"><code class="fe ne nf ng mv b">public/hello.html</code></p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="9b12" class="kc kd iq mv b gy mz na l nb nc">&lt;!DOCTYPE <em class="nh">html</em>&gt;<br/>&lt;html&gt;<br/>    &lt;body&gt;<br/>        &lt;h1&gt;Hello World&lt;/h1&gt;<br/>        &lt;p&gt;Express static files serving hello.html&lt;/p&gt;<br/>    &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="2317" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">现在，让我们将<strong class="la ir"> express.static </strong>中间件添加到我们的应用程序中，如下所示。</p><p id="7939" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated"><code class="fe ne nf ng mv b">index.js</code></p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="edd3" class="kc kd iq mv b gy mz na l nb nc">app.use(express.static('public'))</span></pre><p id="29af" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">打开<a class="ae nd" href="http://localhost:3000/hello.html" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/hello . html</a>，可以看到<code class="fe ne nf ng mv b">hello.html</code>文件。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/eaf5264e1c9bbb32571b8043dd957c73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*qeegXsJlkkO6_PaBMkusWg.png"/></div></figure><p id="3397" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">Express在我们添加到应用程序的静态目录中查找文件。所以这个目录的名字不包含在<strong class="la ir">的URL中。在教程的后面，我们将看到如何为静态文件夹定义路径。但是首先，我们应该寻找如何服务多个目录。</strong></p><h2 id="ca1c" class="kc kd iq bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">服务多个目录</h2><p id="9c24" class="pw-post-body-paragraph ky kz iq la b lb lc ld le lf lg lh li kl lj lk ll kp lm ln lo kt lp lq lr ls ij bi translated">要在应用程序中提供多个目录，可以向Express应用程序添加另一个目录。假设我们想要为<code class="fe ne nf ng mv b">files</code>目录中的资产提供服务。将下面的代码添加到您的应用程序中。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="6364" class="kc kd iq mv b gy mz na l nb nc">app.use(express.static('public'))</span><span id="08d4" class="kc kd iq mv b gy nj na l nb nc"><strong class="mv ir">app.use(express.static('files'))</strong></span></pre><p id="efa3" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">现在，我们添加新的静态中间件来服务文件目录中的资产。</p><p id="73c8" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated"><code class="fe ne nf ng mv b">files/test.html</code></p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="31eb" class="kc kd iq mv b gy mz na l nb nc">&lt;!DOCTYPE <em class="nh">html</em>&gt;<br/>&lt;html&gt;<br/>    &lt;body&gt;<br/>        &lt;h1&gt;Files directory&lt;/h1&gt;<br/>        &lt;p&gt;Express static files serving test.html&lt;/p&gt;<br/>    &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="3016" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">打开<a class="ae nd" href="http://localhost:3000/hello.html" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/test . html</a>可以看到<code class="fe ne nf ng mv b">test.html</code>文件</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/74d4e9c62d857b620ef793d5d72f0d20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Ao-LN_brVWTHXySqRtsew.png"/></div></div></figure><p id="4145" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">正如您现在看到的，我们的应用程序提供了<code class="fe ne nf ng mv b">test.html</code>文件。</p><p id="2195" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated"><strong class="la ir">注意:</strong>当您服务多个目录时，Express将按照您设置的静态目录的顺序提供服务。因此，如果您在两个不同的服务文件夹中有相同的文件名，Express将查找<code class="fe ne nf ng mv b">express.static</code>的使用顺序并提供第一个匹配的。这可能会对您的文件造成一些问题，因此在这种情况下，我们可以创建<strong class="la ir">虚拟目录</strong>来提供服务！</p><h2 id="5f36" class="kc kd iq bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">指定路由—虚拟目录</h2><p id="d48b" class="pw-post-body-paragraph ky kz iq la b lb lc ld le lf lg lh li kl lj lk ll kp lm ln lo kt lp lq lr ls ij bi translated">为了能够使用定义的路由提供静态文件，我们可以在Express应用程序中指定路径。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="46a2" class="kc kd iq mv b gy mz na l nb nc">app.use('/static', express.static('public'))</span></pre><p id="1b28" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">正如您所注意到的，我们没有创建任何名为<strong class="la ir"> static </strong>的文件夹，但是我们可以在Express中指定一个路由，并添加<code class="fe ne nf ng mv b">express.static</code>中间件来服务公共目录中的文件。您可以根据您的目的和使用案例来命名它。</p><p id="ddc2" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">我们添加到公共目录的文件现在可以通过以下方式访问:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="548d" class="kc kd iq mv b gy mz na l nb nc">http://localhost:3000/static/images/woof.jpg<br/>http://localhost:3000/static/css/styles.css<br/>http://localhost:3000/static/js/app.js<br/>http://localhost:3000/static/images/background.png<br/>http://localhost:3000/static/hello.html</span></pre><p id="0677" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">现在，让我们从静态路径打开<code class="fe ne nf ng mv b">hello.html</code>文件，如下所示。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/4c900c3877ccb3e03fb12adc6b9d3e07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j2I6DGRPO1_FUlU4-cBzBw.png"/></div></div></figure><p id="0a0d" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated"><strong class="la ir">注意:</strong>记住，express.static中间件是相对于启动Node.js应用程序的目录的。对于您想要服务的目录，使用绝对路径更安全。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="8fe5" class="kc kd iq mv b gy mz na l nb nc"><em class="nh">const </em>path = require("path");</span><span id="81c7" class="kc kd iq mv b gy nj na l nb nc">app.use('/static', express.static(path.join(__dirname, 'public')))</span></pre><p id="d940" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">现在你可以快递任何你想要的东西。</p><p id="2cf9" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">这里是另一个<code class="fe ne nf ng mv b">woof.jpg.</code>的例子</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/85757f38b91ad06b1e29f3a148f063ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b7E2Rqu1Lgus76sl9B_Pag.jpeg"/></div></div></figure></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><p id="cea2" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated"><strong class="la ir">带选项的示例</strong></p><p id="9d71" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">最后但同样重要的是，你可以看看官方Express文档中的<a class="ae nd" href="http://expressjs.com/en/resources/middleware/serve-static.html" rel="noopener ugc nofollow" target="_blank">选项。</a></p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="7cf6" class="kc kd iq mv b gy mz na l nb nc">var options = {<br/>  dotfiles: 'ignore',<br/>  etag: false,<br/>  extensions: ['htm', 'html'],<br/>  index: false,<br/>  maxAge: '1d',<br/>  redirect: false,<br/>  setHeaders: function (res, path, stat) {<br/>    res.set('x-timestamp', Date.now())<br/>  }<br/>}<br/><br/>app.use(express.static('public', options))</span></pre><p id="c3db" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">仅此而已！我将继续为Express添加新的教程，并在这里编辑以供参考。</p><p id="675d" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">如果您对本教程有任何问题，请在下面发表评论，或者随时分享您的成功故事。</p><p id="4a12" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">谢谢你读到这里！</p><p id="81c8" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated">以下是本教程的GitHub repo:</p><div class="ly lz gp gr ma mb"><a href="https://github.com/hadnazzar/express-lessons" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd ir gy z fp mg fr fs mh fu fw ip bi translated">hadnazzar/express-课程</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">在GitHub上创建一个帐户，为hadnazzar/express-lessons的开发做出贡献。</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">github.com</p></div></div><div class="mk l"><div class="nu l mm mn mo mk mp jw mb"/></div></div></a></div><p id="8f78" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated"><em class="nh">如果你觉得这篇文章很有帮助，你可以通过使用我的推荐链接注册一个</em> <a class="ae nd" href="https://melihyumak.medium.com/membership" rel="noopener"> <strong class="la ir"> <em class="nh">中级会员来访问类似的</em> </strong> </a> <em class="nh">。</em>  </p><p id="bedb" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated"><strong class="la ir"> <em class="nh">关注我的</em> </strong> <a class="ae nd" href="https://twitter.com/hadnazzar" rel="noopener ugc nofollow" target="_blank"> <strong class="la ir">推特</strong> </a></p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/e09adde9fd734db2f987c8df72839da8.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/0*NxeTL1qQlC1dv9-b.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Subscribe for more on <a class="ae nd" href="https://www.youtube.com/c/TechnologyandSoftware?sub_confirmation=1" rel="noopener ugc nofollow" target="_blank">Youtube</a></figcaption></figure><h1 id="8d23" class="nw kd iq bd ke nx ny nz kh oa ob oc kk od oe of ko og oh oi ks oj ok ol kw om bi translated">编码快乐！</h1><p id="ed74" class="pw-post-body-paragraph ky kz iq la b lb lc ld le lf lg lh li kl lj lk ll kp lm ln lo kt lp lq lr ls ij bi translated">梅利赫</p><p id="b09f" class="pw-post-body-paragraph ky kz iq la b lb lt ld le lf lu lh li kl lv lk ll kp lw ln lo kt lx lq lr ls ij bi translated"><em class="nh">更多内容请看</em><a class="ae nd" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="nh">plain English . io</em></a></p></div></div>    
</body>
</html>