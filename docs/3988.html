<html>
<head>
<title>Automatically Generate and Release a Changelog using Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js自动生成并发布变更日志</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/automatically-generate-and-release-a-changelog-using-node-js-489d73e3c1a3?source=collection_archive---------4-----------------------#2021-08-10">https://javascript.plainenglish.io/automatically-generate-and-release-a-changelog-using-node-js-489d73e3c1a3?source=collection_archive---------4-----------------------#2021-08-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/5be42d9c584de154a967dc6037b852a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mmepoTEp7NV9teUm445XzA.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk"><em class="jz">Image from Unsplash by </em><a class="ae ka" href="https://unsplash.com/@juanjodev02" rel="noopener ugc nofollow" target="_blank"><em class="jz">https://unsplash.com/@juanjodev02</em></a></figcaption></figure><p id="93ad" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">变更日志是一段时间内您对项目所做的任何更改的详细记录。changelog不仅可以作为修复bug和错误的起点，而且在向您的项目介绍新的开发人员时，它还是一个有价值的教育资源。</p><p id="0090" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">在本教程中，我们将探索一种使用git挂钩和Node.js自动生成和发布changelog的方法。我们将使用一种称为<a class="ae ka" href="http://conventionalcommits.org/" rel="noopener ugc nofollow" target="_blank">常规提交</a>的特定提交格式和一种称为<a class="ae ka" href="https://github.com/commitizen/cz-cli" rel="noopener ugc nofollow" target="_blank">提交</a>的工具来创建一条常规提交消息。然后，我们将使用一个名为<code class="fe kz la lb lc b"><a class="ae ka" href="https://www.npmjs.com/package/standard-version" rel="noopener ugc nofollow" target="_blank">standard-version</a></code>的库来自动生成一个changelog和一个遵循<a class="ae ka" href="https://blog.logrocket.com/never-guess-about-project-history-again-31f65091f668/" rel="noopener ugc nofollow" target="_blank">语义版本</a>的新发布版本。</p><p id="56d8" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">最后，我们将使我们的changelog在整个开发团队中共享，这样每个人在项目中都遵循相同的约定。如果你愿意跟随，你可以在这个<a class="ae ka" href="https://github.com/imsingh/changelog" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中找到最终的代码。</p><p id="d457" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">我们开始吧！</p><h1 id="c12a" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">在传统提交中构造提交消息</h1><p id="5aac" class="pw-post-body-paragraph kb kc in kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky ig bi translated">传统的提交规范通过提供创建特定提交历史的规则来改进提交消息。传统提交通过创建一个使用语义版本控制的版本，使得生成变更日志变得容易。</p><p id="8d4e" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">根据约定，提交消息的结构应该如下:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="b403" class="mo le in lc b gy mp mq l mr ms">&lt;type&gt;[optional scope]: &lt;description&gt;</span><span id="e467" class="mo le in lc b gy mt mq l mr ms">[optional body]</span><span id="5b67" class="mo le in lc b gy mt mq l mr ms">[optional footer(s)]</span></pre><p id="9690" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">让我们检查一下结构的细节:</p><p id="6f4c" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><code class="fe kz la lb lc b">&lt;type&gt;</code>是一种影响发布版本号的提交类型。在语义版本控制中，<code class="fe kz la lb lc b">fix</code>类型影响补丁，<code class="fe kz la lb lc b">feat</code>类型影响次要版本。还有其他类型，但是，这些不影响版本的版本号。</p><p id="d8a2" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><code class="fe kz la lb lc b">scope</code>是一个可选名词，描述由提交改变或更新的代码库部分。比如在<code class="fe kz la lb lc b">feat(pages)</code>中，pages就是范围。</p><p id="c12b" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">在语义版本中，<code class="fe kz la lb lc b">!</code>与专业相关。当在作用域后使用时，<code class="fe kz la lb lc b">!</code>表示提交中有重大更改。</p><p id="f184" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><code class="fe kz la lb lc b">&lt;description&gt;</code>是对代码变更的简要书面说明。例如，如果我们为<code class="fe kz la lb lc b">feat(pages)</code>写一个描述，它可能看起来像这样:<code class="fe kz la lb lc b">feat(pages): add contact page in the side menu</code>。</p><p id="3455" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><code class="fe kz la lb lc b">body</code>是一个可选字段，您可以使用它来更详细地描述提交。<code class="fe kz la lb lc b">body</code>必须在描述后开始一行。<code class="fe kz la lb lc b">footer</code>也是可选字段。例如，一个页脚是<code class="fe kz la lb lc b">BREAKING CHANGE</code>，它将与语义版本化专业相关联。</p><h1 id="b9b4" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">提交消息示例</h1><p id="cdde" class="pw-post-body-paragraph kb kc in kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky ig bi translated">让我们看一些不同提交消息的例子:</p><h2 id="bf72" class="mo le in bd lf mu mv dn lj mw mx dp ln km my mz lr kq na nb lv ku nc nd lz ne bi translated">仅使用<code class="fe kz la lb lc b">type</code>和<code class="fe kz la lb lc b">description</code>提交消息:</h2><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="a394" class="mo le in lc b gy mp mq l mr ms">feat: add the charging option for cars</span></pre><h2 id="ced7" class="mo le in bd lf mu mv dn lj mw mx dp ln km my mz lr kq na nb lv ku nc nd lz ne bi translated">使用<code class="fe kz la lb lc b">type</code>、<code class="fe kz la lb lc b">scope</code>和<code class="fe kz la lb lc b">description</code>提交消息:</h2><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="80bc" class="mo le in lc b gy mp mq l mr ms">fix(homepage): change title width of title</span></pre><h2 id="aebf" class="mo le in bd lf mu mv dn lj mw mx dp ln km my mz lr kq na nb lv ku nc nd lz ne bi translated">使用<code class="fe kz la lb lc b">BREAKING CHANGE</code>提交消息:</h2><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="d98e" class="mo le in lc b gy mp mq l mr ms">refactor(api): remove the get api from reservations</span><span id="6b88" class="mo le in lc b gy mt mq l mr ms">BREAKING CHANGE: refactor to use the trip api instead of reservations api</span></pre><h1 id="7e75" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">创建我们的项目</h1><p id="7d70" class="pw-post-body-paragraph kb kc in kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky ig bi translated">让我们通过添加必要的工具来自动化我们的变更日志和发布来开始我们的项目。首先，创建一个<code class="fe kz la lb lc b">command</code>提示，我们将在其中添加以下代码块。</p><p id="30f4" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">让我们创建一个基于npm的项目，并使它成为一个git存储库。如果您想自动化现有的存储库，可以跳过这一步:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="d302" class="mo le in lc b gy mp mq l mr ms"># create project directory<br/>mkdir changelog</span><span id="38ef" class="mo le in lc b gy mt mq l mr ms"># cd into project<br/>cd changelog</span><span id="a23a" class="mo le in lc b gy mt mq l mr ms"># initialize npm project<br/>npm init -y</span><span id="10fe" class="mo le in lc b gy mt mq l mr ms"># initialize git<br/>git init</span></pre><p id="484e" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">上面的代码块将用1.0.0版创建一个git存储库和一个npm包。</p><h1 id="8839" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">将<code class="fe kz la lb lc b">standard-version</code>添加到我们的项目</h1><p id="8bda" class="pw-post-body-paragraph kb kc in kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky ig bi translated">现在，让我们开始为我们的项目创建发布！您需要将<code class="fe kz la lb lc b">standard-version</code> npm包安装到您的项目中，如下所示:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="8f55" class="mo le in lc b gy mp mq l mr ms">npm install --save-dev standard-version</span></pre><p id="e0e8" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">您还需要将其添加到npm脚本中:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="f307" class="mo le in lc b gy mp mq l mr ms">...<br/>"scripts": {<br/>  "release": "standard-version"<br/>}<br/>...</span></pre><h1 id="d4db" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">创建版本</h1><p id="2a5e" class="pw-post-body-paragraph kb kc in kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky ig bi translated">创建一个名为<code class="fe kz la lb lc b">new-feature</code>的虚拟文件，并按如下方式提交:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="9518" class="mo le in lc b gy mp mq l mr ms">touch new-feature<br/>git add new-feature<br/>git commit</span></pre><p id="639f" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">添加以下git提交消息:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="73a7" class="mo le in lc b gy mp mq l mr ms">feat(new-feature): add a new-feature to our project</span></pre><p id="1b5d" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">最后，让我们通过运行新添加的脚本在项目中创建一个发布:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="a17a" class="mo le in lc b gy mp mq l mr ms">npm run release</span></pre><p id="3efe" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">运行上面的命令将在屏幕上显示以下消息:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="0a2d" class="mo le in lc b gy mp mq l mr ms">&gt; changelog@1.0.0 release /home/imsingh/Develop/inder/changelog<br/>&gt; standard-version</span><span id="c21b" class="mo le in lc b gy mt mq l mr ms">bumping version in package.json from 1.0.0 to 1.1.0</span><span id="566f" class="mo le in lc b gy mt mq l mr ms">bumping version in package-lock.json from 1.0.0 to 1.1.0</span><span id="b9ea" class="mo le in lc b gy mt mq l mr ms">created CHANGELOG.md</span><span id="3785" class="mo le in lc b gy mt mq l mr ms">outputting changes to CHANGELOG.md</span><span id="4d21" class="mo le in lc b gy mt mq l mr ms">committing package-lock.json and package.json and CHANGELOG.md</span><span id="e858" class="mo le in lc b gy mt mq l mr ms">tagging release v1.1.0</span><span id="322d" class="mo le in lc b gy mt mq l mr ms">Run `git push --follow-tags origin master &amp;&amp; npm publish` to publish</span></pre><p id="9a17" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">上面的消息执行以下操作:</p><ul class=""><li id="c8aa" class="nf ng in kd b ke kf ki kj km nh kq ni ku nj ky nk nl nm nn bi translated">将SemVer版本号从<code class="fe kz la lb lc b">1.0.0</code>增加到<code class="fe kz la lb lc b">1.1.0</code>我们增加了一个特性，因此，MINOR从<code class="fe kz la lb lc b">0</code>更新到<code class="fe kz la lb lc b">1</code></li><li id="b8f4" class="nf ng in kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated">创建一个<code class="fe kz la lb lc b">CHANGELOG.md</code>文件，向其中添加所需的内容</li><li id="71fc" class="nf ng in kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated">提交上面的更改，创建一个<code class="fe kz la lb lc b">v1.1.0</code>标签</li><li id="b420" class="nf ng in kd b ke no ki np km nq kq nr ku ns ky nk nl nm nn bi translated">如果需要，打印出一条消息来推送标签并将我们的包发布到npm</li></ul><h1 id="dc7c" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated"><code class="fe kz la lb lc b">CHANGELOG.md</code></h1><p id="3c74" class="pw-post-body-paragraph kb kc in kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky ig bi translated">现在，如果你打开<code class="fe kz la lb lc b">CHANGELOG.md</code>，你会看到下面的代码块，它包含了上面所做的修改:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="e63a" class="mo le in lc b gy mp mq l mr ms"># Changelog</span><span id="e883" class="mo le in lc b gy mt mq l mr ms">All notable changes to this project will be documented in this file. See \[standard-version\](https://github.com/conventional-changelog/standard-version) for commit guidelines.</span><span id="1c7a" class="mo le in lc b gy mt mq l mr ms">## 1.1.0 (2021-07-12)<br/></span><span id="20cd" class="mo le in lc b gy mt mq l mr ms">### Features</span><span id="1ee9" class="mo le in lc b gy mt mq l mr ms">* <strong class="lc io">**new-feature:**</strong> add a new-feature to our project 11c0322</span></pre><p id="0318" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">您还将看到创建的提交消息<code class="fe kz la lb lc b">standard-release</code>，它使用<code class="fe kz la lb lc b">git log -1</code>命令进行释放:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="6cdd" class="mo le in lc b gy mp mq l mr ms">commit  #COMMIT_HASH (HEAD -&gt; master, tag: v1.1.0)<br/>Author: #AUTHOR_NAME &lt;#AUTHOR_EMAIL&gt;<br/>Date:   #COMMIT_DATE</span><span id="99b9" class="mo le in lc b gy mt mq l mr ms">    chore(release): 1.1.0</span></pre><p id="d487" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">提交消息的类型为<code class="fe kz la lb lc b">chore</code>，范围为<code class="fe kz la lb lc b">release</code>，<code class="fe kz la lb lc b">description</code>为<code class="fe kz la lb lc b">1.1.0</code>。</p><p id="02c9" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">现在，您已经拥有了自动化您的changelog和发布所需的一切！然而，手动编写提交是乏味且容易出错的。让我们引入一些工具来平滑这个过程！</p><h1 id="8954" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">添加提交</h1><p id="1a0d" class="pw-post-body-paragraph kb kc in kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky ig bi translated">您可以使用Commitizen来自动生成提交，而不是自己编写传统的提交。Commitizen在<code class="fe kz la lb lc b">command</code>提示符下向您提问，并根据您的回答生成提交。</p><p id="ef16" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">安装Commitizen软件包，如下所示:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="9945" class="mo le in lc b gy mp mq l mr ms">npm install --save-dev commitizen</span></pre><p id="5eff" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">现在，初始化Commitizen以使用传统的changelog适配器:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="6d41" class="mo le in lc b gy mp mq l mr ms">npx commitizen init cz-conventional-changelog --save-dev --save-exact</span></pre><p id="ad9e" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">适配器是一种配置，它告诉Commitizen在提示符下显示不同类型的提交。目前，有各种各样的适配器<a class="ae ka" href="https://github.com/commitizen/cz-cli#adapters" rel="noopener ugc nofollow" target="_blank">可用，但是如果你愿意，你可以创建你自己的适配器。</a></p><p id="6e39" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">现在，要使用Commitizen，我们将添加一个npm脚本:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="ef85" class="mo le in lc b gy mp mq l mr ms">...<br/>"scripts": {<br/>    "commit": "cz"<br/>}<br/>...</span></pre><p id="425c" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">此时，您应该创建一个<code class="fe kz la lb lc b">.gitignore</code>文件并忽略<code class="fe kz la lb lc b">node_modules</code>目录。</p><p id="8338" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">使用<code class="fe kz la lb lc b">git add</code>将<code class="fe kz la lb lc b">package.json</code>和<code class="fe kz la lb lc b">package-lock.json</code>添加到git暂存区。我们将通过运行下面的代码块进行提交:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="b7c9" class="mo le in lc b gy mp mq l mr ms">npm run commit</span></pre><p id="c6e8" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">上面的代码块还会提示您回答下面的指令。</p><p id="e1f3" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><code class="fe kz la lb lc b">type</code>显示<code class="fe kz la lb lc b">types</code>列表，您可以从中选择。下面的列表来自我们之前安装的适配器:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="dced" class="mo le in lc b gy mp mq l mr ms">? Select the type of change that you're committing: <br/>  feat:     A new feature <br/>  fix:      A bug fix <br/>  docs:     Documentation only changes <br/>❯ style:    Changes that do not affect the meaning of the code (white-space, formatting, missing semi-col<br/>ons, etc) <br/>  refactor: A code change that neither fixes a bug nor adds a feature <br/>  perf:     A code change that improves performance <br/>(Move up and down to reveal more choices)</span></pre><p id="11ab" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">下面代码块中的<code class="fe kz la lb lc b">scope</code>表示常规提交的范围:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="d4b4" class="mo le in lc b gy mp mq l mr ms">? What is the scope of this change (e.g. component or file name): (press enter to skip)</span></pre><p id="dce9" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">对于<code class="fe kz la lb lc b">short description</code>，写出常规提交的简要说明:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="2368" class="mo le in lc b gy mp mq l mr ms">? Write a short, imperative tense description of the change (max 82 chars):</span></pre><p id="3b63" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">在<code class="fe kz la lb lc b">longer description</code>中，描述常规提交的<code class="fe kz la lb lc b">body</code>:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="6ae9" class="mo le in lc b gy mp mq l mr ms">? Provide a longer description of the change: (press enter to skip)</span></pre><p id="3620" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">下面代码块中的两个问题会生成一个包含重大更改的提交:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="0198" class="mo le in lc b gy mp mq l mr ms">? Are there any breaking changes?<br/>? Describe the breaking changes:</span></pre><p id="8fbe" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">在<code class="fe kz la lb lc b">issues related to commit</code>部分，您可以参考来自JIRA GitHub或其他类似工具的问题:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="ac9f" class="mo le in lc b gy mp mq l mr ms">? Does this change affect any open issues?<br/>? Add issue references (e.g. "fix #123", "re #123".):</span></pre><p id="6972" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">一旦您根据需要回答了这些提示，您将得到如下所示的提交:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="086d" class="mo le in lc b gy mp mq l mr ms">Author: #AUTHOR_NAME &lt;#AUTHOR_EMAIL&gt;<br/>Date:   Mon Jul 12 21:10:17 2021 +0200</span><span id="d752" class="mo le in lc b gy mt mq l mr ms">    feat(some-scope): a short description</span><span id="1c99" class="mo le in lc b gy mt mq l mr ms">    a long description</span><span id="4a4a" class="mo le in lc b gy mt mq l mr ms">    BREAKING CHANGE: it breaks</span><span id="df9e" class="mo le in lc b gy mt mq l mr ms">    123</span></pre><h1 id="e3da" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">添加commitlint以实施规则</h1><p id="6dd8" class="pw-post-body-paragraph kb kc in kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky ig bi translated">为了确保我们项目中的所有开发人员都遵循相同的约定，我们将使用带有<a class="ae ka" href="https://typicode.github.io/husky/#/" rel="noopener ugc nofollow" target="_blank"> Husky </a>和commitlint的git挂钩。</p><h1 id="4b74" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">安装所需工具</h1><p id="bbdd" class="pw-post-body-paragraph kb kc in kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky ig bi translated">首先，让我们通过运行下面的代码块来安装commitlint和Husky:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="f925" class="mo le in lc b gy mp mq l mr ms"># Install commitlint cli and conventional config<br/>npm install --save-dev @commitlint/config-conventional @commitlint/cli</span><span id="7156" class="mo le in lc b gy mt mq l mr ms"># Install Husky<br/>npm install husky --save-dev</span></pre><h1 id="d003" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">配置提交列表</h1><p id="1c07" class="pw-post-body-paragraph kb kc in kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky ig bi translated">要配置commitlint，我们需要创建一个名为<code class="fe kz la lb lc b">commitlint.config.js</code>的配置文件，并添加以下代码:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="3399" class="mo le in lc b gy mp mq l mr ms">module.exports = {extends: ['@commitlint/config-conventional']}</span></pre><p id="f532" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">为了在提交之前lint消息，我们需要通过运行以下命令使用Husky的<code class="fe kz la lb lc b">commit-msg</code>钩子:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="d89e" class="mo le in lc b gy mp mq l mr ms"># Activate hooks<br/>npx husky install</span><span id="cdd9" class="mo le in lc b gy mt mq l mr ms"># Add hook<br/>npx husky add .husky/commit-msg 'npx --no-install commitlint --edit "$1"'</span></pre><p id="e9ec" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">您可以添加<code class="fe kz la lb lc b">husky install</code>作为npm准备脚本，但是，这一步是可选的。<code class="fe kz la lb lc b">husky install</code>将确保使用本回购协议的每个开发商在使用本项目之前安装哈斯基挂钩:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="151c" class="mo le in lc b gy mp mq l mr ms">... <br/>"scripts": {<br/>...<br/>  "prepare": "husky install"<br/>}</span></pre><p id="37a3" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">我们仍将使用git commit来使我们的提交遵循前面描述的约定。如果git消息中有错误，commitlint将引发以下错误:</p><pre class="mg mh mi mj gt mk lc ml mm aw mn bi"><span id="8e23" class="mo le in lc b gy mp mq l mr ms">git commit -m "This is a commit"  <br/>⧗   input: This is a commit</span><span id="0add" class="mo le in lc b gy mt mq l mr ms">subject may not be empty [subject-empty]</span><span id="fffc" class="mo le in lc b gy mt mq l mr ms">type may not be empty [type-empty]</span><span id="1207" class="mo le in lc b gy mt mq l mr ms">found 2 problems, 0 warnings  <br/>ⓘ   Get help: \[https://github.com/conventional-changelog/commitlint/#what-is-commitlint\](https://github.com/conventional-changelog/commitlint/#what-is-commitlint)  </span><span id="bef9" class="mo le in lc b gy mt mq l mr ms">husky - commit-msg hook exited with code 1 (error)</span></pre><h1 id="7abd" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">管理发布的最终工作流程</h1><p id="b648" class="pw-post-body-paragraph kb kc in kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky ig bi translated">要管理您的发布，您可以遵循下面列出的工作流程:</p><ol class=""><li id="e0b2" class="nf ng in kd b ke kf ki kj km nh kq ni ku nj ky nt nl nm nn bi translated">创建您的要素并提交它们。如果提交消息不符合约定，commitlint将引发错误</li><li id="06c1" class="nf ng in kd b ke no ki np km nq kq nr ku ns ky nt nl nm nn bi translated">在命令行中执行<code class="fe kz la lb lc b">npm run commit</code>,使用Commitizen进行提交</li><li id="faa2" class="nf ng in kd b ke no ki np km nq kq nr ku ns ky nt nl nm nn bi translated">运行<code class="fe kz la lb lc b">npm run release</code>来创建一个变更日志和一个基于语义版本的发布</li></ol><p id="bee7" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">要使用CI/CD创建发布，请查看<a class="ae ka" href="https://github.com/semantic-release/semantic-release" rel="noopener ugc nofollow" target="_blank">语义发布</a>。</p><h1 id="4f6c" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">摘要</h1><p id="432e" class="pw-post-body-paragraph kb kc in kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky ig bi translated">在这篇文章中，您学习了如何使用git hooks和Node.js创建一个自动的changelog和一个基于语义版本的发布。接下来，我们使用commitlint和Husky来自动编写我们的提交。</p><p id="ad92" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><strong class="kd io"> <em class="nu">本帖原载</em></strong><a class="ae ka" href="https://blog.logrocket.com/automatically-generate-and-release-a-changelog-with-node-js/" rel="noopener ugc nofollow" target="_blank"><em class="nu">https://blog . log rocket . com/automatically-generate-and-release-a-changelog-with-node-js/</em></a></p><p id="5a95" class="pw-post-body-paragraph kb kc in kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><em class="nu">更多内容看</em> <a class="ae ka" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kd io"> <em class="nu">说白了</em></strong></a></p></div></div>    
</body>
</html>