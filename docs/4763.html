<html>
<head>
<title>Why I Wrote a New Tool for Load Testing HTTP APIs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我要编写一个新的工具来测试HTTP APIs负载</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/why-i-wrote-a-new-tool-for-load-testing-http-apis-d59c1f0d98f9?source=collection_archive---------21-----------------------#2021-09-22">https://javascript.plainenglish.io/why-i-wrote-a-new-tool-for-load-testing-http-apis-d59c1f0d98f9?source=collection_archive---------21-----------------------#2021-09-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="4d6b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ApiZapi，一个新的HTTP API负载测试SaaS应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3f8da571783b88c2f89bd7d78992122a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ag4rXAhZp45inxEQeNgMAg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Screenshot from apizapi.com</figcaption></figure><h1 id="b7f9" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">概观</h1><p id="942c" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">在本文中，我将解释我创建一个新的负载测试工具的动机，以及<a class="ae mb" href="https://www.apizapi.com" rel="noopener ugc nofollow" target="_blank"> ApiZapi </a>如何提供一些不同的东西。我将深入研究我认为必要的关键需求，以满足我的负载测试需求，并希望满足其他人的需求。其他文章涵盖了ApiZapi工具的用法(参见这篇<a class="ae mb" rel="noopener ugc nofollow" target="_blank" href="/load-testing-http-apis-with-apizapi-3e2ac01ea5c8">中型文章</a>)以及进行HTTP API负载测试时的注意事项。</p><p id="0795" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mc">请注意:这并不是试图指出其他工具的不足或进行任何类型的比较，而是描述我在寻找什么，以及我是如何坐下来从头开始构建满足我需求的东西的。当然，有许多优秀的负载测试工具将继续满足需求。</em></p><h1 id="5369" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">动机</h1><p id="8d13" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">在我作为软件开发人员的职业生涯中，我需要多次进行负载测试。我采取了各种手段来实现这一目标。这里有一些这样的经历。</p><ul class=""><li id="b82b" class="md me in jm b jn jo jr js jv mf jz mg kd mh kh mi mj mk ml bi translated">我为需要测试的特定API编写了低级代码。我是一个熟练的开发人员，知道我在做什么，所以它工作得很好。在这种情况下，测试在很低的水平上证明系统是非常有效的。</li><li id="8009" class="md me in jm b jn mm jr mn jv mo jz mp kd mq kh mi mj mk ml bi translated">我编写了一个测试工具，插入到Visual Studio中，并基于NUnit概念来添加负载测试功能。这受到了我在Microsoft Visual Studio的. Net应用程序中所能做的事情的限制。</li><li id="a6e7" class="md me in jm b jn mm jr mn jv mo jz mp kd mq kh mi mj mk ml bi translated">我使用<a class="ae mb" href="https://httpd.apache.org/docs/2.4/programs/ab.html" rel="noopener ugc nofollow" target="_blank"> Apache Bench </a>对移动应用程序将使用的HTTP APIs进行负载测试。该API会出现极高的负载，每天高达数千万次调用。</li><li id="6d47" class="md me in jm b jn mm jr mn jv mo jz mp kd mq kh mi mj mk ml bi translated">我创建了一个托管在AWS中的全栈MERN应用程序，并尝试了各种负载测试工具。一些人录下了浏览器网站的互动，并进行回放。其他工具执行较低级别的HTTP协议调用。一些有直观简单的用户界面，而另一些有使用SDK的完整编码能力。有些需要自托管，很难设置和维护。</li></ul><p id="6306" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">除了我自己的经历之外，我还从许多公司那里听说了他们在实现负载测试方面的努力。在过去的几年里，我为私募股权公司做了大量的技术尽职调查工作，涉及他们的并购活动。收购公司或私募股权公司经常想知道目标公司是否有可扩展的架构和托管解决方案。投资资金将使目标公司的客户群增长三到五倍。PE公司自然想知道平台是否能跟上额外的客户负载。</p><p id="34d8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于我的技术勤奋工作，我总是不得不依靠我作为软件架构师的技能来评估可伸缩性和性能方面。这是因为我调查的公司几乎总是声称他们从未运行过负载测试。他们知道有必要运行负载测试，但是从来没有发现任何工具可以让他们快速到位来满足他们的需求。有趣的是，在过去的20年中，单元测试的采用有了很大的增长，然而，负载测试的采用仍然很低。</p><h1 id="0d8c" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">关键要求</h1><p id="62fc" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">我列出了下面的列表来描述我希望在我创建的负载测试工具中看到的内容。</p><ul class=""><li id="31fc" class="md me in jm b jn jo jr js jv mf jz mg kd mh kh mi mj mk ml bi translated">证明API的基本使用场景功能，并通过其自动伸缩性、健壮性和可用性加快发现崩溃、挂起或其他基础架构问题。实现所有必要的功能来验证HTTP端点，以确定性能和伸缩限制。</li><li id="b993" class="md me in jm b jn mm jr mn jv mo jz mp kd mq kh mi mj mk ml bi translated">使我的工具成为SaaS产品，能够在几分钟内注册并运行。让取消和离开变得容易。</li><li id="475a" class="md me in jm b jn mm jr mn jv mo jz mp kd mq kh mi mj mk ml bi translated">让所有负载测试都在AWS Lambda函数中运行，这样在不使用时就不会浪费计算时间。</li><li id="b2a3" class="md me in jm b jn mm jr mn jv mo jz mp kd mq kh mi mj mk ml bi translated">按使用量收费，没有任何月订阅费。传递运行无服务器的成本节约。</li><li id="a03a" class="md me in jm b jn mm jr mn jv mo jz mp kd mq kh mi mj mk ml bi translated">具有独特的用户界面驱动的编辑，具有丰富的基于场景的测试功能。</li><li id="7a3f" class="md me in jm b jn mm jr mn jv mo jz mp kd mq kh mi mj mk ml bi translated">不要求一个人拥有使用工具的编码技能，但是要让测试人员或产品所有者能够使用它。没有脚本，文件配置或编码的必要。</li><li id="4ac3" class="md me in jm b jn mm jr mn jv mo jz mp kd mq kh mi mj mk ml bi translated">确保该工具不会被试图进行DDoS攻击的黑客恶意使用。</li><li id="6a4a" class="md me in jm b jn mm jr mn jv mo jz mp kd mq kh mi mj mk ml bi translated">作为一个扩展目标，提出UI的一个独立部分，它将自动化OAuth2授权代码授权类型UI交互。</li></ul><p id="7788" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我的希望是让负载测试成为一种更常见的SDLC实践，并消除启动和运行的任何障碍。支持将测试工具集成到CI/CD管道中，以便持续使用。</p><h1 id="a893" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">阿皮扎皮的现代建筑</h1><p id="a002" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">ApiZapi的架构全部托管在AWS中，并利用JavaScript Fullstack架构——React、Node.js/Express, MongoDB作为分层架构的核心部分，Lambdas作为实际负载测试运行的执行引擎。作为集成的一部分，它使用Stripe进行支付集成，使用Zoho进行电子邮件发送。从AWS来看，可以使用Elastic Beanstalk、Lambda、Route 53、Event Bridge、SES、SQS、DynamoDB、ALB、EC2s作为前向代理、S3、CodeBuild和VPC安全，在AZs中具有高可用性。我的DevOps APM使用AWS CloudWatch、NewRelic和Opsgenie。我们也花了很多心思让它变得安全，但这是另一个话题了。</p><h1 id="76f6" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">结论</h1><p id="0e29" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">应用程序现在已经完全启动并在AWS中运行。您可能会觉得有趣的一件事是，我实际上使用ApiZapi来测试ApiZapi！为什么不呢？作为一个平台，ApiZapi有一个api并且需要扩展，所以看看我的扩展会有什么问题是非常有启发性的。</p><p id="cee2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">查看ApiZapi网站，如果你有兴趣给我关于未来特性的建议，请发邮件给support@apizapi.com。请阅读我的其他<a class="ae mb" rel="noopener ugc nofollow" target="_blank" href="/load-testing-http-apis-with-apizapi-3e2ac01ea5c8">文章</a>以获得关于ApiZapi到底是什么的简要概述，或者如果你有更多的时间并且想要更深入地了解该工具，请访问<a class="ae mb" href="https://www.apizapi.com/#/userdoc" rel="noopener ugc nofollow" target="_blank">用户文档</a>。</p><p id="5664" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我有很多想法可以更进一步，在我已经建立的基础上进行改进。例如，我曾几次尝试提出一个很好的解决方案来认证使用OAuth2机制的后端API，并在代码中排除了这一点，因为它还不太正确。我想我终于找到了正确的方法，并会把它融入进去。</p><p id="2b64" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mc">更多内容请看</em><a class="ae mb" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mc">plain English . io</em></strong></a></p></div></div>    
</body>
</html>