<html>
<head>
<title>Promises in JavaScript — JavaScript Interview Series</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的承诺——JavaScript访谈系列</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/promises-in-javascript-javascript-interview-series-fd65be7cb0b2?source=collection_archive---------8-----------------------#2021-07-22">https://javascript.plainenglish.io/promises-in-javascript-javascript-interview-series-fd65be7cb0b2?source=collection_archive---------8-----------------------#2021-07-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="d2c5" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">一个简单而全面的JavaScript承诺教程，包括基础知识、重要方法和承诺链。</h2></div><p id="b343" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">承诺是JavaScript中最重要的主题之一，是作为ES6的一部分引入的。这是大多数JavaScript访谈中经常被问到的问题，也是大多数基于web的JavaScript库背后的主要机制之一。在这篇文章中，我们将详细了解承诺及其功能。所以让我们开始吧。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/200bd228b38ace9b08f8e1343b7cf55f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*VYXkOTfjDi8zf86E.gif"/></div></figure><p id="c2a9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">还记得你最后一次去麦当劳点你最喜欢的汉堡吗🍔 🍔？嗯，这一定是发生了什么。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lg"><img src="../Images/c3850122313cc8b978ac2a656edae1dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DDjNodpSuqwOhCOT"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Source : unsplash.com</figcaption></figure><ol class=""><li id="88a8" class="lp lq in ke b kf kg ki kj kl lr kp ls kt lt kx lu lv lw lx bi translated">你下了订单。</li><li id="1b65" class="lp lq in ke b kf ly ki lz kl ma kp mb kt mc kx lu lv lw lx bi translated">支付了与您的订单相应的金额。💵</li><li id="3f0b" class="lp lq in ke b kf ly ki lz kl ma kp mb kt mc kx lu lv lw lx bi translated">服务员给你开了一张订单收据(上面有订单号)。📄</li><li id="f1d4" class="lp lq in ke b kf ly ki lz kl ma kp mb kt mc kx lu lv lw lx bi translated">你等着你的饭准备好。🥱🥱</li><li id="d8bd" class="lp lq in ke b kf ly ki lz kl ma kp mb kt mc kx lu lv lw lx bi translated">最后，当您的订单到达时，您将收据换成订单。🍔 🍟 🥤</li></ol><p id="a990" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">嗯，这与承诺的工作方式非常相似，事实上也是理解承诺的最佳类比之一(归功于凯尔·辛普森)。</p><h1 id="b176" class="md me in bd mf mg mh mi mj mk ml mm mn jt mo ju mp jw mq jx mr jz ms ka mt mu bi translated"><strong class="ak">JavaScript中的承诺是什么？</strong></h1><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lg"><img src="../Images/3328f8eaf348c84458baa15f96dc6d5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zZMC7vDkTfhTeF_0"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Source : unsplash.com</figcaption></figure><p id="125d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">根据MDN docs " <em class="mv">，</em>，<strong class="ke io">，<em class="mv">承诺</em>，</strong>，<em class="mv">是在创建承诺时不一定知道的值的代理。它允许您将处理程序与异步操作的最终成功值或失败原因相关联。这使得异步方法像同步方法一样返回值:异步方法不是立即返回最终值，而是返回一个在未来某个时间提供该值的承诺。</em>”</p><p id="9b8a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">根据前面提到的类比，在你最喜欢的麦当劳点餐是一个异步的行为，也就是说，你不会在支付所需金额后立即收到食物💵。然而，你得到的是一张收据📄或者承诺在未来的某个时间供应这顿饭🍔 🍟 🥤。</p><p id="a880" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请记住，<strong class="ke io"> <em class="mv"> Promise是一个对象</em> t </strong>并且有与之相关联的方法，例如<em class="mv"> then() </em>和<em class="mv"> catch() </em>。<em class="mv"> then </em>方法用于解决承诺时，即异步方法的已解决或已完成结果准备就绪时(即您的订单已准备好放在柜台上)，而<em class="mv"> catch </em>方法用于拒绝承诺时(想象一下麦当劳的可乐用完了😱😱 ).还有其他一些重要的方法，将在本文后面探讨。目前，这应该足够了。</p><p id="54dc" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">承诺处于以下状态之一:</p><ul class=""><li id="4166" class="lp lq in ke b kf kg ki kj kl lr kp ls kt lt kx mw lv lw lx bi translated"><strong class="ke io"> <em class="mv">待定</em> </strong>:初始状态，既不履行也不拒绝。</li><li id="91f7" class="lp lq in ke b kf ly ki lz kl ma kp mb kt mc kx mw lv lw lx bi translated"><strong class="ke io"> <em class="mv">完成</em> </strong>:表示操作成功完成。</li><li id="f151" class="lp lq in ke b kf ly ki lz kl ma kp mb kt mc kx mw lv lw lx bi translated"><strong class="ke io"> <em class="mv">拒绝</em> </strong>:表示操作失败。</li></ul><p id="c66d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们对承诺有了一些了解，让我们通过一个代码例子来理解承诺。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mx"><img src="../Images/eba04a12d815e9f611fa2b2167669317.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uFk0ccbFg-CuRbCd-2Ms_g.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Example code 1.</figcaption></figure><p id="a744" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们理解示例代码1。</p><ol class=""><li id="906e" class="lp lq in ke b kf kg ki kj kl lr kp ls kt lt kx lu lv lw lx bi translated">在第13行。执行的<em class="mv"> divide </em>函数是异步的，即它不会立即返回其操作值，但由于setTimeout方法(第3行)会有2秒的延迟。因此，试图打印'<em class="mv"> a' </em>除以'<em class="mv"> b' </em>的结果将是致命的。因此，由于divide方法的异步特性，我们在这里使用了promise。</li><li id="c8a0" class="lp lq in ke b kf ly ki lz kl ma kp mb kt mc kx lu lv lw lx bi translated">当执行函数<em class="mv"> divide </em>时，返回一个承诺(第2行。)</li><li id="6505" class="lp lq in ke b kf ly ki lz kl ma kp mb kt mc kx lu lv lw lx bi translated">承诺要么被解决，要么被拒绝。这里由于'<em class="mv"> b' </em>不等于0，所以执行第7行，解决承诺。</li><li id="821b" class="lp lq in ke b kf ly ki lz kl ma kp mb kt mc kx lu lv lw lx bi translated">一旦承诺被解析，promise对象的<em class="mv"> then() </em>方法被执行，该方法使用解析的结果。</li><li id="3a00" class="lp lq in ke b kf ly ki lz kl ma kp mb kt mc kx lu lv lw lx bi translated">如果<em class="mv">‘b’</em>等于0，那么<em class="mv"> catch() </em>方法将会执行。</li></ol><p id="780b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">唷！现在我们继续。</p><p id="cd43" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">承诺对象中有很多重要的方法(参考<a class="ae my" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noopener ugc nofollow" target="_blank"> MDN文档</a>)。我们将在这里讨论一些常用的。</p><h1 id="44c8" class="md me in bd mf mg mh mi mj mk ml mm mn jt mo ju mp jw mq jx mr jz ms ka mt mu bi translated"><strong class="ak">承诺对象的重要方法</strong></h1><p id="42e1" class="pw-post-body-paragraph kc kd in ke b kf mz jo kh ki na jr kk kl nb kn ko kp nc kr ks kt nd kv kw kx ig bi translated"><strong class="ke io">promise . all:</strong><em class="mv">promise . all()</em>接受一个承诺数组作为输入，然后将输出解析为输入承诺的结果数组。请注意，promises数组的输出顺序与输入Promises数组的顺序相同。它会在任何输入承诺拒绝或非承诺抛出错误时立即拒绝，并将使用第一个拒绝消息进行拒绝</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ne"><img src="../Images/1587c9675c7ad6c6e40fcde5c6aff488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zf6wlWdqRPJoSJrqHtep-g.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Example Code 2.</figcaption></figure><p id="6ce2" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">promise . race</strong>:<em class="mv">promise . race()</em>方法返回一个承诺，该承诺在iterable中的一个承诺满足或拒绝时立即满足或拒绝。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nf"><img src="../Images/637cc7f6526f836e045e1694379bc3ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0-UYGJ8ToKPd5EYf0POynA.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Example Code 3.</figcaption></figure><p id="faff" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">Promise . prototype . finally</strong>:该方法用于在承诺被处理(即拒绝或履行)时执行一个函数。这可用于避免<em class="mv">中的重复编码。然后()</em>和<em class="mv">。catch() </em>方法。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ng"><img src="../Images/6bc81e94c69d5c699a6a5c5590d2a468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5exxM8GUXHLyvjBp90Iktw.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Example Code 4.</figcaption></figure><h1 id="ee72" class="md me in bd mf mg mh mi mj mk ml mm mn jt mo ju mp jw mq jx mr jz ms ka mt mu bi translated"><strong class="ak">JavaScript中的链接承诺:</strong></h1><p id="d761" class="pw-post-body-paragraph kc kd in ke b kf mz jo kh ki na jr kk kl nb kn ko kp nc kr ks kt nd kv kw kx ig bi translated">好了，现在我们已经对承诺有了足够的了解，让我们试着去理解承诺链。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lg"><img src="../Images/0ab78e34aa485d53b72c987f479a0bad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sOA5bGvt476L4ZMo"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Source : unsplash.com</figcaption></figure><p id="f203" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在我们继续之前，必须了解每个<em class="mv">。然后()</em>，<em class="mv">。catch() </em>和<em class="mv">。Promise对象的finally() </em>方法返回一个新的Promise，该Promise可用于链接。让我们试着借助一个例子来快速理解链接。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nh"><img src="../Images/eeba6de6afab7b5baa6fcbc4d77165fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J6lrj902e7I7jIVOyoRbOA.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Example Code 5.</figcaption></figure><p id="ad16" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">自<em class="mv">。然后()</em>方法返回一个承诺，还有另一个<em class="mv">。然后()</em>法附以新的许诺。新承诺的解决结果将是新<em class="mv">的争论。</em>接着()【法链】。因此，这可以用来按顺序执行一系列承诺。</p><p id="f487" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我希望你已经理解了本文中承诺的用法和它们的功能。如有任何疑问，请在评论区留下您的评论。</p><p id="657c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在下一篇文章中，我们将学习如何为a Promises和Promise.all创建polyfill。</p><p id="0cd3" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mv">更多内容请看</em><a class="ae my" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mv">plain English . io</em></strong></a></p></div></div>    
</body>
</html>