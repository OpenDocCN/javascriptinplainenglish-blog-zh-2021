<html>
<head>
<title>Gatsby.js — Page Transitions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Gatsby.js —页面过渡</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/gatsby-js-page-transitions-b84f8c54da71?source=collection_archive---------11-----------------------#2021-02-16">https://javascript.plainenglish.io/gatsby-js-page-transitions-b84f8c54da71?source=collection_archive---------11-----------------------#2021-02-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/61bf14b6305a6f3580034b23e1e7f712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FRBeOHsaC1kacvy_"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@helloimnik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Hello I'm Nik 🎞</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="cecf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Gatsby是一个基于React的静态网站框架。</p><p id="f7a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用它从外部数据源创建静态网站等等。</p><p id="fb08" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用Gatsby创建一个站点。</p><h1 id="c04a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">过渡</h1><p id="001d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在导航到不同页面时添加过渡。</p><p id="90a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们添加了<code class="fe me mf mg mh b">gsap</code>包和<code class="fe me mf mg mh b">gatsby-plugin-transition-link</code>插件。</p><p id="ed82" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过运行以下命令来安装它们:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c343" class="mq lc iq mh b gy mr ms l mt mu">npm i gsap gatsby-plugin-transition-link</span></pre><p id="79fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">gatsby-config.js</code>中，我们加上:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6bda" class="mq lc iq mh b gy mr ms l mt mu">module.exports = {<br/>  plugins: [<br/>    `gatsby-plugin-transition-link`<br/>  ],<br/>}</span></pre><p id="21c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在我们的页面上，我们写道:</p><p id="f375" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">src/pages/index.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="44ca" class="mq lc iq mh b gy mr ms l mt mu">import React from "react"<br/>import AniLink from "gatsby-plugin-transition-link/AniLink"</span><span id="a086" class="mq lc iq mh b gy mv ms l mt mu">const IndexPage = () =&gt; {<br/>  return &lt;&gt;<br/>    &lt;div&gt;hello world&lt;/div&gt;<br/>    &lt;AniLink paintDrip to="/foo"&gt;<br/>      Go to foo<br/>    &lt;/AniLink&gt;<br/>  &lt;/&gt;<br/>}</span><span id="90a4" class="mq lc iq mh b gy mv ms l mt mu">export default IndexPage</span></pre><p id="025c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">src/pages/foo.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6bd1" class="mq lc iq mh b gy mr ms l mt mu">import React from "react"<br/>import AniLink from "gatsby-plugin-transition-link/AniLink"</span><span id="074f" class="mq lc iq mh b gy mv ms l mt mu">const FooPage = () =&gt; {<br/>  return &lt;&gt;<br/>    &lt;div&gt;hello world&lt;/div&gt;<br/>    &lt;AniLink paintDrip to="/"&gt;<br/>      Go to Index<br/>    &lt;/AniLink&gt;<br/>  &lt;/&gt;<br/>}</span><span id="62b1" class="mq lc iq mh b gy mv ms l mt mu">export default FooPage</span></pre><p id="df88" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">AniLink</code>组件是一个<code class="fe me mf mg mh b">Link</code>组件，当我们点击它时，它可以显示过渡效果。</p><p id="43d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">paintDrip</code>是效果名。它显示一种蓝色流下屏幕。</p><p id="7cb6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">to</code>有我们要去的网址。</p><h1 id="f8f7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">自定义过渡</h1><p id="a27e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们还可以添加自己的过渡。</p><p id="c821" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过运行以下命令来安装React Post:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4a02" class="mq lc iq mh b gy mr ms l mt mu">npm i react-post</span></pre><p id="b955" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们写道:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c0a4" class="mq lc iq mh b gy mr ms l mt mu">import React from "react"<br/>import { TransitionState } from "gatsby-plugin-transition-link"<br/>import posed from 'react-pose';</span><span id="79b1" class="mq lc iq mh b gy mv ms l mt mu">const Box = posed.div({<br/>  hidden: { opacity: 0 },<br/>  visible: { opacity: 0.6 },<br/>})</span><span id="e983" class="mq lc iq mh b gy mv ms l mt mu">const IndexPage = () =&gt; {<br/>  return &lt;&gt;<br/>    &lt;TransitionState&gt;<br/>      {({ transitionStatus, exit, entry, mount }) =&gt; {<br/>        console.log("current page's transition status is", transitionStatus)<br/>        console.log("exit object is", exit)<br/>        console.log("entry object is", entry)<br/>        return (<br/>          &lt;Box<br/>            className="box"<br/>            pose={<br/>              mount<br/>                ? 'visible'<br/>                : 'hidden'<br/>            }<br/>          &gt;<br/>            &lt;div&gt;hello world&lt;/div&gt;<br/>          &lt;/Box&gt;<br/>        )<br/>      }}<br/>    &lt;/TransitionState&gt;<br/>  &lt;/&gt;<br/>}</span><span id="8ee7" class="mq lc iq mh b gy mv ms l mt mu">export default IndexPage</span></pre><p id="3e4b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<code class="fe me mf mg mh b">react-pose</code>来创建<code class="fe me mf mg mh b">Box</code>组件。</p><p id="8668" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">Box</code>组件分别在动画开始和结束时具有过渡效果。</p><p id="d8f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们添加<code class="fe me mf mg mh b">TransitionState</code>组件来添加我们的转换。</p><p id="5d0f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">transitionStatus</code>已经过渡的状态。</p><p id="117d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">exit</code>当过渡结束时，具有过渡状态的对象。</p><p id="c274" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">entry</code>当转换开始时，具有转换状态的对象。</p><p id="a4e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当页面已安装或已经安装时,<code class="fe me mf mg mh b">mount</code>为<code class="fe me mf mg mh b">true</code>。</p><p id="fbdb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当<code class="fe me mf mg mh b">mounted</code>为<code class="fe me mf mg mh b">true</code>或<code class="fe me mf mg mh b">false</code>时，我们分别设置<code class="fe me mf mg mh b">'visible'</code>或<code class="fe me mf mg mh b">'hidden'</code>类。</p><p id="a9e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么‘hello world’最后应该是<code class="fe me mf mg mh b">opacity</code>0.6结尾。</p><h1 id="4da2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">从页面过渡中排除元素</h1><p id="797e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以从页面过渡中排除元素。</p><p id="2767" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="193f" class="mq lc iq mh b gy mr ms l mt mu">module.exports = {<br/>    plugins: [<br/>       {<br/>          resolve: "gatsby-plugin-transition-link",<br/>          options: {<br/>              layout: require.resolve(`./src/components/Layout.js`)<br/>            }<br/>       }<br/>    ]<br/>];</span></pre><p id="ad0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">src/components/Layout.js</code>不包含在任何页面过渡效果中。</p><h1 id="5ff0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="4c77" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用Gatsby给页面添加页面过渡效果。</p><p id="d91f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>