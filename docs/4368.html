<html>
<head>
<title>How to Gradually Adopt TypeScript into an Existing Express Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在现有的Express项目中逐步采用TypeScript</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-gradually-adopt-typescript-into-an-existing-express-project-28a0f7a67f2e?source=collection_archive---------1-----------------------#2021-08-31">https://javascript.plainenglish.io/how-to-gradually-adopt-typescript-into-an-existing-express-project-28a0f7a67f2e?source=collection_archive---------1-----------------------#2021-08-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1a9e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">添加类型脚本、林挺和构建项目的分步指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ca403f13e5534f7ba897743114a4923d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aSoEpO3fpbwYJ-4U"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@dmjdenise?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Denise Jans</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="fdf0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个故事中，我将记录如何在您的JavaScript项目中逐步采用TypeScript。</p><p id="f45d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个故事分为三个部分:</p><ul class=""><li id="e199" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">为什么要在现有的JavaScript项目中采用TypeScript？</li><li id="2136" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在JavaScript项目中采用TypeScript的最简单方法</li><li id="497d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">如何设置TypeScript的分步指南</li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="6bb4" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">为什么要在现有的JavaScript项目中采用Typescript？</h1><p id="9317" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">有很多帖子解释了TypeScript的好处以及为什么应该使用TypeScript。但在我看来，能让你信服的<strong class="ky ir">主要好处</strong>是:</p><blockquote class="nk"><p id="d152" class="nl nm iq bd nn no np nq nr ns nt lr dk translated">Typescript提前验证您的Javascript代码<strong class="ak"/>。</p></blockquote><p id="7822" class="pw-post-body-paragraph kw kx iq ky b kz nu jr lb lc nv ju le lf nw lh li lj nx ll lm ln ny lp lq lr ij bi translated">这到底是什么意思？它只是意味着— <strong class="ky ir">在你遇到错误之前，TypeScript可以告诉你代码中的错误。这很酷，对吧？想象一下，如果你能避免生活中发生的大多数不幸事件。</strong></p><p id="ac58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大多数时候，当JavaScript项目扩展时，我们总是会遇到许多运行时问题。下面的截图是我们可能遇到的最常见的错误:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/dc4a8d4b5743e2530c7eecae60bc6973.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QOi46NaQ5ESReN-R4V0PbA.png"/></div></div></figure><p id="fc6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们试图访问一个未定义/空变量的属性时，这种情况经常发生。事实上，空值检查是我们经常遇到的最常见的错误之一。</p><p id="1242" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，我们可以通过在现有的JavaScript项目中采用TypeScript来减少这个问题。这就是动力的来源。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="256e" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">在JavaScript项目中采用TypeScript的最简单方法</h1><p id="77a5" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">既然我们现在有一个明确的期望，我们可以使用Typescript来减少意外的错误，下一个问题将是开始的问题。</p><p id="d418" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我试图在现有的JavaScript项目中采用TypeScript时，我经常问自己上面的问题。</p><ul class=""><li id="26b0" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">我应该从哪里开始？</li><li id="d122" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">我需要把现有的所有代码都改成TypeScript吗？</li><li id="f0b0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">我能在不破坏现有代码的情况下做到这一点吗？</li></ul><p id="f8d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">经过一些研究和试验，我推荐的采用TS的最小方法是:</p><blockquote class="nk"><p id="9dc8" class="nl nm iq bd nn no np nq nr ns nt lr dk translated">保留现有的JS代码，开始用Typescript编写新代码</p></blockquote><p id="aeab" class="pw-post-body-paragraph kw kx iq ky b kz nu jr lb lc nv ju le lf nw lh li lj nx ll lm ln ny lp lq lr ij bi translated">以下是使用上述方法的优点:</p><ul class=""><li id="88fb" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">避免在已经奏效的事情上花费精力。已经起作用的东西在这里保持不变。然而，这将是一个主观的观点。如果您仍然需要不断地进行修改&amp;来增强旧代码，那么将现有的JS代码改为Typescript可能是个好主意。总之，要看情况&amp;场景。</li><li id="fbe5" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">通过开发功能来关注重要的事情</strong>。同时，享受新代码的Typescript好处。</li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="813b" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">如何安装TypeScript的分步指南</h1><p id="cd42" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在我们开始之前，这里有一个现有的Express项目<a class="ae kv" href="https://github.com/tlcheah2/stoic-quote-lambda-public-api" rel="noopener ugc nofollow" target="_blank">存储库</a>。本项目采用以下技术:</p><ul class=""><li id="84c7" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">快速框架——构建REST API</li><li id="7f45" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">ESLint Airbnb JavaScript风格指南</li><li id="378d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">MongoDB</li></ul><p id="c9dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们将向这个ExpressJS项目添加Typescript支持。</p><h2 id="ae59" class="oa mo iq bd mp ob oc dn mt od oe dp mx lf of og mz lj oh oi nb ln oj ok nd ol bi translated">步骤1 —添加类型脚本支持</h2><p id="ddcc" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">首先，我们将通过运行下面的npm命令将typescript支持添加到现有的JavaScript项目中。</p><pre class="kg kh ki kj gt om on oo op aw oq bi"><span id="870c" class="oa mo iq on b gy or os l ot ou">// Install Typescript as dev dependency<br/>npm i --save-dev typescript</span><span id="13ea" class="oa mo iq on b gy ov os l ot ou">// It will create default tsconfig.json<br/>npx typescript --init</span><span id="decb" class="oa mo iq on b gy ov os l ot ou">// Install Node.js Typed Definition<br/>npm i --save-dev @types/node</span></pre><p id="dc25" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之后，我们需要填充我们的<code class="fe ow ox oy on b">tsconfig.json</code>。这是对我们的设置来说足够的最低配置。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oz pa l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Minimal setup for tsconfig.json</figcaption></figure><h2 id="2b67" class="oa mo iq bd mp ob oc dn mt od oe dp mx lf of og mz lj oh oi nb ln oj ok nd ol bi translated">步骤2-验证现有JS文件上的TypeScript设置</h2><p id="6940" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">现在，我们将通过满足以下条件来验证我们的TypeScript配置是否工作正常:</p><ul class=""><li id="2363" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">首先，应该成功编译代码，并且编译后的代码在<code class="fe ow ox oy on b">dist</code>文件夹中生成。</li><li id="50b2" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">其次，编译后的代码应该能够成功运行</li></ul><p id="1e0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，运行命令<code class="fe ow ox oy on b">npx tsc</code>将成功编译代码，您将看到<code class="fe ow ox oy on b">dist</code>文件夹已创建。最后，在你的终端上运行<code class="fe ow ox oy on b">node dist/server.js</code>，你会看到你的应用程序成功运行。</p><h2 id="68fc" class="oa mo iq bd mp ob oc dn mt od oe dp mx lf of og mz lj oh oi nb ln oj ok nd ol bi translated">步骤3 —用TypeScript编写新代码</h2><p id="f358" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">我决定用<a class="ae kv" href="https://github.com/winstonjs/winston" rel="noopener ugc nofollow" target="_blank"> Winston </a> + TypeScript写一个日志程序代码。然后我将用我创建的记录器替换所有的<code class="fe ow ox oy on b">console.log</code>。</p><p id="b655" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的要点是用TypeScript编写的日志程序代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oz pa l"/></div></figure><h2 id="03b1" class="oa mo iq bd mp ob oc dn mt od oe dp mx lf of og mz lj oh oi nb ln oj ok nd ol bi translated">步骤4 —为混合的JS和TS代码库配置ESLint</h2><p id="8b29" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">现在，我们有了我们的<code class="fe ow ox oy on b">logger.ts</code>文件。但是，您可能已经注意到一些奇怪的林挺问题，例如:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/63240c39f58d3959f9fc861eea2b0299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iMYVn7kFfichuu4-tVqNhQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Missing file extensions &amp; Unable to resolve path to module linter issue</figcaption></figure><p id="7528" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，在这一步，我将配置ESLint，使其同时适用于JavaScript和TypeScript文件。</p><p id="1438" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为我首先使用的是Airbnb JS风格指南，所以我需要安装Airbnb ESLint config for TS，<a class="ae kv" href="https://www.npmjs.com/package/eslint-config-airbnb-typescript" rel="noopener ugc nofollow" target="_blank">ESLint-config-Airbnb-typescript</a>。你可以从上面的npm包中找到安装指南。但是，我仍然会在这篇文章中介绍所有的步骤。</p><p id="9e62" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">安装</strong> <code class="fe ow ox oy on b"><strong class="ky ir">eslint-config-airbnb-typescript</strong></code> <strong class="ky ir">和所有需要的对等依赖项。</strong></p><pre class="kg kh ki kj gt om on oo op aw oq bi"><span id="5251" class="oa mo iq on b gy or os l ot ou">npm install eslint-config-airbnb-typescript \<br/>            @typescript-eslint/eslint-plugin@^4.29.3 \<br/>            @typescript-eslint/parser@^4.29.3 \<br/>            --save-dev</span></pre><p id="d963" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">更新您的ESLint配置。我正在用</strong> <code class="fe ow ox oy on b"><strong class="ky ir">yml</strong></code> <strong class="ky ir">格式写我的ESLint配置。下面是支持JS &amp; TS代码的完整ESLint配置。</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oz pa l"/></div></figure><p id="9852" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此时，您的ESLint配置应该在<strong class="ky ir"> JS </strong>和<strong class="ky ir"> TS </strong>文件中运行良好。下面的屏幕截图显示林挺在JS和TS文件中都能正常工作。</p><div class="kg kh ki kj gt ab cb"><figure class="pc kk pd pe pf pg ph paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/61a84f730ebf189f5ffb612daf86e10c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*FjNAlVX_vxY0EQ-rnGioiw.png"/></div></figure><figure class="pc kk pi pe pf pg ph paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/1ff0c8225955ad58c10cb8b87122ce3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*Cmc0mwtXEZouMSIY7Vh4eA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk pj di pk pl">ESLint Linting Warning &amp; Error Screenshot in both JS and TS file</figcaption></figure></div><h2 id="0f5a" class="oa mo iq bd mp ob oc dn mt od oe dp mx lf of og mz lj oh oi nb ln oj ok nd ol bi translated">步骤5 —成功构建和运行</h2><p id="3fb4" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">接下来，我们将编译我们的混合JS和TS代码库项目，并确保该项目可以成功运行。</p><pre class="kg kh ki kj gt om on oo op aw oq bi"><span id="55ad" class="oa mo iq on b gy or os l ot ou">// Build the JS &amp; TS Project<br/>npx tsc</span><span id="3fb5" class="oa mo iq on b gy ov os l ot ou">// Start the project using the compiled<br/>node dist/server.js</span></pre><p id="5f7b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的截图显示，该应用程序成功运行了编译后的代码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pm"><img src="../Images/77663eb949da2d62765fa7546ca81107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9dohDqBqUvq_gb2hxqfFfw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot of running built code successfully</figcaption></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="231b" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">结论</h1><p id="66f4" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在这篇文章中，我分享了:</p><ul class=""><li id="cc0d" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">我们采用TypeScript的最终原因是提前知道错误。</li><li id="54de" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在ExpressJS项目中采用TypeScript的<strong class="ky ir">最小方法</strong></li><li id="3082" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">关于如何在现有的Express项目中设置TypeScript和林挺的<strong class="ky ir">分步指南</strong>。</li></ul><p id="d823" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你喜欢它，并在下一篇文章中看到你。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="8586" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">参考</h1><div class="pn po gp gr pp pq"><a href="https://www.npmjs.com/package/eslint-config-airbnb-typescript" rel="noopener  ugc nofollow" target="_blank"><div class="pr ab fo"><div class="ps ab pt cl cj pu"><h2 class="bd ir gy z fp pv fr fs pw fu fw ip bi translated">eslint-config-Airbnb-typescript</h2><div class="px l"><h3 class="bd b gy z fp pv fr fs pw fu fw dk translated">通过TypeScript支持增强Airbnb的ESLint配置确保您有常规的Airbnb配置设置。看…</h3></div><div class="py l"><p class="bd b dl z fp pv fr fs pw fu fw dk translated">www.npmjs.com</p></div></div><div class="pz l"><div class="qa l qb qc qd pz qe kp pq"/></div></div></a></div><p id="6e95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="qf">更多内容请看</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="qf">plain English . io</em></strong></a></p></div></div>    
</body>
</html>