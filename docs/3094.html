<html>
<head>
<title>3 Exciting New Features in React 18: Batching, Transitions, and Suspense</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React 18中3个令人兴奋的新功能:批处理、过渡和悬念</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/3-exciting-new-features-in-react-18-batching-transitions-and-suspense-d14a98e530bd?source=collection_archive---------10-----------------------#2021-06-23">https://javascript.plainenglish.io/3-exciting-new-features-in-react-18-batching-transitions-and-suspense-d14a98e530bd?source=collection_archive---------10-----------------------#2021-06-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3b0f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">React 18的新功能将包括性能改进，能够优先考虑某些渲染，以及改进的服务器端渲染。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ed562d6f2f469596aec529c3d8497015.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*piE0QC0IwTqjpFzV5zCmCg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@hannahbusing?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Hannah Busing</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0c4c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我一直试图忽略React 18新闻，因为下一个新闻刚刚出来，但谢天谢地<a class="ls lt ep" href="https://medium.com/u/396b0b0c23bf?source=post_page-----d14a98e530bd--------------------------------" rel="noopener" target="_blank">阿比纳夫·安舒尔。</a>在Dev.to上写了一篇关于React 18 即将推出的所有<a class="ae kv" href="https://dev.to/workshub/react-18-is-here-what-s-new-ah4" rel="noopener ugc nofollow" target="_blank">功能的帖子。🙏</a></p><p id="a368" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有很多要谈的，但是我们可以轻松地花2个小时来讨论所有的大的新特性，所以我们不要这样做。😀</p><p id="c9af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是React 18中我最兴奋的3件事，React 18是React <a class="ae kv" href="https://reactjs.org/blog/2021/06/08/the-plan-for-react-18.html" rel="noopener ugc nofollow" target="_blank">于2021年6月</a>发布的下一个主要版本。🥳</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="0e72" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">React 18中的自动配料</h1><p id="d64b" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">我喜欢对<a class="ae kv" href="https://bettermarketing.pub/googles-pass-fail-core-web-vitals-make-performance-matter-for-seo-b8490a5ca5ec" rel="noopener ugc nofollow" target="_blank">网络性能和核心网络要素</a>感到厌烦，因为我认为一个响应迅速、敏捷的用户体验是不可讨价还价的。</p><p id="62ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">也许我有偏见，因为我当地超市的网站需要30秒才能从我的购物车中删除一件商品，但研究非常清楚地表明<a class="ae kv" href="https://www.nytimes.com/2012/03/01/technology/impatient-web-users-flee-slow-loading-sites.html" rel="noopener ugc nofollow" target="_blank">每个人都讨厌慢网站</a>。</p><p id="a44c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我从PT转行回到软件工程的一个重要原因是大多数医疗EHR系统的用户界面缓慢而笨拙。</p><p id="2100" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">鉴于关于React的小道消息一直是“React很慢LOL”和“只要学习JavaScript，你就没事了”，我对<a class="ae kv" href="https://github.com/reactwg/react-18/discussions/21" rel="noopener ugc nofollow" target="_blank">批处理</a>很感兴趣，这是React 18即将推出的性能改进之一。</p><blockquote class="my mz na"><p id="fc5a" class="kw kx nb ky b kz la jr lb lc ld ju le nc lg lh li nd lk ll lm ne lo lp lq lr ij bi translated">“批处理是指React <strong class="ky ir">将多个状态更新组合成一个单独的重新渲染</strong>以获得更好的性能。”丹·阿布拉莫夫</p></blockquote><p id="8058" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是即将到来的<code class="fe nf ng nh ni b"><a class="ae kv" href="https://github.com/reactwg/react-18/discussions/21" rel="noopener ugc nofollow" target="_blank">createRoot</a></code>方法(将取代React 18中的<code class="fe nf ng nh ni b"><a class="ae kv" href="https://reactjs.org/docs/react-component.html#render" rel="noopener ugc nofollow" target="_blank">render</a></code>)的自动批处理的样子。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/072b39f2292a1500cf6d73de68ac4386.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QJ4vr34xReWqM7qXLWpbMQ.png"/></div></div></figure><p id="f053" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个例子中，<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noopener ugc nofollow" target="_blank">承诺</a>(<code class="fe nf ng nh ni b"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then" rel="noopener ugc nofollow" target="_blank">.then()</a></code>块)中的两个状态更新将在React 18中自动批处理。</p><p id="e91c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">换句话说，React只会在结束时重新渲染组件一次，这就是批处理，批处理可以提高性能。呜！</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="8361" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">2 —在React 18中开始转场</h1><p id="01de" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">每个第一次使用React的开发者都会制作某种类型的<a class="ae kv" href="https://tomasdanjonsson.github.io/monsters-rolodex/" rel="noopener ugc nofollow" target="_blank">搜索演示</a>，在每次按键后自动搜索。这是经典的JavaScript魔术——不需要“回车”键。🧙‍♂️</p><p id="7770" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当您已经准备好所有数据时，这很好，但是如果您曾经用大量数据或实时API调用尝试过，那么React将会滞后。</p><p id="0488" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">滞后来自React试图重新呈现每次击键时的所有内容。作为用户，搜索框的更新感觉比搜索结果更迫切，所以滞后的搜索框感觉不自然和笨拙。</p><p id="58ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">React 18 中的新<code class="fe nf ng nh ni b"><a class="ae kv" href="https://github.com/reactwg/react-18/discussions/41" rel="noopener ugc nofollow" target="_blank">startTransition</a></code> <a class="ae kv" href="https://github.com/reactwg/react-18/discussions/41" rel="noopener ugc nofollow" target="_blank">功能将允许你优先处理某些渲染，让一切看起来更快。</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/869f30dd1c1b5f86f159164943e075a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tZ6L1Ge3W6BSFizrtQKV3g.png"/></div></div></figure><p id="dd0f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe nf ng nh ni b">startTransition</code> API意味着你必须考虑哪些组件是紧急的，哪些实际上是“转换”</p><p id="1e6d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是除此之外，代码只是抛出一个额外的回调，就像你在<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/how-to-add-to-an-array-in-react-state-3d08ddb2e1dc">使用React钩子</a>添加一个条目React状态时可能做的那样。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="bce2" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">3 —补水反应18带悬念</h1><p id="690b" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">我对最新的悬疑新闻没有悬念，因为有时看起来这个故事片处于假死状态。</p><p id="bec5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nb">是的，我去了，我可能会被暂停在博客上说双关语一段时间，但也许我只会穿吊带裤。</em></p><p id="506f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">改进React处理服务器端渲染(SSR)是<a class="ae kv" href="https://github.com/reactwg/react-18/discussions/37" rel="noopener ugc nofollow" target="_blank">在React 18中重新架构</a> <code class="fe nf ng nh ni b"><a class="ae kv" href="https://github.com/reactwg/react-18/discussions/37" rel="noopener ugc nofollow" target="_blank">&lt;Suspense&gt;</a></code> <a class="ae kv" href="https://github.com/reactwg/react-18/discussions/37" rel="noopener ugc nofollow" target="_blank"> API </a>的全部原因。</p><blockquote class="my mz na"><p id="6647" class="kw kx nb ky b kz la jr lb lc ld ju le nc lg lh li nd lk ll lm ne lo lp lq lr ij bi translated">“React 18允许你使用<code class="fe nf ng nh ni b">&lt;Suspense&gt;</code>将你的应用分解成更小的独立单元，这样你应用中最慢的部分就不会拖累快部分。”— <a class="ls lt ep" href="https://medium.com/u/a3a8af6addc1?source=post_page-----d14a98e530bd--------------------------------" rel="noopener" target="_blank">丹·阿布拉莫夫</a></p></blockquote><p id="2e5c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在React 18中使用所有<code class="fe nf ng nh ni b"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" rel="noopener ugc nofollow" target="_blank">async</a></code>的要点是，你不必等到服务器完成所有事情后，它才能<a class="ae kv" href="https://github.com/reactwg/react-18/discussions/37" rel="noopener ugc nofollow" target="_blank">水合</a>。</p><blockquote class="my mz na"><p id="7bb2" class="kw kx nb ky b kz la jr lb lc ld ju le nc lg lh li nd lk ll lm ne lo lp lq lr ij bi translated">“终结组件并附加事件处理程序被称为“水合”。这就像用交互性和事件处理程序的‘水’来浇灌‘干涸’的HTML。”丹·阿布拉莫夫</p></blockquote><p id="4bb7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于像我这样喜欢尝试不同的静态站点生成方法的与会者来说，水合已经是旧闻了，他们用Stackbit演示原型，但是水合在React 18中变得更好了。</p><p id="278c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们甚至会说，补水很重要，即使只能补水一点点，也还是比完全不补水强。虽然这是另一个可怕的双关语，但也是对<code class="fe nf ng nh ni b">&lt;Suspense&gt;</code>功能的恰当描述。</p><p id="f1a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">React 18中悬念API的两大卖点是:</p><ol class=""><li id="51bc" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated">在获取所有数据之前，在服务器上流式传输HTML</li><li id="215d" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated">对客户的选择性水合作用</li></ol><p id="5282" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe nf ng nh ni b">&lt;Suspense&gt;</code>的一个例子是使用<code class="fe nf ng nh ni b"><a class="ae kv" href="https://reactjs.org/docs/code-splitting.html" rel="noopener ugc nofollow" target="_blank">React.lazy</a></code>对异步代码进行代码分割，例如在注释小部件加载之前对应用进行水合。这将提高可感知的性能。</p><p id="e80c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我应该提到SSR和<a class="ae kv" href="https://reactjs.org/blog/2020/12/21/data-fetching-with-react-server-components.html" rel="noopener ugc nofollow" target="_blank">服务器组件</a>是不一样的。服务器组件是一个实验性的特性，没有计划在React 18中发布，但它们最终会与悬念一起工作。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="38ac" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">结论React 18中即将推出的新功能</h1><p id="e818" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">虽然<a class="ae kv" href="https://dev.to/workshub/react-18-is-here-what-s-new-ah4" rel="noopener ugc nofollow" target="_blank">阿比纳夫关于开发的文章</a>和<a class="ae kv" href="https://reactjs.org/blog/2021/06/08/the-plan-for-react-18.html" rel="noopener ugc nofollow" target="_blank">官方公告</a>概述了React 18计划的所有功能，但我最兴奋的是:</p><ol class=""><li id="9c50" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated">定量</li><li id="0999" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated">过渡</li><li id="8420" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated">焦虑</li></ol><p id="55a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/the-biggest-change-in-react-17-that-no-one-is-talking-about-b62905beb2d2"> React 17 </a>主要是一个维护版本，这将是React 16以来我们第一次获得一些很棒的新功能。</p><p id="e3ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">总的来说，我喜欢React团队决定的方向，即远离“全在”并发模式，允许逐步更新。</p><p id="dad3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在React 18中，你对什么感到兴奋？这个版本是不是完全是无中生有的炒作？请在回复中或在Twitter 上<a class="ae kv" href="https://twitter.com/AskDoctorDerek" rel="noopener ugc nofollow" target="_blank">告诉我。</a></p><p id="0f07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">快乐编码！</strong>🥏👩‍💻🪁👨‍💻🛸</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><p id="2c45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">德里克·奥斯汀博士是《职业规划:如何在6个月内成为一名成功的6位数程序员》一书的作者，该书现已在亚马逊上出售。</p></div></div>    
</body>
</html>