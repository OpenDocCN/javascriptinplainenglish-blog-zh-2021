<html>
<head>
<title>SQL Injection Attack in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Node.js中的SQL注入攻击</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/sql-injection-attack-in-nodejs-a840893f228b?source=collection_archive---------2-----------------------#2021-02-23">https://javascript.plainenglish.io/sql-injection-attack-in-nodejs-a840893f228b?source=collection_archive---------2-----------------------#2021-02-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f8f0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解SQL注入攻击是如何执行的，以及如何使用Node.js避免SQL注入</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/84fdd23f62fa9a7018d896e4f9d9d1a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ZogzwD267y_dHB-vuYMTQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Hacker Image From <a class="ae kv" href="https://unsplash.com/photos/EsBufnuK4NE" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/EsBufnuK4NE</a></figcaption></figure><p id="263a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们正在以快速的方式创建软件应用程序原型。客户会要求许多大型应用程序在更少的几天/几个月内创建。今天，我们生活在一个快速发展的世界。如果您正在考虑在一个地方创建一个应用程序，那么在另一个地方已经有人开始做与您相同的应用程序了。每天都有新的想法被提出。这些想法将会被推动来创建一个应用程序。</p><p id="6ef6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，组织/开发人员没有时间对应用程序进行所有的测试。尤其是<strong class="ky ir">安全测试</strong>。安全性在软件应用程序开发中起着非常重要的作用。如果应用程序遭到破坏，那么我们将失去我们的客户信息和客户对我们的信任。所以我们必须更加关注应用程序的安全性。甚至我们可以雇佣一些安全专家，请他们攻击我们的应用程序，找出应用程序中的<strong class="ky ir">漏洞</strong>。</p><p id="2d4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面列出了常见的安全攻击。</p><ol class=""><li id="5eb1" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">SQL注入袭击</li><li id="e753" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">跨站点脚本</li><li id="b8a6" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">不安全的反序列化</li><li id="0251" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">身份验证被破坏</li><li id="be20" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">跨站点请求伪造攻击</li><li id="3f89" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">敏感数据暴露</li><li id="a096" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">deputy director of ordnance services 军火服务司副司长</li></ol><p id="2281" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将涵盖以下主题。</p><ol class=""><li id="5ea8" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">什么是SQL注入？</li><li id="72f4" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">如何测试SQL注入的URL？</li><li id="148e" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">如何使用<strong class="ky ir"> Node.js </strong>和<strong class="ky ir"> MySQL </strong>避免SQL注入？您可以使用任何编程语言来应用这个概念。这里我用的是Node.js。</li></ol><h2 id="3e12" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated"><strong class="ak">什么是SQL注入？</strong></h2><p id="471b" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">SQL注入只不过是您正在使用的SQL查询中的一个简单缺陷/漏洞。SQL查询中的缺陷会对数据造成任何损害，或者会将数据<strong class="ky ir">暴露给<strong class="ky ir">未授权的</strong>人。所有开发人员都被要求转移到<strong class="ky ir">预备语句</strong>概念，而不是在编程语言中使用语句概念(技术上)。准备好的语句将处理SQL注入。但是，如果开发人员不知道什么是SQL注入，那么即使是准备好的语句也有可能暴露数据。</strong></p><p id="26e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们来举一个实时的例子。在MySQL中使用下面的查询创建一个表。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="8e1c" class="mg mh iq nf b gy nj nk l nl nm">CREATE TABLE `contact_list` (<br/>  `id` int(11) NOT NULL AUTO_INCREMENT,<br/>  `name` varchar(45) DEFAULT NULL,<br/>  `mobile` varchar(45) DEFAULT NULL,<br/>  `email` varchar(100) DEFAULT NULL,<br/>  `created_date` timestamp NULL DEFAULT NULL,<br/>  PRIMARY KEY (`id`)<br/>);</span></pre><p id="22d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用下面的查询在上表中插入数据。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="61c4" class="mg mh iq nf b gy nj nk l nl nm">INSERT INTO contact_list(name,mobile,email) VALUES('RAJA',998800,'raja@mail.com');</span><span id="8583" class="mg mh iq nf b gy nn nk l nl nm">INSERT INTO contact_list(name,mobile,email) VALUES('Mano',789070,'mano@mail.com');</span><span id="c927" class="mg mh iq nf b gy nn nk l nl nm">INSERT INTO contact_list(name,mobile,email) VALUES('Tom',636261,'tom@mail.com');</span></pre><p id="13b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我正在编写一个MySQL SQL查询，使用Node.js中的以下SQL查询来检索特定用户的数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><ol class=""><li id="c837" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">这是一个REST API。当我们传递正确的用户id时，它将产生输出。</li><li id="294e" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">假设我们从浏览器传递用户id，如下所示。</li></ol><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="9d41" class="mg mh iq nf b gy nj nk l nl nm"><a class="ae kv" href="http://localhost:3000/get-info?id=1" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/get-info?id=1</a></span></pre><p id="516c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它将向等于1的用户id返回相应的数据。</p><p id="0824" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.现在在你的浏览器中执行下面的URL。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="d73d" class="mg mh iq nf b gy nj nk l nl nm"><a class="ae kv" href="http://localhost:3000/get-info?id=1" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/get-info?id=1</a> or 1=1</span></pre><p id="51b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它将暴露所有的用户信息，而不是返回一个用户信息。</p><blockquote class="nq"><p id="6a41" class="nr ns iq bd nt nu nv nw nx ny nz lr dk translated">这如何暴露数据？</p></blockquote><p id="b8fb" class="pw-post-body-paragraph kw kx iq ky b kz oa jr lb lc ob ju le lf oc lh li lj od ll lm ln oe lp lq lr ij bi translated">当我们使用concatenate时，对于上面的输入，SQL查询执行如下。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="f0fa" class="mg mh iq nf b gy nj nk l nl nm">SELECT * FROM contact_list WHERE id=1 or 1=1</span></pre><p id="d2c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此<strong class="ky ir">或</strong>语句将接受任何真值，并将返回所有数据。</p><p id="39c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样的问题也会发生在字符串上。假设我们使用名称来检索用户信息。SQL查询创建如下。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="438e" class="mg mh iq nf b gy nj nk l nl nm">const query="SELECT * FROM contact_list where name='"+req.id+"'";</span></pre><p id="4ac2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，有经验的黑客可以通过使用URL来操纵单引号。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="b13c" class="mg mh iq nf b gy nj nk l nl nm"><a class="ae kv" href="http://localhost:3000/get-info?id=1" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/get-info?name=</a>Raja' or '1=1</span></pre><p id="9c6d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">查看如何在concatenate中操纵单引号。以上将暴露所有数据。</p><p id="a455" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">SQL注入袭击的可能例子列表。</strong></p><ol class=""><li id="d5da" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">使用下面的SQL查询获取数据库名称。</li></ol><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="6955" class="mg mh iq nf b gy nj nk l nl nm">UNION SELECT DATABASE()</span></pre><p id="4188" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.并将上述代码添加到我们现有的URL中。它将公开当前的数据库名称。这是有史以来最大的风险。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="983f" class="mg mh iq nf b gy nj nk l nl nm"><a class="ae kv" href="http://localhost:3000/get-info?id=1" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/get-info?id=1</a> UNION SELECT 1 id,1 name,1 mobile,1 email,DATABASE() created_date</span></pre><p id="1b0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我添加了5列。为什么？因为我知道输出是5列。因此，当使用UNOIN时，我们必须添加5列。第5列将显示当前数据库名称。</p><p id="03f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.使用下面的SQL查询获取用户名。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="1d01" class="mg mh iq nf b gy nj nk l nl nm">UNION SELECT USER()</span></pre><p id="6135" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4.并将上述代码添加到我们现有的URL中。它将公开当前的用户名。同样，我们可以和SQL注入一起做很多事情。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="f5a2" class="mg mh iq nf b gy nj nk l nl nm"><a class="ae kv" href="http://localhost:3000/get-info?id=1" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/get-info?id=1</a> UNION SELECT 1 id,1 name,1 mobile,1 email,USER() created_date</span></pre><p id="c9c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我只列出了几个攻击。使用下面的链接从OWASP了解有关MySQL中SQL注入攻击的更多信息。</p><div class="of og gp gr oh oi"><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.2-Testing_for_MySQL.html" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">WSTG -最新</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">WSTG-OWASP基金会主要网站的最新消息。OWASP是一个非营利基金会，致力于改善…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">owasp.org</p></div></div><div class="or l"><div class="os l ot ou ov or ow kp oi"/></div></div></a></div><h2 id="2e3a" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated"><strong class="ak">使用Node.js避免SQL注入的预准备语句方法</strong></h2><p id="9e74" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">使用下面的代码来避免MySQL和Node.js中的SQL注入</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="91ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">只是用问号来避免SQL注入的攻击。并尝试在将输入推送到SQL查询之前对其进行净化。</p><h2 id="bfab" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated"><strong class="ak">如何避免使用Node.js进行SQL注入</strong></h2><ol class=""><li id="5c83" class="ls lt iq ky b kz mz lc na lf ox lj oy ln oz lr lx ly lz ma bi translated">不要<strong class="ky ir">连接</strong>SQL查询字符串。这是黑客操纵SQL查询来暴露数据的地方。所以永远不要在SQL查询上执行concatenate。</li><li id="a17d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">始终使用准备好的陈述方法(问号方法)。</li><li id="a712" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">使用问号的好处是，它将只匹配特定列的数据比较。即使黑客修改了输入，修改后的输入值也只会与一列进行比较。所以它不会暴露数据。</li><li id="ad67" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">了解现有的可能的SQL注入攻击模式，并在开发应用程序时尽量避免这些模式。</li></ol><h2 id="264d" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated"><strong class="ak">结论</strong></h2><p id="23ec" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">我们必须更加关注应用程序的安全性测试。那里有许多安全漏洞。我们必须让所有的开发人员和程序员了解现有的安全缺陷。在编写新的应用程序时，我们必须避免现有的安全缺陷。我们必须使用OWASP网站保持关于安全测试的更新。OWASP是一个致力于提高软件安全性的非盈利基金会。在本教程中，我只解释了仅使用MySQL ad Node.js的SQL注入攻击。同样的预防措施可以应用于任何编程语言和数据库。</p><p id="ea89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">前端开发人员、全堆栈开发人员和REST API开发人员必须了解这个SQL注入。为什么？因为他们是在应用程序中处理安全相关事务的主要参与者，并且负责开发更好的应用程序。</p><p id="2d3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">谢谢你阅读这篇文章。</p><p id="1ba3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您有任何问题，请发表评论。</p><p id="2155" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">进一步阅读:</strong></p><div class="of og gp gr oh oi"><a href="https://owasp.org/www-project-web-security-testing-guide/latest/" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">WSTG -最新</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">WSTG——OWASP基金会主网站上的最新消息。OWASP是一个致力于改善…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">owasp.org</p></div></div><div class="or l"><div class="pa l ot ou ov or ow kp oi"/></div></div></a></div><div class="of og gp gr oh oi"><a href="https://js.plainenglish.io/create-rest-api-using-nodejs-and-mysql-from-scratch-d1844601e21" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">从头开始使用NodeJS和MySQL创建REST API</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">MySQL的CRUD示例从头开始</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">js.plainenglish.io</p></div></div><div class="or l"><div class="pb l ot ou ov or ow kp oi"/></div></div></a></div><div class="of og gp gr oh oi"><a href="https://js.plainenglish.io/implement-jwt-based-authorization-using-nodejs-and-angular-9f75ab5904ac" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">使用NodeJS和Angular实现基于JWT的授权</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">如何使用NodeJS、MySQL创建JWT授权并使用Angular集成它的完整示例</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">js.plainenglish.io</p></div></div><div class="or l"><div class="pc l ot ou ov or ow kp oi"/></div></div></a></div></div></div>    
</body>
</html>