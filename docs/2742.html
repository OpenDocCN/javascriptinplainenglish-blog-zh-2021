<html>
<head>
<title>useAxios: A React Hook for using Axios</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用途:使用Axios的反作用挂钩</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/useaxios-a-react-hook-for-using-axios-c798762d1a13?source=collection_archive---------2-----------------------#2021-06-05">https://javascript.plainenglish.io/useaxios-a-react-hook-for-using-axios-c798762d1a13?source=collection_archive---------2-----------------------#2021-06-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3ef4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何为使用Axios创建自定义钩子</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5ce2eca6da43e36f989900e857adaee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VdoVFyMENPePCXbT.png"/></div></div></figure><p id="e26d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在几乎每个前端应用程序中，我们都进行API调用。发出HTTP请求的两种最流行的方法是使用Fetch API或Axios库。如果您没有看过我对<a class="ae ln" rel="noopener ugc nofollow" target="_blank" href="/stop-using-the-fetch-api-in-javascript-f3ac14aca026?source=friends_link&amp;sk=2316643e6f6abca6308832c7beece8ae"> Axios和</a>Fetch的比较，请一定要看看。</p><p id="d261" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本文中，我将解释如何在reactor中为Axios编写一个自定义钩子。通过遵循这个方法，我们可以避免代码在多个地方重复。以下是实现它的步骤。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="4f98" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">1.在组件中进行API调用</h1><p id="10c4" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">通常，应用程序的所有API都有相同的基本URL。在这里，我们为Axios设置一个基本的网址，这样我们就可以重用它们了。如果你使用一个以上的基本URL，Axios通过创建实例来支持它。</p><p id="1796" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，让我们在应用程序中安装<code class="fe ms mt mu mv b">axios</code>包，然后暂时将它们导入我们的<code class="fe ms mt mu mv b">App.js</code>文件中，直到我们将它们移动到另一个文件中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="7bac" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在上面的代码片段中，我创建了一个方法<code class="fe ms mt mu mv b">fetchData()</code>，它使用Axios发出GET请求。请注意，我在这里使用了<code class="fe ms mt mu mv b">axios.default.baseURL</code>，因为我的应用程序只需要指向一个端点。如果需要使用多个端点，可以创建不同的实例。</p><h1 id="e8fd" class="lv lw iq bd lx ly my ma mb mc mz me mf jw na jx mh jz nb ka mj kc nc kd ml mm bi translated">2.添加状态变量来保存数据、错误和加载状态</h1><p id="8c82" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">现在让我们保存响应数据，错误并通过使用<code class="fe ms mt mu mv b">useState()</code>钩子检查它是否加载。渲染时，我只是临时添加了代码，以便渲染内容。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h1 id="f427" class="lv lw iq bd lx ly my ma mb mc mz me mf jw na jx mh jz nb ka mj kc nc kd ml mm bi translated">3.将逻辑移到一个单独的文件中，创建一个自定义的反作用钩子</h1><p id="166b" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">既然我们知道它在工作，那么让我们把获取逻辑移到一个单独的文件<strong class="kt ir">usexios . js</strong>中，并创建一个自定义的React hook。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="960b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在你的<code class="fe ms mt mu mv b">App.js</code>文件可以这样重构了。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h1 id="01e8" class="lv lw iq bd lx ly my ma mb mc mz me mf jw na jx mh jz nb ka mj kc nc kd ml mm bi translated">4.让钩子充满活力</h1><p id="ebd8" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">到目前为止，我们只使用它来获取帖子，让我们通过将选项传递给钩子来使它更具动态性，这样它就可以根据我们的要求发出请求。为此，让我们将请求参数传递给钩子，并在钩子内使用<code class="fe ms mt mu mv b">axios.request(params)</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="c256" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，因为我们只得到一个对象作为响应，让我们调整<code class="fe ms mt mu mv b">App.js</code>文件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="2c4d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是这个应用程序的最终工作版本。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd mx l"/></div></figure><h1 id="aa05" class="lv lw iq bd lx ly my ma mb mc mz me mf jw na jx mh jz nb ka mj kc nc kd ml mm bi translated">结论</h1><p id="966f" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">我希望创建这个自定义挂钩非常容易。如果您愿意，还可以在此基础上添加定制。您还可以创建Axios的自定义实例，如果您有一个用例来访问不同的端点，就可以使用它们。这里可以引用<a class="ae ln" href="https://github.com/axios/axios#creating-an-instance" rel="noopener ugc nofollow" target="_blank"/>，创建多个实例。我希望这篇文章对你有所帮助。感谢阅读！</p><h2 id="e8e2" class="ne lw iq bd lx nf ng dn mb nh ni dp mf la nj nk mh le nl nm mj li nn no ml np bi translated">参考</h2><div class="nq nr gp gr ns nt"><a href="https://github.com/axios/axios" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">axios/axios</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">基于Promise的浏览器和node . js HTTP客户端新的axios docs网站:单击此处从…</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">github.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh kp nt"/></div></div></a></div><div class="nq nr gp gr ns nt"><a rel="noopener  ugc nofollow" target="_blank" href="/stop-using-the-fetch-api-in-javascript-f3ac14aca026"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">停止在JavaScript中使用Fetch API</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">这就是Axios更好的原因</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="oc l"><div class="oi l oe of og oc oh kp nt"/></div></div></a></div><p id="af13" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="oj">更多内容尽在</em><a class="ae ln" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="oj">plain English . io</em></strong></a></p></div></div>    
</body>
</html>