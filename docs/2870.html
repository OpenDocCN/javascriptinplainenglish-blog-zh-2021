<html>
<head>
<title>WebdriverIO Important Sync Mode Updates</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网络驱动重要同步模式更新</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/webdriverio-important-sync-mode-updates-90f59762949d?source=collection_archive---------6-----------------------#2021-06-11">https://javascript.plainenglish.io/webdriverio-important-sync-mode-updates-90f59762949d?source=collection_archive---------6-----------------------#2021-06-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/1daebf03c5cf4c196f3e3a74b2647b59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SIes1kvsROtnUkzRnfF56w.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk"><a class="ae jz" href="https://youtu.be/Jk6giesyECA" rel="noopener ugc nofollow" target="_blank">https://youtu.be/Jk6giesyECA</a></figcaption></figure><p id="7457" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在本帖中，我们将回顾一些与WebdriverIO同步模式相关的重要更新。我们还将介绍WebdriverIO v8中可能出现的一些变化。但是，在我们开始讨论WebdriverIO同步模式之前，理解WebdriverIO异步模式是如何工作的很重要。</p><h1 id="5020" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">WebdriverIO异步模式</h1><p id="bded" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">默认情况下，WebdriverIO使用异步模式与浏览器或移动设备进行交互。它运行一组异步命令，这些命令通过JavaScript中的<code class="fe mb mc md me b">async/await</code>来处理。然而，使用<code class="fe mb mc md me b">async/await</code>有一些缺点</p><ul class=""><li id="c7b8" class="mf mg in kc b kd ke kh ki kl mh kp mi kt mj kx mk ml mm mn bi translated">那些不熟悉JavaScript或异步编程的人可能会觉得async/await令人困惑</li><li id="b2cc" class="mf mg in kc b kd mo kh mp kl mq kp mr kt ms kx mk ml mm mn bi translated">async/await相当冗长，因为它用于大多数WebdriverIO命令</li></ul><p id="a554" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们看看下面的示例代码——</p><figure class="mu mv mw mx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mt"><img src="../Images/2439149674d932d921c1fdaf1413d845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g98Ix8AHuxHjw-6n"/></div></div></figure><p id="8dbc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里有几件事需要注意——</p><ul class=""><li id="cdd6" class="mf mg in kc b kd ke kh ki kl mh kp mi kt mj kx mk ml mm mn bi translated">我们用async关键字启动“it”块，然后所有命令都使用await关键字，例如在查找元素或单击元素或任何其他WebdriverIO命令时。</li><li id="6ae7" class="mf mg in kc b kd mo kh mp kl mq kp mr kt ms kx mk ml mm mn bi translated">我们也不能将这些函数相互链接，因为那样也会引发错误。相反，需要等待每个单独的命令。</li></ul></div><div class="ab cl my mz hr na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ig ih ii ij ik"><h1 id="037c" class="ky kz in bd la lb nf ld le lf ng lh li lj nh ll lm ln ni lp lq lr nj lt lu lv bi translated">WebdriverIO同步模式</h1><p id="fa94" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">所以为了解决上面的一些问题，WebdriverIO提出了同步模式，并创建了一个<a class="ae jz" href="https://www.npmjs.com/package/@wdio/sync" rel="noopener ugc nofollow" target="_blank"> @wdio/sync插件</a>，它允许你通过<a class="ae jz" href="https://www.npmjs.com/package/fibers" rel="noopener ugc nofollow" target="_blank"> node-fibers </a>同步运行命令。这个插件有以下一些优点</p><ul class=""><li id="c84b" class="mf mg in kc b kd ke kh ki kl mh kp mi kt mj kx mk ml mm mn bi translated">它从代码中去掉了所有的async/await，因为现在命令是同步的</li><li id="e23e" class="mf mg in kc b kd mo kh mp kl mq kp mr kt ms kx mk ml mm mn bi translated">测试看起来更容易阅读和理解(初学者友好)</li></ul><p id="f929" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们看看下面的示例代码——</p><figure class="mu mv mw mx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mt"><img src="../Images/e1fcb1966bbe51422f3bc17813f3bbcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LRCGiP-vOme_chsG"/></div></div></figure><p id="89d3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在上面简化的例子中，您会注意到第二个块中不再有async/await，这对于阅读和理解更加用户友好。</p></div><div class="ab cl my mz hr na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ig ih ii ij ik"><h1 id="3748" class="ky kz in bd la lb nf ld le lf ng lh li lj nh ll lm ln ni lp lq lr nj lt lu lv bi translated">为什么WebdriverIO停止同步模式？</h1><p id="1177" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">WebdriverIO在其网站上发布了一个警告，提到自2021年4月14日起将不再支持同步模式，因为Chromium中的一些突破性<a class="ae jz" href="https://chromium-review.googlesource.com/c/v8/v8/+/2537690" rel="noopener ugc nofollow" target="_blank">变化</a>将不允许使用节点光纤。因此，从Node v16开始，他们将正式停止对WebdriverIO同步模式的支持。</p><p id="21a9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">也就是说，有一个活跃的<a class="ae jz" href="https://github.com/webdriverio/webdriverio/discussions/6702" rel="noopener ugc nofollow" target="_blank"> GitHub线程</a>正在讨论下面列出的可能选项</p><figure class="mu mv mw mx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mt"><img src="../Images/e560611bbce4186abbc7f9e14963482e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lJ5yKHqazPORQi1O"/></div></div></figure><p id="04ac" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">指导委员会最终选择的方案是最后一个接受WebdriverIO将异步向前发展的方案。</p></div><div class="ab cl my mz hr na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ig ih ii ij ik"><h1 id="c64e" class="ky kz in bd la lb nf ld le lf ng lh li lj nh ll lm ln ni lp lq lr nj lt lu lv bi translated">WebdriverIO v8中的代码是什么样子的？</h1><figure class="mu mv mw mx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mt"><img src="../Images/7d1cffa6fd46310ad516b724e0816f91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rw-5w3erdqJaIYyy"/></div></div></figure><p id="d8c5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你将继续使用<code class="fe mb mc md me b">async/await</code>,然而，一个可能发生的主要变化是你将能够链接WebdriverIO命令，这在WebdriverIO v7中是不可能的。这样做的好处是，它会使代码看起来更整洁，更简洁。</p><p id="70e5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">注意:</strong>在撰写本文时，它仍在开发中，因此可能会有一些更新或更改。您可以跟随<a class="ae jz" href="https://github.com/webdriverio/webdriverio/discussions/6702" rel="noopener ugc nofollow" target="_blank">线索</a>获取最新信息。</p></div><div class="ab cl my mz hr na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ig ih ii ij ik"><h1 id="1c31" class="ky kz in bd la lb nf ld le lf ng lh li lj nh ll lm ln ni lp lq lr nj lt lu lv bi translated">您仍然可以使用同步模式</h1><p id="deb3" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">对于那些仍然想使用同步模式的人来说，现在仍然可以这样做。以下是您需要做的事情</p><p id="464e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">检查package.json以查看是否安装了<a class="ae jz" href="https://www.npmjs.com/package/@wdio/sync" rel="noopener ugc nofollow" target="_blank"> @wdio/sync </a>包</p><ul class=""><li id="f184" class="mf mg in kc b kd ke kh ki kl mh kp mi kt mj kx mk ml mm mn bi translated">如果安装了，您可以像往常一样继续使用同步模式</li><li id="c60e" class="mf mg in kc b kd mo kh mp kl mq kp mr kt ms kx mk ml mm mn bi translated">如果没有安装，那么您可以安装该软件包</li><li id="59d1" class="mf mg in kc b kd mo kh mp kl mq kp mr kt ms kx mk ml mm mn bi translated"><code class="fe mb mc md me b">npm i @wdio/sync</code></li></ul><p id="bba7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">注意:</strong> WebdriverIO将继续支持同步模式，直到他们决定放弃对节点v15的支持。从节点v16开始，不再支持同步模式。</p></div><div class="ab cl my mz hr na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ig ih ii ij ik"><h1 id="e087" class="ky kz in bd la lb nf ld le lf ng lh li lj nh ll lm ln ni lp lq lr nj lt lu lv bi translated">我对所有这些变化的看法</h1><p id="5129" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">我知道这将是一个相当大的变化，因为很多人喜欢同步版的WebdriverIO，因为它很简单，就像我一样。但是，我建议您<strong class="kc io">开始为您的新项目</strong>使用异步模式，以避免将来进行任何类型的迁移。</p><p id="5eb5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于那些已经有同步模式项目的人，你需要使用由WebdriverIO团队开发的codemod来完成从同步模式到异步模式的迁移。</p></div><div class="ab cl my mz hr na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ig ih ii ij ik"><h1 id="df9f" class="ky kz in bd la lb nf ld le lf ng lh li lj nh ll lm ln ni lp lq lr nj lt lu lv bi translated">WebdriverIO教程系列</h1><p id="ed1f" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">对于那些在YouTube上关注我的<a class="ae jz" href="https://www.youtube.com/watch?v=e8goAKb6CC0&amp;list=PL6AdzyjjD5HBbt9amjf3wIVMaobb28ZYN" rel="noopener ugc nofollow" target="_blank">web drivero视频系列</a>的人来说，在该系列中，我使用的是同步模式的WebdriverIO v6。因此，您可以通过安装@wdio/sync包来继续使用同步模式，或者决定使用异步模式。</p><p id="56fc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我还将在未来制作视频，展示在WebdriverIO v8发布后如何正确使用异步模式。</p><p id="21a1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">感谢阅读！</p><p id="2b56" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="nk">更多内容请看</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="nk">plain English . io</em></a></p></div></div>    
</body>
</html>