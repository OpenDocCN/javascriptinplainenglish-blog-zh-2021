<html>
<head>
<title>How to Record Audio using React Native Expo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用React Native Expo录制音频</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-record-audio-using-react-native-expo-74723d2358e3?source=collection_archive---------2-----------------------#2021-08-01">https://javascript.plainenglish.io/how-to-record-audio-using-react-native-expo-74723d2358e3?source=collection_archive---------2-----------------------#2021-08-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="c021" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用React Native Expo为Android和iOS设备录制音乐的JavaScript代码。</h2></div><p id="b6cd" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您好，React原生开发者！</p><p id="3913" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当你在做一个项目，你想让用户用手机录制他们的音频，那么你必须知道如何在开发过程中把这个特性添加到你的移动应用程序中。我们被这种你可以录制音频的应用所包围。最常见的例子是脸书、Instagram和各种录音应用。因此，在这里，我们将看到如何使用React Native Expo录制音频。坐下，喝杯咖啡，我们开始吧。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/04149b1509614324086a9beb7f969c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lTMBegfs-cGWEezv"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Photo by <a class="ae lo" href="https://unsplash.com/@emilep?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Emile Perron</a> on <a class="ae lo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="979a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您正在寻找视频教程，那么它就在这里:</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="lp lq l"/></div></figure><h1 id="dbab" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">设置和安装</h1><p id="8c94" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">1.创建一个目录并导航到它。</p><p id="71bd" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">2.打开该目录下的终端或命令提示符，执行命令:<code class="fe mo mp mq mr b"><strong class="ke io">expo init Music</strong></code></p><p id="e48d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">3.选择空白模板并继续下载。</p><p id="2cf1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">4.导航到目录“音乐”</p><p id="e622" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">5.使用命令:<code class="fe mo mp mq mr b"><strong class="ke io">npm install expo-av</strong></code> <br/>安装一个包在完成上述所有步骤后，您会看到类似这样的内容</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/652bcad161a204b1e21d989f1e0f144c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*CheJu_RBnLMaKWVv.png"/></div></figure><p id="6908" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们已经完成了这里的设置和安装。现在在文本编辑器中打开这个项目。对了，我更喜欢VS代码。</p><h1 id="adbc" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">记录系统代码</h1><p id="bc3a" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated"><strong class="ke io"> App.js </strong></p><pre class="kz la lb lc gt mt mr mu mv aw mw bi"><span id="3640" class="mx ls in mr b gy my mz l na nb">import * as React from 'react';<br/>import { Text, View, StyleSheet, Button } from 'react-native';<br/>import { Audio } from 'expo-av';</span><span id="ed0e" class="mx ls in mr b gy nc mz l na nb">const [recording, setRecording] = React.useState();</span><span id="b9a9" class="mx ls in mr b gy nc mz l na nb">async function startRecording() {<br/>    try {<br/>      console.log('Requesting permissions..');<br/>      await Audio.requestPermissionsAsync();<br/>      await Audio.setAudioModeAsync({<br/>        allowsRecordingIOS: true,<br/>        playsInSilentModeIOS: true,<br/>      }); <br/>      console.log('Starting recording..');<br/>      const recording = new Audio.Recording();<br/>      await recording.prepareToRecordAsync(Audio.RECORDING_OPTIONS_PRESET_HIGH_QUALITY);<br/>      await recording.startAsync(); <br/>      setRecording(recording);<br/>      console.log('Recording started');<br/>    } catch (err) {<br/>      console.error('Failed to start recording', err);<br/>    }<br/>  }</span></pre><p id="033b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们正在使用react hooks概念。这里我们创建了一个异步函数startRecording()，在这个函数中，我们首先从android或ios设备请求许可。在用户允许权限之后，进一步的过程将会工作。我们使用控制台日志，以便您可以在终端中看到运行状态。我们将录音质量设置为高。以上代码是针对如何开始录音的。现在，让我们看看如何在react native expo中停止录制。</p><pre class="kz la lb lc gt mt mr mu mv aw mw bi"><span id="d8d6" class="mx ls in mr b gy my mz l na nb">async function stopRecording() {<br/>    console.log('Stopping recording..');<br/>    setRecording(undefined);<br/>    await recording.stopAndUnloadAsync();<br/>    const uri = recording.getURI(); <br/>    console.log('Recording stopped and stored at', uri);<br/>  }</span></pre><p id="1b14" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里我们首先在控制台记录停止记录和停止记录。停止录制后，您必须知道录制的位置。这就是为什么我们在记录停止后记录位置的原因。现在只做一个简单的UI进行测试。</p><pre class="kz la lb lc gt mt mr mu mv aw mw bi"><span id="7231" class="mx ls in mr b gy my mz l na nb">return (<br/>    &lt;View style={styles.container}&gt;<br/>      &lt;Button<br/>        title={recording ? 'Stop Recording' : 'Start Recording'}<br/>        onPress={recording ? stopRecording : startRecording}<br/>      /&gt;<br/>    &lt;/View&gt;<br/>  );</span></pre><p id="df98" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">做一点造型</p><pre class="kz la lb lc gt mt mr mu mv aw mw bi"><span id="b480" class="mx ls in mr b gy my mz l na nb">const styles = StyleSheet.create({<br/>  container: {<br/>    flex: 1,<br/>    justifyContent: 'center',<br/>    backgroundColor: '#ecf0f1',<br/>    padding: 10,<br/>  },<br/>});</span></pre><p id="1991" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们已经完成了这里的编码部分。现在打开终端或命令提示符，使用命令运行服务器:npm start <br/>打开expo app，扫描二维码。按下开始录制按钮后，会弹出一个请求许可的屏幕。允许所请求的许可。相应地开始和停止录制。现在看到你的命令提示符或终端，你会看到录音的位置。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/784de0bcd539a7d45a10d48c74698245.png" data-original-src="https://miro.medium.com/v2/resize:fit:368/format:webp/0*0HaKGn3iUNb_kcIS.jpg"/></div></figure><p id="aa34" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如有疑问，请点击此处查看<a class="ae lo" href="https://github.com/imrohit007/Recording-Audio-in-React-Native-Expo" rel="noopener ugc nofollow" target="_blank"> Github代码</a>。</p><p id="0e1a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">谢谢你。</p><p id="eab7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ne">更多内容看</em> <a class="ae lo" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="ne">说白了. io </em> </strong> </a> <strong class="ke io"> <em class="ne">。</em> </strong> <em class="ne">报名参加我们的</em> <a class="ae lo" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="ne">免费每周简讯点击这里</em> </strong> </a> <strong class="ke io"> <em class="ne">。</em> </strong></p></div></div>    
</body>
</html>