<html>
<head>
<title>Adding Dark Mode support to React website</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向React网站添加黑暗模式支持</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/reactjs-grommet-dark-mode-90cf5aafc5cb?source=collection_archive---------15-----------------------#2021-03-10">https://javascript.plainenglish.io/reactjs-grommet-dark-mode-90cf5aafc5cb?source=collection_archive---------15-----------------------#2021-03-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="b526" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是一个现代世界，在网络浏览器中支持黑暗模式应该很容易。有了这个想法，我决定在我的网站上添加黑暗模式支持。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b5555d6bdf4eee61010700c80fcda476.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IByO3ZUruYn03ZhRPndPSQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">A screenshot of a website <a class="ae ky" href="http://psycholog.help" rel="noopener ugc nofollow" target="_blank">psycholog.help</a> with Dark Mode enabled</figcaption></figure><h1 id="b91c" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">反应&gt;索环&gt;黑暗模式</h1><p id="6fb0" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">几年前，我用<a class="ae ky" href="https://www.typescriptlang.org" rel="noopener ugc nofollow" target="_blank">打字稿</a> + <a class="ae ky" href="https://reactjs.org" rel="noopener ugc nofollow" target="_blank">反应</a> + <a class="ae ky" href="https://v2.grommet.io" rel="noopener ugc nofollow" target="_blank">索环</a>组合创建了这个网站。这个Grommet React框架对我来说非常好:它提供了一个易于使用的布局系统，并且足够可定制(除了模态视图，这是一个不同的故事)。</p><blockquote class="mc md me"><p id="8092" class="jk jl mf jm b jn jo jp jq jr js jt ju mg jw jx jy mh ka kb kc mi ke kf kg kh ig bi translated"><a class="ae ky" href="https://v2.grommet.io" rel="noopener ugc nofollow" target="_blank"> Grommet </a>是React网站的设计和布局框架。</p></blockquote><p id="207e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本文中，我们将展示如何为React网站或应用程序实现黑暗模式支持。我用的是Typescript，但是如果你也懂JS的话，你就能理解代码了。如果使用另一个框架，可以跳过关于Grommet集成的第一部分——本文的其余部分给出了足够的细节来实现这种支持。</p><p id="63ff" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">是时候添加黑暗模式(或者称为夜间模式)支持了。所有最新版本的常用浏览器都支持它，对于一个网站来说，尊重用户的选择是一个好的基调，或者有人会说是必要的。</p></div><div class="ab cl mj mk hr ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ig ih ii ij ik"><h1 id="6824" class="kz la in bd lb lc mq le lf lg mr li lj lk ms lm ln lo mt lq lr ls mu lu lv lw bi translated">索环支持黑暗模式</h1><p id="f97a" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">当然，在理想世界中，我们会在自己选择的设计框架中使用这一功能。不幸的是，我们还没有做到这一点，索环决定默认不支持系统黑暗模式。相反，它支持颜色主题。这已经是很大的胜利了。对于<strong class="jm io"> theme.json </strong>文件中的每一种颜色，我们可以设置亮版本和暗版本的值。比方说，我想有一个亮模式的白色背景和暗模式的深灰色背景。为此，我用下面的代码更新了主题文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Setting different colors for dark and light modes in Grommet</figcaption></figure><p id="b9b4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果我们在那之后更改应用程序声明中的<code class="fe mx my mz na b">themeMode</code>——整个站点外观将变为黑色。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Using themeMode parameter in Grommet to pick dark theme</figcaption></figure><h1 id="516b" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">JS和CSS中的黑暗模式支持</h1><p id="1cfb" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">你可能已经找到了很多关于如何检测系统中是否启用了黑暗模式的文章，这些文章确实非常有用。其实我也用过，下面是总结。</p><p id="e911" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您可以在CSS 中添加<strong class="jm io">媒体查询，并为网站的亮暗模式指定不同的外观。然后，浏览器会使用系统设置来确定模式并更改您的网站外观。看，这是默认背景:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Setting website color for light mode</figcaption></figure><p id="0328" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是黑暗模式的调整版本:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Using black color as a website background in dark mode</figcaption></figure><p id="2a6e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">在JavaScript </strong>中，我们使用相同的媒体查询，但只是使用JS API。首先，我们为黑暗模式创建一个匹配:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Using media query match to retrieve dark mode system setting in JS</figcaption></figure><p id="9b72" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后在需要时检索该值:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Checking dark mode value using media query match</figcaption></figure><p id="77b1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此外，JavaScript允许我们使用listener观察值的变化:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Receiving dark mode changes using event listener</figcaption></figure></div><div class="ab cl mj mk hr ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ig ih ii ij ik"><h1 id="53ca" class="kz la in bd lb lc mq le lf lg mr li lj lk ms lm ln lo mt lq lr ls mu lu lv lw bi translated">React中的黑暗模式支持</h1><p id="fb8d" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">你可能已经知道我们要去哪里了。让我们应用React中有史以来最强大的技术——钩子。这将是一个简单的<strong class="jm io"> React钩子</strong>，返回我们当前得到的是暗模式还是亮模式。当模式更改时，属性应反映更改，相关组件将重新呈现。</p><blockquote class="mc md me"><p id="d128" class="jk jl mf jm b jn jo jp jq jr js jt ju mg jw jx jy mh ka kb kc mi ke kf kg kh ig bi translated">未知模式被视为一个轻模式，因为为什么不</p></blockquote><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">React Hook returning if the dark mode is enabled in the system settings or not</figcaption></figure><p id="0e50" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">嗯，这是一个很短的方法，不是吗，但是看看里面有多少复杂的东西。我在代码中添加了一些注释，这样每个人都可以安全地进行到这一步。</p><h1 id="2081" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">将这种Ract钩与索环结合在一起</h1><p id="022f" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">因此，这可能是有史以来最短的代码更改。可以使用新创建的react钩子，而不是手动指定索环中的<code class="fe mx my mz na b">themeMode</code>。在3，2，1 …中用<code class="fe mx my mz na b">useDarkMode</code>替换<code class="fe mx my mz na b">“dark”</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Using Dark Mode React Hook from Grommet to change the website appearance</figcaption></figure><p id="3bc2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">瞧，我们的网站现在支持黑暗模式🥳党的时间。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/817a1e7b1f260188fa646d51d5d91acb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5B7j5_umFVRvQ8EBJyM4tw.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Changing the system appearance between Light and Dark</figcaption></figure><h1 id="7bc9" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">警告</h1><p id="6fa1" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">当你在那里享受新鲜知识的时候。我试了一下代码，iOS 13 safari需要特殊处理。</p><blockquote class="mc md me"><p id="a3dd" class="jk jl mf jm b jn jo jp jq jr js jt ju mg jw jx jy mh ka kb kc mi ke kf kg kh ig bi translated">这是很重要的一部分</p></blockquote><p id="58ab" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mx my mz na b">addEventListener</code>和<code class="fe mx my mz na b">removeEventListener</code>在一些较老的浏览器中不受支持(比如iOS 13的Safari)。我们需要在那里使用<code class="fe mx my mz na b">addListener</code>和<code class="fe mx my mz na b">removeListener</code>来代替。</p><p id="d84b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了完成我的网站，我使用了一些额外的CSS样式来:</p><ol class=""><li id="38da" class="nc nd in jm b jn jo jr js jv ne jz nf kd ng kh nh ni nj nk bi translated">消除阴影——夜晚没有阴影(除非你的设计中有一个月亮，但不是我的情况)</li><li id="cd9f" class="nc nd in jm b jn nl jr nm jv nn jz no kd np kh nh ni nj nk bi translated">更新突出显示状态的工作方式</li></ol></div><div class="ab cl mj mk hr ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ig ih ii ij ik"><p id="aaca" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一些网站为用户提供了一种特殊的设置，可以在不改变系统外观的情况下在暗模式和亮模式之间切换。你可能也想这么做，这不是火箭科学，有很多关于这方面的文章。但是首先要看一些指南，或者检查一下移动应用程序是如何工作的。一个应用程序提供单独的主题调整方式是非常罕见的。从设计的角度考虑一下。你希望你的用户专注于网站内容还是用一些设置分散他们的注意力？有时候开发者需要控制提供大量设置的冲动，因为他们可以设计最好的用户体验。</p><p id="a001" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">无论如何，享受你的时间玩反应🖖</p></div></div>    
</body>
</html>