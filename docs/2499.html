<html>
<head>
<title>How to Build an Analog Clock Using Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用钩子构建模拟时钟</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-build-an-analog-clock-using-hooks-f33adf51ed9f?source=collection_archive---------4-----------------------#2021-05-23">https://javascript.plainenglish.io/how-to-build-an-analog-clock-using-hooks-f33adf51ed9f?source=collection_archive---------4-----------------------#2021-05-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/775aa30a1ce204bfcea29e84e5d85eb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Zi7vcYQmVxSFAKHNaoTgw.png"/></div></div></figure><p id="a028" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">想用模拟时钟来分类吗？嗯，你来对地方了。在本文中，我们将研究一种使用功能组件在React中构建简单模拟时钟的方法。作为奖励，我们还将为那些有不同程度计算障碍的人制作一个数字钟。</p><p id="f666" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们首先在一个名为Clock.js的新文件中构建一个功能组件。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/c0cfd3e5358a84a2e98004367fd6b4ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*m3mb-Cm5AVU9T7nEwdDWiA.png"/></div></figure><p id="5cea" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在让我们在JSX建造时钟。在这里，我们将把时钟的每个部分分配给一个容器。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/e010a7e59dc9216d73e0c2103063fc3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*aR3bgNxVYJR2FiLqZwHj5A.png"/></div></figure><p id="1552" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后，我们将设计每个容器的样式，使一切更像时钟。在这里，你可以尽情发挥创造力。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/ae22ebb4b1de63b2c29be0df7d3bebc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*QTDnur9Xe_0mWTukAOwceQ.png"/></div></figure><p id="09fb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们有了一个看起来有点像模拟时钟的东西！嗯，这又快又简单，感谢阅读！…要是有那么简单就好了！</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi la"><img src="../Images/16490f9b886d575212bc3c13ef01d3c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*waFQG3-St3ibx-Oy3JL-9Q.gif"/></div></figure><p id="010d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在是有趣的事情。让那些手动起来！和所有事情一样，我相信有很多方法可以解决这个问题。我决定用<code class="fe lb lc ld le b">useEffect,</code>和<code class="fe lb lc ld le b">setState </code>钩子来解决这个特殊的问题。</p><p id="d1eb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">通过创建一个“时间”状态变量，并将其设置为对<code class="fe lb lc ld le b">useEffect</code>的依赖，我们能够在每次“时间”改变时运行<code class="fe lb lc ld le b">useEffect </code>钩子。在我们的<code class="fe lb lc ld le b">useEffect</code>钩子中，我们可以设置一个间隔来每秒更新我们的状态变量“时间”。这样，我们将渲染我们的时钟组件，这将更新我们的“时间”变量，这将导致<code class="fe lb lc ld le b">useEffect </code>运行并重新渲染我们的时钟组件，这将更新我们的“时间”变量，这将导致<code class="fe lb lc ld le b">useEffect </code>运行并重新渲染我们的时钟组件，这将更新我们的“时间”变量…您明白了吧。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/7fb9570c0941d19e1e229bed8965cc55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*yTpmdjluoQ1fPqqDLpmaMQ.png"/></div></figure><p id="e5e6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了确保我们没有任何内存泄漏，我们需要在每次迭代中清理我们的<code class="fe lb lc ld le b">useEffect</code>钩子。为此，我们可以简单地返回一个函数，清除我们设置的间隔。</p><p id="3460" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">厉害！现在，我们的“时间”变量每秒都在更新正确的时间。让我们利用这些信息来调整时钟。</p><p id="ee49" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将从在我们的<code class="fe lb lc ld le b">useEffect</code>钩子中设置一些变量开始。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/25bfceb6771b1796092fe60c026442c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*SLG0HqpFiZbuTZs1AmiJpA.png"/></div></figure><p id="b2f0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">由于我们的“时间”状态变量是一个<code class="fe lb lc ld le b">Date</code>对象，我们可以访问一些有用的方法。这里我们将使用<code class="fe lb lc ld le b">getSeconds()</code>、<code class="fe lb lc ld le b">getMinutes()</code>和<code class="fe lb lc ld le b">getHours()</code>。我认为它们都是不言自明的。为了确保分钟总是以两位数显示，我们可以在<code class="fe lb lc ld le b">getminutes()</code>之后调用<code class="fe lb lc ld le b">toLocalString</code>，并包含可选参数<code class="fe lb lc ld le b">minimumIntegerDigits</code>。如果你不打算增加数字钟，这并不重要。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lh"><img src="../Images/c6e95dde32d512f2b64a5a15aaa2f94b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*czTXUBed_ZCUktLTrXH3FA.png"/></div></div></figure><p id="b851" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">类似地，如果您不打算使用数字钟，您可以将保存您的小时数的变量设置为<code class="fe lb lc ld le b">time.getHours()</code>。因为我想要一个数字时钟来伴随我的模拟时钟，我需要建立一个函数来将24小时时间转换为12小时时间。这基本上只是说，如果小时数小于12，则将时间设置为“am”。如果小时大于12，则从数字中减去12，并将时间设置为“pm”。如果小时为0，则将小时设置为12。对于我们这些更习惯于12小时时间的人来说，这使得一切都容易阅读。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi li"><img src="../Images/a7ce4030d45568541ca3bfa679d09486.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1H3DTDYFkbcg4CMX_C8QGQ.png"/></div></div></figure><p id="0f51" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以我们得到当前时间，每秒更新一次，我们把时间分解成秒、分和小时。数学时间到了！</p><p id="cb4d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，让我们抓住所有的时钟指针，并将它们设置为语义变量。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/b55b732ecd6121f5357119ac38b8a53f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*nUIm7_D9gUxMl5xd-P2Uzw.png"/></div></figure><p id="e1ff" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">很好！现在我们可以根据时间改变每手牌的风格。通过设置<code class="fe lb lc ld le b">useEfftect</code>中的style属性，每次<code class="fe lb lc ld le b">useEffect</code>运行时(每秒)都会更新一次。因此，为了让指针根据当前时间旋转它们的位置，我们可以这样设置transform属性。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lk"><img src="../Images/71035b7b61ebcfd509378e6ae98f2f4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ex5n4GTVBENOKV5J-BX7GA.png"/></div></div></figure><p id="6837" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">重要:</strong>如果你还记得，在我们的。CSS文件，在<code class="fe lb lc ld le b">.hand</code>下，我们将变换原点设置为“中上”。这将我们的变形点(我们将要旋转的点)设置为…你猜对了…手的顶部中心。如果设置不正确，指针将无法正确定位！</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/c03866ac24564dd1d6ebf0c999fb5a7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*22YkFydao_T1Unf_LI3u3w.png"/></div></figure><p id="e87d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">就是这样！我们现在有了一个正常工作的模拟时钟！要添加它的数字副本，我们只需添加一个“数字”容器，设置内部HTML来显示小时:分钟，以及它是“上午”还是“下午”。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lm"><img src="../Images/a57eaa1fa2d40a41192cbe9043f1e4e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ILbjIQNuUslu0A4cauOGw.png"/></div></div></figure><p id="ca04" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">模拟时钟可以增加风格，它们可以如你所愿地复杂或简单…想想数字、小时/分钟标记、日期、星期几。这只是一个起点。从中获得乐趣，并发挥创造力。编码快乐！</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ln"><img src="../Images/e642a1913f33f62b1ae9e09e9f523441.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*WB4y5Jw7ArCsotMe8oCetg.gif"/></div></div></figure><p id="ad54" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="lo">更多内容请看</em><a class="ae lp" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="lo">plain English . io</em></a></p></div></div>    
</body>
</html>