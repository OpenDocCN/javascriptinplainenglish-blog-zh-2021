<html>
<head>
<title>Integrating SAWO Labs Authentication + Create React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">集成SAWO实验室认证+创建React应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/integrating-sawo-labs-authentication-create-react-app-4601360fd5d0?source=collection_archive---------13-----------------------#2021-07-04">https://javascript.plainenglish.io/integrating-sawo-labs-authentication-create-react-app-4601360fd5d0?source=collection_archive---------13-----------------------#2021-07-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/f33bd10858bde4c480c2d5a8daf68baf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EkhSO88KFZ1rzQ0IEDuzgA.jpeg"/></div></div></figure><p id="7356" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你好。我正在使用SAWO Labs构建一个简单的身份验证应用程序。在这个过程中，我发现有必要了解比官方文档所提供的更多的内容。</p><p id="4dca" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是一个简短的演练，帮助您将SAWO Labs身份验证与React应用程序集成。</p><p id="79d7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现场代码的视频版本将会出现在我的Youtube上</p><h1 id="2957" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">在我们的小应用中:</h1><ul class=""><li id="9f8d" class="ls lt in jx b jy lu kc lv kg lw kk lx ko ly ks lz ma mb mc bi translated">我们将有一个登录页面。</li><li id="2f19" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">我们将有一个仪表板页面。</li><li id="0d53" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">只有经过身份验证的用户才能进入仪表板页面。</li><li id="2f1c" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">我们将使用VSCode，NPM作为我们的包管理器。</li></ul><h1 id="8080" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">我们开始吧</h1><ul class=""><li id="36fa" class="ls lt in jx b jy lu kc lv kg lw kk lx ko ly ks lz ma mb mc bi translated">你需要一个SAWO Labs账户来使用这个很棒的东西。前往<a class="ae kt" href="https://sawolabs.com" rel="noopener ugc nofollow" target="_blank">sawolabs.com</a>创建你的第一个项目，如果你选择本地开发，将主机设置为<code class="fe mi mj mk ml b">localhost</code>。否则，您可以将Host设置为您的应用程序URL。</li><li id="a2ef" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">您可以使用CodeSandbox React模板，或者如果您在本地执行，请使用以下命令:<code class="fe mi mj mk ml b">npx create-react-app client</code>。</li><li id="9f2c" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">10分钟后…</li><li id="172e" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">我们需要在我们的<code class="fe mi mj mk ml b">node_modules</code>中有SAWO labs包。所以到终端，确保你已经输入了<code class="fe mi mj mk ml b">cd client</code>并运行下面的命令来安装SAWO包:<code class="fe mi mj mk ml b">npm i sawo</code>。</li><li id="8f14" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">一旦软件包安装完毕，您将前往<code class="fe mi mj mk ml b">src/app.js</code>。</li><li id="6c9d" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">通过删除不必要的代码来清理文件，src/app.js的最终外观应该如下所示:</li></ul><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="5708" class="mu kv in ml b gy mv mw l mx my">/* src/app.js */</span><span id="7a7b" class="mu kv in ml b gy mz mw l mx my">import React from "react";<br/>import "./App.css";<br/>function App() {<br/>  return (<br/>    &lt;div id="App"&gt;</span><span id="a8f5" class="mu kv in ml b gy mz mw l mx my">    &lt;/div&gt;<br/>  );<br/>}</span><span id="bbe4" class="mu kv in ml b gy mz mw l mx my">export default App;</span></pre><ul class=""><li id="785f" class="ls lt in jx b jy jz kc kd kg na kk nb ko nc ks lz ma mb mc bi translated">让我们导入SAWO包。</li></ul><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="0a30" class="mu kv in ml b gy mv mw l mx my">import React from "react";<br/>import "./App.css";<br/>import Sawo from "sawo";</span></pre><ul class=""><li id="7bf1" class="ls lt in jx b jy jz kc kd kg na kk nb ko nc ks lz ma mb mc bi translated">在<code class="fe mi mj mk ml b">.env.local</code>文件中保存您的API密匙，并确保您已经在<code class="fe mi mj mk ml b">.gitignore</code>中添加了它。<code class="fe mi mj mk ml b">.env.local</code>文件应该是这样的:</li></ul><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="bb95" class="mu kv in ml b gy mv mw l mx my">REACT_APP_API_SAWO=11example1-821fexampled23-19830-318example2312</span></pre><ul class=""><li id="102a" class="ls lt in jx b jy jz kc kd kg na kk nb ko nc ks lz ma mb mc bi translated">让我们前往<code class="fe mi mj mk ml b">src/app.js</code>。基于此处文件<a class="ae kt" href="https://docs.sawolabs.com/sawo/frameworks/react" rel="noopener ugc nofollow" target="_blank">中的第5点。我们的文件最终应该是这样的。</a></li></ul><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="f836" class="mu kv in ml b gy mv mw l mx my">/* src/app.js */</span><span id="6928" class="mu kv in ml b gy mz mw l mx my">import React from "react";<br/>import logo from "./logo.svg";<br/>import "./App.css";<br/>import Sawo from "sawo";<br/>function App() {<br/>   return (<br/>         &lt;div<br/>          id="sawo-container"<br/>          style={{ height: "300px", width: "300px" }}<br/>        &gt;&lt;/div&gt;<br/>  );<br/>}</span><span id="e297" class="mu kv in ml b gy mz mw l mx my">export default App;</span></pre><ul class=""><li id="3f41" class="ls lt in jx b jy jz kc kd kg na kk nb ko nc ks lz ma mb mc bi translated">恭喜你，但是如果你在浏览器上查看你的申请，我们会得到一个空白，什么都没有。现在是时候调用SDK了！:)</li></ul><h2 id="e4cf" class="mu kv in bd kw nd ne dn la nf ng dp le kg nh ni li kk nj nk lm ko nl nm lq nn bi translated">关键点</h2><p id="faec" class="pw-post-body-paragraph jv jw in jx b jy lu ka kb kc lv ke kf kg no ki kj kk np km kn ko nq kq kr ks ig bi translated">当id为<code class="fe mi mj mk ml b">sawo-container</code>的<code class="fe mi mj mk ml b">div</code>被渲染时，我们需要调用SDK。所以我们将使用<code class="fe mi mj mk ml b">React.useEffect()</code>钩子来满足文件<code class="fe mi mj mk ml b">src/app.js</code>中的这个条件。</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="67c4" class="mu kv in ml b gy mv mw l mx my">/* src/app.js */</span><span id="d341" class="mu kv in ml b gy mz mw l mx my">import React from "react";<br/>import logo from "./logo.svg";<br/>import "./App.css";<br/>import Sawo from "sawo";<br/>function App() {<br/></span><span id="33ea" class="mu kv in ml b gy mz mw l mx my">/*<br/>This makes sure when the component is rendered, <br/>it is called only once.<br/>*/<br/>React.useEffect(() =&gt; { }, []); <br/></span><span id="a0db" class="mu kv in ml b gy mz mw l mx my"> return (<br/>         &lt;div<br/>          id="sawo-container"<br/>          style={{ height: "300px", width: "300px" }}<br/>        &gt;&lt;/div&gt;<br/>  );<br/>}</span><span id="31d0" class="mu kv in ml b gy mz mw l mx my">export default App;</span></pre><ul class=""><li id="79ee" class="ls lt in jx b jy jz kc kd kg na kk nb ko nc ks lz ma mb mc bi translated">是时候为SAWO认证写配置了，正如在他们的文档<a class="ae kt" href="https://docs.sawolabs.com/sawo/frameworks/react" rel="noopener ugc nofollow" target="_blank">这里</a>的第6点中所讨论的。我们将把它放在<code class="fe mi mj mk ml b">useEffect</code>钩子里面。为什么？因为我们希望在组件安装到屏幕上之后执行这个操作。</li><li id="b2a0" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">准备好配置后，我们将使用<code class="fe mi mj mk ml b">config</code>创建一个新的SAWO实例，并执行<code class="fe mi mj mk ml b">showForm</code>方法。最后，<code class="fe mi mj mk ml b">useEffect</code>看起来是这样的:</li></ul><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="deaa" class="mu kv in ml b gy mv mw l mx my">React.useEffect(() =&gt; {<br/>  var config = {<br/>      containerID: "sawo-container",<br/>      identifierType: "email",<br/>      apiKey: process.env.REACT_APP_API_SAWO,<br/>      onSuccess: (payload) =&gt; {<br/>        console.log(payload); <br/>      },<br/>    };<br/>    let sawo = new Sawo(config);<br/>    sawo.showForm();<br/> }, []);</span></pre><ul class=""><li id="48e0" class="ls lt in jx b jy jz kc kd kg na kk nb ko nc ks lz ma mb mc bi translated">让我们来看看浏览器上的应用程序。现在，您应该注意到SAWO身份验证要求您提供电子邮件id。:)</li></ul><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/8b78600c7945ac57e8bad99a5370304e.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/0*au6jEbzKxo6BuonC"/></div></figure><h1 id="cf57" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">仪表板连接。</h1><ul class=""><li id="3025" class="ls lt in jx b jy lu kc lv kg lw kk lx ko ly ks lz ma mb mc bi translated">我们将创建一个文件<code class="fe mi mj mk ml b">src/Dashboard.js</code>，看起来像这样。</li></ul><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="93a9" class="mu kv in ml b gy mv mw l mx my">import React from "react";</span><span id="be07" class="mu kv in ml b gy mz mw l mx my">const Dashboard = (props) =&gt; {</span><span id="053b" class="mu kv in ml b gy mz mw l mx my">  return (<br/>    &lt;&gt;<br/>       &lt;h2&gt;Private Dashboard&lt;/h2&gt;<br/>        Email: {props.payload.identifier}<br/>    &lt;/&gt;<br/>  );<br/>};</span><span id="2d7f" class="mu kv in ml b gy mz mw l mx my">export default Dashboard;</span></pre><p id="fc0c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">转至<code class="fe mi mj mk ml b">src/app.js</code>，我们将执行以下操作:</p><ul class=""><li id="e141" class="ls lt in jx b jy jz kc kd kg na kk nb ko nc ks lz ma mb mc bi translated">我们需要在应用程序中导入我们的仪表板组件。</li><li id="31c4" class="ls lt in jx b jy md kc me kg mf kk mg ko mh ks lz ma mb mc bi translated">我们需要创建一个状态，在用户通过身份验证后存储有效负载。</li></ul><p id="8f95" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们开始吧。</p><pre class="mm mn mo mp gt mq ml mr ms aw mt bi"><span id="76e0" class="mu kv in ml b gy mv mw l mx my">/* src/app.js */</span><span id="eb6f" class="mu kv in ml b gy mz mw l mx my">import React from "react";<br/>import logo from "./logo.svg";<br/>import "./App.css";</span><span id="7efc" class="mu kv in ml b gy mz mw l mx my">/* This imports Dashboard Component*/<br/>import Dashboard from './dashboard'</span><span id="72b5" class="mu kv in ml b gy mz mw l mx my">import Sawo from "sawo";<br/>function App() {</span><span id="11f4" class="mu kv in ml b gy mz mw l mx my">/* We are creating a state, using the useState hook. */</span><span id="b7a7" class="mu kv in ml b gy mz mw l mx my">let [payload, setPayload] = React.useState(false);</span><span id="086e" class="mu kv in ml b gy mz mw l mx my">/*<br/>This makes sure when the component is rendered, <br/>it is called only once.<br/>*/<br/>React.useEffect(() =&gt; {<br/>  var config = {<br/>      containerID: "sawo-container",<br/>      identifierType: "email",<br/>      apiKey: process.env.REACT_APP_API_SAWO,<br/>      onSuccess: (payload) =&gt; {<br/>        // console.log(payload); <br/>        setPayload(payload)<br/>      },<br/>    };<br/>    let sawo = new Sawo(config);<br/>    sawo.showForm();<br/> }, []); <br/></span><span id="dea8" class="mu kv in ml b gy mz mw l mx my"> return (&lt;&gt;<br/>         &lt;div<br/>          id="sawo-container"<br/>          style={{ height: "300px", width: "300px" }}<br/>        &gt;&lt;/div&gt;<br/>        {payload &amp;&amp; (<br/>        &lt;&gt;<br/>          &lt;Dashboard payload={payload} /&gt;<br/>        &lt;/&gt;<br/>        )}<br/>&lt;/&gt;<br/>  );<br/>}</span><span id="b2cb" class="mu kv in ml b gy mz mw l mx my">export default App;</span></pre><p id="b726" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">仅此而已。希望你喜欢阅读这篇文章。<br/>你可以通过<a class="ae kt" href="https://twitter.com/imabptweets" rel="noopener ugc nofollow" target="_blank"> Twitter </a>联系我</p><p id="376a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="ns">更多内容请看</em><a class="ae kt" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="ns">plain English . io</em></strong></a></p></div></div>    
</body>
</html>