<html>
<head>
<title>How I Maintain a Unique Set of HTML Ids with JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何用JavaScript维护一组独特的HTML Ids</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-i-maintain-a-unique-set-of-ids-in-javascript-3f06af71ab1b?source=collection_archive---------9-----------------------#2021-02-26">https://javascript.plainenglish.io/how-i-maintain-a-unique-set-of-ids-in-javascript-3f06af71ab1b?source=collection_archive---------9-----------------------#2021-02-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/3be0d2efe8c31bf9f3eda6917651df83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wYqcyH0_vOVri6EF"/></div></div></figure><p id="5086" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">管理一个应用程序的大量惟一id是非常令人畏惧的，尤其是当应用程序增长和扩展时。HTML元素id是一个完美的例子，因为它们通常分散在许多文件中，很少协调。当更多的开发人员加入进来时，错误报告就不再是“是否”的问题，而是“何时”的问题。</p><p id="bcf8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我最近的一个用例是在<a class="ae kt" href="https://www.cypress.io/" rel="noopener ugc nofollow" target="_blank"> Cypress </a>中跟踪测试id。Cypress的标准惯例是给HTML元素添加一个“data-cy”属性，这样在编写测试时就可以很容易地选择它们。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="3a29" class="ld le in kz b gy lf lg l lh li">&lt;button data-cy="my-button"&gt;Click&lt;/button&gt;</span></pre><p id="9219" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这很好，但是正如我已经提到的，随着应用程序的扩展，管理和跟踪这些Cypress测试id会很快变得难以处理。拥有重复的id会在编写其他测试时导致错误，并且失败测试的原因可能并不明显。这可能导致浪费的检测和调试工作。然而，通过一个数组和一个简单的测试，我们可以很容易地解决这个问题。</p><h1 id="d168" class="lj le in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">追踪身份证</h1><p id="b00e" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">为了让这个过程工作，我们需要保存一个包含所有惟一id的数组。下面你会看到一组柏树身份证的例子。</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="97be" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在我的代码中向HTML元素添加“data-cy”属性时，我也需要将它添加到这个数组中。我将我的文件命名为CyIds.ts，但是您可以随意命名它。这个数组本质上不会阻止我们添加重复的id，但是通过我提到的简单测试，我们可以毫不费力地捕捉重复的id。</p><p id="3119" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">(如果有人建议如何从src文件夹中提取‘data-cy’属性值，并在VSCode中用这个数组生成一个文件，那将是一个巨大的帮助)。</p><h1 id="36a1" class="lj le in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">编写测试</h1><p id="73da" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">现在我们保存了一个id数组，让我们编写一个简单的测试，如果有重复的id，这个测试就会失败。</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="dbcc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">通过对数组进行排序，我们的测试可以通过用它的下一个邻居检查它自己的值来有效地跟踪任何重复的id。为了识别哪个id是重复的，我们在循环中包含了assert，这样如果它失败了，它就会记录失败的id。有了这一点，如果您向主数组添加一个重复的id，您的测试将会失败，并且您可以很容易地找到问题的重复项，而不用翻遍所有的源代码。</p><h1 id="89a4" class="lj le in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">结论</h1><p id="21ab" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">在整个web应用程序中跟踪惟一的id起初看起来微不足道，但是如果管理不当，它会很快变成一堆令人筋疲力尽的技术债务。通过使用上面的技术，您可能会遇到在进行过程中向数组添加id的小麻烦，但是可以省去很多麻烦。自动化测试是我们的朋友，让我们写一次，让他们为我们工作。</p><p id="44a2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在我的下一篇文章中，我将告诉你我们如何利用TypeScript和"<a class="ae kt" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-4.html#const-assertions" rel="noopener ugc nofollow" target="_blank"> const assertion </a>"来获得一些真正令人惊奇的智能感知，这将使得在编写测试时使用这些id变得毫不费力。</p></div><div class="ab cl mn mo hr mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ig ih ii ij ik"><p id="e8ee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mu">查看更多内容请点击</em><a class="ae kt" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="mu">plain English . io</em></strong></a></p></div></div>    
</body>
</html>