<html>
<head>
<title>A Beginner’s Guide To Behaviour Testing In React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React中行为测试的初学者指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/a-beginners-guide-to-behaviour-testing-in-react-faf098a8c232?source=collection_archive---------14-----------------------#2021-12-06">https://javascript.plainenglish.io/a-beginners-guide-to-behaviour-testing-in-react-faf098a8c232?source=collection_archive---------14-----------------------#2021-12-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a5930d4d6ef4782a38c6db7ae66c2069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SVZTVKl5aG_vA0lpUu1Ndg.png"/></div></div></figure><p id="cc8f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在React领域，在过去几年中，我们已经看到我们测试组件的方式发生了重大转变。虽然以前它主要集中在单元测试上，但是现在的标准更倾向于确保你的测试尽可能地代表你的用户体验——行为测试。</p><p id="42cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">到目前为止，在我工作过的所有React工程团队中，行为测试一直是积极讨论的话题。要么我们正在考虑采用它，决定将一个项目的测试栈向一个更注重行为的设置过渡，要么我们已经在应用它们了。这非常符合该领域的发展方向:从快照测试转向验证行为的测试。</p><p id="4692" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是，尽管这是该领域的一个趋势，但这并不意味着每个React开发人员或团队都可以在这些趋势出现时跟随它们。对于一些项目和团队来说，抛弃整个现有的设置来采用像行为测试这样的新概念是不现实的。这本身不是问题，但这意味着不是每个React开发人员都熟悉行为测试</p><p id="5711" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于那些对行为测试更缺乏经验和经验的开发人员来说，对如何实现这些类型的测试有疑问和不确定性并不疯狂。为了帮助他们，本文将作为React中行为测试的入门指南。它将回答我在从事行为测试期间经历的一系列基本问题。这些信息将为您理解React中的行为测试提供坚实的基础，重点是什么，为什么要这样做，它对您的用例是否有意义，以及您自己如何开始。</p><h1 id="fef5" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">什么是行为测试？</h1><p id="925a" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">首先，让我们从最基本的事情开始:什么是行为测试？这是一种前端测试，目标是验证React组件的行为。但具体来说，重点是以最能代表终端用户体验这些行为的方式来做这件事。</p><p id="23f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">行为测试基于这样的原则:我们的web应用程序的最终用户体验是最重要的。其中一部分是确保我们的web应用程序在最终用户与它交互时能按预期工作。因此，它做它应该做的，显示它应该显示的，适当地更新UI:按预期行为。</p><h1 id="cd47" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">行为测试在测试光谱中处于什么位置？</h1><p id="dcec" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">在我目前的团队中，我们试图尽可能多地进行行为测试，但是仍然有一些遗留的测试代码到处存在。虽然这通常不是一个大问题，但是对于使用现有代码作为参考点的新手来说，这是一个大问题。巧合的是，最近几个月我们有两个新的开发人员加入了我们的团队。</p><p id="9e9d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">遇到“正常的”单元测试、快照测试、E2E测试，然后是行为测试，这可能会让人不知所措。这让你失去了全局观，并开始质疑关于设置的许多事情，比如为什么有这么多的测试形式，在什么场景中应该使用哪种形式，以及谁负责什么。不幸的是，事实正是如此。</p><p id="25f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最有可能的是，在React团队中，这种设置和情况并不少见。因此，明确行为测试的作用和地位是很重要的。最后，行为测试是一种单元测试。在测试方面，它们与“普通的”单元测试和快照测试没有太大的不同。但是它们最大的区别在于实现的方式和验证的执行方式。</p><h1 id="a960" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">行为测试和E2E测试有什么区别？</h1><p id="2a9e" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">对于行为测试这个概念相对较新的人来说，行为测试和E2E测试之间的区别可能很难识别。尽管我们说行为测试是单元测试，但它们仍然运行实际的React组件，并像最终用户一样与它们交互。从一个没有经验的人的角度来看，这非常类似于E2E测试。</p><p id="82eb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，有一些微妙但至关重要的差异。</p><ul class=""><li id="00e6" class="lz ma iq ka b kb kc kf kg kj mb kn mc kr md kv me mf mg mh bi translated">渲染环境。尽管我们在两种类型的测试中都运行并呈现了React代码，但行为测试并不在实际的浏览器中运行。与E2E测试相比，这使得它们运行起来更轻便，这意味着它们更具可伸缩性。</li><li id="f189" class="lz ma iq ka b kb mi kf mj kj mk kn ml kr mm kv me mf mg mh bi translated">人脉。E2E测试背后的主要思想是在整个应用程序中模拟真实的用户体验。在我们的例子中，React应用程序只是整个产品的一小部分。因此，E2E测试意味着验证React代码和它周围的应用程序之间的联系，而行为测试不能。</li><li id="9396" class="lz ma iq ka b kb mi kf mj kj mk kn ml kr mm kv me mf mg mh bi translated">责任。基于前一点，E2E测试和行为测试有不同的范围和目标。这意味着在某些工程团队中，不同的人负责不同类型的测试。我们也有类似的情况，尽管不那么明确。</li></ul><h1 id="f680" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">行为测试会取代“正常的”单元测试和快照测试吗？</h1><p id="e94c" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">是也不是，真正的答案是视情况而定。所有不同形式的测试都有其目的和用例，<a class="ae mn" href="https://levelup.gitconnected.com/what-are-proper-use-cases-for-snapshot-testing-react-components-ac5ed2286081" rel="noopener ugc nofollow" target="_blank">甚至快照测试</a>。不同的场景需要不同形式的单元测试。</p><p id="a40a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是否意味着您应该扔掉所有现有的单元测试，用行为测试来代替它们？</p><p id="e012" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不，因为其他表单仍然有用例。一些现有的测试甚至不能转化为行为测试。为了迁移而这样做不仅浪费时间和精力，而且产生的测试甚至可能没有意义。这最终甚至会降低测试的质量和价值。</p><p id="7f71" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是这是否意味着行为测试通常是单元测试最合适的形式呢？</p><p id="01ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">是的，行为测试应该能够覆盖你的大多数用例。其他形式的单元测试更合适并且能够提供更多价值的场景数量非常少。要么它们非常具体，要么这些场景的重点更倾向于验证代码流。</p><h1 id="d495" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">React中的行为测试需要使用React测试库吗？</h1><p id="6ef8" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">不，没必要。一般来说，行为测试作为一个概念是框架和库不可知的。这意味着你可以创建行为测试，不管你用的是什么栈。然而，React测试库是为React中的行为测试而定制的。与其他测试库相比，它提供的工具和实用程序使这项工作变得更加容易。</p><p id="6778" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这使得它成为在React中进行行为测试时的首选。但是，使用其他测试库(如Enzyme)来执行行为测试仍然是完全可能的。唯一的问题是，要做好这件事需要更多的努力，而且更容易搞砸。这意味着你必须更加彻底地进行测试，并且<a class="ae mn" href="https://betterprogramming.pub/a-comprehensive-guide-to-proper-behaviour-testing-in-react-with-enzyme-and-jest-ae866188f29a" rel="noopener ugc nofollow" target="_blank">关注更多的事情</a>。</p><h1 id="34cf" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">行为测试实现起来更复杂吗？</h1><p id="bb2e" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">一般来说，与典型的单元测试或快照测试相比，行为测试更复杂，需要更多的努力来实现。这是因为行为测试的目标和范围不同于其他形式的测试。行为测试更侧重于最终用户的交互，而其他类型的单元测试通常侧重于验证代码流。</p><p id="5ef4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于这个原因，在你的测试中有更多的方面需要关注。虽然实现典型的单元测试只需要关注代码的流程，但是行为测试必须关注确保它们能够代表最终用户的体验。这涵盖了与测试相关的所有方面，比如识别UI元素、触发交互以及验证结果。所有这些都使得行为测试更加复杂，难以正确实施。</p><p id="0c9b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是，尽管行为测试需要更多的时间和精力来实现，但与通常的单元测试相比，它们更有价值。如果实施得当，行为测试将为您提供更高程度的保证和安全性，从用户的角度来看，您的应用程序正在按预期工作。</p><h1 id="b070" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">我可以在没有行为测试的项目中进行行为测试吗？</h1><p id="4261" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">是的。正如本文中多次提到的，行为测试不依赖于任何库、框架或技术。这意味着没有任何技术要求，因此您可以轻松地向任何现有项目添加行为测试。</p><p id="41da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在一个没有React测试库的项目中，有两个选项。首先是在已经存在的测试库中实现行为测试。尽管这将更难做到，但这意味着您不必向您必须维护的项目引入另一个依赖项。</p><p id="e470" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一个选择是添加React测试库，并将新的测试逐步引入到项目中。虽然这为项目引入了另一个依赖项，但它允许您利用为手边的任务优化的库。这会给你一个良好的开端。</p><p id="f20a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">无论您选择哪一个选项，重要的是要记住，您正在向项目添加一个额外的概念，需要被开发人员采用、学习和维护。行为测试及其所有代码也不例外。如果您还决定在一个项目中维护多种测试策略，这种影响会被进一步放大。</p><p id="d4a9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在项目中引入行为测试有很多好处，但是考虑开发、维护和测试中增加的负担也很重要。</p><h1 id="fce3" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">最后的想法</h1><p id="8469" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">在过去的几年里，行为测试在React开发领域变得越来越重要。如今，作为一名React开发人员，这是一个重要的工具。对主题的理解和知识在很多场景中都是相关的。然而，并不是每个开发人员都同样熟悉和掌握行为测试。</p><p id="3b67" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了弥补这些开发人员的不足，本文根据我在多个React工程团队中的经验，讨论了一系列与React中的行为测试相关的问题。这些问题以及它们各自的答案是这个主题的入门指南。通过奠定基础，你可以对主题有一个坚实的理解，并在未来的基础上建立。</p></div><div class="ab cl mo mp hu mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="ij ik il im in"><p id="d108" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢这篇文章，可以考虑看看<a class="ae mn" href="https://www.getrevue.co/profile/chakshunyu" rel="noopener ugc nofollow" target="_blank">不寻常反应</a>时事通讯和我的<a class="ae mn" href="https://twitter.com/keraito" rel="noopener ugc nofollow" target="_blank">推特</a>中的其他条目，以便将来更新。</p><p id="ebbc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="mv">更多内容看</em> <a class="ae mn" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="mv">说白了就是</em> </strong> </a> <strong class="ka ir"> <em class="mv">。</em> </strong> <em class="mv">报名参加我们的</em> <a class="ae mn" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="mv">免费每周简讯点击这里</em> </strong> </a> <strong class="ka ir"> <em class="mv">。</em> </strong></p></div></div>    
</body>
</html>