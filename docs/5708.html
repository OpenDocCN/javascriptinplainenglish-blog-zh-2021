<html>
<head>
<title>How to Create Observable using Behavior Subject in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用行为主体在角度上创建可观察对象</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-observable-using-behavior-subject-in-angular-93a949f54d18?source=collection_archive---------1-----------------------#2021-12-02">https://javascript.plainenglish.io/creating-observable-using-behavior-subject-in-angular-93a949f54d18?source=collection_archive---------1-----------------------#2021-12-02</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/20b8fb65328063122f493ab67c378aa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ce_QCjhgmm41Iq7lyhAAOw.jpeg"/></div></div></figure></div><div class="ab cl jv jw hr jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="ig ih ii ij ik"><h1 id="9de1" class="kc kd in bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">可观察到的</strong></h1><p id="415c" class="pw-post-body-paragraph la lb in lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">Observable，也称为ReactiveX库，来自RxJS<em class="ly">T5，它对于处理事件，尤其是订阅事件非常有用。例如，Angular使用observables作为其核心功能的接口，例如:</em></p><ul class=""><li id="89de" class="lz ma in lc b ld mb lh mc ll md lp me lt mf lx mg mh mi mj bi translated">定义自定义事件以将输出数据从子组件发送到父组件。</li><li id="1632" class="lz ma in lc b ld mk lh ml ll mm lp mn lt mo lx mg mh mi mj bi translated">通过HTTP模块处理AJAX请求和响应。</li><li id="18c7" class="lz ma in lc b ld mk lh ml ll mm lp mn lt mo lx mg mh mi mj bi translated">在角度路由器和表单模块中监听和响应用户输入事件。</li></ul><p id="637b" class="pw-post-body-paragraph la lb in lc b ld mb lf lg lh mc lj lk ll mp ln lo lp mq lr ls lt mr lv lw lx ig bi translated">在Angular中，RxJS提供了4种类型的主题来创建可观察对象。这4种类型分别是<em class="ly">主体</em>、<em class="ly">行为主体</em>、<em class="ly">回放主体</em>和<em class="ly">异步主体</em>。可以通过观察他们对<em class="ly">订阅</em>的反应来区分他们。但是，在本文中，我们将讨论实现<em class="ly">行为主题</em>的方法，这是Angular中最常见的主题之一。</p><h1 id="f5a0" class="kc kd in bd ke kf ms kh ki kj mt kl km kn mu kp kq kr mv kt ku kv mw kx ky kz bi translated">行为主体</h1><p id="7e60" class="pw-post-body-paragraph la lb in lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">首先，你需要对主体的工作原理有基本的了解。当您订阅主题时，您将获得在您订阅主题之后从主题<strong class="lc io">发出的每个事件。参考<a class="ae mx" href="https://www.youtube.com/watch?v=_5n9p_2Ajvo&amp;t=1s" rel="noopener ugc nofollow" target="_blank">这段</a>视频。</strong></p><p id="48ba" class="pw-post-body-paragraph la lb in lc b ld mb lf lg lh mc lj lk ll mp ln lo lp mq lr ls lt mr lv lw lx ig bi translated">但是在BehaviorSubject中，它的工作方式似乎与Subject相同，只是它接收的是在订阅之前发生的最后一个事件。参考<a class="ae mx" href="https://www.youtube.com/watch?v=ENluprrCpTU" rel="noopener ugc nofollow" target="_blank">这个</a>视频。</p><p id="9eaa" class="pw-post-body-paragraph la lb in lc b ld mb lf lg lh mc lj lk ll mp ln lo lp mq lr ls lt mr lv lw lx ig bi translated">所以，没有什么理由更喜欢行为主体而不是主体:</p><ul class=""><li id="a050" class="lz ma in lc b ld mb lh mc ll md lp me lt mf lx mg mh mi mj bi translated">它将始终返回订阅的当前值(初始化时需要初始值)。</li><li id="4363" class="lz ma in lc b ld mk lh ml ll mm lp mn lt mo lx mg mh mi mj bi translated">它有一个<code class="fe my mz na nb b"><strong class="lc io">getValue()</strong></code>函数来获取当前值。</li><li id="b1a3" class="lz ma in lc b ld mk lh ml ll mm lp mn lt mo lx mg mh mi mj bi translated">它确保组件总是接收最新的数据。</li></ul><p id="b9d2" class="pw-post-body-paragraph la lb in lc b ld mb lf lg lh mc lj lk ll mp ln lo lp mq lr ls lt mr lv lw lx ig bi translated">我们可以用组件间数据共享的例子来说明BehaviorSubject的实现。</p><p id="0a19" class="pw-post-body-paragraph la lb in lc b ld mb lf lg lh mc lj lk ll mp ln lo lp mq lr ls lt mr lv lw lx ig bi translated">首先，我们需要使用私有的BehaviorSubject创建一个服务，它将保存消息的当前值。我们定义了一个<em class="ly"> currentMessage </em>变量来处理这个数据流，作为一个将被组件使用的可观察对象。之后，我们实现一个函数来调用<code class="fe my mz na nb b"><strong class="lc io">next()</strong></code>函数来改变它的值。</p><figure class="nc nd ne nf gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="531e" class="pw-post-body-paragraph la lb in lc b ld mb lf lg lh mc lj lk ll mp ln lo lp mq lr ls lt mr lv lw lx ig bi translated">接下来，让我们看看如何在父组件和子组件中使用这个<em class="ly">数据服务</em>。</p><p id="df96" class="pw-post-body-paragraph la lb in lc b ld mb lf lg lh mc lj lk ll mp ln lo lp mq lr ls lt mr lv lw lx ig bi translated">在父组件中，在构造函数中注入<em class="ly">数据服务</em>。然后订阅<em class="ly">数据服务</em>的<em class="ly">current message</em>observable以获取值变化。</p><figure class="nc nd ne nf gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="3851" class="pw-post-body-paragraph la lb in lc b ld mb lf lg lh mc lj lk ll mp ln lo lp mq lr ls lt mr lv lw lx ig bi translated">然后，我们在子组件中创建一个<em class="ly"> changeMessage </em>函数，为消息分配一个新值。重要的是，我们可以在任何组件中创建一个函数来改变消息，它会自动广播给所有订阅了<em class="ly">数据服务</em>的其他组件。</p><figure class="nc nd ne nf gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="8320" class="pw-post-body-paragraph la lb in lc b ld mb lf lg lh mc lj lk ll mp ln lo lp mq lr ls lt mr lv lw lx ig bi translated">在上面的代码片段中，当用户点击新消息按钮后，触发<em class="ly"> changeMessage </em>函数，并且<em class="ly">current Message</em>observable通过<code class="fe my mz na nb b"><strong class="lc io">next()</strong></code>函数从消息的新值中更新其值。因此，被订阅的父组件将收到新的消息值。此外，不仅父组件，而且子组件和被订阅的同级组件都将获得相同的待遇。</p></div><div class="ab cl jv jw hr jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="ig ih ii ij ik"><blockquote class="ni nj nk"><p id="1a7d" class="la lb ly lc b ld mb lf lg lh mc lj lk nl mp ln lo nm mq lr ls nn mr lv lw lx ig bi translated">BehaviorSubject是一个非常简单，易于使用，但功能强大的创建可观察对象的方法。希望这篇文章能帮助你对BehaviorSubject有一个基本的了解。</p></blockquote><p id="8be7" class="pw-post-body-paragraph la lb in lc b ld mb lf lg lh mc lj lk ll mp ln lo lp mq lr ls lt mr lv lw lx ig bi translated"><em class="ly">更多内容看</em> <a class="ae mx" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lc io"> <em class="ly">说白了. io </em> </strong> </a> <strong class="lc io"> <em class="ly">。</em> </strong> <em class="ly">报名参加我们的</em><strong class="lc io"><em class="ly"/></strong><a class="ae mx" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lc io"><em class="ly">免费每周简讯这里</em> </strong> </a> <strong class="lc io"> <em class="ly">。</em> </strong></p></div></div>    
</body>
</html>