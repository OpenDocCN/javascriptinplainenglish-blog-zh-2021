<html>
<head>
<title>Testing 101 in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在JavaScript中测试101</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/testing-101-in-javascript-720c752ecfd5?source=collection_archive---------3-----------------------#2021-06-07">https://javascript.plainenglish.io/testing-101-in-javascript-720c752ecfd5?source=collection_archive---------3-----------------------#2021-06-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="aa9d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">用JavaScript编写测试的初学者友好指南</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ebe4b02596835387d72b76c2d28e8d20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BVQXVXG2NN0KgS7VOtt1MA.jpeg"/></div></div></figure><blockquote class="ku kv kw"><p id="534f" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated">“您是否遇到过这样的情况，您有两个函数，<code class="fe lb lc ld le b">f1</code>和<code class="fe lb lc ld le b">f2</code>，在运行脚本时，您发现<code class="fe lb lc ld le b">f1</code>按预期工作，但是<code class="fe lb lc ld le b">f2</code>不工作？经过几分钟的调试，你终于修复了<code class="fe lb lc ld le b">f2</code>和<strong class="jm io">推送</strong>的代码！等等，但是你在修好<code class="fe lb lc ld le b">f2</code>之后有没有重新检查<code class="fe lb lc ld le b">f1</code>，看它是否工作？”</p><p id="cb46" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated">编辑:如果你喜欢看同样的视频，下周我会在我的Youtube上发布同样的视频。</p></blockquote><p id="ca40" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">显然，我们大多数人都会犯这个错误。像我们这样的初级开发人员/学生开发人员，已经从这个错误中吸取了教训，但是我们仍然这样做，但是不那么频繁了。</p><p id="fe5d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以今天我将和你们讨论JavaScript测试，并和你们一起进行一些现场测试。不要担心，如果你刚刚开始测试。这肯定会帮助你了解测试。</p><p id="15f4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你需要什么？一个浏览器和一个编辑器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/f70db62133c459239918507a8a29a06d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/1*YL8GUaWQn-MGNl1qlGz4zg.gif"/></div><figcaption class="lh li gj gh gi lj lk bd b be z dk">Lets taste(test)</figcaption></figure><p id="2df9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有很多技术，为了测试，我们将使用其中一种技术，称为<code class="fe lb lc ld le b">Behavior Driven Development or BDD.</code></p><p id="55c9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">简单来说，这意味着，</p><ul class=""><li id="f5d7" class="ll lm in jm b jn jo jr js jv ln jz lo kd lp kh lq lr ls lt bi translated">我们将会有一个函数<code class="fe lb lc ld le b">(we will be calling it a unit)</code>，并且我们将会有一个测试文件，它将会描述这个特定的<code class="fe lb lc ld le b">unit</code>的测试。</li><li id="e80b" class="ll lm in jm b jn lu jr lv jv lw jz lx kd ly kh lq lr ls lt bi translated">接下来，我们将确保测试失败，然后再次调试/重新实现<code class="fe lb lc ld le b">unit</code>。</li><li id="be54" class="ll lm in jm b jn lu jr lv jv lw jz lx kd ly kh lq lr ls lt bi translated">最后，在调试之后，我们将验证<code class="fe lb lc ld le b">unit</code>的最新实现是否成功通过了测试。</li><li id="5d7c" class="ll lm in jm b jn lu jr lv jv lw jz lx kd ly kh lq lr ls lt bi translated">(可选)对其他单元(这里作为函数)重复相同的内容。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lz"><img src="../Images/dead752a4989f3c9b36680cc85a3df5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6kd8vLnu9cu3ieo4"/></div></div><figcaption class="lh li gj gh gi lj lk bd b be z dk">Behavior Driven Development</figcaption></figure><p id="33a2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">编写测试文件和执行测试，也称为自动化测试，其中除了代码之外，测试是单独编写的。他们以各种方式运行我们的功能，并将结果与预期进行比较。”</p><p id="defb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，我们将遵循一种实用的方法来学习测试的基础知识。</p><p id="f55d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们必须创建一个函数<code class="fe lb lc ld le b">pow(x,n)</code>，它返回值<code class="fe lb lc ld le b">x</code>的<code class="fe lb lc ld le b">n</code>次方。</p><p id="4054" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">“在Javascript中，我们确实有一个操作符<code class="fe lb lc ld le b">**</code>来完成这项工作，但我们在这里是为了学习测试的基础知识，从今以后，这将是我们的例子，它确保事情对初学者友好。”</p><p id="15f9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以在为这个函数创建代码之前，我们要想象这个函数应该做什么并描述它。这种描述的写作，也称为规范或<code class="fe lb lc ld le b">specs</code>。这只是另一个花哨的词，只是我们想要描述我们的测试函数的一种方式，就像它的名字或者测试做什么一样。</p><p id="f214" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面的代码片段展示了我们的pow函数的规格说明。</p><pre class="kj kk kl km gt ma le mb mc aw md bi"><span id="a396" class="me mf in le b gy mg mh l mi mj">describe("pow", function() {<br/><br/>  it("raises to n-th power", function() {<br/>    assert.equal(pow(2, 3), 8);<br/>  });<br/><br/>});</span></pre><p id="5c7d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">需要注意三点，该规范有三个基本组成部分。</p><ul class=""><li id="6676" class="ll lm in jm b jn jo jr js jv ln jz lo kd lp kh lq lr ls lt bi translated"><code class="fe lb lc ld le b">describe("title", function() { ... })</code>:我们用这个来描述我们将要测试的功能/单元。</li><li id="9a22" class="ll lm in jm b jn lu jr lv jv lw jz lx kd ly kh lq lr ls lt bi translated"><code class="fe lb lc ld le b">it("the-exact-use-case", function() { ... })</code>:如果你对这个完全陌生，<code class="fe lb lc ld le b">use cases</code>的意思是情况，或者可以是动作。这里我们的用例被提升到n次方。</li><li id="1c3a" class="ll lm in jm b jn lu jr lv jv lw jz lx kd ly kh lq lr ls lt bi translated"><code class="fe lb lc ld le b">assert.equal(value1, value2)</code>:块<code class="fe lb lc ld le b">it</code>内的代码，如果实现正确，应该执行无误。功能<code class="fe lb lc ld le b">assert.*</code>用于检查<code class="fe lb lc ld le b">pow</code>是否按预期工作。</li></ul><h1 id="f9a1" class="mk mf in bd ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng bi translated">带电测试</h1><p id="f0d4" class="pw-post-body-paragraph jk jl in jm b jn nh jp jq jr ni jt ju jv nj jx jy jz nk kb kc kd nl kf kg kh ig bi translated">我们将使用以下著名的JS库，它们为我们提供了<code class="fe lb lc ld le b">describe</code>和<code class="fe lb lc ld le b">it</code>函数。</p><p id="5f31" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe lb lc ld le b">Mocha</code> -核心框架:它提供了常见的测试功能，包括“描述”和“它”以及运行测试的主要功能。</p><p id="2858" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe lb lc ld le b">Chai</code>–有很多断言的库。它允许我们使用许多不同的断言，现在，我们只需要<code class="fe lb lc ld le b">assert.equal</code>。</p><p id="a635" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，这将是一个文件系统。</p><pre class="kj kk kl km gt ma le mb mc aw md bi"><span id="01be" class="me mf in le b gy mg mh l mi mj">--directory<br/>      |___ index.html<br/>      |___ test.js</span></pre><p id="5b89" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将拥有一个包含所有导入的<code class="fe lb lc ld le b">mochajs</code>和<code class="fe lb lc ld le b">chaijs</code>的<code class="fe lb lc ld le b">index.html</code>文件。我们将在<code class="fe lb lc ld le b">test.js</code>进行<code class="fe lb lc ld le b">BDD</code>测试。</p><p id="b914" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你的<code class="fe lb lc ld le b">index.html</code>应该是这样的。</p><pre class="kj kk kl km gt ma le mb mc aw md bi"><span id="bb01" class="me mf in le b gy mg mh l mi mj">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>  &lt;!-- add mocha css, to show results --&gt;<br/>  &lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mocha/3.2.0/mocha.css"&gt;<br/>  &lt;!-- add mocha framework code --&gt;<br/>  &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/3.2.0/mocha.js"&gt;&lt;/script&gt;<br/>  &lt;script&gt;<br/>    mocha.setup('bdd'); // minimal setup<br/>  &lt;/script&gt;<br/>  &lt;!-- add chai --&gt;<br/>  &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/chai/3.5.0/chai.js"&gt;&lt;/script&gt;<br/>  &lt;script&gt;<br/>    // chai has a lot of stuff, let's make assert global<br/>    let assert = chai.assert;<br/>  &lt;/script&gt;<br/>&lt;/head&gt;<br/><br/>&lt;body&gt;<br/><br/>  &lt;script&gt;<br/>    function pow(x, n) {<br/>      /* function code is to be written, empty now */<br/>    }<br/>  &lt;/script&gt;<br/><br/>  &lt;!-- the script with tests (describe, it...) --&gt;<br/>  &lt;script src="test.js"&gt;&lt;/script&gt;<br/><br/>  &lt;!-- the element with id="mocha" will contain test results --&gt;<br/>  &lt;div id="mocha"&gt;&lt;/div&gt;<br/><br/>  &lt;!-- run tests! --&gt;<br/>  &lt;script&gt;<br/>    mocha.run();<br/>  &lt;/script&gt;<br/>&lt;/body&gt;<br/><br/>&lt;/html&gt;</span></pre><ul class=""><li id="8360" class="ll lm in jm b jn jo jr js jv ln jz lo kd lp kh lq lr ls lt bi translated">在<code class="fe lb lc ld le b">head</code>标签下，我们已经导入了所需的库。</li><li id="6d3f" class="ll lm in jm b jn lu jr lv jv lw jz lx kd ly kh lq lr ls lt bi translated">在<code class="fe lb lc ld le b">body</code>标签下，第一个脚本定义了我们的函数<code class="fe lb lc ld le b">pow</code>，它现在是空的。</li><li id="d436" class="ll lm in jm b jn lu jr lv jv lw jz lx kd ly kh lq lr ls lt bi translated">接下来，我们引用我们的<code class="fe lb lc ld le b">test.js</code>文件。</li><li id="0cf8" class="ll lm in jm b jn lu jr lv jv lw jz lx kd ly kh lq lr ls lt bi translated">id为mocha的<code class="fe lb lc ld le b">div</code>将帮助mochaJS显示输出</li><li id="6722" class="ll lm in jm b jn lu jr lv jv lw jz lx kd ly kh lq lr ls lt bi translated">最后，通过命令<code class="fe lb lc ld le b">mocha.run()</code>开始测试</li></ul><p id="dd30" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你运行<code class="fe lb lc ld le b">index.html</code>，你会看到类似这样的东西。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/acfeb39b33d10e536a6ce8f493f6e703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8ijgfKJw3sGhTso6"/></div></div></figure><h1 id="6963" class="mk mf in bd ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng bi translated">该股的初步实施</h1><p id="ac48" class="pw-post-body-paragraph jk jl in jm b jn nh jp jq jr ni jt ju jv nj jx jy jz nk kb kc kd nl kf kg kh ig bi translated">如前所述，函数<code class="fe lb lc ld le b">pow</code>我们将调用一个单元。最初，我们是这样实现代码的。</p><pre class="kj kk kl km gt ma le mb mc aw md bi"><span id="9efe" class="me mf in le b gy mg mh l mi mj">function pow(x, n) {<br/>    return 8;<br/>}</span></pre><p id="7baa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">并且<code class="fe lb lc ld le b">test.js</code>包含以下测试。</p><pre class="kj kk kl km gt ma le mb mc aw md bi"><span id="aa33" class="me mf in le b gy mg mh l mi mj">describe("pow", function() {</span><span id="4256" class="me mf in le b gy nn mh l mi mj">  it("raises to n-th power", function() {<br/>    assert.equal(pow(2, 3), 8);<br/>  });</span><span id="adc8" class="me mf in le b gy nn mh l mi mj">});</span></pre><p id="c7ae" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">刷新浏览器，您可以看到类似如下的输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/5cb325849d14ca03e102c2ac32cb15f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EQ4jWgpODGGuAxDk"/></div></div></figure><p id="ad3f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这里，如果你看到，测试是成功的，我们只有一个测试用例，但pow函数完全是一个<strong class="jm io">欺骗</strong>，因为它为x的每个值返回8。所以我们需要改进规格，换句话说，就是<code class="fe lb lc ld le b">test.js</code></p><h1 id="3a81" class="mk mf in bd ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng bi translated">改进规格</h1><p id="3a68" class="pw-post-body-paragraph jk jl in jm b jn nh jp jq jr ni jt ju jv nj jx jy jz nk kb kc kd nl kf kg kh ig bi translated">众所周知，我们在<code class="fe lb lc ld le b">pow</code>函数中做了一个欺骗。所以我们将使用<code class="fe lb lc ld le b">test.js</code>文件向我们展示失败的测试。</p><p id="0aa5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们转到<code class="fe lb lc ld le b">test.js</code>文件，将我们的规格改进为如下所示。</p><pre class="kj kk kl km gt ma le mb mc aw md bi"><span id="3114" class="me mf in le b gy mg mh l mi mj">describe("pow", function() {</span><span id="b6ec" class="me mf in le b gy nn mh l mi mj">  it("2 raised to power 3 is 8", function() {<br/>    assert.equal(pow(2, 3), 8);<br/>  });</span><span id="c838" class="me mf in le b gy nn mh l mi mj">  it("3 raised to power 4 is 81", function() {<br/>    assert.equal(pow(3, 4), 81);<br/>  });</span><span id="f522" class="me mf in le b gy nn mh l mi mj">});</span></pre><p id="7ef3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">保存<code class="fe lb lc ld le b">test.js</code>文件，刷新你的浏览器，你肯定会得到类似这样的东西。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/a7710c82d0a299bedc84b433298f716a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VvfrbWPWDKelSox1"/></div></div></figure><h1 id="8ebb" class="mk mf in bd ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng bi translated">调试装置</h1><p id="71d2" class="pw-post-body-paragraph jk jl in jm b jn nh jp jq jr ni jt ju jv nj jx jy jz nk kb kc kd nl kf kg kh ig bi translated">现在该重新实现函数<code class="fe lb lc ld le b">pow</code>了。转到<code class="fe lb lc ld le b">index.html</code>，在脚本标签下，编写以下代码。</p><pre class="kj kk kl km gt ma le mb mc aw md bi"><span id="1d42" class="me mf in le b gy mg mh l mi mj">function pow(x, n) {<br/>  let result = 1;</span><span id="c19f" class="me mf in le b gy nn mh l mi mj">  for (let i = 0; i &lt; n; i++) {<br/>    result *= x;<br/>  }</span><span id="9887" class="me mf in le b gy nn mh l mi mj">  return result;<br/>}</span></pre><p id="5d49" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，我们改进了我们的实现，让我们刷新我们的浏览器。如果所有调试都正确完成，您将会看到类似这样的内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/68a0e94d0e220b36b532d989b4db9ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*b40M6pRRM9Uzq3iD"/></div></div></figure><p id="a6a7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">是的，我们已经成功地测试了我们的代码。但是，规范中仍然有很多需要改进的地方。以下规格应该是更精确的规格。</p><pre class="kj kk kl km gt ma le mb mc aw md bi"><span id="b5ce" class="me mf in le b gy mg mh l mi mj">describe("pow", function() {</span><span id="7a3e" class="me mf in le b gy nn mh l mi mj">  function makeTest(x) {<br/>    let expected = x * x * x;<br/>    it(`${x} in the power 3 is ${expected}`, function() {<br/>      assert.equal(pow(x, 3), expected);<br/>    });<br/>  }</span><span id="b812" class="me mf in le b gy nn mh l mi mj">  for (let x = 1; x &lt;= 5; x++) {<br/>    makeTest(x);<br/>  }</span><span id="2da1" class="me mf in le b gy nn mh l mi mj">});</span></pre><p id="d55c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">刷新您的浏览器，您肯定会看到以下输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/72733167a5eae693f8f0f80c4b264270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yFn3bnZyjQcuf4ci"/></div></div></figure><h1 id="1caa" class="mk mf in bd ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng bi translated">恭喜🎉🎉🎉</h1><p id="7693" class="pw-post-body-paragraph jk jl in jm b jn nh jp jq jr ni jt ju jv nj jx jy jz nk kb kc kd nl kf kg kh ig bi translated">“终于，你成功了。测试是软件工程中最重要的阶段，它有助于编写好的、可维护的软件。此外，当你为各种开源组织做贡献时，事实上甚至是作为初级开发人员或软件工程实习生，你都应该为你的代码编写测试用例。”</p><p id="10c9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="kx">更多内容请看</em><a class="ae lf" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="kx">plain English . io</em></a></p></div></div>    
</body>
</html>