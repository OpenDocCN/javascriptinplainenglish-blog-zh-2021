<html>
<head>
<title>Adding Graphics to a React App with D3 — Bar Chart</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用D3向React应用程序添加图形—条形图</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/adding-graphics-to-a-react-app-with-d3-bar-chart-addbfcde27ec?source=collection_archive---------13-----------------------#2021-02-11">https://javascript.plainenglish.io/adding-graphics-to-a-react-app-with-d3-bar-chart-addbfcde27ec?source=collection_archive---------13-----------------------#2021-02-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9b9c02b574924de64b4c4953d80d5408.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*o1hsPSJBg1JQQlSQ"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@agkdesign?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alex Knight</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0ec8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">D3让我们可以轻松地向前端web应用添加图形。</p><p id="461d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue是一个流行的前端web框架。</p><p id="55a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们合作得很好。在本文中，我们将了解如何使用D3为Vue应用添加图形。</p><h1 id="3ad2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建条形图</h1><p id="a3da" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在React应用程序中用D3创建一个条形图，方法是读入数据，创建轴，然后添加条形。</p><p id="59c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="1395" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">public/data.csv</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ab7c" class="mq lc iq mh b gy mr ms l mt mu">year,population<br/>2006,20<br/>2008,25<br/>2010,38<br/>2012,61<br/>2014,43<br/>2016,26<br/>2017,62</span></pre><p id="1b8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">src/App.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b553" class="mq lc iq mh b gy mr ms l mt mu">import React, { useEffect } from "react";<br/>import * as d3 from "d3";</span><span id="e116" class="mq lc iq mh b gy mv ms l mt mu">const createBarChart = async () =&gt; {<br/>  const svg = d3.select("svg"),<br/>    margin = 200,<br/>    width = svg.attr("width") - margin,<br/>    height = svg.attr("height") - margin;</span><span id="a9ee" class="mq lc iq mh b gy mv ms l mt mu">  svg<br/>    .append("text")<br/>    .attr("transform", "translate(100,0)")<br/>    .attr("x", 50)<br/>    .attr("y", 50)<br/>    .attr("font-size", "20px")<br/>    .attr("class", "title")<br/>    .text("Population bar chart");</span><span id="3a53" class="mq lc iq mh b gy mv ms l mt mu">  const x = d3.scaleBand().range([0, width]).padding(0.4),<br/>    y = d3.scaleLinear().range([height, 0]);<br/>  const g = svg.append("g").attr("transform", "translate(100, 100)");<br/>  const data = await d3.csv("data.csv");</span><span id="acd2" class="mq lc iq mh b gy mv ms l mt mu">  x.domain(<br/>    data.map(function (d) {<br/>      return d.year;<br/>    })<br/>  );<br/>  y.domain([<br/>    0,<br/>    d3.max(data, function (d) {<br/>      return d.population;<br/>    })<br/>  ]);</span><span id="c358" class="mq lc iq mh b gy mv ms l mt mu">  g.append("g")<br/>    .attr("transform", `translate(0, ${height})`)<br/>    .call(d3.axisBottom(x))<br/>    .append("text")<br/>    .attr("y", height - 250)<br/>    .attr("x", width - 100)<br/>    .attr("text-anchor", "end")<br/>    .attr("font-size", "18px")<br/>    .attr("stroke", "blue")<br/>    .text("year");</span><span id="383c" class="mq lc iq mh b gy mv ms l mt mu">  g.append("g")<br/>    .append("text")<br/>    .attr("transform", "rotate(-90)")<br/>    .attr("y", 6)<br/>    .attr("dy", "-5.1em")<br/>    .attr("text-anchor", "end")<br/>    .attr("font-size", "18px")<br/>    .attr("stroke", "blue")<br/>    .text("population");</span><span id="37aa" class="mq lc iq mh b gy mv ms l mt mu">  g.append("g").attr("transform", "translate(0, 0)").call(d3.axisLeft(y));<br/>  g.selectAll(".bar")<br/>    .data(data)<br/>    .enter()<br/>    .append("rect")<br/>    .attr("class", "bar")<br/>    .style("fill", "lightgreen")<br/>    .on("mouseover", onMouseOver)<br/>    .on("mouseout", onMouseOut)<br/>    .attr("x", function (d) {<br/>      return x(d.year);<br/>    })<br/>    .attr("y", function (d) {<br/>      return y(d.population);<br/>    })<br/>    .attr("width", x.bandwidth())<br/>    .transition()<br/>    .ease(d3.easeLinear)<br/>    .duration(200)<br/>    .delay(function (d, i) {<br/>      return i * 25;<br/>    })<br/>    .attr("height", function (d) {<br/>      return height - y(d.population);<br/>    });</span><span id="c073" class="mq lc iq mh b gy mv ms l mt mu">  function onMouseOver(d, i) {<br/>    d3.select(this).attr("class", "highlight");</span><span id="5656" class="mq lc iq mh b gy mv ms l mt mu">    d3.select(this)<br/>      .transition()<br/>      .duration(200)<br/>      .attr("width", x.bandwidth() + 5)<br/>      .attr("y", function (d) {<br/>        return y(d.population) - 10;<br/>      })<br/>      .attr("height", function (d) {<br/>        return height - y(d.population) + 10;<br/>      });</span><span id="406a" class="mq lc iq mh b gy mv ms l mt mu">    g.append("text")<br/>      .attr("class", "val")<br/>      .attr("x", function () {<br/>        return x(d.year);<br/>      })<br/>      .attr("y", function () {<br/>        return y(d.value) - 10;<br/>      });<br/>  }</span><span id="45eb" class="mq lc iq mh b gy mv ms l mt mu">  function onMouseOut(d, i) {<br/>    d3.select(this).attr("class", "bar");</span><span id="5ec8" class="mq lc iq mh b gy mv ms l mt mu">    d3.select(this)<br/>      .transition()<br/>      .duration(200)<br/>      .attr("width", x.bandwidth())<br/>      .attr("y", function (d) {<br/>        return y(d.population);<br/>      })<br/>      .attr("height", function (d) {<br/>        return height - y(d.population);<br/>      });</span><span id="68e0" class="mq lc iq mh b gy mv ms l mt mu">     d3.selectAll(".val").remove();<br/>  }<br/>};</span><span id="1bbd" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  useEffect(() =&gt; {<br/>    createBarChart();<br/>  }, []);</span><span id="a1b3" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;svg width="500" height="500"&gt;&lt;/svg&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="5d66" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在模板中添加了<code class="fe me mf mg mh b">svg</code>元素。</p><p id="e929" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们写下标题:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8a26" class="mq lc iq mh b gy mr ms l mt mu">svg<br/>  .append("text")<br/>  .attr("transform", "translate(100,0)")<br/>  .attr("x", 50)<br/>  .attr("y", 50)<br/>  .attr("font-size", "20px")<br/>  .attr("class", "title")<br/>  .text("Population bar chart");</span></pre><p id="8f14" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">x</code>和<code class="fe me mf mg mh b">y</code>是文本左上角的x和y坐标。</p><p id="ec7c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">transform</code>通过翻译来转换文本。</p><p id="db1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">font-size</code>有标题的字体大小。</p><p id="9d24" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们创建用于轴的<code class="fe me mf mg mh b">x</code>和<code class="fe me mf mg mh b">y</code>范围:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f633" class="mq lc iq mh b gy mr ms l mt mu">const x = d3.scaleBand().range([0, width]).padding(0.4),<br/>  y = d3.scaleLinear().range([height, 0]);<br/>const g = svg.append("g").attr("transform", "translate(100, 100)");<br/>const data = await d3.csv("data.csv");<br/><br/>x.domain(<br/>  data.map(function(d) {<br/>    return d.year;<br/>  })<br/>);<br/>y.domain([<br/>  0,<br/>  d3.max(data, function(d) {<br/>    return d.population;<br/>  }),<br/>]);</span></pre><p id="db3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">domain</code>方法设置<code class="fe me mf mg mh b">x</code>和<code class="fe me mf mg mh b">y</code>的域。</p><p id="a883" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe me mf mg mh b">axisBottom</code>方法创建x轴:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d69e" class="mq lc iq mh b gy mr ms l mt mu">g.append("g")<br/>  .attr("transform", `translate(0, ${height})`)<br/>  .call(d3.axisBottom(x))<br/>  .append("text")<br/>  .attr("y", height - 250)<br/>  .attr("x", width - 100)<br/>  .attr("text-anchor", "end")<br/>  .attr("font-size", "18px")<br/>  .attr("stroke", "blue")<br/>  .text("year");</span></pre><p id="67e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">attr</code>方法设置所有的CSS样式。</p><p id="d563" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们通过书写来添加y轴的标签:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2280" class="mq lc iq mh b gy mr ms l mt mu">g.append("g")<br/>  .append("text")<br/>  .attr("transform", "rotate(-90)")<br/>  .attr("y", 6)<br/>  .attr("dy", "-5.1em")<br/>  .attr("text-anchor", "end")<br/>  .attr("font-size", "18px")<br/>  .attr("stroke", "blue")<br/>  .text("population");</span></pre><p id="8a60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们加上y轴本身，写为:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="cc21" class="mq lc iq mh b gy mr ms l mt mu">g.append("g").attr("transform", "translate(0, 0)").call(d3.axisLeft(y));</span></pre><p id="2ec5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过书写来添加小节:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="10ea" class="mq lc iq mh b gy mr ms l mt mu">g.selectAll(".bar")<br/>  .data(data)<br/>  .enter()<br/>  .append("rect")<br/>  .attr("class", "bar")<br/>  .style("fill", "lightgreen")<br/>  .on("mouseover", onMouseOver)<br/>  .on("mouseout", onMouseOut)<br/>  .attr("x", function(d) {<br/>    return x(d.year);<br/>  })<br/>  .attr("y", function(d) {<br/>    return y(d.population);<br/>  })<br/>  .attr("width", x.bandwidth())<br/>  .transition()<br/>  .ease(d3.easeLinear)<br/>  .duration(200)<br/>  .delay(function(d, i) {<br/>    return i * 25;<br/>  })<br/>  .attr("height", function(d) {<br/>    return height - y(d.population);<br/>  });</span></pre><p id="789b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加了一个<code class="fe me mf mg mh b">mouseover</code>事件监听器，当我们将鼠标悬停在它上面时，它会展开该栏。</p><p id="76d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们添加了<code class="fe me mf mg mh b">mouseout</code>事件监听器，以便在我们将鼠标从工具条上移开时将工具条恢复到其原始大小。</p><p id="8a24" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们设置了<code class="fe me mf mg mh b">x</code>和<code class="fe me mf mg mh b">y</code>属性，这样我们可以将它定位在x轴上。</p><p id="c4f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，当它加载<code class="fe me mf mg mh b">transition</code>、<code class="fe me mf mg mh b">ease</code>和<code class="fe me mf mg mh b">duration</code>调用时，我们添加一些转换。</p><p id="71b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们通过在最后一个<code class="fe me mf mg mh b">attr</code>调用中设置<code class="fe me mf mg mh b">height</code>属性，将条形的高度设置为。</p><h1 id="e27c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="f28a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用D3从CSV数据创建一个条形图。</p><p id="2636" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>