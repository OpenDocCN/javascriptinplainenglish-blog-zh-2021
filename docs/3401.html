<html>
<head>
<title>How to Create Your Own Implementation of JSON.stringify()</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建自己的JSON.stringify()实现</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-your-own-implementation-of-json-stringify-simiplied-version-8ab6746cdd1?source=collection_archive---------1-----------------------#2021-07-10">https://javascript.plainenglish.io/create-your-own-implementation-of-json-stringify-simiplied-version-8ab6746cdd1?source=collection_archive---------1-----------------------#2021-07-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="5f8b" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">创建自己的JSON.stringify()实现的简化技术</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/e77a1fbc0b5c54e7926ab5234b7f21be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CGREDwvv4ELVxxuX"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@flowforfrank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ferenc Almasi</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="12a8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">大多数JavaScript开发人员都会熟悉JSON.stringify()，它用于比较对象，构建深度克隆对象和数组，还有助于实现RESTful APIs。</p><p id="5407" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，在本文中，我们将讨论如何创建我们自己的简化版本的这种方法。</p><p id="e8e8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">JSON.stringify()方法将JavaScript对象或值转换为JSON字符串，稍后可以使用JSON.parse()方法将该字符串解析回JavaScript对象或值。</p><p id="ed1f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你不熟悉这个功能，我强烈建议你看看<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify" rel="noopener ugc nofollow" target="_blank"> MDN </a>的医生是怎么说的。</p><p id="1f0b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">它的语法非常简单:</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="1d25" class="lu lv in lq b gy lw lx l ly lz">const obj = { x: 5, y: 6 };<br/>console.log(JSON.stringify(obj));<br/>// expected output: "{"x":5,"y":6}"</span></pre><p id="e870" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们从基本的测试用例开始:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="75c9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">正如您所看到的，它对于4种主要的数据类型非常简单:数字、布尔、字符串和对象。对于嵌套的对象结构，我们需要使用递归函数来处理它。对于数组来说，它也是一个对象，但要处理它，我们需要用isArray函数进行显式检查。让我们来看看这个例子:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="adc7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果您传递一个字符串或数字而不是一个对象，上面的函数也将以同样的方式工作和行为。这就是为什么我创建了单独的if块并返回值，这样那些if块就可以用于对象值的递归函数调用。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="c606" class="lu lv in lq b gy lw lx l ly lz">console.<em class="mc">log</em>((<em class="mc">JSON</em>.<em class="mc">stringify</em>(1) === <em class="mc">JSONStringify</em>(1))); -&gt; TRUE</span><span id="ee9a" class="lu lv in lq b gy md lx l ly lz">console.<em class="mc">log</em>((<em class="mc">JSON</em>.<em class="mc">stringify</em>('s') === <em class="mc">JSONStringify</em>('s'))); -&gt; TRUE</span></pre><p id="b8e6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">下一步</strong></p><ul class=""><li id="e4a2" class="me mf in kv b kw kx kz la lc mg lg mh lk mi lo mj mk ml mm bi translated">支持null、Infinity和NAN值。</li><li id="e4a8" class="me mf in kv b kw mn kz mo lc mp lg mq lk mr lo mj mk ml mm bi translated">忽略对象中的函数、未定义值和符号值。</li><li id="5d82" class="me mf in kv b kw mn kz mo lc mp lg mq lk mr lo mj mk ml mm bi translated">添加对未定义的支持。</li><li id="fbd7" class="me mf in kv b kw mn kz mo lc mp lg mq lk mr lo mj mk ml mm bi translated">通过返回与date.toISOString()相同的字符串来转换Date对象。</li><li id="56b1" class="me mf in kv b kw mn kz mo lc mp lg mq lk mr lo mj mk ml mm bi translated">处理NaN、Infinity和未定义值的数组值，并将它们作为空值传递。</li></ul><p id="6b4a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">对于Null、Infinity和NaN值，我们可以创建自定义函数来识别它们并将其分组为一个值:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="1500" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要忽略函数、符号和未定义的值:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="18fd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">支持日期对象:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="34e0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">处理数组值或嵌套数组值我们必须创建一个单独的函数来处理它并更新数组的递归调用:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><h1 id="b58f" class="ms lv in bd mt mu mv mw mx my mz na nb jt nc ju nd jw ne jx nf jz ng ka nh ni bi translated">最终实现:</h1><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="5e3b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">以下是我试图涵盖的测试案例:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="2def" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您可以使用这些案例并传递您自己的stringifying自定义实现，以检查您涵盖了哪些边缘案例。</p><h1 id="8b64" class="ms lv in bd mt mu mv mw mx my mz na nb jt nc ju nd jw ne jx nf jz ng ka nh ni bi translated">结论</h1><p id="eda0" class="pw-post-body-paragraph kt ku in kv b kw nj jo ky kz nk jr lb lc nl le lf lg nm li lj lk nn lm ln lo ig bi translated">我注意到最近在面试中也有人问了一个编码问题来实现你的stringify函数。另外，了解JavaScript语言的深度以及本机方法是如何实现的也很有好处。坦率地说，它帮助我理解了幕后发生的事情以及JavaScript中每种数据类型的深度。</p><p id="9710" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我把这段代码放到了Github上:</p><div class="no np gp gr nq nr"><a href="https://github.com/siddharth-sunchu/native-methods/blob/master/JSONStringfy.js" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd io gy z fp nw fr fs nx fu fw im bi translated">西达斯-孙楚/本地方法</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">JavaScript的本地方法。创建一个帐户，为西达斯-孙楚/本土方法的发展作出贡献…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of km nr"/></div></div></a></div><p id="3104" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">请随意建议或添加我可能遗漏或未考虑的任何边缘案例。</p><p id="6dc8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="mc">更多内容看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="mc">plain English . io</em></strong></a></p></div></div>    
</body>
</html>