<html>
<head>
<title>Sync with Multiple v-models in Vue 3 using Composition API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用组合API与Vue 3中的多个v模型同步</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-easily-sync-with-multiple-v-models-in-vue-3-using-composition-api-1e36440d932?source=collection_archive---------17-----------------------#2021-03-17">https://javascript.plainenglish.io/how-to-easily-sync-with-multiple-v-models-in-vue-3-using-composition-api-1e36440d932?source=collection_archive---------17-----------------------#2021-03-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f8d7a0ea9e64c2ddf375a8db1bd76a32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7GXbX6VrbgVN73i6i0HNqw.png"/></div></div></figure><p id="ab25" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本文原载于<a class="ae kw" href="https://theroadtoenterprise.com/blog/how-to-easily-sync-with-multiple-v-models-in-vue-3-using-composition-api" rel="noopener ugc nofollow" target="_blank">企业之路</a>。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="22da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Vue 3带来了许多新特性，在同一个元素上使用多个v-model指令的能力就是其中之一。我想与您分享一个快速技巧，告诉您在使用多个v-model时如何处理父组件状态的更新。在处理表单的时候特别有用。您可以在这个<a class="ae kw" href="https://github.com/ThomasFindlay/handle-multiple-vmodels-using-composition-api" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a>中找到完整的代码示例。</p><p id="2cb3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于本例，我们将使用下图所示的表单。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi le"><img src="../Images/a50d91dd2e790ff2ad4ff9f146ddf969.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*6Lh5tNwu3rsdOTqJNeTR2Q.png"/></div></figure><p id="4bde" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面你可以找到它的代码。我们有两个文件— <code class="fe lj lk ll lm b">App.vue</code>，它们具有表单状态并呈现<code class="fe lj lk ll lm b">Form</code>组件。<code class="fe lj lk ll lm b">Form.vue</code>组件呈现带有标签和输入字段的表单元素。</p><p id="cc5c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> App.vue </strong></p><pre class="lf lg lh li gt ln lm lo lp aw lq bi"><span id="c50d" class="lr ls iq lm b gy lt lu l lv lw">&lt;template&gt;<br/>  &lt;div :class="$style.container"&gt;<br/>    &lt;Form<br/>      v-model:name="form.name"<br/>      v-model:surname="form.surname"<br/>      @submit="onSubmit"<br/>    /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>import { ref } from 'vue'<br/>import Form from './components/Form.vue'<br/><br/>export default {<br/>  components: {<br/>    Form,<br/>  },<br/>  setup() {<br/>    const form = ref({<br/>      name: '',<br/>      surname: '',<br/>    })<br/><br/>    const onSubmit = () =&gt; console.log(form)<br/><br/>    return {<br/>      form,<br/>      onSubmit,<br/>    }<br/>  },<br/>}<br/>&lt;/script&gt;<br/><br/>&lt;style module&gt;<br/>.container {<br/>  max-width: 30rem;<br/>  @apply mx-auto py-8;<br/>}<br/>&lt;/style&gt;</span></pre><p id="4ec2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">组件/表单. vue </strong></p><pre class="lf lg lh li gt ln lm lo lp aw lq bi"><span id="2064" class="lr ls iq lm b gy lt lu l lv lw">&lt;template&gt;<br/>  &lt;form @submit.prevent="$emit('submit')"&gt;<br/>    &lt;div :class="$style.formBlock"&gt;<br/>      &lt;label :class="$style.label"&gt;Name&lt;/label&gt;<br/>      &lt;input<br/>        v-model="nameState"<br/>        :class="$style.input"<br/>        type="text"<br/>        aria-label="Name input"<br/>      /&gt;<br/>    &lt;/div&gt;<br/>    &lt;div :class="$style.formBlock"&gt;<br/>      &lt;label :class="$style.label"&gt;Surname&lt;/label&gt;<br/>      &lt;input<br/>        v-model="surnameState"<br/>        :class="$style.input"<br/>        type="text"<br/>        aria-label="Surname input"<br/>      /&gt;<br/>    &lt;/div&gt;<br/>    &lt;div&gt;<br/>      &lt;button<br/>        class="float-right bg-blue-100 text-blue-900 px-4 py-3 rounded font-semibold"<br/>        type="submit"<br/>      &gt;<br/>        Submit<br/>      &lt;/button&gt;<br/>    &lt;/div&gt;<br/>  &lt;/form&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>import { useVModel } from '../composables/useVModel.js'<br/>export default {<br/>  emits: ['update:name', 'update:surname', 'submit'],<br/>  props: {<br/>    name: String,<br/>    surname: String,<br/>  },<br/>  setup(props) {<br/>    return {<br/>      nameState: useVModel(props, 'name'),<br/>      surnameState: useVModel(props, 'surname'),<br/>    }<br/>  },<br/>}<br/>&lt;/script&gt;<br/><br/>&lt;style module&gt;<br/>.formBlock {<br/>  @apply flex flex-col mb-4;<br/>}<br/>.label {<br/>  @apply mb-2;<br/>}<br/>.input {<br/>  @apply px-4 py-3 shadow rounded border border-gray-300 bg-white;<br/>}<br/>&lt;/style&gt;</span></pre><p id="9d4f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了更新父节点中的状态，我们需要发出一个<code class="fe lj lk ll lm b">update:&lt;modelValue&gt;</code>事件。</p><p id="d852" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里是<code class="fe lj lk ll lm b">useVModel</code>助手的代码。</p><p id="a4c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">composables/usev model . js</strong></p><pre class="lf lg lh li gt ln lm lo lp aw lq bi"><span id="58e5" class="lr ls iq lm b gy lt lu l lv lw">import { computed, getCurrentInstance } from 'vue'<br/><br/>export const useVModel = (props, propName) =&gt; {<br/>  const vm = getCurrentInstance().proxy<br/><br/>  return computed({<br/>    get() {<br/>      return props[propName]<br/>    },<br/>    set(value) {<br/>      vm.$emit(`update:${propName}`, value)<br/>    },<br/>  })<br/>}</span></pre><p id="06bd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们必须通过<code class="fe lj lk ll lm b">props</code>对象来保持反应的完整性和我们想要同步的属性名。在<code class="fe lj lk ll lm b">useVModel</code>内部，我们通过<code class="fe lj lk ll lm b">getCurrentInstance()</code>访问当前实例，因为我们需要访问<code class="fe lj lk ll lm b">$emit</code>方法。<code class="fe lj lk ll lm b">computed</code>接收一个带有getter和setter的对象。getter返回通过props传递的值，而setter发出一个事件来更新该值。多亏了这个小帮手，通过v-models保持通过道具传递的状态就干净简单多了。</p><p id="243e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望你喜欢这篇文章。如果你想学习更多与Vue相关的技巧、高级模式、技术和最佳实践，你可能想看看<a class="ae kw" href="https://theroadtoenterprise.com/?utm_source=theroadtoenterprise_blog&amp;utm_medium=article_learn_more&amp;utm_campaign=vue_the_road_to_enterprise" rel="noopener ugc nofollow" target="_blank">“Vue——通往企业之路”</a>这本书。</p></div></div>    
</body>
</html>