<html>
<head>
<title>Build A Vue.js Markdown Renderer Component</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建Vue.js Markdown渲染器组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/vue-js-markdown-renderer-component-with-code-highlight-support-5cde100f6e0d?source=collection_archive---------3-----------------------#2021-03-01">https://javascript.plainenglish.io/vue-js-markdown-renderer-component-with-code-highlight-support-5cde100f6e0d?source=collection_archive---------3-----------------------#2021-03-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="6e69" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">带有代码突出显示支持</h2></div><p id="57be" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最终代码可以在这里找到<a class="ae ky" href="https://github.com/ps1312/simple_blog/tree/feature/markdown_display" rel="noopener ugc nofollow" target="_blank">https://github . com/PS 1312/simple _ blog/tree/feature/markdown _ display</a>，找<code class="fe kz la lb lc b">MarkdownDisplay.vue</code>看实现。</p><h1 id="8678" class="ld le in bd lf lg lh li lj lk ll lm ln jt lo ju lp jw lq jx lr jz ls ka lt lu bi translated"><strong class="ak">上下文</strong></h1><p id="64a0" class="pw-post-body-paragraph kc kd in ke b kf lv jo kh ki lw jr kk kl lx kn ko kp ly kr ks kt lz kv kw kx ig bi translated">我想开发我自己的博客作为一个辅助项目来提高我的Vue.js和TDD技能。我已经选择将博客内容保存在markdown中，我需要Vue中的一个组件来编译并以HTML格式呈现我保存的帖子。</p><p id="2fd0" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">经过一些研究，我发现了两个可以完成这项工作的库，<a class="ae ky" href="https://github.com/markedjs/marked" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> marked.js </strong> </a>和<a class="ae ky" href="https://highlightjs.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> highlight.js </strong> </a>。我最终没有做测试，但是我以后一定会再做的。我希望该组件能够编译并显示HTML元素的markdown字符串，我的markdown引用将是:</p><pre class="ma mb mc md gt me lc mf mg aw mh bi"><span id="0b4e" class="mi le in lc b gy mj mk l ml mm"># Creating a blog with Vue</span><span id="93db" class="mi le in lc b gy mn mk l ml mm">### First you'll need a component to display markdown 📄</span><span id="c50d" class="mi le in lc b gy mn mk l ml mm">Here is an example of some code</span><span id="01ab" class="mi le in lc b gy mn mk l ml mm">```javascript<br/>function print(string) {<br/> console.log(string)<br/>};<br/>print("test");<br/>```</span><span id="02d2" class="mi le in lc b gy mn mk l ml mm">### It should also display images from url links 🏞</span><span id="2c95" class="mi le in lc b gy mn mk l ml mm">![Image placeholder](https://via.placeholder.com/700x300)</span><span id="f7a5" class="mi le in lc b gy mn mk l ml mm">### And some lists and links ✅</span><span id="6361" class="mi le in lc b gy mn mk l ml mm">Vue:</span><span id="d539" class="mi le in lc b gy mn mk l ml mm">- [Vue.js official documentation](https://helloacm.com)</span><span id="137c" class="mi le in lc b gy mn mk l ml mm">- [Nuxt.js Server Side Rendering](<a class="ae ky" href="https://nuxtjs.org/" rel="noopener ugc nofollow" target="_blank">https://nuxtjs.org/</a>)</span></pre><h1 id="91c6" class="ld le in bd lf lg lh li lj lk ll lm ln jt lo ju lp jw lq jx lr jz ls ka lt lu bi translated"><strong class="ak">初始设置</strong></h1><p id="7204" class="pw-post-body-paragraph kc kd in ke b kf lv jo kh ki lw jr kk kl lx kn ko kp ly kr ks kt lz kv kw kx ig bi translated">我首先使用默认的Vue 2设置，通过<a class="ae ky" href="https://cli.vuejs.org/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io">Vue CLI</strong></a><strong class="ke io"/>创建了一个Vue应用。安装后，你可以用<code class="fe kz la lb lc b">vue create blog</code>创建一个项目，其中“博客”是你选择的应用程序名称，输出将是。</p><figure class="ma mb mc md gt mo gh gi paragraph-image"><div class="ab gu cl mp"><img src="../Images/e0757b261c598efd1d6f1e65dc5b4289.png" data-original-src="https://miro.medium.com/v2/format:webp/1*pXgJv4yc3xkJ5l3P8OE6Aw.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Vue CLI boilerplate for Vue 2 default settings</figcaption></figure><p id="40e2" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在删除了<code class="fe kz la lb lc b">HelloWorld.vue</code>组件并移除了其在<code class="fe kz la lb lc b">App.vue</code>上的引用后，我需要一个新的空组件来显示内容，它可以被称为<code class="fe kz la lb lc b">MarkdownDisplay.vue</code>。<strong class="ke io"> marked.js </strong>和<strong class="ke io"> highlight.js </strong>都还需要安装，可以用<code class="fe kz la lb lc b">npm install --save marked highlight.js</code>来做。</p><h1 id="da66" class="ld le in bd lf lg lh li lj lk ll lm ln jt lo ju lp jw lq jx lr jz ls ka lt lu bi translated"><strong class="ak">将markdown编译为原始HTML </strong></h1><p id="ca83" class="pw-post-body-paragraph kc kd in ke b kf lv jo kh ki lw jr kk kl lx kn ko kp ly kr ks kt lz kv kw kx ig bi translated"><code class="fe kz la lb lc b">MarkdownDisplay.vue</code>需要从父组件(本例中为<code class="fe kz la lb lc b">App.js</code>)接收一个作为道具传递的markdown字符串。为了显示想要的HTML，markdown字符串需要由<strong class="ke io"> marked.js </strong>解析和编译，通过通读<a class="ae ky" href="https://marked.js.org/using_advanced#options." rel="noopener ugc nofollow" target="_blank">文档</a>我们看到它可以用<code class="fe kz la lb lc b">marked("## sample string" [,options])</code>完成。该组件将类似于:</p><figure class="ma mb mc md gt mo"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="9aec" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我想在这里谈一些事情:</p><ol class=""><li id="d1e5" class="my mz in ke b kf kg ki kj kl na kp nb kt nc kx nd ne nf ng bi translated">返回一个原始的HTML。我们可以在Vue的<code class="fe kz la lb lc b">v-html</code>指令中呈现这些内容，如<a class="ae ky" href="https://vuejs.org/v2/guide/syntax.html#Raw-HTML" rel="noopener ugc nofollow" target="_blank">文档</a>中所示。</li><li id="08e0" class="my mz in ke b kf nh ki ni kl nj kp nk kt nl kx nd ne nf ng bi translated">我已经选择使用<code class="fe kz la lb lc b">marked</code>作为Vue计算属性。该属性可以在data中设置，也可以在<code class="fe kz la lb lc b">mount</code>中编译，但是使用computed会给我们<a class="ae ky" href="https://vuejs.org/v2/guide/computed.html#Computed-Caching-vs-Methods" rel="noopener ugc nofollow" target="_blank">基于markdown字符串依赖的自由缓存</a>。</li></ol><p id="4d4d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们以当前预览结束:</p><figure class="ma mb mc md gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nm"><img src="../Images/2beefec39e32feec23a355b0ef45e143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BZcjkEqwWnDLVgUBWi03kg.png"/></div></div></figure><p id="55f1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里有两个问题:</p><ol class=""><li id="71d6" class="my mz in ke b kf kg ki kj kl na kp nb kt nc kx nd ne nf ng bi translated">调整窗口大小时，图像表现奇怪，我们需要添加一些CSS样式来解决这个问题。</li><li id="1498" class="my mz in ke b kf nh ki ni kl nj kp nk kt nl kx nd ne nf ng bi translated">代码段没有正确突出显示。在小代码块中，这很好，但是对于复杂的逻辑，如果没有语法高亮，就很难阅读。</li></ol><h1 id="6f21" class="ld le in bd lf lg lh li lj lk ll lm ln jt lo ju lp jw lq jx lr jz ls ka lt lu bi translated">代码突出显示</h1><p id="fd80" class="pw-post-body-paragraph kc kd in ke b kf lv jo kh ki lw jr kk kl lx kn ko kp ly kr ks kt lz kv kw kx ig bi translated">正如我们所看到的,<strong class="ke io"> marked.js </strong>默认情况下不高亮显示代码，但是通过搜索它的文档，我们可以找到一个关于如何正确设置该功能的<a class="ae ky" href="https://marked.js.org/using_advanced" rel="noopener ugc nofollow" target="_blank">示例</a>(甚至使用<strong class="ke io"> highlight.js🙌).</strong></p><p id="a139" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">但是首先，我们需要设置<strong class="ke io"> highlight.js，</strong>我们可以通过在某个地方调用<code class="fe kz la lb lc b">hljs.highlightAll()</code>来完成。在我们的应用程序中，它将从<code class="fe kz la lb lc b">MarkdownDisplay.vue</code> <code class="fe kz la lb lc b">mounted</code>生命周期步骤开始调用。我们还必须选择我们的代码块将呈现什么样式，有各种样式<a class="ae ky" href="https://github.com/highlightjs/highlight.js/tree/master/src/styles" rel="noopener ugc nofollow" target="_blank">可供选择。为了避免歧义，我们需要从npm模块导入前缀为<code class="fe kz la lb lc b">~</code>的文件，你可以在这里</a>阅读更多关于它的信息<a class="ae ky" href="https://cli.vuejs.org/guide/html-and-static-assets.html#static-assets-handling" rel="noopener ugc nofollow" target="_blank">。我还将添加必要的CSS来修复调整大小时的图像元素。该组件将类似于:</a></p><figure class="ma mb mc md gt mo"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="95d9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">HTML结果是:</p><figure class="ma mb mc md gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nm"><img src="../Images/d4630c34cd89f1c58ef51c3ee09c626d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W13GCXJ5pn10X00aHwf_yQ.png"/></div></div></figure></div><div class="ab cl nr ns hr nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ig ih ii ij ik"><h1 id="8640" class="ld le in bd lf lg ny li lj lk nz lm ln jt oa ju lp jw ob jx lr jz oc ka lt lu bi translated">绩效调整+事后反思</h1><p id="577f" class="pw-post-body-paragraph kc kd in ke b kf lv jo kh ki lw jr kk kl lx kn ko kp ly kr ks kt lz kv kw kx ig bi translated">在<code class="fe kz la lb lc b">webpack-bundle-analyzer</code>上运行项目后，我注意到<strong class="ke io"> highlight.js、</strong>正在进行未使用的导入，从而使包变得更大，而<strong class="ke io"> </strong>为了解决这个问题，我们需要加载我们需要突出显示的语言，在本例中只有<code class="fe kz la lb lc b">javascript</code>。该组件将类似于:</p><figure class="ma mb mc md gt mo"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="0d26" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">就是这样。✅</p><h2 id="a056" class="mi le in bd lf od oe dn lj of og dp ln kl oh oi lp kp oj ok lr kt ol om lt on bi translated">结论</h2><p id="39cd" class="pw-post-body-paragraph kc kd in ke b kf lv jo kh ki lw jr kk kl lx kn ko kp ly kr ks kt lz kv kw kx ig bi translated">这是学习Vue语法和第三方依赖用法的一个很好的组件。我还学习了如何正确地从单个页面组件导入npm模块。最后但同样重要的是，通过<code class="fe kz la lb lc b">webpack-bundle-analyzer</code>运行应用程序让我对包的创建和代码分割有了更多的了解，我将发布另一篇文章来展示我是如何做到这一点的。</p><p id="bcfc" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">感谢你阅读✋</p></div></div>    
</body>
</html>