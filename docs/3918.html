<html>
<head>
<title>Let’s Validate Our Form: React Hook Form ft. TypeScript📝</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们验证一下我们的形式:React Hook Form ft。以打字打的文件📝</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/lets-validate-our-form-react-hook-form-ft-typescript-1c5184c04429?source=collection_archive---------3-----------------------#2021-08-06">https://javascript.plainenglish.io/lets-validate-our-form-react-hook-form-ft-typescript-1c5184c04429?source=collection_archive---------3-----------------------#2021-08-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/b0993000e3b8fa6b6d6de8dffb3b7a4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IJR3ANI2meHz5D5i1pPvlg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">picture from Desmond Gerber in <a class="ae jz" href="https://morioh.com/p/0d8a67bc4b5e" rel="noopener ugc nofollow" target="_blank">morioh</a></figcaption></figure><blockquote class="ka kb kc"><p id="15c5" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated"><strong class="kg io"> TLDR </strong> : <code class="fe lc ld le lf b">react-hook-form</code>是一个强大的处理表单的库，它减少了重新渲染的次数，因为它采用了<code class="fe lc ld le lf b">uncontrolled</code>处理表单的方式。你将经常使用库提供的<code class="fe lc ld le lf b">useForm</code>钩子来使用它的力量。该挂钩在第<strong class="kg io"> 2a节中解释。使用表单。</strong></p></blockquote><p id="a3d1" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated">当然，在JavaScript或React应用程序中验证表单不是一种固执己见的方式！因为这取决于你工作的环境和用户界面设计。我们可以自己处理或者使用第三方库。有时候，我们自己做验证会花费更多的时间，这也会让其他刚刚处理相关功能的开发人员感到困惑，每个开发人员都有自己的处理方式。</p><p id="af85" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated">有一个名为<code class="fe lc ld le lf b">react-hook-form</code>的第三方库，它旨在帮助开发者处理表单验证。那么，如果第三方库只减少了3-4行代码，那么使用它又有什么意义呢？。嗯，<code class="fe lc ld le lf b">react-hook-form</code>还有另一个优势，正如官方文件中所说:</p><blockquote class="ka kb kc"><p id="3ccb" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">减少您需要编写的代码量，并删除不必要的重新渲染是React Hook Form的一些主要目标</p></blockquote><p id="d0bb" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated">这是真的，因为原因之一是<code class="fe lc ld le lf b">react-hook-form</code>主要使用了一种不受控制的处理形式。如果你想知道表单的非受控处理方式是什么，你可以阅读我之前关于React中<code class="fe lc ld le lf b"><a class="ae jz" href="https://medium.com/@pratamarauf8/controlled-vs-uncontrolled-component-%EF%B8%8F-fa707c759967" rel="noopener">Controlled vs Uncontrolled</a></code>的故事。说够了，给我看看代码！</p></div><div class="ab cl lj lk hr ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ig ih ii ij ik"><h1 id="3203" class="lq lr in bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">1.装置</h1><p id="6daf" class="pw-post-body-paragraph kd ke in kg b kh mo kj kk kl mp kn ko lg mq kr ks lh mr kv kw li ms kz la lb ig bi translated">它只需要一个简单的命令，我们就可以开始了:</p><pre class="mt mu mv mw gt mx lf my mz aw na bi"><span id="c843" class="nb lr in lf b gy nc nd l ne nf">//npm<br/>npm install react-hook-form</span><span id="1d63" class="nb lr in lf b gy ng nd l ne nf">// yarn<br/>yarn add react-hook-form</span></pre><blockquote class="ka kb kc"><p id="d5ad" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">声明:在这个故事中，我用<code class="fe lc ld le lf b"><a class="ae jz" href="https://github.com/react-hook-form/react-hook-form/releases/tag/v7.12.2" rel="noopener ugc nofollow" target="_blank">react-hook-form v7.12.2</a></code>作为例子。</p></blockquote><h1 id="4be6" class="lq lr in bd ls lt nh lv lw lx ni lz ma mb nj md me mf nk mh mi mj nl ml mm mn bi translated">2.使用</h1><p id="de28" class="pw-post-body-paragraph kd ke in kg b kh mo kj kk kl mp kn ko lg mq kr ks lh mr kv kw li ms kz la lb ig bi translated"><code class="fe lc ld le lf b">react-hook-form</code>提供了许多函数和钩子来处理表单，但是有一个钩子叫做<code class="fe lc ld le lf b"><a class="ae jz" href="https://react-hook-form.com/api/useform" rel="noopener ugc nofollow" target="_blank">useForm</a></code>、<code class="fe lc ld le lf b">useController</code>和<code class="fe lc ld le lf b">useFieldArray</code>，这个钩子是最常用的。</p><h2 id="6986" class="nb lr in bd ls nm nn dn lw no np dp ma lg nq nr me lh ns nt mi li nu nv mm nw bi translated">a.使用形式</h2><figure class="mt mu mv mw gt jo"><div class="bz fp l di"><div class="nx ny l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">useForm basic usage</figcaption></figure><p id="2a4e" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated"><code class="fe lc ld le lf b">useForm</code> hook返回的函数有几个，我们来分解一下。</p><p id="fc28" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated"><code class="fe lc ld le lf b"><a class="ae jz" href="https://react-hook-form.com/api/useform/register" rel="noopener ugc nofollow" target="_blank"><strong class="kg io">register</strong></a></code>它将输入或选择元素注册到<code class="fe lc ld le lf b">react-hook-form</code>,以便我们能够使用库验证/特性。从技术上讲，我们只是将输入/选择引用传递给函数。我们还可以通过向第二个参数传递一个对象来添加验证，这些是支持的验证规则:</p><ul class=""><li id="d5bd" class="nz oa in kg b kh ki kl km lg ob lh oc li od lb oe of og oh bi translated"><code class="fe lc ld le lf b">required: boolean</code></li><li id="36e1" class="nz oa in kg b kh oi kl oj lg ok lh ol li om lb oe of og oh bi translated"><code class="fe lc ld le lf b">min: number</code></li><li id="0260" class="nz oa in kg b kh oi kl oj lg ok lh ol li om lb oe of og oh bi translated"><code class="fe lc ld le lf b">max: number</code></li><li id="f12c" class="nz oa in kg b kh oi kl oj lg ok lh ol li om lb oe of og oh bi translated"><code class="fe lc ld le lf b">minLength: number</code></li><li id="6261" class="nz oa in kg b kh oi kl oj lg ok lh ol li om lb oe of og oh bi translated"><code class="fe lc ld le lf b">maxLength: number</code></li><li id="2672" class="nz oa in kg b kh oi kl oj lg ok lh ol li om lb oe of og oh bi translated"><code class="fe lc ld le lf b">pattern: RegExp</code></li><li id="c3c2" class="nz oa in kg b kh oi kl oj lg ok lh ol li om lb oe of og oh bi translated"><code class="fe lc ld le lf b">validate: Function | Object</code></li></ul><p id="6b47" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated"><code class="fe lc ld le lf b"><a class="ae jz" href="https://react-hook-form.com/api/useform/handlesubmit" rel="noopener ugc nofollow" target="_blank"><strong class="kg io">handleSubmit</strong></a></code> <strong class="kg io"> </strong>该函数接受2次回调<strong class="kg io">，成功案例接受</strong> <code class="fe lc ld le lf b">SubmitHandler</code>，错误案例接受<code class="fe lc ld le lf b">SubmitErrorHandler</code><strong class="kg io">。</strong>在调用<code class="fe lc ld le lf b">onSubmit/onSubmitError</code>函数之前，该函数将首先验证我们的表单。</p><p id="0027" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated"><code class="fe lc ld le lf b"><a class="ae jz" href="https://react-hook-form.com/api/useform/watch" rel="noopener ugc nofollow" target="_blank"><strong class="kg io">watch</strong></a></code> <strong class="kg io"> </strong>一个不断观察输入变化的函数，通过将输入键/名称传递给函数来指定，它接受字符串或字符串数组。这个函数将导致对根组件的重新渲染，我们可以使用<code class="fe lc ld le lf b"><a class="ae jz" href="https://react-hook-form.com/api/usewatch" rel="noopener ugc nofollow" target="_blank">useWatch</a></code>钩子来获得更好的性能。</p><p id="986b" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated"><code class="fe lc ld le lf b"><a class="ae jz" href="https://react-hook-form.com/api/useform/formstate" rel="noopener ugc nofollow" target="_blank"><strong class="kg io">formState</strong></a></code>是一个保存表单状态信息的对象，它返回的值之一是<code class="fe lc ld le lf b">errors</code>。<code class="fe lc ld le lf b">errors</code>是包含所有无效输入的对象。</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div class="gh gi on"><img src="../Images/3e7a42ad22941c2f63f15db582e542d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*_LqEeH9eL_hhwf4-KIUmJQ.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">useForm basic usage flow</figcaption></figure><figure class="mt mu mv mw gt jo"><div class="bz fp l di"><div class="oo ny l"/></div></figure><h2 id="f998" class="nb lr in bd ls nm nn dn lw no np dp ma lg nq nr me lh ns nt mi li nu nv mm nw bi translated">b.<strong class="ak">使用控制器</strong></h2><p id="1edd" class="pw-post-body-paragraph kd ke in kg b kh mo kj kk kl mp kn ko lg mq kr ks lh mr kv kw li ms kz la lb ig bi translated">它允许我们使用外部受控组件，如React-Select、AntD、Material-UI或任何不公开引用的输入。</p><figure class="mt mu mv mw gt jo"><div class="bz fp l di"><div class="nx ny l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk"><code class="fe lc ld le lf b">useController</code> basic usage</figcaption></figure><p id="c295" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated">我们使用<code class="fe lc ld le lf b">useController</code>创建一个可重用的受控组件，它接受<code class="fe lc ld le lf b"><a class="ae jz" href="https://react-hook-form.com/api/usecontroller" rel="noopener ugc nofollow" target="_blank">UseControllerProps&lt;T&gt;</a></code>作为道具。<code class="fe lc ld le lf b">useController</code>返回几个对象和函数。我们来分解一下。</p><p id="5da4" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated"><code class="fe lc ld le lf b"><a class="ae jz" href="https://react-hook-form.com/api/usecontroller" rel="noopener ugc nofollow" target="_blank"><strong class="kg io">field</strong></a></code>该对象返回几个函数，如<code class="fe lc ld le lf b">onChange</code>、<code class="fe lc ld le lf b">onBlur</code>、<code class="fe lc ld le lf b">ref</code>、<code class="fe lc ld le lf b">name</code>和<code class="fe lc ld le lf b">value</code>。要将react-hook-form与受控输入连接起来，基本上，我们只需通过spread操作符在字段内部传递它的所有值</p><p id="a5ce" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated"><code class="fe lc ld le lf b"><a class="ae jz" href="https://react-hook-form.com/api/usecontroller" rel="noopener ugc nofollow" target="_blank"><strong class="kg io">fieldState</strong></a></code>将信息保存到特定输入的对象，类似于useForm中的<code class="fe lc ld le lf b">formState</code>。</p><p id="5517" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated">我们还将一些<code class="fe lc ld le lf b">UseControllerProps&lt;T&gt;</code>传递给我们刚刚创建的受控可重用组件，即<code class="fe lc ld le lf b">control</code>、<code class="fe lc ld le lf b">name</code>和<code class="fe lc ld le lf b">rules</code>。<code class="fe lc ld le lf b">control</code>包含注册相关输入的方法，<code class="fe lc ld le lf b">name</code>用作唯一的输入键，<code class="fe lc ld le lf b">rules</code>是我们如何应用验证的选项。</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi op"><img src="../Images/6bc4f7f02a8a1c18dee41b9cc38afaf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0D1JxXZiNa8lJJJIJutsJA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Wiring up controlled input to react-hook-form flow using <code class="fe lc ld le lf b">useController</code></figcaption></figure><h2 id="696c" class="nb lr in bd ls nm nn dn lw no np dp ma lg nq nr me lh ns nt mi li nu nv mm nw bi translated"><strong class="ak"> c. useFieldArray </strong></h2><p id="c4cc" class="pw-post-body-paragraph kd ke in kg b kh mo kj kk kl mp kn ko lg mq kr ks lh mr kv kw li ms kz la lb ig bi translated">useFieldArray是<code class="fe lc ld le lf b">react-hook-form</code>提供的强大钩子之一，它使我们能够处理动态输入。</p><figure class="mt mu mv mw gt jo"><div class="bz fp l di"><div class="nx ny l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">useFieldArray basic usage</figcaption></figure><p id="f573" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated">与<code class="fe lc ld le lf b">useController</code>类似，<code class="fe lc ld le lf b">useFieldArray</code>中的<code class="fe lc ld le lf b">fields</code>值通过设置<code class="fe lc ld le lf b">useForm</code>上的<code class="fe lc ld le lf b">defaultValues</code>来初始化。</p><p id="22bf" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated">在代码示例中，首先，我们声明<code class="fe lc ld le lf b">useForm</code> hook，并将一组对象传递给<code class="fe lc ld le lf b">defaultValues</code> prop，通过从<code class="fe lc ld le lf b">useForm</code>向<code class="fe lc ld le lf b">useFieldArray</code> prop提供<code class="fe lc ld le lf b">control</code>函数，这些对象将被传递给<code class="fe lc ld le lf b">useFieldArray</code> hook。</p><p id="20ac" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated"><code class="fe lc ld le lf b">useForm</code>接受最小道具，返回一些有用的对象/函数<code class="fe lc ld le lf b">line 32</code>。</p><p id="319e" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated">我们使用通过设置<code class="fe lc ld le lf b">defaultValues</code>启动的<code class="fe lc ld le lf b">fields</code>对象，通过映射它来显示输入，默认情况下<code class="fe lc ld le lf b">fields</code>对象和<code class="fe lc ld le lf b">id</code>对象在映射对象时作为关键属性很有用。使用由<code class="fe lc ld le lf b">react-hook-form</code>提供的<code class="fe lc ld le lf b">uuid</code>生成的<code class="fe lc ld le lf b">id</code></p><p id="c0c8" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated">然后我们可以用<code class="fe lc ld le lf b">useFieldArray</code>返回的其他函数来修改数组，比如<code class="fe lc ld le lf b">append</code>、<code class="fe lc ld le lf b">prepend</code>、<code class="fe lc ld le lf b">insert at</code>、<code class="fe lc ld le lf b">remove</code>、<code class="fe lc ld le lf b">swap</code>、<code class="fe lc ld le lf b">move</code></p><figure class="mt mu mv mw gt jo"><div class="bz fp l di"><div class="oo ny l"/></div></figure></div><div class="ab cl lj lk hr ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ig ih ii ij ik"><h1 id="eceb" class="lq lr in bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated"><strong class="ak">结论</strong></h1><p id="7013" class="pw-post-body-paragraph kd ke in kg b kh mo kj kk kl mp kn ko lg mq kr ks lh mr kv kw li ms kz la lb ig bi translated"><code class="fe lc ld le lf b">react-hook-form</code>是一个功能强大的处理表单的第三方库，它比其他库有优势，减少了重新渲染的次数。<code class="fe lc ld le lf b">react-hook-form</code>有其他强大的API/hook来提升性能，比如<code class="fe lc ld le lf b">useWatch</code>、<code class="fe lc ld le lf b">useFormState</code>和<code class="fe lc ld le lf b">useFormContext</code>。</p><p id="8227" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lg kq kr ks lh ku kv kw li ky kz la lb ig bi translated"><em class="kf">更多内容尽在</em> <a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kg io"> <em class="kf">说白了</em> </strong> </a></p></div></div>    
</body>
</html>