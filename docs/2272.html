<html>
<head>
<title>Three.js Tutorial: How to Build Your First Browser Game — Space Shooter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Three.js教程:如何构建你的第一个浏览器游戏——太空射手</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/three-js-tutorial-to-build-your-first-browser-game-ae34bb0d351d?source=collection_archive---------0-----------------------#2021-05-12">https://javascript.plainenglish.io/three-js-tutorial-to-build-your-first-browser-game-ae34bb0d351d?source=collection_archive---------0-----------------------#2021-05-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="e367" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用JavaScript库Three.js开发你的第一个游戏的分步指南</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/b1d83b34ef244accc8b9a4cee47a170d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IrxsckKSOFhyYCnRW40wUw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Space-Shooter: 2D Browser Game</figcaption></figure><p id="a5e0" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">嘿！今天我们将学习如何使用Three.js构建浏览器游戏！这将是一个简单的演练教程，其中我们创建了著名的<em class="lo">“太空射手”</em>游戏(就像<a class="ae lp" href="https://play.google.com/store/apps/details?id=com.game.space.shooter2" rel="noopener ugc nofollow" target="_blank">这个</a>)，每个步骤后都有源代码链接，让你容易理解。</p><p id="86fb" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">哦，顺便说一下，这就是你的游戏将会是什么样子的:<a class="ae lp" href="https://fik-shun.github.io/Space-Shooter-ThreeJS/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io">太空射手</strong> </a></p><p id="4ed8" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">那么，你对创建自己的游戏感到兴奋吗？？那我们走吧！</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/f5e17e9d85435df1bed5e72f2bbce72b.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*xyMJ2MdU2QSuy6RbwUSJ1Q.png"/></div></figure><p id="91bb" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">Three.js是一个<em class="lo">跨浏览器</em> JavaScript库和应用程序编程接口，使得使用<em class="lo"> WebGL </em>在web浏览器中创建和显示动画3D图形变得非常容易。</p><p id="b0d7" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">对于本教程，我将假设你熟悉Three.js的基础知识，但如果你是一个完全的初学者，那么我强烈建议你先浏览一下这个<a class="ae lp" href="https://medium.com/@benjamin.c.coleman/the-beginners-guide-to-beginning-three-js-c36b8947c2aa" rel="noopener">初学者指南</a>和这个惊人的<a class="ae lp" href="https://www.youtube.com/playlist?list=PLRtjMdoYXLf6mvjCmrltvsD0j12ZQDMfE" rel="noopener ugc nofollow" target="_blank">系列</a>。此外，一定要查看Three.js的<a class="ae lp" href="https://threejs.org/docs/" rel="noopener ugc nofollow" target="_blank">官方文档</a>，当你对一些Three.js类/方法感到困惑时，这些会派上用场。</p><h1 id="a6c4" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">第一步。初始化</h1><p id="5e3f" class="pw-post-body-paragraph ks kt in ku b kv mj jo kx ky mk jr la lb ml ld le lf mm lh li lj mn ll lm ln ig bi translated">让我们首先组织我们的目录结构并创建一个样板文件，这对您将来的Three.js项目会有帮助。我们将要讨论的方法受到了这篇文章的启发。</p><ul class=""><li id="7bc2" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">首先，我们创建一个<code class="fe mx my mz na b"><strong class="ku io">index.html</strong></code>文件。这将是我们网页/游戏的<em class="lo">入口。</em>基本上就是一个带有canvas元素的空白HTML页面，链接了Three.js库和其他js文件。每当我们创建一个新的js文件时，我们将回到<code class="fe mx my mz na b">index.html</code>并在这里链接它。</li><li id="2bbc" class="mo mp in ku b kv nb ky nc lb nd lf ne lj nf ln mt mu mv mw bi translated">接下来，我们创建<code class="fe mx my mz na b"><strong class="ku io">main.js</strong></code>，它是应用程序JavaScript端的<em class="lo">入口点，可以访问DOM并包含SceneManager。</em></li><li id="4354" class="mo mp in ku b kv nb ky nc lb nd lf ne lj nf ln mt mu mv mw bi translated">最后，我们创建<strong class="ku io"> </strong> <code class="fe mx my mz na b"><strong class="ku io">SceneManager.js</strong></code>，它是<em class="lo">负责处理app的Three.js端</em>，对main完全隐藏。它对DOM一无所知，并且创建场景、渲染器和正交照相机。是的，我们将使用正交照相机，因为这将是一场2D的比赛。</li></ul><p id="13b1" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">这种初始化对于所有的Three.js项目都是一样的。所以你可以直接去<a class="ae lp" href="https://github.com/Fik-shun/threejs-game-medium/tree/step-1" rel="noopener ugc nofollow" target="_blank"> <em class="lo">这个样板文件</em> </a>，克隆它，然后开始工作。</p><p id="5b44" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">为了<strong class="ku io">测试</strong>我们的应用程序，我们将在浏览器中运行<code class="fe mx my mz na b">python3 -m http.server</code>并前往<a class="ae lp" href="http://localhost:8000" rel="noopener ugc nofollow" target="_blank"> localhost:8000 </a>。</p><p id="bce8" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">您应该会看到一个黑屏(如下图所示)，这是一个好的开始！</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ng"><img src="../Images/878c22d54830ee96e5272cebab249d02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wpr5KZdG0Mvl7OW5xAuXmA.png"/></div></div></figure><p id="c317" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku io">步骤1后的源代码:</strong> <a class="ae lp" href="https://github.com/Fik-shun/threejs-game-medium/tree/step-1" rel="noopener ugc nofollow" target="_blank">链接</a></p><h1 id="e0f0" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">第二步。添加场景主题</h1><p id="b7c7" class="pw-post-body-paragraph ks kt in ku b kv mj jo kx ky mk jr la lb ml ld le lf mm lh li lj mn ll lm ln ig bi translated">我们现在将添加对象到我们的游戏中。首先，让我们给游戏添加一个像样的背景和我们的飞船。</p><ul class=""><li id="f5e3" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">让我们创建文件<code class="fe mx my mz na b"><strong class="ku io">Background.js</strong></code>，并创建一个平面(将作为我们的背景)，并添加纹理(图像)。我们将定位我们的平面，使其下端接触我们浏览器窗口的底部，因此我们将通过<code class="fe mx my mz na b">(3000-window.height)/2</code>沿y轴平移它。</li></ul><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nh ni l"/></div></figure><ul class=""><li id="a7cb" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">接下来，我们将从网上下载一个免费的3D模型(<a class="ae lp" href="https://sketchfab.com/features/free-3d-models" rel="noopener ugc nofollow" target="_blank"> sketchfab </a>，<a class="ae lp" href="https://www.cgtrader.com/free-3d-models" rel="noopener ugc nofollow" target="_blank"> cgtrader </a>等)。)并将其存储在<code class="fe mx my mz na b">assets/</code>中。在<code class="fe mx my mz na b"><strong class="ku io">Spaceship.js</strong></code>内部，我们将加载模型，添加纹理并存储其尺寸。对于加载模型，我们必须在<code class="fe mx my mz na b">index.html</code>中为我们的模型扩展<em class="lo">单独链接加载器</em>(我正在为我的<code class="fe mx my mz na b">.obj</code>模型链接OBJLoader)</li></ul><pre class="kd ke kf kg gt nj na nk nl aw nm bi"><span id="1af6" class="nn ls in na b gy no np l nq nr">&lt;script src="<a class="ae lp" href="https://unpkg.com/three@0.87.0/examples/js/loaders/OBJLoader.js" rel="noopener ugc nofollow" target="_blank">https://unpkg.com/three@0.87.0/examples/js/loaders/OBJLoader.js</a>"&gt; &lt;/script&gt;</span></pre><p id="7326" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">下面是<code class="fe mx my mz na b">Spaceship.js</code>的一个片段。请注意，我们这里还有一个update方法，每一帧都会调用它。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nh ni l"/></div></figure><ul class=""><li id="fbc1" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">在<code class="fe mx my mz na b"><strong class="ku io">SceneManager.js</strong></code>中，我们将创建一个新方法<code class="fe mx my mz na b">createSceneSubjects</code>来初始化我们的对象(背景和飞船)。我们还将维护一个动态主题数组<em class="lo"/>(那些需要每帧更新的)。</li></ul><pre class="kd ke kf kg gt nj na nk nl aw nm bi"><span id="b0d4" class="nn ls in na b gy no np l nq nr">function createSceneSubjects(scene) {<br/>    theBackground = new Background(scene);<br/>    theSpaceship  = new Spaceship(scene);</span><span id="9b83" class="nn ls in na b gy ns np l nq nr">    dynamicSubjects.push(theSpaceship);<br/>}</span></pre><p id="4f82" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku io">记住</strong>链接<code class="fe mx my mz na b">index.html</code>里面新的<code class="fe mx my mz na b">.js </code>文件。在重新加载浏览器时，我们的游戏看起来像这样。耶，我们的太空船来了！</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nt"><img src="../Images/da172c2841d29b2b5606e1b95cf8ac2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TfW9H84cWvTMv4jT8uLR0w.png"/></div></div></figure><p id="108f" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku io">步骤2后的源代码:</strong> <a class="ae lp" href="https://github.com/Fik-shun/threejs-game-medium/tree/step-2" rel="noopener ugc nofollow" target="_blank">链接</a></p><h1 id="8e46" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">第三步。移动我们的场景</h1><p id="0c22" class="pw-post-body-paragraph ks kt in ku b kv mj jo kx ky mk jr la lb ml ld le lf mm lh li lj mn ll lm ln ig bi translated">我们现在将移动我们的场景，因此以恒定的速度向上移动相机和宇宙飞船(直到背景持续)。</p><ul class=""><li id="0941" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">在<code class="fe mx my mz na b"><strong class="ku io">Spaceship.js</strong></code>的更新功能里面，我们沿着y轴匀速平移我们的飞船。</li></ul><pre class="kd ke kf kg gt nj na nk nl aw nm bi"><span id="3102" class="nn ls in na b gy no np l nq nr">this.update = function() {<br/>    if (this.model)<br/>        this.model.position.y += 1;<br/>}</span></pre><ul class=""><li id="ebd5" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">类似地，我们以相同的恒定速度沿y轴平移相机。我们还将在每一帧调用dynamicSubjects的update方法。<code class="fe mx my mz na b">SceneManager.js</code>的更新方法是这样的:</li></ul><pre class="kd ke kf kg gt nj na nk nl aw nm bi"><span id="713a" class="nn ls in na b gy no np l nq nr">this.update = function() {<br/>    if (camera.position.y &lt; 2000) {<br/>        camera.position.y += 1;<br/>        for(let i=0; i&lt;dynamicSubjects.length; i++)<br/>            dynamicSubjects[i].update();<br/>    }<br/>    renderer.render(scene, camera);<br/>}</span></pre><p id="24c2" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">太好了！重新装弹时，我们的场景在移动。🎆 🎆</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/14273c3347c8f215ed0f26c5223c91cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/1*z1v9p3vGhEYMvKoLOwsOsA.gif"/></div></figure><p id="7d0f" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku io">第三步后的源代码:</strong> <a class="ae lp" href="https://github.com/Fik-shun/threejs-game-medium/tree/step-3" rel="noopener ugc nofollow" target="_blank">链接</a></p><h1 id="a148" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">第四步。控制我们的飞船</h1><p id="9f9e" class="pw-post-body-paragraph ks kt in ku b kv mj jo kx ky mk jr la lb ml ld le lf mm lh li lj mn ll lm ln ig bi translated">游戏的基础已经建立，但我们现在想乘坐我们的飞船在太空中移动！是时候处理输入了。</p><ul class=""><li id="19f2" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">在<code class="fe mx my mz na b"><strong class="ku io">main.js</strong></code>内部，我们将为<code class="fe mx my mz na b">window.onkeydown</code>和<code class="fe mx my mz na b">window.onkeyup</code>添加<em class="lo">事件监听器</em>，并调用SceneManager的<code class="fe mx my mz na b">handleInput</code>方法。</li></ul><pre class="kd ke kf kg gt nj na nk nl aw nm bi"><span id="fc08" class="nn ls in na b gy no np l nq nr">function bindEventListeners() {<br/>    window.onkeydown = handleKeyDown;<br/>    window.onkeyup = handleKeyUp;<br/>}</span><span id="ef44" class="nn ls in na b gy ns np l nq nr">function handleKeyDown(event) {<br/>    var keyCode = event.which;<br/>    sceneManager.handleInput(keyCode, true);<br/>}<br/>function handleKeyUp(event) {<br/>    var keyCode = event.which;<br/>    sceneManager.handleInput(keyCode, false);<br/>}</span></pre><ul class=""><li id="4720" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">在<code class="fe mx my mz na b"><strong class="ku io">SceneManager.js</strong></code>内部，我们将维护一个键映射，它存储每个键的状态(如果按下则为<em class="lo">真</em>，否则为<em class="lo">假</em>)，这些键将在更新中被发送到我们飞船的<code class="fe mx my mz na b">handleInput</code>方法。我们将更新SceneManager的<code class="fe mx my mz na b">handleInput</code>方法中的键映射。</li></ul><pre class="kd ke kf kg gt nj na nk nl aw nm bi"><span id="af49" class="nn ls in na b gy no np l nq nr">this.update = function() {<br/>    ...<br/>    theSpaceship.handleInput(keyMap);<br/>    ...<br/>}<br/>this.handleInput = function(keyCode, isDown) {<br/>    keyMap[keyCode] = isDown;<br/>}</span></pre><ul class=""><li id="2084" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">最后，我们将映射键<em class="lo"> W，S，A，D </em>以在相应的方向平移飞船，同时确保它不会越界。</li></ul><pre class="kd ke kf kg gt nj na nk nl aw nm bi"><span id="e956" class="nn ls in na b gy no np l nq nr">this.handleInput = function(keyMap, camera) {<br/>  <br/>    if (keyMap[87] &amp;&amp; (this.model.position.y + this.height/2 &lt; camera.position.y + camera.top)) {<br/>        this.model.position.y += 5;<br/>    }<br/>    if (keyMap[83] &amp;&amp; (this.model.position.y - this.height/2 &gt; camera.position.y + camera.bottom)) {<br/>        this.model.position.y -= 5;<br/>    }<br/>    if (keyMap[68] &amp;&amp; (this.model.position.x + this.width/2 &lt; camera.right)) {<br/>        this.model.position.x += 5;   <br/>    }<br/>    if (keyMap[65] &amp;&amp; (this.model.position.x - this.width/2 &gt; camera.left)) {<br/>        this.model.position.x -= 5;<br/>    }<br/>}</span></pre><p id="a2f9" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">重新载入网页后，你就可以移动飞船了！🚀 🎆</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nv"><img src="../Images/805d0dcd250f44fb009f2865273bde81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*xuwsdxkCp1yxTix1uronfQ.gif"/></div></div></figure><p id="17bf" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku io">步骤4后的源代码:</strong> <a class="ae lp" href="https://github.com/Fik-shun/threejs-game-medium/tree/step-4" rel="noopener ugc nofollow" target="_blank">链接</a></p><h1 id="bd32" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">第五步。添加硬币和敌人</h1><p id="79ee" class="pw-post-body-paragraph ks kt in ku b kv mj jo kx ky mk jr la lb ml ld le lf mm lh li lj mn ll lm ln ig bi translated">让我们通过添加硬币和敌人来使我们的游戏更有趣。</p><ul class=""><li id="f9fb" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">在<code class="fe mx my mz na b">Coin.js</code>中创建一个新组件，创建一个球体，将其涂成金色，定位并存储其高度/宽度。</li></ul><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nh ni l"/></div></figure><ul class=""><li id="28a2" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">现在创建一个函数<code class="fe mx my mz na b">placeCoins</code>来随机地<strong class="ku io"/>将硬币散布在整个背景平面上，并在场景管理器的<code class="fe mx my mz na b">createSceneSubjects</code>方法中调用这个函数。</li><li id="ac60" class="mo mp in ku b kv nb ky nc lb nd lf ne lj nf ln mt mu mv mw bi translated">同样，你可以添加敌人并随机放置。我使用了敌人的<code class="fe mx my mz na b">.gltf</code>模型，因此链接了<code class="fe mx my mz na b">index.html</code>中的GLTFLoader。另外，<em class="lo">不要忘记</em>链接新的JavaScript文件。</li></ul><p id="f3e8" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我们的游戏现在看起来很刺激。但是我们如何对抗敌人呢？</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nw"><img src="../Images/256a5bcdbbe30cad320ca181db5f0739.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8msbBtOvOOrHdyyd1QAEeA.png"/></div></div></figure><p id="4dd5" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku io">步骤5后的源代码:</strong> <a class="ae lp" href="https://github.com/Fik-shun/threejs-game-medium/tree/step-5" rel="noopener ugc nofollow" target="_blank">链接</a></p><h1 id="5a13" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">第六步。发射导弹</h1><p id="3beb" class="pw-post-body-paragraph ks kt in ku b kv mj jo kx ky mk jr la lb ml ld le lf mm lh li lj mn ll lm ln ig bi translated">我们现在允许我们的飞船向我们的敌人发射导弹。同样，我们将创建一个导弹组件，每当按下空格键时初始化它，并给它一个恒定的速度。</p><ul class=""><li id="a848" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">所以造一个<em class="lo">导弹</em>组件类似上面的敌人。然后，在SceneManager的更新方法中，我们将处理<em class="lo"> Space </em>输入并将我们的导弹存储在一个数组中:</li></ul><pre class="kd ke kf kg gt nj na nk nl aw nm bi"><span id="e0f8" class="nn ls in na b gy no np l nq nr">this.update = function() {<br/>    ...<br/>    if (keyMap[32]) {<br/>        var x = theSpaceship.model.position.x;<br/>        var y = theSpaceship.model.position.y + theSpaceship.height/2;</span><span id="97c3" class="nn ls in na b gy ns np l nq nr">        const m = new Missile(scene, x, y);</span><span id="57ba" class="nn ls in na b gy ns np l nq nr">        dynamicSubjects.push(m);<br/>        theMissiles.push(m);<br/>        keyMap[32] = false;<br/>    }<br/>    ...<br/>}</span></pre><p id="ab4d" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">哇哦。我们终于可以射杀我们的敌人了，但是等等...为什么我们的敌人没有被消灭？</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nx"><img src="../Images/0fa5680bb763aae208e0b6d422a1b703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*An5HvZH8cJVGjWP9LY6rPg.png"/></div></div></figure><p id="dd47" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku io">第六步后的源代码:</strong> <a class="ae lp" href="https://github.com/Fik-shun/threejs-game-medium/tree/step-6" rel="noopener ugc nofollow" target="_blank">链接</a></p><h1 id="de9f" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">第七步。冲突检出</h1><p id="4833" class="pw-post-body-paragraph ks kt in ku b kv mj jo kx ky mk jr la lb ml ld le lf mm lh li lj mn ll lm ln ig bi translated">我们需要在游戏中加入碰撞检测，这样我们的飞船可以收集硬币，我们的导弹可以杀死敌人，飞船在与敌人碰撞时的生命值会减少。于是我们寻找这些模型之间的<strong class="ku io"> <em class="lo">交集</em></strong>:(a)飞船&amp;所有硬币，(b)飞船&amp;所有敌人，(c)所有导弹&amp;所有敌人。</p><ul class=""><li id="633c" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">我们需要在每一帧的<em class="lo">中检查碰撞，所以让我们创建一个函数<code class="fe mx my mz na b">checkCollsions</code>并在更新方法中调用它。下面的<code class="fe mx my mz na b">isCollision</code>函数将使用两个模型的位置和尺寸来确定它们之间的交集。</em></li></ul><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="f164" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在当我们重新加载时，我们的游戏感觉非常棒！</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nv"><img src="../Images/4bb140bdf181422d10ded2908f050f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*UDamEx44vbmac7WlmEMcDA.gif"/></div></div></figure><p id="7b16" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku io">第7步后的源代码:</strong> <a class="ae lp" href="https://github.com/Fik-shun/threejs-game-medium/tree/step-7" rel="noopener ugc nofollow" target="_blank">链接</a></p><h1 id="df85" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">第八步。添加记分板</h1><p id="606b" class="pw-post-body-paragraph ks kt in ku b kv mj jo kx ky mk jr la lb ml ld le lf mm lh li lj mn ll lm ln ig bi translated">最后，我们将使用基本的HTML在游戏顶部添加一个记分牌。</p><ul class=""><li id="c03e" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">我们将简单地在<code class="fe mx my mz na b">index.html</code>中添加两个<em class="lo">div</em>:一个用于记分牌，另一个用于显示<em class="lo">‘游戏结束’</em>或<em class="lo">‘你输了’</em>，并赋予它们适当的样式。</li></ul><pre class="kd ke kf kg gt nj na nk nl aw nm bi"><span id="4b24" class="nn ls in na b gy no np l nq nr">&lt;div id=”scoreboard”&gt;HEALTH: 3 &amp;emsp; SCORE: 0&lt;/div&gt;<br/>&lt;div id="gameover"&gt;&lt;/div&gt;</span><span id="522b" class="nn ls in na b gy ns np l nq nr">&lt;style type="text/css"&gt;<br/>    #scoreboard {<br/>      position: absolute;<br/>      top: 10px;<br/>      width: 100%;<br/>      z-index: 100;<br/>      font-size: 40px;<br/>      color: white;<br/>      display:block;<br/>    }</span><span id="60d4" class="nn ls in na b gy ns np l nq nr">    #gameover {<br/>      z-index: 100;<br/>      color: white;<br/>      font-size: 120px;<br/>      position: fixed;<br/>      top: 50%;<br/>      left: 50%;<br/>      transform: translate(-50%, -50%);<br/>    }<br/>&lt;/style&gt;</span></pre><ul class=""><li id="bd76" class="mo mp in ku b kv kw ky kz lb mq lf mr lj ms ln mt mu mv mw bi translated">在<strong class="ku io"> <em class="lo">每次碰撞</em> </strong>后，我们更新我们的变量<em class="lo">分数</em>和<em class="lo">健康</em>并更新记分牌<em class="lo"> div </em>。当我们飞船的<em class="lo">生命值</em>降到0时，我们显示— <strong class="ku io">你输了</strong>，当摄像机到达我们背景的尽头时，我们将显示— <strong class="ku io">游戏结束</strong>。</li></ul><p id="1c03" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">就是这样！我们的游戏是<strong class="ku io"> <em class="lo">终于</em> </strong>完成了，看起来太好玩了！</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nw"><img src="../Images/d09ae31d485a45871a893cfddf5bdb9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GFou7F2oM3e0PZ1lNEY6NA.png"/></div></div></figure><p id="d04a" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku io">步骤8后的源代码:</strong> <a class="ae lp" href="https://github.com/Fik-shun/threejs-game-medium/tree/step-8" rel="noopener ugc nofollow" target="_blank">链接</a></p></div><div class="ab cl ny nz hr oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ig ih ii ij ik"><h1 id="b2eb" class="lr ls in bd lt lu of lw lx ly og ma mb jt oh ju md jw oi jx mf jz oj ka mh mi bi translated">结论</h1><p id="2b18" class="pw-post-body-paragraph ks kt in ku b kv mj jo kx ky mk jr la lb ml ld le lf mm lh li lj mn ll lm ln ig bi translated">就这样，我们结束了。你可以在这里找到最终游戏<a class="ae lp" href="https://github.com/Fik-shun/threejs-game-medium/" rel="noopener ugc nofollow" target="_blank">的源代码</a>。</p><p id="8ba5" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">将这款游戏转换为<strong class="ku io"> 3D </strong>相当简单——你只需要将相机转换到<em class="lo">视角</em>并重新定位！在这里查看我的同一游戏<a class="ae lp" href="https://fik-shun.github.io/Fik-shoot/" rel="noopener ugc nofollow" target="_blank">的<strong class="ku io"> 3D版本</strong>，在这里</a>获取其源代码<a class="ae lp" href="https://github.com/Fik-shun/Fik-shoot" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nv"><img src="../Images/8f59cbf5ec2a96400f79245b334ad461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*tWr7liKC8Ch39qbcGxOYOA.gif"/></div></div></figure><p id="ac00" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我还为<strong class="ku io"> <em class="lo"> Unity3D </em> </strong>中的游戏制作了一个简短的<strong class="ku io">预告/预告片</strong>，同样令人难以置信！看这里的<a class="ae lp" href="https://www.youtube.com/watch?v=NTtcsSwfWnA" rel="noopener ugc nofollow" target="_blank"/>！</p><p id="379b" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">你可以给你的游戏增加更多的功能，比如强大的敌人(可以躲避导弹并向我们的飞船射击)，提高美感，或者增加飞船的速度。</p></div><div class="ab cl ny nz hr oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ig ih ii ij ik"><p id="b02b" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">非常感谢你的时间。希望你喜欢这个教程，它帮助你建立一个神话般的游戏。一旦完成，一定要上传(也许在GitHub上)并在评论中分享链接。我很想玩它们！</p><p id="59d0" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">甚至在这之前我也是初学Three.js。但是在这个过程中我学到了很多。我做的可能不完美，但肯定是打造一个完美游戏的良好开端。</p><p id="3d23" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果你觉得这个游戏缺少了什么或者可以有某些改进，请留下你的建议。如果你有任何疑问或遇到困难，请在评论中提出你的疑问。我会尽力帮忙的！</p><p id="fc5d" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">到时候见。下次见！</p><h2 id="259a" class="nn ls in bd lt ok ol dn lx om on dp mb lb oo op md lf oq or mf lj os ot mh ou bi translated">资源</h2><ul class=""><li id="9713" class="mo mp in ku b kv mj ky mk lb ov lf ow lj ox ln mt mu mv mw bi translated"><strong class="ku io"> Three.js基础知识:</strong> <a class="ae lp" href="https://medium.com/@benjamin.c.coleman/the-beginners-guide-to-beginning-three-js-c36b8947c2aa" rel="noopener">文章</a>，<a class="ae lp" href="https://www.youtube.com/playlist?list=PLRtjMdoYXLf6mvjCmrltvsD0j12ZQDMfE" rel="noopener ugc nofollow" target="_blank">视频系列</a>，<a class="ae lp" href="https://threejs.org/docs/" rel="noopener ugc nofollow" target="_blank">公文</a></li><li id="202a" class="mo mp in ku b kv nb ky nc lb nd lf ne lj nf ln mt mu mv mw bi translated"><strong class="ku io">整理Three.js项目:</strong> <a class="ae lp" href="https://pierfrancesco-soffritti.medium.com/how-to-organize-the-structure-of-a-three-js-project-77649f58fa3f" rel="noopener">文章</a></li><li id="ce9b" class="mo mp in ku b kv nb ky nc lb nd lf ne lj nf ln mt mu mv mw bi translated"><strong class="ku io">游戏源代码:</strong> <a class="ae lp" href="https://github.com/Fik-shun/threejs-game-medium/" rel="noopener ugc nofollow" target="_blank"> 2D版</a> &amp; <a class="ae lp" href="https://github.com/Fik-shun/Fik-shoot/" rel="noopener ugc nofollow" target="_blank"> 3D版</a></li></ul><p id="a335" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><em class="lo">更多内容请看</em><a class="ae lp" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="lo">plain English . io</em></a></p></div></div>    
</body>
</html>