<html>
<head>
<title>Get Started with TypeScript the Easy Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以最简单的方式开始使用TypeScript</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/get-started-with-typescript-the-easy-way-1a74d723925?source=collection_archive---------12-----------------------#2021-06-01">https://javascript.plainenglish.io/get-started-with-typescript-the-easy-way-1a74d723925?source=collection_archive---------12-----------------------#2021-06-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/013b739d77aa74279977de3f8a021820.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*emjsT1vG4ktzMPIG.png"/></div></div></figure><div class=""/><p id="4b15" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不可否认的是<a class="ae kw" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank"> TypeScript </a>已经在JavaScript社区站稳了脚跟。毫无疑问，它提供了像改进的<a class="ae kw" href="https://code.visualstudio.com/docs/editor/intellisense" rel="noopener ugc nofollow" target="_blank">智能感知</a>、<a class="ae kw" href="https://en.wikipedia.org/wiki/Static_program_analysis" rel="noopener ugc nofollow" target="_blank">静态分析</a>(又名“类型检查”)和内联文档这样的特性。</p><p id="c517" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些功能不是TypeScript独有的。它们是任何强类型语言的一部分，它们转化为生产力和代码质量的提高，例如:</p><ul class=""><li id="dfbc" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">使用键入时自动完成的代码建议更快地编写代码。</li><li id="e78b" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">如果代码中有打字错误或错误，会发出警告。</li><li id="8480" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">更容易将新人引入代码库。</li><li id="7955" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">团队成员更好地协作，跨越他们没有编写的代码。</li><li id="247d" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">可以防止损坏的代码通过自动部署。</li><li id="d6a1" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">使维护旧代码变得更容易、更安全。</li><li id="6805" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">可用于自动记录您的项目。</li></ul><p id="110e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这很好，但是我并不是想说服你使用TypeScript。本文面向听说过TypeScript并对开始使用它感兴趣的JavaScript开发人员，或者已经尝试过TypeScript并希望从另一个角度了解它的任何人。</p><p id="cbfc" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不像今天的许多教程，这一个将集中在最小化跟随的技术要求。我们将启动并运行TypeScript，而无需打开终端、安装依赖项，甚至无需初始化NPM项目。在高级部分，我们需要做一点，但是对于大多数用户来说，你需要的只是作为你的编辑器的Visual Studio代码。</p><h1 id="1786" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">级别1:在JavaScript文件中启用类型脚本</h1><p id="33da" class="pw-post-body-paragraph jy jz jb ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">VS Code 席卷了整个科技界。如果你不熟悉，这是一个代码编辑器，但是我敢打赌，如果你经常写JavaScript，你可能已经在使用它了。</p><p id="0941" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你知道VS代码内置了TypeScript吗？这就是它如何能够提供一些基本的智能感知和自动建议。</p><p id="e92c" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，我们可以创建一个具有名为<code class="fe mo mp mq mr b">hello</code>的属性的对象，并赋予它值<code class="fe mo mp mq mr b">"world"</code>。当我们试图访问该对象的属性时，VS代码会自动提示我们<code class="fe mo mp mq mr b">hello</code>。不仅如此，它还会告诉我们属性<code class="fe mo mp mq mr b">hello</code>是一个<code class="fe mo mp mq mr b">string</code>。</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ms"><img src="../Images/73f459c65740b501e13cc3d5b37fb1c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6P5lKKcQQoHozhqW.png"/></div></div></figure><p id="0c52" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个非常基本的类型检查，非常有用。然而，如果我们启用了更好的类型检查，有几个错误仍然可以进入我们的代码库，这些错误本来是可以避免的。</p><p id="6644" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，如果我们不小心将一个数字传递给了一个需要字符串的函数，我们可能会遇到问题。</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mx"><img src="../Images/b5ae98ccd107186cec0ee5d8803bfbe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ky66TuVgvaakGaSk.png"/></div></div></figure><p id="b52c" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">VS代码实际上有一个特性，可以让<a class="ae kw" href="https://code.visualstudio.com/docs/nodejs/working-with-javascript#_type-checking-javascript" rel="noopener ugc nofollow" target="_blank">对JavaScript文件</a>进行全面的类型检查。最棒的是它超级简单。您所要做的就是将这个注释添加到您想要添加类型检查的JavaScript文件的顶部:</p><p id="57ba" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有了这个注释，我们在文件中启用了更严格的类型检查。现在，如果我们在代码库中引入可能的错误，我们将会看到更多的提示。例如，如果我们试图用一个数字覆盖对象的<code class="fe mo mp mq mr b">hello</code>属性，我们将得到一个警告，告诉我们“Type 'number '不能赋给type 'string '”:</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div class="gh gi my"><img src="../Images/a4bd2f327e7b04f157b7fc19e50bf825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/0*w9oPO8azs0ielPWt.png"/></div></figure><p id="3768" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此时，我们前面的函数不会给我们任何提示，说明我们的代码有错误，那是因为TypeScript不知道输入只能是字符串。为了解决这个问题，我们可以用<a class="ae kw" href="https://jsdoc.app/" rel="noopener ugc nofollow" target="_blank"> JSDoc </a>向JavaScript添加类型。</p><p id="37c3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">JSDoc是一个通过使用注释向你的源代码添加上下文文档的系统，它可以用来自动生成文档网站。然而，我们今天最感兴趣的好处是TypeScript支持解析JSDoc注释。</p><p id="689e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于我们的示例函数，我们可以告诉TypeScript，<code class="fe mo mp mq mr b">yell</code>函数的第一个参数是一个名为<code class="fe mo mp mq mr b">str</code>的函数，并且是一种“字符串”类型。该函数的结果也是一个“字符串”。</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mz"><img src="../Images/5f2ba6f833619a86a0d26dc5bcdf21e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jIPlwBghiLs0O-lt.png"/></div></div></figure><p id="83f5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，当我们试图向函数传递一个数字时，我们会看到一个红色的弯曲警告。将鼠标悬停在它上面，我们会看到警告，“类型为‘number’的参数不能赋给类型为‘string’的参数。”谢谢！</p><p id="b5e1" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">学习如何用JSDoc记录一切需要时间、学习和实践。这有点超出了今天主题的范围，但了解更多信息的一个好地方是<a class="ae kw" href="https://jsdoc.app/" rel="noopener ugc nofollow" target="_blank"> jsdoc.app </a>。</p><h1 id="858e" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">级别2:在JavaScript项目中启用TypeScript</h1><p id="dc95" class="pw-post-body-paragraph jy jz jb ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">如果您和我一样，您将很快看到使用JSDoc记录代码的好处，同时在您出错时让TypeScript对您大喊大叫。但是，如果您从事大型JavaScript项目，用不了多久，您就会厌倦向每个文件添加<code class="fe mo mp mq mr b">// @ts-check</code>。</p><p id="f575" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">幸运的是，VS Code为<a class="ae kw" href="https://code.visualstudio.com/docs/nodejs/working-with-javascript#_javascript-projects-jsconfigjson" rel="noopener ugc nofollow" target="_blank">提供了一些方法，让它知道</a>你希望它在每个JavaScript文件上做那种类型脚本的事情。一种方法是将“检查JS”配置设置为<code class="fe mo mp mq mr b">true</code>。在<code class="fe mo mp mq mr b">settings.json</code>文件中，设置为<code class="fe mo mp mq mr b">"javascript.implicitProjectConfig.checkJs": true</code></p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/8308f87a411e7558055284d6edd3c2dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*72yudlk3hnvTV-_r.png"/></div></div></figure><p id="0fe5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以在用户级别或工作区级别执行此操作，但只有您可以这样做。</p><p id="4d83" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您正在一个团队中工作，并且想要在项目级别上为每个人启用这个特性，您可以通过向您的项目的根文件夹添加一个<code class="fe mo mp mq mr b"><a class="ae kw" href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html" rel="noopener ugc nofollow" target="_blank">tsconfig.json</a></code>文件来实现。通常，我只是将同一个文件复制到每个项目中，但是让我们使用TypeScript初始化命令从头开始创建一个全新的文件:</p><p id="4bf7" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个文件可以用来配置一些选项，但是现在我们只对告诉VS代码使用TypeScript检查JavaScript文件的选项感兴趣。有关tsconfig.json配置选项的更多详细信息，请参见<a class="ae kw" href="https://www.staging-typescript.org/tsconfig" rel="noopener ugc nofollow" target="_blank">www.staging-typescript.org/tsconfig</a>。</p><pre class="mt mu mv mw gt nb mr nc nd aw ne bi"><span id="fc23" class="nf lm jb mr b gy ng nh l ni nj">{<br/>  "compilerOptions": {<br/>    "checkJs": true,               /* Report errors in .js files. */<br/>  }<br/>}</span></pre><p id="91c2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我更喜欢这样做，因为我领导一个团队，我不想向人们解释如何在他们的设置中启用类型检查。我们不需要担心保持每个人的编辑器设置同步。</p><p id="38fb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，无论您喜欢哪种方式，您都可以让TypeScript检查所有JavaScript文件的潜在错误，而无需做任何其他事情。万岁！</p><p id="1e0f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">JSDocs支持多种内置类型:<code class="fe mo mp mq mr b">string</code>、<code class="fe mo mp mq mr b">number</code>、<code class="fe mo mp mq mr b">boolean</code>、<code class="fe mo mp mq mr b">array</code>、<code class="fe mo mp mq mr b">promise</code>、<code class="fe mo mp mq mr b">function</code>等。然而，在您想要创建基本原始值之外的类型定义之前，并不需要花费很长时间。例如，假设我们想要定义一个“狗”对象类型，它有一个“品种”、“年龄”和一个可选的“名称”属性。JSDoc在那里还是可以支持你的。</p><p id="103d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以这样定义类型:</p><pre class="mt mu mv mw gt nb mr nc nd aw ne bi"><span id="aedb" class="nf lm jb mr b gy ng nh l ni nj">/**<br/> * @typedef {object} Dog<br/> * @property {string} breed<br/> * @property {number} age<br/> * @property {string} [name]<br/> */</span></pre><p id="e56b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有几种不同的方法来定义对象，这是一种语法。我不想在定义类型的细节上花费太多时间。关于这方面的更多细节，请随意浏览<a class="ae kw" href="https://jsdoc.app/" rel="noopener ugc nofollow" target="_blank"> JSDoc文档</a>。当您进入更高级的需求时，研究TypeScript的<a class="ae kw" href="https://www.typescriptlang.org/docs/handbook/generics.html" rel="noopener ugc nofollow" target="_blank">泛型</a>和<a class="ae kw" href="https://www.typescriptlang.org/docs/handbook/utility-types.html" rel="noopener ugc nofollow" target="_blank">实用程序类型</a>也是值得的。</p><p id="9b6c" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的观点是向您展示如何在您的代码库中导入类型定义。这花了我一点时间来学习，所以希望，我可以节省你一些搜索。</p><p id="6cf3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设我们想用一个文件来定义一些全局类型。姑且称之为<code class="fe mo mp mq mr b">types.js</code>。我们可以将我们的Dog类型定义放入其中，并从不同的文件中，通过引用其相对路径，我们可以在另一个文件中导入并使用该类型:</p><pre class="mt mu mv mw gt nb mr nc nd aw ne bi"><span id="27f6" class="nf lm jb mr b gy ng nh l ni nj">/** @type {import('./types).Dog} */<br/>const myDog = {<br/>  breed: 'Chiweenie',<br/>  age: 4,<br/>  name: 'Nugget'<br/>}</span></pre><p id="3d2e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们发现自己在同一个文件的许多地方使用了<code class="fe mo mp mq mr b">Dog</code>类型，我们可以通过在本地重新定义类型定义来节省一些输入:</p><pre class="mt mu mv mw gt nb mr nc nd aw ne bi"><span id="0f29" class="nf lm jb mr b gy ng nh l ni nj">/** @typedef {import('./types).Dog} Dog */<br/><br/>/** @type {Dog} */<br/>const myDog = {<br/>  breed: 'Chiweenie',<br/>  age: 4,<br/>  name: 'Nugget'<br/>}</span></pre><p id="d300" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你在阅读这篇文章的时候已经尝试过了，你可能遇到了一个小问题。现在，我们不能从我们的<code class="fe mo mp mq mr b">types.js</code>文件导入任何东西，因为那个文件不是JavaScript模块。我们的编辑会这么告诉我们，“File '/path/to/types.js '不是一个模块。”</p><p id="5330" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">解决方案是向该文件添加一个导出。您可以使用CommonJS或ES模块语法。导出的值无关紧要。甚至可以是<code class="fe mo mp mq mr b">undefined</code>。例如，以下任何一行都可以(注意，您只需要一行):</p><pre class="mt mu mv mw gt nb mr nc nd aw ne bi"><span id="e6f3" class="nf lm jb mr b gy ng nh l ni nj">// Works<br/>module.exports = {}<br/><br/>// Sure<br/>exports.merp = ''<br/><br/>// Why not?<br/>export default = null<br/><br/>// Go for it<br/>export const thingamabob = undefined</span></pre><p id="a51f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">也可以从第三方库中导入类型定义。语法非常相似，但不是使用相对路径，而是通过名称引用库。例如，一个<a class="ae kw" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue.js </a>组件可以使用以下类型:</p><pre class="mt mu mv mw gt nb mr nc nd aw ne bi"><span id="42bc" class="nf lm jb mr b gy ng nh l ni nj">/** @type {import('vue').Component} */</span></pre><p id="04fe" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并非所有的库都提供类型定义。你只需要试着看看VS代码是否会自动推荐给你使用。但是如果你的库没有提供类型定义，那么在definitelytyped.org<a class="ae kw" href="https://definitelytyped.org/" rel="noopener ugc nofollow" target="_blank">可能还有一个社区提供的类型包，所以也看看吧。VS代码有一个特性叫做“</a><a class="ae kw" href="https://code.visualstudio.com/Docs/languages/javascript#_intellisense-is-not-working-for-external-libraries" rel="noopener ugc nofollow" target="_blank">自动类型获取</a>”，它会自动为你寻找并安装社区类型定义。</p><p id="4b3a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，我将指出，如果您喜欢这种语法，也可以在TypeScript文件中编写类型定义。JSDoc的导入看起来完全一样。唯一改变的是文件扩展名(以。ts)和语法。例如，如果我们想用TypeScript定义上面的全局类型，我们可以将文件名改为“type.ts ”,内容如下:</p><pre class="mt mu mv mw gt nb mr nc nd aw ne bi"><span id="8f1f" class="nf lm jb mr b gy ng nh l ni nj">export interface Dog {<br/>  breed: string<br/>  age: number<br/>  name?: string<br/>}</span></pre><h1 id="45ea" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">级别3:将TypeScript集成到CI/CD管道中</h1><p id="46de" class="pw-post-body-paragraph jy jz jb ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">到目前为止，我们已经完成了以上所有工作，没有构建步骤，没有安装任何依赖项(除了我们的编辑器)，没有初始化NPM命令，甚至没有打开命令行。那是多么令人耳目一新啊！？！？它只是普通的旧JavaScript，但是有超能力。</p><p id="40f3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们将开始探讨更复杂的问题。如果一个bug被引入到代码中，我们能阻止我们的代码被部署吗？</p><p id="74b3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本节的其余部分将进行以下假设:</p><ul class=""><li id="b2ca" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">您可以轻松地使用命令行。</li><li id="bcac" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">你对<a class="ae kw" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> NPM </a>有些经验(如果没有，你可以在<a class="ae kw" href="https://docs.npmjs.com/getting-started" rel="noopener ugc nofollow" target="_blank">docs.npmjs.com/getting-started</a>阅读NPM的入门页面)。</li><li id="5730" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">你熟悉<a class="ae kw" href="https://en.wikipedia.org/wiki/CI/CD" rel="noopener ugc nofollow" target="_blank"> CI/CD </a>(持续集成/持续交付)概念。</li><li id="c572" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">您已经有了一个用<a class="ae kw" href="https://docs.npmjs.com/cli/v6/configuring-npm/package-json" rel="noopener ugc nofollow" target="_blank"> package.json </a>文件初始化的NPM项目<a class="ae kw" href="https://docs.npmjs.com/cli/v6/commands/npm-init" rel="noopener ugc nofollow" target="_blank">。</a></li></ul><p id="cc14" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的目标是从CI/CD环境中运行TypeScript编译器，以便系统知道我们的代码是否有类型错误。这意味着我们不能再仅仅依靠VS代码为我们提供TypeScript，并告诉我们代码是否有错误。我们需要为CI/CD环境提供一个TypeScript版本和一个要运行的脚本。</p><p id="3720" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们要做的第一件事是在终端中运行这个命令(从与我们的项目相同的文件夹中):</p><pre class="mt mu mv mw gt nb mr nc nd aw ne bi"><span id="82a1" class="nf lm jb mr b gy ng nh l ni nj">npm install --save-dev typescript</span></pre><p id="8ed4" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将在本地安装TypeScript，并且还将通过将<code class="fe mo mp mq mr b">"typecript"</code>包作为开发依赖项来更新package.json文件。这对于运行我们项目的任何其他计算机来说都是必要的，以便知道要安装什么依赖项。有了这些，TypeScript现在就可以在不依赖VS代码的情况下用于项目了。</p><p id="33ef" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们需要能够告诉计算机如何实际运行TypeScript。我们可以用下面一行来更新package.json文件的<a class="ae kw" href="https://docs.npmjs.com/cli/v6/using-npm/scripts" rel="noopener ugc nofollow" target="_blank"> NPM“脚本”</a>部分:</p><p id="4a3b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将添加一个名为“ts”的新脚本，它将运行“tsc”命令，这是TypeScript编译器。现在我们可以运行命令“<code class="fe mo mp mq mr b">npm run ts</code>”，但是现在我们有两个错误。</p><ol class=""><li id="63c7" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv nk ld le lf bi translated">TypeScript希望知道要运行的文件的路径。</li><li id="5779" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv nk ld le lf bi translated">TypeScript仅适用于。ts文件，我们所有的文件都是。js文件。</li></ol><p id="c664" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是你需要自己做决定的地方。是继续写JavaScript文件，还是写TypeScript文件？</p><p id="0131" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就我个人而言，我认为把所有东西都放在JavaScript中会让生活变得更简单。TypeScript编译器很好地支持JavaScript文件，只是默认情况下没有启用。因此，在本教程的其余部分，我们将使用JavaScript，但请记住，这是我的个人偏好(更多原因在最后)。</p><p id="abde" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了解决这些问题，我们需要明确地告诉TypeScript要检查哪些文件，并且我们需要使用<code class="fe mo mp mq mr b">allowJs</code>配置来允许它在JavaScript文件上运行。假设我们的JavaScript是在<code class="fe mo mp mq mr b">./src/index.js</code>的一个文件中编写的，我们有几个选择。</p><ul class=""><li id="94b0" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">我们可以在package.json文件中的NPM脚本中添加“<code class="fe mo mp mq mr b">--allowJs ./src/index.js</code>”</li><li id="c19f" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">我们可以在每次调用NPM脚本时添加上面的命令:<code class="fe mo mp mq mr b">npm run ts -- --allowJs ./src/index.js</code></li><li id="fb2f" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">或者我们可以在项目的根目录中使用一个<a class="ae kw" href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html" rel="noopener ugc nofollow" target="_blank"> tsconfig.json </a>文件。</li></ul><p id="3fdf" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为我们已经有了一个tsconfig.json文件，所以让我们使用它。我们需要定义<code class="fe mo mp mq mr b">"files"</code>数组，并将<code class="fe mo mp mq mr b">"allowJs"</code>和<code class="fe mo mp mq mr b">"noEmit"</code>设置为<code class="fe mo mp mq mr b">true</code>:</p><pre class="mt mu mv mw gt nb mr nc nd aw ne bi"><span id="e551" class="nf lm jb mr b gy ng nh l ni nj">{<br/>  "files": ["./src/index.js"],<br/>  "compilerOptions": {<br/>    "checkJs": true,               /* Report errors in .js files. */<br/>    "allowJs": true,               /* Allow parsing javascript. */<br/>    "noEmit": true,                /* Do not emit outputs. */<br/>  }<br/>}</span></pre><p id="bbd7" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们在这里将<code class="fe mo mp mq mr b">"noEmit"</code>配置设置为<code class="fe mo mp mq mr b">true</code>，因为TypeScript通常用于传输代码。这意味着它接受一些代码并以某种方式进行转换。通常这是接收一个TypeScript文件并返回一个JavaScript文件，但是因为我们的文件已经是JavaScript了，所以这会导致覆盖我们的文件。我们将在下一节研究如何做，但是现在让我们保持简单。</p><p id="33d6" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们现在运行"<code class="fe mo mp mq mr b">npm run ts</code>"命令，我们应该不会有任何配置错误。我们应该只看到与代码中的bug相关的错误。举一个我们之前的例子，试图覆盖一个定义为字符串的对象中的属性会产生一个错误。</p><figure class="mt mu mv mw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ms"><img src="../Images/f4f9b2473dd6b4f920d9f35208daf1e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zsD1tQdPkBsF4ToJ.png"/></div></div></figure><p id="621e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">太好了！现在，我们已经准备好将这种类型检查集成到我们的自动化部署流程中。我们需要做的就是确保部署过程调用我们的<code class="fe mo mp mq mr b">"npm run ts"</code>命令，只要没有错误，它就会继续进行。</p><p id="07d3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不幸的是，有太多的变量让我无法准确地告诉您如何将它集成到您自己的部署过程中。对每个人来说都会有些不同，但是如果你已经走了这么远，那么我认为你可以从这里开始。</p><p id="9879" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我只想提最后一件事。TypeScript是对测试套件的一个很好的补充，但它决不是自动化测试的替代品。TypeScript可以消除进入代码库的几种不同类型的错误，但是如果你的项目依赖于自动化部署，你也应该使用<a class="ae kw" href="https://en.wikipedia.org/wiki/Unit_testing" rel="noopener ugc nofollow" target="_blank">单元</a>或者<a class="ae kw" href="https://en.wikipedia.org/wiki/Integration_testing" rel="noopener ugc nofollow" target="_blank">集成测试</a>。</p><p id="22ff" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，TypeScript可能会阻止您在必须是数字的地方使用字符串，但我不认为它可以阻止您在只允许正数的地方使用负数。</p><p id="56ef" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是说，我建议在您的系统中实现静态分析和自动化测试。我最喜欢的测试JavaScript项目的工具是<a class="ae kw" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> Jest </a>。</p><h1 id="bb83" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">级别4:为开源库生成类型定义</h1><p id="4a82" class="pw-post-body-paragraph jy jz jb ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">作为一名JavaScript开发人员和一个开源Vue.js库的维护者，我可以很坦然地说，人们对开源库的期望很高。一个日益增长的期望是类型定义(有时被称为“类型脚本支持”)，要么在库中，要么通过像<a class="ae kw" href="https://definitelytyped.org/" rel="noopener ugc nofollow" target="_blank">definitelytyped.org</a>这样的社区项目。</p><p id="47f0" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好消息是，我们可以使用当前的设置，不需要太多的努力，告诉TypeScript为我们的项目创建类型定义文件。一旦我们完成，我们将能够发布我们的库，用户将拥有漂亮的类型定义，以帮助改善他们与我们的库交互的体验。</p><p id="4113" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们需要对tsconfig.json文件做一些修改。我们想要移除<code class="fe mo mp mq mr b">"noEmit"</code>设置(或者将其设置为<code class="fe mo mp mq mr b">false</code>，将<code class="fe mo mp mq mr b">"declaration"</code>和“emitDeclarationOnly”设置为<code class="fe mo mp mq mr b">true</code>，并为<code class="fe mo mp mq mr b">"outDir"</code>提供一个路径。</p><p id="eef4" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">新文件应该大致如下所示:</p><pre class="mt mu mv mw gt nb mr nc nd aw ne bi"><span id="e600" class="nf lm jb mr b gy ng nh l ni nj">{<br/>  "files": ["./src/index.js"],<br/>  "compilerOptions": {<br/>    "checkJs": true,               /* Report errors in .js files. */<br/>    "allowJs": true,               /* Allow parsing javascript. */<br/>    "declaration": true,           /* Generates '.d.ts' file. */<br/>    "emitDeclarationOnly": true,   /* Only generate '.d.ts'. No JS */<br/>    "outDir": "./dist",            /* Send output to this directory. */<br/>  }<br/>}</span></pre><p id="62f5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以为<code class="fe mo mp mq mr b">"outDir"</code>选择任何想要的路径，但这是必需的设置。这就是我们生成的类型定义文件所在的位置。我将<code class="fe mo mp mq mr b">"emitDeclarationOnly"</code>设置为<code class="fe mo mp mq mr b">true</code>,因为我们已经在使用JavaScript，所以不需要编译步骤。每当我需要一个构建步骤时，我通常使用<a class="ae kw" href="https://babeljs.io/" rel="noopener ugc nofollow" target="_blank"> Babel.js </a>和<a class="ae kw" href="https://www.rollupjs.org/guide/en/" rel="noopener ugc nofollow" target="_blank"> Rollup.js </a>，但是今天我们保持简单。</p><p id="46c2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">既然我们的类型定义文件正在生成并被发送到一个<code class="fe mo mp mq mr b">/dist</code>文件夹，我们就要完成了。最后一步是告诉NPM这些文件的存在，这样任何使用我们库的开发者都可以受益。我们需要修改我们的package.json文件。</p><p id="a87f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要在NPM上发布任何内容，需要有<code class="fe mo mp mq mr b">"name"</code>和<code class="fe mo mp mq mr b">"version"</code>属性。我们还可以定义<code class="fe mo mp mq mr b">"types"</code>(又名<code class="fe mo mp mq mr b">"typings"</code>)属性来告诉TypeScript在哪个文件夹中查找我们库的类型定义文件。显然，如果你的类型定义文件(以<code class="fe mo mp mq mr b">.d.ts</code>结尾)和你的代码在同一个文件夹中，这就不需要<strong class="ka jc">了。尽管如此，还是建议显式声明你的类型定义将存在于何处，因为我们将上面的<code class="fe mo mp mq mr b">"outDir"</code>设置为<code class="fe mo mp mq mr b">/dist</code>文件夹，这就是我们将要使用的。</strong></p><p id="3167" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们的package.json文件可能看起来像这样:</p><pre class="mt mu mv mw gt nb mr nc nd aw ne bi"><span id="e1c1" class="nf lm jb mr b gy ng nh l ni nj">{<br/>  "name": "nuggetisthebest",<br/>  "version": "1.0.0",<br/>  "types": "dist",<br/>  "scripts": {<br/>    "ts": "tsc"<br/>  },<br/>  "devDependencies": {<br/>    "typescript": "^4.1.3"<br/>  }<br/>}</span></pre><p id="b38c" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有关向NPM发布库的更多信息，请参见<a class="ae kw" href="https://docs.npmjs.com/cli/v6/commands/npm-publish" rel="noopener ugc nofollow" target="_blank"> NPM文档</a>。</p><h1 id="1b5d" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">结束语</h1><p id="5b21" class="pw-post-body-paragraph jy jz jb ka b kb mj kd ke kf mk kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">那是一段相当长的旅程。我希望它足够彻底，可以学到一些东西，而不会让人不知所措。它或多或少地概述了我自己学习和使用TypeScript的个人历程。所以也不是完全没有个人观点和喜好。您的经验和偏好可能会有所不同。</p><p id="c801" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另外值得一提的是，虽然我更喜欢通过JSDocs使用TypeScript，但是使用<code class="fe mo mp mq mr b">.ts</code>文件更常见。TypeScript在很大程度上可以解析JSDocs，但这不是一对一的关系。有一些细微的差别，在<a class="ae kw" href="https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html" rel="noopener ugc nofollow" target="_blank">打字稿文档</a>中有更详细的描述。</p><p id="1771" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我更喜欢JSDocs方法，原因如下:</p><ul class=""><li id="c8c4" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">不需要构建步骤。这只是普通的JavaScript。</li><li id="e4f2" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">这意味着我可以将代码复制粘贴到任何JavaScript项目中。</li><li id="f525" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">没有新的语法，所以(对我来说)学起来更容易。</li><li id="ae05" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">在我的代码中混入更少的噪声。</li></ul><p id="f1fc" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">希望你今天学到了一些新东西，我回答了阅读这篇文章时出现的任何问题。如果没有，请在Twitter上联系我，这样我可以为你和其他可能有同样问题的人回答他们。</p><p id="2f54" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢这篇文章，请通过在Twitter上分享让我知道。如果你想知道什么时候有新文章发表，你也可以<a class="ae kw" href="https://twitter.com/stegosource" rel="noopener ugc nofollow" target="_blank">关注我</a>或者<a class="ae kw" href="https://austingil.com/newsletter/" rel="noopener ugc nofollow" target="_blank">订阅我的时事通讯</a>。</p><h1 id="4837" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">资源</h1><ul class=""><li id="eebd" class="kx ky jb ka b kb mj kf mk kj nl kn nm kr nn kv lc ld le lf bi translated"><a class="ae kw" href="https://code.visualstudio.com/docs/nodejs/working-with-javascript" rel="noopener ugc nofollow" target="_blank">通过<a class="ae kw" href="https://twitter.com/code" rel="noopener ugc nofollow" target="_blank"> VS代码</a>处理JavaScript </a></li><li id="65e4" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="https://devhints.io/jsdoc" rel="noopener ugc nofollow" target="_blank">JSDoc cheat sheet</a>by<a class="ae kw" href="https://twitter.com/devhints" rel="noopener ugc nofollow" target="_blank">dev hints</a></li><li id="cb52" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">罗伯特·比格斯用JSDoc编写的安全类型JavaScript</li><li id="21de" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">罗伯特·比格斯的JavaScript类型林挺</li></ul></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="c73a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="nv">原载于https://austingil.com</em><a class="ae kw" href="https://austingil.com/typescript-the-easy-way/" rel="noopener ugc nofollow" target="_blank"><em class="nv"/></a><em class="nv">。</em></p><p id="d9d5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="nv">更多内容请看</em><a class="ae kw" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="nv">plain English . io</em></a></p></div></div>    
</body>
</html>