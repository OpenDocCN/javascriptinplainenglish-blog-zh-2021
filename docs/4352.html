<html>
<head>
<title>Build Your Own Spotify Player with React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React Native构建您自己的Spotify播放器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/spotify-player-with-reactnative-f605e447ca9e?source=collection_archive---------7-----------------------#2021-08-30">https://javascript.plainenglish.io/spotify-player-with-reactnative-f605e447ca9e?source=collection_archive---------7-----------------------#2021-08-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3094" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我如何创建一个定制的Spotify播放器</h2></div><h2 id="05a9" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">介绍</h2><p id="e855" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">在本系列的第一篇文章中，我解释了我是如何管理ReactNative和Spotify的认证过程的。在这篇文章中，我将解释我是如何用swipecard动画创建自己的Spotify播放器的。观看这个<a class="ae lu" href="https://www.youtube.com/watch?v=UmSQqXhGjkA" rel="noopener ugc nofollow" target="_blank">视频</a>的快速演示。</p><p id="942e" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">你看看这里的回购<a class="ae lu" href="https://github.com/kevintomas1995/spotify_top_songs_player" rel="noopener ugc nofollow" target="_blank"/></p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ma"><img src="../Images/a3c8e802076e1b4bc0b6e7f70c8d903f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u11wldgImvCqwXYTnme1zA.jpeg"/></div></div></figure><h2 id="26e5" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">主屏幕</h2><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="4872" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">如果您看一下导入，您可以看到我们导入了三个自定义组件:CustomHeader、Player和MainSwiper。这些是应用程序中最有趣的部分。但首先让我们看看主屏幕的其余部分！</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="4811" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">我们定义了变量“index”，每次调用函数“onSwiped”都会改变这个变量。该函数是MainSwiper组件的一部分，它确保在刷卡时跟踪当前索引。</p><p id="d9e1" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">还需要索引来显示当前歌曲在spotify帐户前20首歌曲中的当前位置。因此，显示和播放的第一首歌曲将是您当前的热门歌曲。此外，还需要索引来告诉播放器组件中的spotify api需要播放哪首歌曲。</p><p id="9055" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">这就是主屏幕。让我们继续这个应用程序更有趣的部分。</p><h2 id="1fca" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">播放器组件</h2><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="d300" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">正如你可以从导入中得到的，我在这里不是直接与Spotify Api对话。相反，我使用的是<a class="ae lu" href="https://github.com/thelinmichael/spotify-web-api-node" rel="noopener ugc nofollow" target="_blank"> Spotify Web Api节点，</a>，这使得与Spotify Api的通信更加容易。</p><p id="7320" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">首先，我们需要创建一个api实例，如上面的第一行代码所示。其次，我们需要向spotify api提供从身份验证过程中获得的访问令牌。然后我们就可以开始使用api了！</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="1fd5" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">在这个useEffect钩子中，我们引用了从身份验证过程中获得的topSong数据。为了通过api播放一首歌曲，我们需要提供一个song_uri，它包含在topSong数据中。因此，每当Home组件中的索引发生变化时，spotify api也会播放不同的歌曲。最后，我们的topSong数据是一个Song对象数组，我们对其进行迭代。props.index告诉api应该选择数组中的哪个对象。</p><p id="4c14" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">这两个api调用(spotifyapi . pause()spotifyapi . play())被包装在两个TouchableOpacities中，这两个TouchableOpacities表示播放和暂停按钮。根据“播放”状态，其中一个会显示出来并可触摸，然后播放会暂停或继续。</p><h2 id="31ef" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">Swiper组件</h2><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="a224" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">在swiper组件中，我们使用了<a class="ae lu" href="https://github.com/alexbrillant/react-native-deck-swiper" rel="noopener ugc nofollow" target="_blank"> react-native-deck-swiper包</a>，这使得实现swipecard动画变得非常容易！</p><p id="bf87" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">然后，您只需要向Swiper组件提供一些数据，在本例中就是我们的topSongs。我们正在映射这个topSongs数组的所有对象，对于每首歌曲，我们都显示一个带有背景、实际封面图像、歌曲名称和艺术家的视图。对于背景样式，我使用的是expo-blur的BlurView组件，看起来很酷吧？</p><p id="4852" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">请随意查看这里的其余代码，在我看来没有什么特别的。</p><h2 id="98e9" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">结论</h2><p id="f979" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">这就是你用几行代码创建自己的Spotify播放器有多容易。我希望你喜欢这篇文章。如果你有，请在这里留下赞和评论。</p><p id="74a1" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated">祝您愉快！</p><p id="a4ca" class="pw-post-body-paragraph lb lc iq ld b le lv jr lg lh lw ju lj ko lx ll lm ks ly lo lp kw lz lr ls lt ij bi translated"><em class="mo">更多内容尽在</em><a class="ae lu" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="ld ir"><em class="mo">plain English . io</em></strong></a></p></div></div>    
</body>
</html>