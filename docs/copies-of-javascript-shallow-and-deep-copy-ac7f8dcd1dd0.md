# JavaScript 中的浅层和深层复制

> 原文：<https://javascript.plainenglish.io/copies-of-javascript-shallow-and-deep-copy-ac7f8dcd1dd0?source=collection_archive---------0----------------------->

## 理解并学习 JavaScript 中深层和浅层拷贝的区别

![](img/689b2893b1c37ea14f9417da25cd95fd.png)

Photo by [Ferenc Almasi](https://unsplash.com/@flowforfrank?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

JavaScript 是一种高级动态类型语言。像大多数其他编程语言一样，JavaScript 提供并允许支持深度复制和浅层复制的概念。就复制对象而言，将 JavaScript 与其他编程语言进行比较有点棘手。

从高层次来看，复制品只是看起来像旧的东西，但不是。当您更改副本时，您希望原始内容保持不变，而副本却发生了变化。

在编程语言中，我们将值存储在变量中。制作副本意味着您用相同的值初始化一个新变量。然而，在浅层拷贝和深层拷贝之间有一个很大的陷阱需要考虑。

**浅拷贝**:表示某些值或子值仍然与原变量相连。基本上，如果对象的任何字段被其他对象引用，它们共享相同的内存地址。

让我们举个例子来更好地理解——

**深度复制**:与浅层复制不同，深度复制复制旧对象的所有属性，并为新对象分配单独的内存地址。这有助于我们创建一个克隆对象，而不用担心更改旧对象的值。根据对象结构的不同，创建深层副本的方法有很多种，但适用于所有类型的方法是 JSON.parse()和 JSON.stringify()。下面是一个例子:

如果我们真的需要理解复制，我们必须了解如何在 JavaScript 中存储值。

# **原始数据类型**

*   数字(常数 a = 1)
*   字符串(const a = 'string ')
*   布尔值(常数 a =真)
*   未定义(常数 a =未定义)
*   null(常数 a = null)

当您创建原始数据类型的副本时，您不需要担心，因为它们与变量紧密耦合。所以它将永远是一个真正的副本。让我们看一个例子:

# **复合数据类型**

*   数组(从技术上来说，它们也是对象，所以它们的行为是一样的)。
*   目标

当您创建一个复合数据类型时，这些值实际上在实例化时被存储一次，分配一个变量只是创建一个对该值的引用。下面是一个例子:

在上面的例子中，我们实际上做了一个对象的浅层拷贝。这通常是有问题的，因为我们期望旧的变量有原始值，而不是改变的值。因为很多开发人员并不真正理解这个概念，也不希望对象发生变化。

让我们看看复制复合数据类型的不同方法

# **数组**

对于复制，数组类似于复制对象，因为数组也是对象。

## 传播算子

从技术上讲，它不提供完整的深层拷贝。仅当数组不是嵌套数组或 2D 或 3D 等时，它才提供深度复制。如果数组是嵌套数组，它提供值的第一个实例的深层副本，所有嵌套数组都是浅层副本。为了更好地理解，我举了一个例子:

**数组方法——映射、ForEach 和切片**

所有这些方法都返回一个新数组，但它们不提供完整的深度复制，类似于 spread 运算符，它不为嵌套数组提供深度复制。下面是一个例子:

地图:

切片:

ForEach:

**JSON 解析和 Stringify 方法**

毫无顾虑地复制对象的最好方法是 JSON 方法，它提供了完整的**深度复制**。但是您可以为嵌套数组的深层副本创建自己的自定义函数，或者使用外部库，如 JQuery 和 lodash。下面是一个例子:

# 目标

复制对象有很多种方法。

使用 assign 方法时，我们必须确保对象至少复制第二个参数。通常你只需要传递一个空的对象作为第一个参数。它不提供类似于 spread 操作符的完整深度拷贝。下面是一个例子:

**Object.create()
现有对象可用作原型，使所有属性可用于新对象。但是在复制方面，它提供了部分深度复制，如赋值和扩展操作符。**

**传播算子**

如果我们知道嵌套对象的深度，我们可以使用嵌套扩展操作符来实现深度复制。但是如果深度未知，那么最好避免对深度拷贝使用 spread 操作符。下面是一个例子:

**JSON 解析和 Stringify 方法**

毫无顾虑地复制对象的最好方法是 JSON 方法，它提供了完整的深度复制。但是您可以为嵌套数组的深层副本创建自己的自定义函数，或者使用外部库，如 JQuery 和 lodash。下面是一个例子:

JavaScript 中复制对象的唯一缺陷是嵌套值。

更多关于 **JSON 解析和 Stringify 方法的见解:**[https://JavaScript . plain English . io/create-your-own-implementation-of-JSON-Stringify-simi applied-version-8ab 6746 CD D1](/create-your-own-implementation-of-json-stringify-simiplied-version-8ab6746cdd1)

*更多内容请看*[***plain English . io***](http://plainenglish.io/)