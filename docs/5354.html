<html>
<head>
<title>Ever Heard of Lenses?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">听说过镜片吗？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/ever-heard-of-lenses-a480bea08786?source=collection_archive---------8-----------------------#2021-11-03">https://javascript.plainenglish.io/ever-heard-of-lenses-a480bea08786?source=collection_archive---------8-----------------------#2021-11-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="3a2a" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">透镜被用在函数式编程中，你可能在没有注意到的情况下使用它们！</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/a5be3c0838b20ce0e6aca06d5225e3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8wNDPonLNCkczEAb1API_A.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@jamesbold?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">James Bold</a> on <a class="ae ks" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="742b" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">定义</h1><p id="1e7e" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">根据这个比喻，镜头允许我们聚焦于更大的物体(<code class="fe mh mi mj mk b">V</code>)的特定部分(<code class="fe mh mi mj mk b">U</code>):</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ml mm l"/></div></figure><h1 id="25df" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">请用案例！</h1><p id="7fd3" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">在<strong class="ln io">不变性</strong>的背景下更新对象的子部分时，镜头尤其有用。</p><p id="b900" class="pw-post-body-paragraph ll lm in ln b lo mn jo lq lr mo jr lt lu mp lw lx ly mq ma mb mc mr me mf mg ig bi translated">在下面的例子中，我们只愿意更新一个<code class="fe mh mi mj mk b">car</code>的<code class="fe mh mi mj mk b">speed</code>。写<code class="fe mh mi mj mk b">car.speed = { value: 60, unit: "km/h" };</code>将<strong class="ln io">不能</strong>工作，因为<code class="fe mh mi mj mk b">car</code>，内存中对<code class="fe mh mi mj mk b">Car</code>对象的引用，是不变的。这样做，我们简化了变更检测机制(例如，如果使用Redux)。</p><p id="524b" class="pw-post-body-paragraph ll lm in ln b lo mn jo lq lr mo jr lt lu mp lw lx ly mq ma mb mc mr me mf mg ig bi translated">一个<code class="fe mh mi mj mk b">Lens&lt;Car, Speed&gt;</code>只允许处理和更新<code class="fe mh mi mj mk b">speed</code>，同时返回一个全新的<code class="fe mh mi mj mk b">car</code>对象:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ml mm l"/></div></figure><h1 id="80e5" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">镜头容易构图！</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ms"><img src="../Images/0990eafa24fdf7d38109ae4fb77d79a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gO2R64yBXccRm67m_KdADA.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@jakobowens1?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Jakob Owens</a> on <a class="ae ks" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="97cc" class="pw-post-body-paragraph ll lm in ln b lo mn jo lq lr mo jr lt lu mp lw lx ly mq ma mb mc mr me mf mg ig bi translated">为了建造“更强”的透镜，可以使用管道透镜:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="8517" class="pw-post-body-paragraph ll lm in ln b lo mn jo lq lr mo jr lt lu mp lw lx ly mq ma mb mc mr me mf mg ig bi translated">在前面的例子中，我们关注的是<code class="fe mh mi mj mk b">speed</code>。但是现在，在<code class="fe mh mi mj mk b">Speed</code>对象中，我们想关注它的值，假设单位保持不变。因此，我们创建了第二个镜头，并结合两个镜头:</p><pre class="kd ke kf kg gt mt mk mu mv aw mw bi"><span id="049a" class="mx ku in mk b gy my mz l na nb">Car --(focusOnSpeed)--&gt; Speed --(focusOnValue)--&gt; number<br/>Car --(focusOnSpeedValue)--&gt; number</span></pre><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ml mm l"/></div></figure><h1 id="5176" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">减速器让事情变得更加有趣！</h1><p id="6522" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">作为一种以不可变方式更新<code class="fe mh mi mj mk b">State</code>的方式，Reducers在函数式编程中被广泛使用。换句话说，它们允许计算一个更新的状态，而无需进行最终的突变(<code class="fe mh mi mj mk b">state = updatedState</code>)。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="1883" class="pw-post-body-paragraph ll lm in ln b lo mn jo lq lr mo jr lt lu mp lw lx ly mq ma mb mc mr me mf mg ig bi translated">看起来，透镜与渐缩管组合得非常好:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="12dd" class="pw-post-body-paragraph ll lm in ln b lo mn jo lq lr mo jr lt lu mp lw lx ly mq ma mb mc mr me mf mg ig bi translated">这有什么用？同样，在下面的例子中，它允许我们为一个<code class="fe mh mi mj mk b">car</code>的唯一<code class="fe mh mi mj mk b">speed</code>属性编写一个reducer，并且最终仍然得到一个全新的<code class="fe mh mi mj mk b">Car</code>对象:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ml mm l"/></div></figure><h1 id="3e68" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">这有印象吗？</h1><p id="575e" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">Redux <code class="fe mh mi mj mk b">combineReducers</code>，对！</p><p id="747d" class="pw-post-body-paragraph ll lm in ln b lo mn jo lq lr mo jr lt lu mp lw lx ly mq ma mb mc mr me mf mg ig bi translated">看官方<a class="ae ks" href="https://redux.js.org/api/combinereducers" rel="noopener ugc nofollow" target="_blank"> Redux文档</a>怎么说:</p><blockquote class="nc nd ne"><p id="640a" class="ll lm nf ln b lo mn jo lq lr mo jr lt ng mp lw lx nh mq ma mb ni mr me mf mg ig bi translated">随着你的应用程序变得越来越复杂，你会想把你的reducing函数拆分成单独的函数，每个函数管理状态的独立部分。<code class="fe mh mi mj mk b">combineReducers</code>辅助函数将一个值为不同减函数的对象转换成一个可以传递给<code class="fe mh mi mj mk b">createStore</code>的减函数。</p></blockquote><p id="3927" class="pw-post-body-paragraph ll lm in ln b lo mn jo lq lr mo jr lt lu mp lw lx ly mq ma mb mc mr me mf mg ig bi translated">让我们好奇的看一下<code class="fe mh mi mj mk b">combineReducers</code>(从第181行开始的<a class="ae ks" href="https://github.com/reduxjs/redux/blob/5855f71a43ce4a701b7e6ed1dbc083db83b766d7/src/combineReducers.ts#L181" rel="noopener ugc nofollow" target="_blank">，来自GitHub上的Redux’repository)背后的代码:</a></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="4e27" class="pw-post-body-paragraph ll lm in ln b lo mn jo lq lr mo jr lt lu mp lw lx ly mq ma mb mc mr me mf mg ig bi translated">看到了吗？这正是我们对镜头所做的，尽管这里没有提到抽象。</p></div><div class="ab cl nj nk hr nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ig ih ii ij ik"><p id="84c5" class="pw-post-body-paragraph ll lm in ln b lo mn jo lq lr mo jr lt lu mp lw lx ly mq ma mb mc mr me mf mg ig bi translated">就是这样！镜头是函数式编程的基本工具之一。我很高兴收到您的回复，因为我想您会发现大量的用例！</p><h1 id="16f0" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">进一步阅读</h1><ul class=""><li id="3349" class="nq nr in ln b lo lp lr ls lu ns ly nt mc nu mg nv nw nx ny bi translated"><a class="ae ks" href="https://github.com/mathieueveillard/lenses" rel="noopener ugc nofollow" target="_blank">https://github.com/mathieueveillard/lenses</a></li><li id="3330" class="nq nr in ln b lo nz lr oa lu ob ly oc mc od mg nv nw nx ny bi translated"><a class="ae ks" href="https://medium.com/javascript-scene/lenses-b85976cb0534" rel="noopener">https://medium.com/javascript-scene/lenses-b85976cb0534</a></li></ul><p id="45df" class="pw-post-body-paragraph ll lm in ln b lo mn jo lq lr mo jr lt lu mp lw lx ly mq ma mb mc mr me mf mg ig bi translated"><em class="nf">更多内容请看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ln io"><em class="nf">plain English . io</em></strong></a></p></div></div>    
</body>
</html>