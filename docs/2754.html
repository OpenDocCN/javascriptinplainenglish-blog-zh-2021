<html>
<head>
<title>How to Enforce Coding Standards Using Husky Pre-Commit Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Husky预提交挂钩实施编码标准</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-enforce-coding-standards-using-husky-pre-commit-hooks-94d07bd5226d?source=collection_archive---------14-----------------------#2021-06-05">https://javascript.plainenglish.io/how-to-enforce-coding-standards-using-husky-pre-commit-hooks-94d07bd5226d?source=collection_archive---------14-----------------------#2021-06-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/ab72cb6fc83f49e8e7a86a82f622c478.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*URsOKB8clZV1Okh5.png"/></div></div></figure><p id="a4c5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">随着应用程序的扩展，保持一致性和执行编码标准变得非常重要。自动化过程以确保质量标准并使应用程序可维护变得很重要。ESLint和Prettier可以用来定义这些标准，但是我们也需要一个工具来执行它们。Husky通过提供可根据我们的需求进行配置的预提交git挂钩来提供该功能。</p><p id="d9e7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这些标准也可以通过在CI级别对pull请求使用门控检查来实施，但是Husky是在本地机器级别实施的替代方法。</p><h1 id="4052" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">什么是哈士奇？</h1><p id="c871" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">Husky是一个npm包，使管理Git挂钩变得容易。当用Git初始化时，它启用了一个称为钩子的特性(如果您想知道，与react钩子没有关联)。</p><p id="6787" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">它提供了预推送、预重定基、预提交和其他类似的挂钩。这些钩子允许一种机制在git命令运行之前执行一个动作。</p><p id="01dc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要查看项目中所有挂钩的列表，我们可以运行:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="cced" class="mf ku in mb b gy mg mh l mi mj">ls .git/hooks</span></pre><p id="9d55" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所有git挂钩及其用法的列表可以在这里找到。</p><p id="4d63" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">出于我们的目的，我们需要在有人创建提交之前运行linter和formatter。所以我们将使用预提交git挂钩。</p><p id="3b26" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">哈斯基确保:</p><ul class=""><li id="56e4" class="ml mm in jx b jy jz kc kd kg mn kk mo ko mp ks mq mr ms mt bi translated">钩子在机器之间共享(使用package.json中的配置安装)</li><li id="3982" class="ml mm in jx b jy mu kc mv kg mw kk mx ko my ks mq mr ms mt bi translated">挂钩是在本地开发人员的机器上创建的</li><li id="bfd4" class="ml mm in jx b jy mu kc mv kg mw kk mx ko my ks mq mr ms mt bi translated">钩子在git命令执行时运行(在它执行之前)</li><li id="4737" class="ml mm in jx b jy mu kc mv kg mw kk mx ko my ks mq mr ms mt bi translated">如果不满足标准，则实施检查以使git命令执行失败</li></ul><h1 id="7208" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">安装和配置Husky</h1><p id="c594" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">我们使用以下命令安装husky:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="8cb8" class="mf ku in mb b gy mg mh l mi mj">npm i -D husky</span></pre><p id="fbe8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">配置husky需要向项目包的根目录添加一个husky键。json:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="367a" class="mf ku in mb b gy mg mh l mi mj">"husky": {<br/>  "hooks": {<br/>    "pre-commit": "",  // pre-commit command<br/>    "pre-push": "",    // pre-push command<br/>    "...": "..."<br/>  }<br/>}</span></pre><p id="9373" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这些命令可以是我们希望在相应的git操作之前运行的任何命令。</p><p id="072f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果我们有npm脚本运行更漂亮，ESLint设置为:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="fa03" class="mf ku in mb b gy mg mh l mi mj">"scripts": {<br/>    "prettier": "prettier --config .prettierrc 'src/**/*.{js,jsx,css}' --write",<br/>    "lint": "eslint . --ext .js",<br/>    ...<br/>  },</span></pre><p id="1a41" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们可以将husky配置为在提交发生之前运行这些功能:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="296a" class="mf ku in mb b gy mg mh l mi mj">"husky": {<br/>    "hooks": {<br/>      "pre-commit": "npm run prettier &amp;&amp; npm run lint"<br/>    }<br/>  }</span></pre><p id="2e28" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这确保了在没有格式化代码的情况下无法进行提交，并强制执行使用ESLint设置的编码标准。</p><p id="c2b5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意:</strong>不是在整个项目上运行林挺，而是检查包<a class="ae mk" href="https://github.com/okonet/lint-staged" rel="noopener ugc nofollow" target="_blank"> lint-staged </a>，它只在staged文件上运行linter。这减少了对项目进行lint处理所需的时间。</p><p id="d852" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用husky和git预提交挂钩，我们可以在没有任何手动干预的情况下跨项目实施编码标准。如果你有任何问题或其他林挺小贴士，请在下面的评论中告诉我们。</p></div><div class="ab cl mz na hr nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ig ih ii ij ik"><p id="f34e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="ng">原载于2021年6月5日https://www.wisdomgeek.com</em><em class="ng"/><a class="ae mk" href="https://www.wisdomgeek.com/development/web-development/javascript/enforcing-coding-standards-husky-pre-commit-hooks/" rel="noopener ugc nofollow" target="_blank"><em class="ng">。</em></a></p><p id="20ed" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="ng">更多内容看</em><a class="ae mk" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="ng">plain English . io</em></strong></a></p></div></div>    
</body>
</html>