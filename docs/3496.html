<html>
<head>
<title>How to Use the Composition API to Get Data from Service with Vue.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用组合API通过Vue.js从服务中获取数据</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-the-composition-api-to-get-data-from-service-with-vue-js-4da1eca19ad6?source=collection_archive---------8-----------------------#2021-07-14">https://javascript.plainenglish.io/how-to-use-the-composition-api-to-get-data-from-service-with-vue-js-4da1eca19ad6?source=collection_archive---------8-----------------------#2021-07-14</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="6be0" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">通过使用组合API而不是选项API，可以使服务结构更加可用。</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/dba0e5a893f45d46fc6d1d18cf78a461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ojWq1Pv_oLcW0yzB"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@jankolar?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jan Antonin Kolar</a> on <a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="be4b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">今天我感兴趣的是Vue.js 2和Vue.js 3的一个最美的区别。在Vue.js 2中，曾经使用过，甚至还在使用Options API，现在在Vue.js 3中，我们面对的是Composition API的概念。</p><p id="bbfb" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">简要解释为什么做出这样的改变；</p><ul class=""><li id="1e40" class="lt lu ir kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">Vue.js 2让我们不得不在一个地方使用反应变量(数据)、方法和计算值(computed)。</li><li id="5e17" class="lt lu ir kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">没有简单的解决方案来解构组件之间的公共逻辑。</li></ul><p id="f623" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">Mixin 被用来解决这个问题，但是它们相当复杂。随着mixin使用的增加，我们在组件中做出的定义也是混杂的。</p><p id="f58a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">由于这些原因，在Vue.js 3中提出了一个不同的概念。当然，它也有缺点。但是它使我们的代码可重用，它的可理解性更简单。</p></div><div class="ab cl mh mi hv mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ik il im in io"><p id="0634" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">让我们从慢到组合API概念。</p><p id="e0c9" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">首先，<code class="fe mo mp mq mr b">setup()</code>这个方法是为我们使用组合API而创建的。</p><blockquote class="ms mt mu"><p id="2e4e" class="kx ky mv kz b la lb js lc ld le jv lf mw lh li lj mx ll lm ln my lp lq lr ls ik bi translated">一旦它们<code class="fe mo mp mq mr b">props</code>被解析，在组件被创建之前执行的组件选项。它充当组合API的入口点。</p></blockquote><p id="b049" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">其中重要的一点是，你不应该在<code class="fe mo mp mq mr b">setup()</code>中使用关键词<code class="fe mo mp mq mr b">this</code>。因为<code class="fe mo mp mq mr b">setup</code>是在数据、计算或方法被解析之前被调用的。</p><p id="689f" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">让我告诉你我举的例子。我正在从Vue自己网站上的服务中提取数据。他使用的数据是用Options API编写的。我想把它和复合API一起使用。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="mz na l"/></div></figure><p id="5da5" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">正如你在我准备的例子中看到的，我在<code class="fe mo mp mq mr b">data()</code>中创建了<code class="fe mo mp mq mr b">isStatus</code>属性。稍后我会用它来显示数据。</p><p id="9411" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">当你设置你正在使用的IDE时，它会给你一个<code class="fe mo mp mq mr b">setup()</code>建议，它会按照它应该的那样设置。</p><p id="441a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我想解释一下我用的第一个概念<code class="fe mo mp mq mr b">setup()</code>和类似的概念。</p><p id="0e4a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我用<code class="fe mo mp mq mr b">ref([])</code>创建了我使用的数据</p><p id="025e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在使用<code class="fe mo mp mq mr b">ref</code>之前，我们需要导入包。</p><p id="002c" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><code class="fe mo mp mq mr b">import {ref} from "vue"</code></p><ul class=""><li id="63a9" class="lt lu ir kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated"><strong class="kz is"> ref: </strong>我们用它来使一个特征反应。</li><li id="d88b" class="lt lu ir kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated"><strong class="kz is">反应性:</strong>将稳定对象转化为反应性对象。</li><li id="87aa" class="lt lu ir kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated"><strong class="kz is"> isRef: </strong>我们用它来检查一个特性是否是反应性的。</li><li id="6485" class="lt lu ir kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated"><strong class="kz is"> toRefs: </strong>允许我们把一个反应性对象的属性作为反应性属性。</li></ul><p id="933c" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">首先，我必须使用<code class="fe mo mp mq mr b">axios</code>从服务中获取数据。Axios是一个javascript库，允许在客户端应用程序中轻松进行HTTP调用。我们用NPM安装<code class="fe mo mp mq mr b">axios</code>包。</p><p id="7237" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><code class="fe mo mp mq mr b">npm install vue-axios</code></p><p id="61be" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><code class="fe mo mp mq mr b">npm i vue-axios</code></p><p id="f596" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">之后，我们需要在<code class="fe mo mp mq mr b">.vue</code>导入文件。</p><p id="8cfe" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><code class="fe mo mp mq mr b">import axios from "axios"</code></p><p id="06b3" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这是我获取数据的地方。</p><p id="1695" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><code class="fe mo mp mq mr b">axios.get("url")</code></p><p id="2a7a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我处理数据的地方；</p><p id="c8c2" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><code class="fe mo mp mq mr b">.then((res)=&gt;{ data.value = res.data.bpi})</code></p><p id="0d1b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我可以通过调用<code class="fe mo mp mq mr b">data.value</code>来使用我创建的<code class="fe mo mp mq mr b">data</code>。</p><p id="d609" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><code class="fe mo mp mq mr b">res.data.bpi</code>这部分是关于我获取数据的JSON格式。JSON中使用了<code class="fe mo mp mq mr b">bpi</code>，我调用<code class="fe mo mp mq mr b">data.bpi</code>是因为我想访问那里的数据。</p><p id="e93b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在<code class="fe mo mp mq mr b">setup()</code>里面我们需要使用<code class="fe mo mp mq mr b">return.</code>作为回报，我添加了<code class="fe mo mp mq mr b">data.</code></p><p id="dc36" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在这些阶段之后，我将数据从服务获取到数据中。</p><p id="5725" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在<code class="fe mo mp mq mr b">methods:{}</code>中，我创建了<code class="fe mo mp mq mr b">control()</code>一个函数。我将使用它来获取或关闭数据。</p><p id="8ec4" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">第一个<code class="fe mo mp mq mr b">isStatus</code>值为真，为真时数据不显示。如果值为假，数据显示。</p></div><div class="ab cl mh mi hv mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ik il im in io"><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="mz na l"/></div></figure><p id="291e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我使用for循环来使用模板中的数据。</p><p id="7f76" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><code class="fe mo mp mq mr b">v-for="datas in data" :key="datas.description"</code></p><p id="d4ac" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我已经准备好这样使用数据了。我们需要确定密钥。</p><p id="3a0d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您可以根据传入的JSON格式对将要使用的数据进行格式化。</p><p id="22a3" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我的<strong class="kz is"> HelloWorld.vue </strong>、<strong class="kz is"> package.json </strong>和<strong class="kz is"> StackBlitz </strong>文件；</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="mz na l"/></div></figure><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="mz na l"/></div></figure><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nb na l"/></div></figure><div class="nc nd gq gs ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-use-angulars-attribute-directives-in-your-class-hierarchy-d3a1d0adac32"><div class="ng ab fp"><div class="nh ab ni cl cj nj"><h2 class="bd is gz z fq nk fs ft nl fv fx iq bi translated">如何在类层次结构中使用Angular的属性指令</h2><div class="nm l"><h3 class="bd b gz z fq nk fs ft nl fv fx dk translated">使用Angular CLI构建属性指令</h3></div><div class="nn l"><p class="bd b dl z fq nk fs ft nl fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="no l"><div class="np l nq nr ns no nt kq nf"/></div></div></a></div><div class="nc nd gq gs ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/chart-and-calendar-design-in-flip-card-using-angular-nebular-db0ffd434d5b"><div class="ng ab fp"><div class="nh ab ni cl cj nj"><h2 class="bd is gz z fq nk fs ft nl fv fx iq bi translated">使用角状星云在翻转卡中设计图表和日历</h2><div class="nm l"><h3 class="bd b gz z fq nk fs ft nl fv fx dk translated">在活动卡片上创建一个快速、友好的图表和日历。</h3></div><div class="nn l"><p class="bd b dl z fq nk fs ft nl fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="no l"><div class="nu l nq nr ns no nt kq nf"/></div></div></a></div><div class="nc nd gq gs ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-create-marker-and-marker-cluster-with-leaflet-map-95e92216c391"><div class="ng ab fp"><div class="nh ab ni cl cj nj"><h2 class="bd is gz z fq nk fs ft nl fv fx iq bi translated">如何使用传单地图创建标记和标记簇</h2><div class="nm l"><h3 class="bd b gz z fq nk fs ft nl fv fx dk translated">在活页地图架构中创建标记和图层，然后对标记进行聚类的方法。</h3></div><div class="nn l"><p class="bd b dl z fq nk fs ft nl fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="no l"><div class="nv l nq nr ns no nt kq nf"/></div></div></a></div><div class="nc nd gq gs ne nf"><a href="https://bestte.medium.com/today-im-going-to-share-the-home-screen-i-designed-with-flutter-bf95029c76e4" rel="noopener follow" target="_blank"><div class="ng ab fp"><div class="nh ab ni cl cj nj"><h2 class="bd is gz z fq nk fs ft nl fv fx iq bi translated">颤振登录和主页设计</h2><div class="nm l"><h3 class="bd b gz z fq nk fs ft nl fv fx dk translated">学习使用导航器传送另一页。按下并使用圆形按钮，输入说明</h3></div><div class="nn l"><p class="bd b dl z fq nk fs ft nl fv fx dk translated">bestte.medium.com</p></div></div><div class="no l"><div class="nw l nq nr ns no nt kq nf"/></div></div></a></div><div class="nc nd gq gs ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/create-a-card-design-with-the-free-vue-js-template-now-ui-kit-5676a738e518"><div class="ng ab fp"><div class="nh ab ni cl cj nj"><h2 class="bd is gz z fq nk fs ft nl fv fx iq bi translated">使用免费的Vue.js模板创建卡片设计</h2><div class="nm l"><h3 class="bd b gz z fq nk fs ft nl fv fx dk translated">使用免费主题可能是开发设计和学习的最佳方式之一。</h3></div><div class="nn l"><p class="bd b dl z fq nk fs ft nl fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="no l"><div class="nx l nq nr ns no nt kq nf"/></div></div></a></div><div class="nc nd gq gs ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-use-angular-component-styles-with-special-selectors-dc877514372c"><div class="ng ab fp"><div class="nh ab ni cl cj nj"><h2 class="bd is gz z fq nk fs ft nl fv fx iq bi translated">如何将角度组件样式与特殊选择器一起使用</h2><div class="nm l"><h3 class="bd b gz z fq nk fs ft nl fv fx dk translated">在具有独立样式文件的组件的基础上，将样式添加到您的Angular应用程序有助于您创建一个更…</h3></div><div class="nn l"><p class="bd b dl z fq nk fs ft nl fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="no l"><div class="ny l nq nr ns no nt kq nf"/></div></div></a></div><p id="0d0b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><em class="mv">更多内容看</em><a class="ae kw" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kz is"><em class="mv">plain English . io</em></strong></a></p></div></div>    
</body>
</html>