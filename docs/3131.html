<html>
<head>
<title>How to Run Selenium Tests in Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Docker中运行硒测试</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/selenium-docker-tutorial-how-to-run-selenium-tests-in-do-8f86b999d318?source=collection_archive---------4-----------------------#2021-06-25">https://javascript.plainenglish.io/selenium-docker-tutorial-how-to-run-selenium-tests-in-do-8f86b999d318?source=collection_archive---------4-----------------------#2021-06-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/49fae0c148331a8d24866592bc266462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N6FUOn-0_axn7oHn4TIflQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk"><a class="ae jz" href="https://youtu.be/2PgvME7ltNI" rel="noopener ugc nofollow" target="_blank">https://youtu.be/2PgvME7ltNI</a></figcaption></figure><p id="20e5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这篇文章中，我们将介绍如何在Docker中运行Selenium测试，并在Chrome和Firefox浏览器中执行它们。我们也会明白为什么要在Docker中运行Selenium测试？</p><h1 id="ea58" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">先决条件</h1><p id="4304" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">在我们开始之前，您需要了解一些先决条件-</p><ul class=""><li id="a839" class="mb mc in kc b kd ke kh ki kl md kp me kt mf kx mg mh mi mj bi translated"><strong class="kc io">对Docker </strong>的基本熟悉:你至少应该对Docker概念有一个高层次的理解</li><li id="7f5a" class="mb mc in kc b kd mk kh ml kl mm kp mn kt mo kx mg mh mi mj bi translated"><strong class="kc io"> Docker已安装:【https://www.docker.com/products/docker-desktop】您还应该在您的本地机器上安装Docker—<a class="ae jz" href="https://www.docker.com/products/docker-desktop" rel="noopener ugc nofollow" target="_blank">T6】</a></strong></li><li id="8321" class="mb mc in kc b kd mk kh ml kl mm kp mn kt mo kx mg mh mi mj bi translated"><strong class="kc io">基本的Selenium脚本:</strong>您还需要一个示例脚本，您可以执行它来运行您的测试。还可以使用我在JavaScript—<a class="ae jz" href="https://github.com/automationbro/selenium-docker/tree/selenium-docker-basic" rel="noopener ugc nofollow" target="_blank">https://github . com/automation bro/selenium-docker/tree/selenium-docker-basic</a>中创建的示例脚本</li></ul></div><div class="ab cl mp mq hr mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ig ih ii ij ik"><h1 id="d4ff" class="ky kz in bd la lb mw ld le lf mx lh li lj my ll lm ln mz lp lq lr na lt lu lv bi translated">为什么要在Docker中运行硒测试？</h1><p id="843e" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">在我们在Docker中运行测试之前，理解Docker可以为我们解决的问题是很重要的。</p><h2 id="3ca7" class="nb kz in bd la nc nd dn le ne nf dp li kl ng nh lm kp ni nj lq kt nk nl lu nm bi translated">会话创建问题</h2><p id="408d" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">如果您一直在没有Docker的情况下运行您的测试，您可能以前就已经看到过这种错误— <code class="fe nn no np nq b">session not created: This version of ChromeDriver only supports Chrome version 89</code></p><figure class="ns nt nu nv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/fcbd8a3a2270ad7c45225f0a9b61a985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vxsuZkyQHkecfMJQLcicRw.png"/></div></div></figure><p id="47c5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当ChromeDriver的版本和本地浏览器的版本不匹配时，就会出现此错误。在我的情况下，我的浏览器版本是v91，ChromeDriver版本是v89。现在，我有两个选择-</p><ol class=""><li id="3e8a" class="mb mc in kc b kd ke kh ki kl md kp me kt mf kx nw mh mi mj bi translated">如果我需要在最新版本中运行测试，那么我需要将ChromeDriver升级到v91</li><li id="e34f" class="mb mc in kc b kd mk kh ml kl mm kp mn kt mo kx nw mh mi mj bi translated">如果我需要在旧版本中运行测试，那么我需要将我的Chrome浏览器降级到v89</li></ol><p id="b53e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">每当出现版本不匹配时，这就成了一个很常见的问题。因此，要解决这个问题，我们可以使用特定ChromeDriver附带的Docker映像，以及安装的相互兼容的浏览器。不管您的本地机器上有什么版本，您仍然可以在Docker中执行您的测试。</p><h2 id="6ced" class="nb kz in bd la nc nd dn le ne nf dp li kl ng nh lm kp ni nj lq kt nk nl lu nm bi translated">多版本支持</h2><p id="b25c" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">Docker的另一个优势是我们可以设置多个Chrome版本来执行我们的测试。例如，我可以让Chrome v91运行在端口4444上，让Chrome v81运行在端口4446上，并且可以在这两个端口上执行测试。</p><figure class="ns nt nu nv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nx"><img src="../Images/88f52a48389e13753923933f708fb7ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CIVyzt78MvW-QXAy0YL4cg.png"/></div></div></figure><p id="acc6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Docker在选择不同的浏览器以及选择浏览器版本方面为您提供了更多的灵活性，而不必担心任何类型的基础设施设置。</p></div><div class="ab cl mp mq hr mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ig ih ii ij ik"><h1 id="f537" class="ky kz in bd la lb mw ld le lf mx lh li lj my ll lm ln mz lp lq lr na lt lu lv bi translated">在本地运行Selenium独立Chrome Docker映像</h1><p id="8a19" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">Selenium团队为我们提供了一些图片，我们可以使用它们来运行我们的测试。我们将在本教程中使用的是<a class="ae jz" href="https://hub.docker.com/r/selenium/standalone-chrome" rel="noopener ugc nofollow" target="_blank">selenium/standalone-chrome</a>图像。在您的终端中执行以下命令来运行映像—</p><pre class="ns nt nu nv gt ny nq nz oa aw ob bi"><span id="385b" class="nb kz in nq b gy oc od l oe of">docker run -d -p 4444:4444 --shm-size=2g selenium/standalone-chrome:3.141.59-20210607</span></pre><p id="827f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们仔细看看这个命令—</p><ul class=""><li id="8f8a" class="mb mc in kc b kd ke kh ki kl md kp me kt mf kx mg mh mi mj bi translated">-d标志用于在分离模式下运行docker容器</li><li id="f380" class="mb mc in kc b kd mk kh ml kl mm kp mn kt mo kx mg mh mi mj bi translated">-p标志用于传入端口，第一个端口4444:是本地机器的端口，第二个端口:4444是docker容器内部的端口</li><li id="6f45" class="mb mc in kc b kd mk kh ml kl mm kp mn kt mo kx mg mh mi mj bi translated">— shm-size=2g是一个非常重要的标志，这样docker容器就可以共享主机的内存</li><li id="9d7a" class="mb mc in kc b kd mk kh ml kl mm kp mn kt mo kx mg mh mi mj bi translated">selenium/standalone-chrome:3 . 141 . 59–2021 06 07是我们正在使用的图像标签</li></ul><p id="7b87" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">一旦您执行这个命令，它将提取您提供的图像并启动容器。通过执行<code class="fe nn no np nq b">docker ps</code>可以看到容器正在运行</p><figure class="ns nt nu nv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi og"><img src="../Images/2c229a854c408a770fd94e3f53c5bc55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mJ95FiV7_151wib2u1uFGw.png"/></div></div></figure><p id="1989" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，您应该看到Selenium独立运行在<a class="ae jz" href="http://localhost:4444/" rel="noopener ugc nofollow" target="_blank"> http://localhost:4444/ </a>上</p><figure class="ns nt nu nv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oh"><img src="../Images/2c094d26ad3db14d8a3a04e1e9cad2a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9OUp6biwM0496d--Rl_Afw.png"/></div></div></figure></div><div class="ab cl mp mq hr mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ig ih ii ij ik"><h1 id="3df1" class="ky kz in bd la lb mw ld le lf mx lh li lj my ll lm ln mz lp lq lr na lt lu lv bi translated">在Docker上运行硒测试</h1><p id="ba46" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">既然我们已经弄清楚了Docker部分，是时候让我们的测试运行在端口4444上了。因此，这一部分将特定于您在Selenium脚本中使用的框架/语言。在我的例子中，我必须做下面的更新来将我的测试指向端口4444。</p><figure class="ns nt nu nv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oi"><img src="../Images/e3ab358e80952cb6aeb22d9c538925a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_NPoPT0sto3za-Ufr2kZdw.png"/></div></div></figure><p id="135a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们现在运行测试，我将通过执行<code class="fe nn no np nq b">node test.js</code>来完成，然后前往<a class="ae jz" href="http://localhost:4444/wd/hub/static/resource/hub.html" rel="noopener ugc nofollow" target="_blank">http://localhost:4444/wd/hub/static/resource/hub . html</a>，您将看到一个正在Docker容器中运行的Chrome会话正在创建。</p><figure class="ns nt nu nv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oj"><img src="../Images/1064765dc616ebaeb8708f7b7c256e37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WVh5I63l06DFJ0kBq2mhEg.png"/></div></div></figure><p id="16f8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">一旦你的测试执行完毕，chrome会话将被自动删除。</p></div><div class="ab cl mp mq hr mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ig ih ii ij ik"><h1 id="15c8" class="ky kz in bd la lb mw ld le lf mx lh li lj my ll lm ln mz lp lq lr na lt lu lv bi translated">在Docker容器中对Firefox运行Selenium测试</h1><p id="ace9" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">在Firefox上运行测试几乎和Chrome一样，你只需要运行一个新的镜像，你可以在本地指向一个不同的端口(可选)，这样它就不会和你现有的运行端口冲突。</p><pre class="ns nt nu nv gt ny nq nz oa aw ob bi"><span id="be63" class="nb kz in nq b gy oc od l oe of">docker run -d -p 4445:4444 --shm-size 2g selenium/standalone-firefox:3.141.59-20210607</span></pre><p id="bb34" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">注意</strong>:Docker容器内的端口可以保持不变，因为它不与你的Chrome Docker镜像连接。</p><p id="c4bc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您还需要对代码进行修改，以将您的测试指向Firefox和新的端口。</p><figure class="ns nt nu nv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ok"><img src="../Images/7e3e860782acf01bc150e0f23787065f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dzN0M5c3B3zWbvTqVmy75g.png"/></div></div></figure></div><div class="ab cl mp mq hr mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ig ih ii ij ik"><h1 id="46cf" class="ky kz in bd la lb mw ld le lf mx lh li lj my ll lm ln mz lp lq lr na lt lu lv bi translated">结论</h1><p id="e969" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">因此，我们使用Selenium独立Docker映像在Docker容器中执行测试，并在Firefox和Chrome上运行它们。我们还了解了为什么我们应该在Docker容器中运行我们的测试，以及我们从中获得的好处。</p><p id="75b0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">查看下面的视频，了解更多关于如何在Docker中执行Selenium测试的信息–</strong></p><figure class="ns nt nu nv gt jo"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="943e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在下一篇教程中，我将向您展示如何使用VNC来查看Docker容器中运行的测试。</p><p id="a88d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">感谢阅读。</p><p id="6e33" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="on">更多内容看</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="on">plain English . io</em></strong></a></p></div></div>    
</body>
</html>