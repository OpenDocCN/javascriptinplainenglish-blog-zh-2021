<html>
<head>
<title>Converting an Excel file to JSON in Node: Beginner-Friendly Introduction to Node.js + NPM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Node中将Excel文件转换为JSON:Node . js+NPM初学者友好介绍</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/converting-an-excel-file-to-json-in-node-beginner-friendly-introduction-to-node-js-npm-2b994b7bca1e?source=collection_archive---------1-----------------------#2021-07-19">https://javascript.plainenglish.io/converting-an-excel-file-to-json-in-node-beginner-friendly-introduction-to-node-js-npm-2b994b7bca1e?source=collection_archive---------1-----------------------#2021-07-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="ce44" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">通过解析excel文件开始使用Node.js，并在此过程中了解NPM和XLSX。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/2c25c862843d792b0cd0e609e3f5d22d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xT-r5vqQ8NcbyBzs"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@goumbik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Lukas Blazek</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="43d6" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">Node.js是什么？</h1><p id="38f1" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">当我们想到JavaScript时，我们会想到浏览器、网站、网页、交互性、事件监听器、onclick等。这些都和浏览器有关。</p><p id="c679" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">事实上，浏览器曾经是JavaScript唯一的运行时环境。因此，每当我们编写javascript时，只有在浏览器上打开网页时，我们才能真正看到它的运行。</p><p id="adfc" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">这限制了JavaScript在浏览器之外的使用。但是现在，我们几乎可以在任何地方运行JavaScript代码…怎么做？通过安装他们称之为<strong class="ln io">的节点</strong>。Node是JavaScript的新环境。</p><p id="8230" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">现在有<strong class="ln io">两种方式运行JavaScript: </strong></p><ol class=""><li id="789d" class="mm mn in ln b lo mh lr mi lu mo ly mp mc mq mg mr ms mt mu bi translated">在浏览器环境中</li><li id="c2ae" class="mm mn in ln b lo mv lr mw lu mx ly my mc mz mg mr ms mt mu bi translated">在Node.js环境中</li></ol><p id="6f50" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">所以总结一下Node.js是什么:</p><ul class=""><li id="3ab7" class="mm mn in ln b lo mh lr mi lu mo ly mp mc mq mg na ms mt mu bi translated">Node是一个新的JavaScript运行时环境。</li><li id="375b" class="mm mn in ln b lo mv lr mw lu mx ly my mc mz mg na ms mt mu bi translated">Node可以安装在任何服务器上，它是开源和免费的</li><li id="7bf2" class="mm mn in ln b lo mv lr mw lu mx ly my mc mz mg na ms mt mu bi translated">Node允许我们在浏览器之外运行JavaScript，比如在服务器上</li><li id="e75d" class="mm mn in ln b lo mv lr mw lu mx ly my mc mz mg na ms mt mu bi translated">Node允许我们用javascript编写后端或服务器代码！以前这是不可能的，例如你必须使用Java或PHP。</li></ul><h1 id="9fe6" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">现在您已经听说了伟大的全能节点，是时候在您的本地计算机上安装Node.js了</h1><p id="eae0" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">请按照官网上的说明:【https://nodejs.org/en/download/ T4】</p><p id="cf1c" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">要检查节点是否正确安装，请在终端中运行以下命令:</p><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="86e9" class="ng ku in nc b gy nh ni l nj nk">node --version</span></pre><h1 id="c1cc" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">NPM怎么样？Node同样酷的最好的朋友！</h1><p id="b72b" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">node还有一个很酷的功能，叫做<strong class="ln io"> NPM </strong>。不需要单独安装，安装完node就有了。</p><p id="c1d2" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">它代表:<strong class="ln io">节点包管理器。</strong></p><p id="cc41" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">因为node是开源的，而且开发人员都是很好的人(通常)，开发人员可以公开他们的项目供其他开发人员使用。通过这种方式，其他开发人员可以受益，并且他们不需要从头开始编写代码。</p><p id="162c" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">所有这些优秀的开发人员需要做的就是将他们的代码转换成一个模块，然后他们可以将它作为一个<strong class="ln io">包</strong>发布在npm上。</p><p id="fda3" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">NPM是一个软件包的在线市场，任何人都可以免费使用来帮助他们完成项目。</p><p id="5fd4" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">例如，为了在我们的项目中进行复杂的excel处理，我们可以安装第三方npm包并使用它，而不是从头开始构建逻辑。这样我们可以减少开发时间，专注于我们自己的特色。</p><p id="2aa0" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">要使用npm，只需在npm网站上寻找你想要的包(如果有的话)。在本文中，我们将使用我发现的一个名为<strong class="ln io"> XLSX </strong>的包</p><ul class=""><li id="7d4f" class="mm mn in ln b lo mh lr mi lu mo ly mp mc mq mg na ms mt mu bi translated"><a class="ae ks" href="https://www.npmjs.com/package/xlsx" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/xlsx</a></li></ul><p id="a318" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">要从做同样事情的几个其他包中选择正确的包，您需要考虑以下关键因素:</p><ul class=""><li id="a9b9" class="mm mn in ln b lo mh lr mi lu mo ly mp mc mq mg na ms mt mu bi translated">查看每周下载量=更受欢迎=更好的软件包</li><li id="0dcf" class="mm mn in ln b lo mv lr mw lu mx ly my mc mz mg na ms mt mu bi translated">确保最近更新=良好的支持</li><li id="ee56" class="mm mn in ln b lo mv lr mw lu mx ly my mc mz mg na ms mt mu bi translated">阅读并确保它有好的文档=易于使用</li></ul><p id="00cd" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">要安装软件包，您需要使用npm命令。您需要在项目文件夹中运行以下命令:</p><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="8ef7" class="ng ku in nc b gy nh ni l nj nk">npm install package_name</span></pre><p id="a812" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">当您在项目中安装第三方包时，您就创建了一个依赖项。这意味着您的项目依赖于另一个项目。这会变得很混乱，对吧？幸运的是，npm将为您管理项目中的依赖项..稍后将详细介绍这一点！(提示:package.json)</p><p id="3958" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">因此，任何时候有人想运行你的应用程序，npm都会寻找依赖关系，从npm获取依赖代码，并将其下载到你的本地项目中。</p><h1 id="8feb" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">以身作则！让我们从头开始一个节点项目！</h1><p id="566c" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">让我们创建一个应用程序来解析文件系统中的excel文件，并将其转换为json文件。请注意我们将如何使用javascript来做到这一点，我们甚至不需要浏览器做任何事情。</p><p id="3915" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">好的，那么开始吧，为你的项目做一个文件夹。创建一个<strong class="ln io"> index.js文件</strong>，这将是我们的代码所在的地方。</p><p id="beb3" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">然后运行命令npm init创建一个正式的节点项目:</p><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="941c" class="ng ku in nc b gy nh ni l nj nk">npm init</span></pre><ul class=""><li id="40cd" class="mm mn in ln b lo mh lr mi lu mo ly mp mc mq mg na ms mt mu bi translated">对所有默认选项说“是”</li></ul><p id="262d" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">很有趣，你会看到一个新的文件<strong class="ln io"> package.json </strong>，我们去看看吧。似乎它有一些关于我们项目的数据，好酷！我们稍后将回到这个问题..</p><p id="d007" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">好了，有了这个文件，我们可以在我们选择的包中进行npm安装了。让我们安装之前的excel软件包，<strong class="ln io"> xslx。这个包将允许我们解析我们的excel并将其转换成JSON！</strong></p><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="9514" class="ng ku in nc b gy nh ni l nj nk">npm install xlsx</span></pre><p id="8645" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">好了，现在让我们回到我们的<strong class="ln io"> package.json </strong>中，看看发生了什么！</p><p id="261c" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">我们可以在文件中看到一个新的<strong class="ln io">依赖对象</strong> { }。在这里，有“xlsx”和版本号。每当我们进行npm安装时，NPM会自动将我们的软件包添加到这里。npm跟踪我们安装的所有依赖项，这样当人们第一次运行这个项目时，NPM就知道我们需要安装什么依赖项来使这个项目完全运行！</p><p id="12b7" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">啊，其他东西也变了，出现的这个package-lock.json是什么？！</p><p id="9c60" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">NPM还会自动生成一个<strong class="ln io">包——lock . JSON</strong>，你根本不需要管理或编辑它。这就像package.json的快照。所以不要太担心它。你也不应该把这个推或者发布到你的git repo上。它只是由npm在本地使用。</p><p id="e37e" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">我们看到的最后一个被创建的是<strong class="ln io"> node_modules </strong>文件夹。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nl"><img src="../Images/961e368a4e90b4416e351927b92f02fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cu3OM535zkqZ1OQA4UOycw.png"/></div></div></figure><p id="ee70" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">等等…这些文件夹是从哪里来的，我只认得XLSX，我安装的那个。好了，让我们打开XLSX文件夹，我们将看到这个包的所有代码，我们可以在我们的应用程序中使用，这很好。看起来像是一个不错的开发者为我们做好了一切准备。酷酷酷！</p><p id="62e4" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">就像任何其他节点项目一样，XLSX项目也有自己的package.json和自己的依赖项。让我们打开package.json，看看依赖项。</p><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="f04a" class="ng ku in nc b gy nh ni l nj nk">"dependencies": {<br/>"adler-32": "~1.2.0",<br/>"cfb": "¹.1.4",<br/>"codepage": "~1.14.0",<br/>"commander": "~2.17.1",<br/>"crc-32": "~1.2.0",<br/>"exit-on-epipe": "~1.0.1",<br/>"fflate": "⁰.3.8",<br/>"ssf": "~0.11.2",<br/>"wmf": "~1.0.1",<br/>"word": "~0.3.0"<br/>},</span></pre><p id="aaad" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">啊哈，这就是我们<strong class="ln io"> node_modules </strong>中所有其他文件夹的来源。XLSX有自己的依赖项。</p><p id="8fcd" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">如您所见，npm非常有用，因为它允许我们只需安装npm就可以运行任何有依赖项的项目，它会知道为我们安装所有这些依赖项，并将它们放在节点模块文件夹中。<strong class="ln io">它还会安装依赖项，的依赖项！:-) </strong></p><p id="1fd8" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">所以node_modules拥有我们依赖的所有代码。因此，它的尺寸可以很大。</p><p id="07a5" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">事实上，因为我们有package.json文件，它确切地告诉我们需要下载和安装什么，所以我们不需要发布整个node_modules文件夹，因为可以随时使用package.json下载代码。^_^</p><p id="8dfd" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">因此，无论何时你下载一个节点项目，你做的第一件事就是运行npm安装，它会查看所有的package.json并从NPM下载所有的代码，并把它放在<strong class="ln io">节点模块中。</strong></p><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="b93b" class="ng ku in nc b gy nh ni l nj nk">npm install</span></pre><h2 id="b660" class="ng ku in bd kv nm nn dn kz no np dp ld lu nq nr lf ly ns nt lh mc nu nv lj nw bi translated"><strong class="ak">最佳实践:</strong>为了不推送这个大文件夹，我们通常会将它添加到<strong class="ak">中。gitignore </strong>文件</h2><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="8255" class="ng ku in nc b gy nh ni l nj nk">node_modules/</span></pre><p id="da4a" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">这不会将node_modules/文件夹发布到您的repo。节省您的时间和空间！:)</p></div><div class="ab cl nx ny hr nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ig ih ii ij ik"><h2 id="5cba" class="ng ku in bd kv nm nn dn kz no np dp ld lu nq nr lf ly ns nt lh mc nu nv lj nw bi translated">使用npm包</h2><p id="2ee7" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">好了，有趣的部分，现在是时候实际编码了，哈哈，最后，让我们回到index.js文件。这是一个javascript文件！Node中的编码实际上就像javascript一样，所以如果你懂javascript就没问题了！您只需要知道node提供给您的额外功能，例如访问服务器的文件系统！</p><p id="98ce" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">我们需要做的第一件事是引入我们作为依赖项安装的包，所以这是用<strong class="ln io"> require </strong>语法<strong class="ln io">完成的。</strong>这将在该包的node_modules文件夹中查找，如果在那里，它将为您提供对该功能的访问。</p><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="f55c" class="ng ku in nc b gy nh ni l nj nk">const xlsx = <strong class="nc io">require</strong>(‘xlsx’);</span></pre><p id="c166" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">这是语法。您可以随意命名变量，但需要正确的语法(“包名”)；</p><p id="66bf" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">因此，我们今天要构建的应用程序将从excel文件中获取数据，并将其转换为JSON，然后在您的服务器上保存为JSON文件。</p><p id="44ab" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">正如我所说，我们将需要一个名为<strong class="ln io"> xlsx的第三方开源包。</strong></p><p id="4cb6" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">我们还需要访问文件系统。这是node内置的，所以您不需要npm安装它。但是你确实需要它。</p><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="c6b1" class="ng ku in nc b gy nh ni l nj nk">var <strong class="nc io">fs</strong> = <strong class="nc io">require</strong>(‘fs’);</span></pre><p id="0419" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">好了，让我们把一个excel文件放入根目录下的这个项目中。请记下该文件的名称。对于本文，我创建了一个名为Data.xlsx的Excel文件，并将其添加到我的项目文件夹中。</p><p id="7b0f" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">因此，让我们编写将excel文件转换为JSON的函数。我们将利用<strong class="ln io"> xlsx.readFile()和xlsx.utils.sheet_to_json()。</strong>如果没有这些函数，我们将不得不自己创建这些函数。</p><ul class=""><li id="a781" class="mm mn in ln b lo mh lr mi lu mo ly mp mc mq mg na ms mt mu bi translated">xlsx.readFile(文件路径)-接受文件名/路径</li><li id="c639" class="mm mn in ln b lo mv lr mw lu mx ly my mc mz mg na ms mt mu bi translated">xlsx . utils . sheet _ to _ json(sheet)-将单个工作表转换为JSON</li></ul><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="2671" class="ng ku in nc b gy nh ni l nj nk">function convertExcelFileToJsonUsingXlsx() {</span><span id="f546" class="ng ku in nc b gy oe ni l nj nk">    // Read the file using pathname<br/>    const file = xlsx.readFile('./Data.xlsx');</span><span id="ef40" class="ng ku in nc b gy oe ni l nj nk">    // Grab the sheet info from the file<br/>    const sheetNames = file.SheetNames;<br/>    const totalSheets = sheetNames.length;</span><span id="0bc8" class="ng ku in nc b gy oe ni l nj nk">    // Variable to store our data <br/>    let parsedData = [];</span><span id="163d" class="ng ku in nc b gy oe ni l nj nk">    // Loop through sheets<br/>    for (let i = 0; i &lt; totalSheets; i++) {</span><span id="6146" class="ng ku in nc b gy oe ni l nj nk">        // Convert to json using xlsx<br/>        const tempData = xlsx.utils.sheet_to_json(file.Sheets[sheetNames[i]]);</span><span id="0157" class="ng ku in nc b gy oe ni l nj nk">        // Skip header row which is the colum names<br/>        tempData.shift();</span><span id="28fa" class="ng ku in nc b gy oe ni l nj nk">        // Add the sheet's json to our data array<br/>        parsedData.push(...tempData);<br/>    }</span><span id="bbd7" class="ng ku in nc b gy oe ni l nj nk"> // call a function to save the data in a json file</span><span id="8730" class="ng ku in nc b gy oe ni l nj nk"> generateJSONFile(parsedData);<br/>}</span></pre><p id="3a4c" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">现在让我们编写另一个函数，将excel数据存储在服务器上的JSON文件中。让我们创建一个新的函数来分离我们的逻辑。</p><p id="11c0" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">正如你在下面看到的，我们使用了内置的节点<strong class="ln io"> fs.writeFileSync </strong>方法，该方法接受文件路径/文件名和我们正在写入该文件的数据。我们把它包在一个试捕器里以防失败。</p><ul class=""><li id="eb30" class="mm mn in ln b lo mh lr mi lu mo ly mp mc mq mg na ms mt mu bi translated"><strong class="ln io"> writeFileSync() — </strong></li></ul><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="02bf" class="ng ku in nc b gy nh ni l nj nk">function generateJSONFile(data) {<br/>    try {<br/>        fs.writeFileSync('data.json', JSON.stringify(data))<br/>    } catch (err) {<br/>        console.error(err)<br/>    }<br/>}</span></pre><p id="056c" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">让我们在文件的顶部调用我们的函数。</p><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="e597" class="ng ku in nc b gy nh ni l nj nk">convertExcelFileToJsonUsingXlsx();</span></pre><p id="9973" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">这是我们执行这个文件后运行的第一个函数。它会将excel文件转换为JSON，然后调用第二个函数将数据保存到JSON文件中。</p><h1 id="bbee" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">说到运行它…我们如何运行这个节点项目？</h1><p id="48ca" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">所以我们不再需要在浏览器上运行我们的代码了！我们只是用node运行它。我们可以在任何有节点环境的地方运行它。也就是说，运行我们代码的最简单方法就是使用下面的命令:</p><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="1c6c" class="ng ku in nc b gy nh ni l nj nk">node index.js</span></pre><p id="48c2" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">在我们运行这个命令后，node将运行index.js的所有内容，就像任何其他javascript文件一样，它将逐行执行代码。您可以看到输出确实是我们所有数据的JSON文件！这意味着我们的代码起作用了！耶！</p><p id="7c2f" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">运行我们代码的另一种方式是使用<strong class="ln io"> npm start。</strong>要完成这项工作，您必须转到package.json文件并更新<strong class="ln io">脚本</strong>对象。我们添加了一个新的启动脚本，这样我们就能够调用npm <strong class="ln io"> start </strong>。注意它是如何被设置为<strong class="ln io">节点index.js </strong>的，这是一个等效的命令。注意:在脚本对象中，您可以定义其他命令，如npm test来运行您的测试。</p><pre class="kd ke kf kg gt nb nc nd ne aw nf bi"><span id="5417" class="ng ku in nc b gy nh ni l nj nk">“scripts”: {</span><span id="16c0" class="ng ku in nc b gy oe ni l nj nk">  “test”: “echo \”Error: no test specified\” &amp;&amp; exit 1",</span><span id="e1ed" class="ng ku in nc b gy oe ni l nj nk">  “start”: “node index.js”</span><span id="6536" class="ng ku in nc b gy oe ni l nj nk">},</span></pre><p id="8585" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">所以现在我们可以使用命令<strong class="ln io"> npm start </strong>而不是node index.js来启动我们的应用程序。这是更正常的，也是人们在运行项目时所习惯的。</p></div><div class="ab cl nx ny hr nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ig ih ii ij ik"><p id="65d8" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">哒哒！祝贺您试用了您的第一个NPM包并运行了您的第一个节点项目。</p><p id="9ec9" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated"><em class="of">更多内容请看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ln io"><em class="of">plain English . io</em></strong></a></p></div></div>    
</body>
</html>