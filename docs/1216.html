<html>
<head>
<title>Create a React Grouped Bar Chart with the Visx Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Visx库创建一个反应分组条形图</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-a-react-grouped-bar-chart-with-the-visx-library-2c66b62469?source=collection_archive---------9-----------------------#2021-03-14">https://javascript.plainenglish.io/create-a-react-grouped-bar-chart-with-the-visx-library-2c66b62469?source=collection_archive---------9-----------------------#2021-03-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/874a6589adbbff8346e022fd8c0aa4e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gJAnGykr0BHxfpRg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@sergio_as?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sérgio Alves Santos</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="aadf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Visx是一个库，让我们可以轻松地将图形添加到React应用程序中。</p><p id="5429" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用它将分组条形图添加到React应用程序中。</p><h1 id="1447" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">安装所需的软件包</h1><p id="cb1c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们必须安装一些模块来创建分组条形图。</p><p id="61e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="89df" class="mn lc iq mj b gy mo mp l mq mr">npm i @visx/axis @visx/group @visx/mock-data @visx/responsive @visx/scale @visx/shape</span></pre><p id="8e2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装软件包。</p><h1 id="4761" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建图表</h1><p id="04ad" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过添加模块提供的项目来创建图表。</p><p id="7bc9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用来自<code class="fe ms mt mu mj b">@visx/mock-data</code>模块的数据。</p><p id="d6a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了创建图表，我们编写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="03f8" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { Group } from "@visx/group";<br/>import { BarGroup } from "@visx/shape";<br/>import { AxisBottom } from "@visx/axis";<br/>import cityTemperature from "@visx/mock-data/lib/mocks/cityTemperature";<br/>import { scaleBand, scaleLinear, scaleOrdinal } from "@visx/scale";<br/>import { timeParse, timeFormat } from "d3-time-format";</span><span id="01ca" class="mn lc iq mj b gy mv mp l mq mr">const blue = "#aeeef8";<br/>export const green = "#e5fd3d";<br/>const purple = "#9caff6";<br/>export const background = "#612efb";</span><span id="cda5" class="mn lc iq mj b gy mv mp l mq mr">const data = cityTemperature.slice(0, 8);<br/>const keys = Object.keys(data[0]).filter((d) =&gt; d !== "date");<br/>const defaultMargin = { top: 40, right: 0, bottom: 40, left: 0 };</span><span id="91b5" class="mn lc iq mj b gy mv mp l mq mr">const parseDate = timeParse("%Y-%m-%d");<br/>const format = timeFormat("%b %d");<br/>const formatDate = (date) =&gt; format(parseDate(date));</span><span id="8120" class="mn lc iq mj b gy mv mp l mq mr">const getDate = (d) =&gt; d.date;</span><span id="de50" class="mn lc iq mj b gy mv mp l mq mr">const dateScale = scaleBand({<br/>  domain: data.map(getDate),<br/>  padding: 0.2<br/>});<br/>const cityScale = scaleBand({<br/>  domain: keys,<br/>  padding: 0.1<br/>});<br/>const tempScale = scaleLinear({<br/>  domain: [<br/>    0,<br/>    Math.max(...data.map((d) =&gt; Math.max(...keys.map((key) =&gt; Number(d[key])))))<br/>  ]<br/>});<br/>const colorScale = scaleOrdinal({<br/>  domain: keys,<br/>  range: [blue, green, purple]<br/>});</span><span id="744b" class="mn lc iq mj b gy mv mp l mq mr">function Example({ width, height, events = false, margin = defaultMargin }) {<br/>  const xMax = width - margin.left - margin.right;<br/>  const yMax = height - margin.top - margin.bottom;<br/>  dateScale.rangeRound([0, xMax]);<br/>  cityScale.rangeRound([0, dateScale.bandwidth()]);<br/>  tempScale.range([yMax, 0]);</span><span id="e57f" class="mn lc iq mj b gy mv mp l mq mr">  return width &lt; 10 ? null : (<br/>    &lt;svg width={width} height={height}&gt;<br/>      &lt;rect<br/>        x={0}<br/>        y={0}<br/>        width={width}<br/>        height={height}<br/>        fill={background}<br/>        rx={14}<br/>      /&gt;<br/>      &lt;Group top={margin.top} left={margin.left}&gt;<br/>        &lt;BarGroup<br/>          data={data}<br/>          keys={keys}<br/>          height={yMax}<br/>          x0={getDate}<br/>          x0Scale={dateScale}<br/>          x1Scale={cityScale}<br/>          yScale={tempScale}<br/>          color={colorScale}<br/>        &gt;<br/>          {(barGroups) =&gt;<br/>            barGroups.map((barGroup) =&gt; (<br/>              &lt;Group<br/>                key={`bar-group-${barGroup.index}-${barGroup.x0}`}<br/>                left={barGroup.x0}<br/>              &gt;<br/>                {barGroup.bars.map((bar) =&gt; (<br/>                  &lt;rect<br/>                    key={`bar-group-bar-${barGroup.index}-${bar.index}-${bar.value}-${bar.key}`}<br/>                    x={bar.x}<br/>                    y={bar.y}<br/>                    width={bar.width}<br/>                    height={bar.height}<br/>                    fill={bar.color}<br/>                    rx={4}<br/>                    onClick={() =&gt; {<br/>                      if (!events) return;<br/>                      const { key, value } = bar;<br/>                      alert(JSON.stringify({ key, value }));<br/>                    }}<br/>                  /&gt;<br/>                ))}<br/>              &lt;/Group&gt;<br/>            ))<br/>          }<br/>        &lt;/BarGroup&gt;<br/>      &lt;/Group&gt;<br/>      &lt;AxisBottom<br/>        top={yMax + margin.top}<br/>        tickFormat={formatDate}<br/>        scale={dateScale}<br/>        stroke={green}<br/>        tickStroke={green}<br/>        hideAxisLine<br/>        tickLabelProps={() =&gt; ({<br/>          fill: green,<br/>          fontSize: 11,<br/>          textAnchor: "middle"<br/>        })}<br/>      /&gt;<br/>    &lt;/svg&gt;<br/>  );<br/>}</span><span id="e14a" class="mn lc iq mj b gy mv mp l mq mr">export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Example width="500" height="300" /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="6a64" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mj b">blue</code>、<code class="fe ms mt mu mj b">green</code>和<code class="fe ms mt mu mj b">purple</code>变量设置条形的颜色。</p><p id="297d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">background</code>是背景色。</p><p id="44e9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">data</code>变量有我们想要获取并显示在栏中的模拟数据值。</p><p id="a29a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">keys</code>有x轴数值。</p><p id="151c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">defaultMargin</code>有页边距样式。</p><p id="1789" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们从D3的时间解析和格式化函数中创建了<code class="fe ms mt mu mj b">parseDate</code>和<code class="fe ms mt mu mj b">format</code>函数。</p><p id="1a34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe ms mt mu mj b">dateScale</code>和<code class="fe ms mt mu mj b">cityScale</code>变量创建日期和城市刻度。</p><p id="b454" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">cityScale</code>值为条形。</p><p id="9988" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">tempScale</code>是酒吧的高度。</p><p id="bff5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">colorScale</code>有条形的颜色。</p><p id="53ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">Example</code>组件有条形图。我们把所有东西都放在那里。</p><p id="29c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">xMax</code>和<code class="fe ms mt mu mj b">yMax</code>值分别是x轴和y轴的最大值。</p><p id="21b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用它来设置<code class="fe ms mt mu mj b">dateScale</code>和<code class="fe ms mt mu mj b">tempScale</code>的最大值。</p><p id="b711" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe ms mt mu mj b">return</code>语句中，我们把一切都放在了<code class="fe ms mt mu mj b">svg</code>元素中。</p><p id="2751" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">Group</code>有图表组件。</p><p id="5efa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe ms mt mu mj b">barGroups</code>映射到<code class="fe ms mt mu mj b">rect</code>元素来显示条形。</p><p id="579f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们设置<code class="fe ms mt mu mj b">width</code>和<code class="fe ms mt mu mj b">height</code>支柱来设置它们的宽度和高度。</p><p id="b582" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">x轴由<code class="fe ms mt mu mj b">AxisBottom</code>组件渲染。</p><p id="a167" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们设置<code class="fe ms mt mu mj b">top</code>道具来设置轴的位置。</p><p id="bda2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">tickFormat</code>有蜱。</p><p id="6e98" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">tickLabelProps</code>有标签样式。</p><h1 id="4640" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="1dce" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过Visx库轻松地将分组条形图添加到React应用程序中。</p><p id="6079" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p><p id="951f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mw">更多内容请看</em><a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mw">plain English . io</em></strong></a></p></div></div>    
</body>
</html>