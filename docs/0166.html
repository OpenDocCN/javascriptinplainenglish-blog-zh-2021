<html>
<head>
<title>Animate When Element is In-View with Framer Motion</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当元素出现在视图中且有帧运动时，制作动画</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/animate-when-element-is-in-view-with-framer-motion-63b254403bf?source=collection_archive---------0-----------------------#2021-01-10">https://javascript.plainenglish.io/animate-when-element-is-in-view-with-framer-motion-63b254403bf?source=collection_archive---------0-----------------------#2021-01-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="28cb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一个简单的解决方案，动画反应元素时，在视图中使用帧运动</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/474615318adbb793f4446fe370280214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QoD67s7UQk5YDpXr"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@cassidykelley?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Cassidy Kelley</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="fcc8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我最近一直在探索不同的动画库，并开始喜欢我的React应用程序的framer motion。Framer Motion被描述为一个生产就绪的React动画和手势库。看看他们的网站，看看你能做些什么。</p><div class="ls lt gp gr lu lv"><a href="https://www.framer.com/motion/" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">React |成帧器动作的生产就绪动画库</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">Framer Motion是一个生产就绪的React动画和手势库。</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">www.framer.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><p id="af96" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">前几天在构建网页时，我想给一个元素添加一个动画，但是我在时间上遇到了一些麻烦。</p><p id="cd61" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">问题是，当组件在页面加载时出现动画。听起来没什么大不了的，对吧？然而，由于该元素在页面上的位置较低，所以在我向下滚动查看它之前，动画就已经开始了。我需要找到一种方法让动画在元素进入屏幕视图时开始。我检查了文档，但是我找不到我正在寻找的确切解决方案。</p><p id="07e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这时候我问了我最好的朋友谷歌，我在<a class="ae kv" href="https://stackoverflow.com/questions/58958972/framer-motion-animate-when-element-is-in-view-when-you-scroll-to-element" rel="noopener ugc nofollow" target="_blank"> Stack Overflow </a>上发现了这个线程。它帮助我实现了我正在寻找的功能，我想在这里分享这个解决方案。我希望它能对将来遇到同样问题的人有所帮助。如果你知道实现这个功能的其他方法，请告诉我。我总是渴望看到其他解决方案。</p><p id="f94c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们开始之前，我假设您了解React，并且有一些使用framer motion或其他动画库的经验。我不会太深入地研究帧运动，因为本文将只关注元素进入屏幕视图时动画的开始。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="f015" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">入门指南</h1><p id="da2a" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">为了演示这一点，我们将使用React创建一个简单的应用程序，当红框进入屏幕视图时，它会显示红框的动画。在本次演示中，我们将使用create-react-app。如果你想克隆这个应用程序，你可以在下面我的GitHub库查看代码。</p><div class="ls lt gp gr lu lv"><a href="https://github.com/chadmuro/framer-motion-inview" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">chadmuro/framer-motion-inview</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">当元素在视图中时动画，使用帧运动-Chad muro/帧运动-在视图中</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">github.com</p></div></div><div class="me l"><div class="no l mg mh mi me mj kp lv"/></div></div></a></div><p id="31e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们从清理项目中的一些未使用的文件开始，并清理index.js文件。请注意，在我们的示例中，我们将只处理index.js文件。通常，您会希望为每个组件创建单独的文件。</p><p id="0400" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在您的src文件夹中，我们将有一个index.js文件和一个index.css文件，如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/00462f9e7ac4fd9fce62df1671da82af.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*y2IAdrdV2sUSWb3v1J3Z-A.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">index.js</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/f330c2f445d847ad379c2d5e6e8e9da4.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*OIneWcnubcu_sYbCO9FDxA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">index.css</figcaption></figure><p id="f38d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的index.js文件中，我们的App组件显示了10个Box组件。正如您在我们的index.css文件中看到的，每个Box组件都是一个200px x 200px的红色正方形。目前，我们的应用程序应该是这样的；只是一堆红盒子。很无聊吧？让我们给我们的应用程序添加一些动画！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/1459f794605fa51bacb3fd436a12633c.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*kVZR2GABPJive4Dy3CayxA.gif"/></div></figure><h1 id="5294" class="mr ms iq bd mt mu ns mw mx my nt na nb jw nu jx nd jz nv ka nf kc nw kd nh ni bi translated">具有帧运动的动画</h1><p id="313b" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">在我们的例子中，当红色方块出现在屏幕上时，我们希望将它们动画化。为了实现这一点，我们将使用framer motion来添加动画，以及一个名为react intersection observer的包来跟踪元素何时进入视图。让我们通过运行以下命令来安装这两个包。</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="bf94" class="oc ms iq ny b gy od oe l of og">npm install framer-motion react-intersection-observer</span></pre><p id="4875" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一步是当组件装载到页面时，让动画在所有的盒子上工作。我们将首先从成帧器运动库中导入运动。</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="65d8" class="oc ms iq ny b gy od oe l of og">import { motion } from 'framer-motion';</span></pre><p id="3136" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们将为我们的box组件创建一个变体。我们将用0.5秒的时间将我们的盒子从0放大到1。要了解更多关于变体的信息，请看这里的文档<a class="ae kv" href="https://www.framer.com/api/motion/animation/#variants" rel="noopener ugc nofollow" target="_blank"/>。</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="69f6" class="oc ms iq ny b gy od oe l of og">const boxVariants = {<br/>  hidden: { scale: 0 },<br/>  visible: {<br/>    scale: 1,<br/>    transition: {<br/>      duration: 0.5<br/>    }<br/>  }<br/>}</span></pre><p id="828b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们将动画设置为div组件。</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="7b91" class="oc ms iq ny b gy od oe l of og">&lt;motion.div className="Box" initial="hidden" animate="visible" variants={boxVariants}&gt;&lt;/motion.div&gt;</span></pre><p id="efad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们现在看一下我们的应用程序，我们应该有如下所示的内容。在页面加载时，所有的框将在0.5秒内放大。但是，如果我们向下滚动，您会看到所有的框都已经显示出来。这是因为所有盒子的动画都是在初始组件挂载时发生的。当我们向下滚动时，动画已经完成。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/167e8c7d887f728ec251c9e0156fefac.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*wKbo-WtXMRqPrHUMaG_U6g.gif"/></div></figure><h1 id="7f92" class="mr ms iq bd mt mu ns mw mx my nt na nb jw nu jx nd jz nv ka nf kc nw kd nh ni bi translated">使用React交叉点观察器</h1><p id="2de6" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">这是我们将使用react交叉点观察器包的地方。这个API可以告诉我们元素何时进入或离开视口。你可以看看他们的文件<a class="ae kv" href="https://react-intersection-observer.vercel.app/?path=/story/introduction--page" rel="noopener ugc nofollow" target="_blank">这里</a>了解更多。在我们的例子中，我们将使用useInView钩子。我们还将从帧运动中抓取动画钩子，从反应中抓取效果钩子。我们的进口现在应该如下。</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="c2d8" class="oc ms iq ny b gy od oe l of og">import React, { useEffect } from 'react';<br/>import ReactDOM from 'react-dom';<br/>import { motion, useAnimation } from 'framer-motion';<br/>import { useInView } from 'react-intersection-observer';<br/>import './index.css';</span></pre><p id="9a03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用动画钩子来控制动画的开始。从useInView钩子，我们将使用对象析构来访问ref和InView属性。</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="0339" class="oc ms iq ny b gy od oe l of og">const controls = useAnimation();<br/>const { ref, inView } = useInView();</span></pre><p id="a03a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们将使用useEffect钩子来检查元素是否在屏幕视图中。如果是这样，我们将启动动画来显示该框。如果元素不在屏幕视图中，我们将启动动画来隐藏该框。</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="6700" class="oc ms iq ny b gy od oe l of og">useEffect(() =&gt; {<br/>  if (inView) {<br/>    controls.start('visible');<br/>  }<br/>  if (!inView) {<br/>    controls.start('hidden');<br/>  }<br/>}, [controls, inView]);</span></pre><p id="4da9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们将更新motion.div组件上的道具。首先，我们需要设置对每个box组件的引用。然后，将动画道具更新为controls变量。这将允许我们引用每个框，并在它进入屏幕视图和离开屏幕视图时启动动画。</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="dc1a" class="oc ms iq ny b gy od oe l of og">&lt;motion.div ref={ref} className="Box" initial="hidden" animate={controls} variants={boxVariants}&gt;&lt;/motion.div&gt;</span></pre><p id="db1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最终的index.js文件应该如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/1c4a737c604cb892beb239554d1fa824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*P3LZdN0CLu1jstyF3V4TiQ.png"/></div></figure></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="cbe7" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">包扎</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/b0fc0e4e7f1371621afdebf36c9fef2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*A8HEBFNGZquG-5VLLz0qFw.gif"/></div></figure><p id="5775" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你最终的应用应该是这样的。我相信你可以开发出比这个程序更有趣的东西。</p><p id="c86a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你能把这些知识应用到你的网页动画中。这只是我们可以用成帧器运动库做的一件小事，我建议你自己去看看。在你的网页上添加动画确实有助于你的网站脱颖而出，吸引用户的注意力。</p><p id="c39a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！如果你想看另一个正在运行的动画库Anime.js，可以看看下面的文章。</p><div class="ls lt gp gr lu lv"><a href="https://medium.com/javascript-in-plain-english/build-a-bouncing-basketball-app-with-anime-js-90eb5b4630d1" rel="noopener follow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">用Anime.js搭建弹跳篮球App</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">用Anime.js创建弹跳效果</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">medium.com</p></div></div><div class="me l"><div class="oi l mg mh mi me mj kp lv"/></div></div></a></div></div></div>    
</body>
</html>