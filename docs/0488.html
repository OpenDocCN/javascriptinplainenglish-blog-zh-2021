<html>
<head>
<title>JavaScript Parallax Scrolling Effect</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript视差滚动效果</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-parallax-scrolling-effect-c14723806655?source=collection_archive---------8-----------------------#2021-01-29">https://javascript.plainenglish.io/javascript-parallax-scrolling-effect-c14723806655?source=collection_archive---------8-----------------------#2021-01-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="d117" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">视差网页设计的程序员解决方案</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/9971d1c1c1325cebbb6f9bfb1e64c695.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AOB8jDvcXDTKXMbMdKRiLg.png"/></div></div></figure><h1 id="d816" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated"><strong class="ak">我们正在研究的一般解决方案是这个</strong></h1><p id="757a" class="pw-post-body-paragraph lg lh in li b lj lk jo ll lm ln jr lo lp lq lr ls lt lu lv lw lx ly lz ma mb ig bi translated">我们将<strong class="li io">修复页面上的一个HTML元素</strong>(<em class="mc">在这里是一个圆形的DIV</em>)。</p><p id="7b0e" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">当我们向下<strong class="li io">滚动页面</strong>时，我们将手动向上<strong class="li io">滚动HTML元素</strong>。</p><p id="108a" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">因为我们手动向上滚动元素，所以我们可以控制它移动的快慢。</p><p id="a5cc" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">这就产生了我们的<strong class="li io">视差效果</strong>。</p><h2 id="86bb" class="mi kp in bd kq mj mk dn ku ml mm dp ky lp mn mo la lt mp mq lc lx mr ms le mt bi translated"><strong class="ak">让我们写好HTML和CSS</strong></h2><p id="fb97" class="pw-post-body-paragraph lg lh in li b lj lk jo ll lm ln jr lo lp lq lr ls lt lu lv lw lx ly lz ma mb ig bi translated"><strong class="li io">将页面规格化，使其纵向较长，这样我们就有了滚动空间。</strong></p><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="fcb1" class="mi kp in mv b gy mz na l nb nc">body {</span><span id="e7f0" class="mi kp in mv b gy nd na l nb nc">  overflow-x: hidden;</span><span id="0bd0" class="mi kp in mv b gy nd na l nb nc">  width: 100vw;</span><span id="9d82" class="mi kp in mv b gy nd na l nb nc">  height: 300vh;</span><span id="155c" class="mi kp in mv b gy nd na l nb nc">  background-size: contain;</span><span id="6a91" class="mi kp in mv b gy nd na l nb nc">  background-image: url(‘./back.png’);</span><span id="92d8" class="mi kp in mv b gy nd na l nb nc">}</span></pre><p id="181d" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated"><strong class="li io">创建一个DIV </strong></p><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="a93a" class="mi kp in mv b gy mz na l nb nc">&lt;body&gt;</span><span id="62a5" class="mi kp in mv b gy nd na l nb nc">  &lt;div class=”orb”&gt;&lt;/div&gt;</span><span id="4b88" class="mi kp in mv b gy nd na l nb nc">&lt;/body&gt;</span></pre><p id="1bff" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated"><strong class="li io">那我们就把样式改成圆形</strong></p><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="3d0a" class="mi kp in mv b gy mz na l nb nc">.orb {</span><span id="09b4" class="mi kp in mv b gy nd na l nb nc">  margin: 0;</span><span id="ef41" class="mi kp in mv b gy nd na l nb nc">  padding: 0;</span><span id="eddd" class="mi kp in mv b gy nd na l nb nc">  height: 200px;</span><span id="a9b4" class="mi kp in mv b gy nd na l nb nc">  width: 200px;</span><span id="3ce6" class="mi kp in mv b gy nd na l nb nc">  position: fixed;</span><span id="4e7c" class="mi kp in mv b gy nd na l nb nc">  top: 50%;</span><span id="8554" class="mi kp in mv b gy nd na l nb nc">  left: 50%;</span><span id="902f" class="mi kp in mv b gy nd na l nb nc">  transform: translate(-50%, -50%);</span><span id="24fd" class="mi kp in mv b gy nd na l nb nc">  border-radius: 50%;</span><span id="d2ce" class="mi kp in mv b gy nd na l nb nc">  background-color: #0083FF;</span><span id="11cd" class="mi kp in mv b gy nd na l nb nc">  box-shadow: 0px 0px 20px 10px #0083FF;</span><span id="66c3" class="mi kp in mv b gy nd na l nb nc">}</span></pre></div><div class="ab cl ne nf hr ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ig ih ii ij ik"><h1 id="9402" class="ko kp in bd kq kr nl kt ku kv nm kx ky jt nn ju la jw no jx lc jz np ka le lf bi translated">让我们来看看JavaScript </h1><h2 id="5586" class="mi kp in bd kq mj mk dn ku ml mm dp ky lp mn mo la lt mp mq lc lx mr ms le mt bi translated">这个项目我们需要6个变量。</h2><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="71b2" class="mi kp in mv b gy mz na l nb nc">const orb = document.querySelector(‘.orb’),</span><span id="2b9a" class="mi kp in mv b gy nd na l nb nc">ease = 0.05,</span><span id="896e" class="mi kp in mv b gy nd na l nb nc">start_position = orb.offsetTop;</span><span id="36b7" class="mi kp in mv b gy nd na l nb nc">let scroll_request = 0,</span><span id="1318" class="mi kp in mv b gy nd na l nb nc">total_offset = 0,</span><span id="e8bf" class="mi kp in mv b gy nd na l nb nc">animation_running = false;</span></pre><p id="8d87" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">1.<strong class="li io"> orb </strong> —我们想要移动的HTML元素</p><p id="8fa0" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">2.放松——我们控制HTML元素相对于页面滚动的快慢</p><p id="9980" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">3.<strong class="li io"> start_position </strong> —该元素相对于文档/页面顶部的起始位置(<em class="mc"> y位置</em>)</p><p id="f803" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">4.<strong class="li io"> scroll_request </strong> —当我们滚动页面时，我们想告诉我们的程序滚动我们的HTML元素</p><p id="2f22" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">5.<strong class="li io"> total_offset </strong> —我们记录我们总共向上或向下滚动了多远</p><p id="453e" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">6.<strong class="li io"> animation_running </strong> —我们用它来让我们的<strong class="li io"> requestAnimationFrame()循环</strong>开始和停止</p><h1 id="7508" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated"><strong class="ak">让我们建立开始动画循环的逻辑</strong></h1><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="2a28" class="mi kp in mv b gy mz na l nb nc">function animate_scroll() {</span><span id="a231" class="mi kp in mv b gy nd na l nb nc">  scroll_request++;</span><span id="55ab" class="mi kp in mv b gy nd na l nb nc">  if (!animation_running) {</span><span id="5e3b" class="mi kp in mv b gy nd na l nb nc">    animation_running = true;</span><span id="a38f" class="mi kp in mv b gy nd na l nb nc">    animation_loop();</span><span id="96dd" class="mi kp in mv b gy nd na l nb nc">  }</span><span id="65a1" class="mi kp in mv b gy nd na l nb nc">}</span></pre><p id="bb6a" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated"><strong class="li io">每次我们滚动页面时，我们都想滚动HTML元素。</strong></p><p id="eec1" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">如果我们滚动滚轮100次，我们希望确保<strong class="li io">也提交一个滚动HTML元素100次的请求</strong>。</p><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="22bb" class="mi kp in mv b gy mz na l nb nc">scroll_request++;</span></pre><p id="4a97" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">如果当前没有运行动画循环，我们将启动一个；确保将我们的<strong class="li io">动画_运行</strong>切换到<strong class="li io">真实</strong>。</p><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="f63a" class="mi kp in mv b gy mz na l nb nc">if (!animation_running) {</span><span id="2636" class="mi kp in mv b gy nd na l nb nc">  animation_running = true;</span><span id="3d2b" class="mi kp in mv b gy nd na l nb nc">  animation_loop();</span><span id="1b38" class="mi kp in mv b gy nd na l nb nc">}</span></pre><h1 id="2538" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated"><strong class="ak">让我们创建实际的动画循环</strong></h1><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="74da" class="mi kp in mv b gy mz na l nb nc">function animation_loop() {</span><span id="d5f5" class="mi kp in mv b gy nd na l nb nc">  let current_offset = window.pageYOffset;</span><span id="ba3e" class="mi kp in mv b gy nd na l nb nc">  let difference = current_offset — total_offset;</span><span id="fae5" class="mi kp in mv b gy nd na l nb nc">  different *= ease;</span><span id="ee52" class="mi kp in mv b gy nd na l nb nc">  if (Math.abs(difference) &lt; 0.05) {</span><span id="3df1" class="mi kp in mv b gy nd na l nb nc">      scroll_request = 0;</span><span id="7d73" class="mi kp in mv b gy nd na l nb nc">      total_offset = current_offset;</span><span id="fd5d" class="mi kp in mv b gy nd na l nb nc">      animation_running = false;</span><span id="c201" class="mi kp in mv b gy nd na l nb nc">      return;</span><span id="df70" class="mi kp in mv b gy nd na l nb nc">  }</span><span id="adcf" class="mi kp in mv b gy nd na l nb nc">  orb.style.top = `${start_position — total_offset}px`;</span><span id="fd19" class="mi kp in mv b gy nd na l nb nc">  total_offset += difference;</span><span id="86bd" class="mi kp in mv b gy nd na l nb nc">  requestAnimationFrame(animation_loop);</span><span id="cec7" class="mi kp in mv b gy nd na l nb nc">}</span></pre><h2 id="3365" class="mi kp in bd kq mj mk dn ku ml mm dp ky lp mn mo la lt mp mq lc lx mr ms le mt bi translated"><strong class="ak">我们在这里做4件主要的事情(不按这个顺序)</strong></h2><p id="861a" class="pw-post-body-paragraph lg lh in li b lj lk jo ll lm ln jr lo lp lq lr ls lt lu lv lw lx ly lz ma mb ig bi translated">1.计算我们文档的当前位置和页面/文档顶部之间的<strong class="li io">差值</strong>。</p><p id="9cf4" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">我们的页面从哪里开始</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nq"><img src="../Images/751a40723f81baec61a31eda3172fd5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eWeLI88KRy16ikt2.png"/></div></div></figure><p id="d09a" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated"><strong class="li io">我们如何计算差异:</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nr"><img src="../Images/d262590b03cd61127b11e746ec9e9c87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mCfrT60ZaKY_I6DM.png"/></div></div></figure><p id="fe9a" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">2.移动我们的HTML到那个<strong class="li io">的差异</strong>。(<em class="mc">差值乘以我们的</em><strong class="li io"/><em class="mc">创建我们的视差效果</em> <strong class="li io"> ) </strong></p><p id="2557" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">3.为我们的动画请求另一个循环。</p><p id="354e" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">4.我们对于动画循环的<strong class="li io">退出条款</strong>是如果<strong class="li io">差</strong>小于<strong class="li io"> 0.05 </strong>。基本上，如果HTML元素到达了它的目的地。</p></div><div class="ab cl ne nf hr ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ig ih ii ij ik"><h1 id="b361" class="ko kp in bd kq kr nl kt ku kv nm kx ky jt nn ju la jw no jx lc jz np ka le lf bi translated">我们可以对任何类型的HTML元素使用这个逻辑。</h1><h2 id="4142" class="mi kp in bd kq mj mk dn ku ml mm dp ky lp mn mo la lt mp mq lc lx mr ms le mt bi translated"><strong class="ak">div、段落、跨度、图像… </strong></h2><p id="207e" class="pw-post-body-paragraph lg lh in li b lj lk jo ll lm ln jr lo lp lq lr ls lt lu lv lw lx ly lz ma mb ig bi translated">你可以在这里得到源文件<a class="ae ns" href="https://github.com/an-object-is-a/js-parallax-scroll" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl ne nf hr ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ig ih ii ij ik"><p id="de2b" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">如果你想要更深入的指导，请查看我在YouTube上的完整视频教程，<a class="ae ns" href="https://www.youtube.com/c/anobjectisa" rel="noopener ugc nofollow" target="_blank"> <strong class="li io">一个对象是一个</strong> </a>。</p><p id="500c" class="pw-post-body-paragraph lg lh in li b lj md jo ll lm me jr lo lp mf lr ls lt mg lv lw lx mh lz ma mb ig bi translated">请务必在<a class="ae ns" href="https://www.instagram.com/an_object_is_a/" rel="noopener ugc nofollow" target="_blank"> <strong class="li io"> Instagram </strong> </a>和<a class="ae ns" href="https://twitter.com/anobjectisa1" rel="noopener ugc nofollow" target="_blank"> <strong class="li io"> Twitter </strong> </a>上关注我们，以跟上我们最新的<strong class="li io"> Web开发教程</strong>。</p><h2 id="b10f" class="mi kp in bd kq mj mk dn ku ml mm dp ky lp mn mo la lt mp mq lc lx mr ms le mt bi translated"><strong class="ak"> JavaScript视差滚动效果</strong></h2><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div></div>    
</body>
</html>