<html>
<head>
<title>Node.js: Unzip Async Await</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Node.js: Unzipå¼‚æ­¥ç­‰å¾…</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/node-js-unzip-async-await-901040d30393?source=collection_archive---------5-----------------------#2021-03-14">https://javascript.plainenglish.io/node-js-unzip-async-await-901040d30393?source=collection_archive---------5-----------------------#2021-03-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="33ca" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">åœ¨å¼‚æ­¥Node.jsä¸Šä¸‹æ–‡ä¸­è§£å‹ç¼©ä¸€ä¸ª. zipæ–‡ä»¶ã€‚</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b51e1be77707d1331575abf92df48a87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aRAiHOPwSAGnffuFtAGghA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@flo_stk?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Florian Steciuk</a> on <a class="ae kv" href="/s/photos/highway?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="dc1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘æ­£åœ¨å¼€å‘<a class="ae kv" href="https://deckdeckgo.com" rel="noopener ugc nofollow" target="_blank"> DeckDeckGo </a>çš„æ–°åŠŸèƒ½ï¼Œä¸ºæ­¤æˆ‘å¿…é¡»åœ¨<a class="ae kv" href="https://firebase.google.com/docs/functions" rel="noopener ugc nofollow" target="_blank"> Firebaseå‡½æ•°</a>ä¸­è§£å‹ç¼©æ•°æ®ã€‚</p><p id="ef62" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç¼–å†™è¿™æ ·ä¸€ä¸ª<a class="ae kv" href="https://nodejs.org/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>å‡½æ•°èŠ±è´¹äº†æ¯”é¢„æœŸæ›´å¤šçš„æ—¶é—´ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘åˆ†äº«è¿™ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå¸Œæœ›æœ‰ä¸€å¤©å®ƒä¹Ÿèƒ½å¸®åŠ©ä½ ğŸ˜‡ã€‚</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="50e5" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">è§£å‹ç¼©ç¨‹åº</h1><p id="b006" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">Node.jsæä¾›äº†ä¸€ä¸ªå‹ç¼©æ¨¡å—<a class="ae kv" href="https://nodejs.org/api/zlib.html" rel="noopener ugc nofollow" target="_blank"> Zlib </a>ï¼Œä½†æ˜¯å®ƒä¸æ”¯æŒZIPæ–‡ä»¶ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åº“<a class="ae kv" href="https://github.com/ZJONSSON/node-unzipper" rel="noopener ugc nofollow" target="_blank">è§£å‹ç¼©å™¨</a>æ¥å¤„ç†è¿™äº›ã€‚</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="f809" class="nb ma iq mx b gy nc nd l ne nf">npm i unzipper --save</span></pre></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="0596" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">ç”¨å¼‚æ­¥Awaitè§£å‹ç¼©</h1><p id="6b66" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">æˆ‘çš„æ–°ç‰¹æ€§é€šè¿‡æµè¯»å†™ä¸Šä¼ åˆ°<a class="ae kv" href="https://firebase.google.com/docs/storage" rel="noopener ugc nofollow" target="_blank"> Firebaseå­˜å‚¨å™¨</a>çš„æ•°æ®ã€‚æˆ‘ä¹Ÿç”¨promises (async / await)æ–¹æ³•å¼€å‘æˆ‘çš„ä»£ç ã€‚å› æ­¤ï¼Œä¸¤è€…å¿…é¡»å…±å­˜ã€‚</p><p id="80aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºäº†ç¼©å°ä»¥ä¸‹ç¤ºä¾‹çš„èŒƒå›´ï¼Œæˆ‘ç”¨æ–‡ä»¶ç³»ç»Ÿæµ(<code class="fe ng nh ni mx b">fs</code>)å¤„ç†çš„æœ¬åœ°æ–‡ä»¶æ›¿æ¢äº†äº‘å­˜å‚¨ã€‚</p><p id="4966" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å‡½æ•°<code class="fe ng nh ni mx b">unzip</code>åœ¨é€šè¿‡<code class="fe ng nh ni mx b">unzipper</code>ä¼ è¾“çš„<code class="fe ng nh ni mx b">zip</code>æ•°æ®ä¸Šå®ä¾‹åŒ–ä¸€ä¸ªæµã€‚æ¯ä¸ªæ¡ç›®éƒ½è¢«è¿­ä»£å¹¶é€šè¿‡ç®¡é“ä¼ è¾“åˆ°å¯å†™è¾“å‡ºã€‚æ‘˜è¦:æ‰“å¼€zipæ–‡ä»¶ï¼Œå¹¶æå–å…¶ä¸­åŒ…å«çš„æ¯ä¸ªæ–‡ä»¶ã€‚</p><p id="c515" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ng nh ni mx b">unzip</code>åœ¨ä¸€ä¸ªå¤å¤å…¼å®¹çš„top awaitå‡½æ•°ä¸­è¢«è°ƒç”¨ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯å®ƒçš„ğŸ¥³.</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="6e83" class="nb ma iq mx b gy nc nd l ne nf">const {Parse} = require('unzipper');<br/>const {createWriteStream, createReadStream} = require('fs');<br/><br/>const unzip = () =&gt; {<br/>  const stream = <br/>    createReadStream('/Users/david/data.zip').pipe(Parse());<br/><br/>  return new Promise((resolve, reject) =&gt; {<br/>    stream.on('entry', (entry) =&gt; {<br/>      const writeStream = <br/>        createWriteStream(`/Users/david/${entry.path}`);<br/>      return entry.pipe(writeStream);<br/>    });<br/>    stream.on('finish', () =&gt; resolve());<br/>    stream.on('error', (error) =&gt; reject(error));<br/>  });<br/>};<br/><br/>(async () =&gt; {<br/>  try {<br/>    await unzip();<br/>  } catch (err) {<br/>    console.error(err);<br/>  }<br/>})();</span></pre></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="e805" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">ç”¨å¼‚æ­¥Awaitè¯»å–å­—ç¬¦ä¸²</h1><p id="1f3a" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">æˆ‘ä¹Ÿå¿…é¡»ç”¨æµæ¥è¯»å–æ–‡ä»¶ã€‚å› æ­¤ï¼Œæ¨±æ¡ƒåœ¨é¡¶éƒ¨ï¼Œè¿™é‡Œæ˜¯æˆ‘å¦‚ä½•åœ¨æˆ‘çš„ä»£ç é›†æˆè¿™äº›ã€‚</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="d4ba" class="nb ma iq mx b gy nc nd l ne nf">const {createReadStream} = require('fs');<br/><br/>const read = () =&gt; {<br/>  const stream = <br/>    createReadStream('/Users/david/meta.json');<br/><br/>  return new Promise((resolve, reject) =&gt; {<br/>    let data = '';<br/><br/>    stream.on('data', (chunk) =&gt; (data += chunk));<br/>    stream.on('end', () =&gt; resolve(data));<br/>    stream.on('error', (error) =&gt; reject(error));<br/>  });<br/>};<br/><br/>(async () =&gt; {<br/>  try {<br/>    const meta = await read();<br/><br/>    console.log({meta});<br/>  } catch (err) {<br/>    console.error(err);<br/>  }<br/>})();</span></pre><p id="569b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å®ƒéµå¾ªä¸å‰é¢ç›¸åŒçš„æ–¹æ³•ï¼Œå°†æ–‡ä»¶å†…å®¹è¯»å…¥å†…å­˜<code class="fe ng nh ni mx b">string</code>ã€‚</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="8305" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">æ‘˜è¦</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/49f06bcb32d187d378e9131e1d5d5e18.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*6wJfY8vH1FbC1s4Uzxy0QQ.gif"/></div></figure><blockquote class="nk nl nm"><p id="9f69" class="kw kx nn ky b kz la jr lb lc ld ju le no lg lh li np lk ll lm nq lo lp lq lr ij bi translated">ç¼–ç å°±åƒä¸€ç›’å·§å…‹åŠ›ã€‚ä½ æ°¸è¿œä¸çŸ¥é“ä½ ä¼šå¾—åˆ°ä»€ä¹ˆã€‚æœ‰æ—¶å€™è¦å¿«ï¼Œéœ€è¦æ—¶é—´ã€‚æœ‰æ—¶å€™è¿™éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œä½†æ˜¯å®ƒå¾ˆå¿«å°±è¿‡å»äº†â€”â€”å¯¹é˜¿ç”˜æ¥è¯´</p></blockquote><p id="eb74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åˆ°æ— é™å’Œæ›´è¿œçš„åœ°æ–¹ï¼</p><p id="2707" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¤§å«</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="386a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½ å¯ä»¥åœ¨æ¨ç‰¹ä¸Šæˆ–è€…æˆ‘çš„ç½‘ç«™ä¸Šè”ç³»åˆ°æˆ‘ã€‚</p><p id="1cae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å°è¯•<a class="ae kv" href="https://deckdeckgo.com/" rel="noopener ugc nofollow" target="_blank"> DeckDeckGo </a>åˆ¶ä½œæ‚¨çš„ä¸‹ä¸€å¼ å¹»ç¯ç‰‡ğŸ¤Ÿã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><a href="https://deckdeckgo.com"><div class="gh gi nr"><img src="../Images/60715bd16846fb2485281256d8cf3a98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cBEcAFbsMaSsNOPC.png"/></div></a></figure></div></div>    
</body>
</html>