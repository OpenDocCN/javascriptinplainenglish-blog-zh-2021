# 使用 Reach 路由器登录后重定向

> 原文：<https://javascript.plainenglish.io/redirect-after-login-with-reach-router-29c5d7398cb1?source=collection_archive---------16----------------------->

![](img/e1fc2e19dad40e6898813c8ca8923cfb.png)

登录后重定向用户是 web 应用程序中的一个常见功能。通常情况下，当用户的会话过期，他们需要再次登录才能看到他们最初请求的页面时，它就会显示出来。

这种体验是用户所期望的，但需要由开发人员具体实现。

在本文中，我将回顾我最近是如何实现这个特性的。

我将利用浏览器窗口中的位置对象。我还将使用 React 路由库 Reach 路由器。你不一定要用 [Reach](https://reach.tech/router/) 路由器来做这个工作，原理应该是一样的。

让我们从我的有效会话检查开始。

我的应用程序有一个包装所有认证视图的高阶组件。如果用户的会话过期，我会将他们重定向到登录页面。

最重要的是从 location 对象中捕获路径名，并将其保存在某个地方。

`{state: {from: location.pathname}}`

到达路由器建议将这样的变量添加到 location.state 对象中。你可以保存它，只要确保它在一个容易从应用程序的其他部分访问的地方。

接下来，让我们看看登录页面。

当用户在这里登陆时，我使用 Reach Router 提供的`useLocation()`钩子来获取窗口。位置对象。

我的登录页面本身并不关心用户来自哪里。所以我将把我们之前添加的`location.state.from`值传递到我的登录函数中。

一旦我的用户成功登录，我就检查从登录页面传来的可选变量。如果已经设置，用户应该被带到他们最初想访问的页面。

我选择将 from 值传递给我的登录函数有两个原因:

1.  只能在功能组件内部调用`useLocation()`钩子，而我的登录请求在我的应用程序中的其他地方被调用。
2.  这使得我的函数更容易测试。

现在，如果用户有他们想要访问的特定路线，他们在登录后将被成功重定向到该路线。

*更多内容请看*[*plain English . io*](http://plainenglish.io/)