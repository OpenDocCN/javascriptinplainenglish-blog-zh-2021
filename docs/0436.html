<html>
<head>
<title>When Your Firebase Cloud Functions Don’t Want to Deploy Anymore</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当您的Firebase云功能不想再部署时</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/when-your-firebase-cloud-functions-dont-want-to-deploy-anymore-2181fb217f6b?source=collection_archive---------5-----------------------#2021-01-26">https://javascript.plainenglish.io/when-your-firebase-cloud-functions-dont-want-to-deploy-anymore-2181fb217f6b?source=collection_archive---------5-----------------------#2021-01-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0c6d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">不要再看了</h2></div><p id="5fcd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">TL；DR —我通过将本地和云功能节点. js版本设置为12来解决这个问题。</em></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/762084da82ce648dc7b1b8b8440a70a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*bf6dezfTexA6AXrq470G-g.jpeg"/></div></figure><h1 id="ef29" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated">故事</h1><p id="aeb8" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">我一直使用<a class="ae mh" href="https://www.npmjs.com/package/firebase-tools" rel="noopener ugc nofollow" target="_blank"> firebase-tools </a>来手动部署我的云功能，如下所示:</p><pre class="ld le lf lg gt mi mj mk ml aw mm bi"><span id="fd5e" class="mn ll iq mj b gy mo mp l mq mr">firebase deploy --only functions</span></pre><p id="e37c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我的<a class="ae mh" href="https://lazytexts.com" rel="noopener ugc nofollow" target="_blank">项目/公司</a>开展的过去八个月里，我从未遇到过部署云功能的问题，直到今天。</p><p id="7180" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一次，我得到了一个错误:</p><pre class="ld le lf lg gt mi mj mk ml aw mm bi"><span id="ed7e" class="mn ll iq mj b gy mo mp l mq mr">Deployment error. Build failed: Build error details not available.</span></pre><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/c476760ecc4f60ee59c052b051400e7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*CVxUkKuKYenKmTCehOtXnw.jpeg"/></div></figure><p id="0697" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为什么没有生成错误的详细信息？我永远不会知道。这个错误几乎和它们发生时一样无用。我知道我必须做什么。将这条消息粘贴到谷歌后，我偶然发现了以下GitHub问题:</p><p id="c78e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae mh" href="https://github.com/firebase/firebase-tools/issues/853" rel="noopener ugc nofollow" target="_blank">https://github.com/firebase/firebase-tools/issues/853</a></p><p id="0385" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在阅读了论坛上的每一条信息后，我满怀期待地等待着找到解决方案，但什么也没找到。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/830e098ea3c45bdcf2c8e9970969803d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*6KAYQcG0X2iULSh65uG3QQ.png"/></div></figure><p id="7bb6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我必须走得更远。我在幕后说话，扯下Firebase的窗帘，进入谷歌云平台日志。我发现了这个:</p><pre class="ld le lf lg gt mi mj mk ml aw mm bi"><span id="0750" class="mn ll iq mj b gy mo mp l mq mr">ERROR: error fetching storage source: generic::unknown: retry budget exhausted (3 attempts): fetching gcs source: unpacking source from gcs: source fetch container exited with non-zero status: 1</span></pre><p id="4742" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">显然，这对我来说毫无意义，但我有工作要做。我把这条信息贴到谷歌上，找到了答案:</p><div class="mt mu gp gr mv mw"><a href="https://stackoverflow.com/questions/64437656/gcp-cloud-function-error-fetching-storage-source-during-build-deploy/65780066#65780066" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd ir gy z fp nb fr fs nc fu fw ip bi translated">GCP云函数-在构建/部署期间获取存储源时出错</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">构建和部署功能时遇到问题。当试图以编程方式部署函数时，我得到了…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">stackoverflow.com</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk li mw"/></div></div></a></div><p id="d6f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个StackOverflow问题的指导下，我通过将本地和云函数Node.js版本设置为12来解决这个问题。为什么这样可以解决问题？好吧，所有优秀的软件工程师都知道，不要想太多。感谢您花时间阅读这篇文章。也许它帮助了你。也许你会给我一些掌声。也许这是我自己写的，所以我再也不用处理这个了。</p><h2 id="a9b4" class="mn ll iq bd lm nl nm dn lq nn no dp lu ko np nq lw ks nr ns ly kw nt nu ma nv bi translated">在Mac上将节点从版本15降级到版本12(自制)</h2><pre class="ld le lf lg gt mi mj mk ml aw mm bi"><span id="e1cd" class="mn ll iq mj b gy mo mp l mq mr">brew install node@12<br/>brew unlink node<br/>brew link --overwrite node@12</span></pre><h2 id="e960" class="mn ll iq bd lm nl nm dn lq nn no dp lu ko np nq lw ks nr ns ly kw nt nu ma nv bi translated">在Firebase云功能上将节点从版本10升级到版本12</h2><div class="mt mu gp gr mv mw"><a href="https://firebase.google.com/docs/functions/manage-functions#set_nodejs_version" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd ir gy z fp nb fr fs nc fu fw ip bi translated">管理功能部署和运行时选项| Firebase</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">您可以使用Firebase CLI命令或通过在…中设置运行时选项来部署、删除和修改函数</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">firebase.google.com</p></div></div><div class="nf l"><div class="nw l nh ni nj nf nk li mw"/></div></div></a></div><p id="8d0c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在您的函数文件夹的package.json文件中设置以下内容:</p><pre class="ld le lf lg gt mi mj mk ml aw mm bi"><span id="35b6" class="mn ll iq mj b gy mo mp l mq mr">“engines”: {</span><span id="1f58" class="mn ll iq mj b gy nx mp l mq mr">    “node”: “12”</span><span id="28e4" class="mn ll iq mj b gy nx mp l mq mr">}</span></pre><h2 id="f08a" class="mn ll iq bd lm nl nm dn lq nn no dp lu ko np nq lw ks nr ns ly kw nt nu ma nv bi translated">结论</h2><p id="5dc6" class="pw-post-body-paragraph kf kg iq kh b ki mc jr kk kl md ju kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">谢谢你的阅读。我希望你已经发现这很有用，不要遇到和我一样的问题。</p></div></div>    
</body>
</html>