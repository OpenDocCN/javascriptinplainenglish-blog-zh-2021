<html>
<head>
<title>Persist Application Data with Local Storage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用本地存储保存应用程序数据</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/persisting-data-using-local-storage-5820d2361990?source=collection_archive---------8-----------------------#2021-02-22">https://javascript.plainenglish.io/persisting-data-using-local-storage-5820d2361990?source=collection_archive---------8-----------------------#2021-02-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/005f947708f5c82913ab90d533e9714c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9lxYm_ntYFiwYm1uy5FFaw.jpeg"/></div></div></figure><p id="54e3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这篇文章是为那些开始学习用HTML、CSS和JavaScript构建web应用程序的人准备的。如果您想在不进入服务器端代码和数据库的情况下将一些数据存储到web应用程序中，我将向您展示如何使用本地存储持久化您的数据。</p><p id="599e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在我解释什么是本地存储之前，我们必须先看一下<code class="fe kt ku kv kw b">window</code>对象。</p><h1 id="7561" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">窗口对象</h1><p id="a403" class="pw-post-body-paragraph jv jw in jx b jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko lz kq kr ks ig bi translated">对象代表一个包含DOM文档的浏览器窗口。该对象由浏览器自动创建。它包含了一些属性和方法，我们可以使用这些属性和方法通过JavaScript代码来控制或操作浏览器。</p><h1 id="b1af" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">什么是本地存储？</h1><p id="29d1" class="pw-post-body-paragraph jv jw in jx b jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko lz kq kr ks ig bi translated">本地存储是<code class="fe kt ku kv kw b">window</code>对象的属性。它返回对web页面上的<code class="fe kt ku kv kw b">Storage</code>对象的引用。</p><figure class="mb mc md me gt jo gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/4aff2b64eec456a70ffe5c50e40cb0cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*-ZRfvtU9tQ1kxV6GTrzcqQ.png"/></div></figure><p id="bc84" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你查看浏览器控制台中的窗口对象，你会发现本地存储API有类似<code class="fe kt ku kv kw b">getItem</code>和<strong class="jx io"> </strong> <code class="fe kt ku kv kw b">setItem</code>的方法。这些是我们将在接下来的例子中使用的函数。</p><p id="3824" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">本地存储提供基本的CRUD操作，并允许您在计算机的浏览器中保存信息。这可以防止用户特定的信息丢失，而无需服务器将其存储在中央数据库中。假设我们使用HTML创建了一个简单的web应用程序，它接受用户的输入并将其显示在页面主体中。如果我们刷新页面，显示在页面正文中的数据将会消失。因为标准的HTML页面是静态的，所以刷新会导致页面恢复到原来的结构。</p><figure class="mb mc md me gt jo gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/9bf58c2e398fd375775b72131861d196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*yRUyjKZ3C9yrJlbWpEm4Dw.png"/></div></figure><p id="7195" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当我们使用本地存储时，保存的数据将一直保存在浏览器中，直到您在浏览器设置中手动清除它，或者通过编程方式清除它。这意味着，即使在刷新后或者关闭并重新打开浏览器，数据也将持续存在。</p><p id="0f3d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">数据存储在键-值对中，值必须是一个<code class="fe kt ku kv kw b">String</code>。您仍然可以像保存数组或任何其他对象一样保存值，但是您可以使用<code class="fe kt ku kv kw b">JSON.stringify</code>将其转换为字符串，然后在需要使用时使用<code class="fe kt ku kv kw b">JSON.parse</code>将其改回。让我们看看我们的例子。</p><h1 id="1603" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">使用本地存储的示例Web应用程序</h1><figure class="mb mc md me gt jo gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/6567b0278163cd2dc335ef88b6ad3f6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*LMP6P1X2CNc-N08ROKDOkA.gif"/></div></figure><p id="214d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我创建了一个页面来演示如何使用本地存储来保存一些数据。该页面允许用户发布和删除推文。</p><p id="2909" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用本地存储，我们能够将推文保存到内存中，因此即使我们刷新或离开浏览器，推文仍将存在，除非我们删除它们。让我们来看看将它变为现实的功能。</p><h2 id="7dd7" class="mh ky in bd kz mi mj dn ld mk ml dp lh kg mm mn ll kk mo mp lp ko mq mr lt ms bi translated">我们将在示例中涵盖的内容:</h2><ul class=""><li id="92ad" class="mt mu in jx b jy lv kc lw kg mv kk mw ko mx ks my mz na nb bi translated">向页面添加推文</li><li id="d89f" class="mt mu in jx b jy nc kc nd kg ne kk nf ko ng ks my mz na nb bi translated">从页面中删除推文</li><li id="95fe" class="mt mu in jx b jy nc kc nd kg ne kk nf ko ng ks my mz na nb bi translated">将推文保存到本地存储</li><li id="e762" class="mt mu in jx b jy nc kc nd kg ne kk nf ko ng ks my mz na nb bi translated">从本地存储中检索推文</li><li id="50dd" class="mt mu in jx b jy nc kc nd kg ne kk nf ko ng ks my mz na nb bi translated">从本地存储中删除推文</li></ul><h1 id="04d1" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">添加推文</h1><figure class="mb mc md me gt jo"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="7e65" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里我们有一个事件监听器，当用户发布tweet时可以监听它。首先，我们将tweet添加到页面上的tweet列表，然后我们将使用本地存储保存数据。</p><p id="bc26" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">add tweet函数从输入字段中获取tweet的文本值。首先，我们创建一个列表项。每个列表项将包含以下内容:</p><ul class=""><li id="7546" class="mt mu in jx b jy jz kc kd kg nj kk nk ko nl ks my mz na nb bi translated">个人资料图像</li><li id="0715" class="mt mu in jx b jy nc kc nd kg ne kk nf ko ng ks my mz na nb bi translated">名称和句柄</li><li id="135e" class="mt mu in jx b jy nc kc nd kg ne kk nf ko ng ks my mz na nb bi translated">发布推文的时间</li><li id="4c62" class="mt mu in jx b jy nc kc nd kg ne kk nf ko ng ks my mz na nb bi translated">推特内容</li><li id="c755" class="mt mu in jx b jy nc kc nd kg ne kk nf ko ng ks my mz na nb bi translated">删除推文的垃圾桶图标</li><li id="3fbb" class="mt mu in jx b jy nc kc nd kg ne kk nf ko ng ks my mz na nb bi translated">其他交互式图标</li></ul><p id="50b5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一旦我们创建了包含上述内容的列表项，我们就会将该列表项添加到tweets列表的顶部。</p><h1 id="9a32" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">删除推文</h1><figure class="mb mc md me gt jo"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="306f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要删除一条推文，用户必须点击垃圾箱图标。单击该图标将触发一个事件监听器来删除该推文。<code class="fe kt ku kv kw b">deleteTweet</code>函数接收相应的列表项，并将其从tweets列表中删除。</p><h1 id="3266" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">局部存储器</h1><p id="eb3a" class="pw-post-body-paragraph jv jw in jx b jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko lz kq kr ks ig bi translated">我创建了一个<code class="fe kt ku kv kw b">Storage</code>类，它将负责从本地存储中添加、检索和删除tweets。</p><figure class="mb mc md me gt jo"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h2 id="415b" class="mh ky in bd kz mi mj dn ld mk ml dp lh kg mm mn ll kk mo mp lp ko mq mr lt ms bi translated">保存到本地存储</h2><p id="6a55" class="pw-post-body-paragraph jv jw in jx b jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko lz kq kr ks ig bi translated">一旦我们将推文添加到列表中，我们会将内容保存到本地存储。为此，我们将检索并保存之前添加到数组中的任何tweet，将新的tweet推入数组，然后用新更新的tweet数组更新我们存储的tweet。</p><p id="df7b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">就像我之前提到的，数据以键-值对的形式存储在本地存储中，值必须是一个字符串。在本例中，我们将tweets数组转换成一个字符串，然后将值更新到存储中。</p><h2 id="26d4" class="mh ky in bd kz mi mj dn ld mk ml dp lh kg mm mn ll kk mo mp lp ko mq mr lt ms bi translated">从本地存储中检索</h2><p id="a68e" class="pw-post-body-paragraph jv jw in jx b jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko lz kq kr ks ig bi translated">为了获取tweets，我们使用键检查本地存储，并解析返回给数组的值。如果该项不存在，那么我们将得到一个空数组。</p><h2 id="2dcc" class="mh ky in bd kz mi mj dn ld mk ml dp lh kg mm mn ll kk mo mp lp ko mq mr lt ms bi translated">从本地存储中移除</h2><p id="3527" class="pw-post-body-paragraph jv jw in jx b jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko lz kq kr ks ig bi translated">要从本地存储中删除该tweet，首先我们从存储中获取所有tweet，遍历tweet数组并删除与tweet值匹配的条目。一旦我们从数组中删除了这个项目，我们就在存储中更新我们的tweets。</p><h1 id="725f" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="f395" class="pw-post-body-paragraph jv jw in jx b jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko lz kq kr ks ig bi translated">如您所见，我们能够在没有任何服务器端代码或不必处理数据库的情况下持久存储数据。最终，对于真实世界的应用程序来说，这是必要的，但是使用本地存储对于那些刚开始使用一些基本前端概念的人来说是有帮助的。</p><p id="ba5c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">完全回购:<a class="ae nm" href="https://github.com/martinacarter1/tweet-local-storage/tree/master" rel="noopener ugc nofollow" target="_blank">本地存储持久化推文</a></p><p id="9ef8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="nn">阅读更多</em> </strong> <a class="ae nm" href="https://plainenglish.io" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="nn">说白了. io </em> </strong> </a></p></div></div>    
</body>
</html>