# å¦‚ä½•ä½¿ç”¨ GitHub æ“ä½œè®¾ç½®é«˜çº§ CI/CD ç®¡é“

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/how-to-setup-advanced-ci-cd-pipeline-with-github-actions-no-travis-circle-ci-29b02b03c501?source=collection_archive---------6----------------------->

![](img/92f7aa9b8884bac8e9527e177bf28a02.png)

> æ‚¨çš„æºä»£ç  repo æ‰˜ç®¡åœ¨ GitHub ä¸Šï¼Œæ‚¨æƒ³çŸ¥é“å¦‚ä½•å®ç° CI/CD ç®¡é“æ¥æµ‹è¯•ã€æ„å»ºå’Œå‘å¸ƒæ‚¨çš„åº”ç”¨ç¨‹åºã€‚å½“ä½ éœ€è¦çš„æ‰€æœ‰ä¸œè¥¿éƒ½å·²ç»è¢«æ”¾è¿› GitHub çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨å¤–éƒ¨å·¥å…·å‘¢ï¼Ÿè¿˜æœ‰ç§°ä¸ºå·¥ä½œæµçš„è‡ªåŠ¨åŒ–è¿‡ç¨‹ï¼Œå¯ä»¥æ‰«ææ‚¨çš„ä»£ç è¿›è¡Œå®‰å…¨æ€§åˆ†æã€‚

é™¤äº†å®‰å…¨åˆ†ææ‰«æï¼ŒGitHub åŠ¨ä½œä¸­çš„å·¥ä½œæµæ˜¯éå¸¸å¼ºå¤§çš„åŠŸèƒ½ã€‚ä»–ä»¬è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬ã€è¿è¡Œæµ‹è¯•ã€å‘ npm å‘å¸ƒåŒ…ä»¥åŠå°†æ„å»ºçš„åŒ…éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ã€‚

![](img/c8026188fc6ffa683f7ef44989b81128.png)

Various virtual environments for running a CI/CD workflow

# ä»€ä¹ˆæ˜¯å·¥ä½œæµï¼Ÿ

åœ¨å±‚çº§çš„é¡¶ç«¯ï¼ŒGitHub Actions æä¾›äº†æ‰€è°“çš„å·¥ä½œæµã€‚å®ƒä»¬æ˜¯ä½¿ç”¨ YAML è¯­æ³•åˆ›å»ºçš„å¯é…ç½®è‡ªåŠ¨åŒ–æµç¨‹ã€‚å¯ä»¥æŠŠå®ƒä»¬æƒ³è±¡æˆå®¹å™¨æˆ–ç¯å¢ƒï¼Œå…¶ä¸­åä¸º`steps`çš„ä»»åŠ¡ä½¿ç”¨`actions`è¿è¡Œå¤šä¸ªä½œä¸šï¼Œä»¥æ»¡è¶³æ‚¨çš„ CI/CD éœ€æ±‚ã€‚å·¥ä½œæµæ–‡ä»¶å¿…é¡»æ”¾åœ¨ä»£ç åº“çš„`.github/workflows`ç›®å½•ä¸­ã€‚

![](img/0b4fd1a9df0ff23a2329a98ecd4bf7b4.png)

Actions from the GitHub Marketplace [https://github.com/marketplace](https://github.com/marketplace)

# âš™ï¸æµ‹è¯•ã€æ„å»ºå’Œéƒ¨ç½²å·¥ä½œæµ

æ­£å¦‚æœ¬å·¥ä½œæµç¨‹çš„`name`æ‰€ç¤ºï¼Œå…¶ç›®çš„æ˜¯**æµ‹è¯•**ï¼Œ**æ„å»º**ï¼Œ**å°†**åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ã€‚è§¦å‘å·¥ä½œæµçš„äº‹ä»¶åœ¨`on`ä¸‹é…ç½®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯å›è´­æ¨å¼å’Œæ‹‰å¼è¯·æ±‚ã€‚å·¥ä½œæµä»»åŠ¡åœ¨`jobs`ä¸‹å®šä¹‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»»åŠ¡ id ä¸º`test_build_deploy`ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä½œä¸šå¹¶è¡Œè¿è¡Œã€‚è¦æŒ‰é¡ºåºè¿è¡Œä½œä¸šï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`jobs.job_id.needs`å…³é”®å­—å®šä¹‰å¯¹å…¶ä»–ä½œä¸šçš„ä¾èµ–æ€§ã€‚åˆ†é…ç»™`env`çš„ç¯å¢ƒå˜é‡å°†å¯ç”¨äºå·¥ä½œæµç¨‹ä¸­æ‰€æœ‰ä½œä¸šçš„æ­¥éª¤ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`CI`è¢«è®¾ç½®ä¸º`true`å°†å¼ºåˆ¶ Jest åœ¨ CI æ¨¡å¼ä¸‹è¿è¡Œï¼Œæµ‹è¯•å°†åªè¿è¡Œä¸€æ¬¡ï¼Œè€Œä¸æ˜¯å¯åŠ¨è§‚å¯Ÿå™¨ã€‚æºæ˜ å°„ç”Ÿæˆä¹Ÿè¢«è®¾ç½®ä¸º`false`ä»¥å‡å°åŒ…çš„å¤§å°ã€‚è¿è¡Œå·¥ä½œæµæ„å»ºçš„è™šæ‹Ÿç¯å¢ƒç±»å‹åœ¨`runs-on`ä¸­å®šä¹‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒè¿è¡Œåœ¨æœ€æ–°çš„ LTS Ubuntu ä¸Šã€‚Node.js ç‰ˆæœ¬åœ¨`node_version`æ•°ç»„ä¸­æŒ‡å®šã€‚

## è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹å‚æ•°

*   `**name**` å·¥ä½œæµçš„åç§°
*   `**on**` è§¦å‘å·¥ä½œæµçš„äº‹ä»¶
*   `**jobs**` æŒ‰æ­¥éª¤è¿è¡Œä»»åŠ¡çš„å®¹å™¨
*   `**env**` è®¾ç½®ç¯å¢ƒå˜é‡
*   `**steps**` å°†åœ¨ä¸‹ä¸€èŠ‚ä»‹ç»ğŸ‘‰

Main workflow configuration file

# ä½œä¸šæ­¥éª¤

åœ¨è®¾ç½®äº†ç¯å¢ƒæ“ä½œç³»ç»Ÿå’Œä¸€äº›ç¯å¢ƒå˜é‡ä¹‹åï¼Œæˆ‘ä»¬æƒ³è¦æµ‹è¯•ã€æ„å»ºã€éƒ¨ç½²å’Œå‘å¸ƒæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬åœ¨ä½œä¸šä¸­æŒ‰é¡ºåºè¿è¡Œçš„æ­¥éª¤æ¥å®Œæˆè¿™ä¸€ä»»åŠ¡ã€‚

## ğŸ”§ 1.è®¾ç½® Node.js

è¯¥æ­¥éª¤ä½¿ç”¨( [actions/setup-node@v2](https://github.com/marketplace/actions/setup-node-js-environment) )æ“ä½œè®¾ç½® Node.jsã€‚ç‰ˆæœ¬åœ¨`node-version`ä¸‹çš„çŸ©é˜µä¸­æŒ‡å®šã€‚

## ğŸ“¥ 2.**è·å–æœ€æ–°æºä»£ç **

è¿™ä¸ªæ­¥éª¤ä½¿ç”¨( [actions/checkout@v2](https://github.com/marketplace/actions/checkout) )åŠ¨ä½œæ¥ç­¾å‡ºä»£ç ã€‚éœ€è¦ä»æ‚¨çš„ GitHub å¸æˆ·æä¾›ä¸ªäººè®¿é—®æƒé™`token`ã€‚

## ğŸ—‘ï¸ 3.**è·å–çº±çº¿ç¼“å­˜ç›®å½•è·¯å¾„**

è¿™ä¸€æ­¥è¿è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œè¿”å›çº±çº¿ç¼“å­˜ç›®å½•çš„è·¯å¾„ã€‚ç¼“å­˜ä¾èµ–å…³ç³»å¤§å¤§åŠ å¿«äº†å·¥ä½œæµç¨‹ã€‚

## ğŸ”„ 4.**æ¢å¤çº±çº¿ç¼“å­˜**

è¯¥æ­¥éª¤é€šè¿‡ä½¿ç”¨( [actions/cache@v2](https://github.com/marketplace/actions/cache) )æ“ä½œæ¥æ¢å¤ä¾èµ–é¡¹å®‰è£…ç¼“å­˜ï¼Œä»è€Œç¼©çŸ­äº†å·¥ä½œæµæ‰§è¡Œæ—¶é—´ã€‚

## ğŸ“¦ 5.å®‰è£…ä¾èµ–é¡¹

è¿™ä¸€æ­¥è¿è¡Œ`yarn install`æ¥å®‰è£…æ‰€æœ‰çš„ä¾èµ–é¡¹ã€‚

## ğŸ§ª 6.è¿è¡Œæµ‹è¯•å¥—ä»¶

è¿™ä¸€æ­¥è¿è¡Œ`yarn run test`æ¥è¿è¡Œä»£ç æµ‹è¯•å¥—ä»¶ã€‚

## ğŸ—ï¸ 7.**æ„å»ºä¸»åŒ…**

è¿™ä¸€æ­¥è¿è¡Œ`yarn run build`æ¥æ„å»ºä¸»åŒ…æ¨¡å—ã€‚

## ğŸšš 8.**å‘å¸ƒåˆ° NPM**

è¿™ä¸ªæ­¥éª¤ä½¿ç”¨([JS-dev tools/NPM-publish @ v1](https://github.com/marketplace/actions/npm-publish))åŠ¨ä½œå°†ä¸»æ¨¡å—åŒ…æ‰“åŒ…å¹¶å‘å¸ƒåˆ° npm.comã€‚è¿˜éœ€è¦ä»æ‚¨çš„ npm å¸æˆ·æä¾›ä¸€ä¸ª`token`ã€‚è¿™ä¸ªé‡è¦çš„ä»¤ç‰Œå˜é‡å¯ä»¥åœ¨ repo çš„ secrets ä¸‹çš„ settings éƒ¨åˆ†ä¿å­˜å’Œè®¿é—®ã€‚åœ¨`package`ä¸‹è®¾ç½®æŒ‡å®šåŒ…çš„è·¯å¾„ã€‚

## ğŸ—ï¸ 9.**æ„å»ºç¤ºä¾‹åº”ç”¨**

è¿™ä¸€æ­¥è¿è¡Œ`yarn run build:example`æ¥æ„å»ºç¤ºä¾‹åº”ç”¨ç¨‹åºã€‚

## ğŸš€ 10.**éƒ¨ç½²åˆ° GitHub é¡µé¢**

è¿™ä¸€æ­¥ä½¿ç”¨([JamesIves/GitHub-Pages-deploy-action @ 4 . 1 . 4](https://github.com/marketplace/actions/deploy-to-github-pages))åŠ¨ä½œå°†ç¤ºä¾‹åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ° GitHub é¡µé¢ã€‚åˆ†æ”¯è®¾ç½®åœ¨`branch`ä¸‹ï¼Œæ„å»ºç›®å½•åœ¨`folder`ä¸‹ã€‚

ä½¿ç”¨å‰é¢çš„é…ç½®ï¼Œä»»ä½•å¯¹`main`åˆ†æ”¯çš„æ‹‰è¯·æ±‚æˆ–æ¨è¯·æ±‚éƒ½å°†è§¦å‘è¿è¡Œæ‰€æä¾›çš„å·¥ä½œæµã€‚

![](img/15fadfa2b3705d89d76659b0d868ae51.png)

An overview of the previous workflow in the Actions section in the repo

![](img/8e8fb020429cc1e4f486afe072ddd9ab.png)![](img/acbd192323d34f30753f5ec4d61ba43c.png)

Job steps for testing and app build as shown in the Actions section in the repo

# ğŸ›¡ï¸ä»£ç æ‰«æå·¥ä½œæµç¨‹

å¦‚å‰æ‰€è¿°ï¼Œå®‰å…¨åˆ†æå·¥ä½œæµæ˜¯ GitHub æ“ä½œçš„ä¸€éƒ¨åˆ†ã€‚åœ¨æˆ‘çš„ç”¨ä¾‹ä¸­ï¼Œæˆ‘é€‰æ‹©äº† GitHub çš„ **CodeQL åˆ†æ**ã€‚è¯¥å·¥ä½œæµè‡ªåŠ¨æ£€æµ‹å¸¸è§çš„æ¼æ´å’Œç¼–ç é”™è¯¯ã€‚

![](img/6b400af965191cec97a581be28e0a976.png)

Security workflows can be found in Code scanning alerts under Security

è¿™ä¸ªå·¥ä½œæµé…ç½®æ–‡ä»¶å¯ä»¥ä» GitHub è·å¾—ã€‚è¯­è¨€è‡ªåŠ¨è®¾ç½®åœ¨`line 35`ä¸Šï¼Œå¦åˆ™å¿…é¡»æ‰‹åŠ¨æ£€æŸ¥ã€‚

Code scanning workflow file

ğŸ“„**æ”¹å˜è¢«åˆ†æçš„è¯­è¨€:** [é“¾æ¥](https://docs.github.com/en/free-pro-team@latest/github/finding-security-vulnerabilities-and-errors-in-your-code/configuring-code-scanning#changing-the-languages-that-are-analyzed)

![](img/49591562cd1208427027ba8c0156301c.png)

*Thereâ€™s a variety of code scanning workflows to choose from*

# ğŸ“šç›¸å…³æ€§æ›´æ–°å·¥ä½œæµ

æ­¤å·¥ä½œæµä½¿æ‚¨çš„ä¾èµ–å…³ç³»ä¿æŒæœ€æ–°ã€‚Dependabot å¯ä»¥é…ç½®ä¸ºé€šè¿‡åç§°æˆ–ç‰ˆæœ¬å·å¿½ç•¥æˆ–å®šä½æŸäº›åŒ…ã€‚

![](img/f6293f1de2bb34fb75a2ed30552f750e.png)

Dependabot workflow can be found in Dependency graph under Insights

å·¥ä½œæµé…ç½®æ–‡ä»¶éå¸¸åŸºæœ¬ã€‚åœ¨`line 11`ä¸Šè®¾ç½®ç›¸å…³æ€§æ›´æ–°æ£€æŸ¥é¢‘ç‡ã€‚åŒ…ç®¡ç†å™¨è®¾ç½®åœ¨`line 3`ä¸Šã€‚

Dependency update check workflow file

ğŸ“„**ä¾èµ–å…³ç³»æ›´æ–°çš„é…ç½®é€‰é¡¹:** [é“¾æ¥](https://help.github.com/github/administering-a-repository/configuration-options-for-dependency-updates)

![](img/67a1f17ae28b5950ead95fdf6e27e3d3.png)

Dependabot creates pull requests for package updates while also running workflows

# æ‘˜è¦

å¦‚æ‚¨æ‰€çŸ¥ï¼Œå·¥ä½œæµæ˜¯è¿è¡Œä½œä¸šçš„å¯é…ç½® YAML æ–‡ä»¶ã€‚æ¯é¡¹å·¥ä½œéƒ½ç”±æ‚¨ç¼–å†™çš„è„šæœ¬å®šä¹‰çš„ä»»åŠ¡æˆ– GitHub Marketplace çš„æ“ä½œæä¾›çš„ç‰¹å®šä»»åŠ¡ç»„æˆã€‚æ›´å¤šå…³äº GitHub åŠ¨ä½œçš„ä¿¡æ¯è¯·ç‚¹å‡»ã€‚

ğŸ“„**æºä»£ç :ã€https://github.com/amir0ff157/reactjs-use-form/actionsã€‘T22**

# ç»“è®º

æˆ‘ä»¬æµè§ˆäº†ç”±âœ”ï¸testingã€âœ”ï¸scanningã€âœ”ï¸building å’Œâœ”ï¸publishing ç»„æˆçš„æ•´ä¸ª CI/CD ç®¡é“çš„é…ç½®ï¼Œè¿™æ˜¯ä¸€ä¸ªæºä»£ç æ‰˜ç®¡åœ¨ GitHub ä¸Šçš„åº”ç”¨ç¨‹åºã€‚åœ¨ä¸Šä¸€ä¸ªæ•…äº‹ä¸­ [**å¦‚ä½•è®¾ç½®é«˜çº§è‡ªåŠ¨éƒ¨ç½²ç”¨ Travis CI**](https://medium.com/free-code-camp/advanced-automatic-deployment-with-travis-ci-1da32f7930ce) **ã€‚**æˆ‘æ¼”ç¤ºäº†å¦‚ä½•é…ç½®ç±»ä¼¼çš„ CI/CD ç®¡é“ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ æ³¨æ„åˆ°æˆ‘çš„æ•™ç¨‹æœ€è¿‘çš„é£æ ¼å’Œç›®çš„çš„è½¬å˜ï¼Œä½ ä¼šæ³¨æ„åˆ°æˆ‘å¤šä¹ˆå¸Œæœ›äº‹æƒ…å˜å¾—ç®€å•ã€‚ç”¨å°½å¯èƒ½å°‘çš„å¼€é”€ç¼–å†™æ›´å°‘çš„ä»£ç ï¼Œå¹¶è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼Œå¦‚æœä¸æ˜¯æ›´å¤šçš„è¯ã€‚Travis CI å’Œ Circle CI ä»ç„¶æ˜¯å¾ˆå¥½çš„å·¥å…·ã€‚ä½†æ˜¯è¿™ä¸€æ¬¡æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨å¤–éƒ¨å·¥å…·ï¼Œä»…ä»…ä½¿ç”¨ GitHub å°±å–å¾—äº†æ›´å¤šçš„æˆæœã€‚

æˆ‘å¸Œæœ›ä½ å–œæ¬¢é˜…è¯»ï¼Œ
è¯·[**å…³æ³¨**](https://medium.com/@amir0ff) å’Œ**åˆ†äº«**æ›´å¤šç§‘æŠ€å†…å®¹ğŸ¤–ğŸ’–

![](img/f941f057d77c2960c0b4a1d2d673d2b9.png)

*æ›´å¤šå†…å®¹çœ‹* [***è¯´ç™½äº†å°±æ˜¯***](http://plainenglish.io/) ***ã€‚*** *æŠ¥åå‚åŠ æˆ‘ä»¬çš„* [***å…è´¹æ¯å‘¨ç®€è®¯è¿™é‡Œ***](http://newsletter.plainenglish.io/) ***ã€‚***