<html>
<head>
<title>Create Reddit Posts with Node.js and TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Node.js和TypeScript创建Reddit帖子</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/post-to-reddit-using-its-api-32b7baf708b2?source=collection_archive---------17-----------------------#2021-07-19">https://javascript.plainenglish.io/post-to-reddit-using-its-api-32b7baf708b2?source=collection_archive---------17-----------------------#2021-07-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/51eaf976701930ca39af2a03800452f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cnU2Pp7t-oV1fbI0.png"/></div></div></figure><div class=""/><blockquote class="jv jw jx"><p id="5c81" class="jy jz ka kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这篇文章是写给我的<a class="ae kx" href="https://twitter.com/hashtag/100DaysOfCode?src=hashtag_click" rel="noopener ugc nofollow" target="_blank"> #100DaysOfCode </a>的<strong class="kb iz">第二天</strong>的。在这篇文章中，我将讨论如何使用Node.js和TypeScript以编程方式向Reddit发布内容。</p></blockquote><h2 id="7d9e" class="ky kz iy bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">获得认证</h2><p id="0998" class="pw-post-body-paragraph jy jz iy kb b kc lu ke kf kg lv ki kj lh lw km kn ll lx kq kr lp ly ku kv kw ig bi translated">获取Reddit的身份验证令牌很复杂。</p><p id="25ce" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">如果你有一个<strong class="kb iz">业务</strong>并计划用这个代币创收，请遵循<a class="ae kx" href="https://docs.google.com/forms/d/e/1FAIpQLSezNdDNK1-P8mspSbmtC2r86Ee9ZRbC66u929cG2GX0T9UMyw/viewform" rel="noopener ugc nofollow" target="_blank">这个表格</a>。</p><p id="5990" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">对于<strong class="kb iz">个人</strong>使用，导航至您的Reddit <a class="ae kx" href="https://www.reddit.com/prefs/apps" rel="noopener ugc nofollow" target="_blank">应用</a>并滚动至页面底部。您应该会看到一个灰色按钮，上面写着“创建另一个应用程序…”。点击按钮并填写表格。成功提交此表单应该会生成</p><figure class="ma mb mc md gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi lz"><img src="../Images/75ea0f73310c5ce9f2c8149ccc0ff8b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WOfaY0Tigu_NtI8c.png"/></div></div></figure><h2 id="25d6" class="ky kz iy bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">为您的应用奠定基础</h2><p id="6cfc" class="pw-post-body-paragraph jy jz iy kb b kc lu ke kf kg lv ki kj lh lw km kn ll lx kq kr lp ly ku kv kw ig bi translated">Github Repo 跟进</p><p id="b061" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated"><em class="ka">确保你已经安装了</em><a class="ae kx" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"><em class="ka">node . js</em></a><em class="ka"/></p><p id="97ab" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated"><em class="ka">我更喜欢</em> <a class="ae kx" href="https://yarnpkg.com/" rel="noopener ugc nofollow" target="_blank"> <em class="ka">纱</em> </a> <em class="ka">，但是如果你更喜欢</em>也可以用npm代替</p><p id="06c8" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">复制这个<code class="fe me mf mg mh b">package.json</code>文件并运行<code class="fe me mf mg mh b">yarn install</code>来安装依赖项。</p><pre class="ma mb mc md gt mi mh mj mk aw ml bi"><span id="5664" class="ky kz iy mh b gy mm mn l mo mp">{<br/>  "name": "reddit-post",<br/>  "version": "1.0.0",<br/>  "main": "index.js",<br/>  "license": "MIT",<br/>  "scripts": {<br/>    "dev": "ts-node index.ts"<br/>  },<br/>  "devDependencies": {<br/>    "ts-node": "^10.1.0",<br/>    "typescript": "^4.3.5"<br/>  },<br/>  "dependencies": {<br/>    "dotenv": "^10.0.0",<br/>    "snoowrap": "^1.23.0"<br/>  }<br/>}</span></pre><h2 id="82a3" class="ky kz iy bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">包装说明:</h2><ul class=""><li id="7446" class="mq mr iy kb b kc lu kg lv lh ms ll mt lp mu kw mv mw mx my bi translated">ts-node 是一个方便的工具，用于执行类型脚本文件，而不必先编译成Javascript。</li><li id="ef4e" class="mq mr iy kb b kc mz kg na lh nb ll nc lp nd kw mv mw mx my bi translated">Javascript的类型脚本超集。我只是用它来试着在日常项目中变得更舒服。</li><li id="4aa4" class="mq mr iy kb b kc mz kg na lh nb ll nc lp nd kw mv mw mx my bi translated">安全地管理。env变量和您的auth令牌。</li><li id="2634" class="mq mr iy kb b kc mz kg na lh nb ll nc lp nd kw mv mw mx my bi translated"><a class="ae kx" href="https://github.com/not-an-aardvark/snoowrap" rel="noopener ugc nofollow" target="_blank"> snoowrap </a>提供了一个简单的接口来访问每个reddit API端点。</li></ul><h2 id="281a" class="ky kz iy bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">创建一个. env文件</h2><p id="5a66" class="pw-post-body-paragraph jy jz iy kb b kc lu ke kf kg lv ki kj lh lw km kn ll lx kq kr lp ly ku kv kw ig bi translated">。env文件被用作远离GitHub的秘密密钥(比如我们的认证令牌)的最佳实践。确保有一个<code class="fe me mf mg mh b">.gitignore</code>文件，并在其中添加<code class="fe me mf mg mh b">.env</code>。</p><p id="9e37" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated"><code class="fe me mf mg mh b">.env</code>文件应该是这样的:</p><pre class="ma mb mc md gt mi mh mj mk aw ml bi"><span id="092a" class="ky kz iy mh b gy mm mn l mo mp">username = '&lt;REDDIT USERNAME&gt;'<br/>password = '&lt;REDDIT PASSWORD&gt;'<br/>clientId = 'CLIENT_ID'<br/>clientSecret = 'CLIENT SECRET'</span></pre><p id="9456" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">只要确保用Twitter提供的令牌替换掉<code class="fe me mf mg mh b">&lt;&gt;</code>文本。</p><p id="2c2f" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">确保你没有犯错误。env文件到Github或任何其他版本控制系统。这些令牌非常重要，不应与任何人共享！</p><h2 id="608b" class="ky kz iy bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">执行POST请求</h2><ol class=""><li id="d6db" class="mq mr iy kb b kc lu kg lv lh ms ll mt lp mu kw ne mw mx my bi translated">在项目根目录下创建一个index.ts文件</li><li id="08be" class="mq mr iy kb b kc mz kg na lh nb ll nc lp nd kw ne mw mx my bi translated">导入您之前安装的软件包</li></ol><pre class="ma mb mc md gt mi mh mj mk aw ml bi"><span id="d7fe" class="ky kz iy mh b gy mm mn l mo mp">const snoowrap = require('snoowrap')<br/>require('dotenv').config()</span></pre><ol class=""><li id="e42d" class="mq mr iy kb b kc kd kg kh lh nf ll ng lp nh kw ne mw mx my bi translated">创建配置对象来组织Reddit配置变量</li></ol><pre class="ma mb mc md gt mi mh mj mk aw ml bi"><span id="d464" class="ky kz iy mh b gy mm mn l mo mp">const config = {<br/>  username: process.env.username,<br/>  password: process.env.password,<br/>  clientId: process.env.clientId,<br/>  clientSecret: process.env.clientSecret,<br/>}</span></pre><ol class=""><li id="42f5" class="mq mr iy kb b kc kd kg kh lh nf ll ng lp nh kw ne mw mx my bi translated">创建一个向<a class="ae kx" href="https://www.reddit.com/dev/api#POST_api_submit" rel="noopener ugc nofollow" target="_blank"> Reddit的端点</a> <code class="fe me mf mg mh b">/api/submit</code>发送POST请求的函数，该函数带有title、link和subreddit参数。</li></ol><pre class="ma mb mc md gt mi mh mj mk aw ml bi"><span id="adfc" class="ky kz iy mh b gy mm mn l mo mp">function postLink(title: string, link: string, subreddit: string) {<br/>  const r = new snoowrap({<br/>    userAgent: 'Whatever',<br/>    clientId: config.clientId,<br/>    clientSecret: config.clientSecret,<br/>    username: config.username,<br/>    password: config.password,<br/>  })<br/>  r.getSubreddit(subreddit).submitLink({<br/>    title: title,<br/>    url: link,<br/>    sendReplies: true,<br/>  })<br/>}</span></pre><h2 id="226e" class="ky kz iy bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">解释道:</h2><pre class="ma mb mc md gt mi mh mj mk aw ml bi"><span id="2a18" class="ky kz iy mh b gy mm mn l mo mp">const r = new snoowrap({<br/>  userAgent: 'Whatever',<br/>  clientId: config.clientId,<br/>  clientSecret: config.clientSecret,<br/>  username: config.username,<br/>  password: config.password,<br/>})</span></pre><p id="cab8" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">这段代码创建了一个新的连接到Reddit服务的<code class="fe me mf mg mh b">snoowrap</code>实例。</p><pre class="ma mb mc md gt mi mh mj mk aw ml bi"><span id="3cc8" class="ky kz iy mh b gy mm mn l mo mp">r.getSubreddit(subreddit).submitLink({<br/>  title: title,<br/>  url: link,<br/>  sendReplies: true,<br/>})</span></pre><p id="cb96" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated"><code class="fe me mf mg mh b">getSubreddit</code>:生成一个<code class="fe me mf mg mh b">Subreddit</code>对象。你可以在这里阅读关于这个物体<a class="ae kx" href="https://not-an-aardvark.github.io/snoowrap/Subreddit.html" rel="noopener ugc nofollow" target="_blank">的更多信息。</a></p><p id="db23" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated"><code class="fe me mf mg mh b">submitLink</code>:在这个subreddit上创建一个新的链接提交，带有提供的标题、链接的URL和snoowrap API允许的任何其他选项，比如<code class="fe me mf mg mh b">sendReplies</code>选项，允许对帖子的回复将回复发送到认证用户的收件箱。</p><ol class=""><li id="99a9" class="mq mr iy kb b kc kd kg kh lh nf ll ng lp nh kw ne mw mx my bi translated">提出请求</li></ol><p id="4dd9" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">现在添加</p><pre class="ma mb mc md gt mi mh mj mk aw ml bi"><span id="0e50" class="ky kz iy mh b gy mm mn l mo mp">postLink(<br/>  'Post to Reddit with NodeJS and Typescript',<br/>  'https://codybontecou.com/post-to-reddit-with-nodejs-and-typescript.html',<br/>  'webdev'<br/>)</span></pre><p id="dddf" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">在<code class="fe me mf mg mh b">index.ts</code>底部有你要用的参数。</p><p id="375b" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">一旦你准备好了，输入<code class="fe me mf mg mh b">yarn dev</code>到你的项目终端。如果一切顺利，你应该可以看到你的帖子现在在Reddit上了！</p><h2 id="c1c0" class="ky kz iy bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">奖金</h2><p id="323f" class="pw-post-body-paragraph jy jz iy kb b kc lu ke kf kg lv ki kj lh lw km kn ll lx kq kr lp ly ku kv kw ig bi translated">通过在一个数组中迭代多个子元素，使其更加动态:</p><pre class="ma mb mc md gt mi mh mj mk aw ml bi"><span id="211e" class="ky kz iy mh b gy mm mn l mo mp">const url =<br/>  'https://codybontecou.com/post-to-reddit-with-nodejs-and-typescript.html'<br/>const title = 'Post to Reddit using its API'<br/>const subreddits = ['webdev', 'learnjavascript', 'typescript', 'programming']<br/><br/>subreddits.forEach(subreddit =&gt; postLink(title, url, subreddit))</span></pre></div><div class="ab cl ni nj hr nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ig ih ii ij ik"><p id="2851" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">我希望这篇文章对你有帮助，如果你有任何问题、评论或建议，请告诉我</p><p id="1541" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated"><em class="ka">更多内容看</em> <a class="ae kx" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb iz"> <em class="ka">说白了就是</em> </strong> </a> <strong class="kb iz"> <em class="ka">。</em> </strong> <em class="ka">报名参加我们的</em> <a class="ae kx" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb iz"> <em class="ka">免费每周简讯这里</em> </strong> </a> <strong class="kb iz"> <em class="ka">。</em> </strong></p></div></div>    
</body>
</html>