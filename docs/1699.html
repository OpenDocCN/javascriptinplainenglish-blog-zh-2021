<html>
<head>
<title>Simple Smoothing for PoseNet Keypoints</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PoseNet关键点的简单平滑</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/simple-smoothing-for-posenet-keypoints-cd1bc57f5872?source=collection_archive---------7-----------------------#2021-04-11">https://javascript.plainenglish.io/simple-smoothing-for-posenet-keypoints-cd1bc57f5872?source=collection_archive---------7-----------------------#2021-04-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="2990" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated"><em class="kc">如何使用帧平均作为一种简单的方法来平滑来自</em> <a class="ae kd" href="https://p5js.org/" rel="noopener ugc nofollow" target="_blank"> <em class="kc"> p5.js </em> </a> <em class="kc">中PoseNet的关键点数据。</em></h2></div><figure class="kf kg kh ki gt kj gh gi paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="gh gi ke"><img src="../Images/4c15868eb395c585e93a8accb96d074a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bijb_T9x1ddW-QnwxosV3w.png"/></div></div></figure><p id="54eb" class="pw-post-body-paragraph kq kr in ks b kt ku jo kv kw kx jr ky kz la lb lc ld le lf lg lh li lj lk ll ig bi translated">谷歌的Tensorflow.js <a class="ae kd" href="https://github.com/tensorflow/tfjs-models/tree/master/posenet" rel="noopener ugc nofollow" target="_blank"> PoseNet </a>模型极其有用。它从一个网络摄像头返回浏览器中的实时姿势估计数据，这允许在浏览器中进行各种可访问的具体化交互(如<a class="ae kd" href="https://experiments.withgoogle.com/move-mirror" rel="noopener ugc nofollow" target="_blank">新颖的导航模式</a>和<a class="ae kd" href="https://danielkorssen.com/project/digital-dance-party" rel="noopener ugc nofollow" target="_blank">在线舞会</a>)。使用<a class="ae kd" href="https://learn.ml5js.org/#/reference/posenet" rel="noopener ugc nofollow" target="_blank"> ml5.js库</a>，也很容易<a class="ae kd" href="https://www.youtube.com/watch?v=OIo-DIOkNVg" rel="noopener ugc nofollow" target="_blank">启动并运行</a>。</p><p id="857f" class="pw-post-body-paragraph kq kr in ks b kt ku jo kv kw kx jr ky kz la lb lc ld le lf lg lh li lj lk ll ig bi translated">从PoseNet返回的关键点数据非常嘈杂，因此为这些点添加一些平滑处理会有助于获得更好的用户体验。有许多类型的<a class="ae kd" href="https://en.wikipedia.org/wiki/Smoothing" rel="noopener ugc nofollow" target="_blank">平滑</a>算法，它们可能<em class="lm">非常</em>奇特，<em class="lm"> </em>但是我将把重点放在一个简单的方法上，这个方法做得相当好并且容易实现:帧平均。</p><p id="b94b" class="pw-post-body-paragraph kq kr in ks b kt ku jo kv kw kx jr ky kz la lb lc ld le lf lg lh li lj lk ll ig bi translated">这个概念很简单:不是为每一帧显示新的输入关键点值，而是取最近几帧的平均值来帮助减少数据中的噪声。</p><p id="649e" class="pw-post-body-paragraph kq kr in ks b kt ku jo kv kw kx jr ky kz la lb lc ld le lf lg lh li lj lk ll ig bi translated">下面的视频显示了仅在右手腕关键点上平均多个帧的效果。视频从无平滑开始，经过100个平均帧进行平滑。</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="ln lo l"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">The effect of averaging keypoint values for the right hand over multiple frames.</figcaption></figure><p id="eefc" class="pw-post-body-paragraph kq kr in ks b kt ku jo kv kw kx jr ky kz la lb lc ld le lf lg lh li lj lk ll ig bi translated">在第五帧和第十帧时，关键点非常平滑，几乎没有明显的滞后。随着平均帧数的增加，运动变得更加平滑，滞后增加。到50帧时，滞后非常明显。根据你所建立的互动类型，这种滞后可能是破坏性的，但也可能是有用的。(滞后通常会鼓励人们缓慢而谨慎地行动。)</p><p id="4471" class="pw-post-body-paragraph kq kr in ks b kt ku jo kv kw kx jr ky kz la lb lc ld le lf lg lh li lj lk ll ig bi translated">它是这样工作的。</p><p id="06d9" class="pw-post-body-paragraph kq kr in ks b kt ku jo kv kw kx jr ky kz la lb lc ld le lf lg lh li lj lk ll ig bi translated">首先为过去的右手腕位置创建一个全局数组。在我们的例子中，我们将只是平均X坐标，所以我们称它为<em class="lm"> recentXs </em>。</p><pre class="kf kg kh ki gt lt lu lv lw aw lx bi"><span id="6b73" class="ly lz in lu b gy ma mb l mc md">// an array for past x positions positions<br/>let recentXs = [];</span></pre><p id="eff4" class="pw-post-body-paragraph kq kr in ks b kt ku jo kv kw kx jr ky kz la lb lc ld le lf lg lh li lj lk ll ig bi translated">当您从PoseNet收到第一个姿势估计时，获取单个关键点数据，然后使用如下函数对其进行平均:</p><pre class="kf kg kh ki gt lt lu lv lw aw lx bi"><span id="6c19" class="ly lz in lu b gy ma mb l mc md">// get the keypoint data from posenet results<br/>const myRightWrist = poses[0].pose.rightWrist;<br/>const myAveragedRightXPos = averageXPos(myRightWrist.x);</span><span id="c04d" class="ly lz in lu b gy me mb l mc md">// set the number of frames to average<br/>const numXs = 5; </span><span id="486d" class="ly lz in lu b gy me mb l mc md">function averageXPos(x) {</span><span id="2181" class="ly lz in lu b gy me mb l mc md">// the first time this runs add the current x to the array n    number of times. this only runs once<br/>   if (recentXs.length &lt; 1) {<br/>     for (let i = 0; i &lt; numXs; i++) {<br/>       recentXs.push(x);<br/>    }</span><span id="6c53" class="ly lz in lu b gy me mb l mc md">// otherwise update only the most recent number<br/>} else {<br/>  recentXs.shift(); // removes first item from array<br/>  recentXs.push(x); // adds new x to end of array<br/>}</span><span id="827d" class="ly lz in lu b gy me mb l mc md">// add up all the values in the array<br/>let sum = 0;<br/>for (let i = 0; i &lt; recentXs.length; i++) {<br/>  sum += recentXs[i];<br/>}</span><span id="11d0" class="ly lz in lu b gy me mb l mc md">// return the average x value<br/>return sum / recentXs.length;<br/>}</span></pre><p id="e685" class="pw-post-body-paragraph kq kr in ks b kt ku jo kv kw kx jr ky kz la lb lc ld le lf lg lh li lj lk ll ig bi translated">该函数第一次运行时，我们将当前的X值添加到数组中的每个位置。然后，当我们接收到一个新值时，我们将它添加到数组的末尾，并删除第一项。在所有情况下，我们将数组中的所有值相加，并返回这些值的平均值。</p><p id="15e6" class="pw-post-body-paragraph kq kr in ks b kt ku jo kv kw kx jr ky kz la lb lc ld le lf lg lh li lj lk ll ig bi translated">这里是完整的p5草图,这样你就可以在上下文中看到它，并自己尝试一下！这里是<a class="ae kd" href="https://editor.p5js.org/lisajamhoury/sketches/zbsptgaQw" rel="noopener ugc nofollow" target="_blank">一张p5草图，所有17个关节都进行了平滑处理</a>。代码也在<a class="ae kd" href="https://github.com/lisajamhoury/PoseNet-Smoothing" rel="noopener ugc nofollow" target="_blank"> github </a>上。</p><p id="bb08" class="pw-post-body-paragraph kq kr in ks b kt ku jo kv kw kx jr ky kz la lb lc ld le lf lg lh li lj lk ll ig bi translated">感谢<a class="mf mg ep" href="https://medium.com/u/f8b5df9b82a0?source=post_page-----cd1bc57f5872--------------------------------" rel="noopener" target="_blank">扎克·利伯曼</a>在他的<a class="ae kd" href="https://medium.com/@lisajamhoury/debrief-recreating-the-past-8ed91eabeab" rel="noopener">重现过去的</a>课程中向我介绍了<a class="ae kd" href="https://openframeworks.cc/" rel="noopener ugc nofollow" target="_blank"> openFrameworks </a>中姿势数据的帧平均。</p><p id="407f" class="pw-post-body-paragraph kq kr in ks b kt ku jo kv kw kx jr ky kz la lb lc ld le lf lg lh li lj lk ll ig bi translated"><em class="lm">更多内容请看</em><a class="ae kd" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ks io"><em class="lm">plain English . io</em></strong></a></p></div></div>    
</body>
</html>