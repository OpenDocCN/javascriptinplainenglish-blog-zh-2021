<html>
<head>
<title>Three.js with React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有React挂钩的Three.js</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/three-js-with-react-functional-component-9e66e08dbeac?source=collection_archive---------1-----------------------#2021-04-09">https://javascript.plainenglish.io/three-js-with-react-functional-component-9e66e08dbeac?source=collection_archive---------1-----------------------#2021-04-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="5a08" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">通过7个简单的步骤，将一个Three.js场景添加到React应用程序中，并观看3D奇迹的发生！</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/ad5eae83dc0e350f73e123964a7e5156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UuAvt-1sPA8V2kYruryokQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Get a React app up and running with Three.js in 7 easy steps!</figcaption></figure><h1 id="7a46" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">1.创建您的项目</h1><p id="e0c5" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">假设您还没有启动并运行React项目，启动新项目的最简单方法是在命令行中运行<code class="fe mg mh mi mj b">npx create-react-app my-app</code>，等待初始化完成，然后通过运行<code class="fe mg mh mi mj b">cd my-app</code>导航到React应用程序的新文件夹。</p></div><div class="ab cl mk ml hr mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ig ih ii ij ik"><h1 id="ee79" class="ks kt in bd ku kv mr kx ky kz ms lb lc jt mt ju le jw mu jx lg jz mv ka li lj bi translated">2.安装并导入Three.js</h1><p id="839b" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">在命令行中，让我们安装Three.js。运行<code class="fe mg mh mi mj b">npm install three</code>来安装Three.js作为项目的依赖项。在进入我们的代码之前，让我们通过运行<code class="fe mg mh mi mj b">npm start</code>来启动我们的应用程序。导航到<code class="fe mg mh mi mj b">localhost:3000</code>。如果一切顺利，我们现在应该看到默认的起始页，它鼓励我们“编辑src/App.js并保存以重新加载”。让我们去做吧！</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mw"><img src="../Images/e13aae9b96281b5bbd04e00f488c9c37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e-6ReVjcmk4SDAck_VBxOw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">If everything’s gone right, this is what the site should look like.</figcaption></figure></div><div class="ab cl mk ml hr mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ig ih ii ij ik"><h1 id="71a4" class="ks kt in bd ku kv mr kx ky kz ms lb lc jt mt ju le jw mu jx lg jz mv ka li lj bi translated">3.导入三个，useEffect和useRef</h1><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="ca78" class="pw-post-body-paragraph lk ll in lm b ln mz jo lp lq na jr ls lt nb lv lw lx nc lz ma mb nd md me mf ig bi translated">让我们稍微清理一下App.js，删除我们不需要的行，然后导入:</p><ul class=""><li id="bda8" class="ne nf in lm b ln mz lq na lt ng lx nh mb ni mf nj nk nl nm bi translated">useEffect(一旦组件被挂载，我们将使用它来添加和删除我们的Three.js场景)，</li><li id="53e2" class="ne nf in lm b ln nn lq no lt np lx nq mb nr mf nj nk nl nm bi translated">useRef(告诉React场景应该安装在哪里)，以及</li><li id="0cb5" class="ne nf in lm b ln nn lq no lt np lx nq mb nr mf nj nk nl nm bi translated">Three.js库。</li></ul></div><div class="ab cl mk ml hr mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ig ih ii ij ik"><h1 id="472d" class="ks kt in bd ku kv mr kx ky kz ms lb lc jt mt ju le jw mu jx lg jz mv ka li lj bi translated">4.复制粘贴我们的Three.js代码</h1><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="654b" class="pw-post-body-paragraph lk ll in lm b ln mz jo lp lq na jr ls lt nb lv lw lx nc lz ma mb nd md me mf ig bi translated">我们现在已经设置了我们的useEffect-function，并复制粘贴了来自<a class="ae ns" href="https://threejs.org/docs/index.html#manual/en/introduction/Creating-a-scene" rel="noopener ugc nofollow" target="_blank"> Three.js指南中关于如何创建场景的代码</a>(为了更好的可读性，我添加了一些空格)。这段代码将场景直接附加到文档体，在第14行:<code class="fe mg mh mi mj b">document.body.appendChild(renderer.domElement)</code>。</p><p id="3aa4" class="pw-post-body-paragraph lk ll in lm b ln mz jo lp lq na jr ls lt nb lv lw lx nc lz ma mb nd md me mf ig bi translated">起初这可能看起来根本不是问题，但是如果我们看看我们的开发人员工具，我们可以看到画布已经附加在我们的<code class="fe mg mh mi mj b">&lt;body&gt;</code>标签的最后，如果我们在我们的<code class="fe mg mh mi mj b">&lt;div&gt;</code>标签之间添加一行文本，这变得更加明显。让我们在下一步解决这个问题！</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nt"><img src="../Images/2d0ca6f63cbec8ad90f959798ee32ec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qZ3JW7s41FqycdBsIAA5Ag.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">At this point you should have a rotating green cube on your page, yay!</figcaption></figure></div><div class="ab cl mk ml hr mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ig ih ii ij ik"><h1 id="1c2e" class="ks kt in bd ku kv mr kx ky kz ms lb lc jt mt ju le jw mu jx lg jz mv ka li lj bi translated">5.使用useRef将场景挂载到我们的div上</h1><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="bc3f" class="pw-post-body-paragraph lk ll in lm b ln mz jo lp lq na jr ls lt nb lv lw lx nc lz ma mb nd md me mf ig bi translated">我们定义了一个名为<code class="fe mg mh mi mj b">mountRef</code>的<code class="fe mg mh mi mj b">const</code>，并在我们的useEffect-function之前将其赋值为<code class="fe mg mh mi mj b">useRef(null)</code>。然后我们告诉React，我们创建的引用应该通过添加属性<code class="fe mg mh mi mj b">ref={mountRef}</code>来引用我们的<code class="fe mg mh mi mj b">&lt;div&gt;</code>元素。最后，我们用<code class="fe mg mh mi mj b">mountRef.current</code>替换<code class="fe mg mh mi mj b">document.body</code>来将场景挂载到我们引用的<code class="fe mg mh mi mj b">&lt;div&gt;</code>元素上。</p></div><div class="ab cl mk ml hr mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ig ih ii ij ik"><h1 id="c6ac" class="ks kt in bd ku kv mr kx ky kz ms lb lc jt mt ju le jw mu jx lg jz mv ka li lj bi translated">6.清理东西</h1><p id="1edb" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">如果你在浏览器打开的情况下保存了几次文件，你会注意到我们在页面上添加了很多场景。这是因为每次我们保存时，组件都会被重新渲染，并将另一个场景添加到页面中。在第5步之前，我们在useEffect-function中没有任何清理。在第5步第34行添加的代码告诉React，在组件被卸载之前，它应该从我们的<code class="fe mg mh mi mj b">&lt;div&gt;</code>元素中移除场景，并在组件被再次装载时重新添加。如果你现在手动更新浏览器，你会注意到页面上只有一个场景。</p></div><div class="ab cl mk ml hr mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ig ih ii ij ik"><h1 id="f8cb" class="ks kt in bd ku kv mr kx ky kz ms lb lc jt mt ju le jw mu jx lg jz mv ka li lj bi translated">7.收尾</h1><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="1ccd" class="pw-post-body-paragraph lk ll in lm b ln mz jo lp lq na jr ls lt nb lv lw lx nc lz ma mb nd md me mf ig bi translated">最后，当窗口调整大小时，我们希望我们的场景适应它的大小。在第31–37行，我们添加了一个简单的函数，它可以调整相机的大小，更新投影矩阵，并告诉渲染器调整大小。轻松点。</p><p id="55a3" class="pw-post-body-paragraph lk ll in lm b ln mz jo lp lq na jr ls lt nb lv lw lx nc lz ma mb nd md me mf ig bi translated"><a class="ae ns" href="https://github.com/coreAux/react-threejs" rel="noopener ugc nofollow" target="_blank">此处提供回购的完整代码！</a></p><p id="f737" class="pw-post-body-paragraph lk ll in lm b ln mz jo lp lq na jr ls lt nb lv lw lx nc lz ma mb nd md me mf ig bi translated"><em class="nu">更多内容尽在</em><a class="ae ns" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lm io"><em class="nu">plain English . io</em></strong></a></p></div></div>    
</body>
</html>