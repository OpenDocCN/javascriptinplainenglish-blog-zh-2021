<html>
<head>
<title>How to Prevent your Node API from Falling into Common Security Holes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何防止您的节点API落入常见的安全漏洞</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-prevent-your-node-api-from-falling-into-common-security-holes-8bd7272e5504?source=collection_archive---------7-----------------------#2021-08-24">https://javascript.plainenglish.io/how-to-prevent-your-node-api-from-falling-into-common-security-holes-8bd7272e5504?source=collection_archive---------7-----------------------#2021-08-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="29ea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">软件工程师的日常生活充满了问题。有时，我们会遇到安全问题。但是在为大公司做一个大项目时，这个消息可能是非常有害的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/62770219bee8e9f8400779780c4272de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aFbsMI1wZc-tR_Or4AypTw.jpeg"/></div></div></figure><p id="a61d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您从未听说过诸如<strong class="jm io"> XSS、DOS攻击、SQL/NoSQL注入攻击、</strong>等术语，那么很抱歉，您真的没有创建安全的代码。</p><p id="35e7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">好吧，但是具体怎么做呢？从现在开始，我知道这些攻击者是非常有害的。这意味着我们需要尽可能地保证您的应用程序(或API)的安全。</p><p id="13b6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本文中，我希望通过提供一些最佳实践来帮助您，您可以在日常工作环境中尝试并解决这些安全问题。<br/>但首先，如果你不熟悉，让我们一个一个来分析一下！</p><h1 id="1165" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">跨站点脚本(XSS) </strong></h1><p id="6f52" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">基本上，XSS攻击是一种攻击者注入。攻击者会寻找一些方法来插入恶意的浏览器端脚本。当开发人员不够仔细地在服务器端验证输入时，这意味着开发人员只是费心在前端进行验证。不幸的是，这是很常见的。:(</p><p id="3735" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当攻击者成功使用XSS时，他们就可以访问cookies、会话令牌和敏感数据。</p><h1 id="8db2" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">拒绝服务(DOS) </strong></h1><p id="5f58" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">这种行为对于应用程序的声誉来说是非常糟糕的，因为这意味着没有人能够访问该应用程序。攻击者通过不断发送请求、创建流量和发送大量各种信息来实现这一点。如果攻击者成功进行了DOS攻击，将会使您的服务变慢或导致停机。</p><h1 id="c67b" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">蛮力攻击</strong></h1><p id="1ee3" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">用于获取密码或个人识别码(pin)等敏感用户数据的方法。通常，攻击者使用机器人对所需数据的值进行大量猜测/尝试，即使用随机密码进行登录尝试。</p><h1 id="f3cb" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak"> NoSQL/SQL注入</strong></h1><p id="ce6e" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">我想你以前已经听说过这个术语了。注入使得攻击者能够执行恶意的SQL/NoSQL语句。攻击者可以绕过认证、授权，检索整个数据库的内容，添加、修改、删除数据库中的数据。</p></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><p id="f92d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">好吧，但是现在，我们需要解决主要问题。</p><h1 id="f4ce" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">解决这些问题的最佳方法是什么？</strong></h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi me"><img src="../Images/69f3acf8a6a40be666bcd2cdde1e62a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*pf-rs1mDlHF3MQv4rXsBxg.png"/></div></figure><p id="42c6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，在您了解了每个安全发现之后，我将逐一向您展示如何防止这些攻击。</p><h1 id="7709" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">如何防范XSS袭击？</strong></h1><p id="3229" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">首先，我们需要记住，任何参数都需要经过<a class="ae mf" href="https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html" rel="noopener ugc nofollow" target="_blank">验证和</a>净化。这是一件非常容易实现的事情，尽管如此，许多开发人员还是忘记了去做。除此之外，验证所有输入。这是解决这一问题的最有效的技术。该标准将防止脚本攻击并验证服务器端输入。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mg"><img src="../Images/d5c746cd54702391dbc8222ba7563163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*OktglGEieKvBLOflaKhOoA.png"/></div></div></figure><h1 id="00ef" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak"> HttpOnly:阻止针对XSS的cookies】</strong></h1><p id="4c52" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">另一种防止XSS的方法是防止浏览器JavaScript脚本访问cookie。窃取cookies是最常见的XSS攻击之一。这是通过在下面的代码中将cookie值<code class="fe mh mi mj mk b">httpOnly</code>设置为<code class="fe mh mi mj mk b">true</code>来实现的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/72711f1bf257afb22ebc1c76c566a82b.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*am7nfPhksn9qLRMwU2KswQ.png"/></div></figure><h1 id="d1a6" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak"> DOS:防止拒绝服务</strong></h1><p id="f15a" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">首先，为了防止拒绝服务，我们需要定义用户可以向您的API/服务提交的限制。</p><p id="ca92" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们可以使用Express中的body-parse来设置这个限制。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/fc38ba44a3b3f1450353f4518fd82422.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*sDSE26KereAR0KKVZByzsw.png"/></div></figure><p id="988b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">另一种选择是为用户设置速率限制。所以，基本上，你可以为每个用户设置最大请求量；在用户使用完他们的所有请求后，您可以将他们锁定一段时间。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/c2d571cba137e1bbdfef47378a0c5f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*VH9uSnoZKPlTQiLszAnUig.png"/></div></figure><h1 id="d18e" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">如何防止暴力攻击</strong></h1><p id="d878" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">防止这种情况最有效的方法是设置登录尝试的限制，如上所示，使用<code class="fe mh mi mj mk b">express-rate-limit</code>。</p><p id="ca3f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了降低攻击者猜测敏感数据(密码、pin)的难度，您应该实现<strong class="jm io"> bcrypt依赖。Bcrypt将加密敏感数据，如密码，这将使他们更难猜测。</strong></p><p id="a705" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们还可以实现MFA(多因素认证)。这使得认证机制更加安全。</p><h1 id="ee52" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">依赖项和包</strong></h1><p id="bd5d" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">我们知道NPM提供了一种简单的方法来将一些软件包集成到您的应用程序中。但是我们需要采取预防措施，不要因为过时的包而暴露在安全风险中。</p><p id="ad71" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">除此之外，我们必须监控以确保所有软件包都是最新的。</p><p id="8699" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">用<code class="fe mh mi mj mk b">npm audit</code>命令很容易做到，你可以自动修复运行<code class="fe mh mi mj mk b">npm audit fix</code>时可修复的问题。</p><p id="72fb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对了，另一个对你有很大帮助的重要包是<a class="ae mf" href="https://www.npmjs.com/package/helmet" rel="noopener ugc nofollow" target="_blank">头盔</a>。头盔通过设置各种HTTP头来帮助您保护您的Express应用程序。<em class="mo">不是银弹</em>，但是能帮上忙！</p><h1 id="43ec" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">结论</strong></h1><p id="fd5a" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">正如我之前已经解释过的，当主题是确保服务的稳定性、可靠性、持久性和安全性时，开发人员必须努力工作。</p><p id="eabc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上述类型的安全缺陷更常见，因此我向您展示了一些增强我们的节点应用程序的方法，以安全地运行它们，并将安全风险降至最低。</p><p id="64db" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我希望我已经帮助你编写了安全代码！💻 👏</p><p id="2cf2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mo">更多内容看</em><a class="ae mf" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mo">plain English . io</em></strong></a></p></div></div>    
</body>
</html>