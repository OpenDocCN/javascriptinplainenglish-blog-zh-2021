<html>
<head>
<title>How to Resolve LSPs for Deno Projects in Neovim</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何解决Neovim中Deno项目的LSP</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/resolving-lsps-for-deno-projects-in-neovim-1728583edde9?source=collection_archive---------7-----------------------#2021-11-11">https://javascript.plainenglish.io/resolving-lsps-for-deno-projects-in-neovim-1728583edde9?source=collection_archive---------7-----------------------#2021-11-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/3d988e159fee9ea33799467e4ea0da4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eFhYYjFJDSnhte4m"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@pankajpatel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Pankaj Patel</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="32e2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我选择Neovim作为我的编辑器。为了给它类似IDE的特性，我安装了<a class="ae jz" href="https://github.com/neovim/nvim-lspconfig" rel="noopener ugc nofollow" target="_blank"> nvim-lspconfig </a>和<a class="ae jz" href="https://github.com/hrsh7th/nvim-cmp" rel="noopener ugc nofollow" target="_blank"> nvim-cmp </a>。nvim-lspconfig 允许我配置、启动和初始化我机器上的各种语言服务器。对于我的JavaScript和TypeScript工作，这通常意味着初始化<code class="fe ky kz la lb b">tsserver</code>。不过最近在TypeScript中研究LeetCode问题，发现用TypeScript设置节点项目有点过分。所以我决定尝试一下Deno对TypeScript的现成支持。</p><p id="a8dc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">将Deno的LSP添加到我的配置中并不困难。其实过程很简单。我们可以检查<a class="ae jz" href="https://github.com/neovim/nvim-lspconfig" rel="noopener ugc nofollow" target="_blank"> nvim-lspconfig </a> repo中的<code class="fe ky kz la lb b">CONFIG.md</code>文件，看看他们是否为此提供了LSP。然后，我们通过一个简单的命令安装它。</p><pre class="lc ld le lf gt lg lb lh li aw lj bi"><span id="ce46" class="lk ll in lb b gy lm ln l lo lp">-- in my nvim/init.lua file<br/>local nvim_lsp = require("lspconfig")<br/>nvim_lsp.denols.setup{}</span></pre><p id="eeca" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这种情况下，<code class="fe ky kz la lb b">denols</code>是我们可以安装使用Deno的LSP服务器的名称。就这样，我们结束了。至少我是这么认为的。</p><p id="8ede" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我的大部分LSP配置都是空的，就像你在上面看到的一样，这是我在创建Deno项目时犯的一个错误。</p><p id="02bf" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当我开始写一些代码时，一切似乎都很正常。看起来LSP正在做它的工作，但是当我开始编写单元测试时，我遇到了一个问题,<code class="fe ky kz la lb b">Deno.test</code>没有被识别。所以我检查了<code class="fe ky kz la lb b">:LSPInfo</code>，发现有两个客户端连接到缓冲区:<code class="fe ky kz la lb b">tsserver</code>和<code class="fe ky kz la lb b">denols</code></p><p id="194e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是有意义的，因为它会识别<code class="fe ky kz la lb b">TypeScript</code>文件类型，因为我没有任何其他方法来解决冲突。为了解决这个问题，我在LSP配置中添加了以下内容:</p><pre class="lc ld le lf gt lg lb lh li aw lj bi"><span id="1342" class="lk ll in lb b gy lm ln l lo lp">nvim_lsp.tsserver.setup{<br/>  -- Omitting some options<br/>  root_dir = nvim_lsp.util.root_pattern("package.json")<br/>}</span><span id="1c0d" class="lk ll in lb b gy lq ln l lo lp">nvim_lsp.denols.setup {<br/>  -- Omitting some options<br/>  root_dir = nvim_lsp.util.root_pattern("deno.json"),<br/><br/>}</span></pre><p id="20ac" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">通过在我的Deno项目的根目录下创建一个空的<code class="fe ky kz la lb b">deno.json</code>文件，Neovim缓冲区将确保连接了正确的LSP客户端。类似地，如果我想使用<code class="fe ky kz la lb b">tsserver</code>作为我的LSP客户端，我必须确保在项目的根目录下存在一个<code class="fe ky kz la lb b">package.json</code>文件。</p><p id="a8d2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> <em class="lr"> TLDR: </em> </strong> <em class="lr">确保设置</em> <code class="fe ky kz la lb b"><em class="lr">root_dir</em></code> <em class="lr">选项指向一个文件，该文件可以唯一地表示您想要连接到您的缓冲区的LSP客户端。</em></p><p id="8510" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="lr">更多内容请看</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="lr">plain English . io</em></strong></a></p></div></div>    
</body>
</html>