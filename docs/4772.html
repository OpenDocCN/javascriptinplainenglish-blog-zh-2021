<html>
<head>
<title>How To Create Angular Simple Custom Validators — Reactive Forms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建简单的定制验证器——反应式表单</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-angular-simple-custom-validators-reactive-forms-4890cc875a10?source=collection_archive---------8-----------------------#2021-09-23">https://javascript.plainenglish.io/how-to-create-angular-simple-custom-validators-reactive-forms-4890cc875a10?source=collection_archive---------8-----------------------#2021-09-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/db7ccde5cfe61707561e9ac20db6cb3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yzt-XJmNprnsfWKvThHdGw.png"/></div></div></figure><p id="0a6c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用Angular的反应式表单的人都知道Angular团队给了我们一些预定义的验证器，比如<em class="kt"> Validators.required </em>、<em class="kt"> Validators.min() </em>、<em class="kt"> Validators.max() </em>等等。</p><p id="46fb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但是，当我们想要使用Angular中没有预定义的验证时，会发生什么呢？我们该怎么做呢？这就是这篇文章将要解释的内容，最后，我们会看到它有多简单。</p><p id="5363" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们来看一个输入文本的用例，我们希望它是必需的，最小长度为5，并且至少包含一个不是空格的字符(简单地说，我们需要我们的文本有一个值，而不仅仅是空格)。</p><p id="b7be" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这种情况下，我们可以使用一些内置的角度验证器，如<em class="kt"> Validators.required </em>和<em class="kt">Validators . minlength(5)</em>但是空白问题怎么办？</p><p id="a5e4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，我们必须使用Angular FormGroup和与表单相对应的HTML来创建表单。</p><p id="6bcc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们的组件。ts看起来会像:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="ky kz l"/></div></figure><p id="d02b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们的HTML代码是这样的:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="ky kz l"/></div></figure><p id="ae85" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">正如你所看到的，现在，我们只使用了<em class="kt"> Validators.required </em>和<em class="kt">validators . minlength(5)</em>，它们是角度内置的。</p><p id="0178" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">对于空白验证器，我们应该创建一个自定义的。为此，我们必须创建一个函数来接收一个<em class="kt"> AbstractControl </em>对象，并在那里进行验证。</p><p id="c2e5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，我们创建一个包含以下代码的<em class="kt">空白验证器. ts </em>文件:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="ky kz l"/></div></figure><p id="c3fd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如您所见，在这个自定义验证器中，我们首先检查表单值是否为null。如果为null，则不会引发任何错误。之后，我们从表单控件中获取值，修剪它(删除开始和结束空格)并计算值的长度。如果删除起始和结束空格后的长度为零，意味着我们的值只包含空格，我们的验证器应该抛出一个错误。</p><p id="456a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如你所见，我们更新了我们的<em class="kt"> hasErrors </em>变量，如果为真，我们返回一个对象，表明控件无效，我们的表单有错误。</p><p id="ca91" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们必须相应地更新组件:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="ky kz l"/></div></figure><p id="ed0d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">正如我们所看到的，我们刚刚将自定义验证器<em class="kt"> WhiteSpaceValidator </em>添加到表单控件定义中。</p><p id="c656" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">就是这样！我们刚刚创建了全新的自定义验证器。</p><p id="f110" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> PS: </strong>这只是一个非常基本的例子，为了文章的简洁，我省略了错误检查和错误消息。</p><p id="ad44" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> PS2: </strong>如果你需要一个运行时间监控工具，只需检查一下<a class="ae la" href="https://robomiri.com" rel="noopener ugc nofollow" target="_blank"> RoboMiri </a>。最好的免费正常运行时间监测服务。</p><p id="1188" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kt">更多内容请看</em><a class="ae la" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="kt">plain English . io</em></strong></a></p></div></div>    
</body>
</html>