<html>
<head>
<title>Create and Publish Your Own NPM Module</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建并发布您自己的NPM模块</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-and-publish-your-own-npm-module-216bffe82dc5?source=collection_archive---------9-----------------------#2021-12-23">https://javascript.plainenglish.io/create-and-publish-your-own-npm-module-216bffe82dc5?source=collection_archive---------9-----------------------#2021-12-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/13a70840a87b875bbe688ff587ed0b1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*43jeTQ43UlqgLlwcY-Jlww.png"/></div></div></figure><p id="2ae0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">老实说，复制代码很糟糕。这是一个冗长费时的过程，它暂时解决了问题，但从长远来看却是一个负担。您可以创建函数并在您的项目中重用它们，但是，通常情况下，您会发现自己在其他项目中需要相同的函数。这就是你应该考虑将这个函数捆绑到一个包中，然后在你未来的项目中重用它的地方。</p><p id="5299" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这篇博文中，我们将使用Node.js做同样的事情，并最终将其发布到npm商店。</p><blockquote class="kt ku kv"><p id="5ef2" class="jv jw kw jx b jy jz ka kb kc kd ke kf kx kh ki kj ky kl km kn kz kp kq kr ks ig bi translated">我在youtube上也有这个教程的视频版本。</p></blockquote><h2 id="94bb" class="lb lc in bd ld le lf dn lg lh li dp lj kg lk ll lm kk ln lo lp ko lq lr ls lt bi translated">1.创建NPM帐户</h2><figure class="lv lw lx ly gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lu"><img src="../Images/c634b4804a473037d376cdc353785cde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gINhDFwPsgnzpd84XyTFBw.png"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk">npm signup page</figcaption></figure><p id="b4e3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在创建图书馆之前，你首先需要在NPM的网站上注册。跟随<a class="ae la" href="https://www.npmjs.com/signup" rel="noopener ugc nofollow" target="_blank">这个链接</a>并创建一个账户。一个链接也将发送到你的电子邮件地址，你应该通过它来验证你的帐户。一旦完成，你就可以走了。</p><p id="7848" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">打开VSCode(任何代码编辑器)并在其终端中键入“<strong class="jx io"> npm登录</strong>”。</p><figure class="lv lw lx ly gt jo gh gi paragraph-image"><div class="gh gi md"><img src="../Images/4fcf9dc225c5d459a20b99c790860f2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*M6VezCHUo0WP1YvwOY7ATA.png"/></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk">npm login</figcaption></figure><p id="ef6d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">它会要求您输入您刚刚创建的npm帐户的<strong class="jx io">用户名、电子邮件、</strong>和<strong class="jx io">密码</strong>。填写这些值后，您将成功登录到您的帐户。</p><h2 id="9a92" class="lb lc in bd ld le lf dn lg lh li dp lj kg lk ll lm kk ln lo lp ko lq lr ls lt bi translated">2.项目设置</h2><p id="1ac2" class="pw-post-body-paragraph jv jw in jx b jy me ka kb kc mf ke kf kg mg ki kj kk mh km kn ko mi kq kr ks ig bi translated">要创建一个节点项目，在VSCode终端中键入"<strong class="jx io"> npm init -y" </strong>。这将用一个<strong class="jx io"> package.json </strong>文件为您初始化一个节点项目。</p><p id="3fb8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">创建一个<strong class="jx io"> index.js </strong>文件。这个文件将成为您的包的入口点。因此，从这个文件中<strong class="jx io">导出</strong>的任何内容，对于将要在他们的项目中安装这个包的用户来说都是可以访问的。将这段代码复制到index.js文件中。</p><pre class="lv lw lx ly gt mj mk ml mm aw mn bi"><span id="e50c" class="lb lc in mk b gy mo mp l mq mr">const {countryCodes} = require("./countrycodes")<br/>const {timeZones} = require("./timezones")</span><span id="8eb7" class="lb lc in mk b gy ms mp l mq mr">exports.getTimeZones = () =&gt; timeZones<br/>exports.getCountryCodes = () =&gt; countryCodes</span></pre><blockquote class="kt ku kv"><p id="f754" class="jv jw kw jx b jy jz ka kb kc kd ke kf kx kh ki kj ky kl km kn kz kp kq kr ks ig bi translated">这个基本包将做的是导出一组时区和国家代码。因此，任何想在自己的用例中使用这些数据集的人都可以安装这个包。</p></blockquote><p id="46e6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">index.js文件实际上是从它们各自的文件中导入两个数据集，并将它们添加到exports对象中。您可以从<a class="ae la" href="https://github.com/AkileshRao/custom-node-package" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> Github repo </strong> </a>下载<a class="ae la" href="https://github.com/AkileshRao/custom-node-package/blob/master/countryCodes.js" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">国家代码</strong> </a>和<a class="ae la" href="https://github.com/AkileshRao/custom-node-package/blob/master/timeZones.js" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">时区</strong> </a>。我们现在可以将这个包发布到npm商店，但在此之前，让我们快速浏览一下包的基本类型。</p><h2 id="edf9" class="lb lc in bd ld le lf dn lg lh li dp lj kg lk ll lm kk ln lo lp ko lq lr ls lt bi translated">3.了解限定范围和未限定范围的包。</h2><figure class="lv lw lx ly gt jo gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/61567e4b7f1116c3c8f91c8f5ef316ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*0KQlQ0IdlbBQrdjNRt6b-g.png"/></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk">Scoped vs unscoped package</figcaption></figure><p id="6dd1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，当您使用npm init初始化项目时，会用一组预定义的值创建一个package.json文件。该文件中的"<strong class="jx io"> name" </strong>属性通常被设置为<strong class="jx io">文件夹，在该文件夹中您初始化了您的项目</strong>。因此，如果您当前位于一个名为“<strong class="jx io">moment”</strong>的文件夹中，并且您在该文件夹中初始化了您的npm项目，那么package.json文件中的<strong class="jx io"> name键</strong>将被设置为<strong class="jx io"> moment </strong>。</p><p id="8e96" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，我告诉你这个的原因是，如果我们试图发布这个名称设置为“<strong class="jx io"> moment </strong>的项目，npm会给我们一个错误，说这个包名已经被占用了。npm存储中不能有两个同名的包。这可以通过使用<strong class="jx io">示波器</strong>来解决。</p><p id="d16c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">根据npm，“作用域是将相关包组合在一起的一种方式”。所以任何时候你看到一个以“<strong class="jx io"> @ </strong>”开头并且名字中有“<strong class="jx io"> / </strong>”的包，它就是一个作用域包。所以<strong class="jx io"> @babel/core </strong>是一个作用域包，以<strong class="jx io"> core </strong>为包名，<strong class="jx io">babel</strong>为<strong class="jx io">作用域</strong>。现在使用这个作用域，可以将相关的包组合在一起。此外，如果您想为您的包使用一个特定的名称，但是它已经被其他人使用了，您可以在开始时添加一个作用域来解决这个问题。</p><p id="6288" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">通常你的<strong class="jx io">用户名</strong>或者<strong class="jx io">组织</strong>名称被设置为包的范围。例如，如果我正在创建一个名为"<strong class="jx io"> maps </strong>"的作用域包，我的用户名是"<strong class="jx io"> john123" </strong>，那么这个包的名字将被命名为"<strong class="jx io"> @john123/maps </strong>"。将用户名设置为作用域可以确保永远不会与其他包发生命名冲突，因为用户名本质上是唯一的。</p><p id="1e4f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你确信你的包名是唯一的，你就不需要担心作用域。你可以简单地按原样发布它。</p><p id="1a58" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在创建作用域包时，你需要记住的一件事是，它们在默认情况下是私有的，不像未作用域包，每个人都可以使用。当创建作用域包时，您需要手动添加一个标志<strong class="jx io">，使它们对公众可用。我们稍后会看一下这个。</strong></p><h2 id="4532" class="lb lc in bd ld le lf dn lg lh li dp lj kg lk ll lm kk ln lo lp ko lq lr ls lt bi translated">4.发布您的包</h2><p id="f014" class="pw-post-body-paragraph jv jw in jx b jy me ka kb kc mf ke kf kg mg ki kj kk mh km kn ko mi kq kr ks ig bi translated">现在我们知道了什么是作用域，我们将首先创建一个非作用域包。在我的例子中，由于我使用的包名与其他一些预先存在的包相似，所以我得到了一个错误。</p><figure class="lv lw lx ly gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mu"><img src="../Images/4b1f6905701868dd7fe1552aef91e527.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j573TOAqBXgvyjNdvoMuQw.png"/></div></div></figure><p id="8bc6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这个错误告诉我，我的包的名称("<strong class="jx io"> node-js-package-demo" </strong>)与已经创建的包("<strong class="jx io"> nodejspackagedemo" </strong>)相似。它也给了我一个建议，将我的用户名作为一个作用域添加到这个包中来解决这个问题。如果我们仍然想创建一个未分类的包，我们可以只在开头或结尾添加我们的用户名。虽然这仍然会造成命名冲突，但在大多数情况下应该是可行的。所以在我的例子中，包名应该看起来像"<strong class="jx io">node-js-package-demo-akileshro 19</strong>"。现在，如果我尝试发布它，我会收到一条消息，说我的包已经成功创建。</p><figure class="lv lw lx ly gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mv"><img src="../Images/70cd5ddc2363a1314c776ba2f00b7a5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DCmhAAp_XOjlVw1kWtKkMQ.png"/></div></div></figure><p id="fd1f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果我去npm商店并登录到我的帐户，在包部分我将能够找到我新创建的包。</p><p id="5781" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在转到您的package.json文件。删除包名末尾的用户名，并将其添加为一个作用域。所以在我的例子中，由于我的用户名是<strong class="jx io">akileshro 19</strong>，包名是<strong class="jx io"> node-js-package-demo </strong>，新的包名应该类似于<strong class="jx io">@ akileshro 19/node-js-package-demo</strong>。如果你现在试图发布这个包，你会再次得到一个错误。</p><figure class="lv lw lx ly gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/cb88663d63a677acada748e43a8e2326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*njFDLxX3MPIAJ-WaOxj0cQ.png"/></div></div></figure><p id="9bbc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如前所述，作用域包在默认情况下是私有的，要在npm上创建私有包，您需要每月支付费用。相反，我们要做的是传入一个标志，这个标志将<strong class="jx io">创建一个公共范围的包</strong>。因此，除了npm发布，尝试</p><pre class="lv lw lx ly gt mj mk ml mm aw mn bi"><span id="6d58" class="lb lc in mk b gy mo mp l mq mr">npm publish --access=public</span></pre><p id="34b4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在应该可以了，你可以在npm门户的packages部分找到你新创建的，<strong class="jx io">范围的包</strong>。</p><h2 id="f931" class="lb lc in bd ld le lf dn lg lh li dp lj kg lk ll lm kk ln lo lp ko lq lr ls lt bi translated">5.使用软件包</h2><p id="8478" class="pw-post-body-paragraph jv jw in jx b jy me ka kb kc mf ke kf kg mg ki kj kk mh km kn ko mi kq kr ks ig bi translated">现在，在一个单独的nodeJS项目中，尝试安装您的任何一个npm包，就像您通常安装任何第三方包一样。然后，您可以导入我们从包中导出的两个方法，即项目中的<strong class="jx io"> getTimeZones() </strong>和<strong class="jx io"> getCountryCodes() </strong>。</p><h2 id="3f3b" class="lb lc in bd ld le lf dn lg lh li dp lj kg lk ll lm kk ln lo lp ko lq lr ls lt bi translated">结论</h2><p id="838d" class="pw-post-body-paragraph jv jw in jx b jy me ka kb kc mf ke kf kg mg ki kj kk mh km kn ko mi kq kr ks ig bi translated">这基本上就是你通常如何创建和发布你自己的npm包的要点。在这篇文章中，我还没有涉及到其他一些方面。你通常会想要一个<strong class="jx io">好的、描述性的readme部分</strong>，你可以通过一个<strong class="jx io"> README.md </strong>文件或者在你的package.json文件的<strong class="jx io">描述关键字</strong>中添加它。另外，每当您对您的包进行更改并希望将其重新发布到npm存储时，您将需要<strong class="jx io">更新package.json文件中的版本号</strong>。如果您尝试在不更新版本的情况下向包中添加更改并发布它，Npm将抛出错误。</p><p id="4198" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我的youtube频道上有一个视频版本。</p><p id="df23" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可以从<a class="ae la" href="https://github.com/AkileshRao/custom-node-package" rel="noopener ugc nofollow" target="_blank">这个库</a>中访问项目文件。</p><p id="3b47" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你有任何疑问或建议，你可以在评论中提出，或者通过下面提到的任何一个社交网站与我联系。干杯！</p><p id="b21c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><a class="ae la" href="https://www.youtube.com/channel/UCaktnqx_IENyT5T2lJ3F09w" rel="noopener ugc nofollow" target="_blank">YouTube</a><br/><a class="ae la" href="https://www.linkedin.com/in/akilesh-rao-610357137/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a><br/><a class="ae la" href="https://twitter.com/themangalorian" rel="noopener ugc nofollow" target="_blank">Twitter</a><br/><a class="ae la" href="https://github.com/AkileshRao" rel="noopener ugc nofollow" target="_blank">GitHub</a></p><p id="7a29" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kw">更多内容请看</em><a class="ae la" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="kw">plain English . io</em></strong></a><strong class="jx io"><em class="kw">。</em> </strong> <em class="kw">报名参加我们的</em> <a class="ae la" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="kw">免费每周简讯这里</em> </strong> </a> <strong class="jx io"> <em class="kw">。</em> </strong></p></div></div>    
</body>
</html>