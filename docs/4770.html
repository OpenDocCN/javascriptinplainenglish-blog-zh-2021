<html>
<head>
<title>Improve Rendering Performance With The New CSS ‘Content-Visibility’ Property</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用新的CSS“内容可见性”属性提高呈现性能</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/improve-rendering-performance-with-the-new-css-content-visibility-property-7e0c9b425b58?source=collection_archive---------6-----------------------#2021-09-23">https://javascript.plainenglish.io/improve-rendering-performance-with-the-new-css-content-visibility-property-7e0c9b425b58?source=collection_archive---------6-----------------------#2021-09-23</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><h2 id="e152" class="ip iq ir bd b dl is it iu iv iw ix dk iy translated" aria-label="kicker paragraph">WEB性能</h2><div class=""/><div class=""><h2 id="dd30" class="pw-subtitle-paragraph jx ja ir bd b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dk translated">了解内容可见性属性</h2></div><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj kp"><img src="../Images/3999f1ccd0aac384276cf4d183536760.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_hrviLHndkMXg0V56m1Mg.jpeg"/></div></div></figure><p id="c354" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">今年早些时候，Chromium 85发布了，它低调地包含了一个新的CSS属性，当时我完全被它迷住了。属性允许你指示用户代理跳过所有的渲染工作，包括布局和绘画，直到需要的时候。</p><h2 id="f223" class="mb mc ir bd md me mf dn mg mh mi dp mj lk mk ml mm lo mn mo mp ls mq mr ms ix bi translated">这个什么时候有用？</h2><p id="1a72" class="pw-post-body-paragraph lb lc ir ld b le mt kb lg lh mu ke lj lk mv lm ln lo mw lq lr ls mx lu lv lw ik bi translated">如果您的内容最初是隐藏的或不在屏幕上，那么那些包含文本甚至多媒体的部分就不必呈现。这可以极大地提高页面呈现性能，因为不需要加载任何内容，甚至是节中包含的图像或iFrames。</p><p id="10ca" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">马上，我能想到这方面的几个应用:</p><ul class=""><li id="50eb" class="my mz ir ld b le lf lh li lk na lo nb ls nc lw nd ne nf ng bi translated">长页面上折叠线以下的所有内容</li><li id="2c33" class="my mz ir ld b le nh lh ni lk nj lo nk ls nl lw nd ne nf ng bi translated">下拉菜单</li><li id="be5f" class="my mz ir ld b le nh lh ni lk nj lo nk ls nl lw nd ne nf ng bi translated">侧板</li><li id="5731" class="my mz ir ld b le nh lh ni lk nj lo nk ls nl lw nd ne nf ng bi translated">情态动词</li></ul><h2 id="95ad" class="mb mc ir bd md me mf dn mg mh mi dp mj lk mk ml mm lo mn mo mp ls mq mr ms ix bi translated">如何使用它</h2><p id="4433" class="pw-post-body-paragraph lb lc ir ld b le mt kb lg lh mu ke lj lk mv lm ln lo mw lq lr ls mx lu lv lw ik bi translated">属性基本上是CSS包容规范的简写。该属性有三个唯一的值:</p><ul class=""><li id="d520" class="my mz ir ld b le lf lh li lk na lo nb ls nc lw nd ne nf ng bi translated"><code class="fe lx ly lz ma b"><strong class="ld jb">visible</strong></code>:这是默认值，没有任何效果。元素的内容被正常布局和呈现。</li><li id="1a44" class="my mz ir ld b le nh lh ni lk nj lo nk ls nl lw nd ne nf ng bi translated"><code class="fe lx ly lz ma b"><strong class="ld jb">hidden</strong></code>:元素完全跳过其内容。用户代理功能(如在页面中查找、tab键顺序导航)无法访问内容，也无法选择或聚焦内容。这在效果上类似于给出元素的内容<code class="fe lx ly lz ma b">display: none;</code>。</li><li id="8f06" class="my mz ir ld b le nh lh ni lk nj lo nk ls nl lw nd ne nf ng bi translated"><code class="fe lx ly lz ma b"><strong class="ld jb">auto</strong></code>:元素接受布局、风格、油漆包容。如果元素与用户无关，它也会跳过其内容。与<code class="fe lx ly lz ma b">hidden</code>值不同，被跳过的内容仍可访问用户代理功能，如页面查找、tab键顺序导航，并且必须是可聚焦和可选择的。</li></ul><p id="499d" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">这意味着我们可以使用下面的CSS来实现这样的效果，即某个元素的内容不会被呈现、绘制、样式化，或者它的任何媒体资产不会被加载，直到它需要出现在屏幕上。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="f37a" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">不过有一个小问题。元素的高度现在是0，就像你在元素上使用<code class="fe lx ly lz ma b">display: none;</code>一样。这并不理想，因为当元素变得可见时，你可以看到滚动条移动，这是很糟糕的UI。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="53c1" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">为了解决这个问题，我们可以使用<code class="fe lx ly lz ma b">contain-intrinsic-size</code>属性来设置元素的占位符宽度和高度，直到需要并呈现实际内容。</p><h2 id="0e68" class="mb mc ir bd md me mf dn mg mh mi dp mj lk mk ml mm lo mn mo mp ls mq mr ms ix bi translated">隐藏具有内容可见性的内容:隐藏</h2><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="7c2e" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">使用<code class="fe lx ly lz ma b">content-visibility: hidden;</code>将内容隐藏在用户的视野之外，从用户代理特性中删除它，并像<code class="fe lx ly lz ma b">display: none;</code>一样使内容不可选择和不可聚焦。区别在于缓存的呈现状态。</p><p id="b567" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">当使用<code class="fe lx ly lz ma b">display: none;</code>时，它完全破坏了渲染状态。这意味着从一个元素中移除<code class="fe lx ly lz ma b">display: none;</code>和呈现一个具有相同内容的全新元素实际上没有区别。</p><p id="0dc9" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">然而，当使用<code class="fe lx ly lz ma b">content-visibility: hidden;</code>时，缓存的渲染状态被保持。这意味着内容可以更有效地呈现在屏幕上。这对于可以重复显示/隐藏的内容块非常有用，就像单页应用程序中的视图一样。</p><h2 id="29dc" class="mb mc ir bd md me mf dn mg mh mi dp mj lk mk ml mm lo mn mo mp ls mq mr ms ix bi translated">浏览器支持</h2><p id="b4a3" class="pw-post-body-paragraph lb lc ir ld b le mt kb lg lh mu ke lj lk mv lm ln lo mw lq lr ls mx lu lv lw ik bi translated"><code class="fe lx ly lz ma b">content-visibility</code>是在Chromium 85中添加的，目前在Chrome、Edge和Opera的最新版本上工作。Firefox认为它值得进行原型开发，而Safari目前还没有对此功能发表任何评论。</p><p id="2c6d" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">这意味着在生产网站上使用<code class="fe lx ly lz ma b">content-visibility: hidden;</code>需要记住一些事情。你不能安全地使用<code class="fe lx ly lz ma b">content-visibility: hidden;</code>作为隐藏内容的唯一方法。要么使用某种形式的特征检测，要么将其与<code class="fe lx ly lz ma b">display: none;</code>结合使用。</p><h2 id="62cd" class="mb mc ir bd md me mf dn mg mh mi dp mj lk mk ml mm lo mn mo mp ls mq mr ms ix bi translated">结论</h2><p id="bfcd" class="pw-post-body-paragraph lb lc ir ld b le mt kb lg lh mu ke lj lk mv lm ln lo mw lq lr ls mx lu lv lw ik bi translated">这个简单的CSS属性可以为您的工具包带来令人兴奋的性能优化。有关资源<code class="fe lx ly lz ma b">content-visibility</code>和CSS包容规范的更多信息，请查看以下资源:</p><ul class=""><li id="ab7b" class="my mz ir ld b le lf lh li lk na lo nb ls nc lw nd ne nf ng bi translated"><a class="ae nm" href="https://web.dev/content-visibility/" rel="noopener ugc nofollow" target="_blank">内容可见性:提升渲染性能的新CSS属性</a> [web.dev]</li><li id="d2fe" class="my mz ir ld b le nh lh ni lk nj lo nk ls nl lw nd ne nf ng bi translated"><a class="ae nm" href="https://developer.mozilla.org/en-US/docs/Web/CSS/content-visibility" rel="noopener ugc nofollow" target="_blank">内容可见性文档</a>【MDN网络文档】</li><li id="1a37" class="my mz ir ld b le nh lh ni lk nj lo nk ls nl lw nd ne nf ng bi translated"><a class="ae nm" href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Containment" rel="noopener ugc nofollow" target="_blank">CSS包容上的MDN文档</a></li></ul><p id="e364" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">感谢您的阅读。如果你对此有任何想法，请在下面的评论中告诉我。</p><p id="bb40" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">你可以在Twitter上关注我。</p><p id="1be4" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated"><em class="np">更多内容请看</em><a class="ae nm" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ld jb"><em class="np">plain English . io</em></strong></a></p></div></div>    
</body>
</html>