<html>
<head>
<title>Enable Tree Shaking to Optimize Your React Component Libraries with Webpack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">启用树抖动以使用Webpack优化React组件库</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/enable-tree-shaking-on-component-libraries-with-webpack-c1f6f4d0f0b?source=collection_archive---------8-----------------------#2021-07-02">https://javascript.plainenglish.io/enable-tree-shaking-on-component-libraries-with-webpack-c1f6f4d0f0b?source=collection_archive---------8-----------------------#2021-07-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/491696c0f0b2b98b521fdac455331783.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xv2oP0VQHW0aF2yChzrX9g.jpeg"/></div></div></figure><p id="422d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用React构建组件库的一个重要部分是确保它们是轻量级的和优化的。</p><p id="af7f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，我在应用程序中经常使用Lodash。我只使用了Lodash提供的一小部分功能。当我将我的应用程序捆绑到产品版本中时，我不希望整个1.14 Mb的库被拉进来。</p><p id="3be0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">树抖动，或“死代码移除”，是一种允许您从库中移除任何未使用的代码的技术。</p><p id="f9e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了使摇树工作，一些事情需要到位。</p><ol class=""><li id="f8a0" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">目标库需要用ES5或更高的语法编写。</li><li id="3c12" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">目标库需要将它的package.json的sideEffects设置为false。</li><li id="5a6f" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">你需要使用支持它的JavaScript bundler，在我的例子中，是Webpack。</li></ol><p id="2bd5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文的其余部分，我将通过一个例子来说明我是如何在为Monorepo构建的组件库上实现树抖动的。</p><p id="d541" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的Monorepo有一个叫components的包。我所有的定制组件都保存在这里。</p><p id="f826" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我有一个用ES6语法编写的过于简单的按钮组件。</p><figure class="lk ll lm ln gt jr"><div class="bz fp l di"><div class="lo lp l"/></div></figure><p id="4719" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的组件库有自己的package.json，sideEffects设置为false。</p><p id="0f32" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将sideEffects设置为false实质上是我们允许Webpack在我们的模块上执行代码分割。</p><figure class="lk ll lm ln gt jr"><div class="bz fp l di"><div class="lo lp l"/></div></figure><p id="8854" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">导入我的按钮的应用程序使用Webpack进行捆绑。</p><figure class="lk ll lm ln gt jr"><div class="bz fp l di"><div class="lo lp l"/></div></figure><p id="6d6d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我捆绑我的应用程序时，Webpack会负责删除未使用的代码。</p><p id="fc02" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我选择不将我的按钮组件导入我的主应用程序，编译我的应用程序并搜索bundle.js文件，我将看不到任何对按钮组件的引用。</p><p id="6a70" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lq">更多内容看</em><a class="ae lr" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="lq">plain English . io</em></strong></a></p></div></div>    
</body>
</html>