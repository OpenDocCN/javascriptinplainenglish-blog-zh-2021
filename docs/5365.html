<html>
<head>
<title>How to use Playwright and Benchmark.js to test JavaScript performance across browsers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨å‰§ä½œå®¶å’ŒBenchmark.jsè·¨æµè§ˆå™¨æµ‹è¯•JavaScriptæ€§èƒ½</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/using-playwright-and-benchmark-js-to-test-javascript-performance-across-browsers-99fc0dc56e55?source=collection_archive---------3-----------------------#2021-11-05">https://javascript.plainenglish.io/using-playwright-and-benchmark-js-to-test-javascript-performance-across-browsers-99fc0dc56e55?source=collection_archive---------3-----------------------#2021-11-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="6f56" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ­£å¦‚æˆ‘ä»¬åœ¨<a class="ae ki" href="https://medium.com/@alowdon/testing-javascript-performance-with-benchmark-js-3d3f4e4b9fc2" rel="noopener">ä¸Šä¸€ç¯‡æ–‡ç« </a>ä¸­è®¨è®ºçš„ï¼ŒBenchmark.jsæ˜¯æµ‹è¯•JavaScriptä»£ç æ€§èƒ½çš„ä¸€ä¸ªæœ‰ç”¨çš„åº“ã€‚ç„¶è€Œï¼Œç”±äºJavaScriptæ˜¯ä¸€ç§<a class="ae ki" href="https://www.easytechjunkie.com/what-is-interpreted-language.htm" rel="noopener ugc nofollow" target="_blank">è§£é‡Šè¯­è¨€</a>ï¼Œæ‰§è¡Œä»£ç æ—¶çš„æ€§èƒ½å–å†³äºä½¿ç”¨çš„JavaScriptå¼•æ“ã€‚ä¸åŒçš„æµè§ˆå™¨ä½¿ç”¨ä¸åŒçš„JavaScriptå¼•æ“:</p><ul class=""><li id="4d73" class="kj kk in jm b jn jo jr js jv kl jz km kd kn kh ko kp kq kr bi translated">è°·æ­Œçš„<a class="ae ki" href="https://v8.dev/" rel="noopener ugc nofollow" target="_blank"> V8 </a>æ˜¯æœ€å¸¸ç”¨çš„JavaScriptå¼•æ“ï¼Œç”¨äºåŸºäº<a class="ae ki" href="https://www.chromium.org/" rel="noopener ugc nofollow" target="_blank"> Chromium </a>çš„æµè§ˆå™¨ï¼Œå¦‚è°·æ­ŒChromeå’Œå¾®è½¯Edgeï¼Œä»¥åŠ<a class="ae ki" href="https://nodejs.org/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>å’Œ<a class="ae ki" href="https://deno.land/" rel="noopener ugc nofollow" target="_blank"> Deno </a>è¿è¡Œæ—¶</li><li id="3d81" class="kj kk in jm b jn ks jr kt jv ku jz kv kd kw kh ko kp kq kr bi translated">èœ˜è››çŒ´ç”±Mozillaå¼€å‘ï¼Œç”¨äºFirefoxå’Œå…¶ä»–é¡¹ç›®</li><li id="f0fe" class="kj kk in jm b jn ks jr kt jv ku jz kv kd kw kh ko kp kq kr bi translated">JavaScriptCoreæ˜¯è‹¹æœçš„äº§å“ï¼Œç”¨äºåŸºäºWebKitçš„æµè§ˆå™¨ï¼Œæ¯”å¦‚Safari</li></ul><p id="5d46" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿›è¡Œæ›´æ”¹æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»éªŒè¯å¯¹è¿™äº›å¼•æ“æ€§èƒ½çš„å½±å“ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼›æˆ‘ä»¬å¾ˆå®¹æ˜“å¯¹ä¸€äº›æµè§ˆå™¨äº§ç”Ÿç§¯æçš„å½±å“ï¼Œè€Œå¯¹å…¶ä»–æµè§ˆå™¨äº§ç”Ÿæ¶ˆæçš„å½±å“ï¼Œå¹¶ä¸”å¯èƒ½ç»å¸¸éœ€è¦æ ¹æ®ç”¨æˆ·æœ€å¸¸ç”¨çš„æµè§ˆå™¨åšå‡ºå…³äºä½¿ç”¨ä»€ä¹ˆä»£ç çš„åŠ¡å®å†³å®šã€‚</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/037d8680815e5397f6cd20260948bfe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cCqtmD00FAusCUbO79-GMw.jpeg"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">Performance varies across different browser engines</figcaption></figure><p id="9f4d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å‰§ä½œå®¶ä½œä¸ºæµè§ˆå™¨è‡ªåŠ¨åŒ–å·¥å…·æ­£åœ¨è¿…é€Ÿè·å¾—å…³æ³¨ï¼Œå®ƒæä¾›äº†é’ˆå¯¹Chromiumã€Firefoxå’ŒWebKitçš„æµ‹è¯•èƒ½åŠ›ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‰§ä½œå®¶å¯¹æˆ‘ä»¬ä¸Šé¢æåˆ°çš„æ‰€æœ‰JavaScriptå¼•æ“æ‰§è¡ŒBenchmark.jsæµ‹è¯•ã€‚</p><p id="f3ba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬å°†ä»æˆ‘ä»¬ä¹‹å‰åœ¨å·¥ä½œçš„ç¤ºä¾‹æµ‹è¯•å¥—ä»¶å¼€å§‹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…å‰§ä½œå®¶æµ‹è¯•è¿è¡Œå™¨å’Œæ”¯æŒçš„æµè§ˆå™¨(ä½¿ç”¨è¿™ç§æ–¹æ³•å°†å…è®¸å‰§ä½œå®¶ä¸ºæ‚¨ç»´æŠ¤æ‰€éœ€çš„æµè§ˆå™¨å¼•æ“ï¼Œä½†æ˜¯å¦‚æœæ‚¨æ„¿æ„ï¼Œæ‚¨å¯ä»¥<a class="ae ki" href="https://playwright.dev/docs/browsers#installing-browsers" rel="noopener ugc nofollow" target="_blank">ä½¿ç”¨ç°æœ‰çš„å®‰è£…</a>)ã€‚</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="b314" class="ls lt in lo b gy lu lv l lw lx">npm i -D @playwright/test<br/>npx playwright install</span></pre><blockquote class="ly lz ma"><p id="9c93" class="jk jl mb jm b jn jo jp jq jr js jt ju mc jw jx jy md ka kb kc me ke kf kg kh ig bi translated">æ³¨æ„:åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯MacOS Montereyï¼Œæ‚¨åº”è¯¥è°ƒç”¨<code class="fe mf mg mh lo b">npm i -D @playwright/test@next</code>ï¼Œå› ä¸ºåœ¨æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬ä¸­ï¼ŒWebKitæµ‹è¯•å­˜åœ¨<a class="ae ki" href="https://github.com/microsoft/playwright/issues/9811" rel="noopener ugc nofollow" target="_blank">é—®é¢˜</a></p></blockquote><p id="0e30" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªspecæ–‡ä»¶ä¾›å‰§ä½œå®¶æ‰§è¡Œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæµ‹è¯•è¢«å‡å®šåœ¨ä¸€ä¸ª<code class="fe mf mg mh lo b">tests</code>æ–‡ä»¶å¤¹ä¸­ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬åœ¨<code class="fe mf mg mh lo b">tests/bench.spec.js</code>åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹:</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="3608" class="ls lt in lo b gy lu lv l lw lx">const { test } = require('@playwright/test');</span><span id="049c" class="ls lt in lo b gy mi lv l lw lx">test('Run benchmarks', async ({ page }) =&gt; {<br/>  await page.goto(`file://${process.cwd()}/bench.html`);<br/>});</span></pre><p id="d189" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥è¿è¡Œæµ‹è¯•:</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="c609" class="ls lt in lo b gy lu lv l lw lx">npx playwright test</span></pre><p id="5e85" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬å°†å¾—åˆ°ä»¥ä¸‹è¾“å‡º:</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="aeed" class="ls lt in lo b gy lu lv l lw lx">Running 1 test using 1 worker</span><span id="e2c3" class="ls lt in lo b gy mi lv l lw lx">âœ“  tests/bench.spec.js:3:1 â€º Run benchmarks (728ms)</span><span id="8a0d" class="ls lt in lo b gy mi lv l lw lx">1 passed (1s)</span></pre><p id="fa7c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ‰€ä»¥é¡µé¢æˆåŠŸåŠ è½½äº†ï¼Œä½†æ˜¯æˆ‘ä»¬çœ‹ä¸åˆ°åŸºå‡†æµ‹è¯•çš„ç»“æœï¼Œè¿™æ²¡æœ‰å¤šå¤§ç”¨å¤„ï¼å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æ•è·å¹¶æ˜¾ç¤ºæ§åˆ¶å°è¾“å‡ºï¼Œæˆ‘ä»¬ä¹‹å‰é€šè¿‡ç›‘å¬æ¥è‡ªå‰§ä½œå®¶çš„<code class="fe mf mg mh lo b">console</code>äº‹ä»¶æ¥æŸ¥çœ‹åŸºå‡†æµ‹è¯•ç»“æœã€‚</p><p id="aca4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬è¿˜å¯ä»¥ä»Benchmark.js <code class="fe mf mg mh lo b">complete</code>äº‹ä»¶å‘å¸ƒæµ‹è¯•å¥—ä»¶å®Œæˆæ—¶çš„å·²çŸ¥æ¶ˆæ¯:</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="97c9" class="ls lt in lo b gy lu lv l lw lx">suite.on('complete', () =&gt; console.log('Benchmark suite complete.'))</span></pre><p id="1d78" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å¹¶åœ¨å…è®¸å‰§ä½œå®¶æµ‹è¯•å®Œæˆä¹‹å‰ç­‰å¾…å·²çŸ¥æ¶ˆæ¯ä»¥ç¡®ä¿åŸºå‡†å®Œæˆ:</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="5f30" class="ls lt in lo b gy lu lv l lw lx">let benchmarkPromise = new Promise(resolve =&gt; {<br/>  page.on('console', async message =&gt; {<br/>    if (message.text() === 'Benchmark suite complete.') {<br/>      // if the suite has finished, we're done<br/>      resolve();<br/>    } else {<br/>      // pipe through any other console output<br/>      console[message.type()](message);<br/>    }<br/>  });<br/>});</span></pre><blockquote class="ly lz ma"><p id="f3ce" class="jk jl mb jm b jn jo jp jq jr js jt ju mc jw jx jy md ka kb kc me ke kf kg kh ig bi translated">æ³¨æ„:ä½œä¸ºä¼˜ç§€çš„å¼€å‘äººå‘˜ï¼Œæˆ‘ä»¬æ˜¾ç„¶åº”è¯¥å°†ä»»ä½•ç¥å¥‡çš„å­—ç¬¦ä¸²æ”¾å…¥å…±äº«å¸¸é‡ä¸­ï¼Œä½†æˆ‘ä»¬åœ¨è¿™é‡Œè¿™æ ·åšåªæ˜¯ä¸ºäº†ä¿æŒç¤ºä¾‹ç®€å•ï¼</p></blockquote><p id="e74c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬ç°åœ¨å¯ä»¥<code class="fe mf mg mh lo b">await</code>åœ¨å‰§ä½œå®¶æµ‹è¯•ä¸­å®ç°è¿™ä¸€æ‰¿è¯ºï¼Œå½“æˆ‘ä»¬å†æ¬¡è¿è¡Œæµ‹è¯•è¿è¡Œç¨‹åºæ—¶ï¼Œæˆ‘ä»¬å°†åœ¨æ§åˆ¶å°ä¸Šçœ‹åˆ°åŸºå‡†æµ‹è¯•ç»“æœ:</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="7985" class="ls lt in lo b gy lu lv l lw lx">Running 1 test using 1 worker</span><span id="f191" class="ls lt in lo b gy mi lv l lw lx">âœ“  tests/bench.spec.js:3:1 â€º Run benchmarks (13s)<br/>Array.prototype.some x 133 ops/sec Â±0.89% (56 runs sampled)<br/>for loop x 1,724 ops/sec Â±0.62% (60 runs sampled)</span><span id="ea46" class="ls lt in lo b gy mi lv l lw lx">1 passed (13s)</span></pre><p id="31d9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆåŠŸï¼ğŸ‰é»˜è®¤æƒ…å†µä¸‹ï¼Œå‰§ä½œå®¶ä½¿ç”¨Chromiumå¼•æ“è¿è¡Œæµ‹è¯•ï¼Œå› æ­¤è¦åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸Šè¿è¡Œå®ƒä»¬ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä»¥ä¸‹ä»£ç :</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="51dc" class="ls lt in lo b gy lu lv l lw lx">npx playwright test --browser=all --workers=1</span></pre><p id="460f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mf mg mh lo b">browser</code>é€‰é¡¹é…ç½®åœ¨å“ªäº›æµè§ˆå™¨ä¸­è¿è¡Œæµ‹è¯•ï¼Œè€Œ<code class="fe mf mg mh lo b">all</code>å°†ä½¿ç”¨å‰§ä½œå®¶å¯ä»¥ä½¿ç”¨çš„æ‰€æœ‰æµè§ˆå™¨ã€‚æˆ‘ä»¬è¿˜åŒ…æ‹¬äº†<code class="fe mf mg mh lo b">--workers=1</code>,å› ä¸ºå‰§ä½œå®¶é»˜è®¤å¹¶è¡Œè¿è¡Œæµ‹è¯•ï¼Œä½†è¿™æ˜¾ç„¶ä¼šå½±å“æˆ‘ä»¬çš„æ€§èƒ½æµ‹è¯•ï¼Œæ‰€ä»¥è¿™ä¸ªé€‰é¡¹åªå…è®¸ä¸€ä¸ªå·¥äººå¼ºåˆ¶æµ‹è¯•ä¸²è¡Œè¿è¡Œã€‚æˆ‘ä»¬çš„è¾“å‡ºç°åœ¨çœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="8e2b" class="ls lt in lo b gy lu lv l lw lx">Running 3 tests using 1 worker</span><span id="96b2" class="ls lt in lo b gy mi lv l lw lx">âœ“  [chromium] â€º tests/bench.spec.js:3:1 â€º Run benchmarks (13s)<br/>Array.prototype.some x 140 ops/sec Â±1.14% (56 runs sampled)<br/>for loop x 1,793 ops/sec Â±0.99% (61 runs sampled)<br/>  âœ“  [firefox] â€º tests/bench.spec.js:3:1 â€º Run benchmarks (14s)<br/>Array.prototype.some x 224 ops/sec Â±0.53% (60 runs sampled)<br/>for loop x 242 ops/sec Â±1.10% (59 runs sampled)<br/>  âœ“  [webkit] â€º tests/bench.spec.js:3:1 â€º Run benchmarks (12s)<br/>Array.prototype.some x 757 ops/sec Â±22.39% (54 runs sampled)<br/>for loop x 1,756 ops/sec Â±1.27% (60 runs sampled)</span><span id="2667" class="ls lt in lo b gy mi lv l lw lx">3 passed (40s)</span></pre><p id="4cba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ‰€æœ‰ä¸‰ä¸ªæµè§ˆå™¨å¼•æ“çš„åŸºå‡†æµ‹è¯•ç»“æœã€‚æ­£å¦‚è¿™ä¸ªä¾‹å­æ‰€å¼ºè°ƒçš„ï¼Œå·®å¼‚å¯èƒ½æ˜¯å®è´¨æ€§çš„ï¼Œè¿™è¯æ˜äº†è¿è¡Œè¿™äº›æµ‹è¯•æ˜¯å¤šä¹ˆæœ‰ç”¨ï¼</p></div><div class="ab cl mj mk hr ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ig ih ii ij ik"><p id="8225" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™é‡Œæˆ‘ä»¬è¿˜å¯ä»¥åšæ›´å¤šçš„äº‹æƒ…ï¼Œä½†æ˜¯è¿™ç¯‡ä»‹ç»ä¸ºä½¿ç”¨å‰§ä½œå®¶åè°ƒè·¨æµè§ˆå™¨çš„æµ‹è¯•å¥ å®šäº†åŸºç¡€ã€‚ä»¥ä¸‹æ˜¯ä¸åŒæ–‡ä»¶çš„æœ€ç»ˆç‰ˆæœ¬ï¼Œä¾›å‚è€ƒ:</p><figure class="ky kz la lb gt lc"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="7e93" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mb">æ›´å¤šå†…å®¹è¯·çœ‹</em><a class="ae ki" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mb">plain English . io</em></strong></a></p></div></div>    
</body>
</html>