<html>
<head>
<title>How to Create a Pie Chart in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Angular中创建饼图</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-a-pie-chart-in-angular-33cc0354bde7?source=collection_archive---------7-----------------------#2021-02-25">https://javascript.plainenglish.io/how-to-create-a-pie-chart-in-angular-33cc0354bde7?source=collection_archive---------7-----------------------#2021-02-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4b10" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Angular中的数据可视化入门</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/54217b2f33559736548f6d59504a2f9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-ueDG7Kcvd06ECvM"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@adeolueletu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Adeolu Eletu</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3559" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据是21世纪的黄金，但要让数据有意义，必须很好地呈现给用户，让他们理解它。图表是展示数据的最佳方式之一。</p><p id="69dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本指南中，我们将了解如何使用Angular中的饼图向用户展示您的数据。我们将在ng2charts图书馆的帮助下完成这项工作。</p><p id="0bbf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ng2charts库基于著名的可视化库:chart.js。然而，与面向普通JavaScript的chart.js不同，ng2charts是专门为Angular开发的，因此，在使用Angular框架时，它更容易实现和使用。</p><h1 id="4dec" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">入门指南</h1><p id="3cb7" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们将从使用Angular CLI在Angular中创建新项目开始。我将我的项目命名为饼图。只需运行下面的命令来创建新项目。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="0554" class="mu lt iq mq b gy mv mw l mx my">$ ng new pie-chart --defaults</span></pre><h1 id="553e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">向项目添加依赖项</h1><p id="5b84" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在我们开始创建饼图之前。我们需要以npm包的形式添加绘制图表所需的三个依赖项。我们将要安装的npm包是<strong class="ky ir"> ng2-charts </strong>、<strong class="ky ir"> chart.js </strong>和<strong class="ky ir">chart js-plugin-data labels</strong>。</p><p id="aed8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将用下面的一个命令安装所有三个依赖项。确保在应用程序的根文件夹中运行该命令。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="6554" class="mu lt iq mq b gy mv mw l mx my">$ npm install ng2-charts chart.js chartjs-plugin-datalabels --save</span></pre><h1 id="b779" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">更新主模块文件</h1><p id="bc95" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">一旦你安装了上面需要的包，你需要从你的主模块文件中的ng2charts导入<strong class="ky ir"> <em class="mz"> ChartsModule </em> </strong>。在本例中，<strong class="ky ir"> <em class="mz"> app.module.ts文件</em> </strong>。</p><p id="0700" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了导入<strong class="ky ir">图表模块</strong>之外，将<strong class="ky ir">图表模块</strong>添加到导入模块的数组中。</p><p id="60af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您的<strong class="ky ir"><em class="mz">app . module . ts</em></strong>文件现在应该如下所示。唯一添加的代码是粗体的代码。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="90d0" class="mu lt iq mq b gy mv mw l mx my">import { BrowserModule } from '@angular/platform-browser';<br/>import { NgModule } from '@angular/core';<br/>import { AppComponent } from './app.component';<br/><strong class="mq ir">import { ChartsModule } from 'ng2-charts';</strong></span><span id="cb0d" class="mu lt iq mq b gy na mw l mx my">@NgModule({<br/>    declarations: [ AppComponent],<br/>    imports: [ BrowserModule, <strong class="mq ir">ChartsModule</strong>],<br/>    bootstrap: [AppComponent]<br/>})</span><span id="d9bb" class="mu lt iq mq b gy na mw l mx my">export class AppModule { }</span></pre><h1 id="59cd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">为图表创建画布</h1><p id="31dd" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在HTML5中，canvas元素用于绘制图形和表示动态或可脚本化的二维形状和图像。</p><p id="0dc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们将创建的饼图将被放置在一个<strong class="ky ir"> <em class="mz"> &lt;画布&gt; </em> </strong>元素<strong class="ky ir"> <em class="mz">中。</em>T29】</strong></p><p id="4d71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转到项目中的<strong class="ky ir"><em class="mz">app.component.html</em></strong>文件，删除模板中的所有代码，并用下面的样板代码替换。</p><p id="42d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了canvas元素，我们还将创建两个按钮来切换图例，并创建另一个按钮来将额外的饼图数据添加到饼图中。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="e099" class="mu lt iq mq b gy mv mw l mx my">&lt;div&gt;<br/>  &lt;canvas class="chart" baseChart<br/>   [data]="pieChartData"<br/>   [labels]="pieChartLabels"<br/>   [chartType]="pieChartType"<br/>   [options]="pieChartOptions"<br/>   [plugins]="pieChartPlugins"<br/>   [colors]="pieChartColors"<br/>   [legend]="pieChartLegend"&gt;<br/>  &lt;/canvas&gt;<br/>&lt;/div&gt;</span><span id="4388" class="mu lt iq mq b gy na mw l mx my">&lt;div&gt;<br/>   &lt;button (click)="pieChartLegend=!pieChartLegend"&gt;Toggle  Legend&lt;/button&gt;<br/>   &lt;button (click)="addSlice()"&gt;Add Slice&lt;/button&gt;<br/>&lt;/div&gt;</span></pre><p id="0344" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在canvas元素中，我们使用模板表达式来绑定组件文件中的值。请注意，我们将在这里使用硬编码的值，但是这些值可以很容易地用来自一些API或任何其他来源的动态数据替换。</p><h1 id="4081" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">向组件添加图表逻辑</h1><p id="02ad" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们现在将添加处理按钮事件的逻辑，以及要在图表中表示的数据的硬编码值。</p><p id="3b9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将下面的代码复制粘贴到组件文件中，即<strong class="ky ir"><em class="mz">app . component . ts .</em></strong></p><p id="6d91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从下面的代码中可以看出，我创建了两个负责处理按钮点击事件的方法。此外，我们还将处理图表上的鼠标悬停事件，以向饼图显示相应的数据。</p><p id="f9c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我还创建了几个公共变量，用于保存要在图表中表示的硬编码数据值。其他图表属性(如颜色和标签)也保存在这些变量中。</p><p id="865e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您的<strong class="ky ir"> <em class="mz"> app.component.ts </em> </strong>文件现在应该类似于下图。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="90d3" class="mu lt iq mq b gy mv mw l mx my">import { Component } from '@angular/core';<br/>import { ChartType, ChartOptions } from 'chart.js';<br/>import { Label } from 'ng2-charts';<br/>import * as pluginDataLabels from 'chartjs-plugin-datalabels';</span><span id="df06" class="mu lt iq mq b gy na mw l mx my">@Component({<br/>    selector: 'app-root',<br/>    templateUrl: './app.component.html',<br/>})</span><span id="32ed" class="mu lt iq mq b gy na mw l mx my">export class AppComponent {<br/>    title = 'pie-chart';<br/>    public pieChartOptions: ChartOptions = {<br/>        responsive: true,<br/>        legend: { position: 'top',},<br/>        <br/>       plugins: { <br/>          datalabels: { formatter: (value, ctx) =&gt; {<br/>          const label = ctx.chart.data.labels[ctx.dataIndex];      return label;},<br/>   },<br/>  }<br/>};</span><span id="3e69" class="mu lt iq mq b gy na mw l mx my">public pieChartLabels: Label[] = [['Download', 'Sales'], ['In',   'Store', 'Sales'], 'Mail Sales'];<br/>public pieChartData: number[] = [300, 500, 100];<br/>public pieChartType: ChartType = 'pie';<br/>public pieChartLegend = true;<br/>public pieChartPlugins = [pluginDataLabels];</span><span id="eca3" class="mu lt iq mq b gy na mw l mx my">public pieChartColors = [{ backgroundColor: ['rgba(255,0,0,0.3)', 'rgba(0,255,0,0.3)', 'rgba(0,0,255,0.3)'],<br/>},];</span><span id="95d8" class="mu lt iq mq b gy na mw l mx my">public chartHovered({ event, active }: { event: MouseEvent, active:   {}[] }): void { console.log(event, active);<br/>}</span><span id="e171" class="mu lt iq mq b gy na mw l mx my">addSlice(): void {<br/>    this.pieChartLabels.push(['Line 1', 'Line 2', 'Line 3']);<br/>    this.pieChartData.push(400);<br/>this.pieChartColors[0].backgroundColor.push('rgba(196,79,244,0.3)');  }<br/>}</span></pre><h1 id="e77b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">运行应用程序</h1><p id="1305" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果您按照本指南中的说明连接了所有设备。现在，您可以测试并运行您的应用程序了。</p><p id="e57d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要为应用程序提供服务，只需从应用程序的根文件夹中运行以下命令。我添加了<code class="fe nb nc nd mq b">-o</code>标志，这样应用程序就可以在你的默认浏览器中自动打开。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="d1d0" class="mu lt iq mq b gy mv mw l mx my">$ ng serve -o </span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/176761ad2ca8a12200c14e58922ad8b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*i0p01Pg0MxovYpp8X9R7Cw.gif"/></div></figure><h1 id="6abd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">最后的想法</h1><p id="8c89" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在使用Angular框架时，可以使用许多库来增强对用户的数据表示。Chart.js是一个强大的动态开源库，可以用来可视化数据。</p><p id="4ef7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mz">阅读更多尽在</em> <a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="mz">说白了. io </em> </strong> </a></p></div></div>    
</body>
</html>