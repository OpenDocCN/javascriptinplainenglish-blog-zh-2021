<html>
<head>
<title>Getting Started with Creating Static Sites with Gatsby.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开始使用Gatsby.js创建静态站点</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/getting-started-with-creating-static-sites-with-gatsby-js-fbdcae9c5f11?source=collection_archive---------8-----------------------#2021-02-06">https://javascript.plainenglish.io/getting-started-with-creating-static-sites-with-gatsby-js-fbdcae9c5f11?source=collection_archive---------8-----------------------#2021-02-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/09321bcd93ca4cdac5282f532c5a031b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g0Ve1DAmvk1334nQ"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@samjbrowne?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sam Browne</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7bd7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Gatsby是一个基于React的静态网站框架。</p><p id="f7a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用它从外部数据源创建静态网站等等。</p><p id="fb08" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用Gatsby创建一个站点。</p><h1 id="2175" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">安装Gatsby CLI</h1><p id="be80" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="cdd3" class="mn lc iq mj b gy mo mp l mq mr">npm install -g gatsby-cli</span></pre><p id="cd4b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装Gatsby命令行界面。</p><h1 id="62d9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建新网站</h1><p id="b022" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">一旦我们安装了Gatsby CLI，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="69e2" class="mn lc iq mj b gy mo mp l mq mr">gatsby new gatsby-site https://github.com/gatsbyjs/gatsby-starter-hello-world</span></pre><p id="079d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让Gatsby CLI创建一个项目。</p><p id="25a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过运行dev服务器开始开发:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="4b90" class="mn lc iq mj b gy mo mp l mq mr">cd gatsby-site<br/>gatsby develop</span></pre><p id="1041" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们进行更改时，我们将看到显示的最新更改。</p><h1 id="851f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建生产版本</h1><p id="2db3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了创建生产构建，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e40e" class="mn lc iq mj b gy mo mp l mq mr">gatsby build</span></pre><p id="99d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了服务于本地的生产构建，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="4f01" class="mn lc iq mj b gy mo mp l mq mr">gatsby serve</span></pre><h1 id="7e9e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">页</h1><p id="c89b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们将页面添加到<code class="fe ms mt mu mj b">src/pages</code>文件夹中。</p><p id="e3d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe ms mt mu mj b">Link</code>组件链接页面。</p><p id="f169" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="cc43" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">src/pages/foo.js</code></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e3e4" class="mn lc iq mj b gy mo mp l mq mr">import { Link } from "gatsby"<br/>import React from "react"</span><span id="7390" class="mn lc iq mj b gy mv mp l mq mr">export default function Foo() {<br/>  return &lt;&gt;<br/>    &lt;Link to='/foo'&gt;foo&lt;/Link&gt;<br/>    &lt;Link to='/bar'&gt;bar&lt;/Link&gt;<br/>    &lt;div&gt;foo&lt;/div&gt;<br/>  &lt;/&gt;<br/>}</span></pre><p id="2a59" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">src/pages/bar.js</code></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2f7d" class="mn lc iq mj b gy mo mp l mq mr">import React from "react"<br/>import { Link } from "gatsby"</span><span id="5799" class="mn lc iq mj b gy mv mp l mq mr">export default function Bar() {<br/>  return &lt;&gt;<br/>    &lt;Link to='/foo'&gt;foo&lt;/Link&gt;<br/>    &lt;Link to='/bar'&gt;bar&lt;/Link&gt;<br/>    &lt;div&gt;bar&lt;/div&gt;<br/>  &lt;/&gt;<br/>}</span></pre><p id="68b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加了<code class="fe ms mt mu mj b">Link</code>组件，链接到页面将被添加。</p><p id="8a5a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">URL路径由文件名决定。</p><p id="754a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以<code class="fe ms mt mu mj b">foo.js</code>映射到<code class="fe ms mt mu mj b">/foo</code>，而<code class="fe ms mt mu mj b">bar.js</code>映射到<code class="fe ms mt mu mj b">/bar</code>。</p><h1 id="1bea" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">布局</h1><p id="01b8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用Gatsby创建一个布局组件，在多个页面之间添加共享的标记、样式和功能。</p><p id="7e3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><p id="4eed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">src/components/layout.js</code></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7fcc" class="mn lc iq mj b gy mo mp l mq mr">import { Link } from "gatsby"<br/>import React from "react"</span><span id="09f0" class="mn lc iq mj b gy mv mp l mq mr">export default function Layout({ children }) {<br/>  return (<br/>    &lt;div style={{ margin: `0 auto`, maxWidth: 650, padding: `0 1rem` }}&gt;<br/>      &lt;Link to='/foo'&gt;foo&lt;/Link&gt;<br/>      &lt;Link to='/bar'&gt;bar&lt;/Link&gt;<br/>      {children}<br/>    &lt;/div&gt;<br/>  )<br/>}</span></pre><p id="4e5b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">src/pages/foo.js</code></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e036" class="mn lc iq mj b gy mo mp l mq mr">import React from "react"<br/>import Layout from "../components/layout"</span><span id="c4ac" class="mn lc iq mj b gy mv mp l mq mr">export default function Foo() {<br/>  return &lt;Layout&gt;<br/>    &lt;div&gt;foo&lt;/div&gt;<br/>  &lt;/Layout&gt;<br/>}</span></pre><p id="c4a4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">src/pages/bar.js</code></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1633" class="mn lc iq mj b gy mo mp l mq mr">import React from "react"<br/>import Layout from "../components/layout"</span><span id="e4b7" class="mn lc iq mj b gy mv mp l mq mr">export default function Bar() {<br/>  return &lt;Layout&gt;<br/>    &lt;div&gt;bar&lt;/div&gt;<br/>  &lt;/Layout&gt;<br/>}</span></pre><p id="c912" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe ms mt mu mj b">Link</code>组件移到了<code class="fe ms mt mu mj b">layout.js</code>，这样我们就可以在一个地方引用所有内容。</p><p id="113c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe ms mt mu mj b">Layout</code>组件中，我们有<code class="fe ms mt mu mj b">children</code>属性来呈现包装在<code class="fe ms mt mu mj b">Layout</code>组件中的子组件。</p><h1 id="d0a0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用createPage以编程方式创建页面</h1><p id="467d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过编程来创建页面。</p><p id="1ff1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><p id="9a76" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">gatsby-node.js</code></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="031c" class="mn lc iq mj b gy mo mp l mq mr">exports.createPages = ({ actions }) =&gt; {<br/>  const { createPage } = actions<br/>  const dogData = [<br/>    {<br/>      name: "fido",<br/>      breed: "Sheltie",<br/>    },<br/>    {<br/>      name: "sparky",<br/>      breed: "Corgi",<br/>    },<br/>  ]<br/>  dogData.forEach(dog =&gt; {<br/>    createPage({<br/>      path: `/${dog.name}`,<br/>      component: require.resolve(`./src/templates/dog-template.js`),<br/>      context: { dog },<br/>    })<br/>  })<br/>}</span></pre><p id="32f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">src/templates/dog-template.js</code></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1301" class="mn lc iq mj b gy mo mp l mq mr">import React from "react"</span><span id="9c2a" class="mn lc iq mj b gy mv mp l mq mr">export default function DogTemplate({ pageContext: { dog } }) {<br/>  return (<br/>    &lt;section&gt;<br/>      {dog.name} - {dog.breed}<br/>    &lt;/section&gt;<br/>  )<br/>}</span></pre><p id="0cb8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们导出<code class="fe ms mt mu mj b">createPages</code>函数。</p><p id="8229" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在函数内部，我们用页面的<code class="fe ms mt mu mj b">path</code>调用<code class="fe ms mt mu mj b">actions.createPage</code>函数。</p><p id="0ddb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">component</code>拥有我们想要呈现数据的模板。</p><p id="532e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">context</code>有我们想要渲染的数据。</p><p id="3332" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe ms mt mu mj b">dog-template.js</code>中，我们从<code class="fe ms mt mu mj b">pageContext</code>道具中获取数据并渲染它们。</p><p id="78db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，当我们转到<a class="ae kc" href="http://localhost:8000/fido" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/fido</a>时，我们看到:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="42e3" class="mn lc iq mj b gy mo mp l mq mr">fido - Sheltie</span></pre><p id="ac19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们转到<a class="ae kc" href="http://localhost:8000/sparky" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/sparky</a>时，我们会看到:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3be5" class="mn lc iq mj b gy mo mp l mq mr">sparky - Corgi</span></pre><h1 id="0588" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="e4fc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用Gatsby.js手动和自动添加页面</p><p id="e4c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果是这样，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>