<html>
<head>
<title>Authentication and Onboarding Flow in React Native: A Step-by-Step Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Native中的身份验证和入职流程:分步指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/step-by-step-guide-to-authentication-and-onboarding-flow-in-react-native-32663b80eefc?source=collection_archive---------1-----------------------#2021-10-23">https://javascript.plainenglish.io/step-by-step-guide-to-authentication-and-onboarding-flow-in-react-native-32663b80eefc?source=collection_archive---------1-----------------------#2021-10-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="1c52" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对任何应用程序来说，最常见的要求之一是拥有一个同时包含入职的身份验证流程。流程如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/49de9476cf83af399556de763b13ffd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PZ7e0DlPIRdhw_AVh1NOrA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">auth-onboarding flow</figcaption></figure><ul class=""><li id="b1a9" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh ld le lf lg bi translated">当用户打开app时，我们首先需要检查用户是否是我们系统中的登录用户，根据这个条件他们可以去两个不同的流程；</li><li id="2e90" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh ld le lf lg bi translated">如果用户之前已经登录，他们将进入应用程序屏幕。例如-主屏幕、个人资料屏幕等。</li><li id="ed66" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh ld le lf lg bi translated">如果用户是新用户或已注销用户，他们将转到身份验证屏幕，例如登录页面、注册页面等。</li><li id="80bd" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh ld le lf lg bi translated">对于一个全新的用户，当他们第一次注册时，我们也希望向他们展示一个入门屏幕，通常我们会在那里展示应用的主要功能/优势或应用的操作指南。完成入职培训屏幕后，他们将继续进入应用程序的主屏幕。(登录流程)</li></ul><h1 id="afc2" class="lm ln in bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">设置屏幕</h1><p id="3685" class="pw-post-body-paragraph jk jl in jm b jn mk jp jq jr ml jt ju jv mm jx jy jz mn kb kc kd mo kf kg kh ig bi translated">我们将创建几个虚拟屏幕来正确显示流程。我们会有-</p><ol class=""><li id="b9ba" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh mp le lf lg bi translated">登陆屏幕</li><li id="9119" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh mp le lf lg bi translated">登录屏幕</li><li id="5ab0" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh mp le lf lg bi translated">注册屏幕</li><li id="1ce9" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh mp le lf lg bi translated">入职屏幕</li><li id="2d64" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh mp le lf lg bi translated">主屏幕</li></ol><p id="0344" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果我们想要描述屏幕流，那么它看起来会像下面这样-</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/1c250114ab6f8dee96efb5aeaaf67ada.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*pNanA2QY9cFuNoQbXZPLTw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">screens</figcaption></figure><h1 id="a3c6" class="lm ln in bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">授权上下文</h1><p id="c78a" class="pw-post-body-paragraph jk jl in jm b jn mk jp jq jr ml jt ju jv mm jx jy jz mn kb kc kd mo kf kg kh ig bi translated">为了管理用户认证流，我们将使用上下文。让我们从创建我们的AuthContext开始。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/239ec265a986bcf15c8a3b591a0d4c59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9ju8SxX2UlPnQQxO.png"/></div></div></figure><p id="42b9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了举例，我们将尽量保持简单。我们创建auth context，并从上下文提供者向整个应用程序传递2个值。这些值是</p><ul class=""><li id="7f87" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh ld le lf lg bi translated"><code class="fe ms mt mu mv b">isLoggedIn</code> -这是一个布尔值，让我们知道我们的用户是否登录。</li><li id="129d" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh ld le lf lg bi translated"><code class="fe ms mt mu mv b">setIsLoggedIn</code> -根据登录流程将<code class="fe ms mt mu mv b">isLoggedIn</code>状态设置为真或假。</li></ul><p id="974a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们用AuthProvider包装这个应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/acc8bdd234658ba5d31f7b9b4edf2d5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VJd8IZVYzxUHSzv_.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">app.js</figcaption></figure><h1 id="11a1" class="lm ln in bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">根组件</h1><p id="a0a7" class="pw-post-body-paragraph jk jl in jm b jn mk jp jq jr ml jt ju jv mm jx jy jz mn kb kc kd mo kf kg kh ig bi translated">设置完成后，我们现在将设置我们的屏幕。我们的初始组件是Root。在我们的根目录中，我们将检查用户是否登录。根据我们上下文中的isLoggedIn值，我们将把用户重定向到正确的流。</p><p id="538e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最初，我们的根组件看起来像这样</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/dd26e05eb94cbc9ffeccf834c390ada5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qBo9KbY-AD_meD4A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">root component</figcaption></figure><h1 id="1761" class="lm ln in bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">注册</h1><p id="fbcd" class="pw-post-body-paragraph jk jl in jm b jn mk jp jq jr ml jt ju jv mm jx jy jz mn kb kc kd mo kf kg kh ig bi translated">我们将首先设置登录流程。在我们的登录界面。</p><ol class=""><li id="682c" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh mp le lf lg bi translated">我们将有一个名为登录的按钮，当按下该按钮时，我们将使用<code class="fe ms mt mu mv b">setIslogged</code>将我们上下文中的<code class="fe ms mt mu mv b">isLoggedIn</code>状态设置为<code class="fe ms mt mu mv b">true</code>。</li><li id="a187" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh mp le lf lg bi translated">当<code class="fe ms mt mu mv b">isLoggedIn</code>变为真时，用户将自动导航到<code class="fe ms mt mu mv b">HomeScreen</code>。我们已经在<code class="fe ms mt mu mv b">Root</code>中设置好了。</li><li id="35d9" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh mp le lf lg bi translated">我们还使用<code class="fe ms mt mu mv b">AsyncStorage</code>来持久化一个虚拟令牌值，这样当用户关闭应用程序时，我们可以使用持久化值来知道他们是否已经登录。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/a7d364d9df49b69e7cea2c48205b6a2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aa9rRnHJMvrmCd4I.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">login</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/ca020c71760dad6bdec317d65b4f1e2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/0*fp6l8x1-5-eeNaci.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">login</figcaption></figure><h1 id="6934" class="lm ln in bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">注册和入职</h1><p id="9f45" class="pw-post-body-paragraph jk jl in jm b jn mk jp jq jr ml jt ju jv mm jx jy jz mn kb kc kd mo kf kg kh ig bi translated">对于新用户，我们希望他们注册并完成入职流程。一旦他们完成入职流程，我们希望他们转到主应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/9215a4470a5baed05ba11701015bda7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*I8R-ulYwFM8OKTl8.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">signup</figcaption></figure><ul class=""><li id="fea5" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh ld le lf lg bi translated">假设我们在注册屏幕上有一个按钮，单击该按钮注册成功，我们将用户导航到入职屏幕</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/f2e37f003dcb9ecabef978ac050877e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ONyEfupYyxM50qV2.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">onboarding</figcaption></figure><ul class=""><li id="20cf" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh ld le lf lg bi translated">入职屏幕与登录屏幕完全相同。它使isLoggedIn值为真，并在我们的异步存储中保存一个虚拟令牌。当它将“isLoggedIn”设置为true时，用户将自动转到主应用程序。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/8d34e2cf75f00cf2e6da6649a55b980e.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/0*DkyWLzetUiyMqS2q.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">signup — onboarding</figcaption></figure><h1 id="3d20" class="lm ln in bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">主页和注销</h1><p id="b3bd" class="pw-post-body-paragraph jk jl in jm b jn mk jp jq jr ml jt ju jv mm jx jy jz mn kb kc kd mo kf kg kh ig bi translated">在我们的主屏幕上，我们将有一个注销按钮。如果用户点击注销按钮，我们将做两件事</p><ol class=""><li id="a345" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh mp le lf lg bi translated">使<code class="fe ms mt mu mv b">isLoggedIn</code>为假</li><li id="cc7c" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh mp le lf lg bi translated">从我们的异步存储中删除虚拟令牌</li><li id="e07d" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh mp le lf lg bi translated">当我们将<code class="fe ms mt mu mv b">isLoggedIn</code>设为假时，用户将自动转到<code class="fe ms mt mu mv b">LandingScreen</code></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/cc264e5236a657e55030b6fc51fb0dca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hulgtcZ2xcsxCeal.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">home</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/77609bc112ebef60c8257cf8354605a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/0*BOkr7EixLE3MgjsA.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">home-logout</figcaption></figure><h1 id="aa1c" class="lm ln in bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">检查用户是否从异步存储登录</h1><p id="5d40" class="pw-post-body-paragraph jk jl in jm b jn mk jp jq jr ml jt ju jv mm jx jy jz mn kb kc kd mo kf kg kh ig bi translated">每当用户登录或注册时，我们都在我们的中保存一个虚拟令牌来保存它。我们希望保留令牌，因为如果用户关闭应用程序并在稍后返回我们的应用程序，我们希望让他们保持相同的状态。我们将在根组件中进行这种检查。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/a12db2f8b1b456d2a0242d5bb552cd92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hqEeOuyd2h8DjUNT.png"/></div></div></figure><ol class=""><li id="1d79" class="ky kz in jm b jn jo jr js jv la jz lb kd lc kh mp le lf lg bi translated">当我们的组件第一次加载时，我们试图从异步存储中获取令牌，如果找到令牌，那么我们通过调用<code class="fe ms mt mu mv b">setIsLoggedIn(true)</code>使<code class="fe ms mt mu mv b">isLoggedIn</code>值为真</li><li id="a060" class="ky kz in jm b jn lh jr li jv lj jz lk kd ll kh mp le lf lg bi translated">我们还使用加载器状态，因为获取令牌是异步的，我们需要等待并显示一个加载指示器，直到检查完成。</li></ol><p id="93fb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，让我们来看看实际情况，我们将首先登录，关闭应用程序，然后再次返回应用程序。我们的用户应该仍然在主屏幕上，而不是在登陆屏幕上。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/f0774dee1779f44869349dc0ca3f5ba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/0*e-vWo3ElsBpGd4N4.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">full-flow</figcaption></figure><p id="f900" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这样我们的完整流程就完成了！这里是零食<a class="ae mz" href="https://snack.expo.dev/@saad-bashar/authentication-flow" rel="noopener ugc nofollow" target="_blank">链接</a>如果有人想抢码。谢谢！</p><p id="0c65" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="na">更多内容请看</em><a class="ae mz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="na">plain English . io</em></strong></a></p></div></div>    
</body>
</html>