<html>
<head>
<title>Build a Custom Date Input Component in Vue.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Vue.js中构建一个自定义日期输入组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/building-a-custom-date-input-component-in-vue-js-b5641b7b7c2b?source=collection_archive---------7-----------------------#2021-11-23">https://javascript.plainenglish.io/building-a-custom-date-input-component-in-vue-js-b5641b7b7c2b?source=collection_archive---------7-----------------------#2021-11-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/f676f91a8020454c2394ff25e0b38cdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TWX0_OR0nf0PMbLA"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@waldemarbrandt67w?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Waldemar Brandt</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4bb2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最近，我们有理由重新设计收集生日的方式(以及在塞拉菲恩的其他日期)。虽然默认的浏览器实现在开始时可以做到这一点，但我们面临着几个问题:</p><ol class=""><li id="de09" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">并非所有浏览器的实现都是一致的。</li><li id="8224" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">大多数浏览器打开的日历输入都聚焦于今天的日期，这让我们的用户很难输入他们的生日。</li></ol><p id="5784" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们决定创建日期输入组件来解决这个问题(使用Vue.js)。</p><p id="86a9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">虽然结果非常好，但它确实让我问自己，如果我们用普通的Javascript编写相同的行为，会有什么不同。</p><p id="5f38" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，这是本系列的第一篇文章，展示了我在Vue.js. <a class="ae jz" href="https://pablo-curell-mompo.medium.com/bulding-a-custom-date-component-using-vanilla-javascript-4cb6e8f547a" rel="noopener">中的自定义日期组件。在第二部分</a>中，我们将探索如何用普通的javascript构建相同的组件，我们将通过比较这两者来结束本系列。</p><h1 id="5ebc" class="lm ln in bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">规格</h1><p id="2b83" class="pw-post-body-paragraph ka kb in kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">我们的DateInput组件的规范表现为浏览器上的本地日期输入减去日历选择，即:</p><ul class=""><li id="fb56" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx mp le lf lg bi translated">我们只能输入两位数来表示日和月。</li><li id="0d8f" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx mp le lf lg bi translated">我们只能输入四位数的年份。</li><li id="dd13" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx mp le lf lg bi translated">这一天应该在1到31之间</li><li id="8fca" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx mp le lf lg bi translated">月份应该在1到12之间</li><li id="aa14" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx mp le lf lg bi translated">年份应该在1900年到2100年之间(这个是我们的，不是浏览器的)</li><li id="35a6" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx mp le lf lg bi translated">我们需要通过直接输入数字或者用箭头键上下移动来输入日期。</li><li id="9816" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx mp le lf lg bi translated">如果我们用箭头键输入日期，并达到上限或下限，显示的数字应该循环。</li><li id="e79c" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx mp le lf lg bi translated">如果我们通过输入数字来输入日期，输入应该是有边界的(max(输入，高边界)或min(输入，低边界)</li><li id="0faf" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx mp le lf lg bi translated">我们应该以直观的方式让用户进入下一个领域。</li><li id="51b6" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx mp le lf lg bi translated">我们应该证实日期是正确的。</li></ul><h1 id="46a0" class="lm ln in bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">Vue.js中的DateInput组件</h1><p id="5483" class="pw-post-body-paragraph ka kb in kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">下面是日期输入的代码(你也可以在这里找到<a class="ae jz" href="https://github.com/pablocm90/learning/blob/main/dateinput/vue-example/src/components/DateInput.vue" rel="noopener ugc nofollow" target="_blank"/>)。你应该能够复制粘贴它，并使用它:)</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mq"><img src="../Images/85ad91660d27208cb715e1bc70a8b5b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0X8s4QXTIV9Ooy_VXn1srA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Code of DateInput.vue</figcaption></figure><h1 id="6b2e" class="lm ln in bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">关注关键要素:</h1><p id="b84b" class="pw-post-body-paragraph ka kb in kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">日、月和年的逻辑是相似的，所以让我们深入研究一下如何处理用户输入。</p><p id="11d0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">三个输入中的每一个都有两条路径:</p><h2 id="5bde" class="mv ln in bd lo mw mx dn ls my mz dp lw kl na nb ma kp nc nd me kt ne nf mi ng bi translated">增量{日|月|年}(键)</h2><p id="5a09" class="pw-post-body-paragraph ka kb in kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">当我们使用箭头键时，可以访问该路径，并且将:</p><ol class=""><li id="c05f" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">根据您按下的箭头键，将该值增加或减少1。</li></ol><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nh"><img src="../Images/7922b9162fa8fdd4cea0674d0aeaa416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EZN_o5Uidaso__FTqzJ8fw.png"/></div></div></figure><p id="ce93" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">2.查看它是否在允许的值范围内，并相应地循环。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ni"><img src="../Images/0fd824b40cd60d2ef8cc03e2751687da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SFoD3_VaHiau--1rijPM0g.png"/></div></div></figure><p id="b3ff" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">3.设置数值的格式，使其具有正确的位数。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nj"><img src="../Images/3ca351da00517421a08e29c978d6e333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C0SyRvmEcqpZW8t-jJig8A.png"/></div></div></figure><h2 id="c3e2" class="mv ln in bd lo mw mx dn ls my mz dp lw kl na nb ma kp nc nd me kt ne nf mi ng bi translated">处理{日|月|年}(值)</h2><p id="47c9" class="pw-post-body-paragraph ka kb in kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">正如您所看到的，当用户通过输入数字来输入日期值时，事情会变得更加复杂。让我们剖析一下正在发生的事情:</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/64fc2c98fca4fca573f14798c6a7ab6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L7qTw5YJ9HtYcmGVA_sPHA.png"/></div></div></figure><ol class=""><li id="d84c" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">我们查看新值是否在允许的最大值和最小值范围内。</li></ol><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/f00bea0f4a299ac6c13fc80f0e38b832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ktkBlGkGeLh_zuYHKBP2w.png"/></div></div></figure><p id="74cf" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">2.如果日值大于3，或者月值大于1(并且这些值足够长)，我们设置一个标志，在最后转到下一个字段。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/04b57532f47b290ad543b3bed9b6d6e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b8xRd204RK0Iz0lQDY1YDQ.png"/></div></div></figure><p id="f6f4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">3.我们将该值格式化为正确的数字。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nj"><img src="../Images/3ca351da00517421a08e29c978d6e333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C0SyRvmEcqpZW8t-jJig8A.png"/></div></div></figure><p id="a410" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">4.我们在现场检查错误。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/3bcba469cc9106bb1bc8890ab64a56c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mN6fWRQTxh4NaY0WTvkeWA.png"/></div></div></figure><p id="3a8d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">5.如果前面讨论的标志为真，我们传递到下面的字段。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/59ba6fa508b3f6a51ac0e92dc44fa199.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eCWRW9DbGGowRTgPfyp8FQ.png"/></div></div></figure><h2 id="d202" class="mv ln in bd lo mw mx dn ls my mz dp lw kl na nb ma kp nc nd me kt ne nf mi ng bi translated">错误检查</h2><p id="6d13" class="pw-post-body-paragraph ka kb in kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">有一个小的复杂问题，当我们想要查看用户是否输入了正确的日期时，我们需要有点厚脸皮。例如，用户不能输入30/02/1990作为有效日期。</p><p id="5083" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您可能会认为“新日期(' 30–02–1990 ')在不同浏览器之间的行为是一致的，但是您错了。</p><p id="4a56" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">至少在Firefox和Chrome之间存在差异。</p><pre class="mr ms mt mu gt nn no np nq aw nr bi"><span id="3fc1" class="mv ln in no b gy ns nt l nu nv">// Firefox =&gt;</span><span id="9be5" class="mv ln in no b gy nw nt l nu nv">new Date(‘30–02–1990’) =&gt; Error Date Invalid</span><span id="2f41" class="mv ln in no b gy nw nt l nu nv">// Chrome</span><span id="36b7" class="mv ln in no b gy nw nt l nu nv">new Date(‘30–02–1990’) =&gt; 02/03/1990</span></pre><p id="53e5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，为了验证正确的日期，我们在模糊年份输入时使用computeDateError:</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ni"><img src="../Images/9e96ce5a9bf4b404f2a5a4fb1bc9f02a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HhpDPiT1Eoaqlr-mepKaLA.png"/></div></div></figure><p id="0b7e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">简而言之，如果日期抛出异常，我们将为错误返回true。如果日期没有抛出异常，我们检查日期是否相同。</p><h1 id="f01e" class="lm ln in bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">我应该用这个吗？</h1><p id="be1e" class="pw-post-body-paragraph ka kb in kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">如果您正在使用Vue.js，并且不想导入一个奇特的日期选择器库，或者只是想要一个没有让用户使用日期选择器的选项的输入，这是一个相当容易实现并且使用直观的方法。</p><p id="e26b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果可能的年份范围相对较大(因为在日期选择器中更改年份通常很麻烦)，那么与日期选择器相比，该组件甚至更有帮助。</p><h1 id="57bd" class="lm ln in bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">结论</h1><p id="31ea" class="pw-post-body-paragraph ka kb in kc b kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt mo kv kw kx ig bi translated">在Vue.js中制作一个定制的日期组件相当复杂，但最终相当简单(我们花了大约3-4天来实现，我们花在这上面的大部分时间是搞清楚规格和重构我们的代码。</p><p id="867e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果使用日期选择器对用户来说有问题，您也许可以使用这样的组件。</p><p id="a6b1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请继续关注第2部分，并在Twitter上关注<a class="ae jz" href="https://twitter.com/PCurell" rel="noopener ugc nofollow" target="_blank"> @pcurell </a>以了解我何时发布它:)</p><p id="8f14" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="nx">更多内容看</em> <a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="nx">说白了。在这里注册我们的</em> </a><a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="nx">免费周报</em> </a> <em class="nx">。</em></p></div></div>    
</body>
</html>