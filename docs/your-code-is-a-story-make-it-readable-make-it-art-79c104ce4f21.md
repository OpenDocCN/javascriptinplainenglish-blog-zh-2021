# 你的代码是一个故事。让它具有可读性。让它成为艺术。

> 原文：<https://javascript.plainenglish.io/your-code-is-a-story-make-it-readable-make-it-art-79c104ce4f21?source=collection_archive---------9----------------------->

## 让你的代码读起来充满乐趣。

![](img/59dd269607b9c8a575a641a71d5c4a50.png)

By [fizkes](https://www.shutterstock.com/g/fizkes) on [Shutterstock](https://www.shutterstock.com/image-photo/thoughtful-serious-young-indian-ethnic-woman-1606120330)

有无数的“编码最佳实践”的文章，一般都是这样说的:

*   整理你的文件。
*   分解大型函数。
*   给事物起个好名字。

但他们似乎忽略了一个更大的统一概念。

代码是由人类阅读的。

如果我们把我们的代码看作是像故事一样可以阅读的东西，而不仅仅是像指令一样可以解释的东西，我们可以使它更容易返回，以便以后理解。

# 什么是“好的函数？”

编程中最难的部分之一是找出粗粒度和细粒度函数和方法的正确平衡。什么时候 2 行函数才有意义？一个 100 行的函数？

根据我的经验，可以归结为:

> 如果有人能用一个简单的句子理解一个函数的作用，那么这个函数就是一个“好函数”。

如果我不得不停下来解释它，或者如果我使用的句子太模糊，我需要重写它。我认为 JavaScript 中“好函数”的一些例子:

这些可能会写得更好，并使用不同的算法，但想法是，每一个持有一个单一的，简单的概念。告诉我两个数组是否相等。`getUserProfile`获取用户的个人资料。`createCommentThreadedPosts` …你明白了。

如果一个功能试图做太多的事情，或者有太多的活动部分，那么分解它可能是有意义的。即使一个函数只使用一次，如果将代码放入该函数中可以更容易地理解原来的函数，如果这些代码作为一个想法都属于一个整体，那么创建新函数是有意义的。

同时，如果一个函数字面上重命名一个简单的操作，比如

```
function isFunction(fn) {
  return !!fn && (typeof fn === 'function' || fn instancof Function);
}
```

它可能不需要成为自己的函数。通过在包装函数中隐藏公共操作来创建一种全新的编程语言可能太容易了，除了编写这种语言的传统语言之外，新开发人员还需要学习这种元语言。

# 将代码分解成段落

当我们在一个地方有太多的代码时，我们可能会把它分成更小的函数或方法，这样我们在一个地方可以看到的就更少了。但是当进一步分解一个函数没有意义的时候呢？(世上有过犹不及的事。)

使用空白来制作“代码段落”

你能重新安排你的代码，让给定进程的所有语句都在一起吗？它们有共同的主题吗？如果是这样，在它们周围留白。

作为一堆代码行，每个“代码段”都有一个主题。它可以简单到“这是函数的初始化部分。”"这个循环转换我的数据.""这是我从数据库收集数据的地方."

其中的每一个都可能是它自己的方法或函数，但这可能会使它更难阅读，在函数之间来回跳跃。通过在每段之间放置一个空行，你给读者一个停顿的机会。你告诉他们是时候喘口气，准备接受新的思路了。这让他们在进入一个新的想法之前吸收以前的想法。

你可以在上面的`arraysEqual`方法中看到这一点。在每个早期返回测试之后添加一行空白。这让读者停下来说，“好吧，这是一个出口。给我一点时间回到实际的功能目的。”

在这种情况下，大多数函数*是*的早期返回测试，所以有很多空白，但那是因为这个函数的特殊性质。不过，希望它说明了空白是如何影响函数的读取流程的。

# 注意复杂的句子。

构建真正复杂的表达式可能非常容易。阅读一个复杂的表达式和阅读一个复杂的句子一样费力。看看下面的密码检查:

Keep on scrolling….

这里发生了很多事情，尽管没有一件事情是复杂的，但像这样写它需要在条件通过时，在开始做什么之前，把所有事情都记在脑子里。

在这种情况下，它可以帮助将所有内容拆分成自己的表达式，然后在最后将它们组合起来:

这里有很多陈述，但是每个陈述都描述了它自己。而且，如果您只关心条件在做什么，那么在检查密码是否有效之后，您可以立即看到表单提交发生了。不需要动脑筋，除非你想研究到底是什么让密码有效。

类似地，可以很容易地将函数链接在一起，从一长串操作中创造奇迹:

这是一个将句子拆分成单词的功能，跟踪单词的大写和小写版本，根据小写版本过滤掉文章，然后将句子重新连接在一起。

在一份声明中。

这其实不是*那个*疯狂的一种说法。我们可以一行一行地读，看看每一行做了什么。它正在处理的数据相当简单。

但是当对来自服务器的复杂对象进行同样的链接，过滤并转换它以呈现给用户时，这种链接会变得相当混乱。

当链变得太长时，或者当转换变得太混乱时，将链分成更小的部分，或者独立地定义转换器是有帮助的:

比较长，但是每个句子都构建了自己完整的故事。对于这个例子来说，这可能太复杂了，但是考虑一下，例如，如果`buildWordCaseObject`是一个 15 行的`transformServerData`函数。

# 箭头函数还是传统函数？

这更多是特定于 JavaScript 的，但是我通常使用`function`作为 JavaScript 模块的主要函数。它让我更容易识别“这是一个函数”，而不必在初始变量和参数名后寻找箭头。

由于函数提升，使用`function`还可以让我在主函数下面定义辅助函数。我可以在模块的顶部给读者主要的功能，而不强迫他们滚动到底部，一步步向上。使用顶级`function`关键字声明的每个函数在模块中的任何地方都是可用的，所以我可以在任何有意义的地方编写它们。

所以我是说箭头函数没用吗？没有。我将箭头函数用于简短的纯实用函数，以及作为参数内联的函数，如 Array 的`map()`、`sort()`和`filter()`函数。在这些情况下，函数定义在更大的代码上下文中流动是很重要的，而不是在外部函数和内联函数定义之间创建强有力的描述。

# 大声读出你的变量名。

即使我们被告知要写描述性的变量名，我们也没有被告知如何想出最好的描述性名称。`objectCount`？`objectTotal`？`numObjects`？

关键是看你的变量用在哪里，并大声读出它们。

你能说出这个名字吗？例如，在`objectCount`和`numObjects`之间，`numObjects`中的`m`在单词之间形成了一个模糊的分隔符，使得在对话中更难说出。这在你写代码的时候可能并不重要，但是当你试图向你的同事大声解释的时候就变得很重要了。如果你发现自己在脑子里大声朗读代码，它也可以使阅读变得更容易。这是一个很小的差别，但每一点都有帮助！

变量的使用方式也会有所不同。如果在条件中使用了一个变量，请考虑使用该变量名的条件如何读取。虽然布尔值传统上以`is`为前缀，但用`if (passwordHasNumbers)`代替`if (isPasswordWithNumbers)`可能更有意义。

对于跟踪变量，有许多推荐的命名约定，特别是对于松散类型的语言，比如 Javascript。然而，需要有灵活性的空间，否则代码会变得生硬，难以讨论。

# 编写以改善代码的故事流程。

无论您是编写更长或更短的语句、使用空白、分解函数还是选择变量名，都要记住这一点:

> 编写以改善代码的故事流程。

某个特定功能是否过于笨拙？把它分成更小的函数，用名字解释发生了什么。使用空白来显示代码的故事在哪里改变了场景和速度。使用函数和变量名，让你可以口头讲述故事。预先讲述主要内容(将主要功能放在模块顶部),下面是支持功能。

永远记住，你是在为观众写作。你未来的自己和你的同事会为此感谢你。并且，在一天结束的时候，你可以回顾你的代码并且说，

“该死的。这是一个好故事。”

*更多内容看*[***plain English . io***](http://plainenglish.io/)