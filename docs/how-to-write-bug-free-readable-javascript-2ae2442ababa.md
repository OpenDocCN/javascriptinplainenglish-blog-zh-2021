# 如何编写无 Bug 可读的 JavaScript

> 原文：<https://javascript.plainenglish.io/how-to-write-bug-free-readable-javascript-2ae2442ababa?source=collection_archive---------9----------------------->

## 专家总结的关于如何编写可读 JavaScript 的解释。

![](img/d053ff6af11a48128f720a0674e5cc10.png)

## 如果你讨厌 JavaScript，你会想读这个的。

根据“叔叔”鲍伯·马丁、道格拉斯·克洛克福特、蒂莫西·戴利、朱尔斯·梅和凯夫林·亨尼的教导，对如何编写可读的 JavaScript 进行了说明性和固执己见的解释。

在他们不同意的地方，我会默认任何一个对 JavaScript 最不鄙视的人。

首先要学习的是**代码是给别人看的**，顺便说一下是给电脑看的。理想情况下，计算机会接受 1 和 0，但我们用的是压缩的英语。显然，计算机不是正在编写的内容的主要目标。人类就是，未来会对代码做出不可预测的改变的人类。

缩小和传输软件将优化代码。这里的重点是制作实现业务需求的代码，然后可以扩展。

# 使用臭虫避免函数语法

**一个函数的语法是“知道动作是涉及参数的”；除非参数无效；表示输入，所以除非输入无效，算法**。或者没有否定句“知道动作涉及构成该算法输入的这些参数”

*   有些动词是一系列名词
*   参数不合格
*   主语名词
*   名词取消资格者
*   述语

这里的细节是事情如何随着实现而分解以及为什么。

**命名函数**，不要用常量来分配。这允许虚拟机提升该功能，如果有人编辑代码，则不太可能发生由于代码移动而导致的代码引用错误。它还允许通过网站和 IDEs 进行代码导航和编程修改，比如 Github 和 VSCode。这是一个令人敬畏的生活帮。

尝试限制函数中使用的参数数量。一个参数可能太少。可能会产生敏感的链式代码。超过五岁，人类的记忆力就成了问题。让情况决定吧。

如果参数的名称很长，屏幕可读性/代码风格可能会成为一个问题。命名对于清除代码至关重要。所以选择好的名字。他们应该遵循语法风格。

函数应该是**动词**。A **boolean 是与名词组合的介词**，strings 和 objects 是**名词**。数组、列表、地图或集合应该是**复数**名词。避免将名称空间概念化为名称的一部分，这些都是形容词。这些都可以考虑在内。

如果传入的参数靠近用户输入源，请验证它们是工作输入。如果它们有效但不是正确的类型，现在就强制它们并生成可用的数据。请记住，垃圾在…然后你有一个垃圾场，必须像火坑一样点燃。使用单个`if` 语句来检查每个参数的有效性。这是 JavaScript，所以将这里的错误丢到上面的`try…catch`语句中，该语句提供一个错误接口来提醒用户或实现者。

![](img/f9087f1197a41d4c44600b04b674ff54.png)

**此时数据应该处于明确定义的状态。**使用且仅使用一个 const 语句。如果团队的代码风格不允许使用单个`const` 语句，那么就把它们都放在一个代码块中。对于条件常量值，使用三元语句来赋值。不要嵌套三元语句。

**如果需要新的 const 语句或块，则创建新的函数。**当试图创建一个新的常量时，它意味着执行一个与其参数无关的操作。动作是动词，而不是最初的动作。它正在完成一项不同的任务。因此，创建一个新的函数，这样它就能得到为什么一个给定的动作会发生的所有细节。

决定一个失败案例或违约，并用一个 if 语句逐一评估可能发生的情况。如果遇到负条件，从函数返回默认值。这里使用大量的`!`操作符。**不返回** `**null**` **或** `**NaN**` **。在 JavaScript 中，这些都是有毒的值，就像从核电厂出来的真皮。如果将`undefined` 作为一个值返回，则正值也必须是`undefined` 。**

**返回**正状态后，则**不做*动作*此后不做附加动作**。这可以是一个在线计算、一个生成的常数或一个 I/O 触发器。**避免耍小聪明**除非涉及到 I/O，否则火焰图的测试证明该功能效率低下。正值的返回类型应该与默认值/负值相同。这减少了与数据有效性相关的代码噪声。

# 评论

最后，在上面贴一些好的 JSDocs。在对该功能的含义或功能做出决定后，它们会一直持续下去。如果制定了需求规格说明**将在其中传达的关键信息粘贴到 JSDoc** 中，作为总结、参数和返回语句的注释。这对于接口尤其重要，接口是代码文件连接到其他接口的地方。VSCode 将使用这些格式化的注释向最终用户显示，有时还会做一些类似编译器的行为。

关于评论有两种学派。“代码应该对自己进行评论”，过分强调命名，对未来的维护者抱有妄想，并且来自一个不存在版本控制的世界。不用说，使用版本控制。

任何从事高中或高等数学的事情都需要评论。任何优化，或“聪明”都应该解释。这就是谎言的来源。注释旨在**记录**的原因。为什么会发生动作，动作是指一个动词过渡到一个功能。

如果注释在代码检查期间与算法不匹配，或者只是在版本控制中查找原因。没有更简单的方法来捕捉特定领域的缺陷。与英语相比，注释填补了 JavaScript 的语言缺陷，并为未来的开发人员提供了案例参考。**评论可以说谎是件好事。**这是评论的一个特征，不是臭虫。

# 班级

类是数据规则的例外，因为它们是最初创建数据的方式。想象一下管道中的水。水是数据，管道是功能。类并不都是坏的，有三个“类”在适当的时候使用类。避免甜食。

**纯数据类** 统一创建的理想的、真正的复合类型。它们可以在 JavaScript 中以多种方式定义，一个对象文字，一个返回函数文字的函数，但是一个巧妙的方法是使用一个类。当使用类构造数据时，它会获得一些额外的标识符来确定是什么创建了它。这些都可以封装起来，以提供额外的功能或确保正确性。

**闭包或模块** 通常不需要添加类语法。任何时候只要有`module.exports`或限定范围的上下文，其中至少一个函数可以引用另一个和一个或多个常数来产生黑盒计算、效果、新的闭包或它们的组合。如果最终只有一个或几个函数被使用，就不需要类语法。它引入了`this` 范围的复杂性。需要使用`bind(this)`来解决的问题。

**计算绑定数据** 最后，如果没有算法辅助，数据的案例是无法使用的。基本上是吸气剂和/或设置剂。数据可能需要以某种方式存储在内存中，以允许某些算法工作或程序有效。这是使用类的最佳时机。当不可能将数据从方法中分离出来时。当与类一起使用时，JavaScript 有针对`get` 和`set` 的语法糖。好好利用。

# 习惯

用`===`和`!==`代替`==`和`!=`。互联网上抱怨 JavaScript 的最奇怪的地方是人们没有使用正确的操作符。他们描述的是一个类型错误，而`===`和`!==`检查那些类型错误。

如果一个匿名函数越来越复杂，比如说 5 行；命名它，将它移出它所在的参数位置，然后传递命名的函数。**回调地狱的视觉金字塔结构是一个选择**。

**数组应该都是一致的类型**，这包括对象。如果是一个对象列表，它们应该有一致的组成。

**不要使用** `**else**` **语句**，或者嵌套在其他`if`语句中的`if` 语句。使用更清晰的常量来传达正在发生的事情和正在检查的内容，然后只检查那个常量。考虑嵌套的 ifs 和 else 语句编译错误。使用单词“**除非**”精神上不是“别的”Else 是倒排语法。

倾向于大文件，或者被称为“深类”。所有相关的功能应该在同一个文件中。这是通过挑选被操作的最关键的数据(而不是功能)并在该点分割文件来实现的。所以所有使用这一段数据的功能。状态本身，而不是它的属性，以及 I/O 接口就是很好的例子。文件将开始增长到大约 300-700 行，并自然地开始封顶，在修订中会涉及越来越少的代码库。

**不要假设阅读代码的人是在与**中所写的相同的介质中阅读代码。他们可能正在网上看。拥有不需要跳来跳去、挖来挖去或钻来钻去的更大的文件会使代码评审更加有效。

将 switch 语句放在接近入口或数据输入的程序后立即进行数据验证。switch cases 应该调用一个函数，就这样。这可以简化为多态性，但将其作为一个开关写出可以更容易地进行调试检查。

**我们可以把程序看作是首先操纵数据，然后传递数据的东西。**

# 德米特里定律

把事物的价值，而不是把它们所连接的事物送入函数。有时有几种方法可以将相关的东西组合起来，然后将它们传递给函数，只获取函数需要的东西。

表达这一点最简单的方法是不要在对象上使用多个属性 deep，并将属性作为值传递以移除点表示法。这将产生广泛的 API。可以通过名称间距输入缩小范围。这就是如何防止程序的不同部分出现传递错误。

**“一点好除非使用** `**this**` **，然后两个“**

期望基元值的函数更易于测试，在进行测试时需要更少的嘲笑。

# 总结说明

本文中的许多内容都依赖于当今的 IDE 以及它们如何理解程序文件体。随着更多功能可用或允许更大的灵活性而调整。