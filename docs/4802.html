<html>
<head>
<title>What is Corepack in Node.js?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Node.js中的Corepack是什么？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/what-is-corepack-in-node-js-d26dfc2cae43?source=collection_archive---------2-----------------------#2021-09-25">https://javascript.plainenglish.io/what-is-corepack-in-node-js-d26dfc2cae43?source=collection_archive---------2-----------------------#2021-09-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a64d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Corepack允许节点开发人员使用新的打包选项！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5b89f0ace4cb3b0576aa884b86264372.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4aoSf92kNht1Qk0S.jpg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Image courtesy of Pawel Czerwinski on Unsplash</figcaption></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="kv kw l"/></div></figure><p id="a64c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">随着Node.js 16.9.0的发布，出现了一个名为<a class="ae lt" href="https://github.com/nodejs/corepack" rel="noopener ugc nofollow" target="_blank"> Corepack </a>的新工具。<code class="fe lu lv lw lx b">Corepack</code>被描述为一个零运行时依赖性的节点脚本，在节点项目和包管理器(如<a class="ae lt" href="https://yarnpkg.com/" rel="noopener ugc nofollow" target="_blank"> Yarn </a>和<a class="ae lt" href="https://pnpm.io/" rel="noopener ugc nofollow" target="_blank"> Pnpm </a>)之间充当桥梁。Node.js附带了一个名为<code class="fe lu lv lw lx b">NPM</code>的包管理器，每次在计算机或服务器上安装Node.js时，它都会随Node.js一起安装。</p><p id="67df" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">所以本质上Corepack允许我们使用第三方包管理器，而不必在我们的开发计算机或构建服务器上全局安装它们。</p><p id="a27e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">虽然NPM很可能是最大的软件包管理器，但许多组织在根据自己的需求选择软件包管理器时，必须考虑一些因素。许多组织不能使用NPM，因为当Node.js开发人员对他们的应用程序有依赖时，他们被复制到一个名为<code class="fe lu lv lw lx b">node_modules</code>的子目录中。大多数CI/CD服务器和流程不允许构建服务器从其网络外部访问或下载模块。这是发明纱线的原因之一。Yarn和PNPM既可以在开发者的计算机上存档和缓存模块，也可以在应用程序的源代码中存储模块包。</p><h1 id="8eca" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">Corepack简介</h1><p id="6e38" class="pw-post-body-paragraph kx ky iq kz b la mq jr lc ld mr ju lf lg ms li lj lk mt lm ln lo mu lq lr ls ij bi translated">Corepack是Node.js附带的一个脚本，可以通过命令行访问。它有专门用于启用、禁用、准备和合并软件包管理器的命令。因为它仍然被认为是一个实验性的特性，所以默认情况下是禁用的。要启用Corepack，只需在终端中键入以下命令；</p><pre class="kg kh ki kj gt mv lx mw mx aw my bi"><span id="6b3c" class="mz lz iq lx b gy na nb l nc nd">&gt; corepack enable</span></pre><p id="2e21" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">您还可以通过在<code class="fe lu lv lw lx b">enable</code>后包含其名称来启用特定的包管理器shim。在下面的例子中，我们将只启用<code class="fe lu lv lw lx b">yarn</code>的垫片。</p><pre class="kg kh ki kj gt mv lx mw mx aw my bi"><span id="43e1" class="mz lz iq lx b gy na nb l nc nd">&gt; corepack enable yarn</span></pre><p id="02fc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果您想禁用corepack，您可以简单地使用以下命令将其关闭；</p><pre class="kg kh ki kj gt mv lx mw mx aw my bi"><span id="9cb6" class="mz lz iq lx b gy na nb l nc nd">&gt; corepack disable</span></pre><h1 id="872b" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">激活软件包管理器</h1><p id="c662" class="pw-post-body-paragraph kx ky iq kz b la mq jr lc ld mr ju lf lg ms li lj lk mt lm ln lo mu lq lr ls ij bi translated">在本例中，我将激活<code class="fe lu lv lw lx b">yarn</code>包管理器。使用Corepack，您可以激活一个软件包管理器、所有软件包管理器或特定版本的软件包管理器。我们将安装一个特定版本的<code class="fe lu lv lw lx b">yarn</code>包管理器；</p><pre class="kg kh ki kj gt mv lx mw mx aw my bi"><span id="9320" class="mz lz iq lx b gy na nb l nc nd">&gt; corepack prepare yarn@1.22.11 --activate</span></pre><p id="1cfc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这将安装yarn版本1.22.11并为我们的项目激活。一旦我们激活了我们的软件包管理器，我们就可以使用Corepack运行现有的软件包管理器命令。如果我们想使用特定的包管理器添加一个模块，我们只需将这些命令添加到<code class="fe lu lv lw lx b">corepack</code>命令中；</p><pre class="kg kh ki kj gt mv lx mw mx aw my bi"><span id="9cc6" class="mz lz iq lx b gy na nb l nc nd">&gt; corepack yarn add axios</span></pre><p id="844d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果我们在全球范围内安装了yarn，那么运行<code class="fe lu lv lw lx b">yarn add axios</code>也是一样的。如果我们看一下<code class="fe lu lv lw lx b">package.json</code>文件，它将对<code class="fe lu lv lw lx b">axios</code>有一个依赖关系。我们在package.json文件中还有一个<code class="fe lu lv lw lx b">packageManager</code>设置，它列出了我们希望在项目中使用的包管理器。</p><pre class="kg kh ki kj gt mv lx mw mx aw my bi"><span id="c70c" class="mz lz iq lx b gy na nb l nc nd">{<br/>  "name": "sampleproject",<br/>  "version": "1.0.0",<br/>  "main": "index.js",<br/>  "type": "module",<br/>  "license": "MIT",<br/>  "scripts": {<br/>    "start": "node index.js"<br/>  },<br/>  "packageManager": "yarn@1.22.11",<br/>  "dependencies": {<br/>    "axios": "^0.21.4"<br/>  }<br/>}</span></pre><h1 id="ffb8" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">归档和分发我们的包管理器</h1><p id="2a02" class="pw-post-body-paragraph kx ky iq kz b la mq jr lc ld mr ju lf lg ms li lj lk mt lm ln lo mu lq lr ls ij bi translated">Corepack还允许我们将我们的包管理器归档到我们的项目中。当我们的项目被部署到我们的构建环境中时，这些档案可以被水化。</p><p id="7ef9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了归档我们的包管理器，我们可以在使用<code class="fe lu lv lw lx b">prepare</code>命令时添加一个<code class="fe lu lv lw lx b">-o</code>输出标志。</p><pre class="kg kh ki kj gt mv lx mw mx aw my bi"><span id="d3d0" class="mz lz iq lx b gy na nb l nc nd">&gt; corepack prepare yarn@1.22.11 --activate -o</span></pre><p id="af5c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这将添加一个<code class="fe lu lv lw lx b">corepack.tgz</code>文件到包含我们的包管理器的项目中。如果我们将项目的源代码复制到另一台机器上，我们可以使用hydrate命令对包管理器进行解归档，如下所示；</p><pre class="kg kh ki kj gt mv lx mw mx aw my bi"><span id="6200" class="mz lz iq lx b gy na nb l nc nd">&gt; corepack hydrate --activate corepack.tgz</span></pre><h1 id="c3e1" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">结论</h1><p id="b7ab" class="pw-post-body-paragraph kx ky iq kz b la mq jr lc ld mr ju lf lg ms li lj lk mt lm ln lo mu lq lr ls ij bi translated">Corepack是Node.js社区如何让Node逐渐成为更好的工具的另一个例子。通过为不同的包管理器提供支持，这是工具使我们的生活变得更容易的另一种方式。</p><p id="e3d6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在Corepack只是预览版，但是通过安装和使用Node.js的最新版本，您可以在它成为默认版本的一部分之前开始感受这个新工具。</p><p id="1e43" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="ne">原发布于</em><a class="ae lt" href="https://fek.io/blog/what-is-corepack-in-node-js/" rel="noopener ugc nofollow" target="_blank"><em class="ne">https://fek . io</em></a><em class="ne">。</em></p></div></div>    
</body>
</html>