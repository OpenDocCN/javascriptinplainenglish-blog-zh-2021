<html>
<head>
<title>How to Draw Directions on a Map in React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React Native中在地图上绘制方向</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-draw-directions-on-a-map-in-react-native-f40825e8194a?source=collection_archive---------16-----------------------#2021-03-17">https://javascript.plainenglish.io/how-to-draw-directions-on-a-map-in-react-native-f40825e8194a?source=collection_archive---------16-----------------------#2021-03-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/71a4e52f14f4d52e350206059db42419.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R_EcNdEptXaYI3OD"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@glenncarstenspeters?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Glenn Carstens-Peters</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3cff" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">今天我们将在React Native的地图上绘制方向路线，展示两个不同位置之间的路径。我们将利用<strong class="kc io"> react-native-maps </strong>，这是一个强大的库，允许我们在多个坐标之间绘制折线。我们还将使用谷歌方向API，以获取两个坐标之间的精确方向路线。</p><p id="7b7c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">值得注意的是，截至本文撰写之时，react-native-maps库仅正式支持最新React Native版本上的折线模块，因为React Native生态系统中的变化越来越多，不容易跟上。</p><h2 id="17dd" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">装置</h2><p id="55e2" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">让我们安装并配置这个库。根据您首选的包管理器，只需运行:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="52da" class="ky kz in mb b gy mf mg l mh mi">npm install react-native-maps --save-exact</span></pre><p id="ae7e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">或者</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="d9b8" class="ky kz in mb b gy mf mg l mh mi">yarn add react-native-maps -E</span></pre><p id="326b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">专业提示:-E标志安装这个库的最新版本</p><h2 id="0939" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">设置</h2><p id="1f0d" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated"><strong class="kc io"> iOS </strong></p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="acce" class="ky kz in mb b gy mf mg l mh mi">cd ios<br/>pod install</span></pre><p id="ba04" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">从您的Google控制台获取一个Google API密钥。你可以在我们的<a class="ae jz" href="https://www.instamobile.io/react-native-tutorials/react-native-location/" rel="noopener ugc nofollow" target="_blank">用户位置</a>教程中一步步学习如何获得Google API密匙。一旦你有了API密匙，编辑你的<strong class="kc io"> <em class="mj"> AppDelegate.m </em> </strong>文件:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="461b" class="ky kz in mb b gy mf mg l mh mi">+ #import &lt;GoogleMaps/GoogleMaps.h&gt;</span><span id="288f" class="ky kz in mb b gy mk mg l mh mi">@implementation AppDelegate<br/>...</span><span id="e6eb" class="ky kz in mb b gy mk mg l mh mi">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions<br/>{<br/>+  [GMSServices provideAPIKey:@"_YOUR_API_KEY_"]; // add this line using the api key obtained from Google Console<br/>...</span></pre><p id="611a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">将以下内容添加到<code class="fe ml mm mn mb b">use_native_modules!</code>函数上方的<strong class="kc io"> <em class="mj"> Podfile </em> </strong>中，并运行<em class="mj"> ios </em>文件夹中的<code class="fe ml mm mn mb b">pod install</code>:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="8a36" class="ky kz in mb b gy mf mg l mh mi"># React Native Maps dependencies<br/>rn_maps_path = '../node_modules/react-native-maps'<br/>pod 'react-native-google-maps', :path =&gt; rn_maps_path<br/>pod 'GoogleMaps'<br/>pod 'Google-Maps-iOS-Utils'</span></pre><p id="2720" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">安卓</strong></p><p id="8b2a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您已经定义了<em class="mj">项目级属性</em>(推荐！)在你的根<code class="fe ml mm mn mb b">build.gradle</code>中，这个库会检测到下列属性的存在:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="e83d" class="ky kz in mb b gy mf mg l mh mi">buildscript {...}<br/>allprojects {...}</span><span id="2e3e" class="ky kz in mb b gy mk mg l mh mi">/**<br/> + Project-wide Gradle configuration properties<br/> */<br/>ext {<br/>    compileSdkVersion   = xxx<br/>    targetSdkVersion    = xxx<br/>    buildToolsVersion   = "xxx"<br/>    minSdkVersion       = xxx<br/>    supportLibVersion   = "xxx"<br/>    playServicesVersion = "17.0.0" // or get latest version<br/>    androidMapsUtilsVersion = "xxx"<br/>}</span></pre><p id="b97f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">或者你可以</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="2d1e" class="ky kz in mb b gy mf mg l mh mi">buildscript {<br/>    ext {<br/>        buildToolsVersion = "xxx"<br/>        minSdkVersion = xxx<br/>        compileSdkVersion = xxx<br/>        targetSdkVersion = xxx<br/>        supportLibVersion = "xxx"<br/>        playServicesVersion = "17.0.0" // or find latest version<br/>        androidMapsUtilsVersion = "xxx"<br/>    }<br/>}<br/>...</span></pre><p id="4000" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您没有<strong class="kc io">也没有</strong>定义<em class="mj">项目范围的属性</em>并且有一个与该库中包含的版本不同的play-services版本，请使用以下版本(切换到17.0.0和/或17.2.1以获得所需版本):</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="f80a" class="ky kz in mb b gy mf mg l mh mi">...<br/>dependencies {<br/>   ...<br/>   implementation(project(':react-native-maps')){<br/>       exclude group: 'com.google.android.gms', module: 'play-services-base'<br/>       exclude group: 'com.google.android.gms', module: 'play-services-maps'<br/>   }<br/>   implementation 'com.google.android.gms:play-services-base:17.2.1'<br/>   implementation 'com.google.android.gms:play-services-maps:17.0.0'<br/>}</span></pre><p id="d310" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最后，您必须将已经检索到的Google API密钥添加到<strong class="kc io"><em class="mj">androidmanifest . XML</em></strong>:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="31af" class="ky kz in mb b gy mf mg l mh mi">&lt;application&gt;<br/>   &lt;!-- You will only need to add this meta-data tag, but make sure it's a child of application --&gt;<br/>   &lt;meta-data<br/>     android:name="com.google.android.geo.API_KEY"<br/>     android:value="Your Google maps API Key Here"/&gt;<br/>  <br/>   &lt;!-- You will also only need to add this uses-library tag --&gt;<br/>   &lt;uses-library android:name="org.apache.http.legacy" android:required="false"/&gt;<br/>&lt;/application&gt;</span></pre><h2 id="40d0" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">使用</h2><p id="e057" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">该库的基本用法如下:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="09ac" class="ky kz in mb b gy mf mg l mh mi">/**<br/> * Sample React Native App<br/> * <a class="ae jz" href="https://github.com/facebook/react-native" rel="noopener ugc nofollow" target="_blank">https://github.com/facebook/react-native</a><br/> *<br/> * @format<br/> * @flow strict-local<br/> */</span><span id="f94b" class="ky kz in mb b gy mk mg l mh mi">import React from 'react';<br/>import {StyleSheet, View, Dimensions} from 'react-native';</span><span id="82c0" class="ky kz in mb b gy mk mg l mh mi">import MapView from 'react-native-maps';</span><span id="c3b6" class="ky kz in mb b gy mk mg l mh mi">const App = () =&gt; {<br/>  return (<br/>    &lt;View style={styles.container}&gt;<br/>      &lt;MapView<br/>        style={styles.maps}<br/>        initialRegion={{<br/>          latitude: 48.864716,<br/>          longitude: 2.349014,<br/>          latitudeDelta: 0.0622,<br/>          longitudeDelta: 0.0121,<br/>        }}/&gt;<br/>    &lt;/View&gt;<br/>  );<br/>};</span><span id="4971" class="ky kz in mb b gy mk mg l mh mi">const styles = StyleSheet.create({<br/>  container: {<br/>    flex: 1,<br/>  },<br/>  maps: {<br/>    width: Dimensions.get('screen').width,<br/>    height: Dimensions.get('screen').height,<br/>  },<br/>});</span><span id="f1f9" class="ky kz in mb b gy mk mg l mh mi">export default App;</span></pre><p id="1129" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这段代码呈现了一个以法国巴黎为中心的基本地图。正如我们在下面看到的，这只是一张空白地图，但是我们将添加一些功能来渲染一条显示两个位置之间方向的线。</p><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/302edbd98014d504d53d3eb1a1dfa1a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/0*HUSKPnPH-LvqIBTg.jpg"/></div></figure><p id="5d07" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了实现本文的目标，我们必须看看由<strong class="kc io"> react-native-maps </strong>提供的名为<strong class="kc io"> Polyline、</strong>的元素，它在地图上绘制两点之间的方向路线。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="b523" class="ky kz in mb b gy mf mg l mh mi">const App = () =&gt; {<br/>  const [coordinates] = useState([<br/>    {<br/>      latitude: 48.8587741,<br/>      longitude: 2.2069771,<br/>    },<br/>    {<br/>      latitude: 48.8323785,<br/>      longitude: 2.3361663,<br/>    },<br/>  ]);</span><span id="1c61" class="ky kz in mb b gy mk mg l mh mi">  return (<br/>    &lt;View style={styles.container}&gt;<br/>      &lt;MapView<br/>        style={styles.maps}<br/>        initialRegion={{<br/>          latitude: coordinates[0].latitude, <br/>          longitude: coordinates[0].longitude,<br/>          latitudeDelta: 0.0622,<br/>          longitudeDelta: 0.0121,<br/>        }}&gt;<br/>        &lt;Marker coordinate={coordinates[0]} /&gt;<br/>        &lt;Marker coordinate={coordinates[1]} /&gt;<br/>        &lt;Polyline<br/>          coordinates={coordinates}<br/>          strokeColor="#000" // fallback for when `strokeColors` is not supported by the map-provider<br/>          strokeColors={['#7F0000']}<br/>          strokeWidth={6}<br/>        /&gt;<br/>      &lt;/MapView&gt;<br/>    &lt;/View&gt;<br/>  );<br/>};</span></pre><p id="46d8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">正如我们在下面的截图中看到的，它只是在地图上的两个标记之间显示了一条直线，这对我们的目的没有帮助，因为它没有向我们显示两个位置之间的路径。</p><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/f81ab2bee80a72a65fefce05c9e54588.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/0*pY4q53wBiUL_yJo7.jpg"/></div></figure><p id="d184" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了解决这个问题，我们必须使用一个外部库<code class="fe ml mm mn mb b">react-native-maps-directions</code>来帮助我们绘制两个期望位置之间的正确方向路线。这个库使用了<a class="ae jz" href="https://developers.google.com/maps/documentation/directions/overview" rel="noopener ugc nofollow" target="_blank"> Google Directions API </a>的，这是Google提供的一个REST端点，您可以通过一个简单的HTTP调用查询它来获得两个坐标之间的方向路线。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="ddda" class="ky kz in mb b gy mf mg l mh mi">const App = () =&gt; {<br/>  const [coordinates] = useState([<br/>    {<br/>      latitude: 48.8587741,<br/>      longitude: 2.2069771,<br/>    },<br/>    {<br/>      latitude: 48.8323785,<br/>      longitude: 2.3361663,<br/>    },<br/>  ]);</span><span id="f002" class="ky kz in mb b gy mk mg l mh mi">  return (<br/>    &lt;View style={styles.container}&gt;<br/>      &lt;MapView<br/>        style={styles.maps}<br/>        initialRegion={{<br/>          latitude: coordinates[0].latitude,<br/>          longitude: coordinates[0].longitude,<br/>          latitudeDelta: 0.0622,<br/>          longitudeDelta: 0.0121,<br/>        }}&gt;<br/>        &lt;MapViewDirections<br/>          origin={coordinates[0]}<br/>          destination={coordinates[1]}<br/>          apikey={GOOGLE_API_KEY} // insert your API Key here<br/>          strokeWidth={4}<br/>          strokeColor="#111111"<br/>        /&gt;<br/>        &lt;Marker coordinate={coordinates[0]} /&gt;<br/>        &lt;Marker coordinate={coordinates[1]} /&gt;<br/>      &lt;/MapView&gt;<br/>    &lt;/View&gt;<br/>  );<br/>};</span></pre><p id="84d3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有了它，我们就能实现我们的目标。</p><figure class="lw lx ly lz gt jo gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/29df8965f32c636b3d100bb2172f96f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:276/format:webp/0*Y8cEFVvwE2xjAwy2.jpg"/></div></figure><h2 id="1cbc" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">结论</h2><p id="eb98" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">如果您已经密切关注，您将能够在React本地地图上呈现方向。但是请注意，如果您正在测试Android，您应该启用<strong class="kc io">方向API </strong>来渲染方向，如果您正在测试iOS，您应该启用<strong class="kc io"> Google Maps for Android </strong>或<strong class="kc io"> Google Maps API for iOS </strong>。</p><p id="5dda" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">通过使用地图库和Google Directions API端点，我们能够在React Native的地图上绘制两个给定位置之间的路线。</p><p id="3844" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你觉得这个React Native教程有用，请通过分享到你的社区来传播它。干杯！</p></div></div>    
</body>
</html>