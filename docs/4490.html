<html>
<head>
<title>MongoDB Client-Side Field Level Encryption (CSFLE) for Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向初学者的MongoDB客户端字段级加密(CSFLE)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/mongodb-client-side-field-level-encryption-csfle-for-beginners-5eed965d4ba3?source=collection_archive---------6-----------------------#2021-09-07">https://javascript.plainenglish.io/mongodb-client-side-field-level-encryption-csfle-for-beginners-5eed965d4ba3?source=collection_archive---------6-----------------------#2021-09-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="c9f7" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">为您的应用程序增加一层额外的安全性。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/d499ae9c3de1d386a03290e18e8949dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MemvtPcPM5CKfZGYGRZ3tQ.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo By <a class="ae ks" href="https://unsplash.com/@alesnesetril" rel="noopener ugc nofollow" target="_blank"><strong class="bd kt">Ales Nesetril</strong></a></figcaption></figure><p id="5b28" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">数据安全是当前应用中最关心的问题。为了提高安全性，MongoDB提供了许多构造。</p><p id="0a33" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">在这篇博客中，我们将讨论如何在通过网络向服务器传输数据之前加密MongoDB文档中的字段，这使得几乎不可能从数据库服务器获取敏感信息。要了解更多信息，请访问MongoDB官方文档。</p><h2 id="394f" class="lq lr in bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">MongoDB客户端字段级加密的工作原理</h2><p id="6d07" class="pw-post-body-paragraph ku kv in kw b kx mj jo kz la mk jr lc ld ml lf lg lh mm lj lk ll mn ln lo lp ig bi translated">MongoDB客户端字段级加密(CSFLE)使用一种称为信封加密的加密策略，其中用于加密/解密数据的密钥(称为数据加密密钥)用另一个密钥(称为主密钥)加密。</p><blockquote class="mo mp mq"><p id="35a2" class="ku kv mr kw b kx ky jo kz la lb jr lc ms le lf lg mt li lj lk mu lm ln lo lp ig bi translated">在本例中，我们使用的是不适合生产的本地密钥提供程序。相反，您应该在密钥管理系统(KMS)中配置一个主密钥，该系统可以远程存储和解密您的数据加密密钥。</p></blockquote><h2 id="b9c3" class="lq lr in bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">先决任务</h2><p id="f88a" class="pw-post-body-paragraph ku kv in kw b kx mj jo kz la mk jr lc ld ml lf lg lh mm lj lk ll mn ln lo lp ig bi translated">要设置和运行此示例，您必须首先完成以下任务:</p><ol class=""><li id="0068" class="mv mw in kw b kx ky la lb ld mx lh my ll mz lp na nb nc nd bi translated">安装MongoDB Server 4.2或更高的企业版。</li><li id="9374" class="mv mw in kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">通过在命令提示符下输入以下命令来安装相应的软件包</li></ol><pre class="kd ke kf kg gt nj nk nl nm aw nn bi"><span id="2825" class="lq lr in nk b gy no np l nq nr">npm i mongodb-client-encryption uuid-base64 mongodb</span></pre><p id="dd50" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">让我们开始吧。</p><h2 id="b06b" class="lq lr in bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">创建主密钥</h2><p id="5c29" class="pw-post-body-paragraph ku kv in kw b kx mj jo kz la mk jr lc ld ml lf lg lh mm lj lk ll mn ln lo lp ig bi translated">要生成主密钥，创建一个Node.js模块，文件名为<em class="mr"> create-master-key.js </em>。确保您已经安装了所需的客户端和软件包。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="10e2" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">要运行该示例，请在命令提示符下输入以下内容，这将创建我们的主密钥。</p><pre class="kd ke kf kg gt nj nk nl nm aw nn bi"><span id="31fd" class="lq lr in nk b gy no np l nq nr">node create-master-key.js</span></pre><h2 id="f8a5" class="lq lr in bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">创建数据加密密钥</h2><p id="d1f1" class="pw-post-body-paragraph ku kv in kw b kx mj jo kz la mk jr lc ld ml lf lg lh mm lj lk ll mn ln lo lp ig bi translated">创建一个Node.js模块，文件名为<em class="mr"> create-data-key.js </em>，内容如下。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="9e31" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">在生成加密密钥的命令提示符下输入以下内容。</p><pre class="kd ke kf kg gt nj nk nl nm aw nn bi"><span id="3090" class="lq lr in nk b gy no np l nq nr">node create-data-key.js</span></pre><p id="64ff" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">上面代码的输出应该如下所示</p><pre class="kd ke kf kg gt nj nk nl nm aw nn bi"><span id="9d6d" class="lq lr in nk b gy no np l nq nr">DataKeyId [UUID]: de4d735a-44789-48bc-bb93-3c84c3g90824 <br/>DataKeyId [base64]: fUV/k/85QiCeB3amaU/9kQ==</span></pre><h2 id="f889" class="lq lr in bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">使用JSON模式指定加密字段</h2><p id="a5cd" class="pw-post-body-paragraph ku kv in kw b kx mj jo kz la mk jr lc ld ml lf lg lh mm lj lk ll mn ln lo lp ig bi translated">MongoDB驱动程序使用JSON模式标准的扩展版本来配置集合中文档的特定字段的自动客户端加密和解密。</p><p id="5f00" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">下面是完整的可运行助手代码。它获取<em class="mr">密钥Id </em>并返回所需的模式。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="4f1a" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">接下来，创建一个Node.js模块，文件名为<em class="mr"> app.js </em>，将患者插入到集合中。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="1f27" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">若要运行该示例，请在命令提示符下输入以下内容。</p><pre class="kd ke kf kg gt nj nk nl nm aw nn bi"><span id="c144" class="lq lr in nk b gy no np l nq nr">node app.js</span></pre><p id="0abe" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">此操作将创建一个类似于以下内容的文档:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nu"><img src="../Images/6119f64efffbbe58d04ff4533764c5e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Co-vYEn-O_mYzOI-I82sxA.png"/></div></div></figure><p id="abf6" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">您可以通过在<em class="mr"> app.js </em>中添加以下函数来获取加密的患者数据</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="a36d" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">干杯！你已经走到这一步了。</p><p id="858a" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">有了这些关于CSFLE的知识，您应该能够更好地保护应用程序并理解它是如何工作的！</p><p id="82db" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">你可以在这里找到完整的代码<a class="ae ks" href="https://github.com/sujitpatil72/MongoDB-Client-Side-Field-Level-Encryption" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="7399" class="lq lr in bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated"><strong class="ak">有用的链接</strong></h2><ol class=""><li id="b488" class="mv mw in kw b kx mj la mk ld nv lh nw ll nx lp na nb nc nd bi translated"><a class="ae ks" href="https://docs.mongodb.com/drivers/security/client-side-field-level-encryption-guide/" rel="noopener ugc nofollow" target="_blank">https://docs . MongoDB . com/drivers/security/client-side-field-level-encryption-guide/</a></li><li id="51dd" class="mv mw in kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">【https://github.com/Automattic/mongoose/issues/8167 T4】</li></ol><h1 id="d19c" class="ny lr in bd ls nz oa ob lv oc od oe ly jt of ju mb jw og jx me jz oh ka mh oi bi translated">结论</h1><p id="6ad5" class="pw-post-body-paragraph ku kv in kw b kx mj jo kz la mk jr lc ld ml lf lg lh mm lj lk ll mn ln lo lp ig bi translated">虽然这篇文章试图涵盖保护MongoDB实例安全的最重要的安全方面之一，但是MongoDB安全还有更多的内容。</p><p id="e34e" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">如启用访问控制、配置基于角色的访问控制、加密网络流量、限制网络暴露等。</p><p id="331e" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">虽然这篇文章关注的是数据库安全，但是建议您保护web和移动应用程序的JavaScript源代码。</p><h2 id="4fee" class="lq lr in bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">感谢阅读！</h2></div><div class="ab cl oj ok hr ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="ig ih ii ij ik"><div class="kd ke kf kg gt oq"><a rel="noopener  ugc nofollow" target="_blank" href="/12-useful-vs-code-extensions-to-help-make-web-development-easier-6960680c56d4"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd io gy z fp ov fr fs ow fu fw im bi translated">12个有用的VS代码扩展，帮助简化Web开发</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">使用这些12 VS代码扩展提高您作为开发人员的生产力</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe km oq"/></div></div></a></div><div class="pf pg gp gr ph oq"><a rel="noopener  ugc nofollow" target="_blank" href="/using-ng2-tel-input-in-angular-aa33c3ced92f"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd io gy z fp ov fr fs ow fu fw im bi translated">使用ng2-tel-输入角度</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">今天我们将探索ng2-tel-input包，并看看如何在Angular中使用它。</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="oz l"><div class="pi l pb pc pd oz pe km oq"/></div></div></a></div><p id="9692" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated"><em class="mr">更多内容请看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kw io"><em class="mr">plain English . io</em></strong></a></p></div></div>    
</body>
</html>