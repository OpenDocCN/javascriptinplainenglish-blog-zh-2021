<html>
<head>
<title>How To Build a Telegram Bot With Node.js in Under 3 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在3分钟内用Node.js构建一个电报机器人</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/nodejs-telegram-bot-5e372f67f57?source=collection_archive---------0-----------------------#2021-01-16">https://javascript.plainenglish.io/nodejs-telegram-bot-5e372f67f57?source=collection_archive---------0-----------------------#2021-01-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="50a6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这可能比你想象的要简单</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4d46df52eed691b68a7e639298fc5c69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UKPKu1bycj79C-tNx96-Vg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: the author</figcaption></figure><p id="5c77" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Telegram是WhatsApp的替代品——在我看来，是一个非常好的替代品。它的免费使用被认为是非常安全的。但是最好的:<br/>我们可以编写自己的机器人！</p><p id="dca8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是如何用Node.js来构建一个<br/>让我们放轻松&amp;构建我们自己的电报机器人吧！</p><h2 id="18d2" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">入门指南</h2><p id="3f31" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">首先，我们需要注册我们的机器人。我们可以通过联系<strong class="kx ir"> <em class="mp"> BotFather </em> </strong>在Telegram app中完成。</p><p id="1e59" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">只需在搜索框中键入“僵尸父亲”，然后选择带有蓝色勾号的建议。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/63579b9032b8e139a801c3a0f547e0f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sej3FFOO1s2QoSdIopaUjg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: the author</figcaption></figure><p id="b37f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">只需点击聊天中的“开始”并浏览选项。您只需要选择一个名称和一个用户名，然后就可以保存密钥了。请保密。</p><p id="8cb7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你已经可以在电报搜索中找到你的机器人了。寻找<br/>“@&lt;bot-username&gt;”——当然，这个bot还不能做任何事情。</p><p id="da92" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们开始编码吧。我使用NPM软件包来处理Telegram API。只需安装:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="09ad" class="lr ls iq ms b gy mw mx l my mz">yarn add node-telegram-bot-api</span></pre><p id="2cd6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后我们就可以用这个包了。将您的令牌放入变量中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="c52d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">搞定了。现在我们可以开始用机器人做事了。这里有一个简单的例子。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="8ec4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用<strong class="kx ir"><em class="mp">context</em></strong>我们可以对符合正则表达式模式的消息做出反应。在这个例子中，表达式<code class="fe nc nd ne ms b">/\/echo (.+)/</code>说我们必须写“/echo”和它后面的一些文本。</p><p id="739f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">变量<strong class="kx ir"> chatId </strong>是用户的ID <strong class="kx ir"> </strong>。只有有了它，我们才能从机器人向电报用户发送消息。因此，如果我们想让机器人自给自足，用户的id必须存储在某个地方。</p><p id="5597" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> bot.sendMessage </strong>用于发送消息(真是惊喜！).resp 是echo命令后发送的字符串。是的，机器人会把我们发给它的东西送回来。<br/>运行<code class="fe nc nd ne ms b">node app.js</code>，打开你的聊天机器人，发送如下内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/73a646e97532a0d1eff5d2a834ea0cff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ipO38Ad4mrEOzb31uNY00A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: the author</figcaption></figure><h2 id="fabf" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">自动发送消息</h2><p id="6c4b" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">正如我所说的，我们需要使用<strong class="kx ir"> chatId </strong>向用户发送消息——为此；我们需要把它存放在某个地方。当然，在生产应用程序中，您应该为此选择非易失性存储——MySQL、MongoDB或其他数据库。</p><p id="cc01" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于我们的例子，我将id存储在一个数组中。用户可以用“/register”向机器人注册，然后机器人被允许向他发送消息。机器人每秒钟向每个用户发送一条消息——我们只是用for循环遍历用户数组。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="6d91" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦我们发送“/register”给机器人，我们就会收到垃圾邮件。</p><h2 id="9b6d" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">回复我的所有邮件</h2><p id="4efb" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">使用<strong class="kx ir">bot . context</strong>我们能够对正则表达式匹配的消息做出反应。但是，如果我们想要处理所有传入的消息呢？这在<code class="fe nc nd ne ms b">bot.on("message")</code>中是可能的——只要有人发送信息，它就会被触发。</p><p id="9e7f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里有一个简单的例子。机器人会为每条消息被触发，但只有当用户发送“狗”时才会响应。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><h2 id="2358" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">发送投票</h2><p id="3824" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在电报上，我们可以交换很多东西。不仅仅是贴纸、视频和短信，还有投票。创建一个很容易:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="5909" class="lr ls iq ms b gy mw mx l my mz">bot.sendPoll(chatId, 'Is Telegram great?', [‘Sure’, ‘Of course’])</span></pre><p id="8364" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">就在身份证之后，我们通过了投票问题。第三个是一系列可能的答案——当然，您可以有不止两个选择。</p><p id="feae" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是多么容易，我们可以建立一个电报机器人与节点. js！</p><p id="e2b8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢阅读——你想在未来看到一个更复杂的项目吗？那就请随意把你的意见留给我。</p><h2 id="ac59" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated"><a class="ae ng" href="http://eepurl.com/hacY0v" rel="noopener ugc nofollow" target="_blank">加入我的时事通讯，了解最新动态</a></h2></div></div>    
</body>
</html>