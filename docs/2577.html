<html>
<head>
<title>Physical Computing with JavaScript (5/8) — Sensing Temperature and Humidity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用JavaScript的物理计算(5/8) —感测温度和湿度</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/physical-computing-with-javascript-5-8-sensing-temperature-and-humidity-2040eb1d20e9?source=collection_archive---------7-----------------------#2021-05-27">https://javascript.plainenglish.io/physical-computing-with-javascript-5-8-sensing-temperature-and-humidity-2040eb1d20e9?source=collection_archive---------7-----------------------#2021-05-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/4c135d499066c60fee5562cf52a63ba3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ctBs8BuFZ7_UezUMFPyPA.png"/></div></div></figure><p id="5235" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本教程中，我将解释数字脉冲，并使用DHT11数字温度和湿度传感器测量温度和湿度。</p><blockquote class="kt ku kv"><p id="74c0" class="jv jw kw jx b jy jz ka kb kc kd ke kf kx kh ki kj ky kl km kn kz kp kq kr ks ig bi translated"><a class="ae la" href="https://niklauslee.medium.com/physical-computing-with-javascript-table-of-contents-69c38fd74e61" rel="noopener">目录</a></p></blockquote><h1 id="e3c7" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">成分</h1><ul class=""><li id="22ed" class="lz ma in jx b jy mb kc mc kg md kk me ko mf ks mg mh mi mj bi translated">树莓派Pico— 1件。</li><li id="adb0" class="lz ma in jx b jy mk kc ml kg mm kk mn ko mo ks mg mh mi mj bi translated">试验板— 1个。</li><li id="0630" class="lz ma in jx b jy mk kc ml kg mm kk mn ko mo ks mg mh mi mj bi translated">数字温度和湿度传感器(DHT11) — 1个。</li><li id="13b3" class="lz ma in jx b jy mk kc ml kg mm kk mn ko mo ks mg mh mi mj bi translated">跳线(M-M型)</li></ul><figure class="mq mr ms mt gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mp"><img src="../Images/c794222a71afe43d938347c73042d76e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f0iOCtf_37LyXEav7i2yfQ.jpeg"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk">Components for sensing temperature and humidity</figcaption></figure><p id="41bc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">DHT11是一款非常流行的数字温度和湿度传感器。DHT传感器有多种类型，但DHT11和DHT22是最常用的。注意每个操作方法和准确度略有不同。</p><figure class="mq mr ms mt gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi my"><img src="../Images/8f418ae5ef855754c802c721f559ef0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kqJDBC9n79ZMurLIlM95dg.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk">Pinout of DHT11 sensor</figcaption></figure><h1 id="3ae7" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">电路</h1><p id="ddfc" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg mz ki kj kk na km kn ko nb kq kr ks ig bi translated">将DHT11传感器的<strong class="jx io"> VCC </strong>和<strong class="jx io"> GND </strong>引脚分别连接到<strong class="jx io"> 3V3 </strong>和<strong class="jx io"> GND </strong>。几乎所有的传感器和组件都需要电源，所以它们在默认情况下应该总是连接到<strong class="jx io"> 3V3 </strong>、<strong class="jx io"> GND </strong>。最后，将<strong class="jx io"> OUT </strong>引脚连接到<strong class="jx io"> GPIO15 </strong>以接收温度和湿度数据。</p><figure class="mq mr ms mt gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi my"><img src="../Images/5d8c9d1023ac39ba0fd8501bdc3db3a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_bfQvX3_Ct-Mqi_DrXGM1g.jpeg"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk">Circuit for DHT11 and Pico</figcaption></figure><h1 id="dfb3" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建项目</h1><p id="cb09" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg mz ki kj kk na km kn ko nb kq kr ks ig bi translated">在上一个教程之前，为了简单起见，我只使用了终端和文本编辑器。在本教程中，我们将创建一个项目并使用一个外部库。首先，让我们创建一个项目文件夹。让我们简单地用<code class="fe nc nd ne nf b">npm init</code>命令初始化这个项目。然后会像在普通Node.js项目中一样创建一个<code class="fe nc nd ne nf b">package.json</code>。</p><pre class="mq mr ms mt gt ng nf nh ni aw nj bi"><span id="90e8" class="nk lc in nf b gy nl nm l nn no">$ mkdir dht11-test<br/>$ cd dht11-test<br/>$ npm init -y</span></pre><h1 id="43e1" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用第三方包</h1><p id="be58" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg mz ki kj kk na km kn ko nb kq kr ks ig bi translated">每个部分都有自己的使用方法。这样，器件制造商总是会提供一份数据手册。数据手册中详细描述了这些器件的特性和用途。如果你知道零件的唯一编号，你可以在alldatasheet.com的<a class="ae la" href="https://www.alldatasheet.com/" rel="noopener ugc nofollow" target="_blank">搜索。</a></p><div class="np nq gp gr nr ns"><a href="https://www.alldatasheet.com/" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd io gy z fp nx fr fs ny fu fw im bi translated">所有数据表。电子元件和半导体及其他产品的数据表搜索网站</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">如果你在这里找不到，世界上其他地方也找不到。你不太可能找到它。ALLDATASHEET.COM是最大的…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">www.alldatasheet.com</p></div></div></div></a></div><p id="f212" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">没有专业知识的人很难阅读数据手册和使用器件。但是不用担心。在大多数情况下，开源库已经发布，以使这些部分更容易使用。在Kaluma的官方网站上，可以在<strong class="jx io">包</strong>页面找到公开的模块。当然，您也可以找到我们将使用的DHT温度和湿度传感器的库。您可以找到该模块的Github URL，然后将该模块安装到您的项目中。</p><pre class="mq mr ms mt gt ng nf nh ni aw nj bi"><span id="5dd5" class="nk lc in nf b gy nl nm l nn no">$ npm install <a class="ae la" href="https://github.com/niklauslee/dht" rel="noopener ugc nofollow" target="_blank">https://github.com/niklauslee/dht</a> --save</span></pre><p id="e7f4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果安装成功，该模块也会被添加到<code class="fe nc nd ne nf b">package.json</code>文件中。</p><h1 id="b0fe" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">从传感器读取数据</h1><p id="38cc" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg mz ki kj kk na km kn ko nb kq kr ks ig bi translated">在<code class="fe nc nd ne nf b">index.js</code>中写下下面的代码，保存文件并使用CLI上传。</p><figure class="mq mr ms mt gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ob"><img src="../Images/7290c269f9b60280742863691c26587c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T68nxgdanGDN4ANP5sqRdg.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk">Read data from DHT11 sensor and print it in terminal</figcaption></figure><pre class="mq mr ms mt gt ng nf nh ni aw nj bi"><span id="a8ee" class="nk lc in nf b gy nl nm l nn no">$ kaluma flash index.js --port &lt;port&gt; --bundle</span></pre><p id="ea49" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">请注意CLI命令中的<code class="fe nc nd ne nf b">--bundle</code>选项。由于<code class="fe nc nd ne nf b">index.js</code>程序使用外部模块<code class="fe nc nd ne nf b">dht</code>，因此在上传之前必须将其捆绑成一个文件。CLI使用<code class="fe nc nd ne nf b">--bundle</code>选项自动完成这项工作。如果想单独捆绑，可以直接使用<code class="fe nc nd ne nf b">bundle</code>命令，或者用Webpack等外部工具捆绑。</p><p id="a533" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一旦上传，程序被存储在Pico内部的闪存中并立即执行。因此我们无法检查控制台上打印的温度和湿度信息。如果想再次运行从头上传的程序，只需在终端中发送<code class="fe nc nd ne nf b">.load</code>命令即可。我们可以很容易地制造出一种装置，可以测量我家或办公室的温度和湿度！</p><pre class="mq mr ms mt gt ng nf nh ni aw nj bi"><span id="8784" class="nk lc in nf b gy nl nm l nn no">&gt; .load<br/>Humidity: 58 %<br/>Temperature: 25.4 C</span></pre><h1 id="c6ea" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">数字脉冲</h1><p id="7946" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg mz ki kj kk na km kn ko nb kq kr ks ig bi translated">只有一个<strong class="jx io"> OUT </strong>引脚可以与DHT11传感器交换数据。我如何仅通过一个pin码请求和接收温度和湿度数据？DHT11传感器如何工作的简要说明如下。</p><ol class=""><li id="b7ee" class="lz ma in jx b jy jz kc kd kg oc kk od ko oe ks of mh mi mj bi translated">Pico向<strong class="jx io"> OUT </strong>引脚发送<code class="fe nc nd ne nf b">HIGH</code>信号一段时间，以请求温度和湿度数据。</li><li id="c78d" class="lz ma in jx b jy mk kc ml kg mm kk mn ko mo ks of mh mi mj bi translated">当收到请求时，DHT11传感器调制温度和湿度数据，并将其传输到<strong class="jx io"> OUT </strong>引脚。简单来说，温度和湿度数据被转换成二进制数，然后按顺序发送0和1。在这种情况下，如果<code class="fe nc nd ne nf b">HIGH</code>信号短，则按0处理，如果<code class="fe nc nd ne nf b">HIGH</code>信号长，则按1处理。这样，总共传输40位。</li><li id="7f65" class="lz ma in jx b jy mk kc ml kg mm kk mn ko mo ks of mh mi mj bi translated">Pico记录<code class="fe nc nd ne nf b">HIGH</code>信号和<code class="fe nc nd ne nf b">LOW</code>信号，同时观察<strong class="jx io"> OUT </strong>引脚的信号变化，然后解调记录结果。</li></ol><p id="a083" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">基本上原理不难，但是自己写这个程序读取温湿度数据就不容易了。因此，您只需要使用外部库轻松调用<code class="fe nc nd ne nf b">read()</code>函数。</p><p id="59d3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">记住Kaluma提供的<code class="fe nc nd ne nf b">pulseRead()</code>函数可以很容易地读取这些数字脉冲是很有用的。这个函数记录<code class="fe nc nd ne nf b">HIGH</code>和<code class="fe nc nd ne nf b">LOW</code>信号在一个特定的管脚上保持多长时间(以微秒计),并将它们作为一个数组返回。例如，假设下图所示的信号来自<strong class="jx io"> GPIO15 </strong>引脚。</p><figure class="mq mr ms mt gt jo gh gi paragraph-image"><div class="gh gi og"><img src="../Images/ce0bcc2c68d2499492a59b526268465f.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*I1IWKQJLm9D9qPUmXLp1RQ.png"/></div></figure><p id="cb9e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当执行以下代码时，它会观察到<strong class="jx io"> GPIO15 </strong>引脚上3个信号的变化，并返回每个信号保持的时间，单位为us(微秒— 1/1，000，000秒)。注意，当<code class="fe nc nd ne nf b">HIGH</code>值被读取时，记录开始。结果将是<code class="fe nc nd ne nf b">[30, 20, 50]</code>。有关<code class="fe nc nd ne nf b">pulseRead()</code>功能的更多信息，请同时参考<a class="ae la" href="https://docs.kaluma.io/api-reference/digital_io#pulseread" rel="noopener ugc nofollow" target="_blank">参考</a>。</p><pre class="mq mr ms mt gt ng nf nh ni aw nj bi"><span id="5ae2" class="nk lc in nf b gy nl nm l nn no">&gt; pinMode(15, INPUT);<br/>&gt; pulseRead(15, 3, {stateState: HIGH});<br/>[30, 20, 50]</span></pre><p id="79da" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本教程中，我们学习了数字脉冲，并从DHT11传感器读取温度和湿度值，并将其显示在终端上。在下一个教程中，我们将在一个单独的显示器上显示它，以便它可以在实践中使用。</p><div class="np nq gp gr nr ns"><a href="https://niklauslee.medium.com/physical-computing-with-javascript-6-8-showing-temperature-on-7-segment-display-b670f11fa36e" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd io gy z fp nx fr fs ny fu fw im bi translated">使用JavaScript的物理计算— (6/8)在7段显示器上显示温度</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">在本教程中，让我们在7段显示器上显示从DHT11传感器读取的温度值。</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">niklauslee.medium.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om jt ns"/></div></div></a></div><p id="f77f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kw">更多内容请看</em><a class="ae la" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="kw">plain English . io</em></a></p></div></div>    
</body>
</html>