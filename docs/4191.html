<html>
<head>
<title>Generate Static Sites using Nunjucks and Gulp</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Nunjucks和Gulp生成静态站点</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/generate-static-sites-using-nunjucks-and-gulp-298fab58b9e3?source=collection_archive---------3-----------------------#2021-08-20">https://javascript.plainenglish.io/generate-static-sites-using-nunjucks-and-gulp-298fab58b9e3?source=collection_archive---------3-----------------------#2021-08-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/adbc218d4c88e77bc9784ef8f3c315ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m5iPYWAIDpE5QhykQCbrTg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Image created and edited by the Author</figcaption></figure><p id="b41c" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><a class="ae kx" href="https://mozilla.github.io/nunjucks/" rel="noopener ugc nofollow" target="_blank"> Nunjucks </a>是一个强大的JavaScript模板引擎。如果你做得正确的话，它的设置是非常简单的，并且它可以成为更复杂框架的一个很好的替代品，比如<a class="ae kx" href="https://www.gatsbyjs.com" rel="noopener ugc nofollow" target="_blank"> Gatsby </a>或者<a class="ae kx" href="https://nextjs.org" rel="noopener ugc nofollow" target="_blank"> Next.js </a>。作为一名前端开发人员，这对夫妇可以成为你的技术堆栈的一个很好的补充。</p><p id="137c" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">凭借每周超过100万次的下载量，<a class="ae kx" href="https://gulpjs.com/" rel="noopener ugc nofollow" target="_blank"> Gulp </a>(或gulp.js)仍然是开发人员中非常受欢迎的选择，使用它自动完成任务的好处数不胜数。</p><p id="1033" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在这篇文章中，让我们回顾一下使用这些伟大的JavaScript工具来构建项目、自动化工作流和生成静态站点的步骤。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="8d87" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">安装核心依赖项</h1><p id="7249" class="pw-post-body-paragraph jz ka in kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ig bi translated">初始化项目后，在CLI中运行:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="419b" class="mr lg in mn b gy ms mt l mu mv"><em class="mw">npm i gulp gulp-nunjucks-render -D</em></span></pre><p id="2377" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">包<a class="ae kx" href="https://www.npmjs.com/package/gulp-nunjucks-render" rel="noopener ugc nofollow" target="_blank"> gulp-nunucks-render </a>是一个插件，它将Nunjucks core作为一个依赖项安装在引擎盖下，它将简化与gulp的集成，并且它也可以很好地与Gulp的最新版本(&gt; 4.x.x)兼容。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="81ad" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">项目结构</h1><p id="fcbd" class="pw-post-body-paragraph jz ka in kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ig bi translated">Nunjucks对文件夹结构并不固执己见，它依赖于文件系统进行模板继承，关于这一点，请考虑下面的项目文件夹结构:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="a7ee" class="mr lg in mn b gy ms mt l mu mv">|-- .gitignore<br/>|-- package.json<br/>|-- gulpfile.js<br/>|-- assets<br/>|-- src<br/>    |-- css<br/>        |-- styles.scss<br/>    |-- js<br/>        |-- main.js<br/>    |-- html<br/>        |-- layouts<br/>            |-- layout.html<br/>        |-- pages<br/>            |-- index.html<br/>        |-- partials<br/>            |-- header.html<br/>            |-- footer.html</span></pre><p id="f2ff" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这个例子预期使用<a class="ae kx" href="https://sass-lang.com" rel="noopener ugc nofollow" target="_blank"> Sass </a>和vanilla Js，但是让我们把重点放在<code class="fe mx my mz mn b">src/html</code>文件夹上，所有的Nunjuck动作都将在那里发生。此外，在本例中，文件扩展名将保持为<code class="fe mx my mz mn b">.html</code>，但是您可以随意更改它:</p><blockquote class="na nb nc"><p id="bda6" class="jz ka mw kb b kc kd ke kf kg kh ki kj nd kl km kn ne kp kq kr nf kt ku kv kw ig bi translated">虽然你可以自由地为你的Nunjucks模板文件使用任何你想要的文件扩展名，但是Nunjucks社区已经采用了. njk .—<a class="ae kx" href="https://mozilla.github.io/nunjucks/templating.html" rel="noopener ugc nofollow" target="_blank">mozilla.github.io/nunjucks</a></p></blockquote></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="bfec" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">布局、页面和局部</h1><p id="1c1b" class="pw-post-body-paragraph jz ka in kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ig bi translated">Nunjucks完全是关于可重用性的，它们通过提供模板继承使这变得非常容易:</p><blockquote class="na nb nc"><p id="e117" class="jz ka mw kb b kc kd ke kf kg kh ki kj nd kl km kn ne kp kq kr nf kt ku kv kw ig bi translated">模板继承是一种使重用模板变得容易的方法。编写模板时，可以定义子模板可以覆盖的“块”。继承链可以有多长就有多长。”——<a class="ae kx" href="https://mozilla.github.io/nunjucks/templating.html" rel="noopener ugc nofollow" target="_blank">mozilla.github.io/nunjucks</a></p></blockquote><p id="84ae" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">模板和内容块可以通过<a class="ae kx" href="https://jinja.palletsprojects.com/en/3.0.x/" rel="noopener ugc nofollow" target="_blank"> jinja2 </a>语法访问。它包含一个非常广泛的自定义标记API，在这种情况下，让我们专注于以下模板标记:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="63d2" class="mr lg in mn b gy ms mt l mu mv">{% extend [layout] %}<br/>{% include [partial] %}<br/>{% block [content] %}</span></pre><p id="9792" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">标签可以接收任意参数，如变量、字符串或条件运算符。</p><p id="1265" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">下面是如何在您的<code class="fe mx my mz mn b">layout.html</code>中实现标签:</p><figure class="mi mj mk ml gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="106b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">注意，我们将自定义变量传递给Html head元标记。这对于传递定制SEO和OpenGraph数据，以及关于页面的任何参数，如页面名称或页面路径，非常有用。</p><p id="018f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">请记住，这些变量只能在构建时访问。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><p id="1ef6" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这是您在页面中填充布局动态信息的方式:</p><figure class="mi mj mk ml gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="3a77" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">它的工作方式很简单，所有在<code class="fe mx my mz mn b">block</code>标签中的内容将替换布局中相同的<code class="fe mx my mz mn b">block</code>标签。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><p id="f181" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您的partials可以用普通的Html编写，尽管您可能想探索更多关于Nunjucks的语法，以包括一些条件呈现，如下所示:</p><figure class="mi mj mk ml gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="7987" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在构建时，将使用页面中填充的变量值来解析条件。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="2533" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">用Gulp生成静态文件</h1><p id="6a94" class="pw-post-body-paragraph jz ka in kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ig bi translated">使用gulp.js，您可以自动执行预处理Sass、优化资产、绑定JavaScript模块等任务，当然，还可以编译Nunjucks模板。这样做的目的是在开发时尽可能地节省时间，最终得到一个干净整洁的源代码。</p><p id="a8ac" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您将把所有内容导出到一个<code class="fe mx my mz mn b">dist</code>文件夹中，该文件夹可以根据需要创建和删除多次。如果希望自动执行部署过程，可以稍后在服务器上定位dist文件夹。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><p id="8b27" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在我们创建gulp任务之前，让我们添加两个新的依赖项，这将有助于我们保持输出的整洁:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="f59c" class="mr lg in mn b gy ms mt l mu mv"><em class="mw">npm i del gulp-beautify -D</em></span></pre><p id="301a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在在项目的根目录下创建一个<code class="fe mx my mz mn b">gulpfile.js</code>，并创建预处理Nunjucks所需的任务，如下所示:</p><figure class="mi mj mk ml gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="30c3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您可以在以后扩展这个文件，以包含Sass、images等任务。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><p id="b808" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在剩下要做的就是用运行脚本更新您的<code class="fe mx my mz mn b">package.json</code>:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="3044" class="mr lg in mn b gy ms mt l mu mv">"scripts": {<br/>    "start": "gulp",<br/>    "build": "gulp build"<br/>},</span></pre><p id="7838" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">会编译这些文件并监听你的Nunjuck文件的变化。</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="19fc" class="mr lg in mn b gy ms mt l mu mv"><em class="mw">npm run start</em></span></pre><p id="04d9" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><code class="fe mx my mz mn b">build</code>只会编译文件。</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="c2ba" class="mr lg in mn b gy ms mt l mu mv"><em class="mw">npm run build</em></span></pre></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="1bd1" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">持续部署</h1><p id="235e" class="pw-post-body-paragraph jz ka in kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ig bi translated">您可以利用<a class="ae kx" href="https://docs.github.com/en/actions/guides/about-continuous-integration" rel="noopener ugc nofollow" target="_blank"> Github </a>、<a class="ae kx" href="https://docs.gitlab.com/ee/ci/" rel="noopener ugc nofollow" target="_blank"> Gitlab </a>或<a class="ae kx" href="https://www.atlassian.com/continuous-delivery/tutorials" rel="noopener ugc nofollow" target="_blank"> Bitbucket </a>与无服务器托管服务(如<a class="ae kx" href="https://www.netlify.com/products/workflow/" rel="noopener ugc nofollow" target="_blank"> Netlify </a>)的集成，并将其设置为自动化您的部署工作流。这将使你的项目的架构100% JamStack。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="6e22" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="1214" class="pw-post-body-paragraph jz ka in kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ig bi translated">记住不要因为过度使用复杂的JavaScript库而使web应用程序过于复杂。大多数情况下，您不需要它们，而且它们会带来很大的开销，您稍后需要为维护、配置和优化支付这些开销。</p><p id="6950" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">如果你想了解更多关于JamStack和静态站点生成器的信息，请点击以下链接:</p><ul class=""><li id="e306" class="ni nj in kb b kc kd kg kh kk nk ko nl ks nm kw nn no np nq bi translated"><a class="ae kx" href="https://jamstack.org/" rel="noopener ugc nofollow" target="_blank">https://jamstack.org</a></li><li id="4b7b" class="ni nj in kb b kc nr kg ns kk nt ko nu ks nv kw nn no np nq bi translated"><a class="ae kx" href="https://snipcart.com/blog/choose-best-static-site-generator" rel="noopener ugc nofollow" target="_blank">https://snipcart.com/blog/choose-best-static-site-generator</a></li></ul><p id="d8f3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">下面是本文中构建的完整示例的链接:</p><ul class=""><li id="909b" class="ni nj in kb b kc kd kg kh kk nk ko nl ks nm kw nn no np nq bi translated"><a class="ae kx" href="https://github.com/andresdhn/template-gulp-nunjucks" rel="noopener ugc nofollow" target="_blank">https://github.com/andresdhn/template-gulp-nunjucks</a></li></ul><p id="dd6e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">希望这篇文章对你有所帮助。感谢您的阅读。</p><p id="2e0d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><em class="mw">更多内容看</em> <a class="ae kx" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="mw">说白了. io </em> </strong> </a></p></div></div>    
</body>
</html>