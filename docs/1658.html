<html>
<head>
<title>A 9-Step Project To Get Started With Redux-Saga</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Redux-Saga入门的9步计划</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/getting-started-with-redux-saga-fbcb76126f1f?source=collection_archive---------14-----------------------#2021-04-09">https://javascript.plainenglish.io/getting-started-with-redux-saga-fbcb76126f1f?source=collection_archive---------14-----------------------#2021-04-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/9d13ac7d9fccd1229e84802219e17d07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HTi9e_0kSlc6MXCj91PJAA.png"/></div></div></figure><p id="74bc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当你听到Redux的时候，你首先想到的可能是全球商店。没错，但是Redux在一个项目中的实现方式有很多种。</p><p id="51fc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">今天，我们将主要关注Redux-Saga。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi kt"><img src="../Images/68ed5b042f9f5ea91bceeb6dc7d4c54e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ug9hRC1ZuJTBIyar"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Photo by <a class="ae lc" href="https://unsplash.com/@giabyte?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Gia Oris</a> on <a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0a2a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在深入Redux-Saga之前，我们先了解一下Redux是什么。</p><p id="d186" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Redux是一个状态容器，允许应用程序的任何部分以一致的方式访问/修改状态变量。</p><p id="9a1b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">那是什么意思？</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ld"><img src="../Images/da5eff980ff12206beaeba080c3c4494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FNkyvdpkDTSFIzKt"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Photo by <a class="ae lc" href="https://unsplash.com/@kchance8?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kelsey Chance</a> on <a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7db6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们想象一下，你在你的房子里，和你的朋友们开派对。你有一个由不同食物组成的厨房，你和你的朋友可以根据需要去拿。当你从厨房拿食物时，你实质上是在改变厨房的状态。当你意识到厨房食物不足时，你可以去冰箱给厨房储备食物。</p><p id="5d5a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以类似的方式，Redux允许我们检索和修改多个组件共享的全局值。这些组件就像我们的朋友一样，都试图访问同一个全球商店，也就是我们的厨房。与此同时，他们还可以为我们的全球商店重新进货，改造我们的“厨房”，用更多的食物填满它。</p><p id="6883" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在简单说一下Redux-Thunk和Redux-Saga的表现。</p><p id="60ff" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们来看看下面的流程:</p><p id="2195" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="le">动作创建者- &gt;动作- &gt;分派- &gt;减少者- &gt;全局状态- &gt;动作创建者</em></p><p id="1e98" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">…等等。</p><p id="83dc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你想知道更多关于如何设置Redux的细节，请阅读这篇文章:</p><div class="lf lg gp gr lh li"><a href="https://medium.com/weekly-webtips/what-is-redux-and-how-data-flow-within-redux-fb675900fed1" rel="noopener follow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd io gy z fp ln fr fs lo fu fw im bi translated">什么是Redux，数据如何在Redux中流动</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">没错！储物应该是你想到的第一个词。</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">medium.com</p></div></div><div class="lr l"><div class="ls l lt lu lv lr lw jt li"/></div></div></a></div><p id="9cc2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">简而言之，程序中有动作创建者，它们是执行某种动作的函数(API调用、显示加载指示器等)。一旦完成，我们就向reducer发送一个动作。</p><p id="481d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">缩减器更新全局状态，任何使用全局状态的组件都会立即看到变化。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lx"><img src="../Images/bc56c131b0c462f23f77b344d761df98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iWwj1TUQBRlz6jDj"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Photo by <a class="ae lc" href="https://unsplash.com/@kellysikkema?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kelly Sikkema</a> on <a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a3d9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">容易记住对吗？再来看看Redux-Saga。</p><p id="9b59" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="le">视图层- &gt;动作- &gt; saga中间件- &gt;全局存储- &gt;视图层</em></p><p id="4b3e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">…等等。</p><p id="3586" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">它与我们拥有的Redux Thunk非常相似。然而，中间件理解和处理动作的行为是不同的。</p><p id="4bc7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了理解其中的区别，让我们从一个Redux-Saga项目开始。</p><p id="e817" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第一步:</strong>运行<code class="fe ly lz ma mb b">npx create-react-app sample-redux-app</code></p><p id="48fa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第二步:</strong>运行<code class="fe ly lz ma mb b">npm install — save react-redux redux redux-saga</code></p><p id="69e6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这些将是为项目实现Redux-Saga所需的库。</p><p id="2920" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤3: </strong>运行<code class="fe ly lz ma mb b">npm install</code>来完成项目所需的其余包的设置。</p><p id="7800" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第4步:</strong>转到<strong class="jx io"> src/index.js </strong>，用以下内容替换代码:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="cbb6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这里，我们通过提供者包装整个应用程序，提供应用程序redux功能。</p><p id="1648" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第五步:</strong>转到<strong class="jx io"> src </strong>，创建一个名为<strong class="jx io"> store </strong>的文件夹。在该文件夹中，创建一个名为<strong class="jx io"> configureStore.js </strong>的文件，内容如下:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="0028" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这里，我们创建中间件层，并使用我们的根reducer创建一个全局存储，根reducer是这个应用程序中所有reducer的组合。</p><p id="dae6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">注意这里有一条线叫做<code class="fe ly lz ma mb b">sagaMiddleware.run(rootSaga)</code>。在Redux-Saga中，调度操作是通过生成器处理的。</p><p id="f19e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们这么想吧——在Redux-Saga中，有watcher函数。除了拉动未来的动作，他们实际上不做任何事情。它们相当于监听器函数，知道在触发时调用哪个调度函数。我们将在本文后面进一步讨论这一点。</p><p id="e666" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第六步:</strong>转到<strong class="jx io"> src </strong>创建一个名为<strong class="jx io"> sagas </strong>的文件夹。创建一个名为<strong class="jx io"> rootSaga.js </strong>的文件，内容如下:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="e475" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里的这个文件包含一个观察器(或者监听器，如果更直观的话)函数，它可以监听所有其他的传奇故事。现在让我们看看其他的传奇文件。</p><p id="a4c3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第七步:</strong>转到<strong class="jx io"> src/sagas </strong>，创建一个名为<strong class="jx io"> category.js </strong>的文件:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="667a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第8步</strong>:现在转到<strong class="jx io"> src/sagas </strong>，创建另一个名为<strong class="jx io"> count.js </strong>的文件:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="9420" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这里，我们创建了观察器函数— watchCategorySagas和watchCountSagas。这些功能将被合并到一个rootSaga中，由主应用程序监听。</p><p id="5abd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">嗯…听？我们在说什么？</p><p id="7491" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们修改一下<strong class="jx io"> app.js </strong>，并加入一些使用这些saga函数的例子。</p><p id="965e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第九步:</strong>转到<strong class="jx io"> src </strong>，用以下内容修改<strong class="jx io"> app.js </strong>:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="f78a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这里，用户可以单击“+”或“-”，这将触发“向上计数”或“向下计数”类型的调度操作。当一个动作被触发时，sagas中的watcher函数监听并将该动作映射到将被调用的函数。</p><p id="6734" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们来看看来自<strong class="jx io"> src/sagas/count.js </strong>的这段代码:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="a20d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当调度函数触发' COUNT_UP '时，调用countUpAsync函数。countUpAsync(或countDownAsync)是修改redux状态的部分。</p><p id="fdad" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你可能会想，如果我们有Redux-Thunk，那么为什么还要使用Redux-Saga呢？反之亦然。有了Redux-Saga，继续使用Redux Thunk还有意义吗？</p><p id="0f11" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们这样来看一下Redux-Thunk:您调用了一个动作创建器函数。它将调用一个API，并根据API的结果更新全局状态。动作调度器和API逻辑在一个动作调度器功能中混合使用。</p><p id="c96a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另一方面，Redux-Saga需要很好地了解发生器和redux/saga效果函数是如何工作的。</p><p id="fdf8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">什么是效果函数？这些效果函数包含一些要由中间件解析的信息。它告诉中间件，当观察器函数接收到一个动作时，调用回调时应该采用什么行为。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi me"><img src="../Images/d4653f1c656e4d79180726ea7b8386ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H0iHyT80RSvKPIRY"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Photo by <a class="ae lc" href="https://unsplash.com/@kevinjiner?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kévin JINER</a> on <a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e30f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">那么，使用Redux-Thunk与Redux-Saga相比有哪些优势？</p><p id="56ce" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">对于一个初学者项目来说，Redux Thunk非常容易学习，特别是如果你想一开始就学习reaction。您需要关心的只是一个动作创建器，它既可以进行异步调用(主要是API调用)，也可以将动作发送到中间件，然后由中间件更新存储。视图利用选择器从存储中读取并显示数据——仅此而已。</p><p id="eaf2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另一方面，Redux-Saga有很多有用的助手功能，这些功能都是由redux-saga/effects提供的。这些函数使我们能够管理副作用，例如使异步调用更容易以更可预测的方式访问和管理。此外，测试更容易，因为生成器逻辑与所有异步调用逻辑以及更新状态的逻辑是分开的。</p><p id="9373" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您应该使用哪一种？这要由你来决定。</p><p id="10c6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="le">更内容于</em> <a class="ae lc" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="le">通俗易懂</em> </a></p></div></div>    
</body>
</html>