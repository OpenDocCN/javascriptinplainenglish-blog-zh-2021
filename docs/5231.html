<html>
<head>
<title>Next.js Firebase v9: Authentication with Firebase Admin SDK</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Next.js Firebase v9:使用Firebase Admin SDK进行身份验证</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/nextjs-firebase-v9-part-20-authentication-with-firebase-admin-sdk-2ad57db8e4c1?source=collection_archive---------3-----------------------#2021-10-25">https://javascript.plainenglish.io/nextjs-firebase-v9-part-20-authentication-with-firebase-admin-sdk-2ad57db8e4c1?source=collection_archive---------3-----------------------#2021-10-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2ff5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第20部分:添加Firebase Admin SDK</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/11e0d56a62ec8acce28cb0461772f251.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PgS5CX5J9WuCxpjL"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@baciutudor?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tudor Baciu</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3f55" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一部分，我们准备待办事项的服务器端呈现。但是对于渲染，我们必须在构建时进行认证。</p><p id="72dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们需要将Firebase admin SDK添加到我们的应用程序中。</p><h2 id="cd9a" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">在firebase网站生成私钥</h2><p id="4cbd" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">第一步是从Firebase网站生成一个私钥。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/263fe772f9b16916b31249c92a750f11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FzWW40cWLnk7-NFDReJRow.png"/></div></div></figure><p id="6a5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">点击项目设置，点击"生成新私钥"。它将生成JSON文件。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="e1c5" class="ls lt iq ms b gy mw mx l my mz">yarn add firebase-admin</span></pre><h2 id="c19a" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">添加firebase管理文件</h2><p id="f222" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在根文件夹中，创建“firebaseAdmin.js”。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="50ad" class="ls lt iq ms b gy mw mx l my mz">const admin = require("firebase-admin");</span><span id="a1e8" class="ls lt iq ms b gy na mx l my mz">const serviceAccount = require("./secrets.json");</span><span id="ec08" class="ls lt iq ms b gy na mx l my mz">export const verifyIdToken = (token) =&gt; {</span><span id="0f86" class="ls lt iq ms b gy na mx l my mz">if (!admin.apps.length) {</span><span id="2d0f" class="ls lt iq ms b gy na mx l my mz">admin.initializeApp({</span><span id="8122" class="ls lt iq ms b gy na mx l my mz">credential: admin.credential.cert(serviceAccount),</span><span id="f597" class="ls lt iq ms b gy na mx l my mz">});</span><span id="febe" class="ls lt iq ms b gy na mx l my mz">}</span><span id="0e94" class="ls lt iq ms b gy na mx l my mz">return admin</span><span id="9c56" class="ls lt iq ms b gy na mx l my mz">.auth()</span><span id="e0f1" class="ls lt iq ms b gy na mx l my mz">.verifyIdToken(token)</span><span id="ff88" class="ls lt iq ms b gy na mx l my mz">.catch((error) =&gt; {</span><span id="c141" class="ls lt iq ms b gy na mx l my mz">throw error;</span><span id="a688" class="ls lt iq ms b gy na mx l my mz">});</span><span id="08d4" class="ls lt iq ms b gy na mx l my mz">};</span></pre><p id="e9a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它验证是JWT的令牌。如果成功了，就不会有什么不好的事情发生；否则，它会捕获错误。</p><p id="6ba4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">稍后我们将使用这个函数来验证令牌。</p><h1 id="e2f1" class="nb lt iq bd lu nc nd ne lx nf ng nh ma jw ni jx md jz nj ka mg kc nk kd mj nl bi translated">关注我们:<a class="ae kv" href="https://www.youtube.com/channel/UCu4-4FnutvSHVo9WHvq80Ww?sub_confirmation=1" rel="noopener ugc nofollow" target="_blank"> YouTube </a>，<a class="ae kv" href="https://ckmobile.medium.com/" rel="noopener"> Medium </a>，<a class="ae kv" href="https://www.udemy.com/user/cyruschan2/" rel="noopener ugc nofollow" target="_blank"> Udemy </a>，<a class="ae kv" href="https://www.linkedin.com/company/ckmobi/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>，<a class="ae kv" href="https://twitter.com/ckmobilejavasc1" rel="noopener ugc nofollow" target="_blank"> Twitter </a>，<a class="ae kv" href="https://www.instagram.com/ckmobile8050" rel="noopener ugc nofollow" target="_blank"> Instagram </a>，<a class="ae kv" href="https://app.gumroad.com/ckmobile" rel="noopener ugc nofollow" target="_blank"> Gumroad </a></h1><p id="c660" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated"><em class="nm">更多内容看</em><strong class="ky ir"><em class="nm"/></strong><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="nm">说白了. io </em> </strong> </a></p></div></div>    
</body>
</html>