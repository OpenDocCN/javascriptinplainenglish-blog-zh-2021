<html>
<head>
<title>Make HTTP Requests in a Vue App with Fetch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Fetch在Vue应用程序中发出HTTP请求</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/make-http-requests-in-a-vue-app-with-fetch-adb81884248a?source=collection_archive---------14-----------------------#2021-01-21">https://javascript.plainenglish.io/make-http-requests-in-a-vue-app-with-fetch-adb81884248a?source=collection_archive---------14-----------------------#2021-01-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/aacbfc99dc332c79ee69fa0e38a0d89f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mzcXNAiyFkQnYgpO"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@miaanderson?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mia Anderson</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="23bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Fetch API是一个内置于现代浏览器中的HTTP客户端。</p><p id="a316" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们可以用它来发出HTTP请求，而不需要安装任何东西。</p><p id="50c2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何在Vue应用程序中使用Fetch API发出请求。</p><h1 id="4b1a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">提出请求</h1><p id="389a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">fetch</code>函数发出请求。</p><p id="148d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0d75" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div id="app"&gt;&lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>export default {<br/>  name: "App",<br/>  async beforeMount() {<br/>    const res = await fetch("https://jsonplaceholder.typicode.com/posts/1", {<br/>      method: "GET",<br/>      mode: "cors"<br/>    });<br/>    const data = await res.json();<br/>    console.log(data);<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="59db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用<code class="fe me mf mg mh b">fetch</code>做一个简单的GET请求。</p><p id="d238" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个参数是URL。</p><p id="86e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个是具有<code class="fe me mf mg mh b">method</code>和<code class="fe me mf mg mh b">mode</code>属性的对象。</p><p id="e5eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">method</code>属性是请求方法。</p><p id="c2f3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">mode</code>被设置为<code class="fe me mf mg mh b">'cors'</code>以允许我们进行跨原点请求。</p><p id="244b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要发出POST请求，我们可以:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2ce7" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div id="app"&gt;&lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>export default {<br/>  name: "App",<br/>  async beforeMount() {<br/>    const res = await fetch("https://jsonplaceholder.typicode.com/posts", {<br/>      method: "POST",<br/>      headers: {<br/>        "Content-Type": "application/json"<br/>      },<br/>      body: JSON.stringify({<br/>        title: "foo",<br/>        body: "bar",<br/>        userId: 1<br/>      })<br/>    });<br/>    const data = await res.json();<br/>    console.log(data);<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="ae91" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们设置<code class="fe me mf mg mh b">headers</code>属性来设置请求头。</p><p id="247e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">body</code>属性具有用于请求体的stringified JSON对象。</p><h1 id="5fee" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">上传文件</h1><p id="6973" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要上传文件，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="da99" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;input type="file" @change="onChange"&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>export default {<br/>  name: "App",<br/>  methods: {<br/>    async onChange(ev) {<br/>      const formData = new FormData();<br/>      formData.append("username", "abc123");<br/>      formData.append("avatar", ev.target.files[0]);<br/>      const res = await fetch(<br/>        "https://run.mocky.io/v3/c5189845-2a93-49aa-85c7-70bc64e8af90 ",<br/>        {<br/>          method: "PUT",<br/>          body: formData<br/>        }<br/>      );      <br/>      console.log(res);<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="97b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个文件输入和一个更改事件监听器来监听文件选择的更改。</p><p id="99d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">onChange</code>方法是变更监听器。</p><p id="d1de" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在其中，我们创建了一个<code class="fe me mf mg mh b">FormData</code>实例，并用<code class="fe me mf mg mh b">ev.target.files[0]</code>文件对象将文件添加到其中。</p><p id="2c45" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们通过将<code class="fe me mf mg mh b">body</code>属性设置为<code class="fe me mf mg mh b">formData</code>对象来发出请求。</p><p id="e767" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="55d6" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;input type="file" @change="onChange" multiple&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>export default {<br/>  name: "App",<br/>  methods: {<br/>    async onChange(ev) {<br/>      const formData = new FormData();<br/>      formData.append("username", "abc123");<br/>      for (const file of ev.target.files) {<br/>        formData.append("photos", file);<br/>      }<br/>      const res = await fetch(<br/>        "https://run.mocky.io/v3/c5189845-2a93-49aa-85c7-70bc64e8af90 ",<br/>        {<br/>          method: "PUT",<br/>          body: formData<br/>        }<br/>      );<br/>      console.log(res);<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="f509" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用for-of循环遍历<code class="fe me mf mg mh b">ev.target.files</code>对象，将所有文件从对象添加到请求体。</p><h1 id="0784" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">检查请求是否成功</h1><p id="cfff" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过捕捉错误来检查请求是否成功。</p><p id="67db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">只会引发网络错误。这不包括带有400或500系列错误代码的已完成请求。</p><p id="ba08" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="fd4c" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div id="app"&gt;&lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>export default {<br/>  name: "App",<br/>  async beforeMount() {<br/>    try {<br/>      const res = await fetch("https://picsum.photos/200");<br/>      const data = await res.blob();<br/>      console.log(data);<br/>    } catch (error) {<br/>      console.error(error);<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="5fbb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用<code class="fe me mf mg mh b">catch</code>块捕捉错误。</p><h1 id="7a13" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="f8ca" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用Fetch API在Vue应用程序中发出HTTP请求。</p><p id="fd75" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>