<html>
<head>
<title>Making Most of HTML Input Box Built-In Validation Methods</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">充分利用HTML输入框内置的验证方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/making-most-of-html-input-box-built-in-validation-methods-e87e502ba6a9?source=collection_archive---------10-----------------------#2021-03-02">https://javascript.plainenglish.io/making-most-of-html-input-box-built-in-validation-methods-e87e502ba6a9?source=collection_archive---------10-----------------------#2021-03-02</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="72bc" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用普通JavaScript的输入框验证中一些较少使用的方法</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/a88d635f6689177691a3055232e1d2bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sCJCKGAqpnTuf1Qe"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@firosnv?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Firos nv</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e1b8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们都使用了输入字段，处理了验证，显示了错误消息。像Angular这样的框架有先进的方法来创建表单和处理验证，好的旧的普通JavaScript确实有一些有趣的特性来简化我们的开发。</p><p id="02df" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在本文中，我将讨论什么是有效性状态，如何检查输入框的有效性，显示错误消息，使用CSS伪类进行验证状态，以及处理自定义验证消息。</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="40e2" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">1.有效状态</h1><p id="1b04" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">使用V <em class="mt">验证状态</em>界面可以知道验证失败的原因。有一些默认情况下适用于输入框的基本验证。例如:<code class="fe mu mv mw mx b">required</code>、<code class="fe mu mv mw mx b">min</code>值、<code class="fe mu mv mw mx b">max</code>值、<code class="fe mu mv mw mx b">minlength</code>、<code class="fe mu mv mw mx b">maxlength</code>和<code class="fe mu mv mw mx b">pattern</code>。<code class="fe mu mv mw mx b">ValidityState</code>为您提供验证失败的确切情况。要知道输入的有效性状态，在目标元素上使用<code class="fe mu mv mw mx b">validity</code>。</p><p id="0425" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">示例1:</p><pre class="kd ke kf kg gt my mx mz na aw nb bi"><span id="9d77" class="nc lx in mx b gy nd ne l nf ng">HTML:<br/>&lt;input type="number" id="input1" max="6" min="3" value="33"&gt;</span><span id="1314" class="nc lx in mx b gy nh ne l nf ng">JS:<br/>document.getElementById("input1").validity</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/23d2b8b36719092f763066e5b163a95f.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*jf7H4Xlv3p1uoku5NUR07A.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Example-1 for ValidityState</figcaption></figure><p id="b0ff" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在<code class="fe mu mv mw mx b">input1</code>上，最小值和最大值分别是3和6，其值是33。因此<code class="fe mu mv mw mx b">rangeOverflow</code>就是<code class="fe mu mv mw mx b">true</code>。</p><p id="4daa" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">示例2:</p><pre class="kd ke kf kg gt my mx mz na aw nb bi"><span id="c9d2" class="nc lx in mx b gy nd ne l nf ng">HTML:<br/>&lt;input type="tel" id="input2"  required value=""&gt;</span><span id="7482" class="nc lx in mx b gy nh ne l nf ng">JS:<br/>document.getElementById("input2").validity</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/a2b5080114c28e276bb0100cdfc89fd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*OEViORP2CNVKRGVCJNos1w.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Example-2 of Validity State</figcaption></figure><p id="d3d6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在<code class="fe mu mv mw mx b">input2</code>上，不满足<code class="fe mu mv mw mx b">required</code>验证，故<code class="fe mu mv mw mx b">valueMissing</code>为<code class="fe mu mv mw mx b">true</code>。</p><p id="f926" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您还可能观察到，<code class="fe mu mv mw mx b">valid</code>在两种情况下均为假。这通常表明输入验证有问题。</p><h1 id="6705" class="lw lx in bd ly lz nk mb mc md nl mf mg jt nm ju mi jw nn jx mk jz no ka mm mn bi translated"><strong class="ak"> 2 .检查输入的有效性</strong></h1><p id="53f8" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">有两种方法可以检查您的输入是否没有验证错误。</p><ol class=""><li id="8fdb" class="np nq in kv b kw kx kz la lc nr lg ns lk nt lo nu nv nw nx bi translated">在目标元素上使用<code class="fe mu mv mw mx b">checkValidity()</code>。如果有验证错误，则返回<code class="fe mu mv mw mx b">false</code>。</li><li id="7cfb" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo nu nv nw nx bi translated">通过在目标元素上使用<code class="fe mu mv mw mx b">validity.valid</code>来使用有效性状态。</li></ol><p id="5d65" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">示例:</p><pre class="kd ke kf kg gt my mx mz na aw nb bi"><span id="00db" class="nc lx in mx b gy nd ne l nf ng">//Using checkValidity()<br/>HTML:<br/>&lt;input type="text" id="input3" pattern="[A-Z]{4}" value="icecream"&gt;</span><span id="1b3b" class="nc lx in mx b gy nh ne l nf ng">JS:<br/>document.getElementById("input3").checkValidity() //false</span><span id="fcff" class="nc lx in mx b gy nh ne l nf ng">//Using Validity State<br/>document.getElementById("input3").validity.valid //false</span></pre><p id="adfe" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">两者的区别在于:</p><ul class=""><li id="cdb2" class="np nq in kv b kw kx kz la lc nr lg ns lk nt lo od nv nw nx bi translated"><code class="fe mu mv mw mx b">checkValidity()</code>适用于单个输入元件，也适用于整个表单，而<code class="fe mu mv mw mx b">ValidityState</code>仅适用于单个输入元件。</li></ul><p id="398a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">示例:</p><pre class="kd ke kf kg gt my mx mz na aw nb bi"><span id="5330" class="nc lx in mx b gy nd ne l nf ng">HTML:<br/>&lt;form name="myForm"&gt;<br/>    &lt;input type="tel" id="f1"  required value=""&gt;<br/>    &lt;input type="text" id="f2" required value="icecream"&gt;<br/>&lt;/form&gt;</span><span id="c58c" class="nc lx in mx b gy nh ne l nf ng">JS:<br/>document.getElementsByName("myForm")[0].checkValidity(); //false</span></pre><h1 id="5ec1" class="lw lx in bd ly lz nk mb mc md nl mf mg jt nm ju mi jw nn jx mk jz no ka mm mn bi translated">3.验证消息</h1><p id="a4e3" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">对于输入框上的基本验证，如<code class="fe mu mv mw mx b">min</code>值、<code class="fe mu mv mw mx b">max</code>值、<code class="fe mu mv mw mx b">minlength</code>、<code class="fe mu mv mw mx b">maxlength</code>、<code class="fe mu mv mw mx b">required</code>或<code class="fe mu mv mw mx b">pattern</code>，JavaScript确实有一些内置的验证消息。利用目标元素上的<code class="fe mu mv mw mx b">validationMessage</code>属性。</p><p id="ed2b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">示例:</p><pre class="kd ke kf kg gt my mx mz na aw nb bi"><span id="69c9" class="nc lx in mx b gy nd ne l nf ng">HTML:<br/>&lt;input type="number" id="input1" max="6" min="3" required value="33"&gt;</span><span id="0247" class="nc lx in mx b gy nh ne l nf ng">JS:<br/>document.getElementById("input1").validationMessage //Value must be less than or equal to 6.</span></pre><h1 id="e379" class="lw lx in bd ly lz nk mb mc md nl mf mg jt nm ju mi jw nn jx mk jz no ka mm mn bi translated">4.用于验证的CSS伪类</h1><p id="46e6" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">CSS伪类<code class="fe mu mv mw mx b">valid</code>和<code class="fe mu mv mw mx b">invalid</code>可以在目标元素上使用，以适当地处理样式。</p><p id="327a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">示例:</p><pre class="kd ke kf kg gt my mx mz na aw nb bi"><span id="d41f" class="nc lx in mx b gy nd ne l nf ng">HTML:<br/>&lt;input type="number" id="input1" max="6" min="3" required value="33"&gt;</span><span id="bbd5" class="nc lx in mx b gy nh ne l nf ng">CSS:<br/>#input1:invalid{<br/>  border-color: red; <br/>}</span></pre><h2 id="f1b9" class="nc lx in bd ly oe of dn mc og oh dp mg lc oi oj mi lg ok ol mk lk om on mm oo bi translated">各种验证状态的CSS伪类列表:</h2><ul class=""><li id="8551" class="np nq in kv b kw mo kz mp lc op lg oq lk or lo od nv nw nx bi translated">:有效-如果满足所有输入约束。</li><li id="8c64" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo od nv nw nx bi translated">:无效-如果不满足至少一个输入约束。</li><li id="36a7" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo od nv nw nx bi translated">:超出范围—当值超出<code class="fe mu mv mw mx b">min</code>和<code class="fe mu mv mw mx b">max</code>值的范围时。</li><li id="6952" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo od nv nw nx bi translated">:必需-当不满足必需的约束时。</li><li id="ebe8" class="np nq in kv b kw ny kz nz lc oa lg ob lk oc lo od nv nw nx bi translated">:可选—提交表单时不需要输入。</li></ul><h1 id="8320" class="lw lx in bd ly lz nk mb mc md nl mf mg jt nm ju mi jw nn jx mk jz no ka mm mn bi translated">5.自定义验证消息</h1><p id="c43a" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">如果您想使用自定义验证消息而不是内置消息，请在输入字段上使用<code class="fe mu mv mw mx b">setCustomValidity</code>。</p><p id="ff97" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">示例:</p><pre class="kd ke kf kg gt my mx mz na aw nb bi"><span id="25ad" class="nc lx in mx b gy nd ne l nf ng">HTML:<br/>&lt;input type="text" id="input3" pattern="[A-Z]{4}" value="icecream"&gt;</span><span id="f4cd" class="nc lx in mx b gy nh ne l nf ng">JS:<br/>Built-in Validation Message:<br/>document.getElementById("input3").validationMessage //Please match the requested format.</span><span id="12b7" class="nc lx in mx b gy nh ne l nf ng"><strong class="mx io">Custom Message:</strong><br/>document.getElementById("input3").setCustomValidity("Only uppercase values are allowed with max length 4");</span><span id="972f" class="nc lx in mx b gy nh ne l nf ng">document.getElementById("input3").validationMessage //Only uppercase values are allowed with max length 4</span></pre><p id="90ae" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">另一点需要注意的是，对于自定义错误，<code class="fe mu mv mw mx b">ValidityState</code>对象中的<code class="fe mu mv mw mx b">customError</code>属性为真。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi os"><img src="../Images/7daa73f02451181b09792b2a0edf099e.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*u8VWPqZyhlAwXHrxpGk32w.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Validity State Object for Custom Errors.</figcaption></figure><p id="7566" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">确保一旦满足所有约束且输入值正确，<code class="fe mu mv mw mx b">setCustomValidity</code>的值应为空。否则，输入仍将处于无效状态。</p><p id="8386" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">示例:</p><pre class="kd ke kf kg gt my mx mz na aw nb bi"><span id="305e" class="nc lx in mx b gy nd ne l nf ng">var pattern = document.getElementById("input3").pattern;<br/>var regex = new RegExp(pattern);<br/>var elm = document.getElementById("input3");</span><span id="7026" class="nc lx in mx b gy nh ne l nf ng">if(!regex.test(elm.value)){<br/>  elm.setCustomValidity("Only uppercase values are allowed with max length 4");<br/>}else{<br/>  elm.setCustomValidity("");<br/>}</span></pre><h1 id="1c8b" class="lw lx in bd ly lz nk mb mc md nl mf mg jt nm ju mi jw nn jx mk jz no ka mm mn bi translated">结论</h1><p id="d0b3" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">我们已经看到了HTML5输入验证方法和用法的基础。ValidityState的浏览器兼容性可以在这里检查<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Web/API/ValidityState" rel="noopener ugc nofollow" target="_blank">。并非每个浏览器都支持每个属性。</a></p><p id="ff9f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">嵌入一些我们在这里讨论的各种方法的例子。</p><p id="bae4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">希望这篇文章有用！</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ot ou l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">HTML5 Validations Example</figcaption></figure><p id="ccbb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">参考文献:</strong></p><p id="1f87" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">validity state:<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Web/API/ValidityState" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/API/validity state</a></p><p id="4ae2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">check validity:<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLObjectElement/checkValidity" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/API/HTMLObjectElement/check validity</a></p><p id="0047" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">setCustomValidity:<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLSelectElement/setCustomValidity" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/API/html selectelement/setCustomValidity</a></p></div></div>    
</body>
</html>