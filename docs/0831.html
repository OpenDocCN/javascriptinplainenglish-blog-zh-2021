<html>
<head>
<title>Configure Multiple Accounts in AWS CLI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在AWS CLI中配置多个帐户</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/configure-multiple-accounts-in-aws-cli-c7e4ebc799dc?source=collection_archive---------19-----------------------#2021-02-20">https://javascript.plainenglish.io/configure-multiple-accounts-in-aws-cli-c7e4ebc799dc?source=collection_archive---------19-----------------------#2021-02-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/628f7f2226eb7d84d6a9389f9a5f0711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q39rXouXzmTQ6NtP.png"/></div></div></figure><p id="a380" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">AWS CLI是一个很好的工具，可以做任何与AWS相关的事情。我们可以使用访问密钥ID和秘密访问密钥来配置帐户的访问密钥。但是如果我们想在同一台电脑上使用多个账户呢？如果我们在多个AWS项目上工作，或者对于不同的项目有不同的IAM角色？</p><p id="c24c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在设置多个帐户之前，让我们先设置一个帐户。</p><h1 id="c967" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">创建AWS配置文件</h1><p id="daef" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">为了验证我们自己，我们需要创建一个AWS概要文件，用于所有未来的会话。访问密钥用于签署使用我们的程序向AWS发出的请求。我们将首先在AWS控制台中创建一个概要文件。然后以. csv格式下载。(如果丢失，将无法恢复，并且需要重新创建具有权限的新用户)。</p><p id="91a1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果我们计划在与AWS的通信中只使用一个用户配置文件，我们可以使用命令:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="8c04" class="mf ku in mb b gy mg mh l mi mj">$ aws configure<br/>AWS Access Key ID [None]: &lt;Enter Access Key&gt;<br/>AWS Secret Access Key [None]: &lt;Enter Secret Access Key&gt;<br/>Default region name [None]: &lt;Enter Region&gt;<br/>Default output format [None]: json</span></pre><p id="e2d9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这将在~/中创建两个文件。aws(或%USERPROFILE%)。aws/在Windows上)目录。一个是凭证，另一个是配置。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="05d1" class="mf ku in mb b gy mg mh l mi mj"># ~/.aws/credentials<br/>[default]<br/>aws_access_key_id=&lt;Your Access Key&gt;<br/>aws_secret_access_key=&lt;Your Secret Access Key&gt;<br/><br/># ~/.aws/config<br/>[default]<br/>region=&lt;Your Region&gt;<br/>output=json</span></pre><h1 id="7e8b" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">命名AWS配置文件</h1><p id="86a3" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">AWS CLI允许我们设置命名配置文件(这将帮助我们创建多个帐户)。命名的概要文件只是一个附加了名称的概要文件。为了创建一个命名的概要文件，我们使用:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="54e0" class="mf ku in mb b gy mg mh l mi mj">$ aws configure --profile &lt;profile name&gt;</span></pre><p id="320d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">假设我们在AWS CLI中使用名称dev创建了一个概要文件。对配置文件的相应更新将是:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="2dc3" class="mf ku in mb b gy mg mh l mi mj"># ~/.aws/credentials<br/>[default]<br/>aws_access_key_id=&lt;Your Access Key&gt;<br/>aws_secret_access_key=&lt;Your Secret Access Key&gt;<br/><br/>[dev]<br/>aws_access_key_id=&lt;Dev Access Key&gt;<br/>aws_secret_access_key=&lt;Dev Secret Access Key&gt;<br/><br/># ~/.aws/config<br/>[default]<br/>region=&lt;Your Region&gt;<br/>output=json<br/><br/>[profile dev]<br/>region=&lt;Dev Region&gt;<br/>output=json</span></pre><h1 id="3da5" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">在AWS CLI中配置多个帐户</h1><p id="957a" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">因为我们可以创建多个概要文件，所以我们可以简单地使用命名概要文件来创建多个帐户。我们可以为任意多的用户创建任意多的配置文件。AWS CLI按以下顺序查找凭据:</p><ul class=""><li id="862d" class="mk ml in jx b jy jz kc kd kg mm kk mn ko mo ks mp mq mr ms bi translated"><strong class="jx io"> AWS CLI选项:</strong>调用CLI时传入的命令行参数</li><li id="a97f" class="mk ml in jx b jy mt kc mu kg mv kk mw ko mx ks mp mq mr ms bi translated"><strong class="jx io">环境变量:</strong>将AWS_ACCESS_KEY_ID和AWS_SECRET_ACCESS_KEY作为环境变量导出</li><li id="6632" class="mk ml in jx b jy mt kc mu kg mv kk mw ko mx ks mp mq mr ms bi translated"><strong class="jx io"> AWS凭证文件:</strong>我们刚刚讨论的文件</li></ul><p id="7000" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">并且凭证文件也可以有多个配置文件。如果我们想要使用凭证文件，我们需要在AWS CLI中运行命令时添加“-profile”标志。</p><p id="c5f9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">每次都将配置文件指定为CLI参数可能是一项单调乏味的任务。因此，最好使用环境变量。我们甚至可以使用以下方法将概要文件导出到环境变量中:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="fc18" class="mf ku in mb b gy mg mh l mi mj">export AWS_PROFILE=dev</span></pre><p id="fe28" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">dev AWS配置文件将用于所有后续命令，而无需显式指定它。</p><h2 id="ed92" class="mf ku in bd kv my mz dn kz na nb dp ld kg nc nd lh kk ne nf ll ko ng nh lp ni bi translated">结论</h2><p id="835f" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">我们使用AWS CLI对多个帐户的简单设置到此结束。如果你有任何意见，请在下面留言。</p></div><div class="ab cl nj nk hr nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ig ih ii ij ik"><p id="a29b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="nq">原载于2021年2月20日https://www.wisdomgeek.com</em><em class="nq"/><a class="ae nr" href="https://www.wisdomgeek.com/development/aws/configure-multiple-accounts-in-aws-cli/" rel="noopener ugc nofollow" target="_blank"><em class="nq">。</em></a></p></div></div>    
</body>
</html>