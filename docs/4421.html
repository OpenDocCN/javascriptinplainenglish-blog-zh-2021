<html>
<head>
<title>How To Replace Multiple Substrings With Data From an Object in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用JavaScript中一个对象的数据替换多个子字符串</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-replace-multiple-substrings-8e9e9678bca7?source=collection_archive---------9-----------------------#2021-09-03">https://javascript.plainenglish.io/javascript-replace-multiple-substrings-8e9e9678bca7?source=collection_archive---------9-----------------------#2021-09-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="d49c" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">我不得不谷歌一下JS的东西</h2><div class=""/><div class=""><h2 id="86cc" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">或者:水合模板串</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/cf7bc8ecb5e382d05c72cee9a2e93462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tCoCnSnzjN5XMFGTpZ3fWg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Source: the author</figcaption></figure><p id="9a92" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ma">提示:在您将要学习的代码的许多用例中，</em> <a class="ae mb" rel="noopener ugc nofollow" target="_blank" href="/template-literals-in-javascript-the-complete-guide-e23f64c13aa1"> <em class="ma">模板文字</em> </a> <em class="ma">是一个更简洁的选项。</em></p><p id="5b4f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">有时，我们希望在JavaScript中替换一个字符串中的多个字符串。当我们已经在这样做的时候，经常需要用动态数据替换字符串——比如变量的值。</p><p id="7e1e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这里有一个小例子。给定此字符串:</p><p id="6635" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><code class="fe mc md me mf b">'The person name is age years old'</code></p><p id="af4e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们希望将它与来自某个对象的匹配数据相融合，该数据如下所示:</p><pre class="kp kq kr ks gt mg mf mh mi aw mj bi"><span id="79a5" class="mk ml iq mf b gy mm mn l mo mp">const person = {<br/>  name: 'Max',<br/>  age: 20<br/>}</span></pre><p id="e832" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">最后得到的字符串应该是:<code class="fe mc md me mf b">The person Max is 20 years old</code>。</p><p id="d682" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如您所见，给定字符串中的子字符串“name”和“age”与我们的对象的键完全匹配。我们的目标是用对象值来水合一个字符串模板。我们是这样做的。</p><p id="6587" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">诀窍是将regex与string.replace函数结合起来。</p><p id="bfb7" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">首先，我们需要构建正则表达式。在许多情况下，我们只是将一些正则表达式传递给string.replace函数。然而，这一次我们需要基于我们拥有的对象生成一个动态正则表达式。因此，仅仅传递regex是不行的，我们需要生成它。</p><p id="2596" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">为了用JavaScript生成正则表达式，我们使用了<code class="fe mc md me mf b">RegExp</code>类。我们希望接收一个包含我们的对象键的regex结构。这个正则表达式可以传递给string.replace，然后用匹配的对象值替换匹配的字符串。</p><p id="54f7" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">尽管如此，给定对象<code class="fe mc md me mf b">const person = { name: 'Max', age: 20 }</code>，我们可以用以下方法将它转换成必要的正则表达式:</p><pre class="kp kq kr ks gt mg mf mh mi aw mj bi"><span id="5266" class="mk ml iq mf b gy mm mn l mo mp">Object.keys(person).join('|')</span></pre><p id="0615" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><code class="fe mc md me mf b">Object.keys</code>是对象中的一个键数组(姓名和年龄)，我们用一个逻辑OR将它连接起来，以接收:<code class="fe mc md me mf b">name|age</code> —精确匹配的正则表达式结构。然后，将该字符串传递给RegExp实例:</p><pre class="kp kq kr ks gt mg mf mh mi aw mj bi"><span id="55b8" class="mk ml iq mf b gy mm mn l mo mp">const regex = new RegExp(Object.keys(person).join('|'), 'gi')</span></pre><p id="9e52" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">最后，让我们使用string.replace函数将所有东西放在一起。我在代码下面解释一下:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="f7d0" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">使用string.replace函数生成我们想要的最终水合字符串。它接受我们的正则表达式，并用属于这个键的值替换一个子串，这个子串等于我们对象中的一个实际键。</p><p id="e5d7" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在我们的例子中，<code class="fe mc md me mf b">hyrdatedString</code>是“人Max 20岁”。</p><h1 id="3df8" class="ms ml iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">使它更像模板</h1><p id="9266" class="pw-post-body-paragraph le lf iq lg b lh nj ka lj lk nk kd lm ln nl lp lq lr nm lt lu lv nn lx ly lz ij bi translated">实际上，用属于完全相同的对象键的值替换子串并不是一个有用的例子。当替换作为模板的字符串中的内容时，拥有模板语法是更干净的解决方案。我的意思是。</p><p id="c1eb" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们现在有了这样的结构，而不是以前的字符串:</p><pre class="kp kq kr ks gt mg mf mh mi aw mj bi"><span id="137e" class="mk ml iq mf b gy mm mn l mo mp">"The person {{name}} is {{age}} years old"</span></pre><p id="c6d8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">为此，我们可以使用和以前几乎一样的代码。但是首先，我们需要用<code class="fe mc md me mf b">{{</code> <code class="fe mc md me mf b">}}</code>包装我们的对象键，这样正则表达式就可以在字符串中匹配它。我们可以用下面一行代码来包装它们:</p><pre class="kp kq kr ks gt mg mf mh mi aw mj bi"><span id="8724" class="mk ml iq mf b gy mm mn l mo mp">const templatedKeys = Object.keys(person).map((item) =&gt; {<br/>  return '{{' + item + '}}'<br/>})</span></pre><p id="9f32" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们使用的正则表达式生成器保持不变，但是我们将模板化的键传递给它:</p><pre class="kp kq kr ks gt mg mf mh mi aw mj bi"><span id="2832" class="mk ml iq mf b gy mm mn l mo mp">const regex = new RegExp(templatedKeys.join('|'), 'gi')</span></pre><p id="6b99" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这就产生了像<code class="fe mc md me mf b">{{name}}|{{age}}</code>这样的正则表达式。现在，我们的正则表达式可以匹配模板的精确出现，在字符串中包装一个对象键。</p><p id="2540" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">只剩下一个问题:在没有模板语法的代码中，我们只是将对象的键传递给对象，以接收匹配值:<code class="fe mc md me mf b">return person[match]</code> —匹配过去是“name”或“age”，它们实际上是对象键。</p><p id="cf34" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在，通过正则表达式匹配的是“{{name}}”或“{{age}}”。因此，我们不能传递它们，因为它们不是对象键。为了解决这个问题，我们从匹配中移除<code class="fe mc md me mf b">{{</code>T5，以接收我们实际的对象密钥。我们可以通过剪切匹配字符串的前两个和后两个字符来实现这一点:</p><pre class="kp kq kr ks gt mg mf mh mi aw mj bi"><span id="4e38" class="mk ml iq mf b gy mm mn l mo mp"><em class="ma">return</em> person[match.slice(2, match.length -2)]</span></pre><p id="ed3a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">完整代码:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="57c2" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">请记住，通常，模板文字是在JavaScript中合成模板字符串的更好的解决方案。然而，我只是在一个真实的项目中使用了上面的代码，其中模板文字(<code class="fe mc md me mf b">`value`</code>语法)不起作用。</p><p id="0f3f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">感谢您的阅读！</p><p id="35aa" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ma">更多内容请看</em><a class="ae mb" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lg ja"><em class="ma">plain English . io</em></strong></a></p></div></div>    
</body>
</html>