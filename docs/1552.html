<html>
<head>
<title>Make Form Handling Easy in React Apps with Formik and Yup — withFormik and Yup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Formik和Yup简化React应用程序中的表单处理</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/make-form-handling-easy-in-react-apps-with-formik-and-yup-basic-validation-cd08fb43d722?source=collection_archive---------16-----------------------#2021-04-02">https://javascript.plainenglish.io/make-form-handling-easy-in-react-apps-with-formik-and-yup-basic-validation-cd08fb43d722?source=collection_archive---------16-----------------------#2021-04-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1f2bf7976de0263a5773c01e0e8fcb7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rafG5G-v32VDpr8d"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@llhheather?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Heather Lo</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d4cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Formik是一个使React应用程序中的表单处理变得简单的库。</p><p id="1d04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Yup是一个集成了Formik的库。</p><p id="6bcb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用Formik处理表单输入。</p><h1 id="80c9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">确认</h1><p id="005f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">用Formik添加验证的一种方法是将我们的表单组件转换成一个带有使用<code class="fe me mf mg mh b">withFormik</code>高阶组件进行验证的表单。</p><p id="4df1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="20d2" class="mq lc iq mh b gy mr ms l mt mu">import React from "react";<br/>import { withFormik } from "formik";</span><span id="ba41" class="mq lc iq mh b gy mv ms l mt mu">const MyForm = (props) =&gt; {<br/>  const {<br/>    values,<br/>    touched,<br/>    errors,<br/>    handleChange,<br/>    handleBlur,<br/>    handleSubmit<br/>  } = props;<br/>  return (<br/>    &lt;form onSubmit={handleSubmit}&gt;<br/>      &lt;input<br/>        type="text"<br/>        onChange={handleChange}<br/>        onBlur={handleBlur}<br/>        value={values.email}<br/>        name="email"<br/>      /&gt;<br/>      {errors.email &amp;&amp; touched.email &amp;&amp; &lt;div id="feedback"&gt;{errors.email}&lt;/div&gt;}<br/>      &lt;button type="submit"&gt;Submit&lt;/button&gt;<br/>    &lt;/form&gt;<br/>  );<br/>};</span><span id="df70" class="mq lc iq mh b gy mv ms l mt mu">const MyEnhancedForm = withFormik({<br/>  mapPropsToValues: () =&gt; ({ email: "" }),<br/>  validate: (values) =&gt; {<br/>    const errors = {};<br/>    if (!values.email) {<br/>      errors.email = "Required";<br/>    } else if (<br/>      !/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(values.email)<br/>    ) {<br/>      errors.email = "Invalid email address";<br/>    }</span><span id="a761" class="mq lc iq mh b gy mv ms l mt mu">    return errors;<br/>  },</span><span id="9fb6" class="mq lc iq mh b gy mv ms l mt mu">  handleSubmit: (values, { setSubmitting }) =&gt; {<br/>    setTimeout(() =&gt; {<br/>      alert(JSON.stringify(values, null, 2));<br/>      setSubmitting(false);<br/>    }, 1000);<br/>  },</span><span id="c2b9" class="mq lc iq mh b gy mv ms l mt mu">  displayName: "BasicForm"<br/>})(MyForm);</span><span id="37ed" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;MyEnhancedForm /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="525e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了做到这一点。</p><p id="41a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了<code class="fe me mf mg mh b">MyForm</code>组件来从<code class="fe me mf mg mh b">props</code>中获取我们需要的属性。</p><p id="e973" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">values</code>有输入值。</p><p id="e822" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">touched</code>有每个输入的触动状态。</p><p id="e284" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">errors</code>有我们在<code class="fe me mf mg mh b">validate</code>方法中设置的表单验证错误/</p><p id="7744" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">handleChange</code>有表单变更处理程序。</p><p id="798d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">handleBlur</code>有模糊处理程序。</p><p id="ed22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">handleSubmit</code>有提交处理程序。</p><p id="15fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们创建具有验证的<code class="fe me mf mg mh b">MyEnhancedForm</code>组件。</p><p id="7fe2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">mapPropsToValues</code>设置为返回初始值的函数。</p><p id="ea4b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">validate</code>检查<code class="fe me mf mg mh b">values</code>参数的值后，返回一个错误对象。</p><p id="d663" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">handleSubmit</code>具有表单提交功能。</p><p id="29aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">values</code>具有表单值。</p><p id="a963" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">setSubmitting</code>具有设置表单提交状态的功能。</p><p id="393c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">displayName</code>为调试设置组件的<code class="fe me mf mg mh b">displayName</code>属性。</p><p id="a5da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们使用<code class="fe me mf mg mh b">App</code>中的<code class="fe me mf mg mh b">MyEnhancedForm</code>来呈现表单。</p><h1 id="359b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用Yep进行基本验证</h1><p id="234e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了使表单验证更容易，我们可以使用Yup库向表单添加验证。</p><p id="8173" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d442" class="mq lc iq mh b gy mr ms l mt mu">import React from "react";<br/>import { Formik, Form, Field } from "formik";<br/>import * as Yup from "yup";</span><span id="411d" class="mq lc iq mh b gy mv ms l mt mu">const SignupSchema = Yup.object().shape({<br/>  email: Yup.string().email("Invalid email").required("Required")<br/>});</span><span id="a8f3" class="mq lc iq mh b gy mv ms l mt mu">export const ExampleForm = () =&gt; (<br/>  &lt;div&gt;<br/>    &lt;h1&gt;Signup&lt;/h1&gt;<br/>    &lt;Formik<br/>      initialValues={{<br/>        email: ""<br/>      }}<br/>      validationSchema={SignupSchema}<br/>      onSubmit={(values) =&gt; {<br/>        console.log(values);<br/>      }}<br/>    &gt;<br/>      {({ errors, touched }) =&gt; (<br/>        &lt;Form&gt;<br/>          &lt;Field name="email" type="email" /&gt;<br/>          {errors.email &amp;&amp; touched.email ? &lt;div&gt;{errors.email}&lt;/div&gt; : null}<br/>          &lt;button type="submit"&gt;Submit&lt;/button&gt;<br/>        &lt;/Form&gt;<br/>      )}<br/>    &lt;/Formik&gt;<br/>  &lt;/div&gt;<br/>);</span><span id="005e" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;ExampleForm /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="df7f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">Yup.object()</code>方法创建了<code class="fe me mf mg mh b">SignupSchema</code>。</p><p id="3386" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将一个对象传入到<code class="fe me mf mg mh b">shape</code>方法中，为该对象添加验证。</p><p id="1582" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了验证字符串，我们调用<code class="fe me mf mg mh b">Yup.string().email()</code>方法。</p><p id="ed64" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">'email'</code>的参数有验证错误信息。</p><p id="9e15" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">required</code>使该字段成为必填字段。</p><p id="e9ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将返回的对象传递给<code class="fe me mf mg mh b">validationSchema</code> prop。</p><p id="0fd9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">onSubmit</code>有提交处理程序。</p><p id="6cfb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">initialValues</code>有初始值。</p><p id="ee09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后为了创建<code class="fe me mf mg mh b">Field</code>对象，我们将<code class="fe me mf mg mh b">name</code>设置为属性，我们在<code class="fe me mf mg mh b">shape</code>方法的参数中应用了表单验证。</p><p id="2bad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">touched</code>已进入触摸输入状态。</p><h1 id="c3a2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="e320" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用Formik添加表单验证，并且使用yeah可以使这变得更容易。</p><p id="0085" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mw">更内容于</em> <a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="mw">通俗地说就是</em> </strong> </a></p></div></div>    
</body>
</html>