<html>
<head>
<title>Resize Observer with an RXJS Twist</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用RXJS扭曲调整观察点的大小</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/resize-observer-with-an-rxjs-twist-8dee5bdedce3?source=collection_archive---------7-----------------------#2021-04-06">https://javascript.plainenglish.io/resize-observer-with-an-rxjs-twist-8dee5bdedce3?source=collection_archive---------7-----------------------#2021-04-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="0962" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">当容器尺寸改变时得到通知</h2></div><h2 id="42ec" class="kc kd in bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">我们都喜欢使用CSS Flex和网格，不是吗？</h2><p id="5dd8" class="pw-post-body-paragraph ky kz in la b lb lc jo ld le lf jr lg kl lh li lj kp lk ll lm kt ln lo lp lq ig bi translated">但是，在某些情况下，容器维度的更改可能需要重新绘制其内容元素。为了解决这样的用例，<a class="ae lr" href="https://developer.mozilla.org/en-US/docs/Web/API/Resize_Observer_API" rel="noopener ugc nofollow" target="_blank"> <strong class="la io">调整观察者尺寸规范</strong> </a>发布了。</p><p id="2150" class="pw-post-body-paragraph ky kz in la b lb ls jo ld le lt jr lg kl lu li lj kp lv ll lm kt lw lo lp lq ig bi translated">我很高兴地报告，Resize Observer现在在现代浏览器 中得到广泛的<a class="ae lr" href="https://caniuse.com/?search=resize%20observer" rel="noopener ugc nofollow" target="_blank"> <strong class="la io">支持。它的类型定义也与<a class="ae lr" href="https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/948" rel="noopener ugc nofollow" target="_blank"> <strong class="la io"> this </strong> </a> PR合并在Typescript Lib中。</strong></a></p><p id="c10b" class="pw-post-body-paragraph ky kz in la b lb ls jo ld le lt jr lg kl lu li lj kp lv ll lm kt lw lo lp lq ig bi translated">然而，在<a class="ae lr" href="https://github.com/ReactiveX/rxjs" rel="noopener ugc nofollow" target="_blank"> RxJs Observables </a>的时代，我发现用于调整观察者大小的<strong class="la io"> API使用起来有点<strong class="la io">繁琐</strong>。我开始想…围绕这个API构建一个RxJs包装器会很好！</strong></p><p id="ac67" class="pw-post-body-paragraph ky kz in la b lb ls jo ld le lt jr lg kl lu li lj kp lv ll lm kt lw lo lp lq ig bi translated">这个想法引导我创建了<a class="ae lr" href="https://github.com/twig-it/from-resize" rel="noopener ugc nofollow" target="_blank"> <strong class="la io"> From-Resize </strong> </a>库。下面列出了这个库的主要目标。</p><ul class=""><li id="b002" class="lx ly in la b lb ls le lt kl lz kp ma kt mb lq mc md me mf bi translated">返回一个RxJs可观察对象，它在每次容器维度改变时发出</li><li id="e5b7" class="lx ly in la b lb mg le mh kl mi kp mj kt mk lq mc md me mf bi translated">将手表方向设置为<code class="fe ml mm mn mo b">Horizontal</code>、<code class="fe ml mm mn mo b">Vertical</code>或<code class="fe ml mm mn mo b">All</code></li><li id="2529" class="lx ly in la b lb mg le mh kl mi kp mj kt mk lq mc md me mf bi translated">设置初始去抖时间以控制发射频率</li><li id="8af0" class="lx ly in la b lb mg le mh kl mi kp mj kt mk lq mc md me mf bi translated">使用<code class="fe ml mm mn mo b">emitOnStart</code>在首次加载时获得通知</li><li id="fd1b" class="lx ly in la b lb mg le mh kl mi kp mj kt mk lq mc md me mf bi translated">利用<a class="ae lr" href="https://rxjs.dev/guide/operators" rel="noopener ugc nofollow" target="_blank"> RxJs操作员</a>的力量创造奇迹！</li></ul></div><div class="ab cl mp mq hr mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ig ih ii ij ik"><h1 id="df22" class="mw kd in bd ke mx my mz kh na nb nc kk jt nd ju ko jw ne jx ks jz nf ka kw ng bi translated">让我们看看它的实际效果吧！</h1><p id="bd89" class="pw-post-body-paragraph ky kz in la b lb lc jo ld le lf jr lg kl lh li lj kp lk ll lm kt ln lo lp lq ig bi translated"><em class="nh">演示假设:我使用ChartJs，将“responsive”选项设置为</em><strong class="la io"><em class="nh">false</em></strong><em class="nh">来演示这个示例*。</em></p><figure class="nj nk nl nm gt nn gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi ni"><img src="../Images/c8143dbb83371403f289c66746b88d74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O4DD8eYsZqRCdaGKta29TA.png"/></div></div></figure><h2 id="59f4" class="kc kd in bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">看到问题了吗</h2><ul class=""><li id="5203" class="lx ly in la b lb lc le lf kl nu kp nv kt nw lq mc md me mf bi translated">保持<em class="nh">启用从-调整</em>未选中</li><li id="243d" class="lx ly in la b lb mg le mh kl mi kp mj kt mk lq mc md me mf bi translated">图表显示在右下角的单元格中。顶部和左侧的单元格仅用于演示目的。</li></ul><p id="cf8d" class="pw-post-body-paragraph ky kz in la b lb ls jo ld le lt jr lg kl lu li lj kp lv ll lm kt lw lo lp lq ig bi translated">现在点击“<em class="nh">移除左div </em>”按钮移除左Div元素。对于这个动作，没有<strong class="la io"> <em class="nh">窗口大小调整</em> </strong>事件会被激发，因为窗口大小保持不变。</p><figure class="nj nk nl nm gt nn gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi nx"><img src="../Images/0d7684a5dea34f0b9124c114b9ce044b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vC_9AhBptWunaAMVGEtvfw.png"/></div></div></figure><ul class=""><li id="afc8" class="lx ly in la b lb ls le lt kl lz kp ma kt mb lq mc md me mf bi translated"><strong class="la io">问题</strong>:图表元素的维度现在与其父容器维度不同步。要解决这个问题，我们需要重新绘制图表。但是我们如何得到通知呢？？</li></ul><h2 id="6d8f" class="kc kd in bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">解决方法！</h2><ul class=""><li id="9104" class="lx ly in la b lb lc le lf kl nu kp nv kt nw lq mc md me mf bi translated">通过选择复选框启用<strong class="la io"> From-Resize </strong></li></ul><figure class="nj nk nl nm gt nn gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi ny"><img src="../Images/0abcd96bf3210cf95bf44fd3f76e1ed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CKp8XGATNp-y2rSZ3_5TPw.png"/></div></div></figure><ul class=""><li id="0d47" class="lx ly in la b lb ls le lt kl lz kp ma kt mb lq mc md me mf bi translated">您可以选择方向。默认值为“全部”；也就是说，它将在水平和垂直尺寸变化时发出。</li><li id="04f9" class="lx ly in la b lb mg le mh kl mi kp mj kt mk lq mc md me mf bi translated">现在通过点击“移除左div”按钮移除左Div元素。</li><li id="2a23" class="lx ly in la b lb mg le mh kl mi kp mj kt mk lq mc md me mf bi translated">图表被重新绘制。<strong class="la io">问题解决了！！</strong></li></ul><figure class="nj nk nl nm gt nn gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi nz"><img src="../Images/bd0fc8dd916be15c846398a8006d4d6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hLQZuCmjHAisZO4Xudy-og.png"/></div></div></figure><p id="ffa4" class="pw-post-body-paragraph ky kz in la b lb ls jo ld le lt jr lg kl lu li lj kp lv ll lm kt lw lo lp lq ig bi translated">这次成功了，因为我们从-resize  observable订阅了<strong class="la io">，并且在每次发射时，我们都重新绘制图表。</strong></p><p id="212c" class="pw-post-body-paragraph ky kz in la b lb ls jo ld le lt jr lg kl lu li lj kp lv ll lm kt lw lo lp lq ig bi translated">可以在这里  <strong class="la io">玩这个互动试玩app <a class="ae lr" href="https://twig-it.github.io/from-resize/" rel="noopener ugc nofollow" target="_blank"> <strong class="la io">。</strong></a></strong></p></div><div class="ab cl mp mq hr mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ig ih ii ij ik"><h2 id="a7ae" class="kc kd in bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">用法示例</h2><figure class="nj nk nl nm gt nn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="c38b" class="pw-post-body-paragraph ky kz in la b lb ls jo ld le lt jr lg kl lu li lj kp lv ll lm kt lw lo lp lq ig bi translated">如您所见，代码简单易懂。现在你可以把它和不同的RxJs操作符结合起来做更高级的东西！</p><h2 id="7e07" class="kc kd in bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h2><p id="3e5d" class="pw-post-body-paragraph ky kz in la b lb lc jo ld le lf jr lg kl lh li lj kp lk ll lm kt ln lo lp lq ig bi translated">我希望你在使用这个库的时候开心！请联系<a class="ae lr" href="https://github.com/anandtiwary" rel="noopener ugc nofollow" target="_blank"> me </a>获取任何反馈或使用说明。</p><h2 id="223f" class="kc kd in bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">有用的链接</h2><ul class=""><li id="1c7a" class="lx ly in la b lb lc le lf kl nu kp nv kt nw lq mc md me mf bi translated"><a class="ae lr" href="https://twig-it.github.io/from-resize/" rel="noopener ugc nofollow" target="_blank"> <strong class="la io">互动演示App </strong> </a></li><li id="7d60" class="lx ly in la b lb mg le mh kl mi kp mj kt mk lq mc md me mf bi translated"><a class="ae lr" href="https://github.com/twig-it/from-resize" rel="noopener ugc nofollow" target="_blank"> <strong class="la io"> Github来源</strong> </a></li><li id="ceb1" class="lx ly in la b lb mg le mh kl mi kp mj kt mk lq mc md me mf bi translated"><a class="ae lr" href="https://twig-it.github.io/from-resize/types/index.html" rel="noopener ugc nofollow" target="_blank"><strong class="la io">From-Resize API</strong></a></li><li id="d6b6" class="lx ly in la b lb mg le mh kl mi kp mj kt mk lq mc md me mf bi translated">用<a class="ae lr" href="https://github.com/twig-it/typescript-starter-template" rel="noopener ugc nofollow" target="_blank"> <strong class="la io">构建的打字稿</strong> <strong class="la io">模板</strong> </a></li><li id="3731" class="lx ly in la b lb mg le mh kl mi kp mj kt mk lq mc md me mf bi translated">观看<a class="ae lr" href="https://github.com/twig-it" rel="noopener ugc nofollow" target="_blank"><strong class="la io">@ twig-it</strong></a>GitHub org一些即将推出的精彩库。</li></ul></div></div>    
</body>
</html>