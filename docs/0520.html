<html>
<head>
<title>Testing Vue 3 Apps — Reactive Properties and Form Handling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">测试Vue 3应用程序—反应属性和表单处理</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/testing-vue-3-apps-reactive-properties-and-form-handling-23eee166f491?source=collection_archive---------12-----------------------#2021-01-31">https://javascript.plainenglish.io/testing-vue-3-apps-reactive-properties-and-form-handling-23eee166f491?source=collection_archive---------12-----------------------#2021-01-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/62ab3eae954c263222c15d93bdbb0a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*teJ9qdwwzgkndSvD"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@siora18?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Siora Photography</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ff7a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随着应用程序变得越来越复杂，自动测试它们变得非常重要。我们可以通过单元测试做到这一点，然后我们就不必手动测试所有的东西了。</p><p id="ca81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将通过编写一个简单的应用程序并测试它来看看如何测试Vue 3应用程序。</p><h1 id="18f2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将数据传递给组件</h1><p id="1099" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以将数据传递给组件。</p><p id="9ccc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f106" class="mn lc iq mj b gy mo mp l mq mr">import { mount } from '@vue/test-utils'</span><span id="f634" class="mn lc iq mj b gy ms mp l mq mr">const Name = {<br/>  template: `<br/>    &lt;div&gt;<br/>      &lt;input v-model="name"&gt;<br/>      &lt;div v-if="error"&gt;{{ error }}&lt;/div&gt;<br/>    &lt;/div&gt;<br/>  `,<br/>  props: {<br/>    minLength: {<br/>      type: Number<br/>    }<br/>  },<br/>  computed: {<br/>    error() {<br/>      if (this.name.length &lt; this.minLength) {<br/>        return `Name must be at least ${this.minLength} characters.`<br/>      }<br/>      return<br/>    }<br/>  }<br/>}</span><span id="c850" class="mn lc iq mj b gy ms mp l mq mr">test('renders an error if length is too short', () =&gt; {<br/>  const wrapper = mount(Name, {<br/>    props: {<br/>      minLength: 10<br/>    },<br/>    data() {<br/>      return {<br/>        name: 'short'<br/>      }<br/>    }<br/>  })<br/>  expect(wrapper.html()).toContain('Name must be at least 10 characters')<br/>})</span></pre><p id="5cb4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个带有输入字段和错误显示的<code class="fe mt mu mv mj b">Name</code>组件。</p><p id="7f41" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">error</code> computed属性检查<code class="fe mt mu mv mj b">name</code>是否太短，如果太短，则显示一条错误消息。</p><p id="cd3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在测试中，我们将<code class="fe mt mu mv mj b">minLength</code>道具传递给组件。</p><p id="21f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而<code class="fe mt mu mv mj b">data</code>方法设置了<code class="fe mt mu mv mj b">name</code>无功属性。</p><p id="c577" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们显示错误消息，因为<code class="fe mt mu mv mj b">name</code>值的长度小于10。</p><h1 id="b21f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用<code class="fe mt mu mv mj b">setProps</code></h1><p id="85e7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们也可以用<code class="fe mt mu mv mj b">setProps</code>的方法来设置道具。</p><p id="75f3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d6ff" class="mn lc iq mj b gy mo mp l mq mr">import { mount } from '@vue/test-utils'</span><span id="6e5b" class="mn lc iq mj b gy ms mp l mq mr">const Show = {<br/>  template: `<br/>    &lt;div&gt;<br/>      &lt;div v-if="show"&gt;{{ greeting }}&lt;/div&gt;<br/>    &lt;/div&gt;<br/>  `,<br/>  props: {<br/>    show: {<br/>      type: Boolean,<br/>      default: true<br/>    }<br/>  },<br/>  data() {<br/>    return {<br/>      greeting: 'Hello'<br/>    }<br/>  }<br/>}</span><span id="b6fb" class="mn lc iq mj b gy ms mp l mq mr">test('renders a greeting when show is true', async () =&gt; {<br/>  const wrapper = mount(Show)<br/>  expect(wrapper.html()).toContain('Hello')<br/>  await wrapper.setProps({ show: false })<br/>  expect(wrapper.html()).not.toContain('Hello')<br/>})</span></pre><p id="7857" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们测试<code class="fe mt mu mv mj b">Show</code>组件并检查<code class="fe mt mu mv mj b">'Hello'</code>是否在组件中呈现。</p><p id="f0dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe mt mu mv mj b">setProps</code>将<code class="fe mt mu mv mj b">show</code>道具设置为<code class="fe mt mu mv mj b">false</code>。</p><p id="c86b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们检查<code class="fe mt mu mv mj b">'Hello'</code>没有被渲染。</p><h1 id="2522" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">测试表单处理</h1><p id="f979" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过与表单元素交互来测试表单处理。</p><p id="3e8a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8b4f" class="mn lc iq mj b gy mo mp l mq mr">import { mount } from '@vue/test-utils'</span><span id="06e5" class="mn lc iq mj b gy ms mp l mq mr">const EmailInput = {<br/>  template: `<br/>    &lt;div&gt;<br/>      &lt;input type="email" v-model="email"&gt;<br/>      &lt;button @click="submit"&gt;Submit&lt;/button&gt;<br/>    &lt;/div&gt;<br/>  `,<br/>  data() {<br/>    return {<br/>      email: ''<br/>    }<br/>  },<br/>  methods: {<br/>    submit() {<br/>      this.$emit('submit', this.email)<br/>    }<br/>  }<br/>}</span><span id="cb6a" class="mn lc iq mj b gy ms mp l mq mr">test('sets the value', async () =&gt; {<br/>  const wrapper = mount(EmailInput)<br/>  const input = wrapper.find('input')<br/>  await input.setValue('abc@mail.com')<br/>  expect(input.element.value).toBe('abc@mail.com')<br/>})</span></pre><p id="0c61" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个带有输入组件的<code class="fe mt mu mv mj b">EmailInput</code>组件。</p><p id="ebf9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们添加一个测试来安装<code class="fe mt mu mv mj b">EmailInput</code>组件。</p><p id="a1e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe mt mu mv mj b">find</code>得到输入。</p><p id="cbfe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe mt mu mv mj b">input.setValue</code>来设置它的值。</p><p id="2703" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe mt mu mv mj b">input.element.value</code>从输入中得到值。</p><h1 id="3194" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="1b6e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以传入道具的数据，并用Vue测试工具测试渲染的Vue 3组件。</p><p id="0ac5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们可以用它来测试表单输入。</p></div></div>    
</body>
</html>