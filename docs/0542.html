<html>
<head>
<title>The Ultimate Guide to Creating Auto-Saving Forms in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Angular中创建自动保存表单的终极指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-ultimate-guide-to-creating-auto-saving-forms-in-angular-29806875364?source=collection_archive---------1-----------------------#2021-02-02">https://javascript.plainenglish.io/the-ultimate-guide-to-creating-auto-saving-forms-in-angular-29806875364?source=collection_archive---------1-----------------------#2021-02-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="0b00" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">极限角度导轨</h2><div class=""/><div class=""><h2 id="e927" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">由RxJS和角形材料提供动力</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/266953451858eec5bdd1a0af9eb4781c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ed-Vd4XCMcZ-VaHj5zrJGA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Angular 10</figcaption></figure></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h1 id="eed8" class="ll lm iq bd ln lo lp lq lr ls lt lu lv kf lw kg lx ki ly kj lz kl ma km mb mc bi translated">复制粘贴设置速度运行</h1><p id="d52e" class="pw-post-body-paragraph md me iq mf b mg mh ka mi mj mk kd ml mm mn mo mp mq mr ms mt mu mv mw mx my ij bi translated">以下命令创建一个新的Angular应用程序，生成自动保存窗体将驻留的组件，为应用程序提供服务，并在Visual Studio代码中打开项目。</p><pre class="kp kq kr ks gt mz na nb nc aw nd bi"><span id="089e" class="ne lm iq na b gy nf ng l nh ni">ng new AutoForm --style=scss<br/>ng g c auto-form<br/>ng serve<br/>cd AutoForm<br/>code .</span></pre><p id="ff97" class="pw-post-body-paragraph md me iq mf b mg nj ka mi mj nk kd ml mm nl mo mp mq nm ms mt mu nn mw mx my ij bi translated">将<strong class="mf ja">app.component.html</strong>的内容替换为:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Sorry, &lt;router-outlet&gt;&lt;/router-outlet&gt;, we don’t need you for this one.</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/9ae021782460fe333148cf465d880367.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*VGJTWYjGqeOq21yP_F5PiQ.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">What you see at localhost:4200</figcaption></figure></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h1 id="36cc" class="ll lm iq bd ln lo lp lq lr ls lt lu lv kf lw kg lx ki ly kj lz kl ma km mb mc bi translated">添加角形材料</h1><p id="9f44" class="pw-post-body-paragraph md me iq mf b mg mh ka mi mj mk kd ml mm mn mo mp mq mr ms mt mu mv mw mx my ij bi translated"><code class="fe nr ns nt na b">ng add @angular/material</code></p><p id="898a" class="pw-post-body-paragraph md me iq mf b mg nj ka mi mj nk kd ml mm nl mo mp mq nm ms mt mu nn mw mx my ij bi translated">现在从<strong class="mf ja"> app.module.ts </strong>中的角形和角形材料导入必要的模块。</p><p id="9409" class="pw-post-body-paragraph md me iq mf b mg nj ka mi mj nk kd ml mm nl mo mp mq nm ms mt mu nn mw mx my ij bi translated"><em class="nu">我必须重启服务器才能应用更改。</em></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h1 id="36ff" class="ll lm iq bd ln lo lp lq lr ls lt lu lv kf lw kg lx ki ly kj lz kl ma km mb mc bi translated">构建表单</h1><p id="4e04" class="pw-post-body-paragraph md me iq mf b mg mh ka mi mj mk kd ml mm mn mo mp mq mr ms mt mu mv mw mx my ij bi translated">该表格将是一个输入姓名，性别和生物概况。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="27e6" class="pw-post-body-paragraph md me iq mf b mg nj ka mi mj nk kd ml mm nl mo mp mq nm ms mt mu nn mw mx my ij bi translated">表单组有一个名为<em class="nu"> valueChanges </em>的可观察属性，每当它的一个表单控件中的值发生变化时，它就会发出一个事件。这种可观察性将成为自动保存功能的基础。</p><p id="19c8" class="pw-post-body-paragraph md me iq mf b mg nj ka mi mj nk kd ml mm nl mo mp mq nm ms mt mu nn mw mx my ij bi translated">在<strong class="mf ja"> auto-form.component.ts </strong>中，订阅<em class="nu"> valueChanges </em>，添加RxJS管道控制自动保存流程。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><blockquote class="nv nw nx"><p id="0837" class="md me nu mf b mg nj ka mi mj nk kd ml ny nl mo mp nz nm ms mt oa nn mw mx my ij bi translated"><em class="iq">但是假设(true) <em class="iq">的</em>实际上是一个将表单数据保存到数据库的可观察函数，因为这将是这种自动保存功能的真实实现。</em></p></blockquote><h2 id="08d7" class="ne lm iq bd ln ob oc dn lr od oe dp lv mm of og lx mq oh oi lz mu oj ok mb iw bi translated">RxJS运算符</h2><ul class=""><li id="b3d4" class="ol om iq mf b mg mh mj mk mm on mq oo mu op my oq or os ot bi translated"><a class="ae ou" href="https://www.learnrxjs.io/learn-rxjs/operators/filtering/debouncetime" rel="noopener ugc nofollow" target="_blank"> <em class="nu">去抖时间</em> </a></li></ul><p id="291b" class="pw-post-body-paragraph md me iq mf b mg nj ka mi mj nk kd ml mm nl mo mp mq nm ms mt mu nn mw mx my ij bi translated">该操作符不允许从可观察对象中发出一个事件，直到发出最后一个事件经过了一段时间。换句话说，<em class="nu"> valueChanges </em>不会发出一个事件，直到连续1.5秒没有修改概要文件。这可以防止在每次修改表单后触发事件时不断更新数据库。1.5秒是基于<a class="ae ou" href="https://firebase.google.com/docs/firestore/quotas" rel="noopener ugc nofollow" target="_blank"> Cloud Firestore每秒一次写入文档的限制。</a></p><ul class=""><li id="be6d" class="ol om iq mf b mg nj mj nk mm ov mq ow mu ox my oq or os ot bi translated"><a class="ae ou" href="https://www.learnrxjs.io/learn-rxjs/operators/transformation/switchmap" rel="noopener ugc nofollow" target="_blank"> <em class="nu">开关图</em> </a></li></ul><p id="bc4b" class="pw-post-body-paragraph md me iq mf b mg nj ka mi mj nk kd ml mm nl mo mp mq nm ms mt mu nn mw mx my ij bi translated">这个算符把可观测值转换成一个新的可观测值。为了我们的目的，这个新的可观测性将留给想象。然而，无论你和Angular一起使用什么样的后端技术，你几乎总会在更新用户数据的服务中使用它。无论如何，这将是我们想要订阅的可观察的。该算子无缝地取消了先前的可观测值，并订阅了新的可观测值。</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h1 id="7c3c" class="ll lm iq bd ln lo lp lq lr ls lt lu lv kf lw kg lx ki ly kj lz kl ma km mb mc bi translated">UX改进</h1><p id="4410" class="pw-post-body-paragraph md me iq mf b mg mh ka mi mj mk kd ml mm mn mo mp mq mr ms mt mu mv mw mx my ij bi translated">当我写这篇文章时，从Medium上的这个地方得到了灵感，看到我的作品何时被保存以及何时完成保存是很有帮助的。让我们用一个新的变量<em class="nu"> saveStatus </em>来改进我们的表单，让用户知道正在发生什么。</p><p id="2b4c" class="pw-post-body-paragraph md me iq mf b mg nj ka mi mj nk kd ml mm nl mo mp mq nm ms mt mu nn mw mx my ij bi translated">在<strong class="mf ja">auto-form.component.html</strong>中，将变量添加到用户可以看到的地方。</p><pre class="kp kq kr ks gt mz na nb nc aw nd bi"><span id="13a5" class="ne lm iq na b gy nf ng l nh ni">{{ saveStatus }}</span></pre><p id="b3d2" class="pw-post-body-paragraph md me iq mf b mg nj ka mi mj nk kd ml mm nl mo mp mq nm ms mt mu nn mw mx my ij bi translated">在<strong class="mf ja"> auto-form.component.ts </strong>中，我们需要一个新的RxJS操作符<em class="nu">点击</em>，在每次表单控件被更改时运行一个函数。该功能将保存状态设置为“保存”。在订阅中，一旦保存了数据，保存状态将设置为“已保存”，再过两秒钟，如果状态仍然为“已保存”，则将设置为“空闲”，这是一个空字符串。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="1210" class="pw-post-body-paragraph md me iq mf b mg nj ka mi mj nk kd ml mm nl mo mp mq nm ms mt mu nn mw mx my ij bi translated">这是工作演示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oy"><img src="../Images/7d0367dfa39a1fb40403e8c07c64dda8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vPFDAEydKGA_ifH4eqKTNg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Voila!</figcaption></figure><p id="5149" class="pw-post-body-paragraph md me iq mf b mg nj ka mi mj nk kd ml mm nl mo mp mq nm ms mt mu nn mw mx my ij bi translated">希望您会发现本指南很有帮助。如果您喜欢或有任何问题请留言，我一定会回答。感谢您花时间阅读这篇文章。😎</p></div></div>    
</body>
</html>