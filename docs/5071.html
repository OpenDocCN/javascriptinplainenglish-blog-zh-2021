<html>
<head>
<title>Understand Static Site Generation with Next.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Next.js了解静态站点生成</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/understand-static-site-generation-with-next-js-22e86efda38c?source=collection_archive---------8-----------------------#2021-10-14">https://javascript.plainenglish.io/understand-static-site-generation-with-next-js-22e86efda38c?source=collection_archive---------8-----------------------#2021-10-14</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="3f5e" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">充分利用静态站点生成。</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/c0097a015ad3b5848d299530a8cd30f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WXQj7nbTvJBvBoCDoVBOfA.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Image by <a class="ae kw" href="https://pixabay.com/users/kreatikar-8562930/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3461405" rel="noopener ugc nofollow" target="_blank">Mudassar Iqbal</a> from <a class="ae kw" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3461405" rel="noopener ugc nofollow" target="_blank">Pixabay</a></figcaption></figure><p id="09c1" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们都爱Next.js的服务器端渲染能力。但是我们经常不能利用静态一代的魅力。</p><p id="96ac" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">如果设计得当，我们几乎可以预先生成网站的每个页面，因此，我们的网站就像一个静态网站。快速和搜索引擎友好。</p><p id="7880" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是使用Next.js可以预生成的页面数量是有限制的。今天，我们将尝试理解Next.js中静态站点生成的不同用例。</p><h1 id="90b5" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">静态生成是如何工作的</h1><p id="51c1" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">静态生成意味着我们将在服务器端预先生成页面，当用户请求页面时，我们将向他们发送回实际的HTML文件。这是Next.js和React的主要区别，React只支持客户端生成。</p><p id="3d9d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">为了用Next.js静态生成页面，我们需要使用两个函数。</p><ol class=""><li id="68d2" class="mq mr ir kz b la lb ld le lg ms lk mt lo mu ls mv mw mx my bi translated"><code class="fe mz na nb nc b">getStaticPaths</code> - &gt;提前知道所有可能的路线</li><li id="5ea3" class="mq mr ir kz b la nd ld ne lg nf lk ng lo nh ls mv mw mx my bi translated"><code class="fe mz na nb nc b">getStaticProps</code> - &gt;生成页面所需的道具</li></ol><p id="59f8" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">假设您想要预先生成您个人网站的所有博客帖子。网址看起来有点像<code class="fe mz na nb nc b">/blog/{blogId}</code></p><p id="5552" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在这种情况下，代码将如下所示。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ni nj l"/></div></figure><p id="8720" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">你应该已经熟悉语法了，所以我不想详细说明。我们将重点理解静态生成的不同方法。</p><h1 id="5942" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">问题是</h1><p id="6b2b" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">主要问题是我们可以预先生成的页面数量是有限制的。你可以在<code class="fe mz na nb nc b"><a class="ae kw" href="https://vercel.com/docs/concepts/limits/overview" rel="noopener ugc nofollow" target="_blank">vercel website</a></code>上查看。一般是8000页。</p><p id="fbbe" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在根据情况，我们必须做出明智的决定，决定我们将采取哪种方法。并且生成基于<code class="fe mz na nb nc b">fallback</code>属性的作品。</p><p id="1f75" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">有3个可能的值。</p><ol class=""><li id="49dd" class="mq mr ir kz b la lb ld le lg ms lk mt lo mu ls mv mw mx my bi translated"><code class="fe mz na nb nc b">false</code></li><li id="bc39" class="mq mr ir kz b la nd ld ne lg nf lk ng lo nh ls mv mw mx my bi translated"><code class="fe mz na nb nc b">true</code></li><li id="61f4" class="mq mr ir kz b la nd ld ne lg nf lk ng lo nh ls mv mw mx my bi translated"><code class="fe mz na nb nc b">blocking</code></li></ol><p id="42c8" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">让我们讨论一下使用这些不同值的场景。</p><h1 id="4962" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">你有一个动态内容较少的小网站</h1><p id="bead" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">如果你正在建立一个投资组合页面，随着时间的推移，你的页面很有可能会非常相似，并且它们也会在8000页的限制内。</p><p id="58a1" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在这些场景中，您必须指定fallback = <code class="fe mz na nb nc b">false</code></p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ni nj l"/></div></figure><p id="eb6b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">当您将回退定义为<code class="fe mz na nb nc b">false</code>时，您基本上是在告诉Next.js只提供静态页面。所以它就像一个静态网站。</p><p id="d568" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">尽管有一些暗示。</p><ol class=""><li id="0205" class="mq mr ir kz b la lb ld le lg ms lk mt lo mu ls mv mw mx my bi translated">如果任何用户想要访问任何未预先生成的路线，他们将会看到404页面。Next.js不会尝试在运行时构建这个页面。</li><li id="3cd6" class="mq mr ir kz b la nd ld ne lg nf lk ng lo nh ls mv mw mx my bi translated">如果你改变网站的任何内容(意味着增加一些新的路线)，你必须重新部署整个应用程序。</li><li id="210f" class="mq mr ir kz b la nd ld ne lg nf lk ng lo nh ls mv mw mx my bi translated">一般来说，这将确保不会出现不需要的路由。这种方法会让你的网站看起来像一个静态网站。</li></ol></div><div class="ab cl nk nl hv nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ik il im in io"><h1 id="a3b1" class="lt lu ir bd lv lw nr ly lz ma ns mc md jx nt jy mf ka nu kb mh kd nv ke mj mk bi translated">拥有大量动态内容的大型网站</h1><p id="f8c9" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">如果你有一个可能有大量页面的网站，你想给用户一个页面的框架(为了良好的用户体验)。那你应该用<code class="fe mz na nb nc b">fallback</code> = <code class="fe mz na nb nc b">true</code>。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ni nj l"/></div></figure><p id="c1c5" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在，如果任何用户请求一个不是静态生成的页面，服务器不会用404页面响应。相反，</p><ul class=""><li id="2e45" class="mq mr ir kz b la lb ld le lg ms lk mt lo mu ls nw mw mx my bi translated">它将立即返回一个没有道具的版本(在这个阶段，我们的工作是展示骨架版本)</li><li id="4623" class="mq mr ir kz b la nd ld ne lg nf lk ng lo nh ls nw mw mx my bi translated">它会尝试在后台为页面获取合适的道具(就像<code class="fe mz na nb nc b">getServerSideProps</code>)。</li></ul><p id="1c78" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在的问题是，如何理解何时显示框架，何时显示实际页面？</p><p id="6a17" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">为此，我们利用了Next.js的<code class="fe mz na nb nc b">router</code>。在您的组件中，您将尝试了解页面是否具有所需的可用属性，并基于此显示页面的适当版本。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ni nj l"/></div></figure><p id="b7d6" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这是动态生成静态页面的好方法。</p><p id="a5a3" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">好的一面是，一旦用户请求了一个页面并生成了该页面，服务器将缓存该页面以供后续请求使用。这是非常好和有效的！</p><h1 id="f5f0" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">动态内容，但没有框架</h1><p id="f6e2" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">如果你有一个网站，其中大部分页面都是预先生成的，你不想为显示非预先生成页面的框架而烦恼，那么你将使用<code class="fe mz na nb nc b">fallback</code> = <code class="fe mz na nb nc b">blocking</code></p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ni nj l"/></div></figure><p id="7127" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在，当任何用户请求一个页面时，除了一个空白页面(或加载程序)，他们什么也看不到。服务器只有在后台获得合适的道具后才会响应。</p><h1 id="ec0c" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">最后的话</h1><p id="e3ec" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">尝试理解<code class="fe mz na nb nc b">fallback</code>属性的不同值，以便充分利用Next.js的静态生成功能。</p><p id="b3df" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">今天到此为止。祝您愉快！</p><p id="f835" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is">通过</strong> <a class="ae kw" href="https://www.linkedin.com/in/56faisal/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> LinkedIn </strong> </a>联系我</p><p id="09a7" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><em class="nx">更多内容请看</em><a class="ae kw" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kz is"><em class="nx">plain English . io</em></strong></a></p><div class="ny nz gq gs oa ob"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-handle-different-environments-in-a-next-js-application-8dc4aef6ad9b"><div class="oc ab fp"><div class="od ab oe cl cj of"><h2 class="bd is gz z fq og fs ft oh fv fx iq bi translated">如何在Next.js应用程序中处理不同的环境</h2><div class="oi l"><h3 class="bd b gz z fq og fs ft oh fv fx dk translated">关于Next.js中的环境变量，您需要知道的一切</h3></div><div class="oj l"><p class="bd b dl z fq og fs ft oh fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="ok l"><div class="ol l om on oo ok op kq ob"/></div></div></a></div></div></div>    
</body>
</html>