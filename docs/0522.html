<html>
<head>
<title>Adding Graphics to a Vue App with D3 — Pie Chart</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用D3向Vue应用程序添加图形—饼图</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/adding-graphics-to-a-vue-app-with-d3-pie-chart-63b39251ee96?source=collection_archive---------14-----------------------#2021-01-31">https://javascript.plainenglish.io/adding-graphics-to-a-vue-app-with-d3-pie-chart-63b39251ee96?source=collection_archive---------14-----------------------#2021-01-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ecbd432f9d88be74ae2e80f187a3aa29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VmpjJ_KXA6tqHa72"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@sheri_silver?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">sheri silver</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b662" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">D3让我们可以很容易地将图形添加到前端网络应用程序中。</p><p id="461d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue是一个流行的前端网络框架。</p><p id="55a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们一起工作很棒。在本文中，我们将研究如何将图形添加到带有D3的Vue应用程序中。</p><h1 id="dbe7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">圆形分格统计图表</h1><p id="d344" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在Vue应用程序中添加一个包含D3的饼图。</p><p id="9208" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="4d22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">public/populations.csv</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="83f2" class="mq lc iq mh b gy mr ms l mt mu">states,percent<br/>California,38.00<br/>New York,18.00<br/>Texas,20.0</span></pre><p id="e0d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">App.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8017" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;svg width="600" height="400"&gt;&lt;/svg&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>import * as d3 from "d3";<br/>import Vue from "vue";</span><span id="7f97" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  name: "App",<br/>  mounted() {<br/>    Vue.nextTick(async () =&gt; {<br/>      const svg = d3.select("svg"),<br/>        width = svg.attr("width"),<br/>        height = svg.attr("height"),<br/>        radius = Math.min(width, height) / 2;</span><span id="35c2" class="mq lc iq mh b gy mv ms l mt mu">      const g = svg<br/>        .append("g")<br/>        .attr("transform", `translate(${width / 2}, ${height / 2})`);</span><span id="5033" class="mq lc iq mh b gy mv ms l mt mu">      const color = d3.scaleOrdinal(["gray", "green", "brown"]);</span><span id="d2df" class="mq lc iq mh b gy mv ms l mt mu">      const pie = d3.pie().value(function (d) {<br/>        return d.percent;<br/>      });</span><span id="593c" class="mq lc iq mh b gy mv ms l mt mu">      const path = d3<br/>        .arc()<br/>        .outerRadius(radius - 10)<br/>        .innerRadius(0);</span><span id="ddc0" class="mq lc iq mh b gy mv ms l mt mu">      const label = d3<br/>        .arc()<br/>        .outerRadius(radius)<br/>        .innerRadius(radius - 80);</span><span id="2498" class="mq lc iq mh b gy mv ms l mt mu">      const data = await d3.csv("/populations.csv");</span><span id="6b4f" class="mq lc iq mh b gy mv ms l mt mu">      const arc = g<br/>        .selectAll(".arc")<br/>        .data(pie(data))<br/>        .enter()<br/>        .append("g")<br/>        .attr("class", "arc");</span><span id="afc4" class="mq lc iq mh b gy mv ms l mt mu">      arc<br/>        .append("path")<br/>        .attr("d", path)<br/>        .attr("fill", function (d) {<br/>          return color(d.data.states);<br/>        });</span><span id="9cc3" class="mq lc iq mh b gy mv ms l mt mu">      arc<br/>        .append("text")<br/>        .attr("transform", function (d) {<br/>          return `translate(${label.centroid(d)})`;<br/>        })<br/>        .text(function (d) {<br/>          return d.data.states;<br/>        });</span><span id="5005" class="mq lc iq mh b gy mv ms l mt mu">      svg<br/>        .append("g")<br/>        .attr("transform", `translate(${width / 2 - 120},20)`)<br/>        .append("text")<br/>        .text("Top population states in the US")<br/>        .attr("class", "title");<br/>    });<br/>  },<br/>};<br/>&lt;/script&gt;</span><span id="f806" class="mq lc iq mh b gy mv ms l mt mu">&lt;style scoped&gt;<br/>.arc text {<br/>  font: 12px arial;<br/>  text-anchor: middle;<br/>}</span><span id="3f3f" class="mq lc iq mh b gy mv ms l mt mu">.arc path {<br/>  stroke: #fff;<br/>}</span><span id="9b02" class="mq lc iq mh b gy mv ms l mt mu">.title {<br/>  fill: green;<br/>  font-weight: italic;<br/>}<br/>&lt;/style&gt;</span></pre><p id="0957" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们首先获取<code class="fe me mf mg mh b">svg</code>元素，并设置饼图的<code class="fe me mf mg mh b">width</code>、<code class="fe me mf mg mh b">height</code>和<code class="fe me mf mg mh b">radius</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a92c" class="mq lc iq mh b gy mr ms l mt mu">const svg = d3.select("svg"),<br/>  width = svg.attr("width"),<br/>  height = svg.attr("height"),<br/>  radius = Math.min(width, height) / 2;</span></pre><p id="b3a4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们通过写作来翻译<code class="fe me mf mg mh b">svg</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8fee" class="mq lc iq mh b gy mr ms l mt mu">const g = svg<br/>  .append("g")<br/>  .attr("transform", `translate(${width / 2}, ${height / 2})`);</span></pre><p id="2e81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们通过书写为饼图添加颜色；</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="e51b" class="mq lc iq mh b gy mr ms l mt mu">const color = d3.scaleOrdinal(["gray", "green", "brown"]);</span></pre><p id="c0a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们通过编写以下内容来添加饼图块的数据:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1c56" class="mq lc iq mh b gy mr ms l mt mu">const pie = d3.pie().value(function(d) {<br/>  return d.percent;<br/>});</span></pre><p id="3c62" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们通过书写为饼图创建弧线</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7e89" class="mq lc iq mh b gy mr ms l mt mu">const path = d3<br/>  .arc()<br/>  .outerRadius(radius - 10)<br/>  .innerRadius(0);</span></pre><p id="44c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们通过书写来创建标签:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f7f3" class="mq lc iq mh b gy mr ms l mt mu">const label = d3<br/>  .arc()<br/>  .outerRadius(radius)<br/>  .innerRadius(radius - 80);</span></pre><p id="58ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们从<code class="fe me mf mg mh b">populations.csv</code>读取数据:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="63bc" class="mq lc iq mh b gy mr ms l mt mu">const data = await d3.csv("/populations.csv");</span></pre><p id="63b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们通过写入读取的数据来设置弧线的长度:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5696" class="mq lc iq mh b gy mr ms l mt mu">const arc = g<br/>  .selectAll(".arc")<br/>  .data(pie(data))<br/>  .enter()<br/>  .append("g")<br/>  .attr("class", "arc");</span></pre><p id="6be6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们通过书写来设置饼图块的填充颜色:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="05ce" class="mq lc iq mh b gy mr ms l mt mu">arc<br/>  .append("path")<br/>  .attr("d", path)<br/>  .attr("fill", function(d) {<br/>    return color(d.data.states);<br/>  });</span></pre><p id="08d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们通过编写以下内容来添加饼图块的文本:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="98d4" class="mq lc iq mh b gy mr ms l mt mu">arc<br/>  .append("text")<br/>  .attr("transform", function(d) {<br/>    return `translate(${label.centroid(d)})`;<br/>  })<br/>  .text(function(d) {<br/>    return d.data.states;<br/>  });</span></pre><p id="38cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们通过以下方式为图表添加标题文本:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="87d4" class="mq lc iq mh b gy mr ms l mt mu">svg<br/>  .append("g")<br/>  .attr("transform", `translate(${width / 2 - 120},20)`)<br/>  .append("text")<br/>  .text("Top population states in the US")<br/>  .attr("class", "title");</span></pre><p id="5763" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们应该看到一个饼图显示。</p><h1 id="91d5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="ab94" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在Vue应用程序中添加一个包含D3的饼图。</p></div></div>    
</body>
</html>