<html>
<head>
<title>How to Make a RPG Game using JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用JavaScript制作一个RPG游戏</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-make-a-rpg-game-using-javascript-cf3e9feff761?source=collection_archive---------10-----------------------#2021-10-17">https://javascript.plainenglish.io/how-to-make-a-rpg-game-using-javascript-cf3e9feff761?source=collection_archive---------10-----------------------#2021-10-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1fcf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第二部分</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a70889b5bb0a138e04598e9542d7662e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uROwSk34Jtrdgfi2HhJuGg.png"/></div></div></figure><h1 id="78b4" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">概述</h1><p id="f2aa" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在之前的博客文章<a class="ae mf" rel="noopener ugc nofollow" target="_blank" href="/how-to-make-an-rpg-game-using-javascript-89b19cd49577">第1部分</a>中，我们看到了如何设置我们的环境并安装其他依赖项，以便开始为游戏开发工作设置我们的项目。</p><p id="9e89" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">如果有人不想阅读，而喜欢通过观看视频来进行开发，那么为此，我也为它制作了一个视频系列。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ml mm l"/></div></figure><h1 id="234d" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">介绍</h1><p id="fa65" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在这一部分中，我们将看到如何使用二维字符数组来设置我们的地图，添加玩家的移动，以及添加我们的<strong class="ll ir">精灵</strong>之间的碰撞检测，以便找出两个用例:</p><ol class=""><li id="8393" class="mn mo iq ll b lm mg lp mh ls mp lw mq ma mr me ms mt mu mv bi translated">当<strong class="ll ir">玩家</strong>拿起<strong class="ll ir">按键</strong>时</li><li id="37cb" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">当<strong class="ll ir">玩家</strong>进入<strong class="ll ir">门</strong>时。</li></ol><h1 id="bb15" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">游戏引擎命令</h1><p id="34de" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在进入游戏开发的逻辑之前，让我们看看一些可用的内置方法，这将有助于我们理解代码流。</p><p id="a1ed" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">(i) <strong class="ll ir">添加</strong> —这个关键字用于给我们的游戏添加文本、图像。</p><p id="247a" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">(ii) <strong class="ll ir">按键</strong> —该关键字用于检测键盘上的按键。</p><p id="c60f" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">(iii) <strong class="ll ir"> keyDown </strong> —该关键字用于检测键盘上特定键的长按，我们将使用该关键字来检测玩家的移动。</p><p id="c210" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">(四)<strong class="ll ir"> loadSprite </strong> —这个关键字用于在游戏中加载我们的Sprite。</p><p id="4db2" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">(v)<strong class="ll ir">add level</strong>——这个关键字用于添加我们的2d基于字符的地图，以及我们在引擎中加载的图像/精灵。</p><p id="66c5" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我们使用的与游戏引擎相关的命令很少，但是它们都是不言自明的。</p><h1 id="9277" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">地图表示</h1><p id="ce0c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在前面的部分中，我们已经定义了游戏地图的大小为180 x 180，现在我们可以想象这个游戏地图位于图形的第一象限，即角落坐标如下:</p><ol class=""><li id="af7f" class="mn mo iq ll b lm mg lp mh ls mp lw mq ma mr me ms mt mu mv bi translated">左下角— (0，0)。</li><li id="e640" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">右下— (180，0)。</li><li id="4660" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">左上角— (0，180)。</li><li id="7e7a" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">右上— (180，180)。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/2f08f19fc8c4a3d88754ef8f1627636a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BBzFGSDBL5oX5Uil4AAj8w.png"/></div></div></figure><h2 id="a011" class="nc ks iq bd kt nd ne dn kx nf ng dp lb ls nh ni ld lw nj nk lf ma nl nm lh nn bi translated">计算</h2><p id="1e22" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">现在，该做些数学计算了:</p><p id="acf9" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">map_width = 180像素</p><p id="1cec" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">map_height = 180像素</p><p id="84d1" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">墙壁_图像_宽度= 11像素</p><p id="c62e" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">墙壁_图像_高度= 11像素</p><p id="bcab" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><strong class="ll ir">注意:</strong>如果你想知道，我们是从哪里得到11像素宽和高的墙壁图像的，所以这基本上是我们在上一部分下载的wall.png的大小。</p><p id="d630" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">现在，什么是最大的行和列的大小，我们可以得到我们的二维字符数组来表示我们的地图。</p><p id="ed26" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">max_row_size = 180/11，所以max_row_size ≤ 16。</p><p id="6eba" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">max_column_size = 180/11，所以max_column_size ≤ 16。</p><p id="9428" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">现在，我们还需要在游戏场景和我们创建的地图之间提供一些空间/间隙，所以让我们使用12的行大小和11的列大小。这只是一个任意的数字，你可以选择任何小于等于16的值。</p><p id="351a" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">现在，我们已经决定了我们的地图表示所需的尺寸，让我们用字符' = '来表示，它将等同于我们的墙壁图像。</p><p id="2cfe" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">因此，我们的json形式的地图看起来会像这样:</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="9a39" class="nc ks iq np b gy nt nu l nv nw">[<br/>   {<br/>      "layout":[<br/>         "=====1======",<br/>         "=  @       =",<br/>         "=          =",<br/>         "=          =",<br/>         "=          =",<br/>         "=          =",<br/>         "=          =",<br/>         "=          =",<br/>         "=      i   =",<br/>         "=          =",<br/>         "============"<br/>      ]<br/>   }<br/>]</span></pre><p id="4f30" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">让我们看看每个字符代表什么:</p><ol class=""><li id="2318" class="mn mo iq ll b lm mg lp mh ls mp lw mq ma mr me ms mt mu mv bi translated">= '是我们的<strong class="ll ir">墙</strong>精灵。</li><li id="7eac" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">‘1号’是我们的<strong class="ll ir">门</strong>雪碧。</li><li id="1e98" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">@ '是给我们的<strong class="ll ir">玩家</strong>雪碧的。</li><li id="675d" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">‘我’是我们的<strong class="ll ir">项</strong>雪碧。</li></ol><h2 id="3472" class="nc ks iq bd kt nd ne dn kx nf ng dp lb ls nh ni ld lw nj nk lf ma nl nm lh nn bi translated">代码的当前状态</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mm l"/></div></figure><h1 id="2b37" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">代码解释</h1><ol class=""><li id="4c8b" class="mn mo iq ll b lm ln lp lq ls ny lw nz ma oa me ms mt mu mv bi translated">第1行到第8行，我们只是初始化我们的游戏引擎。</li><li id="5565" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">从第11行到第15行，我们加载了我们的图像/精灵和每个精灵的关键点，在我们的代码中使用。</li><li id="49c8" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">在第88行，我们创建了第一个场景<strong class="ll ir"> main </strong>，使用start关键字，我们初始化了不同的场景。</li><li id="7945" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">从第73行到第86行，我们添加了一些要在第一个场景中显示的基本文本。<strong class="ll ir"> Add </strong>关键字用于在我们的游戏引擎中添加<strong class="ll ir">文本</strong>或任何其他种类的<strong class="ll ir">图形</strong>。之后，我们使用关键字<strong class="ll ir"> keyPress </strong>检测空格键按压。</li><li id="f117" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">从第19行到第35行，我们以字符串的形式加载游戏地图。</li><li id="b7ce" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">第36行用于启动我们的游戏场景。</li><li id="c337" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">从第42行开始，我们创建了一个名为roomConf的数据结构，它基本上让游戏引擎知道每个角色到其各自精灵的映射。</li><li id="76fc" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">第68行非常重要，它有两个参数，一个是我们在上面的步骤中创建的<strong class="ll ir"> roomConf </strong>变量，另一个是我们基于json的2-D字符映射表，它基本上呈现并创建了如上图所示的映射表。</li><li id="744a" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">从第70行开始，我们基本上为每个方向分配4个向量，然后将它们映射到每个按键，并基于此改变玩家的方向。为了更好地理解为什么我们用特定的值来表示向量，请看下图</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/747df195218493ecd5068046188daf53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FXEwRyXaFjma0o2zp8B4aQ.png"/></div></div></figure><p id="45df" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">10.现在，检测两个固体物体碰撞的最后一个重要部分-</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="2575" class="nc ks iq np b gy nt nu l nv nw">// Update the player position etc - run every frame.    player.action(() =&gt; {      <br/>    player.resolve();    <br/>});</span></pre><p id="db1c" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">如果你注意到了，我们已经为我们的墙、门和物品精灵提到了<strong class="ll ir"> solid() </strong>，所以上面这段代码决定了玩家是否触摸了任何固体物体，我们需要解析每个玩家的动作。</p><h1 id="617e" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">冲突检出</h1><p id="b5d5" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在<strong class="ll ir"> Kaboom.js </strong>游戏引擎中，我们为每个精灵提供了一个名为overlaps的方法，我们可以用它来检测两个实体精灵之间的冲突，我们可以在方法中定义实现逻辑。在我们的用例中，需要采取以下行动</p><ol class=""><li id="16a5" class="mn mo iq ll b lm mg lp mh ls mp lw mq ma mr me ms mt mu mv bi translated">当<strong class="ll ir">玩家</strong>与<strong class="ll ir">门</strong>重叠时，我们要完成我们的游戏并显示一个获胜文本。</li><li id="3c40" class="mn mo iq ll b lm mw lp mx ls my lw mz ma na me ms mt mu mv bi translated">当<strong class="ll ir">玩家</strong>与<strong class="ll ir">物品(钥匙)</strong>重叠时，那么我们要隐藏<strong class="ll ir">钥匙</strong>并将其从我们的地图中移除。</li></ol><p id="be12" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">下面的代码关注上面的用例:-</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx mm l"/></div></figure><p id="d9a4" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">一旦<strong class="ll ir">玩家</strong>触碰到<strong class="ll ir">门</strong>，我们直接进入<strong class="ll ir">赢家</strong>场景，在屏幕上显示中奖信息。</p><h1 id="36b4" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">结论</h1><p id="3ece" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">至此，我们结束了第二部分，在这篇文章中，我们看到了如何映射我们的二维字符数组和渲染场景中的精灵，检测<strong class="ll ir">实体()</strong>精灵之间的碰撞，并以<strong class="ll ir">赢得</strong>场景来结束我们的游戏。</p><p id="4877" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">感谢所有的支持，完整的游戏代码可以在这里找到——<a class="ae mf" href="https://github.com/Kavit900/ludum-dare-49" rel="noopener ugc nofollow" target="_blank">https://github.com/Kavit900/ludum-dare-49</a>。</p><p id="3e0a" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><em class="oc">更多内容请看</em><a class="ae mf" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir"><em class="oc">plain English . io</em></strong></a></p></div></div>    
</body>
</html>