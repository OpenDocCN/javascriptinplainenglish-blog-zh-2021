<html>
<head>
<title>Portfolio Project | Spotify Mood Ring</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">组合项目| Spotify心情戒指</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/portfolio-project-spotify-mood-ring-dba09b6da1e0?source=collection_archive---------12-----------------------#2021-04-06">https://javascript.plainenglish.io/portfolio-project-spotify-mood-ring-dba09b6da1e0?source=collection_archive---------12-----------------------#2021-04-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="0d7b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一款移动优先的React web应用，它根据用户最近在Spotify上播放的音乐来判断用户的情绪。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/25147fc67a7c92bffde505f8764c8754.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lWq8uH-gG3WaL39RvPA1wA.png"/></div></div></figure><p id="6124" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">今年二月，我制作了<a class="ae kv" href="https://moodring.vercel.app" rel="noopener ugc nofollow" target="_blank">心情戒指</a>。它使用<strong class="jm io">Spotify API</strong>检查用户最近在Spotify上播放的歌曲，并试图猜测用户的情绪。</p><p id="4ed6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在与一些朋友分享并发布到网上后，我很高兴地说，它已经吸引了来自15个以上国家的3000多名用户。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/c6370ede39fcd9a25c35a2b2e5a3675e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2rlxurW0vQ1qIAdlMqvn6Q.png"/></div></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/c8599788bc42f676e1b65803e3240cf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Vtktr55UzAfYFX1CwO9Ug.png"/></div></div></figure><h1 id="f9f4" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">这个概念💡</h1><p id="3287" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated"><strong class="jm io"> <em class="ki">我们听的音乐说明了我们的感受？</em>T13】</strong></p><p id="84fb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我知道我想用Spotify API做一个项目。它非常强大，为整个Spotify库中的每首歌曲提供了丰富的分析，这非常酷。</p><p id="3ef9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在阅读他们的文档时，我想到了向用户展示一些关于他们最近音乐品味的数据。为了让它更有趣，我认为向用户展示一个关于他们自己的假设会很有趣，很有个性，有点像星座。</p><p id="3919" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">作为这个想法的延伸，我决定使用情绪探测器。</p><h1 id="bb19" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">技术👨🏼‍💻</h1><p id="ef15" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">这个项目的完整代码可以在我的GitHub上的<a class="ae kv" href="https://github.com/dunleavyjack/Spotify-Mood-Ring" rel="noopener ugc nofollow" target="_blank">这里</a>找到。我使用了以下内容:</p><ul class=""><li id="f493" class="lz ma in jm b jn jo jr js jv mb jz mc kd md kh me mf mg mh bi translated"><strong class="jm io">反应</strong></li><li id="ef9e" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><strong class="jm io">反应路由器</strong></li><li id="d6fe" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><strong class="jm io"> Redux </strong></li><li id="4030" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><strong class="jm io"> Axios </strong>(针对Spotify API的请求)</li><li id="6e33" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><strong class="jm io"> OAuth2授权</strong></li><li id="53b3" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><strong class="jm io">自举5 </strong></li><li id="3770" class="lz ma in jm b jn mi jr mj jv mk jz ml kd mm kh me mf mg mh bi translated"><strong class="jm io">图玛</strong>(用于设计UI)</li></ul><h1 id="b73b" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">用户界面注意事项🎨</h1><p id="3dee" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">我不会称自己为设计师，但我确实对设计有强烈的偏好。我喜欢简单、不复杂的东西，有大胆的、有点孩子气的线条和颜色。</p><p id="4b51" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有些人建议用一种颜色搭配起来更自然，但我不同意。我喜欢那种略带另类的迷人感觉。</p><h1 id="f161" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">情绪检测算法👨‍🔬</h1><p id="9066" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">Spotify API为他们的歌曲提供了一些非常有趣的分析。除了更令人期待的<strong class="jm io"> tempo </strong>、<strong class="jm io"> bpm </strong>和<strong class="jm io"> song key </strong>之外，Spotify还包括<strong class="jm io"> danceability </strong>、<strong class="jm io">acoustic、energy </strong>和<strong class="jm io"> valence </strong>(一种感知幸福的衡量标准)。</p><p id="8ca2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如你所见，Spotify已经做了很多繁重的工作。在我这边，我为每个分析设置平均值，并编写函数来查找，然后将它们的百分比差异与这些平均值进行比较。</p><p id="b406" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">比如说，如果一首歌的<strong class="jm io">可舞性</strong>低于平均水平，那么我会用它与平均水平的百分比差值将这首歌标记为“不太适合跳舞”。通过这种方式，我可以对它们进行排序。</p><p id="c1e7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这给了我一个有序的列表，其中分析从用户最近的收听体验中脱颖而出。这就是事情变得有趣的地方。例如，如果用户最近的歌曲最引人注目的是<strong class="jm io">【更多的快乐】</strong>和<strong class="jm io">【更多的可跳舞性】</strong>，那么我觉得可以有把握地假设用户可能感觉<strong class="jm io">精力充沛</strong>或<strong class="jm io">富有表现力</strong>。</p><p id="c688" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面是一个简单的例子，来自我的程序检测到的第一个情绪:</p><pre class="kk kl km kn gt mn mo mp mq aw mr bi"><span id="79b9" class="ms kx in mo b gy mt mu l mv mw">if (</span><span id="9c89" class="ms kx in mo b gy mx mu l mv mw">    moodNames.includes("more-happiness") &amp;&amp;</span><span id="d760" class="ms kx in mo b gy mx mu l mv mw">    moodNames.includes("lower-danceability")</span><span id="3632" class="ms kx in mo b gy mx mu l mv mw">) {</span><span id="7a7c" class="ms kx in mo b gy mx mu l mv mw">    return "peaceful";</span></pre><p id="407c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这里，一个用户一直在听那些更快乐(感觉良好)但可跳舞性(感觉平静)更低(感觉平静)的歌曲，所以我的假设是他们可能感觉平静或满足。这是算法的基础。在那之后，决定其他不同的情绪组合是相当有趣的。选择合适的词有点像诗歌。</p><h1 id="a0e8" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">C <strong class="ak">挑战和解决方案🚧</strong></h1><h2 id="ba76" class="ms kx in bd ky my mz dn lc na nb dp lg jv nc nd lk jz ne nf lo kd ng nh ls ni bi translated"><strong class="ak"> OAuth2初学流程</strong></h2><p id="b1cf" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">这是我第一次使用第三方认证和登录流程，所以需要一段时间来理解和习惯流程。</p><p id="91f8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">实践了这么多之后，我后来觉得有足够的信心写下<a class="ae kv" href="https://levelup.gitconnected.com/add-strava-oauth2-login-to-your-react-app-in-15-minutes-6c92e845919e" rel="noopener ugc nofollow" target="_blank">这篇教程</a>(发表在<strong class="jm io">Level-Up code</strong>here on Medium)来为连接到<strong class="jm io"> Strava </strong>的应用程序实现类似的OAuth2过程，Strava 是一个流行的跑步社交媒体平台。</p><h2 id="8869" class="ms kx in bd ky my mz dn lc na nb dp lg jv nc nd lk jz ne nf lo kd ng nh ls ni bi translated"><strong class="ak">饼干，饼干，饼干</strong></h2><p id="62b2" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">我最初学习了如何使用<code class="fe nj nk nl mo b">local.storage</code>在从Spotify的Auth页面返回到应用程序的过程中存储认证令牌来执行OAuth2。这很好，直到我知道它给广告拦截器用户带来了问题。</p><p id="ea8d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我了解到这种方法在浏览器上创建了一个cookie，这导致了红旗。但是幸运的是有一个简单的解决方案，我实现了一个Redux store来保存令牌。</p><h2 id="78ca" class="ms kx in bd ky my mz dn lc na nb dp lg jv nc nd lk jz ne nf lo kd ng nh ls ni bi translated"><strong class="ak">错误处理响应对象</strong></h2><p id="5b18" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">我为我所有的Axios请求编写了<code class="fe nj nk nl mo b">try</code>和<code class="fe nj nk nl mo b">catch</code>语句，但是我忽略了一个问题:没有个人资料照片的用户。我从未见过没有Spotify帐户的，我甚至不知道这是可能的！</p><p id="f656" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我花了很多时间想知道为什么这个应用程序总是对少数用户崩溃，不管他们用的是什么设备。幸运的是，Reddit上的一个非常有用的人提出了这个问题，我可以制作一个默认的个人资料图像来解决这个问题。现在，我对从API返回的对象更加谨慎。</p><h1 id="4454" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">新手的一个大错误🤦</h1><ul class=""><li id="0cb4" class="lz ma in jm b jn lu jr lv jv nm jz nn kd no kh me mf mg mh bi translated">当时，我不知道你可以用更漂亮的配置<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/4-step-guide-to-setting-up-eslint-prettier-d87904a7746e"> ESLint，所以当我认为我已经完成时，我通过<strong class="jm io">将每个文件</strong>复制/粘贴到</a><a class="ae kv" href="https://prettier.io/playground/" rel="noopener ugc nofollow" target="_blank">更漂亮的. io操场</a>中，然后将干净的代码复制/粘贴回项目中，从而清理了代码。它确实有效，但是我现在有了一个更好的方法。</li></ul><h1 id="2d5a" class="kw kx in bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">结论✨</h1><p id="88af" class="pw-post-body-paragraph jk jl in jm b jn lu jp jq jr lv jt ju jv lw jx jy jz lx kb kc kd ly kf kg kh ig bi translated">通过制作这个项目，我学到了很多东西。把一些东西放到这个世界上也很有趣，我很期待接下来的事情。</p><p id="d97f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">用<a class="ae kv" href="https://vercel.com" rel="noopener ugc nofollow" target="_blank"> Vercel </a>托管也是一个很棒的想法，我已经把它用在了我所有的其他个人项目中，并且还写了一个教程<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/hosting-your-web-app-with-vercel-8ef3f1fbb5ff">，这个教程是用简单的英语在<strong class="jm io"> Javascript上选择并发布的。</strong></a></p><p id="a382" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">心情是奇怪的，不可言喻的，但我希望心情和一些人联系在一起:)</p></div></div>    
</body>
</html>