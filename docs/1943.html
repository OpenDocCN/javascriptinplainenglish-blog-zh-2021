<html>
<head>
<title>How to Create a Node.js Back-End using the MVC Software Design Pattern</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用MVC软件设计模式创建Node.js后端</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-a-node-back-end-using-the-mvc-software-design-pattern-dc32cfe870fd?source=collection_archive---------6-----------------------#2021-04-23">https://javascript.plainenglish.io/creating-a-node-back-end-using-the-mvc-software-design-pattern-dc32cfe870fd?source=collection_archive---------6-----------------------#2021-04-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/447e8b5b0740bf5543d9bb1584df9bf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lOrbY_IXw2bxV1975UbNog.png"/></div></div></figure><p id="7bcb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本教程中，您将学习如何使用模型-视图-控制器(MVC)软件设计模式创建Node.js后端。这种设计模式使您能够将用户界面分成三个不同的元素。业务逻辑是分离的，这样数据、用户界面和用户输入就不会混合在一起。这允许一个更干净的架构，因为不同的层是解耦的，允许更快更容易地完成更改。</p><p id="ea6e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然而，这里要提到的一个重要的警告是，这些天来，这个软件设计模式的<strong class="jx io">视图</strong>部分不再像几年前那样相关。这是因为我们现在有前端框架，如React、Vue.js、Angular和Svelte，它们用于构建应用程序的前端。尽管如此，了解这些概念仍然很有用，因为当后端开发人员构建返回某种数据的REST和GraphQL APIs时，今天仍然在使用<strong class="jx io">模型</strong>和<strong class="jx io">控制器</strong>。像JavaScript Object Notation (JSON)这样的数据在API中使用，并使用fetch或Axios API进行检索。</p><h1 id="3998" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">先决条件</h1><p id="dd05" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">确保您已经安装了下面的工具和软件包</p><ul class=""><li id="79da" class="lw lx in jx b jy jz kc kd kg ly kk lz ko ma ks mb mc md me bi translated"><a class="ae mf" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js和npm </a></li><li id="0f39" class="lw lx in jx b jy mg kc mh kg mi kk mj ko mk ks mb mc md me bi translated"><a class="ae mf" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank">快递</a></li><li id="62b0" class="lw lx in jx b jy mg kc mh kg mi kk mj ko mk ks mb mc md me bi translated"><a class="ae mf" href="https://nodemon.io/" rel="noopener ugc nofollow" target="_blank">节点门</a></li><li id="d290" class="lw lx in jx b jy mg kc mh kg mi kk mj ko mk ks mb mc md me bi translated"><a class="ae mf" href="https://ejs.co/" rel="noopener ugc nofollow" target="_blank"> EJS </a></li></ul><h1 id="b850" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">设计模式</h1><h1 id="a3f4" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">模型</h1><p id="45ec" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">模型是这种设计模式的主要组成部分。它负责处理结构内部的所有数据。这是定义所有数据、业务逻辑和原则的地方。</p><h1 id="f4f2" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">视角</h1><p id="0e49" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">本质上，视图是用户界面。这是用户将要看到的应用程序的一部分。基本上设计的前端。在React、Vue.js、Angular和Svelte等前端框架出现之前，后端开发人员使用的是EJS、PUG和Handlebars等模板语言。</p><h1 id="4b99" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">控制器</h1><p id="6402" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">控制器可以被认为是应用程序的大脑。它接受用户请求的任何输入，然后将它们转换成模型和视图可以解释的命令。</p><h1 id="13ab" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">设置项目</h1><p id="d1ec" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">在桌面或目录下创建一个名为<strong class="jx io">my-app _ _的文件夹，然后将__cd </strong>放入其中。另外，在代码编辑器中打开该文件夹。确保您位于<strong class="jx io"> my-app </strong>文件夹中，然后在您的终端应用中运行以下命令。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="a30a" class="mu ku in mq b gy mv mw l mx my">mkdir backend<br/>cd backend<br/>npm init -y<br/>npm i express nodemon ejs<br/>mkdir controllers models public routes src  <br/>mkdir src/pages<br/>touch index.js</span></pre><p id="0abd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这将为我们的项目创建基本的设置。现在让我们创建一个简单的express服务器。将以下代码复制并粘贴到<code class="fe mz na nb mq b">index.js</code>文件中。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="1bb3" class="mu ku in mq b gy mv mw l mx my">const express = require('express');</span><span id="9c4a" class="mu ku in mq b gy nc mw l mx my">const app = express();</span><span id="0815" class="mu ku in mq b gy nc mw l mx my">app.get('/', (req, res) =&gt; res.send('Home Route'));</span><span id="c43d" class="mu ku in mq b gy nc mw l mx my">const port = process.env.PORT || 5000;</span><span id="71a3" class="mu ku in mq b gy nc mw l mx my">app.listen(port, () =&gt; console.log(`Server running on port ${port}, <a class="ae mf" href="http://localhost:${port}`));" rel="noopener ugc nofollow" target="_blank">http://localhost:${port}`));</a></span></pre><p id="61fb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在将这些运行脚本添加到<code class="fe mz na nb mq b">package.json</code>文件中。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="5615" class="mu ku in mq b gy mv mw l mx my">"scripts": {<br/>        "start": "node index.js",<br/>        "dev": "nodemon index.js"<br/>    },</span></pre><p id="43cc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在您的终端应用程序中运行以下任一运行代码，查看应用程序在您的web浏览器中的运行情况。第一次运行的代码使用Node，这意味着如果您想看到更改，需要重新启动服务器。第二次运行的代码使用Nodemon，它执行热重载，这意味着您只需要重载web浏览器就可以看到新的更改。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="3df3" class="mu ku in mq b gy mv mw l mx my">npm run start</span><span id="a686" class="mu ku in mq b gy nc mw l mx my">npm run dev</span></pre><h1 id="9c58" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">创建MVC控制器</h1><p id="80e7" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">是时候创建一些控制器了。创建两个名为<code class="fe mz na nb mq b">admin.js</code>的文件，一个放在<strong class="jx io">控制器</strong>文件夹中，另一个放在<strong class="jx io">路径</strong>文件夹中。接下来，创建一个<code class="fe mz na nb mq b">AnimeData.json</code>文件，并把它放在<strong class="jx io">模型</strong>文件夹中。现在创建一个<code class="fe mz na nb mq b">index.ejs</code>文件，并把它放在<strong class="jx io"> src/pages </strong>文件夹中。将下面的代码添加到<code class="fe mz na nb mq b">index.ejs</code>文件中。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="9dcb" class="mu ku in mq b gy mv mw l mx my">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>    &lt;head&gt;<br/>        &lt;meta charset="UTF-8" /&gt;<br/>        &lt;meta http-equiv="X-UA-Compatible" content="IE=edge" /&gt;<br/>        &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;<br/>        &lt;title&gt;Home Route&lt;/title&gt;<br/>    &lt;/head&gt;<br/>    &lt;body&gt;<br/>        &lt;h1&gt;Home Route&lt;/h1&gt;<br/>    &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="d669" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">将下面的代码放到<code class="fe mz na nb mq b">AnimeData.json</code>文件中。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="2a53" class="mu ku in mq b gy mv mw l mx my">[<br/>    {<br/>        "id": "1",<br/>        "type": "Anime",<br/>        "name": "Boku no Hero Academia"<br/>    },<br/>    {<br/>        "id": "2",<br/>        "type": "Anime",<br/>        "name": "Jujutsu Kaisen"<br/>    },<br/>    {<br/>        "id": "3",<br/>        "type": "Anime",<br/>        "name": "Shingeki no Kyojin"<br/>    }<br/>]</span></pre><p id="c49d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">将以下代码添加到<strong class="jx io">控制器</strong>文件夹内的<code class="fe mz na nb mq b">admin.js</code>文件中。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="8413" class="mu ku in mq b gy mv mw l mx my">const AnimeData = require('../models/AnimeData.json');</span><span id="953b" class="mu ku in mq b gy nc mw l mx my">exports.getIndex = (req, res) =&gt; {<br/>    res.render('index');<br/>};</span><span id="52cb" class="mu ku in mq b gy nc mw l mx my">exports.getAnime = (req, res) =&gt; {<br/>    res.json(AnimeData);<br/>};</span></pre><p id="e9e8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来将下面的代码添加到<strong class="jx io"> routes </strong>文件夹中的<code class="fe mz na nb mq b">admin.js</code>文件中。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="94bf" class="mu ku in mq b gy mv mw l mx my">const express = require('express');<br/>const adminController = require('../controllers/admin');</span><span id="87af" class="mu ku in mq b gy nc mw l mx my">const router = express.Router();</span><span id="0f4a" class="mu ku in mq b gy nc mw l mx my">router.get('/', adminController.getIndex);</span><span id="f8b0" class="mu ku in mq b gy nc mw l mx my">router.get('/anime', adminController.getAnime);</span><span id="3245" class="mu ku in mq b gy nc mw l mx my">module.exports = router;</span></pre><p id="e0a1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最后，用下面的代码更新根文件夹中的<code class="fe mz na nb mq b">index.js</code>文件。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="a8ce" class="mu ku in mq b gy mv mw l mx my">const express = require('express');<br/>const path = require('path');<br/>const adminRoute = require('./routes/admin');</span><span id="5528" class="mu ku in mq b gy nc mw l mx my">const app = express();</span><span id="e348" class="mu ku in mq b gy nc mw l mx my">// EJS template engine setup<br/>app.set('view engine', 'ejs');<br/>app.set('views', './src/pages');</span><span id="a869" class="mu ku in mq b gy nc mw l mx my">// Setting up the directory on the server for CSS, JavaScript and media files<br/>app.use('/static', express.static(path.join(__dirname + '/public')));</span><span id="6351" class="mu ku in mq b gy nc mw l mx my">// Configuring the server to work with form submissions and json files<br/>app.use(express.urlencoded({ extended: false }));<br/>app.use(express.json());</span><span id="b24e" class="mu ku in mq b gy nc mw l mx my">// Connecting all of the routes<br/>app.use('/', adminRoute);</span><span id="613d" class="mu ku in mq b gy nc mw l mx my">const port = process.env.PORT || 5000;</span><span id="b217" class="mu ku in mq b gy nc mw l mx my">app.listen(port, () =&gt; console.log(`Server running on port ${port}, <a class="ae mf" href="http://localhost:${port}`));" rel="noopener ugc nofollow" target="_blank">http://localhost:${port}`));</a></span></pre><p id="1da0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您需要重新加载页面或重启服务器。现在，如果您转到home route<a class="ae mf" href="http://localhost:5000/" rel="noopener ugc nofollow" target="_blank">http://localhost:5000</a>，它应该会加载<code class="fe mz na nb mq b">index.ejs</code>文件。如果你访问http://localhost:5000/anime，你应该会在浏览器中看到返回的JSON文件中的数据。</p><h1 id="b472" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">将CSS和JavaScript文件连接到前端</h1><p id="c13e" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">最后一步是将CSS样式表和JavaScript文件连接到<code class="fe mz na nb mq b">index.ejs</code>文件。在<strong class="jx io">公共</strong>文件夹中创建两个文件夹。一个叫<strong class="jx io"> css </strong>另一个叫<strong class="jx io"> js </strong>。现在用下面的代码创建一个<code class="fe mz na nb mq b">styles.css</code>文件并把它放在<strong class="jx io"> css </strong>文件夹中。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="0b4b" class="mu ku in mq b gy mv mw l mx my">body {<br/>    background: #bada55;<br/>}</span></pre><p id="023f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来创建一个<code class="fe mz na nb mq b">scripts.js</code>文件，用下面的代码把它放在<strong class="jx io"> js </strong>文件夹中。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="5e75" class="mu ku in mq b gy mv mw l mx my">console.log('Hello World');</span></pre><p id="0aae" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最后，用下面的代码更新<code class="fe mz na nb mq b">index.ejs</code>文件，现在它有了CSS和JavaScript文件的链接。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="a899" class="mu ku in mq b gy mv mw l mx my">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>    &lt;head&gt;<br/>        &lt;meta charset="UTF-8" /&gt;<br/>        &lt;meta http-equiv="X-UA-Compatible" content="IE=edge" /&gt;<br/>        &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;<br/>        &lt;title&gt;Home Route&lt;/title&gt;<br/>        &lt;link rel="stylesheet" href="http://localhost:5000/static/css/styles.css" /&gt;<br/>    &lt;/head&gt;<br/>    &lt;body&gt;<br/>        &lt;h1&gt;Home Route&lt;/h1&gt;</span><span id="e4b0" class="mu ku in mq b gy nc mw l mx my">        &lt;script src="http://localhost:5000/static/js/scripts.js"&gt;&lt;/script&gt;<br/>    &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="33e4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">重新加载浏览器或重启服务器。如果你去回家的路线，你应该看到一个绿色的背景，如果你去浏览器控制台，你应该看到代码<strong class="jx io"> Hello World </strong>。这些是使用MVC软件设计模式创建Node.js后端服务器的基础。如果你计划将后端连接到React这样的框架，你就不需要<strong class="jx io"> src </strong>文件夹。相反，您可以使用<strong class="jx io">模型</strong>文件夹以JSON的形式返回数据。<strong class="jx io"> models </strong>文件夹也是创建编程逻辑的地方，该逻辑用于将后端连接到MongoDB、Postgre、SQL和HarperDB等数据库。</p><h1 id="5679" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">最后的想法</h1><p id="adcb" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">我真的希望你喜欢阅读这篇文章，并从中学到一些东西。作为一名内容创作者和技术作家，我热衷于分享我的知识并帮助其他人实现他们的目标。让我们通过社交媒体联系起来。你可以在<a class="ae mf" href="https://linktr.ee/andrewbaisden" rel="noopener ugc nofollow" target="_blank"> Linktree </a>上找到我所有的社交媒体资料和博客。</p><p id="9445" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">和平！</p><p id="8eff" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="nd">更多内容请看</em><a class="ae mf" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="nd">plain English . io</em></a></p></div></div>    
</body>
</html>