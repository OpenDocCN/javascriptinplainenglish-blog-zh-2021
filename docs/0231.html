<html>
<head>
<title>A Deep Dive into the Vue3 Composition API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入探究Vue3组合API</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/a-deep-dive-into-the-vue3-composition-api-dece990fc846?source=collection_archive---------13-----------------------#2021-01-13">https://javascript.plainenglish.io/a-deep-dive-into-the-vue3-composition-api-dece990fc846?source=collection_archive---------13-----------------------#2021-01-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e99b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过示例深入研究vue组合API。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/01dbe29edc44b18ed1009df5033156cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eh-USbzKlhy7Cx9g"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@baciutudor?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tudor Baciu</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7953" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你过去一直使用vue，毫无疑问你没有使用过Options API。</p><p id="f182" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">API选项使我们能够通过在组件结构中声明数据、方法、创建的和生命周期挂钩来创建vue组件。还有另一种方法，我们可以使用组合API来创建组件。组合API将是vue3的主要部分。</p><p id="e445" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">引入Composition API是为了解决在创建组件时使用Options API带来的限制和缺点。创建较大的复杂程序时，Options API的一些缺点是:</p><ul class=""><li id="358c" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">大型组件可能变得可读性更差，因此可维护性更差。</li><li id="0865" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">Options API中的代码重用模式有其缺点。</li><li id="bb07" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">选项API也使得将复杂的逻辑组合在一起变得更加困难。</li></ul><p id="148c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Composition API使我们能够在setup函数中轻松地分组和创建逻辑(函数)。</p><p id="5679" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了组合API，我们基本上可以在组件内部设置钩子。在setup函数中，我们将包含所有的应用程序逻辑。</p><p id="f36c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，我们仍然可以使用Options API来创建vue应用程序，但是对于需要更复杂逻辑、更多代码重用和更多组织的更复杂的项目，强烈建议使用composition api。</p><p id="dee1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这实际上是可选的，尽管您仍然可以使用Options API创建令人惊叹的应用程序。</p><p id="fa8c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们创建一个简单的vue项目，并看看组成api</p><p id="ada2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要创建vue项目，请打开您的终端并运行命令</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="7d0a" class="ml mm iq mh b gy mn mo l mp mq">vue create composition-api</span></pre><p id="2a53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该命令将为我们创建一个名为composition-api的新vue应用程序</p><p id="ea63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在使用您最喜欢的文本编辑器打开composition-api文件夹。</p><p id="bdaa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要使用组合api，我们需要在组件内部创建一个设置函数。</p><p id="000c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另外，请注意，setup函数将在任何其他生命周期挂钩之前首先运行。(已创建、计算、安装)。</p><p id="040b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在setup函数中，我们可以编写任何普通的JavaScript或逻辑。</p><p id="4601" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们必须注意的唯一区别是，当我们想要呈现与我们的组件相关联的任何东西时，我们需要返回特定的函数或变量，以使它在我们的模板组件中可用。</p><p id="55fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<em class="mr"> app.vue </em>中，我们可以创建如下设置功能。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="f0cf" class="ml mm iq mh b gy mn mo l mp mq">setup() {</span><span id="83d0" class="ml mm iq mh b gy ms mo l mp mq">const state = {</span><span id="4f07" class="ml mm iq mh b gy ms mo l mp mq">name: “John Philip”,</span><span id="7099" class="ml mm iq mh b gy ms mo l mp mq">age: 23,</span><span id="4dd5" class="ml mm iq mh b gy ms mo l mp mq">};</span><span id="6706" class="ml mm iq mh b gy ms mo l mp mq"><em class="mr">return</em> { state };</span><span id="0dfb" class="ml mm iq mh b gy ms mo l mp mq">}</span></pre><p id="e2ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，在我们的模板组件中，我们可以使用双花括号来呈现姓名和年龄，如下所示。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="c619" class="ml mm iq mh b gy mn mo l mp mq">&lt;div&gt;</span><span id="686d" class="ml mm iq mh b gy ms mo l mp mq">&lt;h2&gt;{{ state.name }}&lt;/h2&gt;</span><span id="6be4" class="ml mm iq mh b gy ms mo l mp mq">&lt;p&gt;{{ state.age }}&lt;/p&gt;</span><span id="5cb9" class="ml mm iq mh b gy ms mo l mp mq">&lt;/div&gt;</span></pre><p id="93d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">姓名和年龄将呈现在我们的页面上。</p><p id="1efe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另外，要注意vue composition-api不会自动绑定我们的状态数据。为了确保双向状态数据绑定，我们需要使用refs或reactive。</p><p id="cb37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，任何功能、方法和其他计算属性都可以直接写在setup函数中。还要记住返回需要在模板组件中呈现的任何内容。</p><p id="63bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将制作一个简单的应用程序，显示用户输入的姓名。</p><p id="9079" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，因为我们需要双向数据绑定，所以我们可以使用refs或者reactive。在这种情况下，我们将使用反应式。</p><p id="3b43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们需要一个输入和一个提交按钮来更新我们的州数据。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="c714" class="ml mm iq mh b gy mn mo l mp mq">&lt;template&gt;</span><span id="7f63" class="ml mm iq mh b gy ms mo l mp mq">&lt;div&gt;</span><span id="dcd3" class="ml mm iq mh b gy ms mo l mp mq">&lt;h2&gt;ADD NAMES&lt;/h2&gt;</span><span id="d183" class="ml mm iq mh b gy ms mo l mp mq">&lt;input v-model="state.name" type="text " placeholder="enter name to add" /&gt;</span><span id="4107" class="ml mm iq mh b gy ms mo l mp mq">&lt;button @click="addName"&gt;add name&lt;/button&gt;</span><span id="b0c6" class="ml mm iq mh b gy ms mo l mp mq">&lt;ul v-for="(name, i) in state.names" :key="i"&gt;</span><span id="d309" class="ml mm iq mh b gy ms mo l mp mq">&lt;li&gt;{{ name }}&lt;/li&gt;</span><span id="45c6" class="ml mm iq mh b gy ms mo l mp mq">&lt;/ul&gt;</span><span id="a030" class="ml mm iq mh b gy ms mo l mp mq">&lt;/div&gt;</span><span id="0f9f" class="ml mm iq mh b gy ms mo l mp mq">&lt;/template&gt;</span><span id="b5cd" class="ml mm iq mh b gy ms mo l mp mq">&lt;script&gt;</span><span id="5cf6" class="ml mm iq mh b gy ms mo l mp mq"><em class="mr">import</em> { reactive } <em class="mr">from</em> "vue";</span><span id="deb5" class="ml mm iq mh b gy ms mo l mp mq"><em class="mr">export</em> <em class="mr">default</em> {</span><span id="9fec" class="ml mm iq mh b gy ms mo l mp mq">name: "App",</span><span id="db5f" class="ml mm iq mh b gy ms mo l mp mq">setup() {</span><span id="be3b" class="ml mm iq mh b gy ms mo l mp mq">const state = reactive({</span><span id="5617" class="ml mm iq mh b gy ms mo l mp mq">name: "John Philip",</span><span id="4373" class="ml mm iq mh b gy ms mo l mp mq">age: 23,</span><span id="cb56" class="ml mm iq mh b gy ms mo l mp mq">names: [],</span><span id="47b4" class="ml mm iq mh b gy ms mo l mp mq">});</span><span id="7884" class="ml mm iq mh b gy ms mo l mp mq">function addName() {</span><span id="a80e" class="ml mm iq mh b gy ms mo l mp mq">state.names.push(state.name);</span><span id="1fe7" class="ml mm iq mh b gy ms mo l mp mq">state.name = "";</span><span id="4c6d" class="ml mm iq mh b gy ms mo l mp mq">}</span><span id="52d5" class="ml mm iq mh b gy ms mo l mp mq"><em class="mr">return</em> { state, addName };</span><span id="31e7" class="ml mm iq mh b gy ms mo l mp mq">},</span><span id="6d9c" class="ml mm iq mh b gy ms mo l mp mq">};</span><span id="540e" class="ml mm iq mh b gy ms mo l mp mq">&lt;/script&gt;</span></pre><p id="df88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的代码片段中，我们有一个input元素，用户将在其中键入名称，附加到它的是一个v-model指令，它将确保状态和UI之间的双向数据绑定。</p><p id="057c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以看到我们的状态是反作用的。reactive的作用是支持状态和UI之间的双向数据绑定。有了它，我们可以很容易地改变我们的状态数据。</p><p id="b045" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还有一个函数addName。这个函数的作用是获取用户输入的姓名，并将其放入names数组。</p><p id="4651" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，它将name对象重置为空字符串，以防止名称出现在我们的输入部分。</p><p id="cfe3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你能从上面的功能中看到，我们的组合api是简单、干净和可读的代码。</p><p id="17ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设我们使用options api来做类似的事情，结果应该是这样的。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="a73e" class="ml mm iq mh b gy mn mo l mp mq">&lt;template&gt;</span><span id="627b" class="ml mm iq mh b gy ms mo l mp mq">&lt;img alt="Vue logo" src="./assets/logo.png" /&gt;</span><span id="e36b" class="ml mm iq mh b gy ms mo l mp mq">&lt;div&gt;</span><span id="56a1" class="ml mm iq mh b gy ms mo l mp mq">&lt;h2&gt;ADD NAME&lt;/h2&gt;</span><span id="0e55" class="ml mm iq mh b gy ms mo l mp mq">&lt;p&gt;{{ state.age }}&lt;/p&gt;</span><span id="cdd1" class="ml mm iq mh b gy ms mo l mp mq">&lt;input v-model="state.name" type="text " placeholder="enter name to add" /&gt;</span><span id="d164" class="ml mm iq mh b gy ms mo l mp mq">&lt;button @click="addName"&gt;add name&lt;/button&gt;</span><span id="5f5c" class="ml mm iq mh b gy ms mo l mp mq">&lt;ul v-for="(name, i) in state.names" :key="i"&gt;</span><span id="9493" class="ml mm iq mh b gy ms mo l mp mq">&lt;li&gt;{{ name }}&lt;/li&gt;</span><span id="7f33" class="ml mm iq mh b gy ms mo l mp mq">&lt;/ul&gt;</span><span id="3142" class="ml mm iq mh b gy ms mo l mp mq">&lt;/div&gt;</span><span id="deff" class="ml mm iq mh b gy ms mo l mp mq">&lt;/template&gt;</span><span id="a0d0" class="ml mm iq mh b gy ms mo l mp mq">&lt;script&gt;</span><span id="a476" class="ml mm iq mh b gy ms mo l mp mq"><em class="mr">export</em> <em class="mr">default</em> {</span><span id="5cb8" class="ml mm iq mh b gy ms mo l mp mq">name: "App",</span><span id="9a5c" class="ml mm iq mh b gy ms mo l mp mq">data() {</span><span id="007b" class="ml mm iq mh b gy ms mo l mp mq"><em class="mr">return</em> {</span><span id="68f6" class="ml mm iq mh b gy ms mo l mp mq">state: {</span><span id="df51" class="ml mm iq mh b gy ms mo l mp mq">name: "John Philip",</span><span id="804a" class="ml mm iq mh b gy ms mo l mp mq">age: 23,</span><span id="faab" class="ml mm iq mh b gy ms mo l mp mq">names: [],</span><span id="c1d3" class="ml mm iq mh b gy ms mo l mp mq">},</span><span id="7d35" class="ml mm iq mh b gy ms mo l mp mq">};</span><span id="503a" class="ml mm iq mh b gy ms mo l mp mq">},</span><span id="777d" class="ml mm iq mh b gy ms mo l mp mq">methods: {</span><span id="5e4b" class="ml mm iq mh b gy ms mo l mp mq">addName() {</span><span id="267b" class="ml mm iq mh b gy ms mo l mp mq">this.state.names.push(this.state.name);</span><span id="f558" class="ml mm iq mh b gy ms mo l mp mq">this.state.name = "";</span><span id="146b" class="ml mm iq mh b gy ms mo l mp mq">},</span><span id="28b0" class="ml mm iq mh b gy ms mo l mp mq">},</span><span id="0520" class="ml mm iq mh b gy ms mo l mp mq">};</span><span id="f88f" class="ml mm iq mh b gy ms mo l mp mq">&lt;/script&gt;</span></pre><p id="0922" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你比较上面的两种方法，我们可以清楚地看到，与选项api相比，组合api更容易阅读。</p><p id="fd3c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你可以看到我们有相同的应用程序，包括组合api和选项api。</p><p id="0f16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您比较这两种方法，我们可以看到选项api有更多的代码和许多功能，而组合api有简单的代码和可读的代码功能。我们也可以很容易地重用代码。</p><p id="a83a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你对Composition API有什么看法，你觉得它真的有必要，并且比Options API更喜欢它吗？</p><h2 id="b5e9" class="ml mm iq bd mt mu mv dn mw mx my dp mz lf na nb nc lj nd ne nf ln ng nh ni nj bi translated"><strong class="ak">结论</strong></h2><p id="b7cb" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">简单回顾一下，我们已经看到了如何在Vue 3中使用Composition API来代替options api。</p><p id="3dd0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">谢谢你把这篇文章读到这里。如果你觉得这篇文章有帮助，请不要犹豫，分享出来。</p></div></div>    
</body>
</html>