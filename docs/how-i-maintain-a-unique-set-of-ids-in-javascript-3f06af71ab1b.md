# 我如何用 JavaScript 维护一组独特的 HTML Ids

> 原文：<https://javascript.plainenglish.io/how-i-maintain-a-unique-set-of-ids-in-javascript-3f06af71ab1b?source=collection_archive---------9----------------------->

![](img/3be0d2efe8c31bf9f3eda6917651df83.png)

管理一个应用程序的大量惟一 id 是非常令人畏惧的，尤其是当应用程序增长和扩展时。HTML 元素 id 是一个完美的例子，因为它们通常分散在许多文件中，很少协调。当更多的开发人员加入进来时，错误报告就不再是“是否”的问题，而是“何时”的问题。

我最近的一个用例是在 [Cypress](https://www.cypress.io/) 中跟踪测试 id。Cypress 的标准惯例是给 HTML 元素添加一个“data-cy”属性，这样在编写测试时就可以很容易地选择它们。

```
<button data-cy="my-button">Click</button>
```

这很好，但是正如我已经提到的，随着应用程序的扩展，管理和跟踪这些 Cypress 测试 id 会很快变得难以处理。拥有重复的 id 会在编写其他测试时导致错误，并且失败测试的原因可能并不明显。这可能导致浪费的检测和调试工作。然而，通过一个数组和一个简单的测试，我们可以很容易地解决这个问题。

# 追踪身份证

为了让这个过程工作，我们需要保存一个包含所有惟一 id 的数组。下面你会看到一组柏树身份证的例子。

在我的代码中向 HTML 元素添加“data-cy”属性时，我也需要将它添加到这个数组中。我将我的文件命名为 CyIds.ts，但是您可以随意命名它。这个数组本质上不会阻止我们添加重复的 id，但是通过我提到的简单测试，我们可以毫不费力地捕捉重复的 id。

(如果有人建议如何从 src 文件夹中提取‘data-cy’属性值，并在 VSCode 中用这个数组生成一个文件，那将是一个巨大的帮助)。

# 编写测试

现在我们保存了一个 id 数组，让我们编写一个简单的测试，如果有重复的 id，这个测试就会失败。

通过对数组进行排序，我们的测试可以通过用它的下一个邻居检查它自己的值来有效地跟踪任何重复的 id。为了识别哪个 id 是重复的，我们在循环中包含了 assert，这样如果它失败了，它就会记录失败的 id。有了这一点，如果您向主数组添加一个重复的 id，您的测试将会失败，并且您可以很容易地找到问题的重复项，而不用翻遍所有的源代码。

# 结论

在整个 web 应用程序中跟踪惟一的 id 起初看起来微不足道，但是如果管理不当，它会很快变成一堆令人筋疲力尽的技术债务。通过使用上面的技术，您可能会遇到在进行过程中向数组添加 id 的小麻烦，但是可以省去很多麻烦。自动化测试是我们的朋友，让我们写一次，让他们为我们工作。

在我的下一篇文章中，我将告诉你我们如何利用 TypeScript 和" [const assertion](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-4.html#const-assertions) "来获得一些真正令人惊奇的智能感知，这将使得在编写测试时使用这些 id 变得毫不费力。

*查看更多内容请点击*[***plain English . io***](https://plainenglish.io/)