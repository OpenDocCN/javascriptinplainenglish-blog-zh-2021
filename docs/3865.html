<html>
<head>
<title>3 Ways to Convert JSON to a JavaScript Object</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将JSON转换成JavaScript对象的3种方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/3-ways-to-convert-json-to-a-javascript-object-5d77c238b4ee?source=collection_archive---------10-----------------------#2021-08-03">https://javascript.plainenglish.io/3-ways-to-convert-json-to-a-javascript-object-5d77c238b4ee?source=collection_archive---------10-----------------------#2021-08-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/fb231a7dbd592da08948dcc0aa61c1c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1b-YCep3YxxHe0eo"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@pinjasaur?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Paul Esch-Laurent</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1411" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当你反序列化JSON的时候，你需要注意一些事情，这些事情可能一开始并不明显。为您的团队提供额外的安全性和调试能力是他们所欣赏的。</p><p id="fd66" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这篇博文中，我将比较3个库，它们可以帮助您找到在项目中反序列化JSON的最佳时机。</p><h1 id="e003" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">1.JSON。解析()</h1><p id="53f1" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">第一个是Javascript自带的，可能大多数人都知道。它允许简单、高效地将JSON解析成Javascript对象。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mb"><img src="../Images/4792b6bb4bddc00a4e11cd23c7aefcef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-qVWuRQ206cSv2B1DVuL4A.png"/></div></div></figure><p id="5433" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您现在可以使用<code class="fe mg mh mi mj b">personObject.firstName</code>(或任何其他字段)而不会在代码的其他部分出现任何问题。</p><p id="e06b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">注意，也可以用这个方法解析嵌套的JSON数据。</p><h1 id="b8a5" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">2.destr()</h1><p id="c355" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated"><code class="fe mg mh mi mj b"><a class="ae jz" href="https://www.npmjs.com/package/destr" rel="noopener ugc nofollow" target="_blank">destr</a></code>是我们要讨论的第二个库。<code class="fe mg mh mi mj b">destr</code>解析标准JSON比较慢，因为它会防止所谓的“原型污染”。</p><p id="def1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">原型污染/中毒对于从请求体接受JSON的应用程序来说是一个真正的安全风险。您可能知道，JavaScript允许您使用<code class="fe mg mh mi mj b">__proto__</code>属性调用来访问对象的原型。</p><p id="ab19" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您使用<code class="fe mg mh mi mj b">JSON.parse</code>来反序列化您的字符串，它也会反序列化对象的原型:</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/ff3f893bb7815835231ee61e26a3a52c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G8wh8rX8LbYsx9sLgCyprA.png"/></div></div></figure><p id="98db" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如您所见，如果personObjects字段来自请求，我们可能会检查它们(这是您应该经常做的事情)。但是在这种情况下，攻击者添加了一个<code class="fe mg mh mi mj b">__proto__</code>管理字段并将其设置为true！这对您的应用程序可能是灾难性的。</p><p id="9abf" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">所以才发明了<code class="fe mg mh mi mj b">destr</code>。当使用<code class="fe mg mh mi mj b">destr</code>解析字符串时，您不必担心原型中毒，因为它们将确保使用反序列化移除原型:</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/d139cb53588cba37ef79b8ba295ac84e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XnDG7AbLT7zPisLTHUUJRQ.png"/></div></div></figure><h1 id="d453" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">3.帕西逊()</h1><p id="3cec" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">我们考虑的第三种方法是使用<code class="fe mg mh mi mj b"><a class="ae jz" href="https://www.npmjs.com/package/parse-json" rel="noopener ugc nofollow" target="_blank">parse-json</a></code>库。Parse JSON为我们提供了获取更多关于文本反序列化期间可能发生的任何异常的深入信息的能力。</p><p id="031a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">考虑下面这段我们用<code class="fe mg mh mi mj b">JSON.Parse()</code>反序列化的JSON</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mm"><img src="../Images/d3ef0098b738444f378176c4baa3353e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vR5FY3fjespQrv054wigeA.png"/></div></div></figure><p id="c7ed" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">正如您所看到的，错误消息中几乎没有什么信息可以让我们快速找到错误的原因。请注意，这是一个小对象，如果是一个更大的对象，可能会更加困难。</p><p id="fd50" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在考虑同样使用<code class="fe mg mh mi mj b">parse-json</code></p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mn"><img src="../Images/36c6762c807df4c1406b1a5327cd19f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KCKNd1HqHmEkkZiW4opq5Q.png"/></div></div></figure><p id="aabc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">看看我们如何得到一个更详细的错误？这将允许您更快地找到异常的原因。这取决于你来决定这是否对你的项目有任何价值。</p><h1 id="9a18" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">结论</h1><p id="0023" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">根据您的项目，您可能对更具体的JSON解析库感兴趣。在本文中，您已经了解到<code class="fe mg mh mi mj b">destr</code>可能用在客户机JSON请求正常的环境中。</p><p id="5915" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您更有可能得到有问题的JSON，或者如果您只想能够更快地调试任何与JSON相关的异常，那么<code class="fe mg mh mi mj b">parseJson</code>库可能更适合您。</p><p id="3d13" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">像往常一样，考虑各种可能性，与您的团队讨论，为您的项目找到最合适的解决方案。祝你好运！</p><p id="1f6f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mo">更多内容尽在</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="mo">plain English . io</em></strong></a></p></div></div>    
</body>
</html>