<html>
<head>
<title>How to Inject Theme Details Into Angular Scope</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将主题细节注入角度范围</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-inject-theme-details-into-angular-scope-theming-chart-js-with-angular-11-daee166ed2ac?source=collection_archive---------15-----------------------#2021-08-27">https://javascript.plainenglish.io/how-to-inject-theme-details-into-angular-scope-theming-chart-js-with-angular-11-daee166ed2ac?source=collection_archive---------15-----------------------#2021-08-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="87db" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用角度11对Chart.js进行主题化</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/8f96504dc438225f4de00f405241d2c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yV-i-R8avRZ31pZ0"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk"><strong class="bd ks">Nature, The Best Theme Creator </strong>❤ — Photo by <a class="ae kt" href="https://unsplash.com/@zerotake?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">zero take</a> on <a class="ae kt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a4a4" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">Angular本身是一个非常强大和饱和的框架。它是成熟的，能够实现从概念到精心制作的实际应用程序的任何用户需求。在这种情况下，让第三方库兼容并直接使用是很容易的，因为它适用于许多其他基于JavaScript的框架。</p><p id="a98c" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">在日常的实现中，有时我们会遇到这样的用例，社区中的某个人已经开发了一个解决方案，同时许多贡献者对其进行了大量的改进。所以没有必要重新发明轮子。</p><p id="1803" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">作为例子，</p><ol class=""><li id="d7be" class="lq lr in kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">对于可视化仪表板实现，设计良好的图表/图形解决方案已经存在于开放云中，即使考虑到数据量，这些解决方案也实现得很好。(有些甚至延迟加载数据，这意味着能够在缩放或平移图表时按需获取数据)</li><li id="2d59" class="lq lr in kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">位置/地图解决方案</li><li id="94bc" class="lq lr in kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">画布解决方案</li><li id="2cd8" class="lq lr in kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">增强的功能部件——日期选择器、日期范围选择器等等</li></ol><p id="7c67" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">即使预期的业务需求或最终的功能/目标可以很容易地用这些专门制作的库部件来管理，但是在制作与主题兼容的部件时，我们仍然面临一个困难。这是因为有些库不支持通过样式类来控制主题，相反，它们期望的是注入颜色和印刷值作为输入参数。</p><p id="65f9" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">以上的主要技术原因，在这样的一些库中</p><ol class=""><li id="dbf3" class="lq lr in kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">他们执行一些画布渲染，其中画布上的颜色和排版在渲染时是需要的，并且不能通过主题化来控制。</li><li id="329e" class="lq lr in kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">外部主题化方面还没有被考虑，但是主题变量注入已经被简化了。</li></ol><p id="c3af" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">我们可以利用$theme实体和mixins，但是canvas涉及到Chart.js这样的用例，没有本地支持来克服这一点。</p><p id="d260" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">作为一个解决方案，我过去所做的是在将<a class="ae kt" href="https://material.angular.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw io">角度素材</strong> </a>主题变量扩展到角度附近的情况下进行讨论。</p></div><div class="ab cl me mf hr mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ig ih ii ij ik"><p id="bb59" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">基于ViewChild的主题细节注入机制是我的首选解决方案，我想推广它，甚至在完全独立的应用程序中利用它，因为我在实现基于图表和图形的应用程序时经常遇到实际的用例。在寻找解决方案时，我发现了这个美妙的<a class="ae kt" href="https://github.com/angular/components/issues/11315" rel="noopener ugc nofollow" target="_blank">功能请求</a>由<a class="ae kt" href="https://github.com/pjmagee" rel="noopener ugc nofollow" target="_blank"> pjmagee </a>提交，但是直到今天我写这篇文章时，它仍然是开放的和未分配的。这意味着该问题对于原生支持仍然是开放的。</p><p id="d994" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">于是我决定把它编译成一个小<a class="ae kt" href="https://www.npmjs.com/package/theme-emitter" rel="noopener ugc nofollow" target="_blank"> npm包</a>发布。如果您对已发布的npm库满意，那么您可以跳过步骤1来创建库。</p><p id="3b7e" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">让我们过一遍。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/bd0f31b8fdb6b7e5e0654e947c2d637f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_qOfsgjp6VjIoZsu"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae kt" href="https://unsplash.com/@der_maik_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Maik Jonietz</a> on <a class="ae kt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div><div class="ab cl me mf hr mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ig ih ii ij ik"><h1 id="ec13" class="ml mm in bd mn mo mp mq mr ms mt mu mv jt mw ju mx jw my jx mz jz na ka nb nc bi translated">1.主题-发射器库项目</h1><p id="55b7" class="pw-post-body-paragraph ku kv in kw b kx nd jo kz la ne jr lc ld nf lf lg lh ng lj lk ll nh ln lo lp ig bi translated">让我们从库模块创建步骤开始。您可以在您的项目用例中实现这一部分，或者直接导入并利用发布的npm包。</p><blockquote class="ni nj nk"><p id="f822" class="ku kv nl kw b kx ky jo kz la lb jr lc nm le lf lg nn li lj lk no lm ln lo lp ig bi translated">ng新主题-发射器-演示--创建-应用=假</p><p id="cb0c" class="ku kv nl kw b kx ky jo kz la lb jr lc nm le lf lg nn li lj lk no lm ln lo lp ig bi translated">cd主题-发射器-演示</p><p id="6a33" class="ku kv nl kw b kx ky jo kz la lb jr lc nm le lf lg nn li lj lk no lm ln lo lp ig bi translated">ng生成库主题-发射器</p></blockquote><p id="21e5" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">1.1在库组件HTML中，我们可以如下定义主题属性映射视图子id。让我们如下定义检索占位符的主要、强调和警告主题参数。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="c388" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">1.2然后如下定义样式mixin，因为它可以检索主题，该主题应该从基本主题设置器样式文件传递到这里。现在，我们已经将主题属性检索到了自定义组件中。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="29bb" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">1.3然后，可以定义一个小型模型类，用于承载和类型保护主题细节，如下所示</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="8d25" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">1.4接下来，我们可以读出component.ts文件中的主题属性。</p><ul class=""><li id="eec7" class="lq lr in kw b kx ky la lb ld ls lh lt ll lu lp nr lw lx ly bi translated">为此，我们可以使用本机方法“<em class="nl"> getComputedStyle </em>”，该方法使用目标元素(因为它是文档中所有对象继承的最通用的基类)</li><li id="aff3" class="lq lr in kw b kx lz la ma ld mb lh mc ll md lp nr lw lx ly bi translated">然后，它将返回一个“<em class="nl"> CSSStyleDeclaration </em>”对象，这是一个CSS声明块，它公开了样式信息和各种与样式相关的方法和属性。</li><li id="5972" class="lq lr in kw b kx lz la ma ld mb lh mc ll md lp nr lw lx ly bi translated">然后可以在服务设置器中分配已解析的主题属性。</li></ul><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="1a08" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">1.5然后应该定义主题发射器服务，它将负责向所有服务消费者发射那些旋转的主题值。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="13d8" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">1.6然后应该定义模块，组件应该像往常一样在ngModule下声明和导出。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="7de7" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">1.7主题发射器组件scss应该在最终的库发行版中公开，否则我们将无法在应用程序主题化中导入它。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="4aa8" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">现在一切都好于图书馆项目的创建。接下来我们要做的是，在实际使用案例中利用它。</p></div><div class="ab cl me mf hr mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ig ih ii ij ik"><h1 id="a673" class="ml mm in bd mn mo mp mq mr ms mt mu mv jt mw ju mx jw my jx mz jz na ka nb nc bi translated">2.主题-发射器利用</h1><p id="b89c" class="pw-post-body-paragraph ku kv in kw b kx nd jo kz la ne jr lc ld nf lf lg lh ng lj lk ll nh ln lo lp ig bi translated">2.1在base.scss文件中定义材质主题详细信息，如下所示。我将在后面的另一篇文章中详细讨论主题化的最佳实践。您也可以在共享的git位置找到更多关于颜色和配置的详细信息。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="f2db" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">然后，已定义的主题应该在组件主题混合下注入到主题发射器中。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="66bb" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">2.2同时，我们需要在应用程序的根级别初始化主题发射器自定义组件。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="b6d3" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">2.3现在一切就绪。如果任何人在应用程序中的任何地方订阅了主题发射器服务，就可以获取主题属性，并准备好在Angular组件附近使用。</p><p id="ffe5" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">如<em class="nl"> initTheme </em>函数所示，颜色细节来自主题发射器服务订阅。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="6775" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">2.4现在那些素材主题链接的样式参数可以传递给第三方组件了。在我的演示中，它是一个Chart.js组件。但可以是引言中提到的任何东西。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="005d" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">Git repo用于Angular lib模块的创建和使用</p><div class="ns nt gp gr nu nv"><a href="https://github.com/sajithahd/angular-theme-emitter-lib" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd io gy z fp oa fr fs ob fu fw im bi translated">github-sajithahd/angular-theme-emitter-lib:用StackBlitz ⚡️创建</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">由斯塔克布里兹·⚡️.创作为sajithahd/angular-theme-emitter-lib开发创建一个帐户…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">github.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj km nv"/></div></div></a></div><p id="39ae" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">Stackblitz工作演示—角度库模块的创建和使用</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ok nq l"/></div></figure></div><div class="ab cl me mf hr mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ig ih ii ij ik"><h1 id="5588" class="ml mm in bd mn mo mp mq mr ms mt mu mv jt mw ju mx jw my jx mz jz na ka nb nc bi translated">3.来自npm的主题发射器</h1><p id="2402" class="pw-post-body-paragraph ku kv in kw b kx nd jo kz la ne jr lc ld nf lf lg lh ng lj lk ll nh ln lo lp ig bi translated">我在npm中发布这个库模块，然后它可以直接导入到package.json中。</p><div class="ns nt gp gr nu nv"><a href="https://www.npmjs.com/package/theme-emitter" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd io gy z fp oa fr fs ob fu fw im bi translated">主题发射器</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">这个库是用Angular CLI版本11.0.9生成的。运行ng生成组件组件名称项目…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">www.npmjs.com</p></div></div><div class="oe l"><div class="ol l og oh oi oe oj km nv"/></div></div></a></div><p id="6fa9" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">针对上述npm包利用率的Git repo</p><div class="ns nt gp gr nu nv"><a href="https://github.com/sajithahd/angular-theme-emitter" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd io gy z fp oa fr fs ob fu fw im bi translated">github-sajithahd/angular-theme-emitter:用StackBlitz ⚡️创建</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">此项目是使用Angular CLI版本11.0.6生成的。为开发服务器运行ng serve。导航到…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">github.com</p></div></div><div class="oe l"><div class="om l og oh oi oe oj km nv"/></div></div></a></div><p id="b8bd" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">Stackblitz工作演示— npm模块利用率</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ok nq l"/></div></figure><p id="b246" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">可能有比这更好的方法来处理同样的问题。可能本地支持也会存在。如果是这样我邀请大家，请在这里分享你们的经历。</p><div class="ns nt gp gr nu nv"><a rel="noopener  ugc nofollow" target="_blank" href="/promises-vs-observables-what-is-ahead-of-the-pack-7567d5f6582a"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd io gy z fp oa fr fs ob fu fw im bi translated">承诺与观察——领先的是什么？</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">在本文中，我将讨论两个主要的异步支持框架工具及其区别——承诺…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="oe l"><div class="on l og oh oi oe oj km nv"/></div></div></a></div><p id="19a0" class="pw-post-body-paragraph ku kv in kw b kx ky jo kz la lb jr lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated"><em class="nl">更多内容看</em><a class="ae kt" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kw io"><em class="nl">plain English . io</em></strong></a></p></div></div>    
</body>
</html>