<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/use-ionic-angular-leaflet-to-build-a-pwa-to-show-a-map-that-works-offline-part-1-b69126386ce6?source=collection_archive---------2-----------------------#2021-07-18">https://javascript.plainenglish.io/use-ionic-angular-leaflet-to-build-a-pwa-to-show-a-map-that-works-offline-part-1-b69126386ce6?source=collection_archive---------2-----------------------#2021-07-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><h2 id="3a8d" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">ä½¿ç”¨Ionicå’Œä¼ å•æ„å»ºPWAåœ°å›¾åº”ç”¨ç¨‹åºğŸ—º ğŸ§­</h2><p id="41fd" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">å…·æœ‰è°·æ­Œåœ°å€æœç´¢é›†æˆï¼Œå…¨çƒå®šä½ç³»ç»Ÿå’Œå±‚åˆ‡æ¢å™¨ã€‚(é€æ­¥æŒ‡å—)</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi kd"><img src="../Images/4111bb9e67ee88b32d89323b6b0c9c06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V44KKR8bjY188HE_LGnPEA.png"/></div></div></figure><p id="c5ea" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">ä½ å¥½æœ‹å‹ï¼Œå¸•å‹’å§†åœ¨è¿™é‡Œä¸å¦ä¸€ä¸ªåˆ†æ­¥æŒ‡å—ã€‚</p><p id="eb9d" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªæ˜¾ç¤ºåœ°å›¾çš„Ionic PWAåº”ç”¨ç¨‹åºï¼Œä½†è¿™ä¸æ˜¯å…¨éƒ¨ã€‚</p><p id="66f7" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">å¿«é€Ÿé¢„è§ˆä¸€ä¸‹æœ€ç»ˆç»“æœæ˜¯ä»€ä¹ˆ:</p><figure class="ke kf kg kh gt ki"><div class="bz fp l di"><div class="ku kv l"/></div></figure><p id="7bac" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">ä»¥ä¸‹æ˜¯åº”ç”¨ç¨‹åºçš„åŠŸèƒ½ã€å®ç°æ¯ä¸ªéƒ¨åˆ†æ—¶æ‚¨å¯ä»¥å­¦åˆ°çš„å†…å®¹ä»¥åŠæ¯ä¸ªéƒ¨åˆ†çš„éš¾åº¦:</p><h2 id="28a4" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">1.ä½¿ç”¨Ionic CLIåˆ›å»ºä¸€ä¸ªç©ºç™½åº”ç”¨ç¨‹åºã€‚</h2><p id="4ecb" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">æ‚¨å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨Ionic CLIåˆ›å»ºIonic/Angularåº”ç”¨ç¨‹åºã€‚(éš¾åº¦:ç®€å•)</p><h2 id="771d" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">2.å°†ä¼ å•åœ°å›¾æ·»åŠ åˆ°æ‚¨çš„Ionicåº”ç”¨ç¨‹åºã€‚</h2><p id="f2d9" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">ä½ å°†å­¦ä¹ å¦‚ä½•å®ç°ä¸€ä¸ªç¦»å­ï¼Œä¼ å•å’Œè§’åº¦çš„åŸºæœ¬åœ°å›¾é›†æˆã€‚(éš¾åº¦:ç®€å•)</p><h2 id="efc6" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">3.æ·»åŠ ä¸€ä¸ªåŸºç¡€å±‚åˆ‡æ¢å™¨ä»¥åœ¨ä¸åŒçš„åŸºç¡€åœ°å›¾ä¹‹é—´åˆ‡æ¢</h2><p id="18af" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">æ‚¨å°†å­¦ä¹ å¦‚ä½•ä¸åŸºæœ¬çš„ä¼ å•APIäº¤äº’ï¼Œå¦‚<code class="fe kw kx ky kz b">TileLayer</code>ã€<code class="fe kw kx ky kz b">LayerGroup</code>å’ŒMapæ–¹æ³•ã€‚(éš¾åº¦ç­‰çº§:ä¸­çº§)</p><h2 id="0e03" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">4.åœ°ç†å®šä½APIé›†æˆä½¿ç”¨è®¾å¤‡GPSå’ŒæŸ¥æ‰¾ç”¨æˆ·å½“å‰ä½ç½®</h2><p id="318f" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">æ‚¨å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨åœ°ç†å®šä½APIæ¥æŸ¥æ‰¾è®¾å¤‡ä½ç½®å’Œå¤„ç†ç›¸å…³é”™è¯¯ã€‚(éš¾åº¦ç­‰çº§:ä¸­çº§)</p><h2 id="2b22" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">5.åœ°å€æœç´¢ä½¿ç”¨googleåœ°å€æœç´¢æ¥æŸ¥æ‰¾ä½ç½®ã€‚</h2><p id="0dca" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">æ‚¨å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨Google Places APIsè¿›è¡Œåœ°å€æœç´¢ï¼Œå¹¶æ‰¾åˆ°ä¸åœ°å€ç›¸å…³çš„åæ ‡ã€‚(éš¾åº¦ç­‰çº§:ä¸­çº§)</p><h2 id="22d0" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">6.åšä¸€ä¸ªPWA</h2><p id="35b3" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">ä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨<code class="fe kw kx ky kz b">@angular/pwa</code>è®©ä½ çš„åº”ç”¨æˆä¸ºå¯å®‰è£…çš„PWAã€‚(éš¾åº¦ç­‰çº§:ä¸­çº§)</p><h2 id="93db" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">7.æŠŠå®ƒå¸¦å›å®¶</h2><p id="9b9b" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">å¦‚æœæˆ‘ä»¬ä¸èƒ½ç‚«è€€è¿™ä¸€åˆ‡ï¼Œé‚£ä¹ˆå»ºé€ è¿™ä¸€åˆ‡åˆæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿè®©æˆ‘ä»¬ä½¿ç”¨<a class="ae la" href="https://vercel.com/" rel="noopener ugc nofollow" target="_blank"> Vercel </a>éƒ¨ç½²æ‚¨çš„æ–°åº”ç”¨ï¼Œå¹¶å‘æˆ‘ä»¬çš„æœ‹å‹å±•ç¤ºå®ƒğŸ˜€(éš¾åº¦:ç®€å•)</p><p id="0d44" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">ä¸‹é¢æ˜¯ç¬¬ä¸€éƒ¨åˆ†æ¼”ç¤º:<a class="ae la" href="https://ionic-angular-leaflet-offline-map-pwa-one.vercel.app/#/home" rel="noopener ugc nofollow" target="_blank">ä½¿ç”¨Vercel </a>éƒ¨ç½²çš„æ¼”ç¤º</p><p id="915d" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è¿™é‡Œæ˜¯Githubä»£ç åº“:<a class="ae la" href="https://github.com/pazel-io/ionic-angular-leaflet-offline-map-pwa.git" rel="noopener ugc nofollow" target="_blank">ionic-angular-leaflet-offline-map-pwa</a></p><p id="7b05" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æœ¬æ–‡æœ€åˆå‘è¡¨äº<a class="ae la" href="https://pazel.dev/ionic-angular-leaflet-pwa-offline-maps-part-1" rel="noopener ugc nofollow" target="_blank"> pazel.dev </a></p><h1 id="3c7c" class="lb im in bd io lc ld le ir lf lg lh iu li lj lk iy ll lm ln jc lo lp lq jg lr bi translated">æˆ‘ä»¬å¼€å§‹å§</h1><h2 id="f0e1" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">1.ä½¿ç”¨Ionic CLIåˆ›å»ºåŸºç¡€åº”ç”¨ç¨‹åº</h2><p id="1ad3" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">å¦‚æœæ‚¨ä¹‹å‰æ²¡æœ‰å®‰è£…Ionic CLIï¼Œè¯·å‰å¾€<a class="ae la" href="https://ionicframework.com/docs/intro/cli" rel="noopener ugc nofollow" target="_blank">ionicframework.com/docs/intro/cli</a>å¹¶æŒ‰ç…§è¯´æ˜å®‰è£…CLIã€‚</p><p id="cb5b" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬é€šè¿‡è¿è¡Œionic start <code class="fe kw kx ky kz b">ionic-leaflet-offline-map-pwa</code>ä½¿ç”¨CLIåˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚CLIåº”æç¤ºæ‚¨é€‰æ‹©å‰ç«¯æŠ€æœ¯å’Œæ›´å¤šé€‰é¡¹ã€‚</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi ls"><img src="../Images/a12c9922ab8056e8ed6897db218378ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YyvFm0jwsyQe4hXz"/></div></div></figure><p id="10ff" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æˆ‘å°†ä¸è§’å’Œç©ºç™½å¯åŠ¨é¡¹ç›®ã€‚Ionic CLIè¯¢é—®æ‚¨æ˜¯å¦å–œæ¬¢ç”µå®¹é›†æˆã€‚è¿™ä¸æ˜¯æœ¬æ•™ç¨‹æ‰€å¿…éœ€çš„ã€‚é€‰æ‹©é€‰é¡¹åï¼ŒCLIå°†ä¸‹è½½æ‰€æœ‰å¿…éœ€çš„npmè½¯ä»¶åŒ…ã€‚(è¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿ)</p><p id="e3ff" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">Ionic CLIè¯¢é—®æ‚¨åœ¨npmè½¯ä»¶åŒ…å®‰è£…åæ˜¯å¦éœ€è¦ä¸€ä¸ªå…è´¹çš„Ionicå¸æˆ·ã€‚è¿™ä¸æ˜¯æœ¬æ•™ç¨‹æ‰€å¿…éœ€çš„ã€‚æ‚¨æœ€ç»ˆä¼šçœ‹åˆ°ä¸€äº›æ—¥å¿—ï¼Œè¡¨æ˜è®¾ç½®å·²ç»å®Œæˆã€‚</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi lt"><img src="../Images/b2df841e2601100a560fd804f3b218a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cxaJ-ha8Ot-O_15S"/></div></div></figure><p id="3a53" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è®©æˆ‘ä»¬è½¬åˆ°åˆšåˆšåˆ›å»ºçš„æ–°é¡¹ç›®å¹¶è¿è¡Œ<code class="fe kw kx ky kz b">ionic serve</code>ã€‚è¿™å°†è¿è¡Œæœ¬åœ°webæœåŠ¡å™¨ï¼Œå¹¶åœ¨æ‚¨çš„é»˜è®¤æµè§ˆå™¨ä¸­æ‰“å¼€åº”ç”¨ç¨‹åºã€‚(é»˜è®¤ç«¯å£ä¸º8100)</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi lu"><img src="../Images/06cf51a6b102dbd7df9cf60a991784cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oLl97Psfeqc_1_Rb"/></div></div></figure><h2 id="73ef" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">2.ä½¿ç”¨ä¼ å•æ·»åŠ åœ°å›¾</h2><p id="a678" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated"><a class="ae la" href="https://leafletjs.com/" rel="noopener ugc nofollow" target="_blank">ä¼ å•</a>æ˜¯ä¸€ä¸ªå¼€æºçš„JavaScriptåº“ï¼Œç”¨äºç§»åŠ¨å‹å¥½çš„äº¤äº’å¼åœ°å›¾ã€‚å®ƒæä¾›äº†å¤§é‡å¾ˆé…·çš„åŠŸèƒ½æ¥å¤„ç†åœ°å›¾ã€‚ä½¿ç”¨æˆ‘ä»¬éœ€è¦æ˜¾ç¤ºåœ°å›¾çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†åªæ˜¯è§¦åŠè¡¨é¢ã€‚æ‰€ä»¥ç›¸å¯¹å®¹æ˜“ã€‚</p><p id="3609" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æˆ‘ä»¬ä½¿ç”¨æœ‰æ£±è§’çš„ä¼ å•åŒ…è£…ï¼Œä»¥ä¾¿äºæ•´åˆã€‚æˆ‘ä»¬å°†ä½¿ç”¨<code class="fe kw kx ky kz b">@asymmetrik/ngx-leaflet</code>é¡¹ç›®ã€‚è¿™ä¸ªåŒ…ä¸æ˜¯Angularçš„å®˜æ–¹éƒ¨åˆ†ï¼Œä½†å®ƒæ˜¯å¯é çš„ï¼Œæˆ‘åœ¨è®¸å¤šprodåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨è¿‡å®ƒã€‚</p><p id="b005" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è¿è¡Œ<code class="fe kw kx ky kz b">npm i leaflet @asymmetrik/ngx-leaflet</code>å®‰è£…<code class="fe kw kx ky kz b">leaflet</code>å’Œ<code class="fe kw kx ky kz b">ngx-leaflet</code>ã€‚</p><p id="75a9" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æˆ‘ä»¬å–œæ¬¢æ‰“å­—ç¨¿ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ·»åŠ é€‚å½“çš„ä¼ å•æ‰“å­—ã€‚</p><p id="d777" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è¿è¡Œ<code class="fe kw kx ky kz b">npm i @types/leaflet -D</code>å°†ç±»å‹ä½œä¸ºå¼€å‘ä¾èµ–é¡¹å®‰è£…ã€‚</p><p id="b1cf" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">å¥½äº†ï¼Œæˆ‘ä»¬å®Œæˆäº†å®‰è£…ã€‚è®©æˆ‘ä»¬ç»™æˆ‘ä»¬çš„Angularåº”ç”¨ç¨‹åºæ·»åŠ ä¸€å¼ åœ°å›¾å§ï¼</p><p id="0493" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æˆ‘å°†æŠŠåœ°å›¾æ·»åŠ åˆ°æˆ‘ä»¬çš„<code class="fe kw kx ky kz b">HomePage(home.page.ts)</code>ç»„ä»¶ä¸­ã€‚è¿™å¾ˆç®€å•ã€‚</p><h2 id="87a3" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">å°†<code class="fe kw kx ky kz b">LeafletModule</code>æ·»åŠ åˆ°<code class="fe kw kx ky kz b">HomePageModule(home.module.ts)</code>ä¸­çš„<code class="fe kw kx ky kz b">imports</code>æ•°ç»„</h2><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="2d2d" class="il im in kz b gy lz ma l mb mc">import { NgModule } from '@angular/core';<br/>import { CommonModule } from '@angular/common';<br/>import { LeafletModule } from '@asymmetrik/ngx-leaflet';<br/>import { IonicModule } from '@ionic/angular';<br/>import { FormsModule } from '@angular/forms';<br/>import { HomePage } from './home.page';</span><span id="bb07" class="il im in kz b gy md ma l mb mc">import { HomePageRoutingModule } from './home-routing.module';<br/></span><span id="1965" class="il im in kz b gy md ma l mb mc">@NgModule({<br/>  imports: [<br/>    CommonModule,<br/>    FormsModule,<br/>    IonicModule,<br/>    LeafletModule,<br/>    HomePageRoutingModule<br/>  ],<br/>  declarations: [HomePage]<br/>})<br/>export class HomePageModule {}</span></pre><h2 id="7508" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">æ·»åŠ åœ°å›¾<code class="fe kw kx ky kz b">options</code>å’Œ<code class="fe kw kx ky kz b">OnMapReady</code></h2><p id="21eb" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated"><code class="fe kw kx ky kz b">options</code>å®šä¹‰åœ°å›¾ä¸­å¿ƒã€æœ€å¤§ç¼©æ”¾ã€åŸºæœ¬å›¾å±‚ç­‰ã€‚</p><p id="8a2b" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated"><code class="fe kw kx ky kz b">onMapReady</code>å°†åœ¨æ´»é¡µåœ°å›¾å‡†å¤‡å°±ç»ªæ—¶è¢«è°ƒç”¨ï¼Œå¹¶æ¥æ”¶åœ°å›¾å®ä¾‹ã€‚ç¨åæˆ‘ä»¬å°†éœ€è¦è¿™ä¸ªå®ä¾‹ä¸åœ°å›¾è¿›è¡Œäº¤äº’ã€‚</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="6945" class="il im in kz b gy lz ma l mb mc">import { Component } from '@angular/core';<br/>import { Map as LMap, TileLayer } from 'leaflet';</span><span id="e252" class="il im in kz b gy md ma l mb mc">@Component({<br/>  selector: 'app-home',<br/>  templateUrl: 'home.page.html',<br/>  styleUrls: ['home.page.scss'],<br/>})<br/>export class HomePage {</span><span id="c4b4" class="il im in kz b gy md ma l mb mc">  public map: LMap;<br/>  public center = [<br/>    -28.690259,<br/>    131.5190514,<br/>  ];</span><span id="2958" class="il im in kz b gy md ma l mb mc">  public options = {<br/>    zoom: 5,<br/>    maxZoom: 18,<br/>    zoomControl: false,<br/>    preferCanvas: true,<br/>    attributionControl: true,<br/>    center: this.center,<br/>    layers: [<br/>      new TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')<br/>    ],<br/>  };</span><span id="2632" class="il im in kz b gy md ma l mb mc">  constructor() {}</span><span id="a84b" class="il im in kz b gy md ma l mb mc">  public async onMapReady(lMap: LMap) {<br/>    this.map = lMap;<br/>    setTimeout(() =&gt; lMap.invalidateSize(true), 0);<br/>  }</span><span id="f5ad" class="il im in kz b gy md ma l mb mc">}</span></pre><h2 id="cddf" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">åœ¨æˆ‘ä»¬çš„<code class="fe kw kx ky kz b">home.page.html</code>ä¸­æ·»åŠ åœ°å›¾å®¹å™¨ã€‚</h2><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="3677" class="il im in kz b gy lz ma l mb mc">&lt;ion-header [translucent]="true"&gt;<br/>  &lt;ion-toolbar&gt;<br/>    &lt;ion-title&gt;<br/>      Ionic Leaflet Map<br/>    &lt;/ion-title&gt;<br/>  &lt;/ion-toolbar&gt;<br/>&lt;/ion-header&gt;</span><span id="9399" class="il im in kz b gy md ma l mb mc">&lt;ion-content [fullscreen]="true"&gt;<br/>  &lt;div class="leaflet" leaflet<br/>       [leafletOptions]="options"<br/>       (leafletMapReady)="onMapReady($event)"&gt;<br/>  &lt;/div&gt;<br/>&lt;/ion-content&gt;</span></pre><h2 id="dfba" class="il im in bd io ip iq dn ir is it dp iu iv iw ix iy iz ja jb jc jd je jf jg jh bi translated">å°†æ´»é¡µCSSæ·»åŠ åˆ°æˆ‘ä»¬çš„å…¨çƒCSSåˆ—è¡¨ä¸­ã€‚</h2><p id="6a57" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">æ‰“å¼€é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„<code class="fe kw kx ky kz b">angular.json</code>æ–‡ä»¶ï¼Œå¹¶ä»</p><p id="c16c" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated"><code class="fe kw kx ky kz b">"styles": ["src/theme/variables.scss", "src/global.scss"],</code>è‡³:</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="2f8d" class="il im in kz b gy lz ma l mb mc">"styles": ["src/theme/variables.scss", "src/global.scss", "./node_modules/leaflet/dist/leaflet.css"],</span></pre><p id="ada0" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">å¹¶å°†åœ°å›¾å®¹å™¨CSSæ·»åŠ åˆ°<code class="fe kw kx ky kz b">home.page.scss</code>ã€‚æ›´æ–°åçš„æ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="2d8f" class="il im in kz b gy lz ma l mb mc">.leaflet {<br/>  height: 100%;<br/>  width: 100%;<br/>  position: absolute;<br/>  z-index: 0;<br/>}</span></pre><p id="9fee" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">é‡å¯æœåŠ¡å™¨ä»¥ç¡®ä¿æ–°çš„CSSæ­£ç¡®åŠ è½½ã€‚æ‚¨åº”è¯¥ä¼šçœ‹åˆ°è¿™æ ·çš„å±å¹•ã€‚</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi lu"><img src="../Images/2a52fe1407004cce3005192fb413bb18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ULdyUzJuDSW99irX"/></div></div></figure><p id="241d" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æ­å–œï¼æˆ‘ä»¬ç°åœ¨å·²ç»å°†ä¸€å¼ åœ°å›¾æ•´åˆåˆ°äº†ç¦»å­åº”ç”¨ç¨‹åºä¸­ã€‚</p><h1 id="f974" class="lb im in bd io lc ld le ir lf lg lh iu li lj lk iy ll lm ln jc lo lp lq jg lr bi translated">3.æ·»åŠ åˆ‡æ¢åŸºç¡€åœ°å›¾çš„åŠŸèƒ½</h1><p id="0203" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">æˆ‘ä»¬å·²ç»åœ¨å®šä¹‰çš„<code class="fe kw kx ky kz b">options</code>ä¸­æ·»åŠ äº†ä¸€ä¸ªåŸºç¡€åœ°å›¾ã€‚æˆ‘æƒ³æ”¹å˜å®ƒï¼Œä½¿ç”¨è‡ªè¡Œè½¦å’Œäº¤é€šåŸºç¡€åœ°å›¾ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªæŒ‰é’®åœ¨å®ƒä»¬ä¹‹é—´åˆ‡æ¢ã€‚</p><p id="d186" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œä»ç¦»å­æ·»åŠ ä¸€ä¸ªFABæŒ‰é’®æ¥è¿›è¡Œå±‚åˆ‡æ¢ã€‚ç»§ç»­ï¼Œåœ¨æ‚¨çš„<code class="fe kw kx ky kz b">&lt;ion-content&gt;</code>å†…æ·»åŠ ä¸€ä¸ªå¸¦æœ‰é€‰é¡¹åˆ—è¡¨çš„FABæŒ‰é’®ã€‚æ›´æ–°åçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="3c85" class="il im in kz b gy lz ma l mb mc">&lt;ion-header [translucent]="true"&gt;<br/>  &lt;ion-toolbar&gt;<br/>    &lt;ion-title&gt;<br/>      Ionic Leaflet Map<br/>    &lt;/ion-title&gt;<br/>  &lt;/ion-toolbar&gt;<br/>&lt;/ion-header&gt;</span><span id="e16d" class="il im in kz b gy md ma l mb mc">&lt;ion-content [fullscreen]="true"&gt;<br/>  &lt;ion-fab vertical="top" horizontal="end" slot="fixed"&gt;<br/>    &lt;ion-fab-button&gt;<br/>      &lt;ion-icon name="layers-outline"&gt;&lt;/ion-icon&gt;<br/>    &lt;/ion-fab-button&gt;<br/>    &lt;ion-fab-list side="bottom"&gt;<br/>      &lt;ion-fab-button color="danger"&gt;<br/>        &lt;ion-icon name="bicycle"&gt;&lt;/ion-icon&gt;<br/>      &lt;/ion-fab-button&gt;<br/>      &lt;ion-fab-button&gt;<br/>        &lt;ion-icon name="car"&gt;&lt;/ion-icon&gt;<br/>      &lt;/ion-fab-button&gt;<br/>    &lt;/ion-fab-list&gt;<br/>  &lt;/ion-fab&gt;<br/>  &lt;div class="leaflet" leaflet<br/>       [leafletOptions]="options"<br/>       (leafletMapReady)="onMapReady($event)"&gt;<br/>  &lt;/div&gt;<br/>&lt;/ion-content&gt;</span></pre><p id="710a" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æ›´æ–°åçš„å±å¹•å°†åœ¨å³ä¸Šè§’æœ‰ä¸€ä¸ªFABæŒ‰é’®ï¼Œæœ‰ä¸¤ä¸ªé€‰é¡¹(éª‘è‡ªè¡Œè½¦å’Œè¿è¾“)å¯ä¾›é€‰æ‹©ã€‚</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi lu"><img src="../Images/e70866bc09b8061215c7b30a1a208552.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*690BG5sPBgIxWuIR"/></div></div></figure><p id="b5f7" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">å½“æˆ‘ä»¬ç‚¹å‡»æ–°æŒ‰é’®æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä»£ç æ¥å®é™…åˆ‡æ¢åŸºç¡€åœ°å›¾ã€‚åˆ«æ‹…å¿ƒã€‚æˆ‘æŠ“ä½ä½ äº†ï¼</p><p id="f3ec" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æˆ‘ä¼šç»™ä½ çœ‹æ›´æ–°åçš„ä»£ç ï¼Œæˆ‘ä»¬ä¼šä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¿›è¡Œä¿®æ”¹ã€‚è¿™æ˜¯æ–°çš„<code class="fe kw kx ky kz b">home.page.ts</code>æ–‡ä»¶ã€‚</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="159a" class="il im in kz b gy lz ma l mb mc">import { Component } from '@angular/core';<br/>import { LayerGroup, Map as LMap, TileLayer } from 'leaflet';<br/>import { BaseLayer } from './BaseLayer.enum';</span><span id="edd8" class="il im in kz b gy md ma l mb mc">@Component({<br/>  selector: 'app-home',<br/>  templateUrl: 'home.page.html',<br/>  styleUrls: ['home.page.scss'],<br/>})<br/>export class HomePage {</span><span id="c7fa" class="il im in kz b gy md ma l mb mc">  public map: LMap;<br/>  public center = [<br/>    -37.8182711,<br/>    144.9648731<br/>  ];</span><span id="c2d0" class="il im in kz b gy md ma l mb mc">  public options = {<br/>    zoom: 15,<br/>    maxZoom: 18,<br/>    zoomControl: false,<br/>    preferCanvas: true,<br/>    attributionControl: true,<br/>    center: this.center,<br/>  };</span><span id="1efb" class="il im in kz b gy md ma l mb mc">  public baseMapUrls = {<br/>    [BaseLayer.cycling]: 'http://c.tile.thunderforest.com/cycle/{z}/{x}/{y}.png',<br/>    [BaseLayer.transport]: 'http://c.tile.thunderforest.com/transport/{z}/{x}/{y}.png',<br/>  };</span><span id="0f9d" class="il im in kz b gy md ma l mb mc">  public selectedBaseLayer = BaseLayer.cycling;</span><span id="3edc" class="il im in kz b gy md ma l mb mc">  public baseLayer = BaseLayer;</span><span id="36e4" class="il im in kz b gy md ma l mb mc">  private baseMapLayerGroup = new LayerGroup();</span><span id="34f1" class="il im in kz b gy md ma l mb mc">  constructor() {<br/>  }</span><span id="25f5" class="il im in kz b gy md ma l mb mc">  public async onMapReady(lMap: LMap) {<br/>    this.map = lMap;<br/>    this.map.addLayer(this.baseMapLayerGroup);<br/>    this.switchBaseLayer(this.selectedBaseLayer);<br/>    setTimeout(() =&gt; lMap.invalidateSize(true), 0);<br/>  }</span><span id="985d" class="il im in kz b gy md ma l mb mc">  public switchBaseLayer(baseLayerName: string) {<br/>    this.baseMapLayerGroup.clearLayers();<br/>    const baseMapTileLayer = new TileLayer(this.baseMapUrls[baseLayerName]);<br/>    this.baseMapLayerGroup.addLayer(baseMapTileLayer);<br/>    this.selectedBaseLayer = BaseLayer[baseLayerName];<br/>  }</span><span id="f03a" class="il im in kz b gy md ma l mb mc">}</span></pre><p id="08a4" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æˆ‘ä»åœ°å›¾<code class="fe kw kx ky kz b">options</code>ä¸­ç§»é™¤äº†<code class="fe kw kx ky kz b">layers</code>æ•°ç»„ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæˆ‘æ·»åŠ äº†åº•å›¾ï¼Œä¸€ä¸ªå¯¹è±¡ã€‚é”®æ˜¯åœ°å›¾åç§°ï¼Œå€¼æ˜¯åœ°å›¾åˆ‡ç‰‡çš„URLã€‚å¯¹äºé”®ï¼Œæˆ‘ä½¿ç”¨äº†TypeScriptæšä¸¾ï¼Œä»¥ä¾¿åœ¨é‡ç”¨ç›¸åŒçš„å­—ç¬¦ä¸²æ—¶æ›´å®¹æ˜“ã€‚Enumä½äºä¸€ä¸ªåä¸º<code class="fe kw kx ky kz b">BaseLayer.enum.ts</code>çš„æ–°æ–‡ä»¶ä¸­ï¼Œä¸‹é¢æ˜¯ä»£ç :</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="7a5f" class="il im in kz b gy lz ma l mb mc">export enum BaseLayer {<br/>  cycling = 'cycling',<br/>  transport = 'transport',<br/>}</span></pre><p id="b5ce" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æœ‰<code class="fe kw kx ky kz b">selectedBaseLayer</code>å±æ€§æ¥è·Ÿè¸ªç”¨æˆ·é€‰æ‹©äº†å“ªä¸ªåŸºå±‚ã€‚æˆ‘å·²ç»ä½¿ç”¨ç›¸åŒçš„æšä¸¾ç”¨å¾ªç¯åŸºç¡€åœ°å›¾åˆå§‹åŒ–äº†å®ƒã€‚</p><p id="b02d" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æœ‰æŒ‡å‘<code class="fe kw kx ky kz b">BaseLayer</code>æšä¸¾çš„<code class="fe kw kx ky kz b">baseLayer</code>å±æ€§ã€‚è¿™æ˜¯ä¸ºäº†è®©æšä¸¾å¯¹æˆ‘ä»¬çš„åœ°å›¾HTMLæ¨¡æ¿å¯ç”¨ï¼Œå¹¶åœ¨é‚£é‡Œä½¿ç”¨å®ƒã€‚</p><p id="9532" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æœ‰<code class="fe kw kx ky kz b">private baseMapLayerGroup = new LayerGroup();</code>ã€‚<code class="fe kw kx ky kz b">LayerGroup</code>æ˜¯ä¸€ç§åœ¨åœ°å›¾ä¸Šå¯¹å¤šä¸ªå›¾å±‚è¿›è¡Œåˆ†ç»„å¹¶å°†å®ƒä»¬ä¸å…¶ä»–å›¾å±‚åˆ†å¼€çš„æ´»é¡µæ–¹å¼ã€‚åœ¨è¿™é‡Œä½¿ç”¨å®ƒå¯ä»¥æ›´å®¹æ˜“åœ°ç®¡ç†åŸºç¡€å±‚ã€‚æˆ‘ä»¬ä»¥åä¼šä½¿ç”¨æ›´å¤šçš„å›¾å±‚ç»„æ¥æ·»åŠ åœ°å€æœç´¢å’ŒGPSæœç´¢ç»“æœã€‚</p><p id="c4f1" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æœ‰<code class="fe kw kx ky kz b">switchBaseLayer</code>æ³•ã€‚å®ƒé‡‡ç”¨ä¸€ä¸ªåŸºæœ¬å±‚åç§°ï¼Œå¹¶å¯ä»¥åˆ‡æ¢åŸºæœ¬å±‚ã€‚å®ƒé¦–å…ˆæ¸…é™¤å›¾å±‚ç»„ä¸­çš„ä»»ä½•å›¾å±‚ï¼Œç„¶åé€šè¿‡ä»<code class="fe kw kx ky kz b">baseMapUrls</code>å¯¹è±¡ä¸­æŸ¥æ‰¾é…ç½®æ¥æ·»åŠ æ–°å›¾å±‚ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬æ·»åŠ çš„å›¾å±‚å±äº<code class="fe kw kx ky kz b">TileLayer</code>ç±»å‹ã€‚ä¼ å•ä¸–ç•Œä¸­çš„è¿™ç§ç‰¹æ®Šç±»å‹çš„å›¾å±‚å¯ä»¥æ˜¾ç¤ºç”¨äºåŸºç¡€åœ°å›¾çš„å›¾å—ã€‚</p><p id="2454" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è¿™æ˜¯ä½ åœ¨HTMLä¸­éœ€è¦çš„æ”¹å˜ã€‚åŸºæœ¬ä¸Šæ˜¯ç»™æŒ‰é’®æ·»åŠ äº†<code class="fe kw kx ky kz b">click</code>åŠŸèƒ½ã€‚æ­¤å¤–ï¼Œæ£€æŸ¥<code class="fe kw kx ky kz b">selectedBaseLayer</code>å°†ä»£è¡¨æ‰€é€‰åŸºç¡€å±‚çš„æŒ‰é’®é¢œè‰²å˜ä¸ºçº¢è‰²(å±é™©)ï¼Œä»¥çªå‡ºæ˜¾ç¤ºè¯¥æŒ‰é’®çš„é¢œè‰²ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä½¿ç”¨äº†ç›¸åŒçš„<code class="fe kw kx ky kz b">BaseLayer</code>æšä¸¾å€¼æ¥æœ€å¤§åŒ–é‡ç”¨ï¼Œè€Œä¸æ˜¯é‡å¤æˆ‘è‡ªå·±ã€‚</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="5a97" class="il im in kz b gy lz ma l mb mc">&lt;ion-header [translucent]="true"&gt;<br/>  &lt;ion-toolbar&gt;<br/>    &lt;ion-title&gt;<br/>      Ionic Leaflet Map<br/>    &lt;/ion-title&gt;<br/>  &lt;/ion-toolbar&gt;<br/>&lt;/ion-header&gt;</span><span id="dde4" class="il im in kz b gy md ma l mb mc">&lt;ion-content [fullscreen]="true"&gt;<br/>  &lt;ion-fab vertical="top" horizontal="end" slot="fixed"&gt;<br/>    &lt;ion-fab-button&gt;<br/>      &lt;ion-icon name="layers-outline"&gt;&lt;/ion-icon&gt;<br/>    &lt;/ion-fab-button&gt;<br/>    &lt;ion-fab-list side="bottom"&gt;<br/>      &lt;ion-fab-button [color]="selectedBaseLayer === baseLayer.cycling ? 'danger' : 'primary'"<br/>                      (click)="switchBaseLayer(baseLayer.cycling)"&gt;<br/>        &lt;ion-icon name="bicycle"&gt;&lt;/ion-icon&gt;<br/>      &lt;/ion-fab-button&gt;<br/>      &lt;ion-fab-button [color]="selectedBaseLayer === baseLayer.transport ? 'danger' : 'primary'"<br/>                      (click)="switchBaseLayer(baseLayer.transport)"&gt;<br/>        &lt;ion-icon name="car"&gt;&lt;/ion-icon&gt;<br/>      &lt;/ion-fab-button&gt;<br/>    &lt;/ion-fab-list&gt;<br/>  &lt;/ion-fab&gt;<br/>  &lt;div class="leaflet" leaflet<br/>       [leafletOptions]="options"<br/>       (leafletMapReady)="onMapReady($event)"&gt;<br/>  &lt;/div&gt;<br/>&lt;/ion-content&gt;</span></pre><h1 id="8d9e" class="lb im in bd io lc ld le ir lf lg lh iu li lj lk iy ll lm ln jc lo lp lq jg lr bi translated">4.ä½¿ç”¨è®¾å¤‡GPSå¹¶æ‰¾åˆ°ç”¨æˆ·çš„å½“å‰ä½ç½®</h1><p id="e1d6" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">æˆ‘ä»¬å°†ä½¿ç”¨<a class="ae la" href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API" rel="noopener ugc nofollow" target="_blank">åœ°ç†å®šä½API </a>æ¥æŸ¥æ‰¾è®¾å¤‡ä½ç½®ã€‚è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„web APIã€‚å‡ºäºéšç§åŸå› ï¼Œç”¨æˆ·å°†è¢«è¦æ±‚æˆæƒè®¿é—®ä»–ä»¬çš„ä½ç½®ã€‚å› æ­¤ï¼Œç”¨æˆ·å¯ä»¥å…è®¸æˆ–æ‹’ç»è®¿é—®ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†è¿™ä¸ªè¿‡ç¨‹ä¸­çš„æ½œåœ¨é”™è¯¯ã€‚</p><p id="d856" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ–¹æ³•æ¥è¯»å–è®¾å¤‡çš„ä½ç½®ã€‚</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="8706" class="il im in kz b gy lz ma l mb mc">public async locate() {<br/>    this.locationLayerGroup.clearLayers();<br/>    if (!navigator.geolocation) {<br/>      console.error('Geolocation is not supported by your browser');<br/>      return;<br/>    }<br/>    await this.presentLoading();<br/>    navigator.geolocation.getCurrentPosition(<br/>      (position) =&gt; this.onLocationSuccess(position),<br/>      (error) =&gt; this.onLocateError(error),<br/>      {enableHighAccuracy: true}<br/>    );<br/>  }</span></pre><p id="da8e" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†ï¼Œæˆ‘å·²ç»åœ¨åä¸º<code class="fe kw kx ky kz b">locationLayerGroup</code>çš„åœ°å›¾ä¸Šæ·»åŠ äº†å¦ä¸€ä¸ªç”¨äºGPSå®šä½çš„<code class="fe kw kx ky kz b">LayerGroup</code>ã€‚</p><p id="1144" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘æ­£åœ¨æ£€æŸ¥æ˜¯å¦æ”¯æŒ<code class="fe kw kx ky kz b">navigator.geolocation</code>ã€‚æ³¨æ„ï¼Œå¦‚æœä¸æ”¯æŒï¼Œæˆ‘ä¼šè®°å½•ä¸€ä¸ªé”™è¯¯ï¼Œå¹¶ä½¿ç”¨<code class="fe kw kx ky kz b">return</code>è¯­å¥é€€å‡ºè¯¥å‡½æ•°ã€‚ä¸ä½¿ç”¨if/elseç›¸æ¯”ï¼Œè¿™æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼Œå¹¶ä¸”ä½¿æ‚¨çš„ä»£ç æ›´å…·å¯è¯»æ€§ã€‚</p><p id="ba91" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">å¦‚æœå®ƒå—æ”¯æŒï¼Œæˆ‘ä¼šæ˜¾ç¤ºä¸€æ¡åŠ è½½æ¶ˆæ¯ã€‚ç„¶åï¼Œæˆ‘è°ƒç”¨<code class="fe kw kx ky kz b">getCurrentPosition</code>ï¼Œå®ƒè¿”å›è®¾å¤‡çš„å½“å‰ä½ç½®(å¦‚æœæ‚¨å–œæ¬¢è§‚å¯Ÿä½ç½®ï¼Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ï¼Œè¿™æœ‰åˆ©äºè·Ÿè¸ªç”¨ä¾‹)ã€‚</p><p id="da0e" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated"><code class="fe kw kx ky kz b">getCurrentPosition</code>éœ€è¦ä¸‰ä¸ªå‚æ•°ã€‚é¦–å…ˆï¼ŒæˆåŠŸå›è°ƒå‡½æ•°ï¼Œå½“ä½ç½®è¢«æˆåŠŸè·å–æ—¶è°ƒç”¨ã€‚ç¬¬äºŒä¸ªæ˜¯é”™è¯¯å›è°ƒï¼Œå¦‚æœæœ‰é”™è¯¯å°±ä¼šè°ƒç”¨å®ƒã€‚åƒä½ç½®è®¿é—®è¢«æ‹’ç»æˆ–è¶…æ—¶é”™è¯¯ï¼Œå¦‚æœGPSå«æ˜Ÿä¸å¯ç”¨ã€‚ç¬¬ä¸‰ä¸ªæ˜¯<code class="fe kw kx ky kz b">PositionOptions</code>ï¼Œæˆ‘ç”¨å®ƒæ¥å¯ç”¨<code class="fe kw kx ky kz b">HighAccuracy</code>ä½ç½®ã€‚å¯ç”¨æ­¤é€‰é¡¹å°†å¯¼è‡´ä½ç½®è¯»å–èŠ±è´¹æ›´é•¿æ—¶é—´ï¼Œä½†ä¼šä½¿å®ƒæ›´å‡†ç¡®ã€‚</p><p id="6c37" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">ä¸‹é¢æ˜¯æˆåŠŸå›è°ƒçš„ä»£ç </p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="5900" class="il im in kz b gy lz ma l mb mc">private onLocationSuccess(position: GeolocationPosition) {<br/>    const {accuracy, latitude, longitude} = position.coords;<br/>    const latlng = [latitude, longitude];<br/>    this.hideLoading();<br/>    this.map.setView(latlng, 18);<br/>    const accuracyValue = accuracy &gt; 1000 ? accuracy / 1000 : accuracy;<br/>    const accuracyUnit = accuracy &gt; 1000 ? 'km' : 'm';<br/>    placeLocationMarker(this.locationLayerGroup, latlng, `Accuracy is ${accuracyValue} ${accuracyUnit}`);<br/>    const locationCircle = circle(latlng, accuracy);<br/>    this.locationLayerGroup.addLayer(locationCircle);<br/>  }</span></pre><p id="7c1c" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è¿™é‡Œæˆ‘ä»æˆ‘æ”¶åˆ°çš„<code class="fe kw kx ky kz b">GeolocationPosition</code>ä¸­è¯»å–ä¸€äº›å±æ€§ã€‚æˆ‘ä½¿ç”¨çº¬åº¦å’Œç»åº¦åˆ›å»ºä¸€ä¸ªä¼ å•LatLngæ•°ç»„ï¼Œå¯ä»¥åœ¨åœ°å›¾ä¸Šå±…ä¸­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨äº†åœ°å›¾çš„<code class="fe kw kx ky kz b">setView</code>æ–¹æ³•ï¼Œä¼ é€’äº†ä¸€ä¸ªç¼©æ”¾çº§åˆ«(18)ã€‚</p><p id="ef99" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æˆ‘ä»¬åœ¨è¿™é‡Œå¾—åˆ°çš„ç²¾åº¦æ˜¯ç±³ï¼Œæ‰€ä»¥å¦‚æœå®ƒå¤§äº1000ï¼Œæˆ‘å°±æŠŠå®ƒè½¬æ¢æˆåƒç±³ï¼Œè¿™æ ·åœ¨å‘ˆç°ç»™ç”¨æˆ·æ—¶å¯è¯»æ€§æ›´å¥½ã€‚</p><p id="2a83" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æˆ‘ä½¿ç”¨<code class="fe kw kx ky kz b">placeLocationMarker</code>åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºè®¾å¤‡ä½ç½®çš„æ ‡è®°ã€‚æˆ‘æå–äº†è¿™ä¸ªå‡½æ•°ï¼Œå› ä¸ºæˆ‘æƒ³åœ¨æ ‡è®°ä¸Šæ˜¾ç¤ºä¸€ä¸ªå·¥å…·æç¤ºï¼Œå®ƒæ˜¾ç¤ºäº†ç²¾ç¡®åº¦ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªä¼ å•å·¥å…·æç¤ºï¼Œæ•´ä¸ªDOMçš„åˆ›å»ºéƒ½æ˜¯ç”±ä¼ å•å¤„ç†çš„ï¼Œæ‰€ä»¥å¦‚ä½•å¤„ç†è§¦æ‘¸äº‹ä»¶å°±æœ‰ç‚¹å¤æ‚äº†ã€‚è¿™ç§å¤æ‚æ€§åœ¨<code class="fe kw kx ky kz b">placeLocationMarker</code>å‡½æ•°ä¸­å¤„ç†ã€‚</p><p id="a332" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æœ€åï¼Œæˆ‘ä½¿ç”¨æ´»é¡µ<code class="fe kw kx ky kz b">circle</code>åŠŸèƒ½åœ¨åœ°å›¾ä¸Šç”»äº†ä¸€ä¸ªåœ†ï¼Œç›´è§‚åœ°å‘ç”¨æˆ·å±•ç¤ºäº†ç²¾åº¦ã€‚è¿™ä¸ªåœ†ä»¥è®¾å¤‡ä½ç½®ä¸ºä¸­å¿ƒï¼ŒåŠå¾„å’Œç²¾åº¦ä¸€æ ·å¤§ã€‚</p><p id="4d0a" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">åœ¨ä½ è§‰å¾—å¤ªæ— èŠä¹‹å‰ï¼Œä»¥ä¸‹æ˜¯ç»“æœ</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi lu"><img src="../Images/4a2369c8d788dfe66abfd5f814f717ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4eJVrm4B4RcyPOam"/></div></div></figure><p id="39bc" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è¯·æ³¨æ„ï¼Œæˆ‘ä½¿ç”¨Chrome Devtoolsæ¥ä¼ªé€ GPSä½ç½®ã€‚æ‚¨å¯ä»¥é€šè¿‡ç‚¹å‡»æ§åˆ¶å°æ—è¾¹çš„ä¸‰ä¸ªç‚¹å¹¶é€‰æ‹©<code class="fe kw kx ky kz b">Sensors</code>åœ¨<code class="fe kw kx ky kz b">console</code>é€‰é¡¹å¡ä¸­è®¿é—®è¯¥åŠŸèƒ½ã€‚</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi me"><img src="../Images/cb068c23fac810c2a91654367f589403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eFcbdLM5hWUJftCA"/></div></div></figure><p id="5317" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">å¥½äº†ï¼Œæˆ‘ä»¬æ¥å¿«é€Ÿçœ‹ä¸€ä¸‹é”™è¯¯å›è°ƒã€‚è¿™ä¸ªå¾ˆç®€å•ã€‚å‡ºé”™æ—¶ï¼Œæˆ‘ä»¬éšè—åŠ è½½å¹¶ä½¿ç”¨Ionicçš„è­¦æŠ¥ç»„ä»¶é€šçŸ¥ç”¨æˆ·é—®é¢˜ã€‚å¯èƒ½ä¼šå‘ç”Ÿ3ä¸ªé”™è¯¯ã€‚æƒé™è¢«æ‹’ç»ï¼Œè¶…æ—¶ï¼Œä½ç½®ä¸å¯ç”¨ã€‚å‰ä¸¤ç§æƒ…å†µå¾ˆæ˜æ˜¾ï¼Œç¬¬ä¸‰ç§å¯èƒ½å‘ç”Ÿåœ¨GPSç¡¬ä»¶å‡ºç°æ•…éšœæ—¶ã€‚å¯¹äºæ¯ä¸ªé”™è¯¯ï¼Œæ‚¨éƒ½ä¼šå¾—åˆ°ä¸€æ¡æ¶ˆæ¯å’Œä»£ç ã€‚å¦‚æœä½ éœ€è¦å®šåˆ¶ä¿¡æ¯ï¼Œä½¿ç”¨ä»£ç å¹¶èµ·è‰ä½ è‡ªå·±çš„ä¿¡æ¯ã€‚</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="2d43" class="il im in kz b gy lz ma l mb mc">private async onLocateError(error) {<br/>    this.hideLoading();<br/>    const alert = await this.alertController.create({<br/>      header: 'GPS error',<br/>      message: error.message,<br/>      buttons: ['OK']<br/>    });</span><span id="a5dc" class="il im in kz b gy md ma l mb mc">    await alert.present();<br/>  }</span></pre><p id="0f6e" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æœ€åï¼Œè¿™é‡Œæ˜¯<code class="fe kw kx ky kz b">placeLocationMarker</code>å‡½æ•°çš„ä»£ç ã€‚æ­¤ä»£ç ä½äºåŒåçš„å•ç‹¬æ–‡ä»¶ä¸­ã€‚å®ƒåšä¸‰ä»¶äº‹ã€‚</p><ul class=""><li id="393f" class="mf mg in jk b jl kp jp kq iv mh iz mi jd mj kc mk ml mm mn bi translated">ä½¿ç”¨è‡ªå®šä¹‰å›¾æ ‡åˆ›å»ºä¼ å•æ ‡è®°ã€‚</li><li id="b062" class="mf mg in jk b jl mo jp mp iv mq iz mr jd ms kc mk ml mm mn bi translated">å°†ä¼ å•å¼¹å‡ºç»‘å®šåˆ°æ˜¾ç¤ºç²¾ç¡®åº¦å€¼å’Œåˆ é™¤é“¾æ¥æŒ‰é’®çš„æ ‡è®°ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦åˆ é™¤ï¼Ÿå› ä¸ºå½“ç”¨æˆ·å‘åœ°å›¾æ·»åŠ æ ‡è®°æ—¶ï¼Œä»–ä»¬éœ€è¦ä¸€ç§æ–¹æ³•åœ¨å®Œæˆåå°†å…¶ç§»é™¤ã€‚</li><li id="cd50" class="mf mg in jk b jl mo jp mp iv mq iz mr jd ms kc mk ml mm mn bi translated">ä¾¦å¬ç‰¹å®šæ ‡è®°å¼¹å‡ºçª—å£ä¸Šçš„clickäº‹ä»¶ï¼Œä»¥å¤„ç†åˆ é™¤æŒ‰é’®å•å‡»ã€‚å¦‚å‰æ‰€è¿°ï¼Œè¿™é‡Œçš„DOMæ“ä½œå®Œå…¨å‘ç”Ÿåœ¨Angularä¸–ç•Œä¹‹å¤–ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨RxJS <code class="fe kw kx ky kz b">fromEvent</code>å‡½æ•°æ¥è¿‡æ»¤å’Œæ¥æ”¶æ¥è‡ªè¿™ä¸ªåˆ é™¤æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ã€‚</li></ul><p id="56c1" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">åªæœ‰å½“å¼¹å‡ºçª—å£æ‰“å¼€æ—¶ï¼Œæ‰ä¼šè®¢é˜…clickäº‹ä»¶ï¼Œä¸€æ—¦å…³é—­ï¼Œå°±ä¼šå–æ¶ˆè®¢é˜…ã€‚</p><p id="344b" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è¿™é‡Œçš„å¦ä¸€ä¸ªå¥½çš„å®è·µæ˜¯æå–<code class="fe kw kx ky kz b">placeLocationMarker</code>ã€‚è¿™ä½¿å¾—å®ƒå°½å¯èƒ½çš„çº¯å‡€ã€‚æ‰€ä»¥è¿™ä¸ªå‡½æ•°åªä¾èµ–äºå®ƒçš„è¾“å…¥æ¥è¿è¡Œã€‚</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="9e31" class="il im in kz b gy lz ma l mb mc">import { LatLng, LayerGroup, marker, Marker } from 'leaflet';<br/>import { fromEvent, Subscription } from 'rxjs';<br/>import { filter, map, tap } from 'rxjs/operators';<br/>import { markerIcon } from './markerIcon';</span><span id="8e84" class="il im in kz b gy md ma l mb mc">const subscribeToDeleteLocationMarker = (id: string, marco: Marker, layerGroup: LayerGroup): Subscription =&gt; {<br/>  return fromEvent(document, 'click')<br/>    .pipe(<br/>      tap((event) =&gt; event.stopPropagation()),<br/>      map((event) =&gt; event.target),<br/>      filter((target: HTMLElement) =&gt; target.id === id),<br/>    )<br/>    .subscribe(($event) =&gt; layerGroup.clearLayers());<br/>};</span><span id="ce79" class="il im in kz b gy md ma l mb mc">const bindMarkerPopup = (marco: Marker, text: string, layerGroup: LayerGroup) =&gt; {<br/>  const id = `location-marker-${Date.now()}`;<br/>  marco.bindPopup(`<br/>        &lt;p&gt;${text}&lt;/p&gt;<br/>        &lt;div class="location-marker-popup__buttons"&gt;<br/>            &lt;a class="location-marker-popup__button" id="${id}"&gt;delete&lt;/a&gt;<br/>        &lt;/div&gt;<br/>      `,          {<br/>    maxWidth: 200,<br/>    maxHeight: 120,<br/>    className: 'location-marker-popup',<br/>  });<br/>  let deleteMarkerSubscription;<br/>  marco.on('popupopen', () =&gt; deleteMarkerSubscription = subscribeToDeleteLocationMarker(id, marco, layerGroup));<br/>  marco.on('popupclose', () =&gt; deleteMarkerSubscription.unsubscribe());<br/>  marco.openPopup();<br/>};</span><span id="5dee" class="il im in kz b gy md ma l mb mc">export const placeLocationMarker = (layerGroup: LayerGroup, latLng: LatLng, text: string) =&gt; {<br/>  layerGroup.clearLayers();<br/>  const marco = marker(latLng, {icon: markerIcon()});<br/>  layerGroup.addLayer(marco);<br/>  bindMarkerPopup(marco, text, layerGroup);<br/>};</span></pre><h1 id="36b2" class="lb im in bd io lc ld le ir lf lg lh iu li lj lk iy ll lm ln jc lo lp lq jg lr bi translated">6.åšä¸€ä¸ªPWA</h1><p id="57fe" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">è¿™ä¸€æ­¥å¾ˆç®€å•ï¼Œå› ä¸ºAngular CLIä¼šä¸ºæ‚¨å®Œæˆæ‰€æœ‰ç¹é‡çš„å·¥ä½œã€‚åªéœ€è¿è¡Œ<code class="fe kw kx ky kz b">npx ng add @angular/pwa</code>ã€‚è¯¥å‘½ä»¤ä¼šå°†æ‰€æœ‰å¿…éœ€çš„åŒ…æ·»åŠ åˆ°æ‚¨çš„é¡¹ç›®ä¸­ï¼Œé…ç½®æ‚¨çš„æœåŠ¡äººå‘˜ï¼Œå¹¶æ·»åŠ ç”¨äºç¼“å­˜çš„é»˜è®¤èµ„äº§ã€‚æ‚¨å¯èƒ½éœ€è¦ä¸ä¹‹äº¤äº’çš„å”¯ä¸€æ–‡ä»¶æ˜¯<code class="fe kw kx ky kz b">ngsw-config.json</code>ã€‚</p><p id="ab40" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è¿™ä¸ªæ–‡ä»¶å‘Šè¯‰Angular service workerï¼Œè¦ç¼“å­˜ä»€ä¹ˆèµ„äº§ä»¥åŠä½¿ç”¨ä»€ä¹ˆç¼“å­˜ç­–ç•¥ã€‚</p><p id="2c3b" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">ä¾‹å¦‚ï¼Œå½“æ‰€æœ‰å›¾åƒèµ„äº§éƒ½è¢«å»¶è¿Ÿç¼“å­˜æ—¶ï¼Œæ‰€æœ‰JSæ–‡ä»¶éƒ½è¢«æ€¥åˆ‡åœ°ç¼“å­˜ã€‚æ‚¨å¯ä»¥åœ¨<a class="ae la" href="https://angular.io/guide/service-worker-config#assetgroups" rel="noopener ugc nofollow" target="_blank">ç»´ä¿®å·¥äººé…ç½®</a>çš„Angularæ–‡æ¡£ä¸­äº†è§£æ›´å¤šå…³äºç®¡ç†è¯¥æ–‡ä»¶çš„ä¿¡æ¯ã€‚</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="b074" class="il im in kz b gy lz ma l mb mc">{<br/>  "$schema": "./node_modules/@angular/service-worker/config/schema.json",<br/>  "index": "/index.html",<br/>  "assetGroups": [<br/>    {<br/>      "name": "app",<br/>      "installMode": "prefetch",<br/>      "resources": {<br/>        "files": [<br/>          "/favicon.ico",<br/>          "/index.html",<br/>          "/manifest.webmanifest",<br/>          "/*.css",<br/>          "/*.js"<br/>        ]<br/>      }<br/>    },<br/>    {<br/>      "name": "assets",<br/>      "installMode": "lazy",<br/>      "updateMode": "prefetch",<br/>      "resources": {<br/>        "files": [<br/>          "/assets/**",<br/>          "/*.(eot|svg|cur|jpg|png|webp|gif|otf|ttf|woff|woff2|ani)"<br/>        ]<br/>      }<br/>    }<br/>  ]<br/>}</span></pre><p id="4936" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">å’Œå¾€å¸¸ä¸€æ ·ï¼Œç¡®ä¿åœ¨æœ¬åœ°æµ‹è¯•æ‚¨çš„PWAã€‚ä¸ºæ­¤ï¼Œè¿è¡Œæ„å»ºå‘½ä»¤<code class="fe kw kx ky kz b">ionic build</code>ã€‚</p><p id="f8f6" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è¿™å°†ç”Ÿæˆ<code class="fe kw kx ky kz b">www</code>æ–‡ä»¶å¤¹ã€‚æ­¤æ–‡ä»¶å¤¹ä¸­çš„åº”ç”¨ç¨‹åºæ˜¯PWAã€‚ä½ å¯ä»¥ä½¿ç”¨åƒ<code class="fe kw kx ky kz b">serve</code>è¿™æ ·çš„æœ¬åœ°æœåŠ¡å™¨æ¥è¿è¡Œå®ƒã€‚</p><p id="5bd6" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æœåŠ¡äººå‘˜è¦æ±‚åº”ç”¨ç¨‹åºæ‰˜ç®¡åœ¨å®‰å…¨çš„ç¯å¢ƒä¸­ã€‚ä¸ºäº†æœåŠ¡äºæ„å»ºï¼Œæˆ‘ä»¬ä½¿ç”¨æœ¬åœ°èŠ‚ç‚¹æœåŠ¡å™¨ã€‚é€šè¿‡è¿è¡Œ<code class="fe kw kx ky kz b">npm i serve -g</code>å®‰è£…<code class="fe kw kx ky kz b">npmjs.com/package/serve</code>ã€‚</p><p id="258a" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œ<code class="fe kw kx ky kz b">serve www</code>å‘½ä»¤ã€‚è¿™åœ¨<a class="ae la" href="http://localhost:5000/" rel="noopener ugc nofollow" target="_blank"> localhost:5000 </a>ä¸Šè¿è¡Œåº”ç”¨ç¨‹åºï¼Œå¹¸è¿çš„æ˜¯ï¼Œä½¿ç”¨localhostè¢«è®¤ä¸ºæ˜¯å®‰å…¨çš„ï¼Œä½ ç°åœ¨ä¸éœ€è¦HTTPS originæ¥æµ‹è¯•æˆ‘ä»¬çš„PWAã€‚</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi mt"><img src="../Images/eb4ff5eeeb5ba3a93ace905130494733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s7HS7A_ByLgY9WjP"/></div></div></figure><p id="7fa3" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">åœ¨chromeä¸­æ‰“å¼€ä¸€ä¸ªéšèº«çª—å£ï¼Œæ‰“å¼€<code class="fe kw kx ky kz b">http://localhost:5000</code>ã€‚ä½ ä¼šæ³¨æ„åˆ°å¦ä¸€ä¸ªé—®é¢˜ã€‚å½“æ‚¨åˆ·æ–°é¡µé¢æ—¶ï¼Œåº”ç”¨ç¨‹åºå°†ä¸ä¼šåŠ è½½ã€‚è¿™æ˜¯å› ä¸º<code class="fe kw kx ky kz b">serve</code>è¯•å›¾æ‰¾åˆ°<code class="fe kw kx ky kz b">localhost:5000/home</code>å¹¶æœŸæœ›ä¸€ä¸ªåŒ…å«index.htmlæ–‡ä»¶çš„ä¸»æ–‡ä»¶å¤¹ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶å¹¶ä¸å­˜åœ¨ã€‚æœ‰å¤šç§æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘å°†ä½¿ç”¨æ•£åˆ—è·¯ç”±ã€‚</p><p id="62be" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">ä½ éœ€è¦åšçš„æ‰€æœ‰æ”¹å˜å°±æ˜¯è½¬åˆ°ä½ çš„<code class="fe kw kx ky kz b">app-routing.module.ts</code>æ–‡ä»¶ï¼Œå¹¶å°†<code class="fe kw kx ky kz b">useHash: true</code>æ·»åŠ åˆ°ä½ çš„è·¯ç”±å™¨é€‰é¡¹ä¸­ã€‚ç°åœ¨ï¼Œé¡µé¢URLå°†çœ‹èµ·æ¥åƒlocalhost:5000/#/homeï¼Œæ‚¨å¯ä»¥æ¯«æ— é—®é¢˜åœ°åˆ·æ–°ã€‚</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="d087" class="il im in kz b gy lz ma l mb mc">import { NgModule } from '@angular/core';<br/>import { PreloadAllModules, RouterModule, Routes } from '@angular/router';</span><span id="f186" class="il im in kz b gy md ma l mb mc">const routes: Routes = [<br/>  {<br/>    path: 'home',<br/>    loadChildren: () =&gt; import('./home/home.module').then( m =&gt; m.HomePageModule)<br/>  },<br/>  {<br/>    path: '',<br/>    redirectTo: 'home',<br/>    pathMatch: 'full'<br/>  },<br/>];</span><span id="32f2" class="il im in kz b gy md ma l mb mc">@NgModule({<br/>  imports: [<br/>    RouterModule.forRoot(routes, { preloadingStrategy: PreloadAllModules, useHash: true })<br/>  ],<br/>  exports: [RouterModule]<br/>})<br/>export class AppRoutingModule { }</span></pre><p id="a738" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">ä¿®å¤è·¯ç”±é—®é¢˜åï¼Œæ‰“å¼€â€œlocalhost:5000â€ã€‚ç„¶åæ‰“å¼€Chrome Devtoolsï¼Œæ‰“å¼€Lighthouseé€‰é¡¹å¡ï¼Œä¸ºProgressive web appç”ŸæˆæŠ¥å‘Šã€‚è¿™æ˜¯æˆ‘çš„æµ‹è¯•ç»“æœï¼Œæ˜¾ç¤ºPWAåº”ç”¨ç¨‹åºæœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦è§£å†³ã€‚</p><ul class=""><li id="e78a" class="mf mg in jk b jl kp jp kq iv mh iz mi jd mj kc mk ml mm mn bi translated">æ²¡æœ‰è‹¹æœè§¦æ‘¸å›¾æ ‡ã€‚</li></ul><p id="a5c6" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°index.htmlçš„headæ ‡è®°ä¸­ï¼Œä»¥è§£å†³ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªé—®é¢˜ã€‚</p><pre class="ke kf kg kh gt lv kz lw lx aw ly bi"><span id="e603" class="il im in kz b gy lz ma l mb mc">&lt;link rel="apple-touch-icon" href="%PUBLIC_URL%/assets/icon/icon-192x192.png"&gt;</span></pre><p id="39af" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æˆ‘ä»¬éƒ½å‡†å¤‡å¥½äº†ã€‚è®©æˆ‘ä»¬å†æ¬¡æ„å»ºå’Œæµ‹è¯•PWAåº”ç”¨ç¨‹åºã€‚è¿è¡Œ<code class="fe kw kx ky kz b">ionic build</code>ï¼Œç„¶åè¿è¡Œ<code class="fe kw kx ky kz b">serve www</code>ã€‚æ‰“å¼€Chromeéšå§“åŸ‹åçª—å£ï¼Œç”¨Lighthouseæµ‹è¯•ã€‚</p><p id="6b72" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æ‚¨åº”è¯¥çœ‹åˆ°è¿™æ ·çš„ç»“æœï¼Œè¡¨æ˜æ‚¨çš„PWAå·²ç»å‡†å¤‡å¥½å¹¶å¯ä»¥å®‰è£…äº†ã€‚</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi lu"><img src="../Images/3c0ac9762a592a63801fd467987555d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*me7Ijqd2Yi-hEHTf"/></div></div></figure><p id="4956" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">å¦‚æœä½ æƒ³æµ‹è¯•å®‰è£…ï¼Œä½ å¯ä»¥åœ¨ä¸€ä¸ªæ­£å¸¸çš„çª—å£æ‰“å¼€ä½ çš„åº”ç”¨ç¨‹åº(ä¸æ˜¯åŒ¿åçš„)ï¼Œä½ åº”è¯¥å¯ä»¥åœ¨Chromeåœ°å€æ çœ‹åˆ°å®‰è£…æŒ‰é’®ã€‚</p><h1 id="2529" class="lb im in bd io lc ld le ir lf lg lh iu li lj lk iy ll lm ln jc lo lp lq jg lr bi translated">7.ä½¿ç”¨Vercelåœ¨ä¸åˆ°5åˆ†é’Ÿå†…éƒ¨ç½²æ‚¨çš„æ–°åº”ç”¨</h1><p id="e791" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">ä¸ºäº†åœ¨æ‰‹æœºä¸Šæµ‹è¯•æˆ‘ä»¬çš„PWAï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°éƒ¨ç½²åº”ç”¨ç¨‹åºï¼Œé€šè¿‡HTTPSä¸Šçš„URLè½»æ¾è®¿é—®å®ƒã€‚æˆ‘ä¼šç”¨Vercelåšè¿™ä¸ªã€‚Vercelæ˜¯ä¸€ä¸ªé›¶é…ç½®çš„äº‘CI/CDï¼Œå®ƒå¯ä»¥ç†è§£æˆ‘ä»¬çš„Ionicé¡¹ç›®çš„ç»“æ„ï¼Œå¹¶å¼€ç®±å³ç”¨åœ°è¿›è¡Œéƒ¨ç½²ã€‚</p><p id="a686" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">ä¸ºæ­¤ï¼Œè¯·å‰å¾€<a class="ae la" href="http://vercel.com/" rel="noopener ugc nofollow" target="_blank">vercel.com</a>æ³¨å†Œä¸€ä¸ªå…è´¹è´¦æˆ·ã€‚</p><p id="a391" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">ç™»å½•ï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä»æ‚¨çš„Git repoå¯¼å…¥ä¸€ä¸ªé¡¹ç›®ã€‚å¦‚å‰æ‰€è¿°ï¼Œæˆ‘æ­£åœ¨ä½¿ç”¨Githubã€‚æ‰€ä»¥æˆ‘å°†ä»æˆ‘çš„Githubå¯¼å…¥é¡¹ç›®ã€‚</p><p id="b4ef" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">Vercelå·²ç»çŸ¥é“æ‚¨çš„é¡¹ç›®æ˜¯Ionic Angularï¼Œå¹¶ä¸”çŸ¥é“è¿è¡Œä»€ä¹ˆå‘½ä»¤æ¥æ„å»ºå®ƒã€‚åªéœ€ç‚¹å‡»éƒ¨ç½²å³å¯ã€‚è¿™å°†è¿è¡Œæ„å»ºå¹¶ä¸ºæ‚¨æä¾›ä¸€ä¸ªURLï¼Œæ‚¨çš„é¡¹ç›®å°†åœ¨è¯¥URLä¸Šå¯ç”¨ã€‚</p><p id="129f" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">åªéœ€ç‚¹å‡»â€œè®¿é—®â€æŒ‰é’®å³å¯è®¿é—®æ‚¨éƒ¨ç½²çš„åº”ç”¨ç¨‹åºã€‚</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi mu"><img src="../Images/798f134731cfdfd52940ea53a735ac5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g5a8D0g7El5gm51t"/></div></div></figure><h1 id="1baa" class="lb im in bd io lc ld le ir lf lg lh iu li lj lk iy ll lm ln jc lo lp lq jg lr bi translated">ç»“è®º</h1><p id="3881" class="pw-post-body-paragraph ji jj in jk b jl jm jn jo jp jq jr js iv jt ju jv iz jw jx jy jd jz ka kb kc ig bi translated">å¦‚æœæ‚¨å·²ç»å®Œæˆäº†æœ¬æ•™ç¨‹ï¼Œé‚£ä¹ˆæ­å–œæ‚¨ã€‚ğŸ‘</p><p id="0210" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æ„Ÿè°¢é˜…è¯»ã€‚æˆ‘å°†åœ¨è¿™é‡Œç»“æŸç¬¬ä¸€éƒ¨åˆ†ï¼Œå¸Œæœ›æ‚¨åœ¨ç¬¬äºŒéƒ¨åˆ†ç»§ç»­å…³æ³¨æ›´å¤šä»¤äººå…´å¥‹çš„ç‰¹æ€§ã€‚</p><p id="a065" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">åƒå¾€å¸¸ä¸€æ ·ï¼Œå¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·åœ¨è¿™é‡Œç»™æˆ‘ç•™è¨€æˆ–åœ¨Twitterä¸Šç»™æˆ‘å‘DMã€‚</p><p id="f8af" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">ä¸‹é¢æ˜¯æ¼”ç¤º:<a class="ae la" href="https://ionic-angular-leaflet-offline-map-pwa-one.vercel.app/#/home" rel="noopener ugc nofollow" target="_blank">ä½¿ç”¨Vercel </a>éƒ¨ç½²çš„æ¼”ç¤º</p><p id="5e28" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">è¿™é‡Œæ˜¯ä»£ç åº“:<a class="ae la" href="https://github.com/pazel-io/ionic-angular-leaflet-offline-map-pwa.git" rel="noopener ugc nofollow" target="_blank">ç¦»å­-è§’åº¦-ä¼ å•-ç¦»çº¿-åœ°å›¾-pwa </a></p><p id="99ec" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated">æ¨ç‰¹:<a class="ae la" href="https://twitter.com/_pazel" rel="noopener ugc nofollow" target="_blank">_å¸•æ³½å°”</a></p><p id="391e" class="pw-post-body-paragraph ji jj in jk b jl kp jn jo jp kq jr js iv kr ju jv iz ks jx jy jd kt ka kb kc ig bi translated"><em class="mv">æ›´å¤šå†…å®¹è¯·çœ‹</em><a class="ae la" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="jk mw"><em class="mv">plain English . io</em></strong></a></p></div></div>    
</body>
</html>