<html>
<head>
<title>React, Redux, TypeScript Starter Kit using Redux Toolkit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Redux工具包的React、Redux、TypeScript初学者工具包</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-redux-typescript-starter-kit-using-redux-toolkit-f12ea1c9466e?source=collection_archive---------5-----------------------#2021-03-25">https://javascript.plainenglish.io/react-redux-typescript-starter-kit-using-redux-toolkit-f12ea1c9466e?source=collection_archive---------5-----------------------#2021-03-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="32d0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你正在开始一个新项目？你想同时使用所有最新的技术达到生产水平的标准。到本文结束时，您将拥有一个生产就绪的react应用程序，它使用redux、redux-thunk和TypeScript。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8ea1c1336429e73ed105a6baac995965.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*meCFnZ5MK_7Fu1ogYfBvNQ.png"/></div></div></figure><p id="070b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最初，这篇文章是基于我在过去三年构建react应用时学到并构建的一组模式而写的。该模式本质上是一个动作文件，是该文件的缩减器，然后是一个根缩减器来包装所有这些文件。在团队中，我们会花时间决定/辩论/争论我们的react/redux应用程序使用的最佳模式，并最终采用一种“科学怪人”方法，这种方法有效，但固执己见，尽管团队与团队之间一直不同步。</p><p id="c18f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后<a class="ae ku" href="https://twitter.com/acemarke" rel="noopener ugc nofollow" target="_blank"> @acemarke </a>一个redux维护人员联系我，跟我分享了他们的Redux工具包。</p><p id="1869" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Redux Toolkit是一套帮助在web应用程序中集成和使用Redux的最佳实践、模式和功能。是的，它固执己见，起初感觉很奇怪，但它是由redux的创造者维护的，所以我认为我们可以相信工具包的发展方向。这也让你远离了很多元决策，让你可以更专注于重要的事情:用户和性能的UX。</p><p id="ec13" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以我们开始吧！有一个<code class="fe kv kw kx ky b">create-react-app</code>类型脚本模板，所以将使用它开始。</p><pre class="kj kk kl km gt kz ky la lb aw lc bi"><span id="36fc" class="ld le in ky b gy lf lg l lh li">npx create-react-app my-app — template redux-typescript</span></pre><p id="5235" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个<code class="fe kv kw kx ky b">create-react-app</code>模板将为您设置一个简单的计数器应用程序。它将包含一个名为<code class="fe kv kw kx ky b">counter</code>的减速器切片。</p><p id="6d4b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这篇文章中，我将扩展模板，这样我们可以更好地了解正在发生的事情。我还将介绍Redux thunk，并从服务器请求一些数据。</p><p id="36b7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们使用<code class="fe kv kw kx ky b">create-react-app</code>成功创建了我们的项目之后，我们将拥有一个闪亮的新项目。</p><p id="f0fb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您想查看源代码，您可以在此处查看:</p><div class="lj lk gp gr ll lm"><a href="https://github.com/davidjamescarter/react-redux-thunk-typescript-redux-toolkit-starter-kit" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab fo"><div class="lo ab lp cl cj lq"><h2 class="bd io gy z fp lr fr fs ls fu fw im bi translated">David jamescarter/react-redux-thunk-typescript-redux-toolkit-starter-kit</h2><div class="lt l"><h3 class="bd b gy z fp lr fr fs ls fu fw dk translated">这个项目是用Create React App引导的，使用了Redux和Redux Toolkit模板。在项目中…</h3></div><div class="lu l"><p class="bd b dl z fp lr fr fs ls fu fw dk translated">github.com</p></div></div><div class="lv l"><div class="lw l lx ly lz lv ma ks lm"/></div></div></a></div><h1 id="4f66" class="mb le in bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">商店</h1><p id="3a8a" class="pw-post-body-paragraph jk jl in jm b jn my jp jq jr mz jt ju jv na jx jy jz nb kb kc kd nc kf kg kh ig bi translated">下面是我们的<code class="fe kv kw kx ky b">store.ts</code>,我们从<code class="fe kv kw kx ky b">@reduxjs/toolkit</code>导入三个对象，让它们通过。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="3e44" class="ld le in bd mc nf ng dn mg nh ni dp mk jv nj nk mo jz nl nm ms kd nn no mw np bi translated"><code class="fe kv kw kx ky b">configureStore</code></h2><p id="ffd5" class="pw-post-body-paragraph jk jl in jm b jn my jp jq jr mz jt ju jv na jx jy jz nb kb kc kd nc kf kg kh ig bi translated"><code class="fe kv kw kx ky b">configureStore({reducer, middleware, devTools, preloadedState, enhancers})</code></p><p id="6995" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以<code class="fe kv kw kx ky b">configureStore</code>函数接受单个配置对象参数，有以下选项:<code class="fe kv kw kx ky b">reducer, middleware, devTools, preloadedState, enhancers</code> <a class="ae ku" href="https://redux-toolkit.js.org/api/configureStore" rel="noopener ugc nofollow" target="_blank">此处阅读更多。</a></p><blockquote class="nq nr ns"><p id="cdd3" class="jk jl nt jm b jn jo jp jq jr js jt ju nu jw jx jy nv ka kb kc nw ke kf kg kh ig bi translated">对标准Redux <code class="fe kv kw kx ky b">createStore</code>函数的友好抽象，为商店设置添加了良好的默认值，以获得更好的开发体验。</p></blockquote><h2 id="a49d" class="ld le in bd mc nf ng dn mg nh ni dp mk jv nj nk mo jz nl nm ms kd nn no mw np bi translated"><code class="fe kv kw kx ky b">Action</code></h2><p id="2a9b" class="pw-post-body-paragraph jk jl in jm b jn my jp jq jr mz jt ju jv na jx jy jz nb kb kc kd nc kf kg kh ig bi translated"><code class="fe kv kw kx ky b">Action</code>是一个内置在Redux库中的动作类型。</p><h2 id="39c8" class="ld le in bd mc nf ng dn mg nh ni dp mk jv nj nk mo jz nl nm ms kd nn no mw np bi translated">思维活动</h2><p id="61e4" class="pw-post-body-paragraph jk jl in jm b jn my jp jq jr mz jt ju jv na jx jy jz nb kb kc kd nc kf kg kh ig bi translated"><code class="fe kv kw kx ky b">ThunkAction</code>是一个动作类型，内置于Redux Thunk库中。Redux thunk是一个通用的中间件，Redux推荐使用它来编写与存储交互的同步和异步逻辑。<a class="ae ku" href="https://github.com/reduxjs/redux-thunk" rel="noopener ugc nofollow" target="_blank">点击此处阅读更多内容。</a></p><blockquote class="nq nr ns"><p id="b997" class="jk jl nt jm b jn jo jp jq jr js jt ju nu jw jx jy nv ka kb kc nw ke kf kg kh ig bi translated">thunk是一个包装表达式的函数，用于延迟该表达式的求值。在Redux中，thunk接受参数<code class="fe kv kw kx ky b">dispatch</code>和<code class="fe kv kw kx ky b">getState</code>。</p></blockquote><p id="eacc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如redux所推荐的，一个可重用的<code class="fe kv kw kx ky b">AppThunk</code>类型在<code class="fe kv kw kx ky b">store.ts</code>中定义一次，每当你写一个thunk时就被重用。我们将在下一节看到更多这方面的内容。</p><h1 id="382a" class="mb le in bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">部分</h1><p id="81fb" class="pw-post-body-paragraph jk jl in jm b jn my jp jq jr mz jt ju jv na jx jy jz nb kb kc kd nc kf kg kh ig bi translated">现在，我们已经建立了一个正常运行的商店，我们可以更仔细地看看这些商店的每一部分。这是Redux Toolkit引入的新概念。<code class="fe kv kw kx ky b">slice</code>是一个工厂功能，当给定一个<code class="fe kv kw kx ky b">name</code>、<code class="fe kv kw kx ky b">initialState</code>和一组减速器功能时，它产生一个减速器并自动产生动作。</p><blockquote class="nq nr ns"><p id="ff29" class="jk jl nt jm b jn jo jp jq jr js jt ju nu jw jx jy nv ka kb kc nw ke kf kg kh ig bi translated">一个函数，它接受一个初始状态、一个充满reducer函数的对象和一个“片名”，并自动生成与reducer和状态对应的动作创建者和动作类型。</p></blockquote><p id="c9e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">切片的好处在于，它允许我们编写更少的代码，并将相关的代码放在一起。我们不再需要6–7个文件来创建存储片。这是我们的<code class="fe kv kw kx ky b">weatherSlice.ts</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="a651" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里我们有一个完整的存储片，它在一个可读、可管理的文件中创建了一个缩减器、操作和选择器。</p><p id="32c0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个例子中，我们将特别关注thunk操作。然而，我已经包含了一个简单的非异步动作<code class="fe kv kw kx ky b">increment</code>来演示如何做，这将会减少工具包，见第28行。</p><h1 id="ebe1" class="mb le in bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">使用Redux thunk的API请求</h1><p id="8e3a" class="pw-post-body-paragraph jk jl in jm b jn my jp jq jr mz jt ju jv na jx jy jz nb kb kc kd nc kf kg kh ig bi translated">我们想要做的是通过thunk动作从api请求一些数据，就像在现实世界中一样。管理JS应用中的异步行为有很多解决方案，但是redux团队推荐thunks用于简单的异步行为。</p><blockquote class="nq nr ns"><p id="a87a" class="jk jl nt jm b jn jo jp jq jr js jt ju nu jw jx jy nv ka kb kc nw ke kf kg kh ig bi translated">我们推荐<a class="ae ku" href="https://github.com/reduxjs/redux-thunk" rel="noopener ugc nofollow" target="_blank">使用Redux Thunk中间件作为标准方法</a>，因为它足以满足大多数典型用例(比如基本的AJAX数据获取)。此外，在thunks中使用<code class="fe kv kw kx ky b">async/await</code>语法使得它们更容易阅读。</p></blockquote><h2 id="6d8f" class="ld le in bd mc nf ng dn mg nh ni dp mk jv nj nk mo jz nl nm ms kd nn no mw np bi translated"><code class="fe kv kw kx ky b">createAsyncThunk</code></h2><p id="e778" class="pw-post-body-paragraph jk jl in jm b jn my jp jq jr mz jt ju jv na jx jy jz nb kb kc kd nc kf kg kh ig bi translated">所以让我们使用Redux Toolkit <code class="fe kv kw kx ky b">createAsyncThunk</code>函数创建一个thunk动作。您可以在第5行看到这个函数被导入到了<code class="fe kv kw kx ky b">weatherSlice.ts</code>文件中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="6009" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用<code class="fe kv kw kx ky b">createAsyncThunk</code>的好处之一是它返回一个Redux thunk动作创建器。该函数将为附加的<code class="fe kv kw kx ky b">pending</code>、<code class="fe kv kw kx ky b">fulfilled</code>和<code class="fe kv kw kx ky b">rejected</code>案例提供普通操作创建器。这些可以用作管理组件加载状态的方法，例如渲染加载微调器和错误处理。</p><p id="6f8c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">通过使用<code class="fe kv kw kx ky b">extraReducer</code>——这是<code class="fe kv kw kx ky b">createSlice</code>工厂功能的最后一个特征。它允许我们编写逻辑，而本质上不产生动作。这对于基于“外部”动作编写逻辑非常有用。</p><p id="5fc6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">需要记住的一点是，如果动作类型字符串在<code class="fe kv kw kx ky b">reducers</code>和<code class="fe kv kw kx ky b">extraReducers</code>中都被引用，那么来自<code class="fe kv kw kx ky b">reducers</code>的函数将被用来处理动作类型。</p><h1 id="5038" class="mb le in bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">在组件中调度Thunk操作</h1><p id="6f38" class="pw-post-body-paragraph jk jl in jm b jn my jp jq jr mz jt ju jv na jx jy jz nb kb kc kd nc kf kg kh ig bi translated">现在我们已经设置了我们的<code class="fe kv kw kx ky b">weatherSlice</code>,让我们在<code class="fe kv kw kx ky b">Weather.ts</code>切片组件文件中调用我们的新thunk动作<code class="fe kv kw kx ky b">fetchWeatherForecast()</code>。</p><p id="901a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是相当标准的东西，我们使用<code class="fe kv kw kx ky b">react-redux</code> <code class="fe kv kw kx ky b">useDispatch()</code>函数来调度我们的<code class="fe kv kw kx ky b">fetchWeatherForecast()</code>动作。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="3e1b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然而正如你所看到的，我们没有使用非类型化版本的<code class="fe kv kw kx ky b">useDispatch()</code>和<code class="fe kv kw kx ky b">useSelector()</code>钩子。可以将<code class="fe kv kw kx ky b">RootState</code>和<code class="fe kv kw kx ky b">AppDispatch</code>类型导入到每个组件中。然而，正如Redux团队所建议的，最好创建预键入版本。<a class="ae ku" href="https://react-redux.js.org/using-react-redux/usage-with-typescript" rel="noopener ugc nofollow" target="_blank">点击此处阅读更多内容。</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="cb94" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是一个简单的React TypeScript应用程序，它利用了Redux工具包。它使用Redux thunks和async/await发出一个简单的异步请求。然后用键入的选择器选择该数据。没什么特别的，但它确实做到了这是一种干净、规定的方式，几乎没有样板文件，比过去的redux设置更具凝聚力。</p></div><div class="ab cl nx ny hr nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ig ih ii ij ik"><p id="b2e4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是连续系列的一部分。接下来，我将扩展Thunk操作以使用<code class="fe kv kw kx ky b">Promise.all()</code>,并更详细地介绍TypeScript和React的其他方面。</p><p id="51ba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你有任何问题，或者你想被记录的事情，请留下评论。</p><p id="8003" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="nt">更多内容请看</em><a class="ae ku" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="nt">plain English . io</em></strong></a></p></div></div>    
</body>
</html>