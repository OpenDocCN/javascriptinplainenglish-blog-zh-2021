<html>
<head>
<title>Global State Management in an Electron Application using Pinia and Vue.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Pinia和Vue.js的电子应用中的全局状态管理</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/global-state-management-in-an-electron-application-abdac1a1ce52?source=collection_archive---------20-----------------------#2021-12-16">https://javascript.plainenglish.io/global-state-management-in-an-electron-application-abdac1a1ce52?source=collection_archive---------20-----------------------#2021-12-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/e72b4b822ad869f929add3e8568a45c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QV7hosq_7A0qIPmH.png"/></div></div></figure><div class=""/><blockquote class="jv jw jx"><p id="364e" class="jy jz ka kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">将Vue.js工具<a class="ae kx" href="https://pinia.esm.dev/" rel="noopener ugc nofollow" target="_blank"> Pinia </a>引入我们的电子应用程序来管理其内部状态。这篇文章假设你已经关注了我之前的<a class="ae kx" href="https://codybontecou.com/electron-app-with-vuejs-and-vite.html" rel="noopener ugc nofollow" target="_blank">文章</a>。</p></blockquote><h2 id="1a32" class="ky kz iy bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">什么是商店？</h2><p id="19b1" class="pw-post-body-paragraph jy jz iy kb b kc lu ke kf kg lv ki kj lh lw km kn ll lx kq kr lp ly ku kv kw ig bi translated">存储是管理应用程序全局状态的实体。无论您在哪个组件中工作，它都允许您读取和写入。</p><p id="318d" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">你可能听说过其他帮助管理商店的包，Vuex是Vue的标准，Redux是React的标准。</p><h2 id="096d" class="ky kz iy bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">装置</h2><blockquote class="jv jw jx"><p id="861e" class="jy jz ka kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这假设您使用的是Vue 3。<br/>如果您使用的是Vue 2，请参考他们的<a class="ae kx" href="https://pinia.esm.dev/getting-started.html#installation" rel="noopener ugc nofollow" target="_blank">文档</a>。</p></blockquote><p id="0013" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">因为我们将它连接到一个电子应用程序，这只是一个额外步骤的JavaScript，我们可以利用我们最喜欢的包管理器如<code class="fe lz ma mb mc b">npm</code>或<code class="fe lz ma mb mc b">yarn</code>来安装Pinia。</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="eb98" class="ky kz iy mc b gy ml mm l mn mo">yarn add pinia<br/># or with npm<br/>npm install pinia</span></pre><p id="4e61" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">使用<code class="fe lz ma mb mc b">createPinia</code>功能将其附加到Vue.js应用程序:</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="386f" class="ky kz iy mc b gy ml mm l mn mo">// renderer/main.js<br/><br/>import { createApp } from 'vue'<br/>import App from './App.vue'<br/>import { createPinia } from 'pinia'<br/><br/>createApp(App).use(createPinia()).mount('#app')</span></pre><p id="28f6" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">在Vue可用的电子应用中，Pinia现已可用。</p><h2 id="be0c" class="ky kz iy bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">创建我们的第一家商店</h2><p id="caeb" class="pw-post-body-paragraph jy jz iy kb b kc lu ke kf kg lv ki kj lh lw km kn ll lx kq kr lp ly ku kv kw ig bi translated">使用<code class="fe lz ma mb mc b">defineStore()</code>定义商店，并要求<em class="ka">唯一的</em>名称。在这种情况下，我使用<code class="fe lz ma mb mc b">main</code>作为这个商店的惟一id。</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="f764" class="ky kz iy mc b gy ml mm l mn mo">// renderer/stores/main.js<br/><br/>import { defineStore } from 'pinia'<br/><br/>// useMainStore could be anything like useUser, useCart<br/>// the first argument is a unique id of the store across your application<br/>export const useMainStore = defineStore('main', {<br/>  state: () =&gt; ({<br/>    msg: 'Hello World!',<br/>  }),<br/>  getters: {<br/>    message: state =&gt; state.msg,<br/>  },<br/>  actions: {},<br/>})</span></pre><h2 id="66d8" class="ky kz iy bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">在Vue.js组件中使用我们的存储</h2><p id="46ec" class="pw-post-body-paragraph jy jz iy kb b kc lu ke kf kg lv ki kj lh lw km kn ll lx kq kr lp ly ku kv kw ig bi translated">既然我们的商店已经创建好了，我们可以将它导入到单独的组件中，允许我们的组件与商店进行交互。</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="b289" class="ky kz iy mc b gy ml mm l mn mo">import { useMainStore } from '@/stores/main'</span></pre><p id="1976" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">在<code class="fe lz ma mb mc b">setup</code>函数中，我调用我们的存储函数并在一个常量变量中设置值:</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="0f85" class="ky kz iy mc b gy ml mm l mn mo">setup() {<br/>  const main = useMainStore()<br/>}</span></pre><p id="a98c" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">这让我能够与我的商店互动。对于这个简单的例子，我显示了在<a class="ae kx" href="https://pinia.esm.dev/core-concepts/getters.html" rel="noopener ugc nofollow" target="_blank"> getter </a>中定义的消息。</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="731c" class="ky kz iy mc b gy ml mm l mn mo">setup() {<br/>  const main = useMainStore()<br/><br/>  return {<br/>    message: computed(() =&gt; main.message),<br/>}</span></pre><p id="febf" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">整个组件如下所示:</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="eb9f" class="ky kz iy mc b gy ml mm l mn mo">// renderer/components/Hello.vue<br/><br/>&lt;template&gt;<br/>  &lt;div id="hello"&gt;<br/>    &lt;img src="https://vuejs.org/images/logo.png" /&gt;<br/>    &lt;h1&gt;{{ message }}&lt;/h1&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>import { computed, defineComponent } from 'vue'<br/>import { useMainStore } from '@/stores/main'<br/><br/>export default defineComponent({<br/>  setup() {<br/>    const main = useMainStore()<br/><br/>    return {<br/>      message: computed(() =&gt; main.message),<br/>    }<br/>  },<br/>})<br/>&lt;/script&gt;</span></pre><h2 id="a368" class="ky kz iy bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">让HMR工作</h2><blockquote class="jv jw jx"><p id="80b9" class="jy jz ka kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">虽然HMR内置于皮尼亚，它不能很好地与电子和需要一点额外的配置。Pinia在此提供了本主题<a class="ae kx" href="https://pinia.esm.dev/cookbook/hot-module-replacement.html" rel="noopener ugc nofollow" target="_blank">的附加文档。</a></p></blockquote><p id="91e5" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">HMR(热模块替换)允许您编辑您的商店并查看应用程序中的更改，而无需重新加载页面或重启服务器。</p><p id="7100" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">下面是我的<code class="fe lz ma mb mc b">main</code>商店更新后的样子，考虑到HMR:</p><pre class="md me mf mg gt mh mc mi mj aw mk bi"><span id="dcbf" class="ky kz iy mc b gy ml mm l mn mo">import { defineStore, acceptHMRUpdate } from 'pinia'<br/><br/>export const useMainStore = defineStore('main', {<br/>  state: () =&gt; ({<br/>    msg: 'Hello World!',<br/>  }),<br/>  getters: {<br/>    message: state =&gt; state.msg,<br/>  },<br/>  actions: {},<br/>})<br/><br/>if (import.meta.hot) {<br/>  import.meta.hot.accept(acceptHMRUpdate(useMainStore, import.meta.hot))<br/>}</span></pre><p id="54a8" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">经过<code class="fe lz ma mb mc b">acceptHMRUpdate</code>你的商店(在我的例子中是<code class="fe lz ma mb mc b">useMainStore</code>，它给了我们HMR！</p><p id="6648" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated">希望你喜欢它！</p><p id="9674" class="pw-post-body-paragraph jy jz iy kb b kc kd ke kf kg kh ki kj lh kl km kn ll kp kq kr lp kt ku kv kw ig bi translated"><em class="ka">更多内容看</em> <a class="ae kx" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb iz"> <em class="ka">说白了. io </em> </strong> </a> <strong class="kb iz"> <em class="ka">。</em> </strong> <em class="ka">报名参加我们的</em> <a class="ae kx" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb iz"> <em class="ka">免费每周简讯这里</em> </strong> </a> <strong class="kb iz"> <em class="ka">。</em>T25】</strong></p></div></div>    
</body>
</html>