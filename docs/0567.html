<html>
<head>
<title>Ionic Framework with Vue 3 and Firebase — Photo Sharing App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有Vue 3和Firebase的Ionic框架——照片分享应用</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/ionic-framework-with-vue-3-and-firebase-photo-sharing-app-a3b8f948bbcb?source=collection_archive---------9-----------------------#2021-02-03">https://javascript.plainenglish.io/ionic-framework-with-vue-3-and-firebase-photo-sharing-app-a3b8f948bbcb?source=collection_archive---------9-----------------------#2021-02-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="efdb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第3部分—显示照片和地图</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/52661a0ee7ab3394dc459b7c560eafc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EAf0RJ9Qcxx58EXZFSCpiA.jpeg"/></div></div></figure><p id="7e55" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在第2部分中，我们介绍了如何利用本机设备特性，比如摄像头和GPS。在这一部分，我们将看看如何展示这些照片。我们还将看看如何用大头针显示我们拍摄照片的地图。</p><h1 id="c61a" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">制表符</h1><p id="0420" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">我们要做的第一件事是改变标签图标和名称。对于选项卡2，我们将显示一个图像图标，并将该选项卡命名为“图像”。对于选项卡3，我们将其命名为“地图”并显示一个地图图标。为此，请访问src/views/Tabs.vue。</p><p id="a2cd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在脚本标记的顶部，我们将用图像和地图图标替换椭圆和正方形图标:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="3f49" class="mp lo iq ml b gy mq mr l ms mt"><em class="mu">import</em> { <strong class="ml ir">images</strong>, <strong class="ml ir">map</strong>, cameraOutline } <em class="mu">from</em> 'ionicons/icons';</span></pre><p id="5ff1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后在设置方法中，我们将返回它们以便在模板中使用:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="47b3" class="mp lo iq ml b gy mq mr l ms mt"><em class="mu">setup</em>() {<br/> <em class="mu">return</em> {<br/>  <strong class="ml ir">images</strong>,<br/>  <strong class="ml ir">map</strong>,<br/>  cameraOutline,<br/> }<br/>}</span></pre><p id="62b6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在模板中，我们将用图标和名称替换标签。您的最终文件应该如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><h1 id="ac43" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">显示图像</h1><p id="d3c8" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">接下来，我们将致力于显示图像。我们将在第二个选项卡上实现这一点。因此，请转到src/views/Tab2.vue。我们要做的第一件事是导入我们需要的依赖项。</p><h2 id="691a" class="mp lo iq bd lp mx my dn lt mz na dp lx la nb nc lz le nd ne mb li nf ng md nh bi translated">脚本</h2><p id="4322" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">在脚本标记的顶部添加以下内容:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="3519" class="mp lo iq ml b gy mq mr l ms mt"><em class="mu">import</em> { reactive, toRefs } <em class="mu">from</em> "vue";</span><span id="c858" class="mp lo iq ml b gy ni mr l ms mt"><em class="mu">import</em> {<br/> IonPage,<br/> IonHeader,<br/> IonToolbar,<br/> IonTitle,<br/> IonContent,<br/> <strong class="ml ir">IonSpinner</strong>,<br/> <strong class="ml ir">IonLabel</strong>,<br/> <strong class="ml ir">IonCard</strong>,<br/> <strong class="ml ir">IonImg</strong>,<br/>} <em class="mu">from</em> "@ionic/vue";</span><span id="c32e" class="mp lo iq ml b gy ni mr l ms mt"><em class="mu">import</em> { db, auth } <em class="mu">from</em> "../main";</span></pre><p id="b1ce" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在导出默认值中，我们将注册我们添加的组件:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="4abf" class="mp lo iq ml b gy mq mr l ms mt">components: {<br/> IonHeader,<br/> IonToolbar,<br/> IonTitle,<br/> IonContent,<br/> IonPage,<br/> <strong class="ml ir">IonSpinner,<br/> IonLabel,<br/> IonCard, <br/> IonImg,</strong><br/>},</span></pre><p id="46de" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，我们将创建我们的设置方法并添加我们的状态:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="9be4" class="mp lo iq ml b gy mq mr l ms mt"><em class="mu">setup</em>() {<br/> const<em class="mu"> state </em>=<em class="mu"> reactive</em>({<br/>  <em class="mu">photos</em>:<em class="mu"> </em>[]<em class="mu"> as string</em>[],<br/>  <em class="mu">loading</em>:<em class="mu"> false</em>,<br/> });<br/>}</span></pre><p id="ee91" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，我们将在setup方法中创建从Firebase获取照片的方法:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="f811" class="mp lo iq ml b gy mq mr l ms mt">const<em class="mu"> fetchPhotos </em>=<em class="mu"> async </em>()<em class="mu"> </em>=&gt;<em class="mu"> </em>{<br/> <em class="mu">state.loading </em>=<em class="mu"> true</em>;<br/> <br/> const<em class="mu"> user </em>=<em class="mu"> auth.currentUser</em>;</span><span id="b73d" class="mp lo iq ml b gy ni mr l ms mt"> const<em class="mu"> snap </em>=<em class="mu"> await db<br/>  .collection</em>("users")<br/>  <em class="mu">.doc</em>(<em class="mu">user?.uid</em>)<br/>  <em class="mu">.collection</em>("images")<br/>  <em class="mu">.get</em>();<br/> <br/> if<em class="mu"> </em>(!<em class="mu">snap.empty</em>)<em class="mu"> </em>{<br/>  <em class="mu">snap.docs.forEach</em>((<em class="mu">doc</em>)<em class="mu"> </em>=&gt;<em class="mu"> </em>{<br/>   const<em class="mu"> data </em>=<em class="mu"> doc.data</em>();<br/>   if<em class="mu"> </em>(<em class="mu">data.image</em>)<em class="mu"> </em>{<br/>    <em class="mu">state.photos.push</em>(<em class="mu">data.image</em>);<br/>   }<br/>  });<br/> }</span><span id="9a75" class="mp lo iq ml b gy ni mr l ms mt"><em class="mu"> state.loading </em>=<em class="mu"> false</em>;<br/>};</span></pre><p id="664a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在setup方法中，我们需要做的最后一件事是调用fetchPhotos方法，以便它在页面加载时触发并返回状态:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="2072" class="mp lo iq ml b gy mq mr l ms mt"><em class="mu">fetchPhotos</em>();</span><span id="9b3d" class="mp lo iq ml b gy ni mr l ms mt"><em class="mu">return</em> {<br/> ...<em class="mu">toRefs</em>(state),<br/>};</span></pre><h2 id="e675" class="mp lo iq bd lp mx my dn lt mz na dp lx la nb nc lz le nd ne mb li nf ng md nh bi translated">模板</h2><p id="032f" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">现在我们有了要传递给模板的照片和状态，我们可以构建模板了。我们要做的第一件事是删除ion-content标签中的所有内容，并删除ExploreContainer组件。如果我们正在获取照片，我们将显示加载器。</p><p id="e032" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果我们的方法已经完成，我们没有照片，我们将显示一条消息说明这一点。如果我们有照片，我们将通过使用v-for循环在屏幕上以卡片的形式显示它们。</p><p id="5a6b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们还将添加一个带有“center”样式的样式标签，以在屏幕中央显示我们的微调器和标签。</p><p id="2865" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您的最终文件应该如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><h1 id="14da" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">地图</h1><p id="f521" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">既然我们的照片已经显示在应用程序中，让我们把注意力放在地图选项卡上，并在我们拍照的位置显示大头针。你需要做的第一件事是获得一个谷歌地图API密匙。要得到一个，你可以按照这里的说明<a class="ae nj" href="https://developers.google.com/maps/documentation/javascript/get-api-key" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="072b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有了API键之后，转到public/index.html，在结束head标记(<em class="mu"> &lt; /head &gt; </em>)之前添加以下内容:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="699f" class="mp lo iq ml b gy mq mr l ms mt">&lt;script <em class="mu">src</em>="http://maps.google.com/maps/api/js?key=YOUR_API_KEY"&gt;&lt;/script&gt;</span></pre><p id="d22d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，转到src/views/Tab3.vue。在脚本标记的顶部，我们必须告诉eslint和Typescript忽略所有错误，因为它不知道我们在index.html文件中导入了脚本:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="d51e" class="mp lo iq ml b gy mq mr l ms mt">//<em class="mu"> @ts-nocheck<br/></em>/*<em class="mu"> eslint-disable </em>*/</span></pre><p id="dacb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，我们将导入一些Vue依赖项以及我们的Firebase auth和db实例:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="78ed" class="mp lo iq ml b gy mq mr l ms mt"><em class="mu">import</em> { ref, onMounted } <em class="mu">from</em> "vue";<br/><em class="mu">import</em> {db, auth} <em class="mu">from</em> '../main';</span></pre><p id="a38b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，我们将创建我们的设置方法。我们将添加一个ref，这样我们就可以访问模板中的一个div，一个显示地图的方法，一个显示地图大头针的方法，并且在挂载时我们将触发这些方法。最后，您的脚本标记应该如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="0762" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了全屏显示我们的地图，我们还需要添加一个样式标签:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="b40e" class="mp lo iq ml b gy mq mr l ms mt">&lt;style <em class="mu">scoped</em>&gt;<br/>#<em class="mu">map</em> {<br/> width: 100%;<br/> height: 100%;<br/>}<br/>&lt;/style&gt;</span></pre><p id="7eba" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们需要做的最后一件事是编辑模板标签。在模板内部，删除ion-content标签中的所有内容，并删除ExplorerContainer组件。然后，在ion content标记中创建一个id为“map”、ref为“mapRef”的div。您的最终文件应该如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><h1 id="be8a" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">视频教程</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk mw l"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk">Video Tutorial</figcaption></figure><h1 id="3c62" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">结论</h1><p id="413c" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">在这个由3部分组成的系列中，我们已经了解了如何编写一个完整的移动应用程序，该应用程序使用相机和GPS等本机功能。在第一部分中，我们建立了我们的火基和离子项目。在<a class="ae nj" href="https://diligentdev.medium.com/ionic-framework-with-vue-3-and-firebase-photo-sharing-app-4ddda0c992a3" rel="noopener">第二部</a>中，我们用相机拍摄图像，用手机的GPS获取用户的位置。在这一部分，我们展示了这些图像和位置。</p><p id="ab13" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我希望你喜欢这个系列，并从中获得很多价值。我知道我很开心，也从组装过程中学到了很多。如果您有任何意见、问题或顾虑，请在下面留言。如果你从这个系列中得到任何价值，给我鼓掌。下次再见，祝编码愉快！</p></div></div>    
</body>
</html>