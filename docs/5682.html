<html>
<head>
<title>How to Hook up Firebase v9 to React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何连接Firebase v9进行反应</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/hooking-up-firebase-v9-to-react-be845465f219?source=collection_archive---------4-----------------------#2021-11-30">https://javascript.plainenglish.io/hooking-up-firebase-v9-to-react-be845465f219?source=collection_archive---------4-----------------------#2021-11-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="dc6e" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">随着Firebase发布了新的web模块化版本9，将React连接到Firebase变得前所未有的简单。我们将向你展示如何用一个短钩。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/0813431d3d4c944271e6f4d1b922f3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-VyjxXbGR62788fj"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@sortino?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joshua Sortino</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a522" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为一个应用程序创建一个完整的后端系统，或者仅仅是一个简单的授权，有时会让人力不从心。尤其是如果你像我一样，刚刚开始涉足后端开发的海洋。这就是为什么我的首选之一是<a class="ae ks" href="https://firebase.google.com" rel="noopener ugc nofollow" target="_blank"> Firebase </a>。</p><p id="74f5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Firebase以前被它的尺寸所拖累，增加了相当多的构建和渲染时间。在版本9中，Firebase引入了一个模块化选项来导入和使用Firebase提供的不同服务，如授权、firestore和实时数据库。</p><p id="9980" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在第一篇文章中，我将向你展示如何在你的React应用中初始化Firebase，在下一篇文章中，我将向你展示如何导入包并在你的应用中使用它们。</p><p id="bf83" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，让我们来看看如何将Firebase v 9连接到React应用程序。</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="8385" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">创建新的React应用程序(可选)</h1><p id="3198" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">假设您还没有启动并运行React项目，启动新项目的最简单方法是在命令行中运行<code class="fe mt mu mv mw b">npx create-react-app firebase-app</code>，等待初始化完成，然后通过运行<code class="fe mt mu mv mw b">cd firebase-app</code>导航到React应用程序的新文件夹。</p><p id="ab4d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们还需要安装我们的依赖项。我们将使用<a class="ae ks" href="https://www.npmjs.com/package/firebase" rel="noopener ugc nofollow" target="_blank"> Firebase NPM模块</a>连接到我们的Firebase数据库，使用<a class="ae ks" href="https://www.npmjs.com/package/dotenv" rel="noopener ugc nofollow" target="_blank"> dotenv NPM模块</a>存储我们的配置凭证。在<code class="fe mt mu mv mw b">firebase-app</code>文件夹中，运行<code class="fe mt mu mv mw b">npm install firebase dotenv --save</code>，等待安装完成。</p><p id="dba9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这一点上，你可以随意删除任何你不使用的文件，例如<code class="fe mt mu mv mw b">App.test.js</code>、<code class="fe mt mu mv mw b">reportWebVitals.js</code>和<code class="fe mt mu mv mw b">setupTests.js</code>。如果您选择删除这些，请记住也要删除来自<code class="fe mt mu mv mw b">index.js</code>的导入。</p><p id="4b07" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">运行<code class="fe mt mu mv mw b">npm start</code>以确保一切正常，并且您的应用已经启动并运行！</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="c059" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">设置dotenv</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mx"><img src="../Images/be0730de3e3d74ff37f15205dd3f48e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xhzXge-byJKxs0swHp0PJQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Cogwheel &gt; Project settings</figcaption></figure><p id="70ec" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在项目的根文件夹中创建一个新文件，名为<code class="fe mt mu mv mw b">.env.development</code>。这是我们将存储配置凭证的地方，在下一步中，我们将使用这些凭证在我们的应用程序中初始化Firebase。您的配置凭证可以在Firebase控制台中找到，单击左侧菜单上的齿轮，选择项目设置，然后向下滚动(几乎)到底部。</p><p id="82cc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">将配置凭证添加到dotenv文件并不比遵循语法NAME=VALUE更复杂。然而，为了让我们的React应用程序获取这些环境变量，我们需要给它们加上前缀<code class="fe mt mu mv mw b">REACT_APP_</code>，如创建React应用程序文档中的<a class="ae ks" href="https://create-react-app.dev/docs/adding-custom-environment-variables/" rel="noopener ugc nofollow" target="_blank">所述。请注意，如果您使用不同的环境，则创建React App(例如Gatsby)，环境变量的前缀可能会有所不同(例如<code class="fe mt mu mv mw b">GATSBY_</code>)。</a></p><p id="4130" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你计划将这个应用程序也用于生产，或者想要测试构建，创建一个相同的文件，仍然在项目的根文件夹中，命名为<code class="fe mt mu mv mw b">.env.production</code>。在这里，您可以简单地填写与开发完全相同的配置凭证，或者您可以填写一个单独项目的配置凭证。使用另一个项目的配置凭证将允许您将一个数据库用于开发，而将另一个数据库用于生产*。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="d488" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na"> *检查你正在运行的进程不比在你的应用的返回语句中放入(或</em><code class="fe mt mu mv mw b"><em class="na">console.log</em></code><em class="na">-ing)</em><code class="fe mt mu mv mw b"><em class="na">{process.env.NODE_ENV}</em></code><em class="na">并运行你的应用更难！</em></p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="383b" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">钩子、线和函数</h1><p id="b638" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">在项目的<code class="fe mt mu mv mw b">src</code>中，创建两个文件夹:<code class="fe mt mu mv mw b">hooks</code>和<code class="fe mt mu mv mw b">services</code>。在<code class="fe mt mu mv mw b">services</code>文件夹中，创建一个名为<code class="fe mt mu mv mw b">firebase.js</code>的文件。在<code class="fe mt mu mv mw b">hooks</code>文件夹中，创建一个名为<code class="fe mt mu mv mw b">useFirebase.js</code>的文件。</p><h2 id="9bd0" class="nb lx in bd ly nc nd dn mc ne nf dp mg lc ng nh mi lg ni nj mk lk nk nl mm nm bi translated">火情网</h2><p id="9fb6" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">在这个文件中，我们将初始化Firebase应用程序。对于Firebase v9，这并不比从<code class="fe mt mu mv mw b">"firebase/app"</code>导入<code class="fe mt mu mv mw b">initializeApp</code>功能更难。从Firebase控制台的项目设置中复制<code class="fe mt mu mv mw b">firebaseConfig</code>对象，并用dotenv文件中声明的环境变量替换所有值，例如<code class="fe mt mu mv mw b">process.env.REACT_APP_FIREBASE_APIKEY</code>。</p><p id="053f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们的默认导出将是一个名为<code class="fe mt mu mv mw b">getFirebase</code>的函数，它将返回给我们一个Firebase客户端的实例。我们将在我们的<code class="fe mt mu mv mw b">useFirebase</code>钩子中使用这个实例。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="my mz l"/></div></figure><h2 id="3c8f" class="nb lx in bd ly nc nd dn mc ne nf dp mg lc ng nh mi lg ni nj mk lk nk nl mm nm bi translated">useFirebase.js</h2><p id="cb5f" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">我们将用<code class="fe mt mu mv mw b">!!</code>来转换我们的实例。如果您不熟悉JavaScript中<code class="fe mt mu mv mw b">!!</code>的用法，这是<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" rel="noopener ugc nofollow" target="_blank">将非布尔值转换为布尔值的方法之一。在我看来是最简单最有型的一款。那么我们为什么要这样做呢？不仅仅是因为看起来很酷，其实是为了安全措施。记住我们的函数<code class="fe mt mu mv mw b">getFirebase</code>如何返回给我们整个初始化的Firebase客户端，如果我们<code class="fe mt mu mv mw b">console.log</code>返回给我们什么，我们可以看到我们的配置凭证显示在返回的对象中，在<code class="fe mt mu mv mw b">_options</code>下。对于我们的应用程序的构建版本来说也是如此，这意味着任何安装了</a><a class="ae ks" href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?hl=en" rel="noopener ugc nofollow" target="_blank"> React devtools </a>的人都可以看到我们的配置凭证，从而访问我们的数据库。如果我们提供一个boolean，这是一个安全的使用firebase的方法。只要站点上有一个连接的Firebase客户端，Firebase本身并不关心您是否有权访问返回的客户端。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="my mz l"/></div></figure><h1 id="a7c3" class="lw lx in bd ly lz nn mb mc md no mf mg jt np ju mi jw nq jx mk jz nr ka mm mn bi translated">测试连接</h1><p id="23ae" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">为了使用我们新的<code class="fe mt mu mv mw b">useFirebase</code>钩子，我们简单地将它导入到我们在<code class="fe mt mu mv mw b">App.js</code>中的根组件，并将它赋给一个变量，我发现<code class="fe mt mu mv mw b">firebase</code>非常直观，但是你当然可以随便叫它什么。</p><p id="6683" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果我们将变量<code class="fe mt mu mv mw b">console.log</code>赋给<code class="fe mt mu mv mw b">useFirebase</code>，我们将看到它最初返回<code class="fe mt mu mv mw b">false</code>，一旦连接建立，返回<code class="fe mt mu mv mw b">true</code>。我们将向您展示如何将它与其他Firebase功能(如firestore、存储、身份验证等)一起使用。)下一篇。但是现在，我们可以检查钩子是否工作，要么记录它，要么(我更喜欢的方式)在我们的返回语句中把它和<a class="ae ks" href="https://www.joshwcomeau.com/operator-lookup?match=logical-and" rel="noopener ugc nofollow" target="_blank">逻辑AND操作符</a>以及React要呈现的内容一起写出来。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="a155" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">值得注意的是，不管我们是否提供了正确的配置凭证，一旦Firebase客户端初始化完毕，我们的钩子就会返回true。我们真正知道我们是否正确连接了应用程序的唯一方法是尝试访问Firebase，我们将在下一篇文章中向您展示如何做！</p><p id="78f2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">更多内容请看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="na">plain English . io</em></strong></a><em class="na">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="na">免费每周简讯点击这里</em> </strong> </a> <strong class="kv io"> <em class="na">。</em>T19】</strong></p></div></div>    
</body>
</html>