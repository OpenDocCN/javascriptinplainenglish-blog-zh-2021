<html>
<head>
<title>Make a Camera App using React Native Expo (Android &amp; IOS)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React Native Expo制作相机应用程序(Android和IOS)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/make-a-camera-app-using-react-native-expo-android-ios-75b3567f5a47?source=collection_archive---------0-----------------------#2021-08-07">https://javascript.plainenglish.io/make-a-camera-app-using-react-native-expo-android-ios-75b3567f5a47?source=collection_archive---------0-----------------------#2021-08-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="27ae" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用React原生Expo应用程序拍照。</h2></div><p id="4c54" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">各位原生开发者好！</p><p id="6034" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如今，几乎所有的社交媒体应用程序都有拍照功能，你可以点击并使用应用程序更新你的个人资料。不仅是社交媒体应用程序，所有电子商务和生产应用程序都有这个功能。那么，作为一个初学者，如何在你的应用程序中添加这样一个特性呢？如果您正在使用React Native构建这样一个应用程序，那么喝杯咖啡，让我们看看这些东西是如何工作的。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/70ca25cf14e41b36f494c11ffb758d1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bWb2i26xPx2MLSnn"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Photo by <a class="ae lo" href="https://unsplash.com/@art_maltsev?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Artem Maltsev</a> on <a class="ae lo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f7ff" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您正在寻找视频教程，那么它就在这里:</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="lp lq l"/></div></figure><h1 id="540c" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">React本地Expo应用程序的设置和安装</h1><p id="c232" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated">使用命令:Expo init<strong class="ke io"><em class="mo">camera app</em></strong>在您的首选目录中启动expo-CLI项目(您可以根据自己的选择命名)。选择空白模板并完成javascript依赖项的安装。之后，使用命令在父目录中安装以下软件包:</p><pre class="kz la lb lc gt mp mq mr ms aw mt bi"><span id="9986" class="mu ls in mq b gy mv mw l mx my">npm install expo-camera</span></pre><p id="a71a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">expo-camera具有内置功能，可帮助您使用移动设备点击照片。</p><p id="969c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们已经完成了安装部分。让我们现在开始黑吧。</p><h1 id="51cd" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">React Native中相机应用程序的代码(JavaScript)</h1><p id="27ac" class="pw-post-body-paragraph kc kd in ke b kf mj jo kh ki mk jr kk kl ml kn ko kp mm kr ks kt mn kv kw kx ig bi translated"><strong class="ke io"> App.js </strong></p><pre class="kz la lb lc gt mp mq mr ms aw mt bi"><span id="6f43" class="mu ls in mq b gy mv mw l mx my">import React, { useState, useEffect } from 'react';<br/>import { StyleSheet ,Text, View, Button, Image} from 'react-native';<br/>import { Camera } from 'expo-camera';</span></pre><p id="79f2" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">从各自的包中导入上述组件，因为我们将在我们的项目中使用它们。</p><pre class="kz la lb lc gt mp mq mr ms aw mt bi"><span id="7bae" class="mu ls in mq b gy mv mw l mx my">const [hasCameraPermission, setHasCameraPermission] = useState(null);<br/>const [camera, setCamera] = useState(null);<br/>const [image, setImage] = useState(null);<br/>const [type, setType] = useState(Camera.Constants.Type.back);</span><span id="8d8d" class="mu ls in mq b gy mz mw l mx my">useEffect(() =&gt; {<br/>    (async () =&gt; {<br/>      const cameraStatus = await Camera.requestPermissionsAsync();<br/>      setHasCameraPermission(cameraStatus.status === 'granted');</span><span id="4a21" class="mu ls in mq b gy mz mw l mx my">})();<br/>  }, []);</span></pre><p id="eede" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们请求用户允许我们使用摄像机。许可的初始状态被设置为空，但是当用户允许访问摄像机时，许可的状态将会改变。这就是为什么我们在这里使用react-hook的useState。</p><p id="7ce7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们的手机上有两种类型的摄像头，前置摄像头和后置摄像头。我们在它们之间切换，点击我们选择的图片。而相机之间的切换就是状态的变化。初始状态设置为“后”,但您可以将其更改为“前”,当您更改它时，状态会更改为“前”。这就是为什么我们在这里使用type作为钩子。同样的挂钩概念也适用于相机和图像。</p><p id="c843" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">useEffect的数据异步存储在一个数组中。如果你删除了这个阵列，那么每次用户打开应用程序时，应用程序都会询问相机的许可，这有点烦人，也给用户带来了不好的体验。</p><pre class="kz la lb lc gt mp mq mr ms aw mt bi"><span id="0bd3" class="mu ls in mq b gy mv mw l mx my">const takePicture = async () =&gt; {<br/>    if(camera){<br/>        const data = await camera.takePictureAsync(null)<br/>        setImage(data.uri);<br/>    }<br/>  }<br/> if (hasCameraPermission === false) {<br/>    return &lt;Text&gt;No access to camera&lt;/Text&gt;;<br/>  }</span></pre><p id="15ca" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这个箭头功能将允许您拍摄图片，并将图像的URI设置为setImage hook。你也可以在这里控制台记录数据，它会给你URI，高度，宽度，和图像的其他细节。</p><p id="bda5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果用户拒绝访问图库，屏幕上将出现“禁止访问摄像头”的文字。</p><pre class="kz la lb lc gt mp mq mr ms aw mt bi"><span id="dbfd" class="mu ls in mq b gy mv mw l mx my">&lt;View style={{ flex: 1}}&gt;<br/>   &lt;View style={styles.cameraContainer}&gt;<br/>       &lt;Camera <br/>            ref={ref =&gt; setCamera(ref)}<br/>            style={styles.fixedRatio} <br/>            type={type}<br/>            ratio={'1:1'} /&gt;<br/>    &lt;/View&gt;<br/>    &lt;Button<br/>            title="Flip Image"<br/>            onPress={() =&gt; {<br/>              setType(<br/>                type === Camera.Constants.Type.back<br/>                  ? Camera.Constants.Type.front<br/>                  : Camera.Constants.Type.back<br/>              );<br/>            }}&gt;<br/>     &lt;/Button&gt;<br/>     &lt;Button title="Take Picture" onPress={() =&gt; takePicture()} /&gt;<br/>     {image &amp;&amp; &lt;Image source={{uri: image}} style={{flex:1}}/&gt;}<br/>&lt;/View&gt;</span></pre><p id="79d5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在将这些代码添加到App函数的返回片段中。这将给你一个在屏幕上观看该项目的体验。我将摄像机视角的比例设置为1:1。您可以对其进行相应的定制。大多数人更喜欢4:3的观点。</p><p id="4737" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因为我们主要关注这些东西的功能而不是样式。您可以相应地设计它们的样式。现在，在终端窗口中运行这个应用程序，并在您的设备上运行expo应用程序。点击一张你自己的照片，嘣..！！你在屏幕上看到自己。恭喜你，你使用react native expo成功构建了一个相机应用程序。</p><p id="9d76" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">本文到此为止。如果你在某个地方丢失了，那么完整的代码在这里。</p><pre class="kz la lb lc gt mp mq mr ms aw mt bi"><span id="7271" class="mu ls in mq b gy mv mw l mx my">import React, { useState, useEffect } from 'react';<br/>import { StyleSheet ,Text, View, Button, Image} from 'react-native';<br/>import { Camera } from 'expo-camera';<br/><br/>export default function App() {<br/>  const [hasCameraPermission, setHasCameraPermission] = useState(null);<br/>  const [camera, setCamera] = useState(null);<br/>  const [image, setImage] = useState(null);<br/>  const [type, setType] = useState(Camera.Constants.Type.back);</span><span id="ba36" class="mu ls in mq b gy mz mw l mx my">useEffect(() =&gt; {<br/>    (async () =&gt; {<br/>      const cameraStatus = await Camera.requestPermissionsAsync();<br/>      setHasCameraPermission(cameraStatus.status === 'granted');</span><span id="3ed3" class="mu ls in mq b gy mz mw l mx my">})();<br/>  }, []);</span><span id="659f" class="mu ls in mq b gy mz mw l mx my">const takePicture = async () =&gt; {<br/>    if(camera){<br/>        const data = await camera.takePictureAsync(null)<br/>        setImage(data.uri);<br/>    }<br/>  }</span><span id="bdb8" class="mu ls in mq b gy mz mw l mx my"><br/>  if (hasCameraPermission === false) {<br/>    return &lt;Text&gt;No access to camera&lt;/Text&gt;;<br/>  }<br/>  return (<br/>   &lt;View style={{ flex: 1}}&gt;<br/>      &lt;View style={styles.cameraContainer}&gt;<br/>            &lt;Camera <br/>            ref={ref =&gt; setCamera(ref)}<br/>            style={styles.fixedRatio} <br/>            type={type}<br/>            ratio={'1:1'} /&gt;<br/>      &lt;/View&gt;<br/>      &lt;Button<br/>            title="Flip Image"<br/>            onPress={() =&gt; {<br/>              setType(<br/>                type === Camera.Constants.Type.back<br/>                  ? Camera.Constants.Type.front<br/>                  : Camera.Constants.Type.back<br/>              );<br/>            }}&gt;<br/>        &lt;/Button&gt;<br/>       &lt;Button title="Take Picture" onPress={() =&gt; takePicture()} /&gt;<br/>        {image &amp;&amp; &lt;Image source={{uri: image}} style={{flex:1}}/&gt;}<br/>   &lt;/View&gt;<br/>  );<br/>}</span><span id="a703" class="mu ls in mq b gy mz mw l mx my">const styles = StyleSheet.create({<br/>  cameraContainer: {<br/>      flex: 1,<br/>      flexDirection: 'row'<br/>  },<br/>  fixedRatio:{<br/>      flex: 1,<br/>      aspectRatio: 1<br/>  }<br/>})</span></pre><p id="5880" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">感谢阅读！如果这篇文章对你有帮助，你可以尽情鼓掌。</p><p id="02b1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mo">更多内容看</em> <a class="ae lo" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="mo">说白了. io </em> </a> <em class="mo">。在这里注册我们的</em> <a class="ae lo" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="mo">免费周报</em> </a> <em class="mo">。</em></p></div></div>    
</body>
</html>