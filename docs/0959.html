<html>
<head>
<title>Mobile Face Detection with Google ML Kit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用谷歌ML工具包的移动人脸检测</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/mobile-face-detection-with-google-ml-kit-6b6debf13e84?source=collection_archive---------10-----------------------#2021-02-28">https://javascript.plainenglish.io/mobile-face-detection-with-google-ml-kit-6b6debf13e84?source=collection_archive---------10-----------------------#2021-02-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/a2d026a9fa4bf95844a2f8a2423fa4e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/format:webp/1*07KCOtuUYGqeosGQ-KJ2WA.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk">Face detector</figcaption></figure><p id="cbee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我在本文中的目标是向您展示如何在不到5分钟的时间内用Expo和Google ML Kit构建一个人脸检测器移动应用程序。</p><p id="fea0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Expo是一个强大的框架，配备了大量现成的组件，允许您轻松构建跨平台移动应用程序。在本文中，我们将使用诸如expo-camera这样的组件来访问手机摄像头，并使用一个内置的人脸检测器模块expo-face-detector来从图像中检测人脸。世博人脸检测器基于<a class="ae kt" href="https://cloud.google.com/vision" rel="noopener ugc nofollow" target="_blank"> Google ML Kit Vision API </a>。</p><p id="9193" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在我们可以使用相机对象之前，我们需要导入expo-permissions包，并使用这一行代码访问相机权限。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="ff90" class="ld le in kz b gy lf lg l lh li">await Permissions.askAsync(Permissions.CAMERA);</span></pre><p id="c4ac" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Expo camera内置了人脸检测器属性，以便我们配置其属性和回调方法。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="3a28" class="ld le in kz b gy lf lg l lh li">&lt;Camera<br/>  style={{ flex: 1 }}<br/>  type={this.props.cameraType}<br/>  onFacesDetected={this.handleFacesDetected}<br/>  onFaceDetectionError={this.handleFaceDetectionError}<br/>  faceDetectorSettings={{<br/>    mode: FaceDetector.Constants.Mode.fast,<br/>    detectLandmarks: FaceDetector.Constants.Landmarks.all,<br/>    runClassifications: FaceDetector.Constants.Classifications.all,<br/>  }}<br/>  ref={ref =&gt; {<br/>    this.camera = ref;<br/>  }}<br/>&gt;</span></pre><p id="1ed0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">onFacesDetected:设置检测到人脸时处理人脸的方法。在检测人脸时，人脸检测器将以人脸对象数组作为参数调用该方法。我的实现如下。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="874c" class="ld le in kz b gy lf lg l lh li">handleFacesDetected = ({ faces }) =&gt; {<br/>  if (faces.length === 1){ // detect a face<br/>    this.setState({<br/>      faceDetected: true, // variable state to hold face is detected<br/>      faceBox: faces[0].bounds // variable to hold face location<br/>    });<br/>  } else { // no faces detected<br/>    this.setState({faceDetected: false });<br/>  }<br/>}</span></pre><p id="b72c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了显示面部边界框并突出显示检测到的面部，我们使用带有相应样式的反应视图在面部检测器模型返回的位置绘制一个虚线矩形。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="65a7" class="ld le in kz b gy lf lg l lh li">&lt;View<br/>  style={{<br/>    position: 'absolute',<br/>    backgroundColor: 'transparent',<br/>    flexDirection: 'row',<br/>    width: this.state.faceBox ? this.state.faceBox.size.width : '100%',<br/>    height: this.state.faceBox ? this.state.faceBox.size.height : '100%',<br/>    top: this.state.faceBox ? this.state.faceBox.origin.y : '0',<br/>    left: this.state.faceBox ? this.state.faceBox.origin.x : '0',<br/>    borderColor: '#33FF33',<br/>    borderWidth: 5,<br/>    borderStyle: 'dashed',<br/>    display: this.state.faceDetected &amp;&amp; !this.state.pictureTaken ? 'flex' : 'none',<br/>  }}&gt;<br/>&lt;/View&gt;</span></pre><p id="bf8b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要绘制矩形，请注意我们正在从faceBox状态变量中设置左上角的宽度高度，该变量有origin.x、origin.y和size.width、size.height。</p><p id="c0b2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面是faceDetectorSettings属性的有趣部分，通过设置run class:face detector . constants . mode . all，我们不仅可以检测人脸，还可以检测微笑和睁眼的概率。注意如果您只需要人脸检测，请将其设置为none。请参阅此处的<a class="ae kt" href="https://docs.expo.io/versions/latest/sdk/facedetector/" rel="noopener ugc nofollow" target="_blank"> API文档</a>。还有检测界标属性，我们可以检测和返回人脸界标，如眼睛，鼻子，嘴巴。用更多一点的代码，我们可以建立一个应用程序，可以提醒疲惫的司机，当他们无意中闭上眼睛太长时间</p><p id="4ed3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">世博相机和内置的人脸检测器功能允许我们用几行代码构建一个移动人脸检测应用程序。它简单而强大，但你可能会问，我怎么才能在相机上使用我自己的视觉模型？在我的下一篇文章中，我将向您展示如何使用其他机器学习模型，比如Google MobileNet和TensorFlow.js平台适配器来进行react native框架，我们将看到如何使用TensorCamera对象。这个目标加强了<a class="ae kt" href="https://docs.expo.io/versions/latest/sdk/camera/" rel="noopener ugc nofollow" target="_blank">世博会。相机</a>组件，能够产生代表相机流的张量。请继续关注。</p><p id="cfb2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">本文的完整源代码可以在这里找到:</p><figure class="ku kv kw kx gt jo"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="e497" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">请<strong class="jx io">关注</strong>我如果你觉得这篇文章有用，它将激励我写更多有用的文章并帮助他人学习。谢谢你。</p></div></div>    
</body>
</html>