<html>
<head>
<title>How to Properly Watch for Nested Data with Vue.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Vue.js正确地观察嵌套数据</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-properly-watch-for-nested-data-with-vue-js-3ac7ca964067?source=collection_archive---------7-----------------------#2021-04-29">https://javascript.plainenglish.io/how-to-properly-watch-for-nested-data-with-vue-js-3ac7ca964067?source=collection_archive---------7-----------------------#2021-04-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/693724f381c632998bee756015ab60c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WJI-FTYa752G7fVV"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@m_stepien?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mateusz Stępień</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="eea3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">观察深度嵌套的对象状态和道具是我们在Vue.js应用程序中经常要做的事情。</p><p id="52b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何正确地观察Vue.js组件中的嵌套数据。</p><h1 id="4755" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">深度观察者</h1><p id="1d60" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以向<code class="fe me mf mg mh b">watch</code>属性中的组件添加深度观察器。</p><p id="62cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="4a56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">App.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="bb29" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;button<br/>      @click="<br/>        id++;<br/>        getTodo(id);<br/>      "<br/>    &gt;<br/>      increment id<br/>    &lt;/button&gt;<br/>    &lt;Todo :todo="todo" /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="a834" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>import Todo from "./components/Todo";</span><span id="fc5d" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  name: "App",<br/>  components: {<br/>    Todo,<br/>  },<br/>  data() {<br/>    return {<br/>      todo: {},<br/>      id: 1,<br/>    };<br/>  },<br/>  methods: {<br/>    async getTodo(id) {<br/>      const results = await fetch(<br/>        `https://jsonplaceholder.typicode.com/todos/${id}`<br/>      );<br/>      const data = await results.json();<br/>      this.todo = data;<br/>    },<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="fad1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">Todo.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8e1d" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div class="hello"&gt;&lt;/div&gt;<br/>&lt;/template&gt;</span><span id="addd" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  name: "Todo",<br/>  props: {<br/>    todo: Object,<br/>  },<br/>  watch: {<br/>    todo: {<br/>      handler(val) {<br/>        console.log(val);<br/>      },<br/>      deep: true,<br/>    },<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="c938" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个按钮，当我们用给定的<code class="fe me mf mg mh b">id</code>获取一个新的<code class="fe me mf mg mh b">todo</code>对象时，它会调用<code class="fe me mf mg mh b">getTodo</code>。</p><p id="ddc8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">getTodo</code>从响应中更新<code class="fe me mf mg mh b">todo</code>反应属性。</p><p id="55a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">todo</code>值传递给<code class="fe me mf mg mh b">Todo</code>组件的<code class="fe me mf mg mh b">todo</code>属性。</p><p id="5b5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">Todo</code>组件中，我们观察具有<code class="fe me mf mg mh b">watch</code>属性的<code class="fe me mf mg mh b">todo</code>道具。</p><p id="0112" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用带有<code class="fe me mf mg mh b">val</code>参数的<code class="fe me mf mg mh b">handler</code>函数来获取最新的值。</p><p id="1cab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">deep</code>设置为<code class="fe me mf mg mh b">true</code>，这样我们就可以观察物体道具的属性。</p><h1 id="b90c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">计算属性</h1><p id="6938" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以创建一个计算属性来从反应属性中获取属性。</p><p id="1f6f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="dabd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">Todo.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2906" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;{{ todoTitle }}&lt;/div&gt;<br/>&lt;/template&gt;</span><span id="3c80" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  name: "Todo",<br/>  props: {<br/>    todo: Object,<br/>  },<br/>  computed: {<br/>    todoTitle() {<br/>      return this.todo.title;<br/>    },<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="30bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们保持<code class="fe me mf mg mh b">App.vue</code>不变。</p><p id="10f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了返回<code class="fe me mf mg mh b">this.todo.title</code>属性的<code class="fe me mf mg mh b">todoTitle</code>计算属性。</p><p id="40d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以在模板中使用它，就像其他任何反应属性一样。</p><p id="25bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每当<code class="fe me mf mg mh b">this.todo</code>对象中的任何属性被更新时，<code class="fe me mf mg mh b">todoTitle</code>将被更新。</p><h1 id="59fb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">观察对象的属性</h1><p id="e8fe" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们还可以观察一个对象的属性。</p><p id="4335" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="101c" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div class="hello"&gt;&lt;/div&gt;<br/>&lt;/template&gt;</span><span id="f0a1" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  name: "Todo",<br/>  props: {<br/>    todo: Object,<br/>  },<br/>  watch: {<br/>    "todo.title": {<br/>      handler(val) {<br/>        console.log(val);<br/>      },<br/>    },<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="d1b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后<code class="fe me mf mg mh b">todo</code>道具的<code class="fe me mf mg mh b">title</code>属性被观察者观察。</p><p id="a789" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为<code class="fe me mf mg mh b">'todo.title'</code>是<code class="fe me mf mg mh b">todo</code>道具的<code class="fe me mf mg mh b">title</code>属性。</p><p id="1548" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">val</code>将具有<code class="fe me mf mg mh b">todo</code>属性的<code class="fe me mf mg mh b">title</code>属性值。</p><p id="7804" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以从watcher函数中得到<code class="fe me mf mg mh b">newVal</code>和<code class="fe me mf mg mh b">oldVal</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b503" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div class="hello"&gt;&lt;/div&gt;<br/>&lt;/template&gt;</span><span id="34b8" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  name: "Todo",<br/>  props: {<br/>    todo: Object,<br/>  },<br/>  watch: {<br/>    "todo.title": {<br/>      handler(newVal, oldVal) {<br/>        console.log(newVal, oldVal);<br/>      },<br/>    },<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><h1 id="3daa" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="464e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过向带有属性路径的<code class="fe me mf mg mh b">watch</code>属性对象添加方法，用观察器来观察嵌套的属性。</p><p id="5e9f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以将<code class="fe me mf mg mh b">deep</code>设置为<code class="fe me mf mg mh b">true</code>来观察深度嵌套的属性。</p><p id="5254" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读，希望这篇文章对您有所帮助。</p><p id="3c02" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="mw">更多内容敬请关注</em></a></p></div></div>    
</body>
</html>