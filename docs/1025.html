<html>
<head>
<title>Profit from TypeScript in pure JavaScript projects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从纯JavaScript项目的TypeScript中获利</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/profit-from-typescript-in-pure-javascript-projects-5208a2f5c9b0?source=collection_archive---------23-----------------------#2021-03-03">https://javascript.plainenglish.io/profit-from-typescript-in-pure-javascript-projects-5208a2f5c9b0?source=collection_archive---------23-----------------------#2021-03-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5b35" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将TypeScript链接到JavaScript并启用类型检查</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ce1de15f66190d30808aa2ea4c259410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cAi8PmyO026dl3IIh_--eg.png"/></div></div></figure><p id="af75" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从TypeScript中获利有一个简单的方法，特别是在基于项目的操作中。当迁移不可行或已经提出疑问但没有得到任何<em class="ln">是</em>或<em class="ln">否</em>的回答时。从JavaScript迁移到TypeScript也意味着可能会出现问题，例如在某些情况下代码不兼容，或者没有足够经验的程序员来迁移项目，或者您的项目依赖于Microsoft。</p><p id="ebe7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是，TypeScript是JavaScript的超集，这使得将JavaScript移植到TypeScript变得很容易。这意味着所有编写的类型脚本代码都是有效的JavaScript (JS)代码。认为TypeScript编译器只适用于用JavaScript编写的项目是错误的。TypeScript (TS)编译器不关心文件<em class="ln"> *的结尾。js </em>或<em class="ln"> *。ts </em>没啥意思。因为JS没有从TS得到语言特性，也没有信息类型。</p><p id="5cc8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">看起来旅程的终点是项目完全是ts或停留在JS，但是还有第三种选择，通过TypeScript丰富基于JS代码的项目，而不需要完全迁移，从而创建混合。</p><h1 id="e100" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">明智地使用类型系统</h1><p id="f29d" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">到目前为止，我解释的内容限制了TypeScript的类型系统，并且它只在语言本身中可用。JS不识别类型。JS代码中存在无法识别类型的可能性，这可能会导致错误。那么，如何让这一切成为可能呢？</p><p id="cfcb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">注释不是一个选项，因为JavaScript中没有有效的语法，比如</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="f447" class="mq lp iq mm b gy mr ms l mt mu">let x: number, y: number;</span></pre><p id="0d3c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最简单的方法是使用注释。将注释的样式与JSDoc已知语法对齐。将先前声明的变量键入如下</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="4eb6" class="mq lp iq mm b gy mr ms l mt mu"><em class="ln">/** @type {number} */ <br/></em>let x;<br/><em class="ln">/** @type {number} */ <br/></em>let y;</span></pre><p id="ce31" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">访问这两个变量意味着我们可以分配两个数。</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="c27c" class="mq lp iq mm b gy mr ms l mt mu">x = 23;<br/>y = 23;</span></pre><p id="cd6c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">不幸的是，每隔一个值赋值不会导致错误。虽然应该有一个。下面的代码是有效的。</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="ba76" class="mq lp iq mm b gy mr ms l mt mu">x = 'Hallo Welt!'; <br/>y = false;</span></pre><p id="dd57" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这种有效代码的原因是:TS只在基于TS项目的环境中检查类型，而不是在JS环境中。幸运的是，我们可以通过添加一行来启用这种类型的手动检查。该行必须是:</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="10af" class="mq lp iq mm b gy mr ms l mt mu"><em class="ln">//@ts-check</em></span></pre><p id="fcbb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一个例子可能是这样的:</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="7d86" class="mq lp iq mm b gy mr ms l mt mu"><em class="ln">//@ts-check<br/><br/>/** @type {number} */<br/></em>let x;<br/><em class="ln">/** @type {number} */ <br/></em>let y;</span></pre><p id="c2e4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它现在将实现类型检查，将错误的类型值赋给两个变量中的任何一个都会导致编译器错误。你可以在这里阅读TypeScript <a class="ae mv" href="https://jsdoc.app/" rel="noopener ugc nofollow" target="_blank">支持的JSDoc的每一个关键字。</a></p><h1 id="4a90" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated"><strong class="ak">配置您的JavaScript项目</strong></h1><p id="8ddf" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">想象一下在每个文件中放入一行<strong class="kt ir"> //@ts-check </strong>。这是一个繁琐的过程，更实际的做法是让TypeScript在全球范围内使用。幸好有办法！</p><p id="60f1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">必须创建文件<em class="ln"> jsconfig.json </em>,只需要一行代码就可以在整个项目中全局启用。<em class="ln"> Jsconfig.json </em>看起来和众所周知的<em class="ln"> tsconfig.json </em>几乎一模一样，但是当然，得到了JS特有的条目。因此，可以对所有文件启用类型检查。</p><p id="a247" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">是否要排除特定文件？将它们添加到<em class="ln"> jsconfig.json </em>文件的排除列表中，或者将</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="90c2" class="mq lp iq mm b gy mr ms l mt mu"><em class="ln">//@ts-nocheck</em></span></pre><p id="08f3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从TS 3.7开始，你可以从类型声明中生成<em class="ln"> *.d.ts </em>文件，对此我们使用JSDoc注释。这意味着我们也可以在库中键入变量，而根本不用迁移到TypeScript。为此，您需要一个<em class="ln"> tsconfig.json </em>文件，尽管它仍然是一个纯JavaScript项目。添加行<em class="ln">编译器选项</em>和一堆首选项:</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="8771" class="mq lp iq mm b gy mr ms l mt mu">{ "include": [ "./src/**/*.js" ],<br/>    "compilerOptions" : {<br/>        "allowJs" : true,<br/>        "declaration" : true,<br/>        "emitDeclarationOnly" : true,<br/>        "outDir": "./dist"<br/>    }<br/>}</span></pre><p id="ea09" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"><em class="ln">allow JS:true</em></strong><em class="ln">:</em>甚至考虑项目中的JS文件，进行类型声明。在TypeScript项目中将忽略默认JavaScript。<br/> <strong class="kt ir"> <em class="ln">声明:true </em> </strong>:告诉编译器以<em class="ln"> *.d.ts </em>文件的形式显式创建类型声明。<br/><strong class="kt ir"><em class="ln">emitDeclarationOnly:true</em></strong><em class="ln">:</em>你只想得到类型声明而不是代码的翻译。<br/><strong class="kt ir"><em class="ln">outDir:&lt;dirPath&gt;</em></strong>:类型声明不是源代码的一部分。因此，粘贴在您的首选目录。</p><p id="ac06" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您不喜欢编辑JSON，可以用如下参数启动编译器</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="ad06" class="mq lp iq mm b gy mr ms l mt mu">$ npx tsc ./src/**<em class="ln">/*.js --allowJs --declaration --emitDeclarationOnly --outDir ./dist</em></span></pre><p id="d10c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">已正确设置文件package.json中的types-field。否则，模块无法找到相应的<em class="ln"> *.d.ts </em>文件。记住明智地选择集合属性也很重要。严格模式在TS中非常有用和有意义，但在JS中毫无意义。</p><h1 id="291f" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">结论</h1><p id="00f8" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">创建JavaScript和TypeScript的混合体只需要几个步骤。至少可以在不迁移整个代码库的情况下将类型系统实现到仅包含JS的项目中。</p><p id="4d30" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是因为TypeScript基于像JSDoc这样的注释，JS-Codebase的文档得到了增强，至少在使用JSDoc时是这样。我不能否认，您只能获得TypeScript提供的一些有意义的特性，这些特性将随完整的迁移一起提供。在这里得出一个结论:有总比没有好。</p><p id="0e74" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">TypeScript功能强大，可以为您节省大量时间和调试工作。对于大型项目，您需要一个好的理由来继续使用JS，而不是迁移到ts。但是正是因为这个特殊的原因，covered方法提供了一种方法，至少有几个方便的可用选项。</p></div></div>    
</body>
</html>