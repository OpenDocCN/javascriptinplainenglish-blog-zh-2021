<html>
<head>
<title>One Refactoring Rule Great Developer Should Know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">伟大的开发人员应该知道的一条重构规则</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-rule-of-three-refactoring-rule-every-great-developer-knows-6e910a8b02d8?source=collection_archive---------14-----------------------#2021-03-10">https://javascript.plainenglish.io/the-rule-of-three-refactoring-rule-every-great-developer-knows-6e910a8b02d8?source=collection_archive---------14-----------------------#2021-03-10</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="7609" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">学习规则，变得更擅长重构</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/d7cb16c9d6e810e47ba1c00c05f4d6d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TSoKsD3yVhT1xz-R"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Photo by <a class="ae kw" href="https://www.pexels.com/@olia-danilevich?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">olia danilevich</a> from <a class="ae kw" href="https://www.pexels.com/photo/man-sitting-in-front-of-three-computers-4974915/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><p id="3c5c" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">假设你写了两次完全相同的代码。你是一个优秀的开发人员，看到这是重复的代码。考虑到DRY，你进行重构。</p><p id="ad3c" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但这是正确的方式吗？你让代码更容易维护了吗？这个场景的衡量标准是什么？</p><p id="fc49" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">让我们进入细节。</p><h1 id="f411" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">等等。</h1><p id="a48b" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">这是规则。等等。等待更多的复制。</p><p id="c75c" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">也被称为“三法则”。或者“什么都写两遍”。</p><p id="1f40" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">你经常看到相同的代码，三次或更多次？。重构。进行抽象。如果不是，就让它保持原样。</p><blockquote class="mq"><p id="3155" class="mr ms ir bd mt mu mv mw mx my mz ls dk translated">“三振出局，你重构”——尼古拉斯·卡洛</p></blockquote><p id="f6a6" class="pw-post-body-paragraph kx ky ir kz b la na js lc ld nb jv lf lg nc li lj lk nd lm ln lo ne lq lr ls ik bi translated">接受小复制。没那么糟糕。错误的抽象比复制更糟糕。</p><blockquote class="mq"><p id="e033" class="mr ms ir bd mt mu mv mw mx my mz ls dk translated"><strong class="ak">复用代码时，复制一次，第三次只抽象</strong>。—三原则</p></blockquote><p id="a510" class="pw-post-body-paragraph kx ky ir kz b la na js lc ld nb jv lf lg nc li lj lk nd lm ln lo ne lq lr ls ik bi translated">不等待的代价是一个糟糕的抽象概念。您没有足够的泛型来提取。两个用例是不够的。你需要两个以上，然后你可以做抽象。</p></div><div class="ab cl nf ng hv nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ik il im in io"><h1 id="67eb" class="lt lu ir bd lv lw nm ly lz ma nn mc md jx no jy mf ka np kb mh kd nq ke mj mk bi translated">为什么错误的抽象不好？</h1><p id="e7aa" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">糟糕的抽象会导致糟糕的代码。不要为了抽象而添加抽象。这导致了糟糕的代码质量。</p><p id="7c49" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">有多少次你不得不添加一个新的条件到现有的实现中？这就产生了混乱的代码，难以测试，难以维护。</p><p id="8fce" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">以下是桑迪·梅斯如何看待糟糕的抽象。您可以自己推断代码质量问题。</p><p id="4020" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">Sandi Metz说得很完美，所以我在这里重复一下。复制比抽象要好。</p><ol class=""><li id="94b2" class="nr ns ir kz b la lb ld le lg nt lk nu lo nv ls nw nx ny nz bi translated">程序员A看到了重复。</li><li id="7281" class="nr ns ir kz b la oa ld ob lg oc lk od lo oe ls nw nx ny nz bi translated">程序员A提取复制并给它一个名字。</li><li id="229f" class="nr ns ir kz b la oa ld ob lg oc lk od lo oe ls nw nx ny nz bi translated"><em class="of">这创造了一种新的抽象。它可能是一个新的方法，甚至可能是一个新的类。</em></li><li id="6558" class="nr ns ir kz b la oa ld ob lg oc lk od lo oe ls nw nx ny nz bi translated">程序员A用新的抽象替换了复制。</li><li id="29fa" class="nr ns ir kz b la oa ld ob lg oc lk od lo oe ls nw nx ny nz bi translated"><em class="of">啊，代码是完美的。程序员快乐地小跑而去。</em></li><li id="50b7" class="nr ns ir kz b la oa ld ob lg oc lk od lo oe ls nw nx ny nz bi translated">时光流逝。</li><li id="700e" class="nr ns ir kz b la oa ld ob lg oc lk od lo oe ls nw nx ny nz bi translated">一个新的需求出现了，当前的抽象几乎是完美的。</li><li id="fafe" class="nr ns ir kz b la oa ld ob lg oc lk od lo oe ls nw nx ny nz bi translated">程序员B的任务是实现这个需求。</li><li id="62b1" class="nr ns ir kz b la oa ld ob lg oc lk od lo oe ls nw nx ny nz bi translated"><em class="of">程序员B觉得保留现有的抽象是义不容辞的，但由于每个案例的抽象并不完全相同，他们修改代码以接受一个参数，然后添加逻辑以根据该参数的值有条件地做正确的事情。</em></li><li id="eb96" class="nr ns ir kz b la oa ld ob lg oc lk od lo oe ls nw nx ny nz bi translated"><em class="of">曾经的通用抽象现在在不同的情况下表现不同。</em></li><li id="501e" class="nr ns ir kz b la oa ld ob lg oc lk od lo oe ls nw nx ny nz bi translated">另一个新的要求来了。<br/> <em class="of">程序员X. <br/>另一个附加参数。<br/>又一个新的条件句。<br/>循环直到代码变得不可理解。</em></li><li id="756a" class="nr ns ir kz b la oa ld ob lg oc lk od lo oe ls nw nx ny nz bi translated">你出现在这个故事中，你的生活发生了戏剧性的变化。—桑迪·梅茨</li></ol></div><div class="ab cl nf ng hv nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ik il im in io"><h1 id="6f09" class="lt lu ir bd lv lw nm ly lz ma nn mc md jx no jy mf ka np kb mh kd nq ke mj mk bi translated">维护糟糕的抽象的代价是什么？</h1><blockquote class="mq"><p id="d99e" class="mr ms ir bd mt mu mv mw mx my mz ls dk translated"><em class="og">最快的前进方式是后退——桑迪·梅斯</em></p></blockquote><p id="9bb9" class="pw-post-body-paragraph kx ky ir kz b la na js lc ld nb jv lf lg nc li lj lk nd lm ln lo ne lq lr ls ik bi translated">不要维护不好的抽象。重新做每件事。把代码放回客户端。你会看到复制并不是“如此复制”，它毕竟是不同的。</p><p id="343b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们作为开发人员，不喜欢删除代码。我们生来就有这种感觉。我们遭受<a class="ae kw" href="https://en.wikipedia.org/wiki/Sunk_cost#Loss_aversion_and_the_sunk_cost_fallacy" rel="noopener ugc nofollow" target="_blank">沉没成本谬误</a>。失去的时间，开发人员的自负，以及其他阻碍我们改变的愚蠢想法。必要时我们需要减少损失。</p><p id="482e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">重新引入重复，去除不良抽象。这是这个故事的重点。</p></div><div class="ab cl nf ng hv nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ik il im in io"><h1 id="3a13" class="lt lu ir bd lv lw nm ly lz ma nn mc md jx no jy mf ka np kb mh kd nq ke mj mk bi translated">三分律</h1><div class="oh oi gq gs oj ok"><a href="https://understandlegacycode.com/blog/refactoring-rule-of-three/" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fp"><div class="om ab on cl cj oo"><h2 class="bd is gz z fq op fs ft oq fv fx iq bi translated">不要让干净的代码更难维护，使用规则三</h2><div class="or l"><h3 class="bd b gz z fq op fs ft oq fv fx dk translated">"你如何证明遵循干净的代码实践来编写更多的代码是合理的？"这是我现在看到有人问的问题，而且…</h3></div><div class="os l"><p class="bd b dl z fq op fs ft oq fv fx dk translated">understandlegacycode.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy kq ok"/></div></div></a></div><div class="oh oi gq gs oj ok"><a href="https://andrewbrookins.com/technology/the-rule-of-three/" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fp"><div class="om ab on cl cj oo"><h2 class="bd is gz z fq op fs ft oq fv fx iq bi translated">三的法则——安德鲁·布鲁金斯</h2><div class="or l"><h3 class="bd b gz z fq op fs ft oq fv fx dk translated">许多程序员渴望在开发过程的早期创建可重用的组件。我知道我有！那么为什么…</h3></div><div class="os l"><p class="bd b dl z fq op fs ft oq fv fx dk translated">andrewbrookins.com</p></div></div><div class="ot l"><div class="oz l ov ow ox ot oy kq ok"/></div></div></a></div><div class="oh oi gq gs oj ok"><a href="https://sandimetz.com/blog/2016/1/20/the-wrong-abstraction" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fp"><div class="om ab on cl cj oo"><h2 class="bd is gz z fq op fs ft oq fv fx iq bi translated">错误的抽象——桑迪·梅茨</h2><div class="or l"><h3 class="bd b gz z fq op fs ft oq fv fx dk translated">我一直在思考“错误抽象”的后果我的RailsConf 2014“所有小事”讲座…</h3></div><div class="os l"><p class="bd b dl z fq op fs ft oq fv fx dk translated">sandimetz.com</p></div></div><div class="ot l"><div class="pa l ov ow ox ot oy kq ok"/></div></div></a></div></div><div class="ab cl nf ng hv nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ik il im in io"><p id="8dba" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">相关文章:</p><div class="oh oi gq gs oj ok"><a href="https://levelup.gitconnected.com/what-is-a-specification-pattern-460b32bfbf7b" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fp"><div class="om ab on cl cj oo"><h2 class="bd is gz z fq op fs ft oq fv fx iq bi translated">什么是规格模式？</h2><div class="or l"><h3 class="bd b gz z fq op fs ft oq fv fx dk translated">用规格模式解开代码</h3></div><div class="os l"><p class="bd b dl z fq op fs ft oq fv fx dk translated">levelup.gitconnected.com</p></div></div><div class="ot l"><div class="pb l ov ow ox ot oy kq ok"/></div></div></a></div><div class="oh oi gq gs oj ok"><a href="https://medium.com/dev-genius/how-to-avoid-anemic-domain-model-59775c639678" rel="noopener follow" target="_blank"><div class="ol ab fp"><div class="om ab on cl cj oo"><h2 class="bd is gz z fq op fs ft oq fv fx iq bi translated">如何避免贫血的域名模型？</h2><div class="or l"><h3 class="bd b gz z fq op fs ft oq fv fx dk translated">如何处理业务逻辑，并避免贫血的领域模型。</h3></div><div class="os l"><p class="bd b dl z fq op fs ft oq fv fx dk translated">medium.com</p></div></div><div class="ot l"><div class="pc l ov ow ox ot oy kq ok"/></div></div></a></div><div class="oh oi gq gs oj ok"><a href="https://levelup.gitconnected.com/how-to-develop-better-program-structure-3a57f48bf971" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fp"><div class="om ab on cl cj oo"><h2 class="bd is gz z fq op fs ft oq fv fx iq bi translated">如何开发更好的程序结构？</h2><div class="or l"><h3 class="bd b gz z fq op fs ft oq fv fx dk translated">改善程序结构的几个简单技巧</h3></div><div class="os l"><p class="bd b dl z fq op fs ft oq fv fx dk translated">levelup.gitconnected.com</p></div></div><div class="ot l"><div class="pd l ov ow ox ot oy kq ok"/></div></div></a></div></div></div>    
</body>
</html>