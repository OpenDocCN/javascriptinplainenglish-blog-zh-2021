<html>
<head>
<title>Implement Dark Mode with React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React实现黑暗模式</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/implementing-dark-mode-reactjs-2fba91cda7f2?source=collection_archive---------4-----------------------#2021-01-17">https://javascript.plainenglish.io/implementing-dark-mode-reactjs-2fba91cda7f2?source=collection_archive---------4-----------------------#2021-01-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="6921" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用React在应用程序中实现暗/亮模式主题</h2></div><p id="284b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">顾名思义，这个博客是关于在使用React的应用程序中实现暗/亮模式主题的。我相信你已经意识到了应用程序中的明暗主题。</p><p id="8220" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky">亮模式:指</em> <strong class="ke io"> <em class="ky">暗</em></strong><em class="ky">-字体文本上</em> <strong class="ke io"> <em class="ky">亮</em> </strong> <em class="ky">背景(正对比极性)</em></p><p id="ade5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky">暗模式:表示组合</em> <strong class="ke io"> <em class="ky">亮</em> </strong> <em class="ky">(如白色)文字上</em> <strong class="ke io"> <em class="ky">暗</em> </strong> <em class="ky">(如黑色)背景(负对比极性)。</em></p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi kz"><img src="../Images/85a962b3c30f121aee427b2ae7cfeed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FAkv1HES4yy8ACi1BgOaxg.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">In Mac, we can set Dark or Light theme from &lt;System Preferences -&gt; General&gt;</figcaption></figure><p id="5417" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这两个主题有一些优点，可以在移动设备上配置，也可以在桌面上配置。在大多数设备中，我们可以从<code class="fe lp lq lr ls b">Setting-&gt; Display-&gt; THEME</code>开始更改暗/亮模式。或者，我们也可以在网站中添加切换功能，明确地在亮暗主题之间切换。</p><p id="2175" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为什么它很重要？当一个网站有黑暗模式主题时，有几点可以让它变得更好:</p><ul class=""><li id="d120" class="lt lu in ke b kf kg ki kj kl lv kp lw kt lx kx ly lz ma mb bi translated">它为视力低下和对强光敏感的用户提高了可见度。</li><li id="c075" class="lt lu in ke b kf mc ki md kl me kp mf kt mg kx ly lz ma mb bi translated">让任何人都能更轻松地在弱光环境中使用设备。</li></ul><p id="207b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果我谈论实现部分，我已经使用了<code class="fe lp lq lr ls b"><a class="ae mh" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia" rel="noopener ugc nofollow" target="_blank">window.matchMedia</a></code>来检查主题<code class="fe lp lq lr ls b"><a class="ae mh" href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme" rel="noopener ugc nofollow" target="_blank">prefers-color-scheme</a></code>。</p><pre class="la lb lc ld gt mi ls mj mk aw ml bi"><span id="4743" class="mm mn in ls b gy mo mp l mq mr">// EventListener when mode/theme is changed</span><span id="9afa" class="mm mn in ls b gy ms mp l mq mr">window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event =&gt; {<br/>  if (event.matches) {<br/>    // set <strong class="ls io">mode</strong> state to Dark here<br/>  } else {<br/>    // set <strong class="ls io">mode</strong> state to Light here<br/>  }<br/>});</span></pre><p id="c965" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">上面的代码是一个监听器，它检查事件<code class="fe lp lq lr ls b">(prefers-color-scheme: dark)</code>中是否有变化。因此，如果系统主题是黑暗的，那么<code class="fe lp lq lr ls b">if</code>条件为真，我们可以将<strong class="ke io">模式</strong>状态切换到<code class="fe lp lq lr ls b">Dark</code>，否则在else语句中，我们可以将状态切换到<code class="fe lp lq lr ls b">Light</code>模式。</p><p id="e240" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我使用相同的事件<code class="fe lp lq lr ls b"><em class="ky">window.matchMedia('(prefers-color-scheme: dark)')</em></code> <em class="ky"> </em>来设置我的应用程序中的默认主题状态，如下所示:</p><pre class="la lb lc ld gt mi ls mj mk aw ml bi"><span id="471a" class="mm mn in ls b gy mo mp l mq mr">// To set default value when page is refreshed</span><span id="775c" class="mm mn in ls b gy ms mp l mq mr">let defaultMode = 'light';<br/>if (window.matchMedia('(prefers-color-scheme: dark)').matches) {<br/>  defaultMode = 'dark';<br/>}</span></pre><p id="a6fa" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，如果系统设置已经设置为暗，则<code class="fe lp lq lr ls b"><em class="ky">if (window.matchMedia('(prefers-color-scheme: dark)').matches)</em></code>条件被评估为真，应用默认模式被设置为<strong class="ke io">暗。</strong></p><p id="4efa" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们实现下面的例子，如果设置从亮到暗，背景颜色应该从白色变成黑色，文本颜色从黑色变成白色，以防主题从亮到暗。</p><p id="35b2" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">灯光主题(左图):背景色:白色，文字色:黑色。</p><p id="19d6" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">深色主题(右图):背景色:黑色，文字色:白色。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi mt"><img src="../Images/ec485a97c97fda587e7ba2eb13db9f6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VwW2aY52FlE70JvK7WIcrw.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Example for Dark and Light theme.</figcaption></figure><p id="6763" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先在应用程序中添加一个上下文。</p><p id="9f80" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里context有两个键<em class="ky">模式</em>(主题值:暗/亮)和<em class="ky">切换(</em>功能切换模式<em class="ky">)。</em></p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="30f7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后我们可以创建一个保持<strong class="ke io">模式</strong>状态的<code class="fe lp lq lr ls b">useDarkmode</code>钩子，并在body上设置样式。然后，我们将在我们的提供者中使用这个函数，如下所述。</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="7057" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这个文件中，我们添加了一个使用<code class="fe lp lq lr ls b">useDarkmode</code>和<code class="fe lp lq lr ls b">darkModeContext</code>的提供者</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="5579" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们有了维护暗/亮模式的代码，我们只需要在我们的应用程序中使用上面的代码，这样它就可以在我们的应用程序中工作。</p><p id="7e08" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要完成该功能，请像这样将您的应用程序包装在提供程序中(<strong class="ke io">应用程序文件</strong>):</p><pre class="la lb lc ld gt mi ls mj mk aw ml bi"><span id="f8ac" class="mm mn in ls b gy mo mp l mq mr">import React from 'react';<br/>import { object } from 'prop-types';<br/>import DarkProvider from './darkModeProvider';<br/>import MainComponent from './mainComponent';</span><span id="dc5b" class="mm mn in ls b gy ms mp l mq mr">function App({ history, client }) {<br/>  return (<br/>    &lt;DarkProvider&gt;<br/>      &lt;MainComponent /&gt;<br/>    &lt;/DarkProvider&gt;<br/>  );<br/>}</span><span id="07a7" class="mm mn in ls b gy ms mp l mq mr">App.propTypes = {<br/>  client: object.isRequired,<br/>  history: object.isRequired,<br/>};</span><span id="c080" class="mm mn in ls b gy ms mp l mq mr">export default App;</span></pre><p id="7656" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你的<code class="fe lp lq lr ls b">MainComponent</code>是这样的(<strong class="ke io"> mainComponent.js文件</strong></p><pre class="la lb lc ld gt mi ls mj mk aw ml bi"><span id="f013" class="mm mn in ls b gy mo mp l mq mr">import React from 'react';<br/>import { useDarkmodeContext } from './darkModeProvider';<br/>import { setThemeMode } from './styles';</span><span id="5396" class="mm mn in ls b gy ms mp l mq mr">const MainComponent = () =&gt; {<br/>  const { mode } = useDarkmodeContext();<br/>  const themeMode = mode || 'light';<br/>  const css = setThemeMode(themeMode);</span><span id="f8ae" class="mm mn in ls b gy ms mp l mq mr">return (<br/>      &lt;div className={css.container}&gt;<br/>        &lt;div&gt;<br/>          &lt;div className={css.emptySearchHeading}&gt;<br/>            {themeMode?.toUpperCase()} THEME<br/>          &lt;/div&gt;<br/>          &lt;div className={css.emptySearchText}&gt;<br/>            Demo...<br/>          &lt;/div&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>  );<br/>};<br/>export default MainComponent;</span></pre><p id="4d1a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在上面的文件中<code class="fe lp lq lr ls b">useDarkmodeContext</code>得到<strong class="ke io">模式</strong>状态是亮还是暗。在这种状态下，我们可以在styles.js文件中设置我们的主题。像下面提到的(<strong class="ke io"> styles.js文件</strong>):</p><pre class="la lb lc ld gt mi ls mj mk aw ml bi"><span id="c57d" class="mm mn in ls b gy mo mp l mq mr">import { css } from 'react-emotion';<br/>import { Theme } from './colors';</span><span id="b3b0" class="mm mn in ls b gy ms mp l mq mr">// set colors dynamically based on the <strong class="ls io">mode</strong> from <strong class="ls io">Theme</strong><br/>// color: ${Theme[mode].blackNewRgba};</span><span id="7e30" class="mm mn in ls b gy ms mp l mq mr">export const setThemeMode = mode =&gt; {<br/>  return {<br/>    container: css`<br/>      display: flex;<br/>      padding: 16px;<br/>      justify-content: center;<br/>      background: ${Theme[mode].containerColor};<br/>    `,<br/>    emptySearchHeading: css`<br/>      font-size: 16px;<br/>      color: ${Theme[mode].headingColor};<br/>      text-align: center;<br/>      font-weight: bold;<br/>    `,<br/>    emptySearchText: css`<br/>      font-size: 12px;<br/>      color: ${Theme[mode].textColor};<br/>      text-align: center;<br/>    `,<br/>  };<br/>};</span></pre><p id="da8a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">主题对象包含亮暗模式的所有颜色变体。我们可以在下面查看这个目标代码(<strong class="ke io">)。/colors.js </strong>)。</p><pre class="la lb lc ld gt mi ls mj mk aw ml bi"><span id="fb17" class="mm mn in ls b gy mo mp l mq mr">// Base color<br/>export const headingColor = 'rgba(49, 53, 59, 0.96)';<br/>export const textColor = `rgba(49, 53, 59, 0.68)`;<br/>export const containerColor = '#ffffff';</span><span id="55ce" class="mm mn in ls b gy ms mp l mq mr">const lightTheme = {<br/>  headingColor,<br/>  textColor,<br/>  containerColor,<br/>};</span><span id="ff5f" class="mm mn in ls b gy ms mp l mq mr">const darkTheme = {<br/>  headingColor: '#ffffff',<br/>  textColor : '#ffffff',<br/>  containerColor: '#000',<br/>};</span><span id="5deb" class="mm mn in ls b gy ms mp l mq mr">export const Theme = {<br/>  light: lightTheme,<br/>  dark: darkTheme,<br/>};</span></pre><p id="0687" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，我们从这个文件中导出<strong class="ke io">主题</strong>对象，如:</p><pre class="la lb lc ld gt mi ls mj mk aw ml bi"><span id="7d19" class="mm mn in ls b gy mo mp l mq mr">export const Theme = {<br/>  light: lightTheme,<br/>  dark: darkTheme,<br/>};</span></pre><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi mw"><img src="../Images/e7d094b350f8c02d3821af3510acae8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*a9q16Aqg0bjjXCgkUKP0HQ.gif"/></div></div></figure><h2 id="aa98" class="mm mn in bd mx my mz dn na nb nc dp nd kl ne nf ng kp nh ni nj kt nk nl nm nn bi translated">结论</h2><p id="0873" class="pw-post-body-paragraph kc kd in ke b kf no jo kh ki np jr kk kl nq kn ko kp nr kr ks kt ns kv kw kx ig bi translated">我希望这能有所帮助。也许我们可以使用不同的方法来设置主题，比如使用状态管理库或者只使用css。请随时与我分享您的实现:)。</p></div></div>    
</body>
</html>