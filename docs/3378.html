<html>
<head>
<title>The Best Way to Add Dark Mode to Your React/Sass Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将黑暗模式添加到React/Sass项目的最佳方式</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-best-way-to-add-dark-mode-to-your-react-sass-project-ce3ae3bd8616?source=collection_archive---------2-----------------------#2021-07-09">https://javascript.plainenglish.io/the-best-way-to-add-dark-mode-to-your-react-sass-project-ce3ae3bd8616?source=collection_archive---------2-----------------------#2021-07-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/3467760b0fb5f872d4c42032e5469ca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N5nT2H-_5bJNYwR1DsVqkA.png"/></div></div></figure><p id="47eb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<a class="ae kt" rel="noopener ugc nofollow" target="_blank" href="/5-steps-to-implement-maintainable-and-scalable-sass-theming-in-complex-projects-76bb6da0a8e6">的上一篇文章</a>中，我写了关于Sass的最佳实践，其中我介绍了如何将主题切换添加到以Sass为主题的项目中。不幸的是，该教程只涵盖了事情的Sass方面。在本文中，我将向您介绍我认为将主题化方法集成到React项目中的最干净的方法。</p><h2 id="0376" class="ku kv in bd kw kx ky dn kz la lb dp lc kg ld le lf kk lg lh li ko lj lk ll lm bi translated">主题化萨斯之路</h2><p id="98ae" class="pw-post-body-paragraph jv jw in jx b jy ln ka kb kc lo ke kf kg lp ki kj kk lq km kn ko lr kq kr ks ig bi translated">对于那些没有读过我写的关于Sass最佳实践的文章的人来说，我将把Sass代码留在这里(但实际上，你应该去读一读，因为它很有趣)。我不会在这里过多地解释代码。</p><figure class="ls lt lu lv gt jo"><div class="bz fp l di"><div class="lw lx l"/></div></figure><figure class="ls lt lu lv gt jo"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="48e2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在我们进入React代码之前，用这个方法要注意的一件重要事情是Sass被编译成<code class="fe ly lz ma mb b">.theme — {value} .classname</code> CSS代码。这意味着为了切换目标类的主题，您需要用一个具有类名<code class="fe ly lz ma mb b">theme — {value}</code>的div来包装整个react项目，以便在整个应用程序中启用主题化。</p><h2 id="5f7f" class="ku kv in bd kw kx ky dn kz la lb dp lc kg ld le lf kk lg lh li ko lj lk ll lm bi translated">有哪些问题？</h2><p id="96df" class="pw-post-body-paragraph jv jw in jx b jy ln ka kb kc lo ke kf kg lp ki kj kk lq km kn ko lr kq kr ks ig bi translated">这种主题切换方法初看起来可能很简单，但是有一个警告。您用来进行主题切换的组件可能深深地嵌套在应用程序的组件树中。这意味着在顶层组件中使用<code class="fe ly lz ma mb b">useState</code>会很麻烦(因为主题div必须位于顶层组件中),并将当前主题值和设置的主题函数传递给主题设置器组件。</p><p id="c44b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果我是React的新成员，我会犯的一个错误是，我会尝试编写自己的名为<code class="fe ly lz ma mb b">useTheme</code>的钩子，并让它返回值和主题设置函数。然后，我会尝试使用顶层的钩子和主题设置组件。这种方法的问题是，你必须记住，每次在组件内部使用这个钩子时，它都是创建的钩子的一个单独的实例，彼此之间没有记忆。然而，这种思路已经接近正确的解决方案。</p><h2 id="a183" class="ku kv in bd kw kx ky dn kz la lb dp lc kg ld le lf kk lg lh li ko lj lk ll lm bi translated">救援的背景</h2><p id="5d63" class="pw-post-body-paragraph jv jw in jx b jy ln ka kb kc lo ke kf kg lp ki kj kk lq km kn ko lr kq kr ks ig bi translated">上下文是一种反应方式，允许在组件树中的任何地方使用状态，而不必将其作为道具传递下去。它的工作原理与我之前描述的惊人地相似，所以让我们看看如何在你的应用中设置它。</p><figure class="ls lt lu lv gt jo"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="2ab8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">正如你从GitHub要点中看到的，你首先使用<code class="fe ly lz ma mb b">React.createContext</code>创建一个上下文，传递初始的主题设置——你不需要这样做，但这是一个很好的实践。然后，在你的应用程序的顶层，你必须用<code class="fe ly lz ma mb b">ThemeContext.Provider</code>包装它，你将在你的主题和setTheme函数的当前状态中传递它——这是在使用<code class="fe ly lz ma mb b">useContext</code>的组件中返回的值。</p><p id="cf4b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在主题设置组件中，我想在这种情况下使用下拉菜单，但切换按钮也应该工作。在这个组件中，我们使用<code class="fe ly lz ma mb b">useContext</code>钩子获取当前主题值，并使用setTheme函数正确显示下拉菜单的状态，并在用户选择新主题时设置主题。</p><p id="8453" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">就是这样，你现在有了一个黑暗主题，应该可以在你的应用程序中添加任意数量的主题。</p><h2 id="dee7" class="ku kv in bd kw kx ky dn kz la lb dp lc kg ld le lf kk lg lh li ko lj lk ll lm bi translated">我们可以做得更好</h2><p id="57ed" class="pw-post-body-paragraph jv jw in jx b jy ln ka kb kc lo ke kf kg lp ki kj kk lq km kn ko lr kq kr ks ig bi translated">我讨厌教程半途而废，而且从来没有展示代码在实际应用中的样子，所以让我们尝试重构和拆分我们的代码，使其“为生产做好准备”。</p><p id="b845" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，让我们将主题上下文提供者简化成一个组件，这样我们就不会弄乱应用程序的顶层组件。</p><figure class="ls lt lu lv gt jo"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="3a7c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">正如您在这里看到的，这个版本的主题提供者将状态逻辑抽象到一个React组件中，这样我们就不必担心顶级组件中的状态。该实现还将主题状态存储在本地存储中，这样当用户刷新或返回到您的站点时，他们将看到他们喜欢的主题，从而带来更好的用户体验。要使用该组件，您只需将它包装在您的应用程序组件中:</p><figure class="ls lt lu lv gt jo"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="e87e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">ThemeContext和ThemeSetter当然和以前一样，但是在它们自己的文件中:</p><figure class="ls lt lu lv gt jo"><div class="bz fp l di"><div class="lw lx l"/></div></figure><figure class="ls lt lu lv gt jo"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="a1ee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当然，我已经创建了一个CodeSandox，这样你就可以玩代码了:</p><figure class="ls lt lu lv gt jo"><div class="bz fp l di"><div class="mc lx l"/></div></figure><h2 id="c879" class="ku kv in bd kw kx ky dn kz la lb dp lc kg ld le lf kk lg lh li ko lj lk ll lm bi translated">好了</h2><p id="dd1b" class="pw-post-body-paragraph jv jw in jx b jy ln ka kb kc lo ke kf kg lp ki kj kk lq km kn ko lr kq kr ks ig bi translated">这实际上是我如何在我正在工作的应用程序中实现主题切换的，我认为它工作得非常好。希望你在本教程中学到了一些东西，并在评论中让我知道你的想法。</p><p id="c643" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="md">更多内容尽在</em><a class="ae kt" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="md">plain English . io</em></strong></a></p></div></div>    
</body>
</html>