<html>
<head>
<title>React Lifecycle Methods in Functional Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在功能组件中反应生命周期方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-lifecycle-methods-in-functional-components-db72e038bd2a?source=collection_archive---------0-----------------------#2021-10-10">https://javascript.plainenglish.io/react-lifecycle-methods-in-functional-components-db72e038bd2a?source=collection_archive---------0-----------------------#2021-10-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="3b52" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">让我们理解React生命周期方法如何与功能组件一起工作。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/cf643d56231d122f70750e89e16b9e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GM2K74SM_OUffP4uGV48_A.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">React Component Life cycle</figcaption></figure><h1 id="1d40" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">React组件的生命周期:</h1><ol class=""><li id="5db4" class="lk ll in lm b ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">初始渲染或挂载</li><li id="2b3b" class="lk ll in lm b ln mc lp md lr me lt mf lv mg lx ly lz ma mb bi translated">更新(当组件中使用的状态或添加到组件中的属性改变时)</li><li id="72be" class="lk ll in lm b ln mc lp md lr me lt mf lv mg lx ly lz ma mb bi translated">卸载</li></ol><p id="3f16" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated"><a class="ae mw" href="https://codesandbox.io/s/simple-counter-for-lifecycle-demo-gzxfw?file=/src/components/PureComponentDemo/PureComponent.tsx" rel="noopener ugc nofollow" target="_blank"> <strong class="lm io">此处代码可用</strong> </a></p><h2 id="6948" class="mx kt in bd ku my mz dn ky na nb dp lc lr nc nd le lt ne nf lg lv ng nh li ni bi translated">我们将只研究那些在大多数场景中使用的生命周期方法。有些方法在<a class="ae mw" href="https://reactjs.org/docs/react-component.html#the-component-lifecycle" rel="noopener ugc nofollow" target="_blank"> React文档</a>中被称为很少使用，建议谨慎使用。</h2><p id="37a9" class="pw-post-body-paragraph mh mi in lm b ln lo jo mk lp lq jr mm lr nj mo mp lt nk mr ms lv nl mu mv lx ig bi translated">1.初始渲染或挂载</p><pre class="kd ke kf kg gt nm nn no np aw nq bi"><span id="f868" class="mx kt in nn b gy nr ns l nt nu">// Merge of componentDidMount and componentDidUpdate<br/>useEffect(() =&gt; {<br/> console.log(“This is mounted or updated.”);<br/>});</span></pre><p id="e323" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">在useEffect的这个变体中，当组件被挂载时，以及每次组件状态或props被更新时，都将打印该消息。</p><p id="9bd2" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">2.更新</p><pre class="kd ke kf kg gt nm nn no np aw nq bi"><span id="e4ac" class="mx kt in nn b gy nr ns l nt nu">// Equivalent of componentDidMount<br/> useEffect(() =&gt; {<br/>   console.log(“This is mounted only not updated.”);<br/> }, []);</span></pre><p id="ba3e" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">在此变体中，在组件的生命周期中，该消息将仅打印一次，并且是在组件安装之后。</p><pre class="kd ke kf kg gt nm nn no np aw nq bi"><span id="7f4d" class="mx kt in nn b gy nr ns l nt nu">// Merge of componentDidMount and componentDidUpdate but only for given dependency</span><span id="e6b2" class="mx kt in nn b gy nv ns l nt nu"> useEffect(() =&gt; {<br/>   console.log(“This is mounted or count state updated.”);<br/> }, [count]);</span></pre><p id="862a" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">在这个变体中，当组件被安装并且每次计数状态被改变时，该消息将被打印。</p><p id="8ea7" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">3.卸载</p><pre class="kd ke kf kg gt nm nn no np aw nq bi"><span id="c14e" class="mx kt in nn b gy nr ns l nt nu">// Equivalent of componentWillUnmount<br/> useEffect(() =&gt; {<br/>   return () =&gt; {<br/>     console.log(“This is unmounted.”);<br/>   };<br/> }, []);</span></pre><p id="cd24" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">如果我们不希望在组件安装或更新时发生任何副作用，而只是在卸载组件时，那么我们可以使用这个变量。</p><p id="cfe9" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated"><a class="ae mw" href="https://codesandbox.io/s/simple-counter-for-lifecycle-demo-gzxfw?file=/src/components/PureComponentDemo/PureComponent.tsx" rel="noopener ugc nofollow" target="_blank"> <strong class="lm io">此处代码可用</strong> </a></p><h1 id="f1b7" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">控制重新渲染:纯组件</h1><p id="9061" class="pw-post-body-paragraph mh mi in lm b ln lo jo mk lp lq jr mm lr nj mo mp lt nk mr ms lv nl mu mv lx ig bi translated">控制组件重新呈现的方法之一是使用“React.memo”高阶组件。</p><p id="f201" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">React.memo使用记忆化。它<strong class="lm io">浅显的</strong>将之前的道具与当前的道具进行对比，判断道具是否有变化。如果它们被更改，那么组件将被重新渲染。</p><p id="da49" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">我们可以向React.memo提供自定义比较器，也可以自定义比较。</p><p id="9f0d" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">PureComponent.tsx</p><pre class="kd ke kf kg gt nm nn no np aw nq bi"><span id="0b2e" class="mx kt in nn b gy nr ns l nt nu">import React from "react";<br/>​<br/>const RegularComponent = (props: any) =&gt; {<br/>  console.log("***Pure component is rendered***");<br/>  return &lt;p&gt;Pure Component = {props.name.firstName}&lt;/p&gt;;<br/>};<br/>​<br/>const PureComponent = React.memo(RegularComponent);<br/>​<br/>export {PureComponent};</span></pre><p id="9b3f" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">或使用比较仪:</p><pre class="kd ke kf kg gt nm nn no np aw nq bi"><span id="c3c4" class="mx kt in nn b gy nr ns l nt nu">import React from "react";<br/>​<br/>const PureComponent = React.memo(<br/>  (props: any) =&gt; {<br/>    console.log("***Pure component is rendered***");<br/>    return &lt;p&gt;Pure Component = {props.name.firstName}&lt;/p&gt;;<br/>  },<br/>  (prevProps, nextProps) =&gt; {<br/>    /*<br/>    return true if passing nextProps to render would return<br/>    the same result as passing prevProps to render,<br/>    otherwise return false<br/>    */<br/>    if (prevProps.name.firstName === nextProps.name.firstName) return true;<br/>    return false;<br/>  }<br/>);<br/>​<br/>export { PureComponent };</span></pre><p id="e166" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">正则组件. tsx</p><pre class="kd ke kf kg gt nm nn no np aw nq bi"><span id="3a71" class="mx kt in nn b gy nr ns l nt nu">import React from "react";<br/>​<br/>const RegularComponent = (props: any) =&gt; {<br/>  console.log("***Regular component is rendered***");<br/>​<br/>  return &lt;p&gt;Regular Component = {props.name.firstName}&lt;/p&gt;;<br/>};<br/>​<br/>export default RegularComponent;</span></pre><p id="d0a4" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">ParentComponent.tsx</p><pre class="kd ke kf kg gt nm nn no np aw nq bi"><span id="18f2" class="mx kt in nn b gy nr ns l nt nu">import React, { useState } from "react";<br/>import {PureComponent} from "./PureComponent";<br/>import RegularComponent from "./RegularComponent";<br/>​<br/>const ParentComponent = () =&gt; {<br/>  const [count, setCount] = useState&lt;number&gt;(0);<br/>  const [name, setName] = useState&lt;{ firstName: string }&gt;({<br/>    firstName: "Yogesh"<br/>  });<br/>​<br/>  console.log("*****Parent component is rendered*****");<br/>​<br/>  return (<br/>    &lt;&gt;<br/>      &lt;p&gt;Parent Component&lt;/p&gt;<br/>      &lt;button<br/>        onClick={() =&gt; {<br/>          setCount((c) =&gt; c + 1);<br/>        }}<br/>      &gt;<br/>        count = {count}<br/>      &lt;/button&gt;<br/>      &lt;button<br/>        onClick={() =&gt; {<br/>          setName({ firstName: "YPD" });<br/>        }}<br/>      &gt;<br/>        change name<br/>      &lt;/button&gt;<br/>      &lt;RegularComponent name={name} /&gt;<br/>      &lt;PureComponent name={name} /&gt;<br/>    &lt;/&gt;<br/>  );<br/>};<br/>​<br/>export default ParentComponent;</span></pre><p id="e6f0" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated"><a class="ae mw" href="https://codesandbox.io/s/simple-counter-for-lifecycle-demo-gzxfw?file=/src/components/PureComponentDemo/PureComponent.tsx" rel="noopener ugc nofollow" target="_blank"> <strong class="lm io">此处代码可用</strong> </a></p><p id="f0d4" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">感谢你的阅读！</p><div class="nw nx gp gr ny nz"><a rel="noopener  ugc nofollow" target="_blank" href="/react-context-do-you-really-need-it-this-will-help-you-decide-bcbdae589f70"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd io gy z fp oe fr fs of fu fw im bi translated">反应上下文:你真的需要它吗？这将帮助你决定！</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">如何创建一个反应上下文</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="oi l"><div class="oj l ok ol om oi on km nz"/></div></div></a></div><p id="ad82" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">参考资料:</p><p id="37fb" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">简单场景:<a class="ae mw" href="https://youtu.be/bZeBToIqaR4" rel="noopener ugc nofollow" target="_blank"> React.memo </a></p><p id="5ad9" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">对于控制组件重新渲染的更多场景，请使用下面的视频:<a class="ae mw" href="https://youtu.be/o-alRbk_zP0" rel="noopener ugc nofollow" target="_blank">如何在React中使用memo来优化渲染</a></p><p id="762b" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">此外，在使用memoization之前，请先阅读:<a class="ae mw" href="https://dmitripavlutin.com/use-react-memo-wisely/" rel="noopener ugc nofollow" target="_blank">再使用memo </a></p><p id="c08e" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated">【React生命周期方法概述</p><h2 id="4415" class="mx kt in bd ku my mz dn ky na nb dp lc lr nc nd le lt ne nf lg lv ng nh li ni bi translated">进一步阅读</h2><div class="nw nx gp gr ny nz"><a href="https://bit.cloud/blog/-extracting-and-reusing-pre-existing-components-using-bit-add-l28qlxpz" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd io gy z fp oe fr fs of fu fw im bi translated">使用位添加提取和重用预先存在的组件</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">最后，您完成了为应用程序中的输入创建一个奇妙的输入字段的任务。你对……很满意</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">比特云</p></div></div><div class="oi l"><div class="oo l ok ol om oi on km nz"/></div></div></a></div><p id="b4e3" class="pw-post-body-paragraph mh mi in lm b ln mj jo mk lp ml jr mm lr mn mo mp lt mq mr ms lv mt mu mv lx ig bi translated"><em class="op">更多内容看</em> <a class="ae mw" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lm io"> <em class="op">说白了就是</em> </strong> </a> <em class="op">。报名参加我们的</em> <a class="ae mw" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lm io"> <em class="op">免费周报</em> </strong> </a> <em class="op">。关注我们关于</em> <a class="ae mw" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="lm io"> <em class="op">推特</em> </strong> </a>，<a class="ae mw" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"> <strong class="lm io"> <em class="op">领英</em> </strong> </a> <strong class="lm io"> <em class="op">，</em></strong><a class="ae mw" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="lm io"><em class="op">YouTube</em></strong></a><strong class="lm io"><em class="op">，以及</em></strong><em class="op"/><a class="ae mw" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="lm io"><em class="op">不和</em> </strong> </a>  <em class="op">对成长黑客感兴趣？检查出</em> <a class="ae mw" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="lm io"> <em class="op">电路</em> </strong> </a> <strong class="lm io"> <em class="op">。</em>T71】</strong></p></div></div>    
</body>
</html>