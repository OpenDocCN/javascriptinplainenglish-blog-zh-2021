<html>
<head>
<title>The State of HMR in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">棱角分明的HMR</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/state-of-hmr-in-angular-b3c19b4ebc54?source=collection_archive---------4-----------------------#2021-02-17">https://javascript.plainenglish.io/state-of-hmr-in-angular-b3c19b4ebc54?source=collection_archive---------4-----------------------#2021-02-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><h2 id="07d7" class="il im in bd b dl io ip iq ir is it dk iu translated" aria-label="kicker paragraph">Angular 11.x中热模块更换的好与坏</h2><div class=""/><div class=""><h2 id="4a8d" class="pw-subtitle-paragraph jt iw in bd b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk dk translated">热模块替换加速了开发和调试。它是一个Webpack特性，可以更新已更改的模块，而无需重新加载整个页面。Angular 11通过在CLI中提供开箱即用的HMR，使其易于使用。</h2></div><p id="cb67" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">在开发和调试前端应用程序时，我们经常编辑组件样式、HTML模板、标签、文本等。在Angular中，我们习惯使用文件监视器，每次保存都会自动刷新页面。这是传统工具的升级，但我们失去了背景。我们可能需要重复几个步骤才能到达works中的屏幕。</p><p id="1336" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">HMR有点神奇。Webpack Dev服务器特性在应用程序运行时添加/删除模块。它允许有选择地更新开发人员更改的屏幕部分，而不会丢失状态/重新加载整个页面。</p><p id="3658" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">虽然在版本11之前可以在Angular中配置HMR，但是这个过程很麻烦。在最近的主要版本(11)中，Angular CLI提供了开箱即用的功能。</p><h2 id="b6f3" class="lh li in bd lj lk ll dn lm ln lo dp lp ku lq lr ls ky lt lu lv lc lw lx ly it bi translated">如何在你的项目中设置HMR？</h2><p id="45ac" class="pw-post-body-paragraph kl km in kn b ko lz jx kq kr ma ka kt ku mb kw kx ky mc la lb lc md le lf lg ig bi translated">要在启用HMR的情况下运行项目，请使用带有<code class="fe me mf mg mh b">ng serve</code>的<code class="fe me mf mg mh b">--hmr</code>标志。HMR只对开发版本有用。当我们用HMR进行调试实验时，在package.json中创建一个新的脚本来以传统方式运行应用程序是一个好主意。它提供了忽略hmr的选择。请考虑package.json中脚本下的以下代码片段。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4a94" class="lh li in mh b gy mq mr l ms mt">"start": "ng serve --hmr",  "// 1": "// yarn start (or npm start) uses HMR by default",</span><span id="3784" class="lh li in mh b gy mu mr l ms mt">"start:no-hmr": "ng serve", "// 2": "// if you choose to not use HMR, use this script.",</span></pre><p id="32ac" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">注意，默认情况下，我们使用启动脚本启用了HMR。我更喜欢这个选项，因为我们习惯于运行纱线启动(或npm启动)。将显示一条消息，表明HMR已启用。</p><figure class="mi mj mk ml gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mv"><img src="../Images/01bc86377130b8a4e305d0c98d62356b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1d9GTknBOc7THZ_35fCFOQ.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk">Figure 1: Run Angular project with HMR enabled</figcaption></figure><p id="e3d9" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">在某些情况下，HMR可能会令人讨厌。在这些情况下，使用纱线开始:no-hmr。</p><h2 id="6a46" class="lh li in bd lj lk ll dn lm ln lo dp lp ku lq lr ls ky lt lu lv lc lw lx ly it bi translated">HMR在行动</h2><p id="6e0f" class="pw-post-body-paragraph kl km in kn b ko lz jx kq kr ma ka kt ku mb kw kx ky mc la lb lc md le lf lg ig bi translated">为了演示HMR，构建了一个有两个屏幕的小应用程序。它按州列出了冠状病毒病例。单击一个州会出现一个详细信息屏幕，显示所选州的案例的附加信息。</p><div class="mi mj mk ml gt ab cb"><figure class="nh mw ni nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><img src="../Images/c0686c5975b6cf4cdb8bb9d8a2c2656e.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*1LJvCStwcF5RXfDstbngNg.png"/></div></figure><figure class="nh mw nn nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><img src="../Images/b007ca2b97477a50a074ee2660dfda5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*Ls1iqr4QNrviD5Q63cn3Jw.png"/></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk no di np nq">Figure 2: Sample Application</figcaption></figure></div><p id="75d9" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">想象选择一个州，导航到第二个屏幕。它预先填充了数据。对样式或模板的更改会刷新整个页面。对于每一项更改，我们都必须导航到该屏幕，以查看反映的更改。只有两个屏幕可能看起来不是问题。如果上下文是用几个先前的屏幕设置的，那么效率不高，而且很费时间。</p><p id="b2e0" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">使用HMR，无需重置表单即可刷新屏幕。它有助于更快地调试和开发屏幕。变化是实时可视化的。考虑以下短视频(演示)</p><figure class="mi mj mk ml gt mw"><div class="bz fp l di"><div class="nr ns l"/></div></figure><figure class="mi mj mk ml gt mw"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="9d46" class="lh li in bd lj lk ll dn lm ln lo dp lp ku lq lr ls ky lt lu lv lc lw lx ly it bi translated">有棱角的HMR还不完美呢！</h2><ul class=""><li id="4251" class="nt nu in kn b ko lz kr ma ku nv ky nw lc nx lg ny nz oa ob bi translated">在引擎盖下，对风格的改变会重新初始化整个应用程序。这导致服务调用再次触发，服务状态丢失并重新初始化。这种行为在某些情况下违背了HMR教的宗旨。点击<a class="ae oc" href="https://github.com/angular/angular-cli/issues/19867" rel="noopener ugc nofollow" target="_blank">此链接</a>查看Angular CLI Github repo中打开的问题。监控问题以获取功能更新。</li><li id="4362" class="nt nu in kn b ko od kr oe ku of ky og lc oh lg ny nz oa ob bi translated">在Angular应用程序中，重要的是取消订阅rxjs observables，关闭组件的ngOnDestory()中的websocket连接。如果不遵循良好做法，HMR会放大问题。由于HMR不会重新加载整个页面，因此可能会创建重复订阅，从而导致意外行为。阅读<a class="ae oc" href="https://dev.to/this-is-angular/things-to-watch-out-for-when-using-hmr-with-angular-50j7" rel="noopener ugc nofollow" target="_blank">这篇博客</a>了解更多。</li></ul><h2 id="2f83" class="lh li in bd lj lk ll dn lm ln lo dp lp ku lq lr ls ky lt lu lv lc lw lx ly it bi translated">代码示例</h2><p id="0c7d" class="pw-post-body-paragraph kl km in kn b ko lz jx kq kr ma ka kt ku mb kw kx ky mc la lb lc md le lf lg ig bi translated">点击<a class="ae oc" href="https://github.com/kvkirthy/covid-sample" rel="noopener ugc nofollow" target="_blank">这个链接</a>，克隆、安装并运行<a class="ae oc" href="https://github.com/kvkirthy/covid-sample" rel="noopener ugc nofollow" target="_blank">https://github.com/kvkirthy/covid-sample</a>一文中描述的代码示例</p><h2 id="1953" class="lh li in bd lj lk ll dn lm ln lo dp lp ku lq lr ls ky lt lu lv lc lw lx ly it bi translated">参考</h2><ol class=""><li id="d4b1" class="nt nu in kn b ko lz kr ma ku nv ky nw lc nx lg oi nz oa ob bi translated">关于https://webpack.js.org/concepts/hot-module-replacement/ HMR的Webpack文档—<a class="ae oc" href="https://webpack.js.org/concepts/hot-module-replacement/" rel="noopener ugc nofollow" target="_blank"/></li><li id="74a4" class="nt nu in kn b ko od kr oe ku of ky og lc oh lg oi nz oa ob bi translated">Angular博客:Angular第11版发布，<a class="ae oc" href="https://blog.angular.io/version-11-of-angular-now-available-74721b7952f7" rel="noopener ugc nofollow" target="_blank">https://Blog . Angular . io/Version-11-of-Angular-now-available-74721 b 7952 f 7</a></li><li id="0a5a" class="nt nu in kn b ko od kr oe ku of ky og lc oh lg oi nz oa ob bi translated">Angular CLI问题记录https://github.com/angular/angular-cli/issues/19867 HMR重新初始化整个应用程序<a class="ae oc" href="https://github.com/angular/angular-cli/issues/19867" rel="noopener ugc nofollow" target="_blank"/></li><li id="ce84" class="nt nu in kn b ko od kr oe ku of ky og lc oh lg oi nz oa ob bi translated">文章:使用带Angular - <a class="ae oc" href="https://dev.to/this-is-angular/things-to-watch-out-for-when-using-hmr-with-angular-50j7" rel="noopener ugc nofollow" target="_blank">的HMR时要注意的事项https://dev . to/this-is-Angular/this-to-watch-out-for-when-using-hmr-with-Angular-50j 7</a></li></ol></div></div>    
</body>
</html>