<html>
<head>
<title>React Native — Image Zooming with Gesture Handler</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Native —使用手势处理器缩放图像</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-native-image-zooming-with-gesture-handler-376193e3d3b4?source=collection_archive---------0-----------------------#2021-12-04">https://javascript.plainenglish.io/react-native-image-zooming-with-gesture-handler-376193e3d3b4?source=collection_archive---------0-----------------------#2021-12-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/22026744adceaa01aacb7e1577d6806b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eqxoAdseTE8qH_TBEPRc3g.jpeg"/></div></div></figure></div><div class="ab cl jv jw hr jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="ig ih ii ij ik"><p id="1680" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">对于每个移动开发者来说，<strong class="ke io">图片</strong>是带来更好插图的最重要元素之一。但是我们怎样才能获得特定图像的更多细节呢？变焦将是答案！</p><p id="8059" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">在学习React Native (RN)的时候，我发现React Native提供了一个简单明了的方法，叫做<a class="ae la" href="https://docs.swmansion.com/react-native-gesture-handler/docs/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io">手势处理程序</strong> </a> <strong class="ke io">。</strong>这个库有助于处理我们的电话系统和行为中的各种手势，就像本地人的手势一样。</p><h1 id="4a30" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">给我举个例子！🌸</h1><figure class="ma mb mc md gt jo gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/b5d7ff9a77b4858c0a096ddbbed1cf41.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/1*3ciqJQ_RhAsaSHe0JItXWA.gif"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk">Showcase for Image Zooming</figcaption></figure><p id="4431" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">以上显示了使用<strong class="ke io"> PanGestureHandler </strong>和<strong class="ke io"> PinchGestureHandler进行图像缩放的示例。</strong> PanGestureHandler用于左右移动图像，PinchGestureHandler用于放大/缩小图像。示例照片取自<a class="ae la" href="https://picsum.photos/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> Lorem Ipsum </strong> </a>。</p><h1 id="5394" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">如何归档？也给我看看代码！🐥</h1><ol class=""><li id="3bd6" class="mi mj in ke b kf mk kj ml kn mm kr mn kv mo kz mp mq mr ms bi translated">让我们声明一些有用的<strong class="ke io">变量</strong>。</li></ol><figure class="ma mb mc md gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mt"><img src="../Images/c9ffe0e16a490b820bfb70cd758c817e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i2ktyYV9XLgWT78ECTXKyA.png"/></div></div></figure><p id="de14" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated"><code class="fe mu mv mw mx b">scale</code>用于测量图像的缩放状态，默认值为1，<code class="fe mu mv mw mx b">translateX</code> &amp; <code class="fe mu mv mw mx b">translateY</code>用于测量左右平移。所有的变量都是使用<code class="fe mu mv mw mx b">useRef</code> &amp; <code class="fe mu mv mw mx b">Animated.Value()</code>创建的，这样所有这些值都可以被动画化，并在组件的整个生命周期内保持不变。</p><p id="a816" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">2.我们既要申报<strong class="ke io">潘&amp;捏事件</strong>。</p><figure class="ma mb mc md gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi my"><img src="../Images/d9dcc431eae450eb9be655fa4309cf19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*flk1FV0HDNGVt3edS1AsPg.png"/></div></div></figure><p id="3e5d" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated"><code class="fe mu mv mw mx b"><strong class="ke io">onPinchEvent</strong></code>会设置<code class="fe mu mv mw mx b">scale</code>值，同时<code class="fe mu mv mw mx b"><strong class="ke io">onPanEvent</strong></code>会将其两个<code class="fe mu mv mw mx b">translationX</code> &amp; <code class="fe mu mv mw mx b">translationY</code>分别设置为<code class="fe mu mv mw mx b">translateX</code> &amp; <code class="fe mu mv mw mx b">translateY</code>。这两个事件都被设置为<code class="fe mu mv mw mx b">useNativeDriver</code>，这意味着所有的动画都将被发送到本机代码，以便在UI线程上执行动画，而不必在每一帧上都通过桥。<a class="ae la" href="https://reactnative.dev/blog/2017/02/14/using-native-driver-for-animated" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io">此处</strong> </a>了解更多<code class="fe mu mv mw mx b">useNativeDriver</code>。</p><p id="55ad" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">3.构建我们的<strong class="ke io"> UI代码</strong>。</p><figure class="ma mb mc md gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mz"><img src="../Images/c856a59892d61d8161572ebbf1fcf69a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ZkOasiFnj7Gt5DqRLrMOg.png"/></div></div></figure><p id="70c4" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">我们将拥有<code class="fe mu mv mw mx b">&lt;Image&gt;</code>，但是将它转换成<code class="fe mu mv mw mx b">&lt;Animated.Image&gt;</code>，以便它能够接收动画变化。然后，用<code class="fe mu mv mw mx b">&lt;PinchGestureHandler&gt;</code> &amp; <code class="fe mu mv mw mx b">&lt;PanGestureHandler&gt;</code>把<code class="fe mu mv mw mx b">&lt;Image&gt;</code>包起来。在<code class="fe mu mv mw mx b">&lt;Image&gt;</code>中，将动画值放入<code class="fe mu mv mw mx b">style — transform</code>中，以便<code class="fe mu mv mw mx b">&lt;Image&gt;</code>知道要变换什么。</p><p id="fd0f" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">有一些重要的事情需要记下来:</p><ul class=""><li id="0fd9" class="mi mj in ke b kf kg kj kk kn na kr nb kv nc kz nd mq mr ms bi translated">当使用2个不同的手势处理程序时，必须用<code class="fe mu mv mw mx b">&lt;Animated.View&gt;</code>包裹子元素，否则什么都不会显示。</li><li id="07a6" class="mi mj in ke b kf ne kj nf kn ng kr nh kv ni kz nd mq mr ms bi translated">为每个手势处理器创建<code class="fe mu mv mw mx b">ref</code>,并将每个引用传入另一个手势处理器的<code class="fe mu mv mw mx b">simultaneousHandlers</code>,这样另一个就知道彼此的存在。</li></ul><p id="2160" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">4.一些<strong class="ke io">捏事件的增强</strong>。</p><p id="d12d" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">到目前为止，基本上，我们完成了我们的图像缩放代码。您可以运行代码，看看效果如何。然而，你会注意到，即使没有缩放，图像也可以被平移<strong class="ke io">并且<strong class="ke io">缩小事件会使图像变得非常小</strong>。</strong></p><ul class=""><li id="ff0a" class="mi mj in ke b kf kg kj kk kn na kr nb kv nc kz nd mq mr ms bi translated">为了解决平移图像而不缩放的问题，我们设置了一个<code class="fe mu mv mw mx b">panEnabled</code>状态来避免图像在缩放之前被平移。当收缩事件激活(持续)时，我们将<code class="fe mu mv mw mx b">panEnabled</code>设置为真。</li><li id="5a8f" class="mi mj in ke b kf ne kj nf kn ng kr nh kv ni kz nd mq mr ms bi translated">为了修复缩小到不可思议的小的图像，我们检查<code class="fe mu mv mw mx b">scale &lt; 1</code>，我们通过使用<code class="fe mu mv mw mx b">Animated.Spring</code>将所有的动画值重置回它们的原始值，以获得漂亮的跳跃效果。</li></ul><figure class="ma mb mc md gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nj"><img src="../Images/80fe1e06bf6d306e0c7bffb11229cc14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZDUy9KPClohWOfOO2E81ag.png"/></div></div></figure><p id="d2cf" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">我们完了！</p><h1 id="f111" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="0bb8" class="pw-post-body-paragraph kc kd in ke b kf mk kh ki kj ml kl km kn nk kp kq kr nl kt ku kv nm kx ky kz ig bi translated">这是我第一次尝试手势处理器，我甚至没有在原生Android中处理这样的动作。原生Android的手势处理对我来说要复杂得多，对于这种图像缩放，我总是会参考第三方库，而不是自己编写所有代码。</p><p id="fa4e" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated">仍然有许多不同的手势处理器可以使用，例如<code class="fe mu mv mw mx b">TapGestureHandler</code>、<code class="fe mu mv mw mx b">RotateGestureHandler</code>等。用母语学习感觉很好。如果我犯了什么错误，请给我反馈。感谢您花时间阅读我的文章。🧀</p><p id="78bd" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated"><strong class="ke io">完整源代码</strong></p><figure class="ma mb mc md gt jo"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="6992" class="pw-post-body-paragraph kc kd in ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ig bi translated"><em class="np">更多内容请看</em><a class="ae la" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="np">plain English . io</em></strong></a><em class="np">。报名参加我们的</em> <a class="ae la" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="np">免费周报</em> </strong> </a> <em class="np">。在我们的</em> <a class="ae la" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="np">社区</em> </strong> </a> <em class="np">获得独家获得写作机会和建议。</em></p></div></div>    
</body>
</html>