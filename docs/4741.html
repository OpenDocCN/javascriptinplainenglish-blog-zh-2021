<html>
<head>
<title>Building an Interactive JavaScript Connector Map</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建交互式JavaScript连接器映射</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/build-an-interactive-javascript-connector-map-62db24cc2fc4?source=collection_archive---------18-----------------------#2021-09-21">https://javascript.plainenglish.io/build-an-interactive-javascript-connector-map-62db24cc2fc4?source=collection_archive---------18-----------------------#2021-09-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/be642a0bfd80bdb95f316dd17d635837.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XQDsJTMVWz14TRX1JkCK3Q.png"/></div></div></figure><p id="b714" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">一个</strong> <a class="ae kt" href="https://www.anychart.com/chartopedia/chart-type/connector-map/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">连接器地图</strong> </a> <strong class="jx io">是一组连接地理地图上各点的直线或曲线。它通常用于以图形方式表示位置之间的路径或任何其他连接。您想了解如何为网页或应用程序构建一个有吸引力的数据可视化吗？</strong></p><p id="4811" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">实际上，使用JavaScript创建交互式连接器映射很容易。我现在就准备好让你见识一下！跟随本教程，我以JS连接器地图的形式描绘了<a class="ae kt" href="https://en.wikipedia.org/wiki/2021_Tour_de_France" rel="noopener ugc nofollow" target="_blank"> 2021环法自行车赛</a>的骑行路线，并彻底解释了所有步骤。</p><p id="0471" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里有一个预览，可以让你对这个旅程感到兴奋，这个漂亮的交互式JavaScript连接器地图将在本教程结束时构建完成！</p><figure class="kv kw kx ky gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ku"><img src="../Images/b82db0d281ed8e2c667b269d000f4b00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iw0qQTCj9FDlrgPy.png"/></div></div></figure><h1 id="2019" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">通过四个基本步骤创建JS连接器映射</h1><p id="c0d1" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">用JavaScript构建连接器图比其他基本图表要复杂一些。但是当我们使用一个JS图表库来创建它时，它就变得简单了。在本教程中，我将使用<a class="ae kt" href="https://www.anychart.com/" rel="noopener ugc nofollow" target="_blank"> AnyChart </a>，这是一个这样的库，它有一个特殊的<a class="ae kt" href="https://www.anychart.com/products/anymap/" rel="noopener ugc nofollow" target="_blank"> AnyMap </a>产品和良好的<a class="ae kt" href="https://docs.anychart.com/Maps/Quick_Start" rel="noopener ugc nofollow" target="_blank">映射文档</a>来帮助轻松开发连接器映射，我将从头到尾解释整个过程，以便您完全理解每一步和每一行代码是做什么的。</p><p id="1ed4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">准备好通过四个基本步骤构建一个令人惊叹的交互式JavaScript连接器地图。</p><h2 id="050d" class="mc la in bd lb md me dn lf mf mg dp lj kg mh mi ln kk mj mk lr ko ml mm lv mn bi translated">1.创建HTML页面</h2><p id="878e" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">首先，我需要一个空白的HTML页面来保存我的连接器映射。我在HTML页面的<code class="fe mo mp mq mr b">&lt;body&gt;</code>中添加了一个具有唯一id的<code class="fe mo mp mq mr b">&lt;div&gt;</code>元素，我将在后面引用它。</p><p id="66b8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我还使用<code class="fe mo mp mq mr b">&lt;style&gt;</code>标签将<code class="fe mo mp mq mr b">&lt;div&gt;</code>的宽度和高度设置为100%，以使我的地图适合整个屏幕。您可以根据需要调整这些参数。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="d5b6" class="mc la in mr b gy mw mx l my mz">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;JavaScript Connector Map&lt;/title&gt;<br/>    &lt;style type="text/css"&gt;      <br/>      html, body, #container { <br/>        width: 100%; height: 100%; margin: 0; padding: 0; <br/>      } <br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="28fe" class="mc la in bd lb md me dn lf mf mg dp lj kg mh mi ln kk mj mk lr ko ml mm lv mn bi translated">2.添加必要的脚本</h2><p id="feb8" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">我将使用AnyChart库，所以我需要在HTML页面的<code class="fe mo mp mq mr b">&lt;head&gt;</code>部分添加必要的JS脚本。</p><p id="5212" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了创建连接器映射，我需要AnyChart的'<a class="ae kt" href="https://docs.anychart.com/Quick_Start/Modules#core" rel="noopener ugc nofollow" target="_blank">核心</a>和'<a class="ae kt" href="https://docs.anychart.com/Quick_Start/Modules#geo_maps" rel="noopener ugc nofollow" target="_blank">映射</a>模块。此外，我还添加了法国的<a class="ae kt" href="https://www.anychart.com/download/cdn#geodata" rel="noopener ugc nofollow" target="_blank">地理数据</a>，因为路线点都在那里。</p><p id="3ddf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另一个用于包装地图相关附加功能的脚本是<a class="ae kt" href="http://proj4js.org/" rel="noopener ugc nofollow" target="_blank"> Proj4js </a>，这是一个JavaScript库，确保在适当的地理区域绘制坐标。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="5fee" class="mc la in mr b gy mw mx l my mz">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;JavaScript Connector Map&lt;/title&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-map.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/geodata/latest/countries/france/france.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.15/proj4.js"&gt;&lt;/script&gt;<br/>    &lt;style type="text/css"&gt;      <br/>      html, body, #container { <br/>        width: 100%; height: 100%; margin: 0; padding: 0; <br/>      } <br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;  <br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>    &lt;script&gt;<br/><strong class="mr io"><em class="na">      // All the code for the JS connector map will come here<br/></em></strong>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="ff30" class="mc la in bd lb md me dn lf mf mg dp lj kg mh mi ln kk mj mk lr ko ml mm lv mn bi translated">3.准备数据</h2><p id="e001" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">我从环法自行车赛的<a class="ae kt" href="https://www.letour.fr/en/overall-route" rel="noopener ugc nofollow" target="_blank">官方网站</a>收集自行车路线的数据。JS连接器映射要求数据采用特定的格式，所以我通过添加所需格式的数据创建了一个特定的数据集。你可以在这里查看文件<a class="ae kt" href="https://gist.githubusercontent.com/shacheeswadia/4a2e84185d754984681a89194b4282df/raw/ec70b11e8f68e5e6df60cff15bff8dd5b05ce22a/connector-map.json" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="2fd9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在连接器地图数据集中，要记住的主要事情是起点和终点由每个位置的纬度和经度定义，其中首先定义纬度，然后定义经度。供您参考，我从<a class="ae kt" href="https://www.latlong.net/" rel="noopener ugc nofollow" target="_blank">LatLong.net</a>获得了每个点的纬度和经度信息。</p><p id="00c6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了使用代码中的数据，我需要包含AnyChart JavaScript图表库附带的方便的<a class="ae kt" href="https://docs.anychart.com/Quick_Start/Modules#data_adapter" rel="noopener ugc nofollow" target="_blank">数据适配器</a>脚本来加载文件。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="84c9" class="mc la in mr b gy mw mx l my mz">&lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-data-adapter.min.js"&gt;&lt;/script&gt;</span></pre><h2 id="9e30" class="mc la in bd lb md me dn lf mf mg dp lj kg mh mi ln kk mj mk lr ko ml mm lv mn bi translated">4.编写JS代码来绘制连接器图</h2><p id="1715" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">现在是比赛的最后也是最重要的阶段，编写生成连接器映射本身的JavaScript代码主线。</p><p id="be94" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，我将所有代码都放在了<code class="fe mo mp mq mr b">anychart.onDocumentReady()</code>函数中，以确保只有在网页完全加载时才会执行。然后我使用<code class="fe mo mp mq mr b">anychart.data.loadJsonFile()</code>函数添加数据。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="b2e8" class="mc la in mr b gy mw mx l my mz">&lt;script&gt;<br/>  anychart.onDocumentReady(function () {<br/>    anychart.data.loadJsonFile(<br/>'https://gist.githubusercontent.com/shacheeswadia/4a2e84185d754984681a89194b4282df/raw/ec70b11e8f68e5e6df60cff15bff8dd5b05ce22a/connector-map.json', function (data) {<br/>    });<br/>  });<br/>&lt;/script&gt;</span></pre><p id="629f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了创建一个连接器地图，我使用了<code class="fe mo mp mq mr b">connector()</code>函数并设置了法国的地理数据。接下来，我只是为地图提供一个标题。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="8570" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// create a connector map chart<br/></em></strong>var map = anychart.connector();</span><span id="f5bb" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">// set the geodata for france<br/></em></strong>map.geoData('anychart.maps.france');</span><span id="de23" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">// add a title for the map<br/></em></strong>map<br/>  .title('Tour de France 2021 Route Map');</span></pre><p id="c489" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在显示连接之前，我使用<code class="fe mo mp mq mr b">marker()</code>功能标出了路线上的所有地点。我用圆形记号笔，用法国国旗的红色填充它。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="fc79" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// create a marker series for the place names<br/></em></strong>var citiesSeries = map<br/>  .marker(data[0]['citiesData'])<br/>  .type('circle')<br/>  .fill('#c51923')<br/>  .stroke(0);</span></pre><p id="8cd9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，我使用一个助手函数来表示各种连接，该函数接受地图、系列名称和数据。在本教程的后面你会看到为什么我制作了五个不同的系列。在helper函数中，我用<code class="fe mo mp mq mr b">connector()</code>函数创建了链接，并将线条的颜色设置为法国国旗的蓝色。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="a86c" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// create individual series<br/></em></strong>createSeries(map, 'Hilly', data[1]['hillyData']);<br/>createSeries(map, 'Mountain', data[2]['mountainData']);<br/>createSeries(map, 'Flat', data[3]['flatData']);<br/>createSeries(map, 'Individual Time Trial', data[4]['timeTrialData']);<br/>createSeries(map, 'Connector', data[5]['connectorData']);</span><span id="0077" class="mc la in mr b gy nb mx l my mz">...</span><span id="7fe0" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">// a helper function to create several series<br/></em></strong>function createSeries(map, name, data) {<br/><strong class="mr io"><em class="na">  // configure and customize the series<br/></em></strong>  var connectorSeries = map<br/>    .connector(data)<br/>    .stroke('#3e5ca6')<br/>    .fill('#3e5ca6');<br/>}</span></pre><p id="7c65" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在最后两步中，我引用容器div来显示图表和绘制地图。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="6160" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// set the container id for the map<br/></em></strong>map.container('container');</span><span id="b894" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">// command to draw the resulting connector map<br/></em></strong>map.draw();</span></pre><p id="b83f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">那是终点线！一个漂亮的JavaScript连接器图就全部做好了！</p><figure class="kv kw kx ky gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nc"><img src="../Images/501a7cc9150e3b15fe278e25421a0e94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AOs_Dm1iYGEHdycEn1oHOA.png"/></div></div></figure><blockquote class="nd ne nf"><p id="0251" class="jv jw na jx b jy jz ka kb kc kd ke kf ng kh ki kj nh kl km kn ni kp kq kr ks ig bi translated"><strong class="jx io">这里是完整的代码，你也可以在</strong> <a class="ae kt" href="https://playground.anychart.com/6Tsj5OI8/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> AnyChart游乐场</strong> </a> <strong class="jx io">上查看。</strong></p></blockquote><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="6828" class="mc la in mr b gy mw mx l my mz">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;JavaScript Connector Map&lt;/title&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-map.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/geodata/latest/countries/france/france.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.15/proj4.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-data-adapter.min.js"&gt;&lt;/script&gt;<br/>    &lt;style type="text/css"&gt;<br/>      html,<br/>      body,<br/>      #container {<br/>        width: 100%;<br/>        height: 100%;<br/>        margin: 0;<br/>        padding: 0;<br/>      }<br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>    &lt;script&gt;</span><span id="6f75" class="mc la in mr b gy nb mx l my mz">anychart.onDocumentReady(function () {</span><span id="328e" class="mc la in mr b gy nb mx l my mz">anychart.data.loadJsonFile(<br/>'https://gist.githubusercontent.com/shacheeswadia/4a2e84185d754984681a89194b4282df/raw/ec70b11e8f68e5e6df60cff15bff8dd5b05ce22a/connector-map.json', function (data) {</span><span id="2ab2" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // create a connector map chart<br/></em></strong>  var map = anychart.connector();</span><span id="fd1a" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // set the geodata for france<br/></em></strong>  map.geoData('anychart.maps.france');</span><span id="9186" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // add a title for the map<br/></em></strong>  map<br/>    .title('Tour de France 2021 Route Map');</span><span id="4271" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // create a marker series for the place names<br/></em></strong>  var citiesSeries = map<br/>    .marker(data[0]['citiesData'])<br/>    .type('circle')<br/>    .fill('#c51923')<br/>    .stroke(0);</span><span id="756e" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // create individual series<br/></em></strong>  createSeries(map, 'Hilly', data[1]['hillyData']);<br/>  createSeries(map, 'Mountain', data[2]['mountainData']);<br/>  createSeries(map, 'Flat', data[3]['flatData']);<br/>  createSeries(map, 'Individual Time Trial', data[4]['timeTrialData']);<br/>  createSeries(map, 'Connector', data[5]['connectorData']);</span><span id="077a" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // sets the container id for the map<br/></em></strong>  map.container('container');</span><span id="1ee2" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // command to draw the resulting connector map<br/></em></strong>  map.draw();</span><span id="3159" class="mc la in mr b gy nb mx l my mz">});<br/>});</span><span id="21ee" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">// a helper function to create several series<br/></em></strong>function createSeries(map, name, data) {<br/><strong class="mr io"><em class="na">  // configure and customize the series<br/></em></strong>  var connectorSeries = map<br/>    .connector(data)<br/>    .stroke('#3e5ca6')<br/>    .fill('#3e5ca6');<br/>}</span><span id="fda6" class="mc la in mr b gy nb mx l my mz">    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h1 id="b110" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">定制JavaScript连接器映射</h1><p id="40fc" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">我认为当前的连接器图看起来已经很棒了。但是我们当然可以包含更多的信息，也可以从美学角度对其进行改进。因此，请和我一起来看看如何定制基于JavaScript的连接器地图可视化，并让它变得更棒。</p><h2 id="05fa" class="mc la in bd lb md me dn lf mf mg dp lj kg mh mi ln kk mj mk lr ko ml mm lv mn bi translated">1.根据舞台路线地形设置颜色</h2><p id="22de" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">环法自行车赛的骑行路线穿过不同类型的地形，我想在连接器地图上用不同的颜色突出显示它们。这就是为什么我之前创建了五个不同的系列:现在我可以单独定制它们。</p><p id="3f68" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，我向helper函数添加了一个颜色参数，并在调用每个系列的函数时包含了各自的颜色代码。</p><p id="c301" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我还通过在辅助函数中设置笔画宽度值来增加连接线的宽度。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="8b2c" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// create individual series<br/></em></strong>createSeries(map, 'Hilly', data[1]['hillyData'], '#57ae12');<br/>createSeries(map, 'Mountain', data[2]['mountainData'], '#318053');<br/>createSeries(map, 'Flat', data[3]['flatData'], '#a4664d');<br/>createSeries(map, 'Individual Time Trial', data[4]['timeTrialData'], '#ef6c00');<br/>createSeries(map, 'Connector', data[5]['connectorData'], '#fac233');</span><span id="4f7f" class="mc la in mr b gy nb mx l my mz">...</span><span id="ea5d" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">// a helper function to create several series<br/></em></strong>function createSeries(map, name, data, color) {<br/><strong class="mr io"><em class="na">  // configure and customize the series<br/></em></strong>  var connectorSeries = map<br/>    .connector(data)<br/>    .stroke(function (d) {<br/>      return {<br/>        color: color,<br/>        thickness: 2<br/>      }<br/>    })<br/>    .fill(color);<br/>}</span></pre><p id="886e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后我修改了位置标记的颜色，将其从红色改为蓝色。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="d5a7" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// create a marker series for the place names<br/></em></strong>var citiesSeries = map<br/>  .marker(data[0]['citiesData'])<br/>  .type('circle')<br/>  .fill('#3e5ca6')<br/>  .stroke(0);</span></pre><p id="fe10" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因为我为不同的舞台类型添加了不同的颜色，所以我需要包含一个图例来表示哪种颜色代表哪种类型。您可以选择和取消选择图例项来显示或隐藏编码地形的路线，例如，单独的计时赛。</p><p id="9562" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，我添加了图例并排除了路线站点，因为它们都是相同的颜色。在助手函数中，我设置了图例的形状和颜色。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="6a0d" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// turn on the legend<br/></em></strong>map.legend(true);</span><span id="a664" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">// exclude cities from the legend<br/></em></strong>citiesSeries.legendItem(false);</span><span id="439b" class="mc la in mr b gy nb mx l my mz">...</span><span id="03ab" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">// set the legend shape and color<br/></em></strong>connectorSeries.legendItem({<br/>  iconType: 'circle',<br/>  iconFill: color<br/>});</span></pre><p id="41f7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你是初学者，乍一看可能会很复杂。但是这些快速的动作实际上增强了连接器图，使其信息量更大。所以不要让这些代码困扰你。加载，保持你的注意力，通过每一行来消化，你将能够掌握正在发生的事情。</p><h2 id="c1c5" class="mc la in bd lb md me dn lf mf mg dp lj kg mh mi ln kk mj mk lr ko ml mm lv mn bi translated">2.格式化标签</h2><p id="cef7" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">如果你注意到，在地图的最初版本中，地名与连接线有相当多的重叠。为了减少重叠并提高可读性，我调整了标签。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="fede" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// customize the labels for the city names series<br/></em></strong>citiesSeries<br/>  .labels()<br/>  .enabled(true)<br/>  .position('center-bottom')<br/>  .fontColor('#263238')<br/>  .offsetY(0)<br/>  .offsetX(5)<br/>  .anchor('left-center')<br/>  .format('{%name}');</span></pre><h2 id="0cb4" class="mc la in bd lb md me dn lf mf mg dp lj kg mh mi ln kk mj mk lr ko ml mm lv mn bi translated">3.更改连接线的曲率</h2><p id="e6ef" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">有一个选项可以通过将曲率归零来将连接器从默认的弧形线更改为直线。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="3569" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// configure and customize the series<br/></em></strong>var connectorSeries = map<br/>  .connector(data)<br/>  .stroke(function (d) {<br/>    return {<br/>      color: color,<br/>      thickness: 2<br/>    }<br/>  })<br/>  .fill(color)<br/>  .curvature(0);</span></pre><blockquote class="nd ne nf"><p id="8eaf" class="jv jw na jx b jy jz ka kb kc kd ke kf ng kh ki kj nh kl km kn ni kp kq kr ks ig bi translated"><strong class="jx io">你可以在这里看到它的样子，也可以在</strong> <a class="ae kt" href="https://playground.anychart.com/mQpaROde/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> AnyChart游乐场</strong> </a> <strong class="jx io">上查看这个变种的互动版本及其完整代码。</strong></p></blockquote><figure class="kv kw kx ky gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nc"><img src="../Images/0658c168f255290ad4f14df8e99c3613.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dkbgddB6iAToDQEaEgGEOg.png"/></div></div></figure><p id="2734" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但说实话，我更喜欢之前的连接器可视化方式。所以我取消了曲率调整，恢复到最初的曲线。</p><h2 id="2405" class="mc la in bd lb md me dn lf mf mg dp lj kg mh mi ln kk mj mk lr ko ml mm lv mn bi translated">4.设置连接线类型的格式</h2><p id="635e" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">在自行车路线中，一些线路只是将一个赛段的终点城镇与下一个赛段的起点城镇连接起来，并不是赛道的一部分。我通过向helper函数添加一个布尔参数来用虚线表示这些连接。如果布尔值为真，我在stroke属性中添加破折号值。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="eb4b" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// create individual series<br/></em></strong>createSeries(map, 'Hilly', data[1]['hillyData'], '#57ae12', false);<br/>createSeries(map, 'Mountain', data[2]['mountainData'], '#318053', false);<br/>createSeries(map, 'Flat', data[3]['flatData'], '#a4664d', false);<br/>createSeries(map, 'Individual Time Trial', data[4]['timeTrialData'], '#ef6c00', false);<br/>createSeries(map, 'Connector', data[5]['connectorData'], '#fac233', true);</span><span id="9ac0" class="mc la in mr b gy nb mx l my mz">...</span><span id="9be6" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">// configure and customize the connector series<br/></em></strong>var connectorSeries = map<br/>  .connector(data)<br/>  .stroke(function (d) {<br/>    return {<br/>      color: color,<br/>      thickness: 2,<br/>      dash: isConnector ? '3 6' : '0'<br/>    }<br/>  })<br/>  .fill(color)<br/>  .name(name);</span></pre><h2 id="4971" class="mc la in bd lb md me dn lf mf mg dp lj kg mh mi ln kk mj mk lr ko ml mm lv mn bi translated">5.增强工具提示</h2><p id="d44f" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">默认情况下，到目前为止创建的JavaScript连接器地图的工具提示显示阶段开始和结束的城市和城镇的纬度和经度，这不是很有用。因此，我使用HTML修改了helper函数中的连接器工具提示，以显示每条连接线的起点和终点的名称。我还禁用了place系列的工具提示，因为每个站点都不需要任何额外的信息。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="a0bd" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// customize the destination series tooltip<br/></em></strong>connectorSeries<br/>  .tooltip()<br/>  .format('{%full}')<br/>  .title({ useHtml: true })<br/>  .titleFormat(<br/>    '{%number}. &lt;span style="font-size: 13px; color: #E1E1E1"; padding: 10px&gt;{%short}&lt;/span&gt;'<br/>  );</span><span id="4e3f" class="mc la in mr b gy nb mx l my mz">...</span><span id="57f4" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">// create a marker series for the place names<br/></em></strong>var citiesSeries = map<br/>  .marker(data[0]['citiesData'])<br/>  .type('circle')<br/>  .fill('#3e5ca6')<br/>  .stroke(0)<br/>  .tooltip(false);</span></pre><h2 id="3008" class="mc la in bd lb md me dn lf mf mg dp lj kg mh mi ln kk mj mk lr ko ml mm lv mn bi translated">6.修改标记大小</h2><p id="3fd5" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">我还想减少连接线上的箭头标记大小，使其更加微妙。这需要在helper函数中添加一行代码。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="a938" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// set the marker size<br/></em></strong>var markers = connectorSeries.markers().size(10);</span></pre><h2 id="b4e1" class="mc la in bd lb md me dn lf mf mg dp lj kg mh mi ln kk mj mk lr ko ml mm lv mn bi translated">7.增强标题</h2><p id="ad8e" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">最后，我只是让标题更具知识性，并定制文本。这段代码类似于工具提示个性化代码，都使用了HTML。</p><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="21c7" class="mc la in mr b gy mw mx l my mz"><strong class="mr io"><em class="na">// set a title for the map and customize it<br/></em></strong>map<br/>  .title()<br/>  .enabled(true)<br/>  .useHtml(true)<br/>  .fontColor('#263238')<br/>  .text(<br/>    'Tour de France 2021 Route Map&lt;br/&gt;' +<br/>    '&lt;span style="color:#a3a3a3; font-size: 14px;"&gt;Indicating stage terrain&lt;/span&gt;'<br/>  );</span></pre><p id="b509" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">仅此而已，已获得奖励积分！一个绝对可爱和富有洞察力的JavaScript (HTML5)连接器地图被构建来展示2021年环法自行车赛的自行车路线，这是最负盛名的年度自行车比赛之一！</p><figure class="kv kw kx ky gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nc"><img src="../Images/a2dfc942d2b1762cab317938925ae730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tlup15Gde5tAjhVlt9xUkw.png"/></div></div></figure><blockquote class="nd ne nf"><p id="c6c7" class="jv jw na jx b jy jz ka kb kc kd ke kf ng kh ki kj nh kl km kn ni kp kq kr ks ig bi translated"><strong class="jx io">抛光版的完整代码就在这里，也在</strong><a class="ae kt" href="https://playground.anychart.com/S9xXAHth/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">any chart Playground</strong></a><strong class="jx io">上。</strong></p></blockquote><pre class="kv kw kx ky gt ms mr mt mu aw mv bi"><span id="3e95" class="mc la in mr b gy mw mx l my mz">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;JavaScript Connector Map&lt;/title&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-map.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/geodata/latest/countries/france/france.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.15/proj4.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.10.0/js/anychart-data-adapter.min.js"&gt;&lt;/script&gt;<br/>    &lt;style type="text/css"&gt;<br/>      html,<br/>      body,<br/>      #container {<br/>        width: 100%;<br/>        height: 100%;<br/>        margin: 0;<br/>        padding: 0;<br/>      }<br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>    &lt;script&gt;</span><span id="6b47" class="mc la in mr b gy nb mx l my mz">anychart.onDocumentReady(function () {</span><span id="76a0" class="mc la in mr b gy nb mx l my mz">anychart.data.loadJsonFile(<br/>'https://gist.githubusercontent.com/shacheeswadia/4a2e84185d754984681a89194b4282df/raw/ec70b11e8f68e5e6df60cff15bff8dd5b05ce22a/connector-map.json', function (data) {</span><span id="5626" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // create a connector map chart<br/></em></strong>  var map = anychart.connector();</span><span id="7b9e" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // set the geodata for france<br/></em></strong>  map.geoData('anychart.maps.france');</span><span id="4db6" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // add a title for the map and customize it<br/></em></strong>  map<br/>    .title()<br/>    .enabled(true)<br/>    .useHtml(true)<br/>    .fontColor('#263238')<br/>    .text(<br/>      'Tour de France 2021 Route Map&lt;br/&gt;' +<br/>      '&lt;span style="color:#a3a3a3; font-size: 14px;"&gt;Indicating stage terrain&lt;/span&gt;'<br/>    );</span><span id="a760" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // create a marker series for the place names<br/></em></strong>  var citiesSeries = map<br/>    .marker(data[0]['citiesData'])<br/>    .type('circle')<br/>    .fill('#3e5ca6')<br/>    .stroke(0)<br/>    .tooltip(false);</span><span id="6c05" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // create individual series<br/></em></strong>  createSeries(map, 'Hilly', data[1]['hillyData'], '#57ae12', false);<br/>  createSeries(map, 'Mountain', data[2]['mountainData'], '#318053', false);<br/>  createSeries(map, 'Flat', data[3]['flatData'], '#a4664d', false);<br/>  createSeries(map, 'Individual Time Trial', data[4]['timeTrialData'], '#ef6c00', false);<br/>  createSeries(map, 'Connector', data[5]['connectorData'], '#fac233', true);</span><span id="af24" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // customize the labels for the city names series<br/></em></strong>  citiesSeries<br/>    .labels()<br/>    .enabled(true)<br/>    .position('center-bottom')<br/>    .fontColor('#263238')<br/>    .offsetY(0)<br/>    .offsetX(5)<br/>    .anchor('left-center')<br/>    .format('{%name}');</span><span id="64e7" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // turn on the legend<br/></em></strong>  map.legend(true);</span><span id="ab0a" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // exclude cities from the legend<br/></em></strong>  citiesSeries.legendItem(false);</span><span id="84b0" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // set the container id for the map<br/></em></strong>  map.container('container');</span><span id="4bcc" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // command to draw the resulting connector map<br/></em></strong>  map.draw();</span><span id="6999" class="mc la in mr b gy nb mx l my mz">});</span><span id="1887" class="mc la in mr b gy nb mx l my mz">});</span><span id="408f" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">// a helper function to create several series<br/></em></strong>function createSeries(map, name, data, color, isConnector) {<br/><strong class="mr io"><em class="na">  // configure and customize the series<br/></em></strong>  var connectorSeries = map<br/>    .connector(data)<br/>    .stroke(function (d) {<br/>      return {<br/>        color: color,<br/>        thickness: 2,<br/>        dash: isConnector ? '3 6' : '0'<br/>      }<br/>      })<br/>    .fill(color)<br/>    .name(name);</span><span id="84a5" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // set the legend shape and color<br/></em></strong>  connectorSeries.legendItem({<br/>    iconType: 'circle',<br/>    iconFill: color<br/>  });</span><span id="c827" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // set the marker size<br/></em></strong>  var markers = connectorSeries.markers().size(10);</span><span id="bc05" class="mc la in mr b gy nb mx l my mz"><strong class="mr io"><em class="na">  // customize the destination series tooltips<br/></em></strong>  connectorSeries<br/>    .tooltip()<br/>    .format('{%full}')<br/>    .title({ useHtml: true })<br/>    .titleFormat(<br/>      '{%number}. &lt;span style="font-size: 13px; color: #E1E1E1"; padding: 10px&gt;{%short}&lt;/span&gt;'<br/>    );<br/>}</span><span id="7973" class="mc la in mr b gy nb mx l my mz">    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h1 id="4c8a" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">结论</h1><p id="d66d" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">正如您在本教程中看到的，创建交互式JavaScript连接器映射实际上是轻松快捷的。如果您想了解如何实现其他内容或查看其他图表类型，请随意钻研<a class="ae kt" href="https://docs.anychart.com/Maps/Connector_Maps" rel="noopener ugc nofollow" target="_blank">连接器映射文档</a>。</p><p id="3e82" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">无论是竞技体育还是交互式数据可视化，实践是成功的关键。所以，继续尽可能多地练习构建JS图形。一定要问我关于本教程或其他数据视觉效果的问题，如果有的话。</p></div><div class="ab cl nj nk hr nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ig ih ii ij ik"><p id="603a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="na">在</em></strong><a class="ae kt" href="https://www.anychart.com/chartopedia/chart-type/connector-map/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="na">Chartopedia</em></strong></a><strong class="jx io"><em class="na">上查看更多关于连接器地图，不要错过其他</em></strong><a class="ae kt" href="https://www.anychart.com/blog/category/javascript-chart-tutorials/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="na">JavaScript制图教程</em> </strong> </a> <strong class="jx io"> <em class="na">。</em> </strong></p></div><div class="ab cl nj nk hr nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ig ih ii ij ik"><p id="fb2e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="na">如果你有一个很酷的客座博文的想法，欢迎来到</em> </strong> <a class="ae kt" href="https://www.anychart.com/support/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="na">让我们知道</em> </strong> </a>。</p></div><div class="ab cl nj nk hr nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ig ih ii ij ik"><p id="e2e5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="na">原载于2021年9月21日https://www.anychart.com</em><a class="ae kt" href="https://www.anychart.com/blog/2021/09/21/connector-map-javascript/" rel="noopener ugc nofollow" target="_blank"><em class="na"/></a><em class="na">。</em></p><p id="ed5f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="na">更多内容请看</em><a class="ae kt" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="na">plain English . io</em></strong></a></p></div></div>    
</body>
</html>