<html>
<head>
<title>Managing Global State With Redux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Redux管理全局状态</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/managing-global-state-with-react-redux-6b7279ec5f50?source=collection_archive---------3-----------------------#2021-03-15">https://javascript.plainenglish.io/managing-global-state-with-react-redux-6b7279ec5f50?source=collection_archive---------3-----------------------#2021-03-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/8ea1c1336429e73ed105a6baac995965.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*meCFnZ5MK_7Fu1ogYfBvNQ.png"/></div></div></figure><p id="9129" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当我第一次学习React时，我对它的许多独特功能和扩展感到不知所措。这是我在熨斗学校期间最具挑战性的阶段转换之一。尽管如此，我还是越来越适应这个框架，并扩展了我的技能，加入了许多有用的工具，包括Redux。</p><h1 id="bb22" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">为什么是Redux？</h1><p id="c819" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">这么多人使用redux的一个主要原因是，它为复杂或高度填充的组件层次结构利用了更简单、更精简的状态管理。Redux也使得在你的应用中保持关注点的分离变得更加容易——它唯一的工作就是处理全局状态。</p><p id="0cee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当在一个有很多组件的大型应用程序中管理状态时，当一个组件中的状态必须由另一个组件更新时，会变得非常混乱。传统上，新值会通过其起点之上的每个组件一直传递到组件层次结构的顶部，然后再向下传递到下一个组件以更新其状态。</p><p id="cede" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">通过Redux，状态被全局存储，并且可以在应用程序中的任何地方轻松更新或调用。</p><p id="d28d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这相当于乘坐当地公交车与乘坐优步。当地公共汽车通常只朝一个方向行驶，要停很多站才能到达最终目的地。它也只从预定的地点上车，如果公共汽车没有在你想要的目的地停下来，你最终不得不换乘另一辆公共汽车。或者，优步可以从任何地点接你，并且总是会把你带到正确的目的地。当然，巴士更便宜，完成工作，你不必建立一个完整的个人资料或输入你的信用卡信息，但当巴士变得有点太复杂时，优步总是派上用场。</p><h2 id="ffc3" class="lw ku in bd kv lx ly dn kz lz ma dp ld kg mb mc lh kk md me ll ko mf mg lp mh bi translated">文件结构</h2><p id="4afb" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">当我学习redux的时候，我被教导通过文件来分离动作和reducers。这遵循了Redux的关注点分离的主题，同时也使代码更具可读性，更简洁。</p><h1 id="56e0" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">索引. js</h1><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mi"><img src="../Images/485018ceb795930f042a95c62943e058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*elNjmuAwbo10ycFTF5aFVw.png"/></div></div></figure><p id="08b2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在Index.js文件的顶部，createStore applyMiddleware和rootReducer从redux库导入，Provider从react-redux库导入，thunk从redux-thunk库导入。</p><p id="d30f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">CreateStore用于使用根reducer创建应用程序的商店，根reducer将包含应用程序的状态树。ApplyMiddleware用于将redux-thunk中间件应用到商店。Provider作为props传递到store，使得包装在里面的所有组件都可以访问状态。</p><h1 id="2782" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">动作类型文件</h1><p id="ca61" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">动作类型文件包含用于识别动作文件中的动作的变量。虽然这个文件对于Redux的功能不是必需的，但是它进一步有助于分离关注点，并有助于避免打字错误或其他小错误。</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/beb019063c71164443f1d00045c10cb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*5HnGsesLrQPh9tyX1IbXNg.png"/></div></figure><p id="dbce" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在我的应用程序Pocket Dudes中，我选择利用Redux来处理宠物状态。在动作类型文件中，两个变量GET_PETS和ADD_PET在引号中被设置为它们的名称并被导出。</p><h1 id="c49a" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">动作文件</h1><p id="5dd9" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">动作文件包含redux函数，这些函数返回传递给redux的数据(<strong class="jx io"> dispatch) </strong>。通常，这些函数会接收一条数据，然后<strong class="jx io">将它</strong>和<strong class="jx io">动作类型</strong>发送到根减速器。</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mo"><img src="../Images/f67ad5ba157ad447bc82e3be3870167f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i9Wex_ELmo09cLbpuymVJw.png"/></div></div></figure><p id="a6a9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，这两种操作类型都是从操作类型文件中导入的。第一个函数addPet接收一个Pet对象，并向数据库发送一个post请求。然后，在post请求完成之后，数据被分派到根reducer，它带有一个键<strong class="jx io">有效负载</strong>和动作类型<strong class="jx io"> ADD_PET。</strong>第二个函数getPets接受用户对象，将有效负载设置为用户的宠物，并使用动作类型<strong class="jx io"> GET_PETS </strong>将其分派给根reducer。</p><h1 id="ef7c" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">根缩减器文件</h1><p id="a15f" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">根reducer文件包含当前状态和处理更新状态的“Reducer函数”。</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mp"><img src="../Images/d273c6e0c3f1db9f313a1d23de665e65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bMGoieS0TPfjeQwogxr0qw.png"/></div></div></figure><p id="7995" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在根Reducer文件中，combineReducers是从redux库导入的，以后用于维护当前状态并保持更新。</p><p id="ca0e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后，默认状态被设置为一个散列，其关键字为“pets ”,值为空数组。函数petsReducer接受<strong class="jx io">默认状态</strong>和<strong class="jx io">动作，</strong>确定<strong class="jx io">动作类型</strong>，<strong class="jx io"> </strong>，并用<strong class="jx io">有效载荷</strong>更新状态(我们在动作文件中设置有效载荷关键字的任何数据)。</p><p id="6d57" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">根缩减器将“pets”的当前状态设置为petsReducer当前返回的状态。如果没有调用动作，则petsReducer返回当前状态。</p><h1 id="8dac" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">地图分派到道具</h1><p id="3f0b" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">map dispatch to props (mdp)函数使特定的redux操作可以通过组件的props来访问。</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mq"><img src="../Images/23830187a64943d855a11b9e2aed1ba2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a8ggxgyz8RXdOqcUDpUT5Q.png"/></div></div></figure><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mr"><img src="../Images/1328d6b0270f2c3a9c8ed315bde6f31c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UEY7SD5wI1Jq_yqYde4U_Q.png"/></div></div></figure><p id="d5d6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里，我使用getPets函数获取PetCard组件中用户的所有宠物，使用addPet函数将一只宠物添加到AdoptPet组件中用户的宠物列表中。<strong class="jx io"> connect </strong>函数从Redux库的文件顶部导入，用于在调用时将函数的调度响应连接到根reducer。</p><h1 id="53b3" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">将状态映射到道具</h1><p id="0720" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">将状态映射到属性(msp)功能使特定的状态对象可以通过组件的属性进行访问。</p><figure class="mj mk ml mm gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mq"><img src="../Images/22c8bbcaee63843e3fc1112cb8cfeccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_smA5tpOpsQC5qpQTrj8QA.png"/></div></div></figure><p id="6875" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在App.js文件中，msp函数接受当前redux状态(通过connect函数)并返回指定状态键的值。</p><h1 id="b66d" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结论</h1><p id="357a" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">Redux是一个非常抽象的库，需要大量的学习和实践才能完全掌握。虽然我的理解仍然相当新鲜，我可能没有在我的解释中非常深入，但我计划继续练习和学习Redux，并希望回来编辑这个博客，提供更全面的说明。</p></div></div>    
</body>
</html>