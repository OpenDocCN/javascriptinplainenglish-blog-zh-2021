<html>
<head>
<title>A Complete Guide To Gatsby + React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">盖茨比+反应完全指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/a-complete-guide-to-gatsby-react-34039da49438?source=collection_archive---------15-----------------------#2021-01-11">https://javascript.plainenglish.io/a-complete-guide-to-gatsby-react-34039da49438?source=collection_archive---------15-----------------------#2021-01-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5d11" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">介绍Gatsby，它是一个健壮而快速的静态站点生成器</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5225d2b5d794b4c0d1940c552cda6edc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jQfKGQ0Tj6PhG8eF3BS5Fg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Image credit: Michael Foster</figcaption></figure><p id="8b73" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">什么是<code class="fe lr ls lt lu b"><a class="ae lv" href="https://en.wikipedia.org/wiki/The_Great_Gatsby" rel="noopener ugc nofollow" target="_blank">The Great Gatsby</a></code>？</p><p id="f65d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是美国作家f .斯科特.菲茨杰拉德在1925年写的一部小说。这本书讲述了1922年夏天生活在繁华的长岛上的虚构小镇西卵和东卵的一群角色。许多文学评论家认为这是有史以来最伟大的小说之一。</p><p id="b57e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">今天我们谈论另一个<a class="ae lv" href="https://github.com/gatsbyjs/gatsby" rel="noopener ugc nofollow" target="_blank"> Gatsby </a>，一个基于React的免费开源框架，帮助开发者构建超快的网站和应用。</p><p id="8a6a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">启动新的React应用程序时，您可以考虑React团队的建议:</p><ul class=""><li id="b3a5" class="lw lx iq kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">如果你正在学习React或创建一个新的单页应用，使用<a class="ae lv" href="https://medium.com/better-programming/10-fun-facts-about-create-react-app-eb7124aa3785" rel="noopener">创建React应用</a>。</li><li id="3fba" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">如果你正在用Node.js <strong class="kx ir">，</strong>构建一个服务器渲染的网站，试试<a class="ae lv" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>。</li><li id="7e7d" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">如果你正在建立一个静态的面向内容的网站<strong class="kx ir">，</strong>试试Gatsby。</li><li id="76b8" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">如果你正在构建一个组件库或者集成一个现有的代码库，试试<a class="ae lv" href="https://neutrinojs.org/" rel="noopener ugc nofollow" target="_blank"> Neutrino </a>、<a class="ae lv" href="https://nx.dev/react" rel="noopener ugc nofollow" target="_blank"> Nx </a>、<a class="ae lv" href="https://parceljs.org/" rel="noopener ugc nofollow" target="_blank">package</a>或者<a class="ae lv" href="https://github.com/jaredpalmer/razzle" rel="noopener ugc nofollow" target="_blank"> Razzle </a>。</li></ul><p id="044c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">什么是静态内容？它是无需额外处理即可交付给最终用户的内容，即服务器向用户交付相同的文件。静态网站对服务器的要求不高。它们更容易被缓存，并且需要更少的计算能力。这是通过互联网传输内容的最简单、最有效的方式之一。静态网站的好处是速度、搜索引擎优化(SEO)和安全性。</p><p id="c4b2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Gatsby是一个健壮而快速的静态站点生成器，它使用React在web上呈现静态内容。在这篇文章中，我们将解释盖茨比是如何工作的。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="2cf1" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">安装并运行盖茨比</h1><p id="2e20" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated">Gatsby CLI工具提供了一组创建和开发Gatsby站点的命令。可以通过以下命令安装它:</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="bf81" class="ns ms iq lu b gy nt nu l nv nw">$ npm install -g gatsby-cli</span></pre><p id="7946" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">安装使<code class="fe lr ls lt lu b">gatsby</code>命令在全球可用:</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="0814" class="ns ms iq lu b gy nt nu l nv nw">$ gatsby --help<br/>Usage: gatsby &lt;command&gt; [options]</span><span id="f5fc" class="ns ms iq lu b gy nx nu l nv nw">Commands:<br/>  gatsby develop                      Start development server. Watches files, rebuilds, and hot reloads if something changes<br/>  gatsby build                        Build a Gatsby project.<br/>  gatsby serve                        Serve previously built Gatsby site.<br/>  gatsby info                         Get environment information for debugging and issue reporting<br/>  gatsby clean                        Wipe the local gatsby environment including built assets and cache<br/>  gatsby repl                         Get a node repl with context of Gatsby environment, see<br/>                                      (<a class="ae lv" href="https://www.gatsbyjs.com/docs/gatsby-repl/" rel="noopener ugc nofollow" target="_blank">https://www.gatsbyjs.com/docs/gatsby-repl/</a>)<br/>  gatsby recipes [recipe]             [EXPERIMENTAL] Run a recipe<br/>  gatsby new [rootPath] [starter]     Create new Gatsby project.<br/>  gatsby telemetry                    Enable or disable Gatsby anonymous analytics collection.<br/>  gatsby plugin [cmd]                 Useful commands relating to Gatsby plugins<br/>  gatsby options [cmd] [key] [value]  View or set your gatsby-cli configuration settings.</span><span id="f490" class="ns ms iq lu b gy nx nu l nv nw">Options:<br/>  --verbose                Turn on verbose output                                 [boolean] [default: false]<br/>  --no-color, --no-colors  Turn off the color in output                           [boolean] [default: false]<br/>  --json                   Turn on the JSON logger                                [boolean] [default: false]<br/>  -h, --help               Show help                                                               [boolean]<br/>  -v, --version            Show the version of the Gatsby CLI and the Gatsby package in the current project<br/>                                                                                                   </span></pre><p id="8c3f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们使用<code class="fe lr ls lt lu b">gatsby</code>命令初始化一个名为<code class="fe lr ls lt lu b">my-gatsby</code>的Gatsby项目:</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="33b3" class="ns ms iq lu b gy nt nu l nv nw">$ gatsby new my-<!-- -->gatsby</span></pre><p id="a225" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">转到文件夹<code class="fe lr ls lt lu b">my-gatsby</code>，启动开发服务器:</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="b974" class="ns ms iq lu b gy nt nu l nv nw">$ cd my-<!-- -->gatsby<br/>$ gatsby develop</span></pre><p id="c29c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在浏览器窗口中，键入URL <code class="fe lr ls lt lu b">http://localhost:8000</code>。它显示了默认的盖茨比网站:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/43eb5907ca5a26ac16c6db3e2529be8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X1Ho7Am5Ee-uozimxx6D4w.png"/></div></div></figure><p id="8c3e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里是<code class="fe lr ls lt lu b">src/pages/index.js</code>，它指定了上述网页中的文本和图像。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="12b4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe lr ls lt lu b">Link</code>(第2行)是一个内置组件，用于站点内页面之间的链接。第17行是到页面<code class="fe lr ls lt lu b">/page-2</code>的链接，第18行是到页面<code class="fe lr ls lt lu b">/using-typescript</code>的链接。</p><p id="cff1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe lr ls lt lu b">Layout</code>(第4行)、<code class="fe lr ls lt lu b">Image</code>(第5行)、<code class="fe lr ls lt lu b">SEO</code>(第6行)是用户自定义组件，对文字和图片进行排列，为SEO提供元数据。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="51ee" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">盖茨比文件夹结构</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/099c846e99182e494d41d22f6ce2485d.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*mp1CslUcSZzQtFRW_XYp4w.png"/></div></figure><p id="1bc1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以上是<code class="fe lr ls lt lu b">gatsby</code>的开箱文件夹结构。</p><ul class=""><li id="ba6a" class="lw lx iq kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated"><code class="fe lr ls lt lu b">.cache</code>、<code class="fe lr ls lt lu b">node_modules, </code>和<code class="fe lr ls lt lu b">public</code>是自动生成的文件夹。</li><li id="feba" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">src</code>是源文件夹。它包含特定于项目的代码。</li><li id="a8c4" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">.gitignore</code>为Git指定未跟踪的文件。</li><li id="73f9" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">.prettierignore</code>和<code class="fe lr ls lt lu b">.prettierrc</code>包含<code class="fe lr ls lt lu b">Prettier</code>的代码格式规则。</li><li id="1f75" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">gatsby-browser.js</code>是Gatsby期望找到任何Gatsby浏览器API用法的地方。它用于自定义或扩展影响浏览器的默认Gatsby设置。</li><li id="9d1e" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">gatsby-config.js</code>是一个Gatsby网站的主配置文件。它指定了<code class="fe lr ls lt lu b">pathPrefix</code>、<code class="fe lr ls lt lu b">siteMetadata</code>、插件、标志、聚合填充、映射、代理和开发硬件。</li><li id="6da7" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">gatsby-node.js</code>是Gatsby期望找到任何Gatsby节点API用法的地方。它用于定制或扩展影响站点构建过程的默认Gatsby设置。</li><li id="eeb7" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">Gatsby希望在这里找到Gatsby服务器端呈现API的任何用法。它用于定制影响服务器端呈现的默认Gatsby设置。</li><li id="7a3b" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">package.json</code>保存项目的各种NPM相关元数据。</li></ul><p id="0c4f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是<code class="fe lr ls lt lu b">package.json</code>的内容。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="10b2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第7 - 20行是<a class="ae lv" href="https://medium.com/better-programming/package-jsons-dependencies-in-depth-a1f0637a3129" rel="noopener">依赖</a>，包括React和Gatsby包，以及Gatsby插件。</p><p id="9bd4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第29 - 38行列出了可用的脚本。Gatsby CLI命令也可以由npm命令执行。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="db11" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">Gatsby Src文件夹</h1><p id="79a2" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated"><code class="fe lr ls lt lu b">src</code>是项目特定源代码的文件夹。它由几个子文件夹组成，如<code class="fe lr ls lt lu b">pages</code>、<code class="fe lr ls lt lu b">components</code>和<code class="fe lr ls lt lu b">images</code>。</p><h2 id="47b2" class="ns ms iq bd mt oc od dn mx oe of dp nb le og oh nd li oi oj nf lm ok ol nh om bi translated"><strong class="ak"> src/pages </strong></h2><p id="b790" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated"><code class="fe lr ls lt lu b">src/pages</code>包含页面组件，这些组件根据文件名由路径自动呈现。这是一条直接的路由规则。</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="23de" class="ns ms iq lu b gy nt nu l nv nw">$ ls src/pages<br/>404.js               index.js             page-2.js            using-typescript.tsx</span></pre><ul class=""><li id="4920" class="lw lx iq kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated"><code class="fe lr ls lt lu b">404.js</code>用于在生产模式下生成<code class="fe lr ls lt lu b">404.html</code>文件。</li><li id="02b6" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">index.js</code>是索引文件，是加载URL的默认页面<code class="fe lr ls lt lu b">/</code>。</li><li id="8a19" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">page-2.js</code>是要加载URL的页面，<code class="fe lr ls lt lu b">/page-2</code>。</li><li id="9f71" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">using-typescript.tsx</code>是要加载URL的页面，<code class="fe lr ls lt lu b">/using-typescript</code>。</li></ul><p id="5aa2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">404是HTTP状态代码，表示请求的文件不可用。Gatsby建议构建<code class="fe lr ls lt lu b">404.js</code>用于错误处理，以防文件被移动、删除或只是路径错误。</p><p id="61a5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你在浏览器的地址栏中输入<a class="ae lv" href="https://jenniferfubook.github.io/gatsby-site/unknown" rel="noopener ugc nofollow" target="_blank">https://jenniferfubook.github.io/gatsby-site/unknown</a>，你会看到未知页面的如下界面:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/9993ea6ceb7e286134c1c00531c639fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*h1-oQXB-0vqefW1mB40WMw.png"/></div></figure><p id="3d18" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里是<code class="fe lr ls lt lu b">src/pages/404.js</code>文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="e41d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">TypeScript是JavaScript超集。它扩展了JavaScript以包含允许静态检查代码库的类型定义。开箱即用，Gatsby通过插件<code class="fe lr ls lt lu b">gatsby-plugin-typescript</code>支持TypeScript。使用TypeScript不需要配置这个插件。但是，如果你想管理TypeScript的选项，在<code class="fe lr ls lt lu b">gatsby-config.js</code>中配置这个插件。</p><p id="7943" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里是<code class="fe lr ls lt lu b">src/pages/using-typescript.tsx</code>文件，由Gatsby为路由URL自动渲染，<code class="fe lr ls lt lu b">/using-typescript</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="3be8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第8 - 12行定义了类型<code class="fe lr ls lt lu b">DataProps</code>。</p><p id="7610" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第14行将<code class="fe lr ls lt lu b">UsingTypescript</code>打成<code class="fe lr ls lt lu b">React.FC&lt;PageProps&lt;DataProps&gt;&gt;</code>。</p><p id="eb6a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第28 - 34行用GraphQL检索<code class="fe lr ls lt lu b">site.buildTime</code>。检索到的值<code class="fe lr ls lt lu b">data.site.buildTime</code>呈现在第20行。</p><h2 id="8ad6" class="ns ms iq bd mt oc od dn mx oe of dp nb le og oh nd li oi oj nf lm ok ol nh om bi translated"><strong class="ak">src/组件</strong></h2><p id="0955" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated"><code class="fe lr ls lt lu b">src/components</code>包含页面构建块，作为用户定义的可重用组件。</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="5373" class="ns ms iq lu b gy nt nu l nv nw">$ ls src/components<br/>header.js  image.js   layout.css layout.js  seo.js</span></pre><ul class=""><li id="310d" class="lw lx iq kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated"><code class="fe lr ls lt lu b">header.js</code>定义了<code class="fe lr ls lt lu b">Header</code>组件，使用html标签，比如<code class="fe lr ls lt lu b">header</code>、<code class="fe lr ls lt lu b">h1</code>和<code class="fe lr ls lt lu b">div</code>。</li><li id="4cde" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">image.js</code>定义了加载<code class="fe lr ls lt lu b">gatsby-astronaut.png</code>的<code class="fe lr ls lt lu b">Image</code>组件。</li><li id="51e4" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">layout.js</code>建立在<code class="fe lr ls lt lu b">Header</code>和html标签之上。它用标准化的页眉和页脚定义了<code class="fe lr ls lt lu b">Layout</code>组件。</li><li id="1cbc" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">layout.css</code>是<code class="fe lr ls lt lu b">layout.js</code>的CSS文件。</li><li id="f94b" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe lr ls lt lu b">seo.js</code>创建<code class="fe lr ls lt lu b">SEO</code>组件，该组件在文档头中嵌入了SEO信息。它使用了react的文档头管理器。</li></ul><p id="5797" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是<code class="fe lr ls lt lu b">src/components/header.js</code>文件。它使用内嵌样式。或者，我们可以定义一个外部CSS文件，并将其导入到任何JavaScript/TypeScript文件中，类似于<code class="fe lr ls lt lu b">layout.js</code>和<code class="fe lr ls lt lu b">layout.css</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="36f1" class="ns ms iq bd mt oc od dn mx oe of dp nb le og oh nd li oi oj nf lm ok ol nh om bi translated">src/图像</h2><p id="b02d" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated"><code class="fe lr ls lt lu b">src/images</code>包含项目使用的图像文件。</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="6870" class="ns ms iq lu b gy nt nu l nv nw">$ ls src/images<br/>gatsby-astronaut.png gatsby-icon.png</span></pre></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="3ccd" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">数据层</h1><p id="145d" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated">Gatsby的数据层由脸书发明的GraphQL提供支持。GraphQL是一种查询语言(QL)，其工作方式类似于SQL。它提供了一种革命性的思考API的方式。我们可以在单个请求中发送描述要检索的数据格式的查询，而不是使用严格的服务器定义的端点。Gatsby站点中的数据可以来自任何地方:Markdown、JSON、API、数据库、内容管理系统、本地文件等。在构建时，Gatsby创建一个内部GraphQL服务器来托管所有这些数据。</p><p id="4362" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<code class="fe lr ls lt lu b">src/pages/using-typescript.tsx</code>文件中，我们已经看到了<code class="fe lr ls lt lu b">data.site.buildTime</code>的GraphQL用法:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="31a4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe lr ls lt lu b">graphql</code>(第1行)可用于查询<code class="fe lr ls lt lu b">src/pages/&lt;files&gt;</code>中的数据。如果查询在<code class="fe lr ls lt lu b">src/components/&lt;files&gt;</code>中，React钩子<code class="fe lr ls lt lu b">useStaticQuery</code>可以和<code class="fe lr ls lt lu b">graphql</code>结合使用。</p><p id="59a6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里是<code class="fe lr ls lt lu b">src/components/seo.js</code>文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="d7a1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第14行和第15行应用<code class="fe lr ls lt lu b">useStaticQuery</code>和<code class="fe lr ls lt lu b">graphql</code>。</p><p id="687b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可能想知道<code class="fe lr ls lt lu b">siteMetadata</code>(第18 - 22行)的内容来自哪里。</p><p id="2761" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<code class="fe lr ls lt lu b">gatsby-config.js</code>文件中定义:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="1402" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第3 - 7行指定了<code class="fe lr ls lt lu b">siteMetadata</code>对象，它分配了<code class="fe lr ls lt lu b">title</code>、<code class="fe lr ls lt lu b">description</code>和<code class="fe lr ls lt lu b">author</code>的值。</p><p id="193c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可能想知道如何编写GraphQL查询。</p><p id="5f91" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当我们运行<code class="fe lr ls lt lu b">gatsby develop</code>时，输出包含以下信息:</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="5c83" class="ns ms iq lu b gy nt nu l nv nw">View GraphiQL, an in-browser IDE, to explore your site's data and schema<br/>⠀<br/>  http://localhost:8000/___graphql</span></pre><p id="2b2c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">去链接，我们看到了盖茨比的仙境。它显示来自内部GraphQL服务器的所有数据。这些数据是在构建时收集的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/f89654493177beaacd49c2808de18781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0s2eJdC81sZFFHJncJiRRQ.png"/></div></div></figure><p id="db91" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在最左侧的窗格中，我们选择了<code class="fe lr ls lt lu b">siteMetadata</code>中的项目。第二个左侧窗格显示了生成的GraphQL查询。左侧第三个窗格显示查询结果的实际值。最右边的窗格显示示例代码，有<code class="fe lr ls lt lu b">Page query</code>、<code class="fe lr ls lt lu b">StaticQuery hook</code>和<code class="fe lr ls lt lu b">StaticQuery</code>选项。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="c0c5" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">盖茨比插件</h1><p id="1a08" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated">像大多数静态站点生成器一样，Gatsby应用<a class="ae lv" href="https://www.gatsbyjs.com/plugins" rel="noopener ugc nofollow" target="_blank">插件</a>来扩展其功能或修改现有功能。此时此刻，已发布的插件有2519个。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/f9f352e89034c5544b6c97ba0ae94672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8pApX2obSBpK0Cs4yH7QLg.png"/></div></div></figure><p id="3f8e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">鼓励用户构建或者发布他们自己的插件。有关于如何创建一个盖茨比插件的详细指导。任何项目特定的、未发布的插件应该放在<code class="fe lr ls lt lu b">/plugins</code>文件夹中。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="4b3f" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">部署Gatsby站点</h1><p id="79a3" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated">对于盖茨比项目，我们做了一个构建:</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="a4f8" class="ns ms iq lu b gy nt nu l nv nw">$ gatsby build</span></pre><p id="f400" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<code class="fe lr ls lt lu b">/public</code>文件夹中生成编译后的代码。它可以通过以下Gatsby命令启动:</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="d119" class="ns ms iq lu b gy nt nu l nv nw">$ gatsby serve</span></pre><p id="be69" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该页面在<code class="fe lr ls lt lu b">http://localhost:9000/</code>可用。</p><p id="e2b7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们退出<code class="fe lr ls lt lu b">gatsy serve</code>，网站将不再活跃。</p><p id="716b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这个网站怎么能一直运行呢？</p><p id="74f4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最简单的方法是将其发布到CDN(内容交付网络，或内容分发网络)，这是代理服务器及其数据中心的地理分布式网络。</p><h2 id="8183" class="ns ms iq bd mt oc od dn mx oe of dp nb le og oh nd li oi oj nf lm ok ol nh om bi translated">部署到浪涌</h2><p id="ca89" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated"><a class="ae lv" href="https://github.com/sintaxi/surge" rel="noopener ugc nofollow" target="_blank"> Surge </a>是一个用于<code class="fe lr ls lt lu b">surge.sh</code>托管服务的CLI客户端，它只需一个命令就可以将web应用发布到CDN，无需任何设置。</p><p id="d6b2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们在全球范围内下载Surge并登录。</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="4a7d" class="ns ms iq lu b gy nt nu l nv nw">$ npm install --global surge</span><span id="c072" class="ns ms iq lu b gy nx nu l nv nw"># Then create a (free) account with them</span><span id="40f8" class="ns ms iq lu b gy nx nu l nv nw">$ surge login</span></pre><p id="8395" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后发布<code class="fe lr ls lt lu b">public</code>文件夹。</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="0e85" class="ns ms iq lu b gy nt nu l nv nw">$ surge public/</span><span id="1303" class="ns ms iq lu b gy nx nu l nv nw">Running as ******</span><span id="b228" class="ns ms iq lu b gy nx nu l nv nw">project: public/<br/>         domain: adjoining-rings.surge.sh<br/>         upload: [================] 100% eta: 0.0s (91 files, 2646769 bytes)<br/>            CDN: [====================] 100%</span><span id="66c8" class="ns ms iq lu b gy nx nu l nv nw">encryption: *.surge.sh, surge.sh (124 days)<br/>             IP: 138.197.235.123</span><span id="65af" class="ns ms iq lu b gy nx nu l nv nw">Success! - Published to adjoining-rings.surge.sh</span></pre><p id="f4b1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在浏览器的地址栏中输入<code class="fe lr ls lt lu b"><a class="ae lv" href="http://adjoining-rings.surge.sh/" rel="noopener ugc nofollow" target="_blank">adjoining-rings.surge.sh</a></code>，这个页面就会一直打开并运行。</p><h2 id="8388" class="ns ms iq bd mt oc od dn mx oe of dp nb le og oh nd li oi oj nf lm ok ol nh om bi translated">部署到Github</h2><p id="1c68" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated"><code class="fe lr ls lt lu b"><a class="ae lv" href="https://github.com/tschaub/gh-pages" rel="noopener ugc nofollow" target="_blank">gh-pages</a></code>可以发布一个盖茨比app到GitHub页面。演示站点已经设置为<a class="ae lv" href="https://github.com/JenniferFuBook/gatsby-site" rel="noopener ugc nofollow" target="_blank"> Github repo </a>，名称为<code class="fe lr ls lt lu b">/gatsby-site</code>。</p><p id="fcc1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下命令安装<code class="fe lr ls lt lu b">gh-pages</code>。</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="3001" class="ns ms iq lu b gy nt nu l nv nw">$ npm install gh-pages --save-dev</span></pre><p id="5bbb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<code class="fe lr ls lt lu b">gatsby-config.js</code>中，<code class="fe lr ls lt lu b">pathPrefix</code>需要设置为回购名称。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="ad67" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为方便起见，在<code class="fe lr ls lt lu b">package.json</code>中添加一个<code class="fe lr ls lt lu b">deploy</code>脚本:</p><pre class="kg kh ki kj gt no lu np nq aw nr bi"><span id="fa40" class="ns ms iq lu b gy nt nu l nv nw">"scripts": {<br/>  "deploy": "gatsby build --prefix-paths &amp;&amp; gh-pages -d public"<br/>}</span></pre><p id="f129" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">执行<code class="fe lr ls lt lu b">npm run deploy</code>，它进行新的构建，并将<code class="fe lr ls lt lu b">public</code>文件夹的所有内容复制到存储库的<code class="fe lr ls lt lu b">gh-pages</code>分支。</p><p id="892f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如我们在<a class="ae lv" href="https://medium.com/better-programming/build-advanced-react-input-fields-using-styled-components-and-storybook-js-a231b9b2438#e765-bf98276875df" rel="noopener">另一篇文章</a>中所描述的，从GitHub页面选择<code class="fe lr ls lt lu b">Settings</code>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/6faee17671415cadc6f8284374b09055.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5v6S75PgfKsBhcD0roX6Q.png"/></div></div></figure><p id="b143" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在设置页面，向下滚动到GitHub页面部分。确保您的存储库的设置将<code class="fe lr ls lt lu b">gh-pages</code>分支设置为要部署的源。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/3ea17aae872a958f98962c03fa3e1afb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M8XmPN9qN_dyWEw56OANIA.png"/></div></div></figure><p id="6410" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe lr ls lt lu b">gh-pages</code>自动设置所有这些。静态网站可以在这里访问<a class="ae lv" href="https://jenniferfubook.github.io/gatsby-site/" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="e198" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">一个真正的盖茨比网站</h1><p id="831e" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated">我们讨论了盖茨比的主要特点。现在我们展示迈克尔·福斯特的盖茨比网站。</p><p id="7b37" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">他的网站是用盖茨比和<a class="ae lv" href="https://www.sanity.io/studio" rel="noopener ugc nofollow" target="_blank">理智工作室</a>搭建的。<code class="fe lr ls lt lu b">sanity.io</code>是一个开源的实时内容编辑环境，连接到Sanity后端。</p><p id="23b7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在浏览器中输入网址:<code class="fe lr ls lt lu b"> <a class="ae lv" href="https://ranchtoplate.com/" rel="noopener ugc nofollow" target="_blank">https://ranchtoplate.com/</a></code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/66fc3cd416195e39b16a8fd43b013a47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TpgzGKWbMJ2wBBcJCezO7w.png"/></div></div></figure><p id="f8be" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你准备好尝尝牛肉或盖茨比了吗？</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="711d" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">结论</h1><p id="becb" class="pw-post-body-paragraph kv kw iq kx b ky nj jr la lb nk ju ld le nl lg lh li nm lk ll lm nn lo lp lq ij bi translated">Gatsby是一个健壮而快速的静态站点生成器。它为你照顾速度，搜索引擎优化和安全。这被认为是创建React项目的最好方法之一。</p><p id="b486" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">《盖茨比》不负众望，既是一部小说，也是一个反应框架。</p><p id="b5ce" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢阅读。我希望这有所帮助。你可以在这里看到我的其他媒体出版物<a class="ae lv" href="https://medium.com/@jenniferfubook/jennifer-fus-web-development-publications-1a887e4454af" rel="noopener"/>。</p></div></div>    
</body>
</html>