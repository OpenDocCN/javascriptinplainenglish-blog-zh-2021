<html>
<head>
<title>Don’t Optimize Your React App, Use Preact Instead</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不要优化你的React应用，用Preact代替</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/dont-optimize-your-react-app-use-preact-instead-76cdc3e69b59?source=collection_archive---------2-----------------------#2021-11-01">https://javascript.plainenglish.io/dont-optimize-your-react-app-use-preact-instead-76cdc3e69b59?source=collection_archive---------2-----------------------#2021-11-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="7e90" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">默认情况下，Preact提供性能优化。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/a3baa233b0c0162f346d2456bdad492f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PFk0hiI2SIkuCBQ-lSYM3g.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@kellysikkema?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Kelly Sikkema</a> on <a class="ae ks" href="https://unsplash.com/s/photos/choose?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ad17" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">几个月前，我写了一篇基于优化React加载时间的<a class="ae ks" href="https://dev.to/nilanth/how-to-reduce-react-app-loading-time-by-70-1kmm" rel="noopener ugc nofollow" target="_blank">文章，大多数读者的评论都建议尝试</a><a class="ae ks" href="https://preactjs.com/" rel="noopener ugc nofollow" target="_blank"> Preact </a>来获得默认优化。所以我决定用前一篇文章中使用的应用程序来尝试Preact。我们先来了解一下Preact。</p><p id="cd8b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Preact是一个react备选库，具有React的所有特性！Preact是一个<strong class="kv io"> 3KB </strong>库。与React相比，它非常小，因为React和react-dom gzip大小约为<strong class="kv io"> 41KB，</strong>不包括基于<a class="ae ks" href="https://bundlephobia.com/" rel="noopener ugc nofollow" target="_blank"> bundlephobia </a>的react-scripts。Preact的一些突出特点是:</p><ol class=""><li id="72e2" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">轻量级虚拟DOM</li><li id="b4ee" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">体积小的</li><li id="1f6f" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">默认情况下性能优化</li><li id="4a89" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">集成很简单</li><li id="ef39" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">默认PWA</li></ol><p id="e3eb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在让我们看看Preact的实际应用。</p><p id="d8c0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我在React和Preact中开发了相同的应用程序来测试应用程序的性能。</p><div class="kd ke kf kg gt ab cb"><figure class="md kh me mf mg mh mi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><img src="../Images/a97f69025e174f0366b4937b430e8779.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*HsU8pcojvvERn1V5509iSw.png"/></div></figure><figure class="md kh mj mf mg mh mi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><img src="../Images/c8c6934acaf4f36915f5adea6329be4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*svlAXi7IUjp5x0-Ioy53Bg.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk mk di ml mm">Preact and React Dashboard</figcaption></figure></div><p id="5b9d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">对于react应用程序，我使用了<a class="ae ks" href="https://create-react-app.dev/" rel="noopener ugc nofollow" target="_blank">创建React应用程序</a>，对于Preact，我使用了<code class="fe mn mo mp mq b"><a class="ae ks" href="https://github.com/preactjs/preact-cli" rel="noopener ugc nofollow" target="_blank">preact-cli</a></code> Preact，它还提供了一个选项，可以使用<a class="ae ks" href="https://github.com/preactjs/preact-compat" rel="noopener ugc nofollow" target="_blank"> preact-compat </a>将您现有的React应用程序转换为Preact，但我已经从头开始构建了一个应用程序，以查看最佳结果。</p><p id="e746" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了比较这两款应用的性能，我使用了<a class="ae ks" href="https://gtmetrix.com/" rel="noopener ugc nofollow" target="_blank"> GTmetrix </a>，并在<a class="ae ks" href="https://www.netlify.com/" rel="noopener ugc nofollow" target="_blank"> Netlify </a>上托管了这两款应用。</p><h1 id="8a7f" class="mr ms in bd mt mu mv mw mx my mz na nb jt nc ju nd jw ne jx nf jz ng ka nh ni bi translated">对应用性能做出反应</h1><p id="2588" class="pw-post-body-paragraph kt ku in kv b kw nj jo ky kz nk jr lb lc nl le lf lg nm li lj lk nn lm ln lo ig bi translated">下面是<strong class="kv io"> GTMetrics </strong>给基于React的App的评分。我为仪表板组件使用了基于路线的<strong class="kv io">代码分割</strong>。性能是<strong class="kv io"> 80% </strong>带<strong class="kv io"> B级</strong>，最大含量漆(<strong class="kv io"> LCP </strong>)和布局移位(<strong class="kv io"> CLS </strong>)看起来低。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/b6f43a7173e1c0b0f36f3f432924746c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l2D7HTfiQK-TxMI024kiRg.png"/></div></div></figure><p id="99e4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">正如我们在下图中看到的，整个页面在<strong class="kv io"> 2秒</strong>内加载，第一次内容绘制在<strong class="kv io"> 1秒左右。</strong>貌似性能还不错。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/e011ce7890a3c1b1e757a310151a00fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5t5v1tTCur6KF56TMUXNYw.png"/></div></div></figure><h1 id="5bc4" class="mr ms in bd mt mu mv mw mx my mz na nb jt nc ju nd jw ne jx nf jz ng ka nh ni bi translated">预测应用程序性能</h1><p id="5f5b" class="pw-post-body-paragraph kt ku in kv b kw nj jo ky kz nk jr lb lc nl le lf lg nm li lj lk nn lm ln lo ig bi translated">所有指标都是绿色的！似乎Preact中的同一个应用程序在GTMetrix中获得了<strong class="kv io"> 100% </strong>和<strong class="kv io"> A级</strong>。最大含量涂料(<strong class="kv io"> LCP </strong>)小于<strong class="kv io"> 500ms </strong>，无布局偏移(<strong class="kv io"> CLS </strong>)。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nq"><img src="../Images/04a40f08815c8168edc03ae8a2871439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ycIjrQUBUTnhO1freDcGVA.png"/></div></div></figure><p id="d01d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这看起来令人印象深刻。Preact很好地优化了我们的仪表板应用程序。与React相比，性能显著提高。现在让我们检查一下装货时间</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/a41a9a758c78eadbd7ac9203b3c6f0b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PX-b6GaCBG6JLDAk9M-3yA.png"/></div></div></figure><p id="8f83" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">正如我们在上面的图像中看到的，整个应用程序在<strong class="kv io"> 1.3秒</strong>内加载，到达第一个字节的时间(<strong class="kv io"> TTFB </strong>)是<strong class="kv io">179毫秒！与react相比，Preact看起来要快得多，而且默认情况下它会处理所有事情。</strong></p><h1 id="2b2e" class="mr ms in bd mt mu mv mw mx my mz na nb jt nc ju nd jw ne jx nf jz ng ka nh ni bi translated">比较两款应用</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/9bb444c8a7c8432d30f457d91951a3bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O9LdOk29aN3jngqFAFLS1Q.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">ReactJS</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/a41a9a758c78eadbd7ac9203b3c6f0b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PX-b6GaCBG6JLDAk9M-3yA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">PREACT</figcaption></figure><p id="0654" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当并排查看页面加载时，preact应用程序比react应用程序提前加载，并且<strong class="kv io">交互时间</strong>也比React应用程序快。Preact默认为<a class="ae ks" href="https://web.dev/progressive-web-apps/" rel="noopener ugc nofollow" target="_blank">渐进式网络应用</a> (PWA)，因此在重复访问时即时加载。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/51ae5d2b80eda1151ea788cad40f6321.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*8xp-GZsmFDpy5yIWMSv2fg.png"/></div></figure><p id="19d8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Preact还给出一些有用的警告，说明在构建期间reg包的大小会增加，如下所示。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ns"><img src="../Images/77ee1518af02f574c215f46460b8e671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ViLzMI_4SJQQ0vm_2x6aw.png"/></div></div></figure><h1 id="9991" class="mr ms in bd mt mu mv mw mx my mz na nb jt nc ju nd jw ne jx nf jz ng ka nh ni bi translated">悬疑和懒惰</h1><p id="d624" class="pw-post-body-paragraph kt ku in kv b kw nj jo ky kz nk jr lb lc nl le lf lg nm li lj lk nn lm ln lo ig bi translated">当转换到Preact时，我面临的一些限制是<strong class="kv io">暂停</strong>和<strong class="kv io">延迟</strong>加载是实验性的，目前还不支持生产。但是对于routes目录，默认情况下启用基于路由的代码分割。</p><h1 id="1fb2" class="mr ms in bd mt mu mv mw mx my mz na nb jt nc ju nd jw ne jx nf jz ng ka nh ni bi translated">参考</h1><ol class=""><li id="4e4f" class="lp lq in kv b kw nj kz nk lc nt lg nu lk nv lo lu lv lw lx bi translated"><a class="ae ks" href="https://preactjs.com/" rel="noopener ugc nofollow" target="_blank">预先行动</a></li><li id="a7c7" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated"><a class="ae ks" href="https://preactjs.com/guide/v10/differences-to-react" rel="noopener ugc nofollow" target="_blank">差异反应过来</a></li></ol><h1 id="8285" class="mr ms in bd mt mu mv mw mx my mz na nb jt nc ju nd jw ne jx nf jz ng ka nh ni bi translated">结论</h1><p id="605b" class="pw-post-body-paragraph kt ku in kv b kw nj jo ky kz nk jr lb lc nl le lf lg nm li lj lk nn lm ln lo ig bi translated">根据上述比较，Preact在所有零件中均领先。由于减少了库的大小和速度，Preact使我们能够专注于开发功能，而不是手动优化。</p><p id="266f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">感谢您的阅读。</p><p id="9eaa" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="nw">更多内容请看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="nw">plain English . io</em></a><em class="nw">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="nw">免费每周简讯</em> </a> <em class="nw">。在我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <em class="nw">社区</em> </a> <em class="nw">获得独家写作机会和建议。</em></p></div></div>    
</body>
</html>