<html>
<head>
<title>How to Upload Images to Cloudinary with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Node.js上传图片到Cloudinary</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-upload-single-multiple-image-to-cloudinary-using-node-js-ae9db9f4a0b9?source=collection_archive---------2-----------------------#2021-02-04">https://javascript.plainenglish.io/how-to-upload-single-multiple-image-to-cloudinary-using-node-js-ae9db9f4a0b9?source=collection_archive---------2-----------------------#2021-02-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/6313dc4e1f87881a2b18682e8216cc5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RxJL40JY2Oi-xCSt"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@cgower?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Christopher Gower</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="e9a7" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">介绍</h1><p id="d34e" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">作为一个初学者，我总是想知道图像数据是如何存储的。它是像一个包含成千上万张图片的文件夹，还是以字符串形式存储在数据库中？</p><p id="2e9c" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">答案是图像文件存储在一些云存储服务上，如<a class="ae jz" href="https://cloudinary.com/" rel="noopener ugc nofollow" target="_blank"> Cloudinary </a>或<a class="ae jz" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> AWS S3 </a>，图像的url存储在数据库中。</p><p id="385e" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在这篇博客中，我们将看到如何在云存储服务(Cloudinary)上保存图像并使用图像的url，而不是将图像存储在本地文件夹中。</p><p id="a993" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">我们将使用Cloudinary，因为它需要最少的设置，并且易于使用。</p><p id="6120" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io"> <em class="mb">我也将很快在</em> </strong> <a class="ae jz" href="https://www.geeksforgeeks.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="la io"> <em class="mb">上发表</em></strong></a></p><h1 id="1214" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">先决条件</h1><p id="8f7a" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在我之前的<a class="ae jz" href="https://rugved-bongale.medium.com/how-to-upload-image-using-multer-in-node-js-f3aeffb90657" rel="noopener">博客</a>中，我们已经看到了如何使用multer库上传图片到服务器(我们的电脑)上的上传文件夹。</p><div class="mc md gp gr me mf"><a href="https://rugved-bongale.medium.com/how-to-upload-image-using-multer-in-node-js-f3aeffb90657" rel="noopener follow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd io gy z fp mk fr fs ml fu fw im bi translated">如何在node.js中使用multer上传图片？</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">每当你做一个网站，像社交媒体应用或博客应用，你很可能会有这样的功能，你会…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">rugved-bongale.medium.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt jt mf"/></div></div></a></div><p id="a5da" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">如果你想继续，你可以克隆下面提到的包含我以前的<a class="ae jz" href="https://rugved-bongale.medium.com/how-to-upload-image-using-multer-in-node-js-f3aeffb90657" rel="noopener">博客</a>代码的库。</p><p id="dfd5" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><a class="ae jz" href="https://github.com/RugvedB/Nodejs-Multer-File" rel="noopener ugc nofollow" target="_blank">https://github.com/RugvedB/Nodejs-Multer-File</a></p><h1 id="db09" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">我们要建造什么？</h1><p id="ce0f" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在这篇博客中，我们将看到如何上传图像到云存储(Cloudinary ),可以在全球范围内访问。上传成功后，我们将获得图像的url作为响应，我们将使用它来显示存储在Cloudinary上的图像。</p><h1 id="1819" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">理解流程</h1><p id="2f33" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">让我们首先通过一个例子来理解它是如何工作的。</p><p id="1669" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">例如，假设我们想把sample.jpg T21上传到Cloudinary。</p><ol class=""><li id="36a0" class="mu mv in la b lb lw lf lx lj mw ln mx lr my lv mz na nb nc bi translated">我们选择一个文件，并使用multer库将其保存到本地计算机文件夹中的“<strong class="la io"> uploads </strong>”文件夹。(我们在我之前的<a class="ae jz" href="https://rugved-bongale.medium.com/how-to-upload-image-using-multer-in-node-js-f3aeffb90657" rel="noopener">博客</a>中已经看到了这一点)</li></ol><p id="5548" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io"> <em class="mb">图像的本地路径= "uploads/sample.jpg" </em> </strong></p><p id="b65f" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">2.我们将编写一个函数，使用上述图像的本地路径，并将它上传到云服务器。</p><p id="775e" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">3.如果上传到云的过程是成功的，它将提供一个我们需要的图像url的一堆东西的响应。</p><p id="3b1f" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">4.从本地计算机的文件夹中删除图像，因为我们已经将它上传到Cloudinary。</p><p id="c31c" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">5.现在，我们可以将这个图像url存储在数据库中，或者基于用例对它做任何事情。在这篇博客中，我只是把它显示在html页面上。</p><h1 id="7c44" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">设置和实施</h1><ol class=""><li id="253e" class="mu mv in la b lb lc lf lg lj nd ln ne lr nf lv mz na nb nc bi translated">转到项目目录，安装Cloudinary。</li></ol><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="e4ab" class="np kb in nl b gy nq nr l ns nt">npm i cloudinary</span></pre><p id="206e" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">2.我们需要在index.js中声明以下导入</p><figure class="ng nh ni nj gt jo"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="e6dc" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">3.要使用cloudinary，您需要创建一个免费帐户并获取凭据。登录后，您可以在“帐户详情”部分的仪表板上找到所需的密钥，然后将其粘贴到index.js中</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="46a1" class="np kb in nl b gy nq nr l ns nt">// cloudinary configuration<br/>cloudinary.config({<br/>    cloud_name: "YOUR_CLOUD_NAME",<br/>    api_key: "YOUR_API_NAME",<br/>    api_secret: "YOUR_API_SECRET"<br/>});</span></pre><p id="b35a" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">4.现在，我们需要编写一个函数，它将接受本地图像文件的路径，并将它上传到Cloudinary。</p><figure class="ng nh ni nj gt jo"><div class="bz fp l di"><div class="nu nv l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">A function to upload local images to cloudinary</figcaption></figure><p id="1456" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">假设<strong class="la io"><em class="mb">locaFilePath = " uploads/sample . jpg "</em></strong><em class="mb">然后</em></p><p id="c8d3" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io"><em class="mb">filePathOnCloudinary = " main/uploads/sample . jpg "</em></strong></p><p id="ec35" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">我特意将“main”添加到<strong class="la io"><em class="mb">filePathOnCloudinary</em></strong><em class="mb"/>中，以表明我们可以在Cloudinary上创建嵌套的文件夹和子文件夹，只需将其作为path。</p><p id="79ce" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在本例中，将创建一个主<strong class="la io">文件夹，将<strong class="la io">上传</strong>作为其子目录，其中将保存<strong class="la io">sample.jpg</strong>。</strong></p><p id="595a" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">5.我们还需要一个助手函数来生成简单的html，我们将传递图像url列表，它将返回html来显示图像。</p><figure class="ng nh ni nj gt jo"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="4f01" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">6.我们将修改<strong class="la io"><em class="mb">/profile-upload-single</em></strong>route的代码，以使用我们刚刚创建的helper方法。</p><p id="023f" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io"> a. </strong>首先上传文件到本地机器的<strong class="la io">上传</strong>文件夹。<br/> <strong class="la io"> b. </strong>然后把这个本地镜像上传到Cloudinary。<br/> <strong class="la io"> c. </strong>如果上传成功，获取图片url作为响应。<br/> <strong class="la io"> d. </strong>生成html在网页上显示图片。</p><figure class="ng nh ni nj gt jo"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="036a" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">7.类似的情况还有“<strong class="la io"><em class="mb">/个人资料-上传-多重</em> </strong>”路线。在这种情况下，我们得到一个文件列表，我们将对其进行迭代，并应用与“<strong class="la io"><em class="mb">/profile-upload-single</em></strong>”相同的方法。</p><figure class="ng nh ni nj gt jo"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="5ef8" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io">现在让我们检查所有代码:</strong></p><p id="0ab4" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io"> <em class="mb"> index.js </em> </strong></p><figure class="ng nh ni nj gt jo"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h1 id="24f9" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">输出</strong></h1><p id="9173" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated"><strong class="la io">初始页面:</strong></p><figure class="ng nh ni nj gt jo gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/20321432902f8f34c3a4db9f38716d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*5kT4h4Ebg3hWeHdjVji0Tw.png"/></div></figure><p id="a261" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io">上传图像单(点击上传按钮前):</strong></p><figure class="ng nh ni nj gt jo gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/9a43b4d070178dcda112755b809e47d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*T7q3_LtK5YOigb_Rao6Bzg.png"/></div></figure><p id="74aa" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在Cloudinary上成功上传单个图像后。</p><p id="ac5f" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">网页:</p><figure class="ng nh ni nj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ny"><img src="../Images/4424f04d186f2a38f23a6ae020e73128.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MzMA2iXF51Dt_D3J1o-Tow.png"/></div></div></figure><p id="71c9" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">云二级控制台:</p><figure class="ng nh ni nj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nz"><img src="../Images/a2a57a0e06827b2273dffc6975ae556f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QZqSij6-T15NS_zQsNKbfQ.png"/></div></div></figure><p id="fbfb" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">类似地，对于多个图像:</p><figure class="ng nh ni nj gt jo gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/e4bb8cf464863b9e5a8f7737fcac8d6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*maOZLqluZEN9jdx3U2nuqg.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">After selecting 3 images and before clicking upload button</figcaption></figure><p id="04d3" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在Cloudinary上成功上传多张图片后。</p><p id="f539" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">网页:</p><figure class="ng nh ni nj gt jo gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/35e84039d1fb5104ea20f9f00ec5f769.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*h-SE4qytn-CvQ5b9JMgfqg.png"/></div></figure><p id="263a" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">云二级控制台:</p><figure class="ng nh ni nj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oc"><img src="../Images/328df9c7201100661cd813eb68aa7f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EfeU8HiNeGJymvCgKWoijA.png"/></div></div></figure><p id="d0c6" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">正如你所看到的，我们上传的图像保存在Cloudinary存储中，我们有它的URL，可以根据需要在全球范围内进一步访问和使用。</p><p id="f8ac" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">仅此而已！现在我们有一个网站，能够上传单个/多个图像到Cloudinary。</p><p id="c00e" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><em class="mb">了解高度、宽度、裁剪、半径、重力、不透明度等变换:</em><a class="ae jz" href="https://cloudinary.com/documentation/node_integration" rel="noopener ugc nofollow" target="_blank"><em class="mb"/></a><em class="mb">。</em></p><h1 id="6a68" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="3515" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">因此，我们已经成功地建立了一个网站，其中包含将单个/多个图像上传到Cloudinary的表单。</p><p id="0e66" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">对于代码，你可以访问<a class="ae jz" href="https://github.com/RugvedB/Nodejs-Cloudinary-File-Upload" rel="noopener ugc nofollow" target="_blank">https://github.com/RugvedB/Nodejs-Cloudinary-File-Upload</a></p><p id="45ba" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><em class="mb">原发于</em><a class="ae jz" href="https://www.gyaanibuddy.com/blog/how-to-upload-singlemultiple-image-to-cloudinary-using-nodejs/" rel="noopener ugc nofollow" target="_blank"><em class="mb">https://www . gyaanibuddy . com/blog/how-to-upload-single multiple-image-to-cloud inary-using-nodejs/</em></a></p></div></div>    
</body>
</html>