<html>
<head>
<title>A Complete Guide To Custom Events In JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中自定义事件的完整指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/a-complete-guide-to-custom-events-in-javascript-4db599b49551?source=collection_archive---------5-----------------------#2021-01-06">https://javascript.plainenglish.io/a-complete-guide-to-custom-events-in-javascript-4db599b49551?source=collection_archive---------5-----------------------#2021-01-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7a2f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">关于JavaScript中的自定义事件，您只需要知道</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0ed41277bb7501c5d6d291d5e31c67d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ee-ODUxU2yv4N_Nv.jpeg"/></div></div></figure><p id="83e9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="ln"> DOMContentLoaded </em> </strong>事件，在浏览器完成加载和解析<strong class="kt ir"> HTML </strong>到<strong class="kt ir"> <em class="ln"> unload事件的瞬间触发，</em> </strong>在用户离开你的站点之前触发。在Web应用程序中，事件几乎无处不在。这些事件有助于确定应用程序中刚刚发生了什么&amp;用户当时的具体状态以及更多。</p><p id="45b7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是可用的<strong class="kt ir"> JavaScript </strong>事件不足以描述应用程序的状态。</p><p id="534d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">例如，当用户登录失败并且您希望父组件知道失败时，就没有这样的登录失败事件。</p><p id="60f5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了解决这些问题，我们当然可以用JavaScript为我们的应用程序创建自定义事件。T15】</p><p id="4d5f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">我们将介绍:</strong></p><ol class=""><li id="3cc1" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated">如何在<strong class="kt ir"> JavaScript </strong>中使用和创建自定义事件</li><li id="f39e" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">使用<strong class="kt ir">客户事件</strong>构造函数。</li><li id="672d" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">调度<strong class="kt ir">自定义事件</strong>。</li><li id="e6e4" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">自定义事件如何工作。</li><li id="df04" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">在JavaScript中<strong class="kt ir">拖动&amp;放下</strong>。</li><li id="2a76" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">在JavaScript中使用<strong class="kt ir"> <em class="ln">对象析构。</em> </strong></li></ol><h1 id="d743" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">先决条件。</h1><ol class=""><li id="2d71" class="lo lp iq kt b ku mu kx mv la mw le mx li my lm lt lu lv lw bi translated"><strong class="kt ir">T33】HTML&amp;CSS。 </strong></li><li id="06a9" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated"><strong class="kt ir"> <em class="ln"> JavaScrip (ES6)。</em> </strong></li><li id="d76c" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated"><strong class="kt ir"> <em class="ln"> DOM &amp; DOM操纵。</em> </strong></li></ol><h1 id="2a36" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">1.如何在<strong class="ak"> JavaScript </strong>中创建自定义事件</h1><p id="d346" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">创建自定义事件肯定有两种方法:</p><ol class=""><li id="ca41" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated">使用<strong class="kt ir">事件</strong>构造函数。</li><li id="a478" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">使用<strong class="kt ir"> CustomEvent </strong>构造函数。</li></ol><p id="2ed4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ln">可以使用事件构造函数创建自定义事件，如下:</em></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="fc3e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们通过将事件名称传递给<strong class="kt ir">事件构造函数来创建事件<strong class="kt ir"> myevent，</strong>。</strong>事件名称区分大小写，因此我们将其命名为<strong class="kt ir"> myEvent </strong>和<strong class="kt ir"> MyEvent </strong>。</p><h2 id="f5fb" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">a)。<strong class="ak">气泡</strong></h2><p id="a060" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated"><strong class="kt ir"> <em class="ln"> bubbles </em> </strong>属性指定事件是否应该向上传播到父元素。</p><p id="b687" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果我们将此设置为true，它将在子元素中被调度，父元素可以监听事件并基于此执行操作。这是大多数<strong class="kt ir"> DOM </strong>事件的行为，对于自定义事件，它默认设置为<strong class="kt ir"> false </strong>。如果我们只想让它分派一个特定的元素，我们可以通过<strong class="kt ir"> <em class="ln"> event.stopPropagation()停止事件的传播。</em>T73】</strong></p><h2 id="18a0" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">b)。可取消</h2><p id="2577" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">这个名字包含了一切，cancelable指定了事件是否应该被取消。</p><p id="4bff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">默认情况下，原生DOM事件是可取消的，因此我们可以对其调用<strong class="kt ir"><em class="ln">event . preventdeafult()</em></strong>，如果自定义事件的cancelable设置为false，这将阻止事件的默认操作，因为调用<strong class="kt ir"><em class="ln">event . preventdeafult()</em></strong>不会执行任何操作。</p><h2 id="19f4" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">c)。组成</h2><p id="de70" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">composed属性指定事件是否应该从影子<strong class="kt ir"> DOM </strong>(使用web组件时创建的)冒泡到真正的<strong class="kt ir"> DOM。</strong></p><p id="d3d7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果<strong class="kt ir"> bubbles </strong>被设置为<strong class="kt ir"> <em class="ln"> false </em> </strong>，这个属性的值就无关紧要了，因为我们明确地告诉事件不要向上冒泡。如果您想在web组件中调度一个自定义事件，并在<strong class="kt ir"> real DOM </strong>中的父元素上监听它，那么composed属性需要设置为true。</p><p id="b9ab" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是这种方法有一个缺点，因为我们不能通过侦听器发送数据，而且在大多数应用程序中，我们希望能够从事件被发送到侦听器的地方发送数据。为此我们可以使用<strong class="kt ir"> <em class="ln"> CustomEvent </em> </strong>控制器。</p><blockquote class="nq"><p id="8db8" class="nr ns iq bd nt nu nv nw nx ny nz lm dk translated">还可以使用DOM事件发送数据。</p></blockquote><h1 id="2c9e" class="mc md iq bd me mf mg mh mi mj mk ml mm jw oa jx mo jz ob ka mq kc oc kd ms mt bi translated">2.使用CustomEvent构造函数</h1><p id="b3a1" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">可以使用<strong class="kt ir"> CustomEvent </strong>构造函数创建自定义事件，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="eeda" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通过<strong class="kt ir"> CustomEvent </strong>构造函数创建一个自定义事件类似于使用<strong class="kt ir"> Event </strong>构造函数创建一个自定义事件，唯一的区别在于作为第二个参数传递给构造函数的对象。在创建事件构造函数时，我们受到这样一个事实的限制，即我们不能通过事件将数据传递给侦听器。任何需要传递给监听器的数据都可以在初始化事件时创建的<strong class="kt ir"> <em class="ln"> detail </em> </strong>属性中传递。</p><h1 id="0b14" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">3.调度自定义事件</h1><p id="8ffb" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">创建事件后，您需要调度它们，事件可以被调度到任何扩展<strong class="kt ir">event target</strong>的对象，它们包括所有<strong class="kt ir"> HTML </strong>元素和文档、窗口。</p><p id="e262" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="ln">例如:</em> </strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="984e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了监听自定义事件，我们向您想要监听的元素添加了一个事件监听器。就像我们在原生DOM事件中做的一样。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h1 id="3e58" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">4.自定义事件如何工作</h1><p id="f03d" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">为了理解我们如何在JavaScript应用程序中使用自定义事件，我们将构建一个简单的应用程序，允许用户添加配置文件并自动获得配置文件卡。</p><h2 id="036e" class="ne md iq bd me nf ng dn mi nh ni dp mm la nj nk mo le nl nm mq li nn no ms np bi translated">用户界面</h2><p id="97b9" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">创建一个文件夹，命名为任何你喜欢的名字，并在文件夹中创建一个index.html<strong class="kt ir">文件。</strong></p><p id="bd24" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将以下内容添加到<strong class="kt ir"><em class="ln"/></strong>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="69ed" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将是页面的标记。</p><p id="d964" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该页面有两个部分，第一部分是允许用户执行以下操作的表单:</p><ol class=""><li id="a262" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated"><strong class="kt ir">通过拖拽&amp;或手动选择上传图像。</strong></li><li id="bdec" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated"><strong class="kt ir">输入姓名。</strong></li><li id="6f73" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated"><strong class="kt ir">进入职业。</strong></li></ol><p id="be46" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从表单中初始化的数据将显示在部分中，即profile卡中。而第二部分仅包含一些占位符文本和图像，则从表单接收的数据将覆盖内容占位符数据。</p><p id="d3cb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后创建下面的<strong class="kt ir"> style.css文件:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="c364" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后创建一个<strong class="kt ir"> index.js </strong>文件，这样我们就可以为应用程序添加功能。</p><h1 id="8b50" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">5.JavaScript中的拖放</h1><p id="8dcf" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">我们将添加通过拖放或手动选择上传图像的功能。为此，将以下内容添加到index.js文件中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="7c3f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这允许我们监听允许拖放操作所需的事件<strong class="kt ir">(拖拽、拖拽中心&amp; drop)。</strong></p><p id="f48e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在<strong class="kt ir"> handleDragOver </strong>函数中，我们确保被拖动的项目是一个文件，并将拖放效果设置为copy，此外<strong class="kt ir"> handleDragCenter </strong>也执行类似的功能，确保我们正在处理被拖动的文件。实际的工作发生在文件被丢弃的时候，我们使用<strong class="kt ir"> handleDrop </strong>来处理它。</p><p id="af0b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，我们阻止浏览器的默认操作，即在提交文件之前打开文件。我们还会验证这是否是一个图像，如果不是，我们会发送一条错误消息，让用户知道我们只接受图像文件。如果验证通过，我们将继续在下一步创建的<strong class="kt ir"><em class="ln">handle file upload</em></strong>函数中处理文件。</p><p id="689f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，用以下内容更新index.js文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="f733" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们可以像您一样简单地添加事件监听器，并在事件监听器被触发时调用<strong class="kt ir"><em class="ln">handlecarddupdate</em></strong>函数。</p><h1 id="ece5" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">6.JavaScript中的对象析构</h1><p id="e91c" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated"><strong class="kt ir"><em class="ln">handle card update</em></strong>接收事件作为参数。使用析构可以从<strong class="kt ir">事件.细节.</strong>中获取图像属性</p><p id="7b07" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将profile卡片中图片的<strong class="kt ir"> src </strong>属性设置为事件中的图片<strong class="kt ir"> URL </strong>。</p><p id="7d27" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要允许用户通过输入栏上传图像:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="83cb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">并且当用户选择图像时，将在文件输入上触发改变事件。我们可以处理第一个图像的上传，因为我们只需要一个图像的个人资料卡。</p><p id="db54" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们必须添加的下一个功能是更新姓名和职业:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="78cc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里我们监听change事件并调度card update事件，但是这一次数据不同，因为我们需要更新处理程序，以便能够处理图像以外的内容。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="6489" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在更新<strong class="kt ir">handlecarddupdate</strong>函数，看起来像上面的代码片段。我们再次使用对象析构从<strong class="kt ir">事件.细节</strong>中获取图像名称&amp;职业，并在获取数据后将它们显示在profile卡上。</p></div><div class="ab cl od oe hu of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="ij ik il im in"><blockquote class="nq"><p id="6940" class="nr ns iq bd nt nu nv nw nx ny nz lm dk translated">当您从事件的角度考虑时，更容易理解被调度的自定义和本机DOM事件。</p></blockquote><p id="b83f" class="pw-post-body-paragraph kr ks iq kt b ku ok jr kw kx ol ju kz la om lc ld le on lg lh li oo lk ll lm ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae op" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">订阅我们的YouTube频道</strong> </a> <strong class="kt ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>