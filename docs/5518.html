<html>
<head>
<title>Angular: How to Create a Reusable Component for using Templates in Ag-Grid Tables</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular:如何创建一个在Ag-Grid表格中使用模板的可重用组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-a-reusable-component-for-using-templates-in-ag-grid-tables-6d9a8dfc88e3?source=collection_archive---------4-----------------------#2021-11-16">https://javascript.plainenglish.io/creating-a-reusable-component-for-using-templates-in-ag-grid-tables-6d9a8dfc88e3?source=collection_archive---------4-----------------------#2021-11-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/c5ddc0d42387ef0462c23081762ab77a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5thltHkt_oKYACES"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@firosnv?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Firos nv</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f9d3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您希望表格能够与表格所在组件的属性和方法进行交互，那么在Ag-Grid表格中插入模板非常有用。</p><p id="74b4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">例如，如果您想要一个引导下拉列表或表格单元格中的一个按钮，使用&lt; ng-template &gt;创建一个<strong class="kc io"> TemplateRef </strong>并将其传递给表格进行渲染会更容易。</p><p id="1f47" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我举了一个非常简单的例子，在Ag-Grid表中显示作者列表和这些作者写的书。</p><p id="f33c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下面是我们将要使用的数据。这是一个从<strong class="kc io"> books.ts </strong>导出的对象数组</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="4de5" class="lh li in ld b gy lj lk l ll lm"><strong class="ld io">//books.ts</strong><br/>export const <strong class="ld io">books</strong>={“<strong class="ld io">books</strong>”:[{<br/>“<strong class="ld io">type</strong>”:”Horror”,”<strong class="ld io">authors</strong>”:[{“<strong class="ld io">name</strong>”:”Stephen King”,”<strong class="ld io">books</strong>”:[“Revival”,”Dark Half”,”Pet Sematary”,”Misery”,”The Girl who loved Tom Gordon”]},{“name”:”Dan Brown”,”books”:[“Origin”,”The Da Vinci Code”,”Digital Fortress”,”Angels and Demons”,”Deception Point”]},{“name”:”Katie Macalister”,”books”:[“Dragon Soul”,”Fire Born”,”Shadow Born”,”Life,Love and the Pursuit of Hotties”,”Time Crossed”]}<br/>]<br/>},<br/>{<br/>“<strong class="ld io">type</strong>”:”Science and Fiction”,”<strong class="ld io">authors</strong>”:[{“<strong class="ld io">name</strong>”:”Jules Verne”,”<strong class="ld io">books</strong>”:[“Twenty Thousand Leagues Under the Sea”,”Journey to the center of the Earth”,”From the Earth to the Moon”,”Around the Moon”,”Off On a Comet”]},{“name”:”H.G Wells”,”books”:[“The Time Machine”,”The War of the Worlds”,”The invisible man”,”The First Men in the Moon”,”The Sleeper awakes”]},{“name”:”Arthur C. Clark”,”books”:[“Childhood’s End”,”The Sentinel”,”The City and the Stars”,”The Final Oddyssey”,”Rendezvous with Rama”]}<br/>]<br/>}]}</span></pre><p id="f618" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">每个对象描述了书的类型，写了该类型的书的几个作者，以及他们写的书。</p><p id="7840" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们的目标如下:</p><ol class=""><li id="bfeb" class="ln lo in kc b kd ke kh ki kl lp kp lq kt lr kx ls lt lu lv bi translated">将上述数据填入Ag-Grid表，如下所示:</li></ol><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lw"><img src="../Images/6294292b7a01a1b4bb9e68478741307e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4EbJH7VJeanaSuLd2gDNWw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Horror Genre</figcaption></figure><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lx"><img src="../Images/16cbc70c5ccab0145fb4451cbfbf70b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*820Ye4Z4WzsrX4_nDD2mBQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Science and Fiction Genre</figcaption></figure><p id="367c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">2.为了演示Ag-Grid表、组件和指令之间的<strong class="kc io">通信，我添加了一个小功能:当用户点击任何作者时，他/她写的书将以黄色突出显示。</strong></p><p id="4d22" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">例如，当我点击作者卡莉·麦卡利斯特时，她写的书会如下突出显示:</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ly"><img src="../Images/6e410b2cbb6acb8c8e5192790a68b147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Clj7Bzmj8qhugbnZiNeyYw.png"/></div></div></figure><p id="d5b9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在让我们来看看组件模板:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="cbdd" class="lh li in ld b gy lj lk l ll lm">&lt;ng-template <strong class="ld io">let-row=”rowInfo” #authorList</strong>&gt;<br/>&lt;ul *ngIf=”row”&gt;<br/>&lt;li *ngFor=”let author of row.rowData.authors” <strong class="ld io">(click)=”showBook(author)”</strong>&gt;{{ author.name }}&lt;/li&gt;<br/>&lt;/ul&gt;<br/>&lt;/ng-template&gt;</span><span id="86c5" class="lh li in ld b gy lz lk l ll lm">&lt;ng-template <strong class="ld io">let-row=”rowInfo” #booksList</strong>&gt;<br/>&lt;ul *ngIf=”row”&gt;<br/>&lt;li *ngFor=”let author of row.rowData.authors”&gt;<br/>&lt;ng-container *ngFor=”let book of author.books”&gt;<br/>&lt;p <strong class="ld io">appBookHighlighter [selectedBooks]=”selectedBooks” [targetBook]=”book”</strong>&gt;{{ book }}&lt;/p&gt;<br/>&lt;/ng-container&gt;<br/>&lt;/li&gt;<br/>&lt;/ul&gt;<br/>&lt;/ng-template&gt;</span><span id="8583" class="lh li in ld b gy lz lk l ll lm"><strong class="ld io">&lt;ag-grid-angular</strong> [columnDefs]=”columnDefs” [defaultColDef]=”defaultColDef” class=”ag-theme-alpine” [rowData]=”rowData” (gridReady)=”onGridReady($event)”<br/>(firstDataRendered)=”dataRendered($event)”<br/>style=”width:100vh;height:100vw”&gt;<br/><strong class="ld io">&lt;/ag-grid-angular&gt;</strong></span></pre><p id="c39c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们定义了2个标签<ng-template>，引用<strong class="kc io">book list</strong>和<strong class="kc io"> authorList </strong>。它们将构成表格中<strong class="kc io">书籍</strong>和<strong class="kc io">作者</strong>栏的模板。我们稍后会谈到这一点。</ng-template></p><p id="e29f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">组件类别:</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="de5e" class="lh li in ld b gy lj lk l ll lm">export class <strong class="ld io">AppComponent </strong>{</span><span id="2e7b" class="lh li in ld b gy lz lk l ll lm">@ViewChild(‘<strong class="ld io">authorList</strong>’, { static: true }) authorList: TemplateRef&lt;any&gt;;<br/>@ViewChild(‘<strong class="ld io">booksList</strong>’, { static: true }) booksList: TemplateRef&lt;any&gt;;</span><span id="c117" class="lh li in ld b gy lz lk l ll lm">public <strong class="ld io">rowData </strong>= [];<br/>public <strong class="ld io">gridApi</strong>: any;<br/>public <strong class="ld io">columnDefs </strong>= [];<br/>public <strong class="ld io">selectedBooks</strong>:string[]=[];<br/>public <strong class="ld io">defaultColDef</strong>={<strong class="ld io">autoHeight: </strong>true<strong class="ld io">,resizable</strong>: true}</span><span id="bd2b" class="lh li in ld b gy lz lk l ll lm">ngOnInit() {<br/>this.<strong class="ld io">rowData </strong>= books.books;<br/>this.<strong class="ld io">columnDefs </strong>= [<br/>{<br/>headerName: ‘<strong class="ld io">Book Type</strong>’,<br/>field: ‘type’,<br/>},<br/>{<br/>headerName: ‘<strong class="ld io">Authors</strong>’,<br/>cellRendererFramework: <strong class="ld io">ReusableGridTemplateComponent</strong>,<br/>cellRendererParams: {<br/>ngTemplate: <strong class="ld io">this.authorList</strong>,<br/>}<br/>},<br/>{<br/>headerName: ‘<strong class="ld io">Books</strong>’,<br/>cellRendererFramework: <strong class="ld io">ReusableGridTemplateComponent</strong>,<br/>cellRendererParams: {<br/>ngTemplate: <strong class="ld io">this.booksList</strong>,<br/>}<br/>}<br/>];<br/>}</span><span id="027a" class="lh li in ld b gy lz lk l ll lm"><strong class="ld io">showBook(author){</strong><br/>this.selectedBooks=author.books;<br/>}</span><span id="91d5" class="lh li in ld b gy lz lk l ll lm"><strong class="ld io">onGridReady(params) {</strong><br/>this.gridApi = params.api;<br/>}</span><span id="8025" class="lh li in ld b gy lz lk l ll lm"><strong class="ld io">dataRendered(params) </strong>{<br/>params.api.sizeColumnsToFit();<br/>}</span><span id="1c17" class="lh li in ld b gy lz lk l ll lm">}</span></pre><p id="9e8a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当组件加载时，在ngOnInit生命周期钩子中，我们正在初始化表的<strong class="kc io"> rowData </strong>和<strong class="kc io"> columnDefs </strong>(列定义)。</p><p id="909c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> rowData </strong>用从books.ts导出的数组<strong class="kc io"> books </strong>初始化</p><p id="c261" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在<strong class="kc io"> columnDefs、</strong>中，我们定义了3列:<strong class="kc io">图书类型、作者和图书</strong>。</p><p id="139f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如你所知，数组<strong class="kc io">书籍</strong>中的每个对象都有2个属性:<strong class="kc io">类型</strong>和<strong class="kc io">作者</strong>。<strong class="kc io">图书类型</strong>列从属性<strong class="kc io">类型中获取其值。</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="9205" class="lh li in ld b gy lj lk l ll lm">{<br/>headerName: ‘<strong class="ld io">Book Type</strong>’,<br/>field: ‘type’,<br/>},</span></pre><p id="9c91" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> Authors </strong>列通过引用<strong class="kc io"> authorList </strong>从模板中获取其内容。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="b383" class="lh li in ld b gy lj lk l ll lm">{<br/>headerName: ‘<strong class="ld io">Authors</strong>’,<br/>cellRendererFramework: <strong class="ld io">ReusableGridTemplateComponent</strong>,<br/>cellRendererParams: {<br/>ngTemplate: <strong class="ld io">this.authorList</strong>,<br/>}<br/>}</span></pre><p id="3aa9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们已经创建了一个新组件:<strong class="kc io">ReusableGridTemplateComponent</strong>，其中将显示引用<strong class="kc io"> authorList </strong>的&lt; ng-template &gt;中定义的模板。</p><p id="325a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">ReusableGridTemplateComponent模板:</strong></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="4954" class="lh li in ld b gy lj lk l ll lm">&lt;ng-container <strong class="ld io">[ngTemplateOutlet]=”template” [ngTemplateOutletContext]=”context”</strong><br/>&gt;&lt;/ng-container&gt;</span></pre><p id="edb4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">变量template(传递给ngTemplateOutlet) </strong>将包含从ColumnDefs传递过来的TemplateRef ( <strong class="kc io"> authorList和book list</strong>)。</p><p id="48e3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了理解变量<strong class="kc io">上下文(传递给ngTemplateOutletContext) </strong>包含什么，让我们检查一下这个类。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="7037" class="lh li in ld b gy lj lk l ll lm">export class <strong class="ld io">ReusableGridTemplateComponent </strong>implements OnInit {<br/>constructor() {}</span><span id="0c64" class="lh li in ld b gy lz lk l ll lm"><strong class="ld io">public template: TemplateRef&lt;any&gt;;<br/>public context: any = {};</strong></span><span id="ef8b" class="lh li in ld b gy lz lk l ll lm">ngOnInit() {}<br/>// gets called once before the renderer is used<br/><strong class="ld io">agInit(params: ICellRendererParams)</strong> {<br/>this.setTemplateAndParams(params);<br/>}</span><span id="13a5" class="lh li in ld b gy lz lk l ll lm">// gets called whenever the cell refreshes<br/><strong class="ld io">refresh(params: ICellRendererParams)</strong> {<br/>this.setTemplateAndParams(params);<br/>}</span><span id="134b" class="lh li in ld b gy lz lk l ll lm"><strong class="ld io">setTemplateAndParams(params) </strong>{<br/>this.template = params[‘<strong class="ld io">ngTemplate</strong>’];<br/>this.context = {<br/>rowInfo: {<br/>rowData: params.data,<br/>rowId:params.node.id<br/>}};<br/>}<br/>}</span></pre><p id="9f5d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">正如前面在<strong class="kc io"> columnDefs </strong>中看到的，模板引用被传递给了<strong class="kc io"> cellRendererParams </strong>对象中的属性<strong class="kc io"> ngTemplate </strong>。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="d5be" class="lh li in ld b gy lj lk l ll lm">{<br/>headerName: ‘<strong class="ld io">Authors</strong>’,<br/>cellRendererFramework: <strong class="ld io">ReusableGridTemplateComponent</strong>,<br/>cellRendererParams: {<br/>ngTemplate: <strong class="ld io">this.authorList</strong>,<br/>}<br/>}</span></pre><p id="661e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此在<strong class="kc io"> setTemplateAndParams </strong>()中，变量模板<strong class="kc io">(传递给ngtemplateeoutlet)</strong>定义如下。它从params的<strong class="kc io"> ngTemplate属性</strong>中获取其值。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="583c" class="lh li in ld b gy lj lk l ll lm">this.template = params[‘<strong class="ld io">ngTemplate</strong>’];<br/>this.context = {<br/>rowInfo: {<br/>rowData: params.data,<br/>rowId:params.node.id<br/>}};</span></pre><p id="ae68" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">变量context(传递给ngTemplateOutletContext) </strong>是一个包含属性<strong class="kc io"> rowInfo的对象。</strong>这个属性<strong class="kc io"> rowInfo </strong>又是另一个具有两个属性<strong class="kc io"> rowData </strong>和<strong class="kc io"> rowId </strong>的对象。根据您在&lt; ng-template &gt;中需要的行信息，您可以传递更多的属性。</p><p id="fc25" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们现在将回到<ng-template>来理解如何使用上述属性。</ng-template></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="0928" class="lh li in ld b gy lj lk l ll lm">&lt;ng-template <strong class="ld io">let-row=”rowInfo” #authorList</strong>&gt;<br/>&lt;ul *ngIf=”row”&gt;<br/>&lt;li *ngFor=”let author of row.rowData.authors” <strong class="ld io">(click)=”showBook(author)”</strong>&gt;{{ author.name }}&lt;/li&gt;<br/>&lt;/ul&gt;<br/>&lt;/ng-template&gt;</span></pre><p id="4373" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">行</strong>包含<strong class="kc io">上下文对象</strong>的<strong class="kc io">行信息</strong>属性。<strong class="kc io"> rowInfo </strong>对象的<strong class="kc io"> rowData </strong>属性如下所示。它包含每一行的数据。我们需要做的就是遍历<strong class="kc io"> rowData </strong>的<strong class="kc io"> authors属性</strong>来显示作者姓名。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ma"><img src="../Images/8e2e2a43a70e28175f4e8f5cd5905cc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*BMtpV7HQ3bWdhKtQMr8o4w.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">rowData property</figcaption></figure><p id="7886" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当我们点击任何作者时，<strong class="kc io"> showBook() </strong>被调用，将该特定作者的对象(包含<strong class="kc io"> name </strong>属性和<strong class="kc io"> books </strong>属性)作为参数传递。</p><p id="746f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">例如，如果我单击<strong class="kc io">斯蒂芬·金</strong>，那么下面的对象将作为参数传递给<strong class="kc io"> showBook() </strong>。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="6373" class="lh li in ld b gy lj lk l ll lm">{“<strong class="ld io">name</strong>”:”Stephen King”,”<strong class="ld io">books</strong>”:[“Revival”,”Dark Half”,”Pet Sematary”,”Misery”,”The Girl who loved Tom Gordon”]}</span></pre><p id="0ff3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这个方法中，我们将对象的<strong class="kc io"> books </strong>属性赋给变量<strong class="kc io"> selectedBooks </strong>。这将有助于我们在图书栏中用黄色突出显示作者所写的图书。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="0789" class="lh li in ld b gy lj lk l ll lm"><strong class="ld io">showBook(author){</strong><br/>this.selectedBooks=author.books;<br/>}</span></pre><p id="91cb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了理解highlight函数是如何工作的，让我们检查一下<strong class="kc io">图书</strong>列是如何定义的。它与Authors列非常相似，但是唯一的区别是传递给<strong class="kc io">ReusableGridTemplateComponent</strong>的TemplateRef。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="c9ad" class="lh li in ld b gy lj lk l ll lm">{<br/>headerName: ‘<strong class="ld io">Books</strong>’,<br/>cellRendererFramework: <strong class="ld io">ReusableGridTemplateComponent</strong>,<br/>cellRendererParams: {<br/>ngTemplate: <strong class="ld io">this.booksList</strong>,<br/>}<br/>}</span></pre><p id="bd4c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">查看图书栏的<ng-template>。</ng-template></p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="a2cd" class="lh li in ld b gy lj lk l ll lm">&lt;ng-template <strong class="ld io">let-row=”rowInfo” #booksList</strong>&gt;<br/>&lt;ul *ngIf=”row”&gt;<br/>&lt;li *ngFor=”let author of row.rowData.authors”&gt;<br/>&lt;ng-container *ngFor=”let book of author.books”&gt;<br/>&lt;p <strong class="ld io">appBookHighlighter [selectedBooks]=”selectedBooks” [targetBook]=”book”</strong>&gt;{{ book }}&lt;/p&gt;<br/>&lt;/ng-container&gt;<br/>&lt;/li&gt;<br/>&lt;/ul&gt;<br/>&lt;/ng-template&gt;</span></pre><p id="3f7b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们首先遍历<strong class="kc io">行数据</strong>对象的属性<strong class="kc io">作者</strong>。在第一次迭代中，我们进行另一次迭代:迭代每个作者的<strong class="kc io">书籍</strong>属性。</p><p id="867f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这样，我们就可以以列表的形式显示图书名称。我们已经将<strong class="kc io">bookhighlight read active</strong>应用于正在显示的图书名称。该指令接受<strong class="kc io"> selectedBooks </strong>变量和书籍名称作为@Input()。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="bbf1" class="lh li in ld b gy lj lk l ll lm">&lt;p <strong class="ld io">appBookHighlighter [selectedBooks]=”selectedBooks” [targetBook]=”book”</strong>&gt;{{ book }}&lt;/p&gt;</span></pre><p id="e351" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当我们点击一个作者时，所选择的<strong class="kc io">书籍</strong>被设置为作者所写的书籍名称的数组(包含在<strong class="kc io">书籍属性</strong>中)。此步骤由前面已经讨论过的<strong class="kc io"> showBook() </strong>完成。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="5400" class="lh li in ld b gy lj lk l ll lm">export class <strong class="ld io">BookHighlighterDirective </strong>{<br/>constructor() {}</span><span id="b499" class="lh li in ld b gy lz lk l ll lm"><strong class="ld io">@Input(‘selectedBooks’) selectedBooks: any;<br/>@Input(‘targetBook’) targetBook: string;<br/>@HostBinding(‘style.backgroundColor’) bgColor: string;</strong></span><span id="085a" class="lh li in ld b gy lz lk l ll lm"><strong class="ld io">ngOnChanges() {</strong><br/>this.bgColor = this.selectedBooks.includes(this.targetBook)? 'yellow': 'transparent';<br/>}<br/>}</span></pre><p id="2f3e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果图书名称在<strong class="kc io">选择的图书</strong>列表中，则该特定图书名称将以黄色突出显示。</p><p id="f924" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了实现所有表格单元格的<strong class="kc io">文本环绕</strong>，需要两个步骤:</p><ol class=""><li id="60ff" class="ln lo in kc b kd ke kh ki kl lp kp lq kt lr kx ls lt lu lv bi translated">在组件中应用下面的CSS。</li></ol><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="3d5a" class="lh li in ld b gy lj lk l ll lm"><strong class="ld io">::ng-deep .ag-theme-alpine .ag-cell</strong> {</span><span id="770b" class="lh li in ld b gy lz lk l ll lm">word-break: break-all !important;<br/>white-space: normal !important;<br/>line-height: unset !important;<br/>}</span></pre><p id="2d88" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">2.将所有列的<strong class="kc io">自动高度属性设置为真</strong>。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="14f5" class="lh li in ld b gy lj lk l ll lm">public <strong class="ld io">defaultColDef</strong>={<strong class="ld io">autoHeight: </strong>true<strong class="ld io">,resizable</strong>: true}</span></pre><p id="9051" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这确保了表格单元格可以很容易地容纳任意数量的文本，而不会切断文本。</p><p id="f21a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最后，在我结束这个故事之前，我想分享一点信息。</p><p id="dd67" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在<strong class="kc io">重用leGridTemplateComponent中，</strong>我做了一个小的修改:上下文对象修改如下，即<strong class="kc io"> rowInfo </strong>属性被<strong class="kc io"> $implicit </strong>属性替换。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="28e7" class="lh li in ld b gy lj lk l ll lm">this.context = {<br/><strong class="ld io">$implicit</strong>: {<br/>rowData: params.data,<br/>rowId: params.node.id,<br/>}<br/>};</span></pre><p id="d730" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">影响是什么？Angular识别出<strong class="kc io">$隐式键</strong>，并将<strong class="kc io">自动将$隐式键的值绑定到&lt; ng-template &gt; </strong>中定义的字母行。因此<strong class="kc io">行</strong>不需要初始化为任何值。它可以简单地如下所示。这将使代码更简单一点。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="7a3a" class="lh li in ld b gy lj lk l ll lm">&lt;ng-template <strong class="ld io">let-row #authorList</strong>&gt;<br/>&lt;ul *ngIf=”row”&gt;<br/>&lt;li *ngFor=”let author of row.rowData.authors” <strong class="ld io">(click)=”showBook(author)”</strong>&gt;{{ author.name }}&lt;/li&gt;<br/>&lt;/ul&gt;<br/>&lt;/ng-template&gt;</span><span id="61bd" class="lh li in ld b gy lz lk l ll lm">&lt;ng-template <strong class="ld io">let-row #booksList</strong>&gt;<br/>&lt;ul *ngIf=”row”&gt;<br/>&lt;li *ngFor=”let author of row.rowData.authors”&gt;<br/>&lt;ng-container *ngFor=”let book of author.books”&gt;<br/>&lt;p <strong class="ld io">appBookHighlighter [selectedBooks]=”selectedBooks” [targetBook]=”book”</strong>&gt;{{ book }}&lt;/p&gt;<br/>&lt;/ng-container&gt;<br/>&lt;/li&gt;<br/>&lt;/ul&gt;<br/>&lt;/ng-template&gt;</span></pre><p id="1282" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您可以在以下链接查看完整代码:</p><div class="mb mc gp gr md me"><a href="https://stackblitz.com/edit/angular-yyhwuz?file=src/app/app.component.html" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd io gy z fp mj fr fs mk fu fw im bi translated">角形(叉形)- StackBlitz</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">编辑描述</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">stackblitz.com</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms jt me"/></div></div></a></div><p id="8601" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mt">多内容见于</em> <a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="mt">中</em></strong></a></p></div></div>    
</body>
</html>