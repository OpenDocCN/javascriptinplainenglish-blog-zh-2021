<html>
<head>
<title>Building a Node.js Server for the Gemini Protocol, The Lightweight Internet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为轻量级互联网Gemini协议构建Node.js服务器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/gemini-node-js-f5bff65e9dc1?source=collection_archive---------6-----------------------#2021-09-15">https://javascript.plainenglish.io/gemini-node-js-f5bff65e9dc1?source=collection_archive---------6-----------------------#2021-09-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="1d17" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">Java Script语言</h2><div class=""/><div class=""><h2 id="a7c9" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">听说过双子座吗？这是它的工作原理</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/3fb65f87a4e2d2bda10fa684b7398876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9SKBxLi2sjnG6O67kZj98w.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Source: the author</figcaption></figure><p id="fa2e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">双子座协议？如果你从未听说过它，不要担心——很多人都不知道它。双子座协议建立在我们对互联网的不满之上，由HTTP协议驱动。</p><p id="730b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">是的，我称之为双子座——一个协议。它不是网络的子集——它运行在自己的协议上，不能用普通的浏览器访问。<br/>但是为什么呢？</p><p id="c6d7" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">双子座的目标不是取代我们所知道的互联网。在网络的目标差异中，Gemini具有:</p><ul class=""><li id="4ec8" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated">更多的隐私和安全。该协议要求使用TLS进行加密。不支持会导致隐私问题的复杂数据类型，如CSS或图像文件。CSS是隐私问题？是的，这里是如何使用CSS 进行<a class="ae mj" rel="noopener ugc nofollow" target="_blank" href="/tracking-with-css-ec98e3d81046">用户跟踪。</a></li><li id="4ac5" class="ma mb iq lg b lh mk lk ml ln mm lr mn lv mo lz mf mg mh mi bi translated">客户端没有JavaScript这样的脚本。</li><li id="7308" class="ma mb iq lg b lh mk lk ml ln mm lr mn lv mo lz mf mg mh mi bi translated">最低限度的协议。目的是每个人都可以在这个互联网上建立一个存在，而不需要整个团队。例如，不可能进行缓存或压缩。客户机中的页面加载速度极快，即使在旧机器上也是如此。</li><li id="975e" class="ma mb iq lg b lh mk lk ml ln mm lr mn lv mo lz mf mg mh mi bi translated">页面的最小基础——带有最小标记的Gemini文件类型。</li></ul><p id="1e96" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们用Node.js托管一个双子页面吧！我不会深入探究双子座独有的功能，因为我自己也是新手。</p><h1 id="00dc" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">但是首先，安装一个Gemini客户端</h1><p id="ca06" class="pw-post-body-paragraph le lf iq lg b lh nh ka lj lk ni kd lm ln nj lp lq lr nk lt lu lv nl lx ly lz ij bi translated">我推荐使用Amfora作为客户端——至少我知道它在工作。在macOS上，可以用<code class="fe nm nn no np b">brew install amfora</code>安装。对于其他平台，请查看<a class="ae mj" href="https://github.com/makeworld-the-better-one/amfora" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>。对于其他受支持的客户端，请查看此<a class="ae mj" href="https://gemini.circumlunar.space/software/" rel="noopener ugc nofollow" target="_blank">官方列表</a>。</p><p id="7e0e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如果你不想永久安装任何东西，有一个可用的、第三方免费的<a class="ae mj" href="https://tildegit.org/solderpunk/gemini-demo-1/src/branch/master/gemini-demo.py" rel="noopener ugc nofollow" target="_blank"> Python客户端</a>，大约100行代码。只需复制文件并用Python运行即可。</p><h1 id="dc75" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">构建我们的服务器</h1><p id="7fdc" class="pw-post-body-paragraph le lf iq lg b lh nh ka lj lk ni kd lm ln nj lp lq lr nk lt lu lv nl lx ly lz ij bi translated">构建Gemini协议服务器有很多服务器库。甚至还有一个针对Node.js的，更确切的说是针对Express.js的。</p><p id="df9d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们可以用<code class="fe nm nn no np b">npm install gemini-server</code>安装。</p><p id="f8be" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在编写代码之前，我们需要为加密生成一个证书。您还记得，我说过Gemini强制使用TLS加密。生成证书很容易。OpenSSL应该默认安装在Linux和macOS上。这里有一个关于如何在Windows上安装的<a class="ae mj" href="https://www.cloudinsidr.com/content/how-to-install-the-most-recent-version-of-openssl-on-windows-10-in-64-bit/" rel="noopener ugc nofollow" target="_blank">指南</a>。</p><p id="78c8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">一旦OpenSSL安装在您的机器上，运行:</p><pre class="kp kq kr ks gt nq np nr ns aw nt bi"><span id="ebbe" class="nu mq iq np b gy nv nw l nx ny">openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes -subj '/CN=localhost'</span></pre><p id="c14a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">然后，您应该有两个证书文件。让我们创建我们的Express服务器。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="ecca" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如您所见，服务器提供了一个名为<code class="fe nm nn no np b">test.gemini</code>的文件——为了测试，我们需要创建一个。所谓的Gemtext非常简单。下面是一个包含标题、列表和斜体引用的小示例:</p><pre class="kp kq kr ks gt nq np nr ns aw nt bi"><span id="019c" class="nu mq iq np b gy nv nw l nx ny"># Hello world<br/>## This is a subheading</span><span id="55b7" class="nu mq iq np b gy ob nw l nx ny">* First list entry<br/>* Second list entry<br/>* Third list entry</span><span id="f671" class="nu mq iq np b gy ob nw l nx ny">&gt; The best about the Gemini protocol is the fact you can’t use CSS.<br/>- Everyone who ever touched CSS</span></pre><p id="902a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">当您将Gemtext保存为<code class="fe nm nn no np b">test.gemini</code>时，您就可以运行您的服务器了。不，我们不需要在<code class="fe nm nn no np b">app.listen</code>函数中提供端口——默认情况下，服务器将运行在Gemini端口上。</p><p id="5409" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">跑<code class="fe nm nn no np b">node &lt;your-server-file&gt;.js</code> —让我们看看我们的网站！</p><p id="ed00" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在，启动您的Gemini客户端。如果你像我一样，使用Amfora，在终端运行<code class="fe nm nn no np b">amfora</code>打开它。一旦启动，只需按空格键并输入以下网址:<code class="fe nm nn no np b">gemini://localhost/</code></p><p id="913e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">显然，我们在其他Gemini客户端中使用相同的URL。在我推荐的Python客户端中，可以即时输入网址。</p><p id="18a3" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">然后，页面应该会显示出来。在我的终端中，它看起来是这样的:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/fd02da08a1ec88ef7b5c44d29de89dd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*jc628FvE71plAyBoBPrB8Q.png"/></div></figure><p id="2301" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">构建一个双子页面就是这么简单！如果你想主办它，它不会变得更加困难。因为可以通过域访问任何服务器端口，所以可以通过现有的域托管Gemini页面。我发现Gemini网站上的许多页面都是使用相同域名的普通互联网页面的副本。由于托管了两个Express实例，您可以轻松地在两个互联网中构建页面。</p><p id="feee" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="od">更多内容请看</em><a class="ae mj" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lg ja"><em class="od">plain English . io</em></strong></a></p></div></div>    
</body>
</html>