<html>
<head>
<title>Generate Open Graph Meta Images On-Demand</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">按需生成开放图形元图像</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/generating-open-graph-meta-images-on-demand-1baa5d12e6e?source=collection_archive---------10-----------------------#2021-10-12">https://javascript.plainenglish.io/generating-open-graph-meta-images-on-demand-1baa5d12e6e?source=collection_archive---------10-----------------------#2021-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3074" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目前，web开发领域的一个趋势是定制的、按需开放的图形元图像。</p><p id="1f40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天，您将学习如何建立自己的服务，并开始按需生成图像！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/27bc86324f384c6ce6230c354caab223.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*15s3-T_gzn78WEXj"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Picture by <a class="ae lb" href="https://unsplash.com/@charissek" rel="noopener ugc nofollow" target="_blank">Charisse Kenion</a></figcaption></figure><h1 id="56ac" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">打开图表什么？</h1><p id="d686" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">如果你从未听说过开放图协议，让我尽快解释一下。</p><p id="9c1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Open Graph是脸书在2010年创建的协议。它的目标是简化和标准化我们向网页添加元数据的方式。元数据可以是任何东西，从你的页面标题到当有人分享你的链接时弹出的图像。</p><p id="cb88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你将把这些<code class="fe mf mg mh mi b">meta</code>标签放在你的HTML的头部，浏览器将能够理解你试图做什么。元数据已经成为SEO(搜索引擎优化)的一个重要部分，因为它帮助搜索引擎确定你的页面是关于什么的。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Some basic metadata from <a class="ae lb" href="https://www.w3schools.com/tags/tag_meta.asp" rel="noopener ugc nofollow" target="_blank">W3Schools</a></figcaption></figure><p id="ebdb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">元数据真正强大的部分是添加图像的能力。很多像Twitter、Discord和LinkedIn这样的服务可以呈现特定的图片，让你的链接脱颖而出！看看这个不和谐的例子。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ml"><img src="../Images/664f2eae7933418b324a59e7414ef532.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8P13XY979YlhnP2tDbEZZg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">An example of an Open Graph image</figcaption></figure><p id="3788" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然这很酷，但我们将会更上一层楼。</p><p id="3d83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们可以按需生成这些图像，并在其中加入一些变量，岂不是很酷？</p><p id="b31d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个完全可以实现的目标，让我们开始吧！</p><h1 id="98d5" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">我们的目标</h1><p id="9354" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我想要模仿的——以一种非常简单的方式——是来自Github的开放图形图像。我仍然记得我第一次看到这些照片的时候，我真的对这些照片中的细节感到惊讶！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/05a9257c4d4bb4a0a004c158270b76e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*L61ewOaSWF92-o3bLi-4GA.png"/></div></figure><p id="040a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可能会看到所有简单明了的主题，如标题和描述，但仔细看看底部。那个小条甚至显示了所用语言的分布！</p><p id="90a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然来自GitHub的那些看起来绝对令人惊叹，但我们将创建一些不那么复杂的东西。</p><p id="f8dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们今天要创造的是:</p><ul class=""><li id="3a5b" class="mn mo iq jp b jq jr ju jv jy mp kc mq kg mr kk ms mt mu mv bi translated">带有简单标题和副标题的图片</li><li id="3730" class="mn mo iq jp b jq mw ju mx jy my kc mz kg na kk ms mt mu mv bi translated">明/暗主题支持</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nb"><img src="../Images/e9a9d5b722e2e2abc282ffcb79ef49c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V5ve4iA5lNvYmAf-"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">The expected result!</figcaption></figure><h1 id="f340" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">一些急需的解释</h1><p id="b8dd" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">虽然我很想详细解释每一步，但事情太多了，不能从头开始。这就是为什么我用最终结果创建了一个方便的<a class="ae lb" href="https://github.com/driaug/og-image" rel="noopener ugc nofollow" target="_blank">回购</a>。这样你就能确定你得到了想要的结果，并直接把它们变成你自己的！</p><p id="6dec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在这里找到回购:<br/>【https://github.com/driaug/og-image T4】</p><p id="f78e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想玩我的主机版本，你可以在这里找到:<br/><a class="ae lb" href="https://og.driaug.com/Hi%20there!?subheader=Let%27s%20generate%20our%20own%20images&amp;theme=dark" rel="noopener ugc nofollow" target="_blank">https://og.driaug.com/Hi%20there!？subheader = Let % 27s % 20 generate % 20 our % 20 own % 20 images&amp;theme = dark</a></p><h2 id="20c6" class="nc ld iq bd le nd ne dn li nf ng dp lm jy nh ni lq kc nj nk lu kg nl nm ly nn bi translated">它是如何工作的</h2><p id="0c41" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我想你一定很好奇这一切是如何运作的。相信我，一旦我解释给你听，你可能会觉得和我了解它时一样愚蠢。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi no"><img src="../Images/a99926aa725573f57682cf2daf3d5b92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eKHQAuRpaMEh3o_X"/></div></div></figure><p id="7014" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简而言之，这个生成器所做的就是接受来自API的请求，使用提供的变量生成一些定制的HTML，呈现它，并使用<a class="ae lb" href="https://pptr.dev/" rel="noopener ugc nofollow" target="_blank">木偶师</a>截屏。仅此而已，别无其他！</p><p id="74e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们非常简单的例子中，我们将确切的字符串传递给API。如果你不想让人们伪造元图像，这可能是你想要避免的。</p><p id="75c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">幸运的是，你有无限的可能性！您可以做的是传递一个ID，而不是传递确切的字符串。一旦解析了ID，您就可以从数据库中获取记录，并从中获得所有详细信息！</p><h2 id="6fd3" class="nc ld iq bd le nd ne dn li nf ng dp lm jy nh ni lq kc nj nk lu kg nl nm ly nn bi translated">我如何使用这些图像？</h2><p id="097b" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">当您想要将图像添加到元数据中时，需要添加两个重要的标签。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">A simple example of meta images</figcaption></figure><p id="54db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们需要为Open Graph协议和Twitter添加一个标签。Twitter使用他们自己的图像标准，因为他们有一些非常酷的额外功能，你可以添加，但我们稍后会回到他们身上。</p><p id="19f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您的标签的内容键需要包含图像，或者在我们的例子中，包含生成图像的URL，这给了我们类似的东西。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Our dynamic meta images</figcaption></figure><h2 id="5bce" class="nc ld iq bd le nd ne dn li nf ng dp lm jy nh ni lq kc nj nk lu kg nl nm ly nn bi translated">我能把这个变成我自己的吗？</h2><p id="462d" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">是的，你可以！你可以叉回购，并为你的博客创建自己的元图像，启动…</p><p id="3acb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为这个想法和资源库最初是由Vercel创建的，所以我建议你也在他们的平台上托管它，它是免费的，而且速度非常快！</p><p id="142e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，你需要将<a class="ae lb" href="https://github.com/driaug/og-image" rel="noopener ugc nofollow" target="_blank">回购</a>分叉，这样你就有了自己的个人拷贝。</p><p id="ec85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在那之后，你需要做的就是去<a class="ae lb" href="https://vercel.com/new" rel="noopener ugc nofollow" target="_blank">https://vercel.com/new</a>把那个库链接到一个新项目，瞧，你已经准备好了！</p><p id="40bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想定制输出，这也是非常容易的！您可能希望更改的一些关键文件有:</p><ul class=""><li id="ca82" class="mn mo iq jp b jq jr ju jv jy mp kc mq kg mr kk ms mt mu mv bi translated">这个文件负责处理传入的请求并解析参数，如标题、副标题和主题。这里需要记住的重要一点是，如果你想添加更多的参数，你还需要改变<code class="fe mf mg mh mi b">api/lib/types.ts</code>中的<code class="fe mf mg mh mi b">ParsedRequest</code>类型！</li><li id="8cd3" class="mn mo iq jp b jq mw ju mx jy my kc mz kg na kk ms mt mu mv bi translated"><code class="fe mf mg mh mi b">api/lib/template.ts</code>，这个文件为图像生成样式和HTML。在这里你可以放上你自己的设计。</li><li id="d3d0" class="mn mo iq jp b jq mw ju mx jy my kc mz kg na kk ms mt mu mv bi translated"><code class="fe mf mg mh mi b">api/fonts</code>，这个文件夹包含了图像中使用的字体。您可以添加自己的字体，也可以依赖默认的web字体。</li></ul><h2 id="62b9" class="nc ld iq bd le nd ne dn li nf ng dp lm jy nh ni lq kc nj nk lu kg nl nm ly nn bi translated">为什么Twitter有自己的标签？</h2><p id="a895" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">正如你在前面的例子中看到的，Twitter需要一个单独的图片meta标签。这是因为Twitter在开放图协议的基础上有一些额外的怪癖和特性。</p><p id="cab4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们提供给你能力来指定他们想要你渲染的卡片类型，有各种选项可以选择，比如一个摘要卡片或者一个大图片。你可以在<a class="ae lb" href="https://developer.twitter.com/en/docs/twitter-for-websites/cards/guides/getting-started" rel="noopener ugc nofollow" target="_blank">他们的开发者文档页面</a>上找到所有细节！</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="0a87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">祝你有激动人心的一天！💛</p><p id="7745" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nw">更多内容尽在</em><a class="ae lb" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="nw">plain English . io</em></strong></a></p></div></div>    
</body>
</html>