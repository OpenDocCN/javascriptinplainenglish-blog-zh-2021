<html>
<head>
<title>Next.js Firebase v9: Delete a To-Do</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Next.js Firebase v9:删除待办事项</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/nextjs-firebase-v9-part-7-delete-a-todo-614a722147cf?source=collection_archive---------7-----------------------#2021-10-23">https://javascript.plainenglish.io/nextjs-firebase-v9-part-7-delete-a-todo-614a722147cf?source=collection_archive---------7-----------------------#2021-10-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e63f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第7部分:用Firebase Firestore添加材质UI图标和删除功能。</h2></div><p id="9c57" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这一部分，我们将在应用程序中添加删除功能。并且在我们添加删除功能之前，我们必须添加<code class="fe lb lc ld le b">&lt;DeleteIcon /&gt;</code>和<code class="fe lb lc ld le b">&lt;MoreVertIcon /&gt;</code>。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/61ab45050e875f6a6dedb1053a7d27ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vJPS8p_R9vbvTk_h.png"/></div></figure><p id="70de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ln" href="https://youtu.be/A-Ce4YyHMGk" rel="noopener ugc nofollow" target="_blank">视频教程</a>和<a class="ae ln" href="https://www.udemy.com/course/complete-nextjs-firebase-firestore-course/?couponCode=FREESOURCE" rel="noopener ugc nofollow" target="_blank">源代码</a></p><p id="5d1a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以先回到<strong class="kh ir"> Todo.js </strong>。</p><p id="319f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">进口<code class="fe lb lc ld le b">&lt;DeleteIcon /&gt;</code>和<code class="fe lb lc ld le b">&lt;MoreVertIcon /&gt;</code>。</p><pre class="lg lh li lj gt lo le lp lq aw lr bi"><span id="691f" class="ls lt iq le b gy lu lv l lw lx">import DeleteIcon from '@mui/icons-material/Delete';</span><span id="2124" class="ls lt iq le b gy ly lv l lw lx">import MoreVertIcon from '@mui/icons-material/MoreVert';</span><span id="6450" class="ls lt iq le b gy ly lv l lw lx">&lt;ListItem</span><span id="81d9" class="ls lt iq le b gy ly lv l lw lx">sx={{ mt: 3, boxShadow: 3 }}</span><span id="65b6" class="ls lt iq le b gy ly lv l lw lx">style={{ backgroundColor: '#FAFAFA' }}</span><span id="af96" class="ls lt iq le b gy ly lv l lw lx">secondaryAction={</span><span id="9242" class="ls lt iq le b gy ly lv l lw lx">&lt;&gt;</span><span id="e9d8" class="ls lt iq le b gy ly lv l lw lx">&lt;IconButton sx={{ m: 1 }} &gt;</span><span id="79eb" class="ls lt iq le b gy ly lv l lw lx">&lt;DeleteIcon /&gt;</span><span id="4931" class="ls lt iq le b gy ly lv l lw lx">&lt;/IconButton&gt;</span><span id="24df" class="ls lt iq le b gy ly lv l lw lx">&lt;IconButton&gt;</span><span id="93ec" class="ls lt iq le b gy ly lv l lw lx">&lt;MoreVertIcon /&gt;</span><span id="04bf" class="ls lt iq le b gy ly lv l lw lx">&lt;/IconButton&gt;</span><span id="0f7b" class="ls lt iq le b gy ly lv l lw lx">&lt;/&gt;</span><span id="cc82" class="ls lt iq le b gy ly lv l lw lx">}</span><span id="0084" class="ls lt iq le b gy ly lv l lw lx">&gt;</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi lz"><img src="../Images/bf9f404d4b44f98a20c2d99eb530943d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uVkAoOx9S8kzzV8y0-WWvA.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk">Todo with Delete Icon</figcaption></figure><h2 id="3232" class="ls lt iq bd mi mj mk dn ml mm mn dp mo ko mp mq mr ks ms mt mu kw mv mw mx my bi translated">创建删除功能</h2><p id="59f0" class="pw-post-body-paragraph kf kg iq kh b ki mz jr kk kl na ju kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">因为我们需要将id传递给删除函数，所以我们也需要从<code class="fe lb lc ld le b">&lt;TodoList&gt;</code>传递这个信息。所以，在<strong class="kh ir"> TodoList.js </strong>中，记得加id={todo.id}。</p><pre class="lg lh li lj gt lo le lp lq aw lr bi"><span id="cae7" class="ls lt iq le b gy lu lv l lw lx">&lt;div&gt;</span><span id="9bad" class="ls lt iq le b gy ly lv l lw lx">{todos.map(todo =&gt; &lt;Todo key={todo.id}</span><span id="4bb2" class="ls lt iq le b gy ly lv l lw lx"><strong class="le ir">id={todo.id}</strong></span><span id="f79e" class="ls lt iq le b gy ly lv l lw lx">title={todo.title}</span><span id="b66b" class="ls lt iq le b gy ly lv l lw lx">detail={todo.detail}</span><span id="6d5a" class="ls lt iq le b gy ly lv l lw lx">timestamp={todo.timestamp}</span><span id="40fa" class="ls lt iq le b gy ly lv l lw lx">/&gt;)}</span><span id="27a4" class="ls lt iq le b gy ly lv l lw lx">&lt;/div&gt;</span></pre><p id="6748" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<strong class="kh ir"> Todo.js </strong>中，创建<code class="fe lb lc ld le b">deleteTodo</code>函数，它会将id和事件传递给该函数。</p><p id="5c03" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须使用<code class="fe lb lc ld le b">stopPropagation</code>方法，因为<code class="fe lb lc ld le b">&lt;DeleteIcon /&gt;</code>位于todo项的顶部。</p><p id="d114" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过id指定哪个文档，然后删除那个文档，显示警报。</p><p id="aba1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用<code class="fe lb lc ld le b">doc</code>和<code class="fe lb lc ld le b">deleteDoc</code>功能，我们必须从Firebase firestore导入它们。另外，从firebase配置文件中导入<code class="fe lb lc ld le b">db</code>。</p><pre class="lg lh li lj gt lo le lp lq aw lr bi"><span id="d892" class="ls lt iq le b gy lu lv l lw lx">import { doc, deleteDoc } from “firebase/firestore”;<br/>import { db } from "../firebase";</span></pre><p id="3d43" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用<code class="fe lb lc ld le b">showAlert</code>功能，我们还必须通过使用<code class="fe lb lc ld le b">useContext(TodoContext</code>在顶部导入它。</p><pre class="lg lh li lj gt lo le lp lq aw lr bi"><span id="9df5" class="ls lt iq le b gy lu lv l lw lx">const { showAlert } = useContext(TodoContext);</span><span id="e142" class="ls lt iq le b gy ly lv l lw lx">const deleteTodo = async (id, e) =&gt; {</span><span id="3c11" class="ls lt iq le b gy ly lv l lw lx">e.stopPropagation();</span><span id="d5eb" class="ls lt iq le b gy ly lv l lw lx">const docRef = doc(db, "todos", id);</span><span id="6b26" class="ls lt iq le b gy ly lv l lw lx">await deleteDoc(docRef)</span><span id="b69f" class="ls lt iq le b gy ly lv l lw lx">showAlert('error', `Todo with id ${id} is deleted successfully`)</span><span id="f352" class="ls lt iq le b gy ly lv l lw lx">}</span></pre><h2 id="2177" class="ls lt iq bd mi mj mk dn ml mm mn dp mo ko mp mq mr ks ms mt mu kw mv mw mx my bi translated">将函数绑定到删除图标</h2><p id="f009" class="pw-post-body-paragraph kf kg iq kh b ki mz jr kk kl na ju kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">最后，我们将<code class="fe lb lc ld le b">deleteTodo</code>函数绑定到<code class="fe lb lc ld le b">IconButton</code>上。</p><pre class="lg lh li lj gt lo le lp lq aw lr bi"><span id="a5e3" class="ls lt iq le b gy lu lv l lw lx">&lt;&gt;</span><span id="4a45" class="ls lt iq le b gy ly lv l lw lx">&lt;IconButton sx={{ m: 1 }}</span><span id="a5fe" class="ls lt iq le b gy ly lv l lw lx">onClick={(e) =&gt; deleteTodo(id, e)}</span><span id="99fa" class="ls lt iq le b gy ly lv l lw lx">&gt;</span><span id="6541" class="ls lt iq le b gy ly lv l lw lx">&lt;DeleteIcon /&gt;</span><span id="d223" class="ls lt iq le b gy ly lv l lw lx">&lt;/IconButton&gt;</span><span id="9d20" class="ls lt iq le b gy ly lv l lw lx">&lt;IconButton&gt;</span><span id="e1ab" class="ls lt iq le b gy ly lv l lw lx">&lt;MoreVertIcon /&gt;</span><span id="f24d" class="ls lt iq le b gy ly lv l lw lx">&lt;/IconButton&gt;</span><span id="e62f" class="ls lt iq le b gy ly lv l lw lx">&lt;/&gt;</span></pre><h1 id="8b09" class="ne lt iq bd mi nf ng nh ml ni nj nk mo jw nl jx mr jz nm ka mu kc nn kd mx no bi translated">关注我们:<a class="ae ln" href="https://www.youtube.com/channel/UCu4-4FnutvSHVo9WHvq80Ww?sub_confirmation=1" rel="noopener ugc nofollow" target="_blank"> YouTube </a>，<a class="ae ln" href="https://ckmobile.medium.com/" rel="noopener"> Medium </a>，<a class="ae ln" href="https://www.udemy.com/user/cyruschan2/" rel="noopener ugc nofollow" target="_blank"> Udemy </a>，<a class="ae ln" href="https://www.linkedin.com/company/ckmobi/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>，<a class="ae ln" href="https://twitter.com/ckmobilejavasc1" rel="noopener ugc nofollow" target="_blank"> Twitter </a>，<a class="ae ln" href="https://www.instagram.com/ckmobile8050" rel="noopener ugc nofollow" target="_blank"> Instagram </a>，<a class="ae ln" href="https://app.gumroad.com/ckmobile" rel="noopener ugc nofollow" target="_blank"> Gumroad </a></h1><p id="866d" class="pw-post-body-paragraph kf kg iq kh b ki mz jr kk kl na ju kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated"><em class="np">更多内容看</em><a class="ae ln" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="np">plain English . io</em></strong></a></p></div></div>    
</body>
</html>