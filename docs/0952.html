<html>
<head>
<title>Strongly Typed Mongoose Models with Typegoose &amp; TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有Typegoose &amp; TypeScript的强类型猫鼬模型</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/strongly-typed-mongoose-models-with-typegoose-typescript-9290d4ed00ed?source=collection_archive---------3-----------------------#2021-02-28">https://javascript.plainenglish.io/strongly-typed-mongoose-models-with-typegoose-typescript-9290d4ed00ed?source=collection_archive---------3-----------------------#2021-02-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3c69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我的上一篇文章中，我们讨论了如何<a class="ae kl" href="https://tomanagle.medium.com/strongly-typed-models-with-mongoose-and-typescript-7bc2f7197722" rel="noopener">集成Mongoose和TypeScript </a>来手动创建强类型模型。在本文中，您将学习如何使用<a class="ae kl" href="https://github.com/typegoose/typegoose" rel="noopener ugc nofollow" target="_blank"> Typegoose </a>同时创建Mongoose模型&amp;类型脚本类型。</p><p id="eb89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">参见最终知识库:</strong><a class="ae kl" href="https://github.com/tomanagle/Typegoose-example" rel="noopener ugc nofollow" target="_blank">https://github.com/tomanagle/Typegoose-example</a></p><p id="4340" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">有什么问题？</strong></p><p id="6ee5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常，我们的应用程序中使用的数据形状都是从模型级别开始的。然后，我们用TypeScript复制这些数据形状，这样我们就可以通过应用程序来表示数据。Typegoose旨在消除在Mongoose和TypeScript中创建数据形状的需要，并在整个开发生命周期中保持形状同步。</p><p id="6dac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【Typegoose如何解决问题？</p><p id="ce0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Typegoose通过使用类和装饰器来输出Mongoose模型和TypeScript接口，从而解决了这个问题。类中的每个属性都有一个TypeScript类型和一个<code class="fe km kn ko kp b">@props</code>装饰器。装饰器将构建Mongoose模型，而TypeScript属性将用于构建接口。最后，这个类可以用来构建一个带有恰当命名的<code class="fe km kn ko kp b">getModelForClass</code>函数的模型</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kq"><img src="../Images/69742ef7162f091ea15b341b1403707b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EyBKgUaaPAMsexkkqdC9NA.png"/></div></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="7347" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们开始学习Typegoose之前，让我们快速回顾一下我们的起源。在上一个指南中，我们创建了两个模型。</p><p id="b5da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用户模型:</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="f00f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">和一个宠物模型:</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="c151" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这两个模型展示了我们将在Typegoose中复制的几个关键的Mongoose概念:</p><ul class=""><li id="2848" class="ll lm iq jp b jq jr ju jv jy ln kc lo kg lp kk lq lr ls lt bi translated">模式验证，如必需和唯一</li><li id="8e69" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">引用另一个模式</li><li id="ce09" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">嵌入子文档</li></ul><p id="8ee5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们看看如何用Typegoose重写上述模式。</p><p id="84e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用户模型现在看起来像这样:</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="611c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">宠物模型现在看起来像这样:</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="3905" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如您所看到的，每个模式都是由一个具有TypeScript类型的类定义的。然后，一个<code class="fe km kn ko kp b">@props</code>装饰器被放在每个类型的顶层，以定义Mongoose模式验证。</p><h2 id="8f3d" class="lz ma iq bd mb mc md dn me mf mg dp mh jy mi mj mk kc ml mm mn kg mo mp mq mr bi translated">虚拟</h2><p id="5ff9" class="pw-post-body-paragraph jn jo iq jp b jq ms js jt ju mt jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated">Mongoose虚拟类型是在输出中计算的数据类型。结果不会保存在文档中。它们非常适合于几个字段的连接。我还用它们来计算数组中子文档的数量，以保存发送给客户机的大型数据列表，这样就可以显示计数。</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="2822" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用将出现在文档上的虚拟字段:</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="349a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虚拟鹅文档:<a class="ae kl" href="https://typegoose.github.io/typegoose/docs/api/virtuals" rel="noopener ugc nofollow" target="_blank">https://typegoose.github.io/typegoose/docs/api/virtuals</a></p><p id="525c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虚拟猫鼬文档:<a class="ae kl" href="https://mongoosejs.com/docs/guide.html#virtuals" rel="noopener ugc nofollow" target="_blank">https://mongoosejs.com/docs/guide.html#virtuals</a></p><p id="c6a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">索引是任何数据库的重要组成部分，MongoDB也不例外。幸运的是，Typegoose支持使用<code class="fe km kn ko kp b">@index</code>装饰器进行索引。</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="d494" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Typegoose索引文档:<a class="ae kl" href="https://typegoose.github.io/typegoose/docs/api/decorators/indexes" rel="noopener ugc nofollow" target="_blank">https://type goose . github . io/type goose/docs/API/decorators/indexes</a></p><p id="9c88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">猫鼬指数文档:<a class="ae kl" href="https://mongoosejs.com/docs/guide.html#indexes" rel="noopener ugc nofollow" target="_blank">https://mongoosejs.com/docs/guide.html#indexes</a></p><h2 id="73ac" class="lz ma iq bd mb mc md dn me mf mg dp mh jy mi mj mk kc ml mm mn kg mo mp mq mr bi translated">最后的想法</h2><p id="e597" class="pw-post-body-paragraph jn jo iq jp b jq ms js jt ju mt jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated">Typegoose是独立声明您的TypeScript类型和Mongoose模型的一个很好的替代方法。这个存储库看起来维护得很好，最后一次提交是在撰写本文的13天前，问题部分报告了少量的错误。</p><p id="05c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，当使用库来定义应用程序的对象结构时，弄清楚前面可能有哪些障碍总是很重要的。你不希望不能以某种方式创建一个对象，因为你正在使用的助手库不支持它。</p><p id="17f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">最终储存库:</strong><a class="ae kl" href="https://github.com/tomanagle/Typegoose-example" rel="noopener ugc nofollow" target="_blank">https://github.com/tomanagle/Typegoose-example</a></p><p id="8f13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">类型鹅:</strong>T15】https://github.com/typegoose/typegoose</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="dbd5" class="lz ma iq bd mb mc md dn me mf mg dp mh jy mi mj mk kc ml mm mn kg mo mp mq mr bi translated">🌎让我们保持联系</h2><p id="27df" class="pw-post-body-paragraph jn jo iq jp b jq ms js jt ju mt jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated"><a class="ae kl" href="https://www.youtube.com/TomDoesTech" rel="noopener ugc nofollow" target="_blank">在YouTube上订阅</a> <br/> <a class="ae kl" href="https://discord.gg/4ae2Esm6P7" rel="noopener ugc nofollow" target="_blank">不和</a> <br/> <a class="ae kl" href="https://twitter.com/tomdoes_tech" rel="noopener ugc nofollow" target="_blank">推特</a> <br/> <a class="ae kl" href="https://www.tiktok.com/@tomdoestech" rel="noopener ugc nofollow" target="_blank">抖音</a> <br/> <a class="ae kl" href="https://www.facebook.com/tomdoestech" rel="noopener ugc nofollow" target="_blank">脸书</a><br/><a class="ae kl" href="https://www.instagram.com/tomdoestech" rel="noopener ugc nofollow" target="_blank">insta gram</a><br/><a class="ae kl" href="https://www.buymeacoffee.com/tomn" rel="noopener ugc nofollow" target="_blank">给我买杯咖啡</a></p></div></div>    
</body>
</html>