<html>
<head>
<title>What Are Floating-point Numbers?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是浮点数？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/what-are-floating-point-numbers-9363671f186c?source=collection_archive---------16-----------------------#2021-04-25">https://javascript.plainenglish.io/what-are-floating-point-numbers-9363671f186c?source=collection_archive---------16-----------------------#2021-04-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="bca8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">浮点是以二进制存储数字的一种方式。它允许我们用固定的空间存储大量的值。</p><p id="c16b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是，如果不小心的话，浮点数(也叫“floats”)会给你带来一些问题。</p><h2 id="1924" class="ki kj in bd kk kl km dn kn ko kp dp kq jv kr ks kt jz ku kv kw kd kx ky kz la bi translated">我为什么要在乎？</h2><p id="8658" class="pw-post-body-paragraph jk jl in jm b jn lb jp jq jr lc jt ju jv ld jx jy jz le kb kc kd lf kf kg kh ig bi translated">你有没有想知道:</p><ul class=""><li id="e006" class="lg lh in jm b jn jo jr js jv li jz lj kd lk kh ll lm ln lo bi translated">为什么JavaScript中的<code class="fe lp lq lr ls b">0.1</code> + <code class="fe lp lq lr ls b">0.3</code>不总是等于<code class="fe lp lq lr ls b">0.4</code>？</li><li id="ee2b" class="lg lh in jm b jn lt jr lu jv lv jz lw kd lx kh ll lm ln lo bi translated">我们如何用二进制存储非整数？</li></ul><p id="0105" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可能熟悉我们如何用二进制表示一个数。</p><p id="3ed0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">每个位代表2的幂，通过组合它们，我们可以产生每个整数:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/818e18db0401a85e6617a62220114018.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*wGbArsoyl9VuOMjqTIW2Ug.png"/></div></figure><p id="61ba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是当我们需要表示非整数的东西时，比如<code class="fe lp lq lr ls b">2.5</code>，会发生什么呢？</p><p id="02f5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们把这8位分成两半。</p><p id="0dfc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将使用“左”半部分来表示小数点前的数字(在我们的例子中为<code class="fe lp lq lr ls b">2</code>)，使用“右”半部分来表示小数点后的分数<em class="mg">(在本例中为<code class="fe lp lq lr ls b">0.5</code>)。</em></p><p id="c995" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个系统中，<code class="fe lp lq lr ls b">2.5</code>将被表示为<code class="fe lp lq lr ls b">0 0 1 0 1 0 0 0</code>:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/6fc019931c53bf626d0d5a33ee6224e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*vLOxXBkeFWGod2zzjlPGvw.png"/></div></figure><p id="8d56" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们现在可以表示分数，但是我们失去了很多范围。</p><p id="16e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">例如，我们不能用这种格式表示<code class="fe lp lq lr ls b">16.0</code>。这一点的左边没有足够的位。</p><p id="f6c9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们可以不断添加更多的位来存储更大的数字，但这种格式仍然非常有限。</p><p id="0bc0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有时我们想存储非常大的数字，在这种情况下，我们希望在左边有更多的位。其他时候，我们希望存储非常小的分数，在这种情况下，我们需要在左边存储更少的位，在右边存储更多的精度，</p><p id="3cda" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这就是浮点运算；一种存储数字的方式，允许指针移动以表示更大范围的值。</p><p id="309d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">浮点值的标准称为“IEEE 754”，它定义了32位和64位浮点(或“浮点”)值。</p><p id="ca1f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">每个32或64位浮点被分成3个部分。</p><ul class=""><li id="eee7" class="lg lh in jm b jn jo jr js jv li jz lj kd lk kh ll lm ln lo bi translated">第一位代表“符号”；<code class="fe lp lq lr ls b">0</code>为正数，或<code class="fe lp lq lr ls b">1</code>为负数</li><li id="b797" class="lg lh in jm b jn lt jr lu jv lv jz lw kd lx kh ll lm ln lo bi translated">接下来的8位称为“指数”</li><li id="1a7a" class="lg lh in jm b jn lt jr lu jv lv jz lw kd lx kh ll lm ln lo bi translated">最后23位是“尾数”</li></ul><p id="186b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们在一个公式中使用这3个值，它给出了浮点数代表的数字:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/6cc4d068cc58bde233d6dbbaed08eddb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Vmvhby1s5ji8fiwfdNBdWA.png"/></div></figure><p id="dda2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你不需要理解这个公式，只需要知道这种存储数字的方式意味着我们可以表示大得多的范围。</p><p id="8a57" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">通过使“指数”值变大或变小，我们可以表示非常小的分数或非常大的数。</p><p id="6cce" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这就是为什么它被称为“浮点”，它不像我们最初的例子那样有一个固定的点。相反，点“浮动”或移动，这取决于“指数”的大小。</p><h2 id="c37b" class="ki kj in bd kk kl km dn kn ko kp dp kq jv kr ks kt jz ku kv kw kd kx ky kz la bi translated">舍入误差</h2><p id="eafc" class="pw-post-body-paragraph jk jl in jm b jn lb jp jq jr lc jt ju jv ld jx jy jz le kb kc kd lf kf kg kh ig bi translated">有些数字我们无法用标准的十进制来精确表示。</p><p id="9a3d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">例如，我们不能用十进制精确地表示⅓<em class="mg"/>:</p><p id="66f4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe lp lq lr ls b">⅓ = 0.3333333...</code></p><p id="aef3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">二进制的一些数也是如此；它们不能被精确地表示出来。</p><p id="40c3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">比如让我们试着用二进制来表示<code class="fe lp lq lr ls b">0.1</code>。</p><p id="adb0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">同样，小数点后的值代表分数:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/5fc99e22c95477ad146cacc7a9d23dd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*5fa_be9iptUvCr24A2GB1Q.png"/></div></figure><p id="ecb2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是<em class="mg">非常接近</em>到<code class="fe lp lq lr ls b">0.1</code>——在这个例子中这是我们能做的最好的——但是它不是<em class="mg">确切地说是</em> <code class="fe lp lq lr ls b">0.1</code>。</p><p id="4fa4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们的点可以“移动”这一事实意味着，如果我们愿意，我们可以给这个分数增加更多的精度，但事实仍然是，我们不能用二进制来精确地表示一些数字。</p><p id="8d6c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这可能会导致一些有趣的舍入误差。</p><p id="0101" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你尝试用JavaScript计算<code class="fe lp lq lr ls b">0.2</code> + <code class="fe lp lq lr ls b">0.1</code>，你会得到<code class="fe lp lq lr ls b">0.30000000000000004</code>的答案:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/2de6c1e3a56a784efdd0d93d8de8a32e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*k129p6o9hNT3Z7EAkDohDQ.png"/></div></figure><p id="41ac" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是<em class="mg">非常接近</em>的正确答案，但不是<em class="mg">确切的</em>正确答案。</p><p id="4c4a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">考虑到这一点，我们通常通过检查浮点数之间的差异来比较浮点数。</p><p id="e327" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">例如，我们不是检查两个数字是否等于，而是检查它们之间的差异是否非常小。</p><pre class="lz ma mb mc gt mi ls mj mk aw ml bi"><span id="81cf" class="ki kj in ls b gy mm mn l mo mp">result1 === result2 // false<br/>(result1 - result2) &lt; 0.001 // true</span></pre><p id="a101" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当然，这是一个简化的例子。实际上，您可以选择一个适合您正在进行的计算的公差。</p><h2 id="4fd1" class="ki kj in bd kk kl km dn kn ko kp dp kq jv kr ks kt jz ku kv kw kd kx ky kz la bi translated">结论</h2><p id="c633" class="pw-post-body-paragraph jk jl in jm b jn lb jp jq jr lc jt ju jv ld jx jy jz le kb kc kd lf kf kg kh ig bi translated">感谢您的阅读。我希望您发现这很有用，并且现在对浮点数有了更好的理解。</p><p id="63b4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mg">订阅我的</em> <a class="ae mq" href="https://www.baseclass.io/newsletter/" rel="noopener ugc nofollow" target="_blank"> <em class="mg">简讯</em> </a> <em class="mg">先收到这个。</em></p><p id="0c6e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mg">更多内容请看</em><a class="ae mq" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mg">plain English . io</em></strong></a></p></div></div>    
</body>
</html>