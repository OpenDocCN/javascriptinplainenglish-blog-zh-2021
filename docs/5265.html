<html>
<head>
<title>How to Import Gatsby Posts into Medium with Gist Code Snippets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Gatsby的文章导入带有要点代码片段的媒体</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-import-gatsby-posts-into-medium-with-gist-code-snippets-168fbde623c5?source=collection_archive---------14-----------------------#2021-10-26">https://javascript.plainenglish.io/how-to-import-gatsby-posts-into-medium-with-gist-code-snippets-168fbde623c5?source=collection_archive---------14-----------------------#2021-10-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="4104" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Medium是一个很好的平台，可以与更广泛的受众分享你的博客文章，但有点烦人的是，要获得代码片段，你需要创建一个GitHub Gist ( <a class="ae ki" href="https://medium.com/pythoneers/9-different-ways-to-embedded-code-in-medium-9213cb4c0a2e" rel="noopener">或其他</a>)并将其嵌入到文章中。</p><p id="f8fd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">由于我在博客中写了很多教程，所以将我所有的代码片段一个一个地添加到GitHub Gist中要花很多时间，而且我非常懒，所以让我们自动化吧。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi kj"><img src="../Images/aee6895c7746915a835368e5d19ff762.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/0*HBIxZarzWhhcj_-R.png"/></div></figure><h1 id="0645" class="kr ks in bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">盖茨比的代码片段</h1><p id="09be" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">要在Gatsby中添加代码片段，您只需使用markdown三个反勾号和您正在使用的语言，如下例所示。</p><pre class="kk kl km kn gt lu lv lw lx aw ly bi"><span id="5c1e" class="lz ks in lv b gy ma mb l mc md">```javascript<br/>    console.log('hello world!');<br/>```</span></pre><p id="4055" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这样，Gatsby将生成如下所示的HTML。这对以后很重要。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="me mf l"/></div></figure><h1 id="8bb5" class="kr ks in bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">问题是</h1><p id="efff" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">Medium有一个超级有用的<a class="ae ki" href="https://medium.com/p/import" rel="noopener">工具，可以将任何地方的任何帖子导入到Medium story </a>中，但遗憾的是，每个代码片段都会被它忽略。</p><p id="fedf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">理想情况下，我可以为我的博客帖子创建一个特殊的URL，在那里我所有的代码片段都将被一个包含这些代码的GitHub Gist URL所取代，这正是我接下来要做的事情😎。</p><h1 id="193b" class="kr ks in bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">为媒体创建特殊的URL</h1><p id="9d48" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">我希望能够将<code class="fe mg mh mi lv b">/medium-import</code>添加到我的博客帖子的URL末尾，并加载一个特殊的帖子页面，所有代码片段都由GitHub Gists替换。</p><p id="a22c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<code class="fe mg mh mi lv b">gatsby-node.js</code>文件上，在<code class="fe mg mh mi lv b">createPages</code>函数中，我将在最后用<code class="fe mg mh mi lv b">/medium-import</code>路径创建一个额外的页面。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="6c7e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我所有的博客文章现在都可以通过<code class="fe mg mh mi lv b">/blog-post-url</code>和<code class="fe mg mh mi lv b">/blog-post-url/medium-import</code>访问。</p><h1 id="cdb8" class="kr ks in bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">为媒体生成不同的HTML</h1><p id="5d2d" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">对于<code class="fe mg mh mi lv b">generateMediumHTML</code>函数，我将使用<code class="fe mg mh mi lv b">querySelectorAll</code>找到所有带有代码片段的HTML节点，并用GitHub Gists URLs替换它们。</p><p id="5f1b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">由于所有这些代码都将在Node上执行，我将需要<a class="ae ki" href="https://github.com/jsdom/jsdom" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> jsdom </strong> </a>来操作<code class="fe mg mh mi lv b">HTML DOM</code>。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="c262" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所有代码片段将被替换为<code class="fe mg mh mi lv b">&lt;div class="gatsby-highlight" data-language="javascript"&gt;https://gist.github.com/some-gist-id&lt;/div&gt;</code>。</p><h1 id="adb7" class="kr ks in bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">使用GitHub Gist API</h1><p id="4fab" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">我将使用<a class="ae ki" href="https://docs.github.com/en/rest/reference/gists#create-a-gist" rel="noopener ugc nofollow" target="_blank"> GitHub Gist API </a>做两件事，获取我现有的所有Gist以避免用<code class="fe mg mh mi lv b">GET</code>请求创建同一个Gist两次，以及用<code class="fe mg mh mi lv b">POST</code>请求创建一个新的Gist。</p><p id="e79f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因为代码将在Node中执行，所以我将使用<a class="ae ki" href="https://github.com/node-fetch/node-fetch" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> node-fetch </strong> </a>来处理API请求。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="4457" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于<code class="fe mg mh mi lv b">generateGistUrlsForPost</code>函数，我将再次使用<code class="fe mg mh mi lv b">querySelectorAll</code>函数通过<code class="fe mg mh mi lv b">textContent</code>属性获取代码，然后通过Gist API将其发送给GitHub，为此我将需要一个<a class="ae ki" href="https://github.com/settings/tokens" rel="noopener ugc nofollow" target="_blank"> GitHub个人访问令牌</a>。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="me mf l"/></div></figure><h1 id="c225" class="kr ks in bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">呈现新的HTML</h1><p id="35ad" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh ig bi translated">在React组件模板中，我可以在<code class="fe mg mh mi lv b">pageContext</code>中访问一个名为<code class="fe mg mh mi lv b">mediumHTML</code>的新属性，这就是所有代码片段都被GitHub Gists替换的新HTML。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="674d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我可以进入<a class="ae ki" href="https://medium.com/p/import" rel="noopener">媒体导入工具</a>并通过<code class="fe mg mh mi lv b">/blog-post-url/medium-import</code>导入任何帖子。</p><p id="38c6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有了这些自动化，期待看到更多来自我的<a class="ae ki" href="https://pablopirata.medium.com/" rel="noopener">中型帖子</a>😊。</p></div><div class="ab cl mj mk hr ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ig ih ii ij ik"><p id="baa5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mq">最初发布于</em><a class="ae ki" href="https://pablo.gg/en/blog/coding/how-to-import-gatsby-posts-into-medium-with-gist-code-snippets/" rel="noopener ugc nofollow" target="_blank"><em class="mq">https://pablo . gg</em></a><em class="mq">。</em></p><p id="b343" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mq">更多内容请看</em><a class="ae ki" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mq">plain English . io</em></strong></a></p></div></div>    
</body>
</html>