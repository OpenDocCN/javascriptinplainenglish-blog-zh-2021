<html>
<head>
<title>How to Create a VSCode Extension with JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用JavaScript创建VSCode扩展</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-a-vscode-extension-with-javascript-4e466c58274e?source=collection_archive---------18-----------------------#2021-06-08">https://javascript.plainenglish.io/how-to-create-a-vscode-extension-with-javascript-4e466c58274e?source=collection_archive---------18-----------------------#2021-06-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f482" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Visual Studio代码使通过您自己的扩展添加功能变得很容易！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/a977bbe0e0736ef44ec4e12ea0045731.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*E1ReHYUAcGMxTPCD.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Photo Illustration by David Fekke</figcaption></figure><p id="dd63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lb">最初发布于</em><a class="ae lc" href="https://fek.io/blog/how-to-create-a-vs-code-extension-with-java-script/" rel="noopener ugc nofollow" target="_blank"><em class="lb">https://fek . io</em></a><em class="lb">。</em></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ld le l"/></div></figure><p id="04e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我最近写了关于使用<a class="ae lc" href="https://nodejs.org" rel="noopener ugc nofollow" target="_blank"> Node.js </a>创建自己的工具。现在有很多基于Node.js的应用程序，您可以使用JavaScript对其进行扩展。其中一个应用程序就是我写这篇文章时正在使用的Visual Studio代码。</p><h1 id="b196" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">VS代码</h1><p id="db74" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">如果你不熟悉Visual Studio Code，简称VSCode，那就是微软的开源代码编辑器。它用于许多不同类型的应用程序开发，从C++到Salesforce。从一开始，VSCode就是可扩展的。换句话说，您可以通过扩展非常容易地向它添加功能。这些扩展是用JavaScript编写的。</p><p id="bdc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">VSCode代码构建在<a class="ae lc" href="https://www.electronjs.org/" rel="noopener ugc nofollow" target="_blank"> Electron </a>之上，后者是GitHub基于Chromium和Node.js的框架，创建Electron是为了让web开发人员更容易地创建桌面应用程序。Web开发人员可以使用他们现有的技能来创建基于HTML、CSS和JavaScript等web技术的应用程序。这些电子应用程序可以在Windows、MacOS和Linux上跨平台运行。</p><h1 id="a0b0" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">创建插件</h1><p id="f4e1" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">几年前，我创建了一个用于生成新博客帖子的命令行工具，名为“blogpostgenerator”。你可以在NPM上找到它。该工具创建一个以当前日期命名的文件夹，然后创建一个带有一些元数据的frontmatter的markdown文件。</p><p id="eddf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">微软有关于如何为VSCode创建扩展的很好的文档，但是我正在考虑创建一个扩展，它可能需要用户输入一些我试图创建的文件名。下面是我如何创建我的扩展。</p><p id="cd02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以使用<a class="ae lc" href="https://yeoman.io/" rel="noopener ugc nofollow" target="_blank"> Yoeman </a>和一个名为“generator-code”的VSCode生成器创建一个hello world扩展。</p><pre class="km kn ko kp gt mi mj mk ml aw mm bi"><span id="9888" class="mn lg iq mj b gy mo mp l mq mr">npm install -g yo generator-code <br/>yo code</span></pre><p id="f970" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行这个程序时，我选择了JavaScript而不是TypeScript。如果要添加模块，您需要添加一个捆绑器，如esbuild或webpack。如果您使用TypeScript选项，它将为您提供一个与webpack一起安装的选项。</p><p id="d619" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将生成一个新的扩展项目。这个新搭建的扩展可以在Visual Studio代码中打开和调试。</p><pre class="km kn ko kp gt mi mj mk ml aw mm bi"><span id="fc4d" class="mn lg iq mj b gy mo mp l mq mr">code .</span></pre><p id="f826" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您将在项目中看到许多文件，包括“extension.js”、“jsconfig.json”和package.json文件。打开“extension.js”文件。</p><p id="fb65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ms mt mu mj b">activate</code>函数是扩展的主要入口点。它用<code class="fe ms mt mu mj b">vscode.commands.registerCommand</code>功能登记一个命令。该命令对应于package.json文件中“contributes”键中列出的命令。</p><p id="89f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以通过按F5键在VSCode中运行并测试它，这将启动一个扩展主机。然后，我们可以在MacOS上按下“command-shift-P ”,或者在Windows或Linux上按下“control-shift-P”。这将向用户提示命令面板。在这里我们可以输入<code class="fe ms mt mu mj b">Hello World</code>。这将显示信息框，其中包含来自我们命令的消息。</p><p id="f9de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们修改它来创建一个可以用来添加到我们的博客的降价文件。</p><p id="e64b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将以下要求添加到我们文件的开头，在带有<code class="fe ms mt mu mj b">const vscode = require('vscode')</code>的行下面。完成后，它应该是这样的。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mv le l"/></div></figure><p id="462f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“path”和“fs”模块免费包含在VSCode中，但我们需要将“lodash”安装到我们的开发依赖项中。我们可以在与我们的项目相同的路径中的命令行中这样做。</p><pre class="km kn ko kp gt mi mj mk ml aw mm bi"><span id="6eac" class="mn lg iq mj b gy mo mp l mq mr">npm install lodash --save-dev</span></pre><p id="a2c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将把‘lodash’添加到‘package . JSON’文件的‘dev dependencies’部分，并把实际的模块添加到‘node _ modules’文件夹。这里需要注意的重要一点是，在打包和发布我们实际的扩展时,' node_modules '文件夹将被排除在外。我们将需要添加一个捆绑器，以确保我们需要的来自lodash的功能包含在我们最终的扩展中。在这篇文章的最后，我们将详细介绍如何添加和配置捆绑器。</p><p id="eb3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们将以下函数添加到我们的“extension.js”文件的末尾。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mv le l"/></div></figure><p id="da02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里的第一个函数“startInputProcess”实际上会提示用户给他们的文章指定一个标题。一旦标题被捕获，它调用“createMarkdownFolder”函数，这将为我们的内容和markdown文件创建子目录。文件夹名称将基于当前日期，我们使用两个函数' getDateString '和' addLeadingZeros '来创建文件夹名称。最后一个函数“createMarkdownFile”将在我们刚刚创建的文件夹中创建markdown文件。</p><p id="e921" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们改变“activate(context)”函数，以便它使用我们添加到“extension.js”文件中的代码。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mv le l"/></div></figure><p id="6616" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个扩展还使用一个我们可以分配给它的设置，最终用户可以修改这个设置。我们需要修改package.json文件来添加这些设置选项。我们可以通过在“package.json”的“contributes”部分添加一个“configuration”键来做到这一点。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mv le l"/></div></figure><p id="6d30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将添加一个可以在我们的代码中查找的设置。在这里，我们将它默认为“src ”,但是用户可以将其更改为他们希望的项目下的任何路径。</p><h1 id="d2b3" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">捆绑我们的扩展</h1><p id="549b" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">我之前提到过，因为我们使用外部模块‘lodash ’,所以我们需要捆绑这个扩展。无论如何，捆绑您的扩展是一个好习惯。我们将使用“esbuild”来捆绑我们的扩展。让我们再次进入项目的命令行，添加以下模块。</p><pre class="km kn ko kp gt mi mj mk ml aw mm bi"><span id="070c" class="mn lg iq mj b gy mo mp l mq mr">npm i --save-dev esbuild</span></pre><p id="97dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们需要将以下脚本属性添加到“package.json”文件的“scripts”部分。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mv le l"/></div></figure><p id="2a4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还需要更改“main”属性，使其指向‘out’子目录中的‘main . js’文件。</p><pre class="km kn ko kp gt mi mj mk ml aw mm bi"><span id="cbfd" class="mn lg iq mj b gy mo mp l mq mr">"main": "./out/main.js"</span></pre><p id="ddd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们可以在命令行中使用下面的npm脚本来捆绑我们的扩展。</p><pre class="km kn ko kp gt mi mj mk ml aw mm bi"><span id="4a02" class="mn lg iq mj b gy mo mp l mq mr">npm run esbuild</span></pre><h1 id="afb2" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">包装我们的扩展</h1><p id="8b71" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">将我们的扩展打包供本地使用或发布到他们的市场需要添加和使用“vsce”命令行工具，并在Azure DevOps上注册为一个组织。我们先安装‘vsce’吧。</p><pre class="km kn ko kp gt mi mj mk ml aw mm bi"><span id="0a23" class="mn lg iq mj b gy mo mp l mq mr">npm i -g vsce</span></pre><p id="48bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你在Azure DevOps上没有组织，你可以按照这里的中的<a class="ae lc" href="https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/create-organization?view=azure-devops" rel="noopener ugc nofollow" target="_blank">说明来做。创建组织后，您将需要创建个人访问令牌。创建该令牌时，它需要具有以下详细信息。</a></p><ul class=""><li id="1fc3" class="mw mx iq jp b jq jr ju jv jy my kc mz kg na kk nb nc nd ne bi translated">指定一个名字</li><li id="71d6" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated">确保所有组织都可以访问该组织</li><li id="e677" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated">将范围设置为“自定义”，并确保分配市场&gt;管理范围</li></ul><p id="7d1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建个人访问令牌后，请将它复制到一个安全的地方，因为在使用“vsce”命令行工具登录时会用到它。</p><p id="2dab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在您有了公共访问令牌，我们可以登录并使用“vsce”打包我们的扩展。</p><pre class="km kn ko kp gt mi mj mk ml aw mm bi"><span id="72d4" class="mn lg iq mj b gy mo mp l mq mr">vsce login &lt;YourOrgName&gt;</span></pre><p id="d89a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它将提示您输入个人访问令牌。成功登录“vsce”后，您可以使用以下命令打包您的扩展。</p><pre class="km kn ko kp gt mi mj mk ml aw mm bi"><span id="ee43" class="mn lg iq mj b gy mo mp l mq mr">vsce package</span></pre><p id="b5b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将创建一个. vsix文件。通过输入以下命令，可以共享该文件并将其本地安装到VSCode。</p><pre class="km kn ko kp gt mi mj mk ml aw mm bi"><span id="3e33" class="mn lg iq mj b gy mo mp l mq mr">code --install-extension &lt;yourExtensionName&gt;-0.0.1.vsix</span></pre><h1 id="e8ee" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="cdbd" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">VSCode的一个奇妙之处是我们可以使用JavaScript和TypeScript来扩展它。这使得创建我们自己的开发工具作为发布扩展变得非常容易。感谢微软为开发者赞助了这么棒的工具！</p><div class="nk nl gp gr nm nn"><a href="https://code.visualstudio.com/api/get-started/your-first-extension" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">你的第一次延期</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">在这个主题中，我们将教你构建扩展的基本概念。确保你有Node.js和Git…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">code.visualstudio.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob kv nn"/></div></div></a></div><div class="nk nl gp gr nm nn"><a href="https://code.visualstudio.com/api/working-with-extensions/bundling-extension" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">捆绑扩展</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">将Visual Studio代码扩展(插件)与webpack绑定。</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">code.visualstudio.com</p></div></div><div class="nw l"><div class="oc l ny nz oa nw ob kv nn"/></div></div></a></div><div class="nk nl gp gr nm nn"><a href="https://code.visualstudio.com/api/working-with-extensions/publishing-extension" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">发布扩展</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">一旦你完成了一个高质量的扩展，你可以把它发布到VS代码扩展市场，这样其他人就可以…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">code.visualstudio.com</p></div></div><div class="nw l"><div class="od l ny nz oa nw ob kv nn"/></div></div></a></div><p id="db36" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lb">更多内容尽在</em><a class="ae lc" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank">T5】plain English . ioT7】</a></p></div></div>    
</body>
</html>