<html>
<head>
<title>Dynamic Imports in JavaScript Explained With Examples</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用例子解释JavaScript中的动态导入</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/dynamic-imports-in-javascript-explained-with-examples-c2122743e5ac?source=collection_archive---------4-----------------------#2021-06-21">https://javascript.plainenglish.io/dynamic-imports-in-javascript-explained-with-examples-c2122743e5ac?source=collection_archive---------4-----------------------#2021-06-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="444b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何在JavaScript中轻松使用动态导入？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2ebac53e953bbd9a085b24ed7d9bcd28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1syCm-n0L3ZZv52yDXDQUQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Image created with ❤️️ By author.</figcaption></figure><p id="5cd5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">动态导入是JavaScript ES2020规范的一大特色。它们是使ES6模块更加动态、强大和高性能的一种方式。除此之外，它们允许您在需要时有条件地导入模块。</p><p id="6163" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本文中，我们将通过与ES6静态导入的比较来了解动态导入。让我们开始吧。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="f7ca" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">静态进口</h1><p id="ee31" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">ES6模块中使用的语法是静态的。这意味着当你从一个特定的文件中导入一段代码时，无论你是否使用它，这个文件都会被加载。</p><p id="694a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这对性能不好，因为有时您从中导入代码的文件可能非常大。所以浏览器必须下载那个大文件。因此，这将影响性能和加载时间。</p><p id="87f0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们看一个简单的例子来展示静态导入是如何工作的:</p><p id="9cc2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将创建一个按钮，当你点击它时显示文本。我们需要建立一个包含3个文件的项目(<code class="fe mv mw mx my b">index.html</code>、<code class="fe mv mw mx my b">index.js</code>和<code class="fe mv mw mx my b">app.js</code>)。</p><p id="aaa9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我们需要创建HTML文件并将JavaScript文件与它链接起来:</p><pre class="kg kh ki kj gt mz my na nb aw nc bi"><span id="c88f" class="nd lz iq my b gy ne nf l ng nh">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;</span><span id="9c20" class="nd lz iq my b gy ni nf l ng nh">&lt;head&gt;<br/>    &lt;meta charset="UTF-8"&gt;<br/>    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;<br/>    &lt;title&gt;Document&lt;/title&gt;<br/>    <strong class="my ir">&lt;script type="module" src="index.js" defer&gt;&lt;/script&gt;<br/>    &lt;script type="module" src="app.js" defer&gt;&lt;/script&gt;</strong><br/>&lt;/head&gt;</span><span id="9262" class="nd lz iq my b gy ni nf l ng nh">&lt;body&gt;<br/>    <strong class="my ir">&lt;button&gt;Show Text&lt;/button&gt;<br/>    &lt;div class="text"&gt;&lt;/div&gt;</strong><br/>&lt;/body&gt;</span><span id="6d86" class="nd lz iq my b gy ni nf l ng nh">&lt;/html&gt;</span></pre><p id="c0ec" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在文件<code class="fe mv mw mx my b">app.js</code>中，我们将创建一个函数，将文本添加到具有HTML中的类<code class="fe mv mw mx my b">text</code>的div中。然后我们将使用ES6 <code class="fe mv mw mx my b">export default</code>导出该函数，以便稍后在<code class="fe mv mw mx my b">index.js</code>导入。</p><pre class="kg kh ki kj gt mz my na nb aw nc bi"><span id="be45" class="nd lz iq my b gy ne nf l ng nh"><em class="nj">//app.js</em></span><span id="d106" class="nd lz iq my b gy ni nf l ng nh"><br/>const textDiv = document.querySelector('body .text');</span><span id="c3a5" class="nd lz iq my b gy ni nf l ng nh">function showText(){<br/>    textDiv.innerHTML = "Hello World!";<br/>}</span><span id="382f" class="nd lz iq my b gy ni nf l ng nh"><strong class="my ir">export default</strong> showText;</span></pre><p id="4204" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，我们将转到文件<code class="fe mv mw mx my b">index.js</code>并创建一个单击事件，以便在我们单击按钮时调用函数<code class="fe mv mw mx my b">showText</code>。所以我们将使用静态ES6导入，以便从<code class="fe mv mw mx my b">app.js</code>导入函数<code class="fe mv mw mx my b">showText</code>。</p><pre class="kg kh ki kj gt mz my na nb aw nc bi"><span id="7e94" class="nd lz iq my b gy ne nf l ng nh"><em class="nj">//index.js<br/></em></span><span id="5311" class="nd lz iq my b gy ni nf l ng nh">//Import the function showText from app.js using a static import<br/><strong class="my ir">import showText from "./app"</strong></span><span id="6c74" class="nd lz iq my b gy ni nf l ng nh">//select the button element.<br/>const btn = document.querySelector('body button');</span><span id="d8cb" class="nd lz iq my b gy ni nf l ng nh">//Add the click event &amp; provide showText as a callback.<br/>btn.addEventListener("click", <strong class="my ir">showText</strong>)</span></pre><p id="5deb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，无论何时单击该按钮，文本<code class="fe mv mw mx my b">Hello World</code>都会显示在页面上。如您所见，我们使用了静态导入，我们的功能运行良好。然而，静态导入的问题是，无论您是否使用它，浏览器总是在加载时下载导入的代码。</p><p id="b215" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这种情况下，浏览器将在加载时下载文件<code class="fe mv mw mx my b">app.js</code>,即使它的代码尚未执行。这不好，想象一下如果文件非常大。这可能会影响网站的性能和加载时间。这就是动态导入发挥作用的地方。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="8c14" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">动态导入</h1><p id="e0e4" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">正如我所说的，动态导入允许我们在需要时有条件地导入模块。</p><p id="0c1e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以为了动态地导入一个模块，你必须像这样调用关键字<code class="fe mv mw mx my b">import</code>作为一个函数:<code class="fe mv mw mx my b">import("./path.js")</code>并且你传递它你的文件的路径，我在这里用<code class="fe mv mw mx my b">"./path.js"</code>只是作为一个例子。所以你必须走自己的路。</p><p id="7eab" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">另外，记住函数<code class="fe mv mw mx my b">import('')</code>返回一个承诺。这意味着你可以对它使用语法<code class="fe mv mw mx my b">.then</code>和<code class="fe mv mw mx my b">.catch</code>。</p><p id="0058" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里有一个例子:</p><pre class="kg kh ki kj gt mz my na nb aw nc bi"><span id="8503" class="nd lz iq my b gy ne nf l ng nh"><strong class="my ir">import</strong>('the path here')<br/>  .<strong class="my ir">then</strong>(module =&gt; {<br/>    //do something.<br/>  }).<strong class="my ir">catch</strong>(err =&gt; console.log(err.message));</span></pre><p id="7c34" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在在一个实例中使用动态导入。我们将使用上面创建一个按钮的同一个例子来尝试一下，当你点击它时，这个按钮会显示文本。</p><p id="1486" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以我们将创建我们的HTML文件并在<code class="fe mv mw mx my b">app.js</code>中导出函数<code class="fe mv mw mx my b">showText</code>，就像我们在上面的静态导入示例中所做的那样。然后我们将转到文件<code class="fe mv mw mx my b">index.js</code>并在那里使用动态导入。</p><p id="3086" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为负责动态导入的导入函数返回一个承诺，所以我们可以对它使用async和await语法。</p><p id="72a9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是一个例子:</p><pre class="kg kh ki kj gt mz my na nb aw nc bi"><span id="9788" class="nd lz iq my b gy ne nf l ng nh"><em class="nj">//index.js</em></span><span id="ec12" class="nd lz iq my b gy ni nf l ng nh"><em class="nj">//select the button element.</em><br/>const btn = document.querySelector('body button');</span><span id="d588" class="nd lz iq my b gy ni nf l ng nh"><em class="nj">//using a dynamic import with async/await to import showText function.<br/></em>btn.addEventListener("click", <strong class="my ir">async</strong>() =&gt;{<br/>    const <strong class="my ir">showText </strong>= <strong class="my ir">await</strong> <strong class="my ir">import("./app.js")</strong>;<br/>    <strong class="my ir">showText()</strong>;<br/>})</span></pre><p id="0b0e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，功能按预期运行，一旦我们单击按钮，文本就会显示出来。但是在这个例子中使用动态导入的好处是，只有当我们点击按钮时，浏览器才会下载导入的文件<code class="fe mv mw mx my b">app.js</code>。它不会总是在加载时下载。</p><p id="17f8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以这是一种在你只需要的时候加载内容的更有效的方式。这就是我喜欢动态导入的原因。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="1cfb" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">何时使用动态导入？</h1><p id="84d6" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">首先，动态导入不能替代静态导入。记住这一点。仅在必要时使用动态导入是一个好习惯。</p><p id="1004" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是一些必须使用动态导入的情况:</p><ul class=""><li id="a58c" class="nk nl iq kx b ky kz lb lc le nm li nn lm no lq np nq nr ns bi translated">当静态导入降低了代码的加载速度时。</li><li id="5810" class="nk nl iq kx b ky nt lb nu le nv li nw lm nx lq np nq nr ns bi translated">当您稍后才需要导入的代码时。</li><li id="81c7" class="nk nl iq kx b ky nt lb nu le nv li nw lm nx lq np nq nr ns bi translated">当静态导入增加内存使用时。</li><li id="f3fa" class="nk nl iq kx b ky nt lb nu le nv li nw lm nx lq np nq nr ns bi translated">当导入的模块在加载时不被执行或不存在时。</li></ul></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="b7f3" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">浏览器支持</h1><p id="1eec" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">除了IE浏览器，其他主流浏览器都支持动态导入。所以设置起来也没那么难。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/26d7650ae026313187d6c0c7ad00029e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*egowBbsSDBEwTGRWcM_-eg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Capture by the author from <a class="ae nz" href="https://caniuse.com/?search=dynamic%20import" rel="noopener ugc nofollow" target="_blank">CanIUse</a>.</figcaption></figure></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="37c3" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">结论</h1><p id="c7a1" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">正如您所看到的，一般来说，模块对于在JavaScript文件之间共享代码非常有用。动态导入是一种只在需要时加载内容的方式。所以如果有必要的话，一定要使用它们。如果没有，使用静态导入总是好的。</p><p id="a3cb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢您阅读这篇文章。希望你觉得有用。</p><p id="94b1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">更多阅读</strong></p><div class="oa ob gp gr oc od"><a rel="noopener  ugc nofollow" target="_blank" href="/7-awesome-apis-for-all-frontend-developers-a06c1057661"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">面向所有前端开发人员的7款出色的API</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">您的下一个项目可能需要的有用的API。</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="om l"><div class="on l oo op oq om or kp od"/></div></div></a></div><div class="oa ob gp gr oc od"><a rel="noopener  ugc nofollow" target="_blank" href="/4-awesome-things-you-can-do-using-only-html-10ab13a245ef"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">只用HTML就能做的4件了不起的事情</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">HTML比你想象的更有用。在以下情况下不需要JavaScript。</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="om l"><div class="os l oo op oq om or kp od"/></div></div></a></div><p id="ebdb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="nj">多内容于</em> <a class="ae nz" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="nj">浅显易懂</em> </strong> </a></p></div></div>    
</body>
</html>