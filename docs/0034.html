<html>
<head>
<title>How to set up a Node, Express + TypeScript App in 2021</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2021年如何设置节点，Express + TypeScript App</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-set-up-a-node-express-typescript-app-in-2021-1459e53a3090?source=collection_archive---------8-----------------------#2021-01-03">https://javascript.plainenglish.io/how-to-set-up-a-node-express-typescript-app-in-2021-1459e53a3090?source=collection_archive---------8-----------------------#2021-01-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="4b89" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">每天都有越来越多的包添加到npm数据库中，这导致新开发人员在设置一个支持TypeScript的简单Express应用程序时感到困惑。本文提供了一个简单易用的指南，帮助您设置一个具有TypeScript支持的良好结构化Node.js Express应用程序。</p></div><div class="ab cl ki kj hr kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="ig ih ii ij ik"><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/034a5c4b28765fc1b1900ea763768393.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KE6gJxbsyceORBoJkDZ0bw.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">ExpressTS — A robust NodeJS server with adding static type definitions (TypeScript)</figcaption></figure><p id="7cec" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Express.js应用程序近年来获得了一些关注。然而，对于类型安全编程来说，普通JavaScript仍然是一个问题。因此，需要将TypeScript集成到Express.js中。本指南不仅提供了设置支持TypeScript的结构化Express应用程序的分步说明，还解释了为什么选择某些包，以便作为开发人员的您了解项目中使用的每个包。</p></div><div class="ab cl ki kj hr kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="ig ih ii ij ik"><h1 id="8b33" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated"><strong class="ak">先决条件</strong></h1><p id="5756" class="pw-post-body-paragraph jk jl in jm b jn md jp jq jr me jt ju jv mf jx jy jz mg kb kc kd mh kf kg kh ig bi translated">这些是要在本地安装的必备软件。</p><ol class=""><li id="ebed" class="mi mj in jm b jn jo jr js jv mk jz ml kd mm kh mn mo mp mq bi translated">节点(如果没有，则在此安装节点)</li><li id="bc77" class="mi mj in jm b jn ms jr mt jv mu jz mv kd mw kh mn mo mp mq bi translated">npm(它随节点安装一起提供)</li><li id="743a" class="mi mj in jm b jn ms jr mt jv mu jz mv kd mw kh mn mo mp mq bi translated">git ( <a class="ae mr" href="https://git-scm.com/downloads" rel="noopener ugc nofollow" target="_blank">在此安装git版本控制</a></li></ol></div><div class="ab cl ki kj hr kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="ig ih ii ij ik"><h1 id="b28c" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">装置</h1><p id="47fc" class="pw-post-body-paragraph jk jl in jm b jn md jp jq jr me jt ju jv mf jx jy jz mg kb kc kd mh kf kg kh ig bi translated">入门有两种方式，主要是<code class="fe mx my mz na b">npm install -g</code>命令和<code class="fe mx my mz na b">npx</code>命令。<code class="fe mx my mz na b">npm install -g</code>命令将本地声明的包下载到全局node_modules文件夹，而<code class="fe mx my mz na b">npx</code>命令只执行节点包，不在本地存储。我将在下面提供这两种方法。不过，我建议使用<code class="fe mx my mz na b">npx</code>方法，因为它可以确保节点包总是最新版本。在本教程中，项目名称为express-ts-app。您应该根据您自己的项目名称对此进行更改。</p><p id="0c21" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">1.npm方法(不推荐—参见npx方法)</p><pre class="kq kr ks kt gt nb na nc nd aw ne bi"><span id="23e3" class="nf lg in na b gy ng nh l ni nj">$ npm install -g create-express-typescript-application <br/>$ create-express-typescript-application express-ts-app</span></pre><p id="e2af" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.npx方法</p><pre class="kq kr ks kt gt nb na nc nd aw ne bi"><span id="d92a" class="nf lg in na b gy ng nh l ni nj">$ npx create-express-typescript-application express-ts-app</span></pre><p id="82b1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦运行了上面的命令，就会创建下面的文件结构，并初始化git。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/6daa58dfbe794600c7471e0132d3adff.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*HDfXEtz0sZNRki5X3DHlag.jpeg"/></div></figure><p id="71a8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在src文件夹中，有三个子文件夹。它们是应用程序、常量和实用程序文件夹。有独立的<code class="fe mx my mz na b">index.ts</code>和<code class="fe mx my mz na b">server.ts</code>文件。<code class="fe mx my mz na b">index.ts</code>是整个应用的入口，主要监听tcp端口。<code class="fe mx my mz na b">server.ts</code>是快速应用程序的设置。请注意，所有路线都应位于app文件夹中。</p></div><div class="ab cl ki kj hr kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="ig ih ii ij ik"><h1 id="f596" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">了解使用的包</h1><p id="d2b9" class="pw-post-body-paragraph jk jl in jm b jn md jp jq jr me jt ju jv mf jx jy jz mg kb kc kd mh kf kg kh ig bi translated">由于这是一个轻量级的Express-TypeScript应用程序，它只包括5个包，即cors，Express，fs，helmet和morgan。</p><p id="b5f8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mx my mz na b">cors</code>是一个允许跨源XML请求调用的包。这是为了允许来自不同来源/URL的API调用。</p><p id="a617" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mx my mz na b">express</code>是一个最小且灵活的Node.js web应用程序框架，为web和移动应用程序提供了一组健壮的特性。</p><p id="01cf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mx my mz na b">fs</code>是一个Node.js文件系统包，允许代码与实际存储进行交互。</p><p id="0076" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mx my mz na b">helmet</code>是一个通过设置各种http头来保护express app的包。</p><p id="8273" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mx my mz na b">morgan</code>是通过控制台记录所有与express服务器通信的流量的记录工具。</p></div><div class="ab cl ki kj hr kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="ig ih ii ij ik"><h1 id="1b67" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">入门指南</h1><p id="c475" class="pw-post-body-paragraph jk jl in jm b jn md jp jq jr me jt ju jv mf jx jy jz mg kb kc kd mh kf kg kh ig bi translated">要开始，只需在项目目录的根目录下启动终端/cmd提示符。一旦到达那里，您就可以通过运行以下命令来启动开发环境。</p><pre class="kq kr ks kt gt nb na nc nd aw ne bi"><span id="d7f5" class="nf lg in na b gy ng nh l ni nj">$ npm run dev</span></pre><p id="e899" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">应用程序使用nodemon来侦听文件更改，如果src文件夹中有文件正在更新，则重新启动应用程序。成功启动服务器后，您可以在浏览器上转到<a class="ae mr" href="http://localhost:8080/api/server-status/" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/API/server-status/</a>。你应该看看</p><pre class="kq kr ks kt gt nb na nc nd aw ne bi"><span id="5797" class="nf lg in na b gy ng nh l ni nj">{<br/>    "status": "server is running"<br/>}</span></pre><p id="b293" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">另一个默认路由是<a class="ae mr" href="http://localhost:8080/api/server-status/routes" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/API/server-status/routes</a>，在这里可以看到所有注册的路由。</p></div><div class="ab cl ki kj hr kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="ig ih ii ij ik"><h1 id="a7a0" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">教程:创建API</h1><p id="2ef2" class="pw-post-body-paragraph jk jl in jm b jn md jp jq jr me jt ju jv mf jx jy jz mg kb kc kd mh kf kg kh ig bi translated">在本教程中，您将学习创建一个API来完成两个数的简单加法运算。</p><p id="25fe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请注意，API文件必须位于src/app/文件夹中，文件名以include router为关键字。您可以在如图所示的<code class="fe mx my mz na b">server.ts</code>文件中相应地修改这些规则。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="3aeb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">准备好后，在src/app/ folder调用addition中创建一个新文件夹。您可以在单独的终端中键入以下命令，通过<code class="fe mx my mz na b">npm run dev</code>命令让您的服务器继续运行。</p><pre class="kq kr ks kt gt nb na nc nd aw ne bi"><span id="febe" class="nf lg in na b gy ng nh l ni nj">$ mkdir src/app/addition</span></pre><p id="3a9d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，创建新文件call addition.router.ts。您可以在单独的终端中键入以下命令，通过<code class="fe mx my mz na b">npm run dev</code>命令让您的服务器继续运行。</p><pre class="kq kr ks kt gt nb na nc nd aw ne bi"><span id="5d31" class="nf lg in na b gy ng nh l ni nj">$ echo &gt; src/app/addition/addition.router.ts</span></pre><p id="c0d8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦创建了新文件，就可以开始了。从导入路由器开始，定义GET方法。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="569e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，通过URL查询字符串a和b获得输入，并检查它是否是有效的数字。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="5afb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦验证了输入是数字，就可以返回这个API了。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="eb1c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">API完成后，您可以从浏览器测试API。</p><p id="9b25" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae mr" href="http://localhost:8080/api/addition?a=hello&amp;b=world" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/API/addition？a=hello &amp; b=world </a>应该回来了</p><pre class="kq kr ks kt gt nb na nc nd aw ne bi"><span id="5350" class="nf lg in na b gy ng nh l ni nj">{<br/>    "message": "a and b are not number"<br/>}</span></pre><p id="c8d3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">还有<a class="ae mr" href="http://localhost:8080/api/addition?a=22&amp;b=09" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/API/addition？a=22 &amp; b=09 </a>应该返回</p><pre class="kq kr ks kt gt nb na nc nd aw ne bi"><span id="9a3c" class="nf lg in na b gy ng nh l ni nj">{<br/>    "equation": "22+9=31",<br/>    "input1": 22,<br/>    "input2": 9,<br/>    "output": 31<br/>}</span></pre><p id="ed40" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">至此，您已经成功地完成了一个GET API。其他http方法甚至<a class="ae mr" href="https://expressjs.com/en/starter/basic-routing.html" rel="noopener ugc nofollow" target="_blank"> Express.js </a>文档都可以参考src/app/sample文件夹。</p></div><div class="ab cl ki kj hr kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="ig ih ii ij ik"><h1 id="f60a" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="4701" class="pw-post-body-paragraph jk jl in jm b jn md jp jq jr me jt ju jv mf jx jy jz mg kb kc kd mh kf kg kh ig bi translated">在本指南中，您已经学习了如何设置一个完整的支持TypeScript的轻量级Express应用程序。您还学习了在刚刚创建的Express-TypeScript应用程序中创建一个简单的加法API。恭喜你！我希望这个指南有用。如果你想有更多的教程或概念，请留言！谢谢你。</p></div></div>    
</body>
</html>