<html>
<head>
<title>Weaving Fabric.js with anime.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用anime.js编织Fabric.js</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/weaving-fabric-js-with-anime-js-df23e0537b27?source=collection_archive---------6-----------------------#2021-05-13">https://javascript.plainenglish.io/weaving-fabric-js-with-anime-js-df23e0537b27?source=collection_archive---------6-----------------------#2021-05-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/0474b98e1b32808b3bb14dd0bc7dcc77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1391kLk-WBtd2l0J9FB-nA.gif"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">source: animejs.com</figcaption></figure><p id="6e2f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们大多数人在从事一个涉及摆弄画布的项目时都使用过/遇到过Fabric.js。它可以拖动简单的形状或者在上面定义动画。</p><p id="98e1" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">让我们从看一个织物对象开始。这是一个简单的织物物体的样子。</p><figure class="kx ky kz la gt jo"><div class="bz fp l di"><div class="lb lc l"/></div></figure><p id="d746" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">上面的对象是一个具有不同属性的结构矩形类型，这些属性定义了对象在画布上的呈现方式。</p><p id="9c80" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在第17行，我们用这个矩形对象的一些值来定义动画。<a class="ae ld" href="http://fabricjs.com/animation-easing" rel="noopener ugc nofollow" target="_blank">这是</a>制作动画后的样子。</p><p id="cf2d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">让我们看看anime.js如何在不同的对象上创建动画，特别是时间轴功能。因为有了时间线，我们可以像控制视频一样更舒适地控制动画。</p><figure class="kx ky kz la gt jo"><div class="bz fp l di"><div class="lb lc l"/></div></figure><p id="b1b7" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在上面的片段中，我们从定义动画的类型开始，我们还在这里定义了整个动画的持续时间。</p><p id="c832" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这里我们正在处理时间线动画。</p><ul class=""><li id="5135" class="le lf in kb b kc kd kg kh kk lg ko lh ks li kw lj lk ll lm bi translated">一旦我们创建了一个动画，我们就可以添加对象或子对象。</li><li id="d954" class="le lf in kb b kc ln kg lo kk lp ko lq ks lr kw lj lk ll lm bi translated">变量<code class="fe ls lt lu lv b">tl</code>是一个时间线对象，有一堆不同的属性，比如暂停、播放、重启、当前时间等。这就去。借助这些属性，用户可以控制动画的播放方式。</li></ul><p id="6b68" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">上面的代码片段显示了一个简单的平移动画，其中对象从左向右移动。</p><p id="0aec" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在anime.js库中提供的关键帧的帮助下，可以定义更细粒度的动画。</p><p id="c707" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">关键帧是一组对象，定义对象在该时刻的行为。</strong></p><ul class=""><li id="21a0" class="le lf in kb b kc kd kg kh kk lg ko lh ks li kw lj lk ll lm bi translated">关键帧中的每个对象都可以有不同的属性，包括位置、不透明度、比例以及对象动画的延迟。</li></ul><p id="7ede" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">一个示例关键帧看起来与此类似。</p><figure class="kx ky kz la gt jo"><div class="bz fp l di"><div class="lb lc l"/></div></figure><p id="396f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们现在对使用fabric.js和anime.js的动画有了一个基本的了解，而anime.js更适合像动画这样的视频，fabric.js用于处理画布并控制对象的行为。</p><p id="430e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在，问题是我们如何将这些结合在一起，使用anime.js中的时间轴来创建动画？</p><p id="b33a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们需要时间轴来支持所有基本的视频类控件。</p><p id="b51a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这可以通过在fabric对象上定义自定义属性来实现。例如:</p><ol class=""><li id="0674" class="le lf in kb b kc kd kg kh kk lg ko lh ks li kw lw lk ll lm bi translated">从第一个代码片段开始，您可以使用<code class="fe ls lt lu lv b">rect.setOptions({name:value}).</code>在rect对象上添加自己的属性</li><li id="3967" class="le lf in kb b kc ln kg lo kk lp ko lq ks lr kw lw lk ll lm bi translated">我们可以利用这些属性来定义织物对象本身的关键帧。</li><li id="ca72" class="le lf in kb b kc ln kg lo kk lp ko lq ks lr kw lw lk ll lm bi translated">我们可以有一个类似于<code class="fe ls lt lu lv b">_anim</code>的属性，它包含了构成该对象动画的所有关键帧。带有动画关键帧的示例对象如下所示</li></ol><figure class="kx ky kz la gt jo"><div class="bz fp l di"><div class="lb lc l"/></div></figure><p id="1366" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">不仅是图像/形状，你甚至可以添加视频作为织物对象，这在<code class="fe ls lt lu lv b">fabric.util.createClass</code>的帮助下是可能的。你可以在<a class="ae ld" href="http://fabricjs.com/polaroid" rel="noopener ugc nofollow" target="_blank">面料文档</a>中找到更多相关信息。</p><p id="97ff" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们可以使用这样不同的对象创建一个visualJson。一个visualJson看起来像这样</p><figure class="kx ky kz la gt jo"><div class="bz fp l di"><div class="lb lc l"/></div></figure><p id="7404" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们可以利用这个JSON在画布上呈现对象并播放动画。因此，问题是我们如何在<code class="fe ls lt lu lv b">_anim</code>属性上制作属性动画。</p><p id="3344" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们可以从创建一个时间线对象开始，然后播放我们需要关键帧的动画，这样我们就可以遍历对象数组并将关键帧添加到时间线对象中。一个简单的实现如下所示:</p><figure class="kx ky kz la gt jo"><div class="bz fp l di"><div class="lb lc l"/></div></figure><p id="bf00" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在上面的代码片段中，第一部分创建了一个时间轴对象，然后我们将对象关键帧添加到时间轴对象中。</p><p id="5720" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">每次对象更新时，画布都必须重新渲染，以反映这些变化。有了这个，我们可以在画布上以动画的形式播放visualJson。与在画布上加载visualJson相关的部分非常简单，可以用fabric canvas实例的<code class="fe ls lt lu lv b">loadFromJSON</code>方法来实现。</p><h2 id="5bae" class="lx ly in bd lz ma mb dn mc md me dp mf kk mg mh mi ko mj mk ml ks mm mn mo mp bi translated">更新动画:</h2><p id="0757" class="pw-post-body-paragraph jz ka in kb b kc mq ke kf kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw ig bi translated">到目前为止，我们已经学习了如何将visualJson(一组fabric对象)作为动画来播放。</p><p id="002a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">但是，如果我们想要更新/创建动画或删除现有的动画/对象呢？我们如何解释这些变化？</p><p id="0e84" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">让我们试着问一问，当我们执行这些操作中的任何一个而不考虑时间线对象时，visualJson会发生什么。</p><ul class=""><li id="ca8a" class="le lf in kb b kc kd kg kh kk lg ko lh ks li kw lj lk ll lm bi translated">当我们在结构对象本身中进行改变时，时间线对象不知道这些改变，因为它已经被初始化了。</li><li id="1165" class="le lf in kb b kc ln kg lo kk lp ko lq ks lr kw lj lk ll lm bi translated">为了在画布上正确呈现动画对象的任何改变，时间轴对象必须被重新初始化。这意味着用新的fabric对象和它们的<code class="fe ls lt lu lv b">_anim</code>属性创建一个不同的时间轴对象。</li><li id="b817" class="le lf in kb b kc ln kg lo kk lp ko lq ks lr kw lj lk ll lm bi translated">如果处理不当，这可能是非常迂腐的。必须进行仔细的设计考虑，以确保捕捉到与织物对象相关的任何变化。</li></ul><h2 id="a6ce" class="lx ly in bd lz ma mb dn mc md me dp mf kk mg mh mi ko mj mk ml ks mm mn mo mp bi translated">结合视频:</h2><p id="1787" class="pw-post-body-paragraph jz ka in kb b kc mq ke kf kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw ig bi translated">在本文的最后一部分，让我们看看如何将视频作为fabric对象添加，并与其他动画一起管理它们。</p><p id="e865" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">对于视频，我们需要做的是根据视频的延迟和持续时间来播放视频，也就是说，根据时间轴对象的</strong> <code class="fe ls lt lu lv b"><strong class="kb io">currenTime</strong></code> <strong class="kb io">属性，我们应该决定在画布上播放和显示哪个视频。</strong>在暂停/播放/重启时间线时，我们应该确保与视频同步。</p><p id="af76" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我希望这能帮助你对fabric.js和anime.js的协同工作有一个基本的了解，这应该是你开始为复杂的功能做设计决策的一个很好的起点。</p><p id="fe8c" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我做过一个非常大的项目，涉及到使用Fabric.js，anime.js，React with Typescript制作不同种类的动画。因此，如果您有任何问题/疑问，请随时在我的Twitter上联系我。我把我的推特账号放在下面。</p></div><div class="ab cl mv mw hr mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ig ih ii ij ik"><div class="kx ky kz la gt nc"><a href="https://twitter.com/shash__wat" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd io gy z fp nh fr fs ni fu fw im bi translated">JavaScript不可用。</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">编辑描述</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">twitter.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq jt nc"/></div></div></a></div><p id="490a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><em class="nr">更多内容尽在</em><a class="ae ld" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="nr">plain English . io</em></a></p></div></div>    
</body>
</html>