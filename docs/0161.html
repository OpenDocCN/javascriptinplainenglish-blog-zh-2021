<html>
<head>
<title>Track Website User Journeys With Klaviyo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Klaviyo追踪网站用户的旅程</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/track-user-journey-and-send-highly-targeted-emails-with-klaviyo-7444746a5d76?source=collection_archive---------10-----------------------#2021-01-09">https://javascript.plainenglish.io/track-user-journey-and-send-highly-targeted-emails-with-klaviyo-7444746a5d76?source=collection_archive---------10-----------------------#2021-01-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/ddad91be302a8a717a6e4040ed25c5df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4_78x70AI5cq9_9SFce-hw.png"/></div></div></figure><p id="c8e9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本教程中，我们将学习如何跟踪用户的旅程，并在此基础上，向用户发送极具针对性的电子邮件。</p><p id="59b1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">使用Klaviyo，您可以设置一个自动序列，该序列可以通过设置特定的触发器来激活。这就是所谓的心流。可以建立Klaviyo流，以便及时向接收者发送信息。他们可以应用某些操作，例如当用户将产品添加到购物车，但在一段时间内没有结帐时，向用户发送放弃购物车的电子邮件。</p><p id="7d8d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以，事不宜迟，我们开始吧。</p><h1 id="ab26" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">设置Klaviyo</h1><ul class=""><li id="8355" class="lr ls in jx b jy lt kc lu kg lv kk lw ko lx ks ly lz ma mb bi translated">从<a class="ae mc" href="https://www.klaviyo.com/register" rel="noopener ugc nofollow" target="_blank">这里</a>设置一个Klaviyo账户。记下<code class="fe md me mf mg b">PUBLIC_API_KEY</code>或公司id。</li><li id="2be9" class="lr ls in jx b jy mh kc mi kg mj kk mk ko ml ks ly lz ma mb bi translated">给页面的<code class="fe md me mf mg b">head</code>添加<code class="fe md me mf mg b">script</code>标签。用你的钥匙替换<code class="fe md me mf mg b">PUBLIC_API_KEY</code>。</li></ul><pre class="mm mn mo mp gt mq mg mr ms aw mt bi"><span id="bc11" class="mu ku in mg b gy mv mw l mx my">&lt;script async type="text/javascript" src="//static.klaviyo.com/onsite/js/klaviyo.js?company_id=PUBLIC_API_KEY"&gt;&lt;/script&gt;</span></pre><h1 id="7d33" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">识别人员</h1><p id="767e" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg mz ki kj kk na km kn ko nb kq kr ks ig bi translated">一旦<code class="fe md me mf mg b">script</code>被加载，您可以使用<code class="fe md me mf mg b">identify</code>方法识别个人。此方法接受属性的字典或哈希。当您识别某人时，您必须使用<code class="fe md me mf mg b">$email</code>键输入其电子邮件地址，或者，如果您只有SMS联系人，则使用<code class="fe md me mf mg b">$phone_number</code>键输入其电话号码。</p><ul class=""><li id="926e" class="lr ls in jx b jy jz kc kd kg nc kk nd ko ne ks ly lz ma mb bi translated">为了获得最佳结果，请在用户登录/注册时或者在页面加载时(如果他们已经登录)传递所有必要的数据。</li><li id="4935" class="lr ls in jx b jy mh kc mi kg mj kk mk ko ml ks ly lz ma mb bi translated">Klaviyo有一些预定义的属性，如<code class="fe md me mf mg b">email</code>或<code class="fe md me mf mg b">phone_number</code>，但是您也可以传递自定义属性，这些属性对于跟踪个人信息非常有用。在Klaviyo中，您可以根据这些属性创建人群。例如，您可能希望跟踪个人的计划类型或注册日期。Klaviyo还会理解您使用的不同数据类型，因此可以随意使用数字、布尔值和日期。</li></ul><pre class="mm mn mo mp gt mq mg mr ms aw mt bi"><span id="6003" class="mu ku in mg b gy mv mw l mx my">var _learnq = typeof window !== "undefined" ? window._learnq : [];</span><span id="c210" class="mu ku in mg b gy nf mw l mx my">_learnq.push(["identify", {<br/>  // Klaviyo defined properties, necessary to pass one of email or phone_number, others properties are optional<br/>  $email: email,<br/>  $first_name: firstName,<br/>  $last_name: lastName,<br/>  $phone_number: phoneNumber,<br/>  $title: title,<br/>  $organization: organizationName,<br/>  $image: imageUrl,</span><span id="df0f" class="mu ku in mg b gy nf mw l mx my">  // Pass custom properties</span><span id="8b79" class="mu ku in mg b gy nf mw l mx my">}]);</span></pre><h1 id="7ebc" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">跟踪用户旅程</h1><p id="9ebf" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg mz ki kj kk na km kn ko nb kq kr ks ig bi translated"><code class="fe md me mf mg b">track</code>方法允许你记录人们在你的网站上发生的事件和行为。该方法接受一个字符串，即您为该事件指定的名称。此方法还接受与该事件关联的可选字典或属性哈希。</p><p id="a99e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">有了这个，您可以跟踪某人何时购买了一个项目，并包括购买价格和他们购买了什么项目的信息。如果您有一个应用程序，其中的人有个人资料，您可以跟踪当有人填写他们的个人资料。</p><ul class=""><li id="cb61" class="lr ls in jx b jy jz kc kd kg nc kk nd ko ne ks ly lz ma mb bi translated"><strong class="jx io">客户端:</strong>要跟踪用户旅程客户端，可以使用下面的代码</li></ul><pre class="mm mn mo mp gt mq mg mr ms aw mt bi"><span id="0b5d" class="mu ku in mg b gy mv mw l mx my">var _learnq = typeof window !== "undefined" ? window._learnq : [];</span><span id="11f2" class="mu ku in mg b gy nf mw l mx my">_learnq.push(["track", "Pass metric name here", {<br/>  // Pass all the necessary data you want to attach to metric as key-value pair or leave it empty<br/>}]);</span></pre><ul class=""><li id="749c" class="lr ls in jx b jy jz kc kd kg nc kk nd ko ne ks ly lz ma mb bi translated"><strong class="jx io">服务器端:</strong>要在服务器端跟踪用户旅程，您可以像这样向Klaviyo发出HTTP请求:</li></ul><pre class="mm mn mo mp gt mq mg mr ms aw mt bi"><span id="fdc6" class="mu ku in mg b gy mv mw l mx my">fetch(`https://a.klaviyo.com/api/track?data=${Buffer.from(<br/>  JSON.stringify({<br/>    token: "<!-- -->PUBLIC_API_KEY<!-- -->",<br/>    event: "Pass metric name here",<br/>    customer_properties: {<br/>      // Properties about the person<br/>      $email: email,<br/>    },<br/>    properties: {<br/>      // Pass all the necessary data you want to attach to metric as key-value pair or leave it empty<br/>    },<br/>  })<br/>).toString("base64")}`);</span></pre><p id="3d9f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所有这些应该可以帮助您将必要的数据和事件传递给Klaviyo。</p><p id="e348" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，我们将设置自定义流程来触发电子邮件。</p><h1 id="0dd6" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">设置自定义流程</h1><p id="ab9d" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg mz ki kj kk na km kn ko nb kq kr ks ig bi translated">Klaviyo流程旨在让您在整个生命周期中轻松建立和培养与订户和客户的关系。流允许您根据某人何时加入列表、被添加到细分市场或采取任何其他行动(如购买或放弃购物车)来触发一封电子邮件或一系列电子邮件。任何同步到您的Klaviyo帐户的数据都可以用来触发和定向自动电子邮件流。</p><p id="c3d5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要创建新流程，请执行以下操作:</p><ul class=""><li id="c360" class="lr ls in jx b jy jz kc kd kg nc kk nd ko ne ks ly lz ma mb bi translated">访问Klaviyo dashboard，点击左侧工具条中的<strong class="jx io">流程</strong>链接。</li><li id="fd97" class="lr ls in jx b jy mh kc mi kg mj kk mk ko ml ks ly lz ma mb bi translated">点击顶部的<strong class="jx io">创建流</strong></li><li id="7ef5" class="lr ls in jx b jy mh kc mi kg mj kk mk ko ml ks ly lz ma mb bi translated">您可以从Klaviyo库中选择一个流或<strong class="jx io">选择从头创建</strong></li><li id="c6b4" class="lr ls in jx b jy mh kc mi kg mj kk mk ko ml ks ly lz ma mb bi translated">添加名称，选择标签，并点击<strong class="jx io">创建流</strong></li><li id="8d53" class="lr ls in jx b jy mh kc mi kg mj kk mk ko ml ks ly lz ma mb bi translated">对于触发器，选择<strong class="jx io">指标</strong>，并选择一个您使用<code class="fe md me mf mg b">track</code>方法发送的指标。根据您的需要设置触发器或流量过滤器，或者保持原样。所有设置完成后，点击<strong class="jx io">完成</strong>。</li><li id="1047" class="lr ls in jx b jy mh kc mi kg mj kk mk ko ml ks ly lz ma mb bi translated">现在拖动流程卡下面的<strong class="jx io">延时</strong>，指定一个延时。</li><li id="681b" class="lr ls in jx b jy mh kc mi kg mj kk mk ko ml ks ly lz ma mb bi translated">现在拖动<strong class="jx io"> Email </strong>到延时卡下面，进行配置。将状态更改为<strong class="jx io">实时。</strong></li><li id="01d6" class="lr ls in jx b jy mh kc mi kg mj kk mk ko ml ks ly lz ma mb bi translated">添加任意数量的电子邮件或延迟操作。</li><li id="4b5f" class="lr ls in jx b jy mh kc mi kg mj kk mk ko ml ks ly lz ma mb bi translated">完成所有操作后，点击右上角的<strong class="jx io">保存</strong>按钮。</li></ul><h1 id="a552" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">一些自定义流程示例</h1><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/a66b6fcc0665aaa7a97149036d046819.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*Q7CC58tio9hURuXVs9NXMw.png"/></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk">Order placed email Flow</figcaption></figure><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/6cd7d6c6e184ed2d225d2ccbfb9ad2bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fVxcY2nkAtjoKFzcC4iTvA.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk">Abandoned Cart email Flow</figcaption></figure><p id="62a4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">有关流量的更多详情，请查看Klaviyo <a class="ae mc" href="https://help.klaviyo.com/hc/en-us/categories/115000312411-Flows" rel="noopener ugc nofollow" target="_blank">流量导轨</a>。</p><p id="1950" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">本教程到此为止。希望对你有帮助。在<a class="ae mc" href="https://www.instagram.com/imchetanyadav/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>和<a class="ae mc" href="https://twitter.com/im_chetanyadav/" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我，获取更多信息。</p></div></div>    
</body>
</html>