<html>
<head>
<title>All You Need To Know About The New React Router 6</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于新款React路由器6，您需要了解的所有信息</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/all-you-need-to-know-about-the-new-react-router-6-987a7b3085dc?source=collection_archive---------3-----------------------#2021-12-06">https://javascript.plainenglish.io/all-you-need-to-know-about-the-new-react-router-6-987a7b3085dc?source=collection_archive---------3-----------------------#2021-12-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/96fca2004d9ddb8a7ed14a6b81e37491.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ul62O2jERDM6gi7S"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@jbcreate_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joseph Barrientos</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4363" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">2021年11月，<a class="ae jz" href="https://reactrouterdotcom.fly.dev/docs/en/v6/getting-started/overview" rel="noopener ugc nofollow" target="_blank"> React路由器6 </a>最终版本发布。它引入了许多突破性的变化。让我们深入了解一下，熟悉一下最新的变化。</p><p id="3e11" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://codesandbox.io/s/react-router-6-demo-97d7q?file=/src/index.tsx" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io">此处代码可用</strong> </a></p><ol class=""><li id="8309" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated"><strong class="kc io">将应用程序连接到浏览器URL没有变化。</strong></li><li id="9976" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated"><code class="fe lm ln lo lp b"><strong class="kc io">Link</strong></code> <strong class="kc io">组件也没有变化。</strong></li><li id="4302" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">先前版本中的<code class="fe lm ln lo lp b"><strong class="kc io">Switch</strong></code> <strong class="kc io">组件被</strong> <code class="fe lm ln lo lp b"><strong class="kc io">Routes </strong></code>组件替换。</li></ol><p id="00b6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe lm ln lo lp b">Routes</code>只接受<code class="fe lm ln lo lp b">Route</code>组件或<code class="fe lm ln lo lp b">React.Fragment</code>为子组件。</p><p id="1d7f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> 4。</strong> <code class="fe lm ln lo lp b"><strong class="kc io">Route</strong></code> <strong class="kc io">组件道具也随之改变。下表总结了这些变化:</strong></p><figure class="lr ls lt lu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lq"><img src="../Images/2c598f8fe2142954269ea9ef55f3256e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iSrT-iTpX7_av1mPBW96_g.png"/></div></div></figure><p id="f6bc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们现在可以添加一个嵌套路由，方法是将一个路由作为子路由添加到父路由。有了嵌套路由，我们不需要在子路由中添加父路径。</p><p id="11bc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">但是对于嵌套的route，需要在父route元素中添加一个额外的组件— <code class="fe lm ln lo lp b">Outlet</code>来呈现子route元素。没有<code class="fe lm ln lo lp b">Outlet</code>组件，将不会呈现子路线元素。</p><p id="d2a9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有了所有这些变化，index.js看起来像这样:</p><p id="862f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">src/index.js</p><pre class="lr ls lt lu gt lv lp lw lx aw ly bi"><span id="fe8e" class="lz ma in lp b gy mb mc l md me">import { render } from "react-dom";<br/>import { BrowserRouter, Route, Routes } from "react-router-dom";<br/>import Component1 from "./components/Component1";<br/>import Component2 from "./components/Component2";<br/>import Component3 from "./components/Component3";<br/>import NotFoundPage from "./components/NotFoundPage";</span><span id="b357" class="lz ma in lp b gy mf mc l md me">import App from "./App";</span><span id="a361" class="lz ma in lp b gy mf mc l md me">const rootElement = document.getElementById("root");<br/>render(<br/>  &lt;BrowserRouter&gt;<br/>    &lt;Routes&gt;<br/>      &lt;Route path="/" element={&lt;App /&gt;}&gt;<br/>        &lt;Route path="expenses" element={&lt;Component1 /&gt;} /&gt;<br/>        &lt;Route path="invoices" element={&lt;Component2 /&gt;} /&gt;<br/>        &lt;Route path="invoice/:id" element={&lt;Component3 /&gt;} /&gt;<br/>        &lt;Route path="*" element={&lt;NotFoundPage /&gt;} /&gt;<br/>      &lt;/Route&gt;<br/>    &lt;/Routes&gt;<br/>  &lt;/BrowserRouter&gt;,<br/>  rootElement<br/>);</span></pre><p id="3336" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> 5。现在可以很容易地添加不匹配路线。</strong></p><pre class="lr ls lt lu gt lv lp lw lx aw ly bi"><span id="aed0" class="lz ma in lp b gy mb mc l md me">&lt;Route path="\*" element={&lt;NotFoundPage /&gt;} /&gt;</span></pre><p id="2dd2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> 6。读取URL参数和查询(搜索参数)</strong></p><p id="5199" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://codesandbox.io/s/react-router-6-demo-97d7q?file=/src/index.tsx" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io">此处代码可用</strong> </a></p><p id="a521" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">一、URL Params: <code class="fe lm ln lo lp b">useParams()</code>返回以参数名为关键字的对象。</p><pre class="lr ls lt lu gt lv lp lw lx aw ly bi"><span id="f1f4" class="lz ma in lp b gy mb mc l md me">import { useParams } from "react-router-dom";</span><span id="3718" class="lz ma in lp b gy mf mc l md me">const Component3 = () =&gt; {<br/>  // for Route =&gt; &lt;Route path="invoice/:id" element={&lt;Component3 /&gt;} /&gt;<br/>  <br/>  const { id } = useParams();</span><span id="db67" class="lz ma in lp b gy mf mc l md me">  return (<br/>    &lt;div&gt;<br/>      &lt;h1&gt;Component3&lt;/h1&gt;<br/>      &lt;p&gt;Param: {id}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</span><span id="714f" class="lz ma in lp b gy mf mc l md me">export default Component3;</span></pre><p id="d572" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">二。URL查询参数:<code class="fe lm ln lo lp b">useSearchParams()</code>返回<code class="fe lm ln lo lp b">searchParams</code>对象和<code class="fe lm ln lo lp b">setSearchParams</code>函数。</p><p id="569e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe lm ln lo lp b">searchParams</code>是一个<a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams" rel="noopener ugc nofollow" target="_blank"> URLSearchParams </a>对象。</p><pre class="lr ls lt lu gt lv lp lw lx aw ly bi"><span id="dba2" class="lz ma in lp b gy mb mc l md me">import { useSearchParams } from "react-router-dom";</span><span id="0970" class="lz ma in lp b gy mf mc l md me">const Component1 = () =&gt; {<br/>  let [searchParams, setSearchParams] = useSearchParams();<br/>  console.log(searchParams.get("name"));</span><span id="994a" class="lz ma in lp b gy mf mc l md me">  return (<br/>    &lt;div&gt;<br/>      &lt;h1&gt;Component1&lt;/h1&gt;<br/>      &lt;p&gt;You have entered following value for "name" query parameter:&lt;/p&gt;<br/>      {searchParams.get("name")}<br/>    &lt;/div&gt;<br/>  );<br/>};</span><span id="3326" class="lz ma in lp b gy mf mc l md me">export default Component1;</span></pre><p id="8227" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> 7。像比赛，位置，历史这样的道具在React Router 6中是没有的。</strong></p><p id="3f62" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> 8。</strong> <code class="fe lm ln lo lp b"><strong class="kc io">Redirect</strong></code> <strong class="kc io">替换为</strong> <code class="fe lm ln lo lp b"><strong class="kc io">Navigate</strong></code> <strong class="kc io">。</strong></p><p id="bc3b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有了<code class="fe lm ln lo lp b">Navigate</code>组件，我们可以送以下道具:</p><pre class="lr ls lt lu gt lv lp lw lx aw ly bi"><span id="1f96" class="lz ma in lp b gy mb mc l md me">&lt;Navigate to="/dashboard" replace={true} state={from: location}/&gt;</span></pre><p id="3e59" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">9。 <code class="fe lm ln lo lp b"><strong class="kc io">useHistory </strong></code> <strong class="kc io">钩被<code class="fe lm ln lo lp b"><strong class="kc io">useNavigate</strong></code></strong>钩取代。</p><p id="20d4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe lm ln lo lp b">useNavigate</code>钩子返回一个函数，让你以编程方式导航。</p><pre class="lr ls lt lu gt lv lp lw lx aw ly bi"><span id="e86f" class="lz ma in lp b gy mb mc l md me">import { useNavigate, <!-- -->useLocation<!-- --> } from "react-router-dom";<br/><br/>function SignupForm() {<br/>  let navigate = useNavigate();<br/>  let location = useLocation();<br/><br/>  async function handleSubmit(event) {<br/>    event.preventDefault();<br/>    await submitForm(event.target);<br/>    navigate("../success", { replace: true, state: {from: location}});<br/>    // navigate(-1) ==&gt; goes back to last route<br/>  }<br/><br/>  return &lt;form onSubmit={handleSubmit}&gt;{/* ... */}&lt;/form&gt;;<br/>}</span></pre><p id="a6bf" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe lm ln lo lp b">navigate</code>函数有两个签名:</p><ul class=""><li id="22e6" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx mg le lf lg bi translated">要么传递一个带有可选的第二个<code class="fe lm ln lo lp b">{ replace, state }</code>参数的<code class="fe lm ln lo lp b">To</code>值(与<code class="fe lm ln lo lp b">&lt;Link to&gt;</code>类型相同),要么</li><li id="f8b3" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx mg le lf lg bi translated">在历史堆栈中传递你想要的增量。比如<code class="fe lm ln lo lp b">navigate(-1)</code>就相当于打了后退键。</li></ul><p id="de40" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">10。 <code class="fe lm ln lo lp b"><strong class="kc io">useLocation</strong></code> <strong class="kc io">还是老样子。</strong></p><pre class="lr ls lt lu gt lv lp lw lx aw ly bi"><span id="ab73" class="lz ma in lp b gy mb mc l md me">import * as React from 'react';<br/>import { useLocation } from 'react-router-dom';<br/><br/>function App() {<br/>  let location = useLocation();</span><span id="548f" class="lz ma in lp b gy mf mc l md me">  // location object looks like this:<br/>  // <!-- -->pathname: "/invoices"<br/>  // search: ""<br/>  // hash: ""<br/>  // state: null<br/>  // key: "default"</span><span id="7713" class="lz ma in lp b gy mf mc l md me">  React.useEffect(() =&gt; {<br/>    ga('send', 'pageview');<br/>  }, [location]);<br/><br/>  return (<br/>    // ...<br/>  );<br/>}</span></pre><p id="da47" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">11.在React Router 6中，为了给导航栏或侧边栏中的活动链接添加样式，我们可以添加以下处理。</p><pre class="lr ls lt lu gt lv lp lw lx aw ly bi"><span id="2719" class="lz ma in lp b gy mb mc l md me">&lt;NavLink<br/>   style={({ isActive }) =&gt; {<br/>     return {<br/>       display: "block",<br/>       margin: "1rem 0",<br/>       color: isActive ? "red" : ""<br/>     };<br/>   }}<br/>   to={`/invoices/${invoice.number}`}<br/>   key={invoice.number}<br/>&gt;<br/> {invoice.name}<br/>&lt;/NavLink&gt;</span></pre><p id="dcee" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe lm ln lo lp b">NavLink</code>将<code class="fe lm ln lo lp b">isActive</code>参数传递给style prop内部的函数。此参数可用于活动链接的条件样式。</p><p id="52bc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这些是React Router 6中引入的一些汇总更改。试试吧，现在变得更好玩了。我已经创建了这些注释和一个小的演示项目来重用语法并在工作中节省一些时间。</p><p id="29ae" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://codesandbox.io/s/react-router-6-demo-97d7q?file=/src/index.tsx" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io">代码此处可用</strong> </a></p><p id="7cf4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">感谢你的阅读！</p><p id="9902" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> <em class="mh">定时下班休息，放松一下！</em> </strong></p><p id="09d2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mh">更多内容看</em> <a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="mh">说白了就是</em> </strong> </a> <strong class="kc io"> <em class="mh">。</em> </strong> <em class="mh">报名参加我们的</em> <a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="mh">免费周报在这里</em> </strong> </a> <strong class="kc io"> <em class="mh">。</em> </strong></p></div></div>    
</body>
</html>