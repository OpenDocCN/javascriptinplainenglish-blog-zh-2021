<html>
<head>
<title>How to create a custom CSS pointer in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中创建自定义CSS指针</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-a-custom-css-pointer-in-react-2d4684215564?source=collection_archive---------1-----------------------#2021-02-11">https://javascript.plainenglish.io/how-to-create-a-custom-css-pointer-in-react-2d4684215564?source=collection_archive---------1-----------------------#2021-02-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a55cbf4b829e759f544c34e1f7e33783.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1n3t3WEURp3LkR0wV5BfEw.png"/></div></div></figure><p id="c2ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现代网站的一个最新趋势(至少在几年前，TBH)是自定义CSS指针，通常，这是通过用其他东西代替箭头(和链接的手)指针来实现的，通常，当悬停链接和点击时，会有某种动画效果的圆圈。</p><p id="a3b0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">即使看起来很简单，替换指针也是一个棘手的问题，尤其是在React中处理它的时候。</p><h2 id="bb4c" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">指针替换在理论上如何工作</h2><ul class=""><li id="a528" class="lp lq iq ka b kb lr kf ls kj lt kn lu kr lv kv lw lx ly lz bi translated">隐藏默认指针(即使一些网站保持它可见)</li><li id="994f" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">创建一个新指针(通常是一个新指针在里面的div或者是指针本身)并定位它<em class="mf">绝对</em></li><li id="5bef" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">不断监视屏幕上的鼠标位置，并相应地移动新指针</li><li id="702b" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">不断地检查我们是否在一个链接、一个按钮或者其他我们想要监控的东西上，并最终动画化指针到它的新状态</li><li id="6bdd" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">如果鼠标离开页面，隐藏新指针(比如进入浏览器标签或其他地方)</li><li id="0e61" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">监控点击以最终激活或改变指针状态/外观</li><li id="a3db" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">离开页面时停止监听上述事件(在React中尤其如此)</li><li id="055e" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">如果我们使用手机，请忽略所有这些</li></ul><p id="e282" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这需要大量的检查，并且很容易导致内存饱和和随之而来的延迟，不断地跟踪鼠标和更新一个<em class="mf"> div </em>位置会填满内存，特别是在React中，如果事情一直在无限循环中渲染</p><h2 id="94b8" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">我们要建造什么</h2><p id="9221" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">我们正在用链接和按钮的悬停动画，点击的反馈动画来编码基本的CSS指针替换。指针将主要由钩子处理，它将存在于自己的组件中，因此可以在需要它的页面中导入。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3c9276fa876ba7b429793d069f719670.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*kvXQr19M-kzsuXf1KED-XQ.gif"/></div></div></figure><h2 id="84b1" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">先决条件</h2><p id="2916" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">在开始之前，你应该对React如何工作有一个基本的了解，尤其是钩子，因为它的大部分逻辑都在它自己的useEffect钩子中。你还需要对CSS有一个基本的了解，所有的光标外观都将由CSS处理。了解一下Tailwind CSS是如何工作的也是有益的，一些样式会用到它。阅读以下指南，了解如何在React项目中安装并开始使用Tailwind CSS</p><div class="mn mo gp gr mp mq"><a href="https://tailwindcss.com/docs/guides/create-react-app" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd ir gy z fp mv fr fs mw fu fw ip bi translated">用Create React App - Tailwind CSS安装Tailwind CSS</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">如果您还没有建立一个Create React应用程序项目，请从创建一个新的项目开始。最常见的方法是…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">tailwindcss.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne jw mq"/></div></div></a></div><p id="6f0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我还假设你已经创建了一个(空的)React项目，要么使用普通React，要么使用像<a class="ae nf" href="https://www.gatsbyjs.com/" rel="noopener ugc nofollow" target="_blank"> Gatsby </a>或<a class="ae nf" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next </a>这样的框架</p><h1 id="98da" class="ng kx iq bd ky nh ni nj lb nk nl nm le nn no np lh nq nr ns lk nt nu nv ln nw bi translated">编写代码</h1><h2 id="9a77" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">索引页</h2><p id="08d2" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">一旦您有了空的React项目，我们就可以开始创建一个简单的主页，稍后我们将在其中附加光标组件。这个页面非常简单，它只包含几个无处可去的链接(使用<em class="mf"> &lt;、一个&gt;…&lt;/一个&gt; </em>标签)和一个按钮(使用<em class="mf"> &lt;按钮&gt;…&lt;/按钮&gt; </em>标签)，因此，一旦光标就位，我们就可以测试它与各种类型链接的交互性。这个页面是用Tailwind CSS设计的，但是这是完全可选的。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="6d7f" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">光标组件</h2><p id="9662" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">在你的<em class="mf"> src </em>文件夹下，新建一个文件夹，命名为<em class="mf"> components </em>，在这个文件夹下新建一个js文件，命名为Cursor.js</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="e193" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们可以在索引页面中导入该组件，并在页面中呈现光标组件:</p><pre class="mj mk ml mm gt nz oa ob oc aw od bi"><span id="0604" class="kw kx iq oa b gy oe of l og oh">import Cursor from '../components/Cursor';<br/>...<br/>return (<br/>   &lt;&gt;<br/>     &lt;Cursor /&gt;<br/>     &lt;main className="container mx-auto px-2 md:px-0"&gt;<br/>     ...<br/>     &lt;/main&gt;<br/>   &lt;/&gt;<br/>)<br/>...</span></pre><p id="2c7d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此时，如果您打开索引页面，应该不会显示任何不同，我们需要开始设计代表光标的<em class="mf"> div </em>的样式。<br/>在你的css文件中添加以下内容:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="6194" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将转换您的。光标div在一个40px的圆中，有2px的边框和固定的位置。<br/>我们现在要跟踪鼠标在页面上的移动，并将。光标移动到鼠标。<br/>返回Cursor.js，修改如下:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="6e32" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们开始定义一个跟踪位置的useState钩子，然后当组件加载时，我们使用useEffect钩子将一个mousemove事件侦听器附加到文档，mousemove回调将不断更新位置状态，这个状态用在。光标div相应地定位它。如果你现在访问这个页面，你应该会看到一个圆圈附在你的鼠标光标上，跟随它，但是在链接和按钮上没有交互，而且如果你把鼠标移到文档之外，这个圆圈将会停留在边框上</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7dc933803db790718b45192d6908a006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*J9CgpYbbSnMIfZx5QJ-bCg.gif"/></div></div></figure><h2 id="65d7" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">当我们离开文档时处理光标</h2><p id="abdf" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">按照光标逻辑，当我们离开文档时，我们应该从文档中移除/隐藏圆形光标(但我见过没有这样做的网站，所以除了逻辑之外，这是个人喜好的问题)。<br/>为了实现这一点，我们将添加几个事件监听器来处理相对于文档的鼠标进入和鼠标离开，通过它的回调，我们可以更新一个新的状态钩子，该钩子通过类名定义光标可见性。先说modyfing Cursor.js:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="26bd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">基于隐藏状态，我们将类(<em class="mf"> c — hidden </em>)添加到我们的。光标div状态由我们添加的新事件侦听器处理。现在我们简单地将这个类添加到CSS中来隐藏div(我们使用transition来显示不透明度)，我们还隐藏了页面中的标准指针:</p><pre class="mj mk ml mm gt nz oa ob oc aw od bi"><span id="837d" class="kw kx iq oa b gy oe of l og oh">html,body {<br/>  cursor: none<br/>}</span><span id="2c79" class="kw kx iq oa b gy oi of l og oh">html *,body * {<br/>  cursor: none;<br/>}</span><span id="44ad" class="kw kx iq oa b gy oi of l og oh">.c--hidden {<br/>   opacity: 0;<br/>}</span><span id="0a4d" class="kw kx iq oa b gy oi of l og oh">.cursor {<br/>   ...<br/>   transition: all 100ms ease;<br/>   transition-property: opacity;<br/>}</span></pre><p id="43e5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您现在运行页面，结果应该与之前类似，但是这一次当您将鼠标移出文档时，圆形指针将淡出</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/58943811fbcdd5b5d7ee555e594c9265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*hq4I-CyHQLCHDyeKRmQ3PQ.gif"/></div></div></figure><h2 id="37a0" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">点击反馈</h2><p id="70d5" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">我们现在想为用户添加一个点击页面时的反馈；这项工作和以前一样，我们添加了两个新的侦听器(mouseup和mousedow ),我们将它们的回调“链接”到一个状态，然后我们使用该状态来添加/删除标识点击的类</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="d1ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用点击状态，我们添加/删除一个c-click类。光标div点击反馈并不依赖于链接(尽管它也作用于链接)，而是在页面被点击时简单地给用户一个视觉反馈。css现在变得个性化了，我决定减小圆形的大小，每次点击都用黑色填充(并在过渡列表中添加变换和背景色样式)</p><pre class="mj mk ml mm gt nz oa ob oc aw od bi"><span id="437c" class="kw kx iq oa b gy oe of l og oh">.c--clicked {<br/>   transform: translate(-50%, -50%) scale(0.5);<br/>   background-color: #121212;<br/>}</span><span id="3e0e" class="kw kx iq oa b gy oi of l og oh">.cursor {<br/>   ...<br/>   transition: all 100ms ease;<br/>   transition-property: opacity, background-color, transform;<br/>}</span></pre><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/52c0f8c09c3c322df0b4f707485c9ae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Gab4CVVt2qpEJ9oaDhH2nA.gif"/></div></div></figure><h2 id="ac68" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">悬停链接和按钮</h2><p id="d44b" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">你肯定想在用户处于“交互”状态时向他们提供反馈(通常是链接和按钮，但也可以扩展到其他DOM对象)，它仍然与事件监听器和状态挂钩一起工作，但这一次监听器被附加到DOM元素，在我们的例子中是<em class="mf"> a </em>和<em class="mf">按钮</em>，但不同的链接有不同的行为会更细粒度。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="93ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们遍历页面的所有链接和按钮，并且在每个元素上附加一个mousover/mouseout事件，该事件将回调以设置一个状态钩子来启用/禁用一个类。c-hover类将简单地增加光标的大小:</p><pre class="mj mk ml mm gt nz oa ob oc aw od bi"><span id="e323" class="kw kx iq oa b gy oe of l og oh">.cursor--link-hovered {<br/>   transform: translate(-50%, -50%) scale(1.25);<br/>}</span></pre><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/42a42c81602dd7cf71b05140a8117515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*VoWLIVd8XM7Lg7hYv81o2w.gif"/></div></div></figure><h2 id="5791" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">最后润色</h2><p id="9185" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">很少有东西可以改进这个组件的功能；首先，我们可以检查我们是否在移动设备上，你可以使用一个库(如<code class="fe oj ok ol oa b">react-device-detect</code>)或使用<code class="fe oj ok ol oa b">navigator.userAgent</code>手动检查，如果你在移动设备上，你可以跳过事件监听器的设置和返回。</p><p id="159a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在视觉上用更多的动画和更多的样式来改进光标，也许添加一个svg并在链接悬停时使其动画化，你也可以在链接上设置一个随机的动画(从动画列表中),当你点击某个东西时，你可以根据你所在的链接启用动画，等等。</p></div></div>    
</body>
</html>