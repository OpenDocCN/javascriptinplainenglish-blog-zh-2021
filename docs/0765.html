<html>
<head>
<title>How to Upload Files to AWS S3 in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中将文件上传到AWS S3</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-upload-files-to-aws-s3-in-react-591e533d615e?source=collection_archive---------0-----------------------#2021-02-17">https://javascript.plainenglish.io/how-to-upload-files-to-aws-s3-in-react-591e533d615e?source=collection_archive---------0-----------------------#2021-02-17</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="fd1e" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">以两种不同的方式</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/881a9503e6f3985b4e086555418275ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ASCANX-9KL4yUBMiMbo6Sg.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Credit: Google</figcaption></figure><p id="6f9c" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">如今，有了AWS和Firebase等一些令人敬畏的无服务器云解决方案，上传文件已经变得轻而易举。</p><p id="c33c" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">今天，我们将了解如何快速创建一个S3存储桶，并直接从我们的前端React应用程序上传文件。</p><h2 id="78da" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">先决条件</h2><ol class=""><li id="0e76" class="ml mm ir ky b kz mn lc mo lf mp lj mq ln mr lr ms mt mu mv bi translated">AWS帐户</li><li id="5e09" class="ml mm ir ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">对反应堆的基本理解</li></ol><p id="1907" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">我们开始吧！</p><h2 id="c8c2" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">第一步。创建S3存储桶</h2><p id="69f8" class="pw-post-body-paragraph kw kx ir ky b kz mn js lb lc mo jv le lf nb lh li lj nc ll lm ln nd lp lq lr ik bi translated">登录到您的aws控制台。搜索<code class="fe ne nf ng nh b">Amazon S3</code>，点击<code class="fe ne nf ng nh b">Create bucket</code>。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj ni"><img src="../Images/eccee1e1941d845e041367e0dbadd492.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JlluKXRL8o8CXQL8uaEjOQ.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">aws-console</figcaption></figure><p id="df28" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">然后给它一个名字并选择合适的区域。然后暂时取消选中<code class="fe ne nf ng nh b">Block all public access</code>(在生产中必须保持不选中)。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj ni"><img src="../Images/da052c5fad8ed6e4a4163619335537f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pyiU565iAgsSshWDylaQMw.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">create-s3-bucket</figcaption></figure><p id="d823" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">点击<code class="fe ne nf ng nh b">Create Bucket</code>，你会在列表中看到你的新桶。</p></div><div class="ab cl nj nk hv nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ik il im in io"><h2 id="7716" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">第二步。编辑存储桶策略</h2><p id="11ad" class="pw-post-body-paragraph kw kx ir ky b kz mn js lb lc mo jv le lf nb lh li lj nc ll lm ln nd lp lq lr ik bi translated">现在，我们将设置存储桶策略。点击桶名并转到<code class="fe ne nf ng nh b">properties</code>选项卡。</p><p id="9781" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">向下滚动一点，您会看到一个名为<code class="fe ne nf ng nh b">Bucket Policy</code>的部分</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nq"><img src="../Images/8098fa401cf362af68a09af0e1594ba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*neOcTZKlo1mvjLbXEn4ErQ.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">bucket-policy</figcaption></figure><p id="6284" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">点击<code class="fe ne nf ng nh b">Edit</code>按钮。并加上下面的<code class="fe ne nf ng nh b">json</code>。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nr ns l"/></div></figure><p id="164e" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">这将允许公众暂时访问该文件夹的内容。</p></div><div class="ab cl nj nk hv nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ik il im in io"><h2 id="5692" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">第三步。编辑CORS策略</h2><p id="bfe5" class="pw-post-body-paragraph kw kx ir ky b kz mn js lb lc mo jv le lf nb lh li lj nc ll lm ln nd lp lq lr ik bi translated">再向下滚动一点，您将看到一个可以编辑<code class="fe ne nf ng nh b">CORS</code>策略的部分。由于我们将从另一个端点上传文件，我们需要确保我们的bucket不会阻止<code class="fe ne nf ng nh b">cors</code>的上传</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nq"><img src="../Images/bf03f806f655df40740d3754b4778ff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WxN7vFqYtTWfRRfuNpUW3A.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">cors-policy</figcaption></figure><p id="fb7a" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">然后将下面的<code class="fe ne nf ng nh b">.json</code>文件添加到策略中</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nr ns l"/></div></figure><p id="f4db" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">现在，我们准备将文件上传到我们的AWS S3存储桶。现在继续前端部分。</p></div><div class="ab cl nj nk hv nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ik il im in io"><h2 id="749e" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">第四步。设置React项目</h2><p id="24dd" class="pw-post-body-paragraph kw kx ir ky b kz mn js lb lc mo jv le lf nb lh li lj nc ll lm ln nd lp lq lr ik bi translated">为了跟进，您将需要一个基本的React项目设置。你可以很容易地做到这一点</p><pre class="kh ki kj kk gu nt nh nu nv aw nw bi"><span id="6591" class="ls lt ir nh b gz nx ny l nz oa">npx create-react-app s3-upload</span></pre><p id="ef31" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">它将为您搭建一个基本的应用程序。</p></div><div class="ab cl nj nk hv nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ik il im in io"><h2 id="3b62" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">第五步。通过原生SDK上传文件</h2><p id="5c0b" class="pw-post-body-paragraph kw kx ir ky b kz mn js lb lc mo jv le lf nb lh li lj nc ll lm ln nd lp lq lr ik bi translated">如果我们在项目中使用其他aws服务，那么我们有一个名为<code class="fe ne nf ng nh b"><a class="ae ob" href="https://www.npmjs.com/package/aws-sdk" rel="noopener ugc nofollow" target="_blank">aws-sdk</a></code>的特殊npm包。我们可以应付过去</p><pre class="kh ki kj kk gu nt nh nu nv aw nw bi"><span id="6b9d" class="ls lt ir nh b gz nx ny l nz oa">yarn add aws-sdk</span></pre><p id="76ab" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">然后创建一个名为<code class="fe ne nf ng nh b">UploadImageToS3WithNativeSdk</code>的新组件，并在其中添加以下代码</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nr ns l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">UploadImageToS3WithNativeSdk.ts</figcaption></figure><p id="f693" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">这是一个简单的组件，其中有一个文件输入，并使用本机<code class="fe ne nf ng nh b">aws-sdk</code>上传文件。</p><blockquote class="oc od oe"><p id="84c1" class="kw kx of ky b kz la js lb lc ld jv le og lg lh li oh lk ll lm oi lo lp lq lr ik bi translated">用您自己的值替换<code class="fe ne nf ng nh b">BUCKET_NAME</code>、<code class="fe ne nf ng nh b">REGION_NAME</code>、<code class="fe ne nf ng nh b">SECRET_KEY</code>、<code class="fe ne nf ng nh b">ACCESS_KEY</code></p></blockquote></div><div class="ab cl nj nk hv nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ik il im in io"><h2 id="a2ec" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">第六步。通过S3 React上传文件</h2><p id="512f" class="pw-post-body-paragraph kw kx ir ky b kz mn js lb lc mo jv le lf nb lh li lj nc ll lm ln nd lp lq lr ik bi translated">如果您没有使用其他AWS服务，那么您不需要完整的<code class="fe ne nf ng nh b">aws-sdk</code>，这将不必要地增加您的包大小。</p><p id="ed19" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">我们将使用另一个名为<code class="fe ne nf ng nh b"><a class="ae ob" href="https://www.npmjs.com/package/react-s3" rel="noopener ugc nofollow" target="_blank">react-s3</a></code>的库。首先，安装它</p><pre class="kh ki kj kk gu nt nh nu nv aw nw bi"><span id="e5c5" class="ls lt ir nh b gz nx ny l nz oa">yarn add react-s3</span></pre><p id="bee3" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">然后创建一个名为<code class="fe ne nf ng nh b">UploadImageToS3WithReactS3</code>的新组件，并添加以下代码</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nr ns l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">UploadImageToS3WithReactS3.ts</figcaption></figure><p id="ad81" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">这个组件将与前一个组件做同样的事情。它将一个文件作为输入，并上传到S3桶。</p><p id="23f8" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">另外，不要忘记更改参数值。</p><h2 id="c9ff" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">结论</h2><p id="a3e7" class="pw-post-body-paragraph kw kx ir ky b kz mn js lb lc mo jv le lf nb lh li lj nc ll lm ln nd lp lq lr ik bi translated">这就对了。下面是如何将任何文件上传到s3 bucket的方法。根据您的需要，浏览文档进行更多的定制。</p><h1 id="6754" class="oj lt ir bd lu ok ol om lx on oo op ma jx oq jy md ka or kb mg kd os ke mj ot bi translated"><strong class="ak">更新:</strong></h1><p id="c436" class="pw-post-body-paragraph kw kx ir ky b kz mn js lb lc mo jv le lf nb lh li lj nc ll lm ln nd lp lq lr ik bi translated">阅读下面的文章，了解如何安全地做到这一点。</p><div class="ou ov gq gs ow ox"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-access-private-s3-buckets-securely-87778efd93bd"><div class="oy ab fp"><div class="oz ab pa cl cj pb"><h2 class="bd is gz z fq pc fs ft pd fv fx iq bi translated">如何安全地访问私有S3存储桶</h2><div class="pe l"><h3 class="bd b gz z fq pc fs ft pd fv fx dk translated">使用预签名的URL</h3></div><div class="pf l"><p class="bd b dl z fq pc fs ft pd fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl kq ox"/></div></div></a></div><p id="a7d2" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">祝您愉快！:D</p><pre class="kh ki kj kk gu nt nh nu nv aw nw bi"><span id="b8a7" class="ls lt ir nh b gz nx ny l nz oa"><strong class="nh is">Get in touch with me via </strong><a class="ae ob" href="https://www.linkedin.com/in/56faisal/" rel="noopener ugc nofollow" target="_blank"><strong class="nh is">LinkedIn</strong></a><strong class="nh is"> or my </strong><a class="ae ob" href="https://www.mohammadfaisal.dev/" rel="noopener ugc nofollow" target="_blank"><strong class="nh is">Personal Website</strong></a><strong class="nh is">.</strong></span></pre><div class="ou ov gq gs ow ox"><a href="https://betterprogramming.pub/21-best-practices-for-a-clean-react-project-df788a682fb" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fp"><div class="oz ab pa cl cj pb"><h2 class="bd is gz z fq pc fs ft pd fv fx iq bi translated">清洁React项目的21个最佳实践</h2><div class="pe l"><h3 class="bd b gz z fq pc fs ft pd fv fx dk translated">提高代码质量的实用建议</h3></div><div class="pf l"><p class="bd b dl z fq pc fs ft pd fv fx dk translated">better编程. pub</p></div></div><div class="pg l"><div class="pm l pi pj pk pg pl kq ox"/></div></div></a></div><div class="ou ov gq gs ow ox"><a href="https://betterprogramming.pub/how-to-use-aws-dynamodb-in-react-70b55ffff93e" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fp"><div class="oz ab pa cl cj pb"><h2 class="bd is gz z fq pc fs ft pd fv fx iq bi translated">如何在React中使用AWS DynamoDB</h2><div class="pe l"><h3 class="bd b gz z fq pc fs ft pd fv fx dk translated">让我们尝试从React应用程序访问DynamoDB</h3></div><div class="pf l"><p class="bd b dl z fq pc fs ft pd fv fx dk translated">better编程. pub</p></div></div><div class="pg l"><div class="pn l pi pj pk pg pl kq ox"/></div></div></a></div><div class="ou ov gq gs ow ox"><a rel="noopener  ugc nofollow" target="_blank" href="/20-essential-parts-of-any-large-scale-react-app-ee4bd35436a0"><div class="oy ab fp"><div class="oz ab pa cl cj pb"><h2 class="bd is gz z fq pc fs ft pd fv fx iq bi translated">任何大型React应用程序的20个基本部分</h2><div class="pe l"><h3 class="bd b gz z fq pc fs ft pd fv fx dk translated">如果您正在编写企业级代码，您需要了解这一点</h3></div><div class="pf l"><p class="bd b dl z fq pc fs ft pd fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="pg l"><div class="po l pi pj pk pg pl kq ox"/></div></div></a></div><div class="ou ov gq gs ow ox"><a rel="noopener  ugc nofollow" target="_blank" href="/45-npm-packages-to-solve-16-react-problems-a9ab18946224"><div class="oy ab fp"><div class="oz ab pa cl cj pb"><h2 class="bd is gz z fq pc fs ft pd fv fx iq bi translated">45个NPM软件包解决16个React问题</h2><div class="pe l"><h3 class="bd b gz z fq pc fs ft pd fv fx dk translated">关于如何选择完美的npm包的深入指导</h3></div><div class="pf l"><p class="bd b dl z fq pc fs ft pd fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="pg l"><div class="pp l pi pj pk pg pl kq ox"/></div></div></a></div></div></div>    
</body>
</html>