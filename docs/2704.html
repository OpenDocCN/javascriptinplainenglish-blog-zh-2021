<html>
<head>
<title>How to Create Custom Hooks in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中创建自定义挂钩</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-custom-hooks-in-react-a756b1d54c45?source=collection_archive---------15-----------------------#2021-06-03">https://javascript.plainenglish.io/how-to-create-custom-hooks-in-react-a756b1d54c45?source=collection_archive---------15-----------------------#2021-06-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7cf1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何在React中创建第一个自定义钩子。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a43124cb8529eabc263010944c18eefc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wBCbPKaEybn3AbY4ao2RNA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Image created with ❤️️ By author.</figcaption></figure><p id="eabf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">钩子在反应时非常有用。现在每个人都在使用它们，因为与使用类组件相比，它们有更简单的语法。</p><p id="e888" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此React附带了许多钩子，我们可以使用它们来轻松地为我们的组件创建功能。但是，您仍然可以选择创建自己的定制挂钩。</p><p id="80c1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">自定义钩子只是一个可重用的函数，它调用其他钩子来为组件创建特定的功能。因此，这是一种为组件创建功能的方式，并且能够在不同的地方使用它，而不必为该功能重复代码。您只需导入自定义挂钩，并在任何您想使用的地方使用它。</p><p id="3774" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本文中，我们将学习如何在React中创建我们的第一个自定义钩子。所以让我们开始吧。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="0896" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">没有自定义挂钩的示例</h1><p id="0a3d" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">让我们来看一个简单的例子，在这个例子中，我们将从一个假的API获取数据，在页面上显示一个用户名列表。我们可以使用钩子<code class="fe mv mw mx my b">useState</code>、<code class="fe mv mw mx my b">useEffect</code>和fetch API来实现。</p><p id="aa3e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是一个例子:</p><pre class="kg kh ki kj gt mz my na nb aw nc bi"><span id="311f" class="nd lz iq my b gy ne nf l ng nh">//App.js</span><span id="590c" class="nd lz iq my b gy ni nf l ng nh">import React,{useState, useEffect} from "react";</span><span id="c047" class="nd lz iq my b gy ni nf l ng nh">const App = () =&gt; {<br/>  const [users, setUsers] = useState([])</span><span id="84af" class="nd lz iq my b gy ni nf l ng nh"><strong class="my ir">const getUsers = async ()=&gt;{<br/>    const response = await fetch(</strong>"https://jsonplaceholder.typicode.com/users"<strong class="my ir">)<br/>    const userdata = await response.json()<br/>    setUsers(userdata)<br/>  }</strong></span><span id="471e" class="nd lz iq my b gy ni nf l ng nh"><strong class="my ir">  useEffect(()=&gt;{<br/>    getUsers()<br/>  },[])</strong></span><span id="a274" class="nd lz iq my b gy ni nf l ng nh">  return (<br/>    &lt;div className="container"&gt;<br/>      &lt;ul&gt;<br/>        {users.map(user =&gt; &lt;li key={user.id}&gt;<strong class="my ir">{user.name}</strong>&lt;/li&gt;)}<br/>      &lt;/ul&gt;<br/>    &lt;/div&gt;<br/>  )<br/>};</span><span id="9370" class="nd lz iq my b gy ni nf l ng nh">export default App;</span></pre><p id="b1cd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如您所见，这就是我们在React中获取数据的方式。但是如果我们想在不同的组件中获取数据呢？嗯，我们将需要复制和粘贴所有这些不同的组件上面相同的功能。这不是一个好的做法。</p><p id="494f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就是定制挂钩发挥作用的原因。它们允许您轻松地将该功能调用到不同的组件中，而不必复制和粘贴所有内容。</p><p id="8fd4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以对于上面的情况，我们需要创建一个自定义的钩子，允许我们获取数据。</p><h1 id="f0b9" class="ly lz iq bd ma mb nj md me mf nk mh mi jw nl jx mk jz nm ka mm kc nn kd mo mp bi translated">创建自定义挂钩</h1><p id="e2d8" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">为了创建我们的定制钩子，我们必须做的第一件事是创建一个新文件。我将称它为<code class="fe mv mw mx my b">useFtech.js</code>,因为它将是一个获取数据的钩子。</p><p id="550d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在该文件中，我们必须创建一个函数来放置功能。该函数将是自定义挂钩本身。还有，要记住函数的名字必须以<code class="fe mv mw mx my b">use</code>开头，否则就不行。所以我将调用这个函数<code class="fe mv mw mx my b">useFetch()</code>。</p><p id="999c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您还需要给函数一个参数。在我们的例子中，它将是<code class="fe mv mw mx my b">url</code>，因为我们将不得不从API URL获取数据。然后我们将不得不使用钩子<code class="fe mv mw mx my b">useState</code>和<code class="fe mv mw mx my b">useEffect</code>来添加抓取功能。</p><p id="1278" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是一个例子:</p><pre class="kg kh ki kj gt mz my na nb aw nc bi"><span id="a730" class="nd lz iq my b gy ne nf l ng nh">//useFetch.js</span><span id="692c" class="nd lz iq my b gy ni nf l ng nh">import {useState, useEffect} from 'react'</span><span id="66ea" class="nd lz iq my b gy ni nf l ng nh">//don't forget to give a url parameter for the function.<br/>const <strong class="my ir">useFetch</strong> = (url)=&gt;{<br/>  const [data, setData] = useState([])</span><span id="9376" class="nd lz iq my b gy ni nf l ng nh">  const getData = async ()=&gt;{<br/>    const response = await fetch(url)<br/>    const userdata = await response.json()<br/>    setData(userdata)<br/>  }</span><span id="a296" class="nd lz iq my b gy ni nf l ng nh"> useEffect(()=&gt;{<br/>    getData()<br/>  },[url])</span><span id="4881" class="nd lz iq my b gy ni nf l ng nh">  //return data that we will need in other components.<br/>  <strong class="my ir">return {data};<br/></strong>}</span><span id="27a0" class="nd lz iq my b gy ni nf l ng nh">export default useFetch;</span></pre><p id="af4c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如您所看到的，在创建了自定义钩子函数并在其中编写了抓取功能之后。您还需要在函数中返回获取的数据。因为JavaScript中的每个函数都需要返回一些东西，我们需要这些数据在其他组件中使用。</p><p id="34c1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">之后，我们只需导出自定义钩子函数，并将其导入另一个组件，这样我们就可以使用获取功能。</p><p id="6e8e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是一个在App组件中使用我们的定制钩子<code class="fe mv mw mx my b">useFetch</code>的例子:</p><pre class="kg kh ki kj gt mz my na nb aw nc bi"><span id="3feb" class="nd lz iq my b gy ne nf l ng nh">//App.js</span><span id="65ed" class="nd lz iq my b gy ni nf l ng nh">import React from "react";<br/><strong class="my ir">import useFetch from './useFetch'</strong></span><span id="77cb" class="nd lz iq my b gy ni nf l ng nh">const App = () =&gt; {<br/>  const API_URL = 'https://jsonplaceholder.typicode.com/users';</span><span id="f085" class="nd lz iq my b gy ni nf l ng nh">  const {<strong class="my ir">data</strong>} = <strong class="my ir">useFetch(</strong>API_URL<strong class="my ir">)</strong></span><span id="4af0" class="nd lz iq my b gy ni nf l ng nh">  return (<br/>    &lt;div className="container"&gt;<br/>      &lt;ul&gt;<br/>        {<strong class="my ir">data</strong>.map(user =&gt; &lt;li key={user.id}&gt;{user.name}&lt;/li&gt;)}<br/>      &lt;/ul&gt;<br/>    &lt;/div&gt;<br/>  )<br/>};</span><span id="1385" class="nd lz iq my b gy ni nf l ng nh">export default App;</span></pre><p id="d63f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你所要做的就是导入自定义钩子，并像使用其他已有的钩子一样使用它。正如您在上面看到的，我们将API URL传递给钩子<code class="fe mv mw mx my b">useFetch</code>,因为它已经接受了一个URL参数。现在一切正常，我们的用户列表将会显示出来。</p><p id="7531" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就是如何创建一个获取数据的自定义钩子。您可以应用相同的方法来创建不同的定制挂钩。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="e7fb" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">结论</h1><p id="aaa4" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">如您所见，创建定制挂钩并不困难。它们非常有用，可以让你不再重复。这也是一个让你的代码更整洁的好方法，因为你不必在不同的组件中重复相同的功能。</p><p id="ea03" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢您阅读这篇文章。希望你觉得有用。</p><p id="edd5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">更多阅读</strong></p><div class="no np gp gr nq nr"><a rel="noopener  ugc nofollow" target="_blank" href="/10-useful-javascript-coding-techniques-that-you-should-use-e8e7960e08ed"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">您应该使用的10种有用的JavaScript编码技术</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">实现编程任务的有用JavaScript技术。</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="oa l"><div class="ob l oc od oe oa of kp nr"/></div></div></a></div><div class="no np gp gr nq nr"><a rel="noopener  ugc nofollow" target="_blank" href="/6-important-tips-to-write-clean-react-code-5ef29d6a73a6"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">编写干净的React代码的6个重要技巧</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">作为React开发人员，编写干净代码的技巧。</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="oa l"><div class="og l oc od oe oa of kp nr"/></div></div></a></div><p id="23a7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="oh">更多内容尽在</em><a class="ae oi" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="oh">plain English . io</em></a></p></div></div>    
</body>
</html>