<html>
<head>
<title>Enable Hot-Reload without Webpack-Dev-Server in Webpack 5 Boilerplate</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Webpack 5样板文件中启用不带Webpack-Dev-Server的热重装</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/enable-hot-reload-without-webpack-dev-server-in-webpack-5-boilerplate-76a9644a6e67?source=collection_archive---------0-----------------------#2021-12-03">https://javascript.plainenglish.io/enable-hot-reload-without-webpack-dev-server-in-webpack-5-boilerplate-76a9644a6e67?source=collection_archive---------0-----------------------#2021-12-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c696" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用例:铯JS网络包的例子。完整的代码实现。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5bfc7cf5c1212a6f4c2665100223ee3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Yunb95s16N2e1VmH"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@altumcode?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">AltumCode</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d5a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于使用bundler工具<a class="ae kv" href="https://webpack.js.org/" rel="noopener ugc nofollow" target="_blank"> Webpack </a>的Node.js web开发人员来说，许多人可能已经注意到了其配套模块<a class="ae kv" href="https://github.com/webpack/webpack-dev-server" rel="noopener ugc nofollow" target="_blank"> Webpack-Dev-Server </a> <strong class="ky ir">(本文发稿时为v4)——</strong>中的最新功能，即内置的“热加载”功能。(<strong class="ky ir">参考消息:</strong><a class="ae kv" href="https://webpack.js.org/" rel="noopener ugc nofollow" target="_blank">web pack</a>bundler最新版本为<strong class="ky ir"> v5 </strong>。)</p><h1 id="beb7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">解释和说明热重装</h1><h2 id="f57b" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">用例演示:<a class="ae kv" href="https://cesium.com/" rel="noopener ugc nofollow" target="_blank">铯</a>，一个JS工具，用于呈现3D网络内容</h2><p id="6847" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">对于本文的演示，所使用的starter Webpack样板文件将从<a class="ae kv" href="https://github.com/CesiumGS/cesium-webpack-example" rel="noopener ugc nofollow" target="_blank">铯与Webpack </a>中检索，这是一个用<a class="ae kv" href="https://github.com/webpack/webpack-dev-server" rel="noopener ugc nofollow" target="_blank"> Webpack-Dev-Server </a>配置的最小Webpack模板。(由<a class="ae kv" href="https://cesium.com/" rel="noopener ugc nofollow" target="_blank">铯</a>团队创造)</p><p id="cf7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基本上,“热重新加载”功能旨在通过动态更改web布局，而无需主动选择刷新按钮来重新呈现网页，从而使web开发成为一个无缝的过程。例如，在使用配置有<a class="ae kv" href="https://github.com/webpack/webpack-dev-server" rel="noopener ugc nofollow" target="_blank"> Webpack-Dev-Server </a>的Webpack 运行<a class="ae kv" href="https://github.com/CesiumGS/cesium-webpack-example" rel="noopener ugc nofollow" target="_blank">铯时，当同时对CSS文件<strong class="ky ir">(右侧)</strong>中的样式表进行更改时，会反映web布局<strong class="ky ir">(左侧)</strong>中的地图显示:</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/2f0154cbd612aea63942253943108f25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*oetISTBGBdm2lOtJuIm0TA.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screen Capture by Author | Illustrating corresponding changes made to the map application on the left upon modification of the ‘main.css’ file | Height of layout is reduced to half when the `height` property in main.css file is changed to `50vh`</figcaption></figure><p id="a8e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这提供了主要优势，例如:</p><ul class=""><li id="7a07" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated">无需主动选择“刷新”按钮</li><li id="e8b4" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">如上例所示，最小程度地改变应用程序的当前状态</li></ul><blockquote class="nq nr ns"><p id="c4e4" class="kw kx nt ky b kz la jr lb lc ld ju le nu lg lh li nv lk ll lm nw lo lp lq lr ij bi translated">如果发生了完全刷新，上面的地图将恢复到其初始位置，用户将需要再次将地图平移到所需的位置。</p></blockquote><p id="42ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">幸运的是，由于对<a class="ae kv" href="https://github.com/webpack/webpack-dev-server" rel="noopener ugc nofollow" target="_blank"> Webpack-Dev-Server </a>的最新调整，这可以通过<em class="nt"> webpack.config.js </em>文件快速配置，方法是将参数<code class="fe nx ny nz oa b">mode</code>设置为<code class="fe nx ny nz oa b"><strong class="ky ir">development</strong></code> <strong class="ky ir"> </strong>，就像上面的演示一样。</p><p id="f50b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<em class="nt"> package.json </em>中包含以下脚本后:</p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="b8a7" class="of lt iq oa b be og oh l oi oj">"start": "node_modules/.bin/webpack serve --config webpack.config.js --open"</span></pre><p id="702c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该应用程序可以通过以下命令运行:</p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="a7d8" class="of lt iq oa b be og oh l oi oj">npm start</span></pre><blockquote class="ok"><p id="b708" class="ol om iq bd on oo op oq or os ot lr dk translated">虽然上面的设置提供了方便的优势，但是这仅用于具有基本功能且很少需要定制的Webpack应用程序。</p></blockquote><p id="fabc" class="pw-post-body-paragraph kw kx iq ky b kz ou jr lb lc ov ju le lf ow lh li lj ox ll lm ln oy lp lq lr ij bi translated">为了覆盖<a class="ae kv" href="https://github.com/webpack/webpack-dev-server" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">web pack-Dev-Server</strong></a>的严格设置，下一节将演示<a class="ae kv" href="https://github.com/webpack/webpack-dev-server" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">web pack-Dev-Server</strong></a><strong class="ky ir"/>如何被<a class="ae kv" href="https://github.com/webpack-contrib/webpack-hot-middleware" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">web pack-Hot-Middleware</strong></a>和<a class="ae kv" href="https://github.com/webpack/webpack-dev-middleware" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">web pack-Dev-Middleware</strong></a>所取代，以实现相同的热重新加载功能，并提供更大的定制空间</p><h1 id="1c6f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">在Webpack样板文件中配置热重装</h1><p id="f65a" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">参考<a class="ae kv" href="https://github.com/CesiumGS/cesium-webpack-example" rel="noopener ugc nofollow" target="_blank">铯的网络包样板</a>，</p><h2 id="121a" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated"><strong class="ak">第一步。</strong>继续按顺序运行以下<code class="fe nx ny nz oa b">npm</code>命令</h2><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="c91b" class="of lt iq oa b be og oh l oi oj">npm uninstall webpack-dev-server --save-dev<br/>npm install webpack-dev-middleware webpack-hot-middleware express regenerator-runtime rimraf cross-env openurl --save-dev</span></pre><h2 id="8172" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated"><strong class="ak">第二步。</strong>修改webpack.config.js文件</h2><p id="a29e" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">一、将参数<code class="fe nx ny nz oa b">mode</code>值从<code class="fe nx ny nz oa b">development</code>更改为<code class="fe nx ny nz oa b">production</code>(热重装不再需要通过<code class="fe nx ny nz oa b">mode</code>参数使能)并将参数<code class="fe nx ny nz oa b">devtool</code>更改为<code class="fe nx ny nz oa b">inline-source-map</code></p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="f1f2" class="of lt iq oa b be og oh l oi oj">{<br/>    context: __dirname,<br/>    mode: 'production', // changed from 'development'<br/>    devtool: 'inline-source-map' // changed from 'eval'<br/>}</span></pre><p id="8b6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">二。对于参数<code class="fe nx ny nz oa b">entry</code>，包含在<code class="fe nx ny nz oa b">webpack-hot-middleware/client</code>中如下:</p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="feda" class="of lt iq oa b be og oh l oi oj">{<br/>    context: __dirname,<br/>    mode: 'production',<br/>    devtool: 'inline-source-map',  <br/>  <br/>    entry: {<br/>        app: 'webpack-hot-middleware/client', './src/index.js'<br/>    }<br/>}</span></pre><p id="235b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">三。对于参数<code class="fe nx ny nz oa b">plugins</code>，包含以下webpack中间件:</p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="cf75" class="of lt iq oa b be og oh l oi oj">{<br/>    context: __dirname,<br/>    mode: 'production',<br/>    devtool: 'inline-source-map',<br/>    entry: {<br/>        app: ['webpack-hot-middleware/client', './src/index.js']<br/>    },<br/>    plugins: [<br/>        new webpack.HotModuleReplacementPlugin(),<br/>        new webpack.NoEmitOnErrorsPlugin(), <br/>        new HtmlWebpackPlugin({<br/>            template: 'src/index.html'<br/>        }),<br/>        new CopyWebpackPlugin({<br/>            patterns: [                <br/>            { from: path.join(cesiumSource, cesiumWorkers), <br/>              to: 'Workers' },                <br/>            { from: path.join(cesiumSource, 'Assets'), <br/>              to: 'Assets' },                <br/>            { from: path.join(cesiumSource, 'Widgets'), <br/>              to: 'Widgets' }            <br/>            ]        <br/>        }),        <br/>        new webpack.DefinePlugin({<br/>            // Define relative base path in cesium for loading assets             <br/>            CESIUM_BASE_URL: JSON.stringify(''),<br/>            'process.env': {<br/>              'NODE_ENV': JSON.stringify('production')<br/>            }        <br/>        })<br/>    ]<br/>}</span></pre><h2 id="5659" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated"><strong class="ak">第三步。</strong>设置express.js服务器配置<a class="ae kv" href="https://github.com/webpack-contrib/webpack-hot-middleware" rel="noopener ugc nofollow" target="_blank"><strong class="ak">web pack-Hot-Middleware</strong></a>和<a class="ae kv" href="https://github.com/webpack/webpack-dev-middleware" rel="noopener ugc nofollow" target="_blank"><strong class="ak">web pack-Dev-Middleware</strong></a></h2><p id="f1f1" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">一、在<strong class="ky ir"> src </strong>文件夹下新建一个文件夹“server”和“index.js ”:</p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="9941" class="of lt iq oa b be og oh l oz oj">(root) celsium-webpack-modified<br/>  |--src<br/>  |   |--css<br/>  |   |   |--main.css<br/>  |   |--index.html<br/>  |   |--index.js<br/>  |   |<br/>  |   |--server<br/>  |        |--index.js<br/>  |<br/>  |--package.json<br/>  |--webpack.config.js</span></pre><p id="96e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">二。为了更好地组织项目结构，将出现在<strong class="ky ir"> src </strong>文件夹中的其他文章嵌套在一个“<strong class="ky ir"> app </strong>文件夹中:</p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="98bd" class="of lt iq oa b be og oh l oz oj">(root) celsium-webpack-example <br/>  |--src<br/>  |   |--app<br/>  |   |   |--css<br/>  |   |   |--main.css<br/>  |   |   |--index.html<br/>  |   |   |--index.js<br/>  |   |--server<br/>  |        |--index.js<br/>  |<br/>  |--package.json<br/>  |--webpack.config.js</span></pre><p id="9687" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">三。在server/index.js文件中，设置express Node.js服务器，如下所示:</p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="a2e4" class="of lt iq oa b be og oh l oi oj">// server/index.js<br/>const express= require('express');<br/>const app = express();<br/>const path= require('path');<br/>const HOSTNAME = 'localhost';<br/>const PORT = 8080;<br/>const webpack= require('webpack');<br/>const webpackconfig = require('../../webpack.config.js');<br/>const webpackMiddleware= require('webpack-dev-middleware');<br/>const webpackHotMiddleware= require('webpack-hot-middleware');<br/>const buildDir = '../../dist/';<br/>app.use(express.static(path.join(__dirname, buildDir)));<br/>const webpackCompiler=webpack(webpackconfig);<br/>const wpmw = webpackMiddleware(webpackCompiler,{ });<br/>app.use(wpmw);<br/>app.use(webpackHotMiddleware(webpackCompiler));<br/>app.listen(PORT, (err) =&gt; {<br/>    if (err) { return console.error(err); }<br/>    console.log(`Server running on ${HOSTNAME}:${PORT}`);<br/>    require("openurl").open(`http://${HOSTNAME}:${PORT}`);<br/>});</span></pre><h2 id="9296" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated"><strong class="ak">第四步。</strong>修改webpack.config.js，更新<em class="pa"> src/index.html </em>和入口文件<em class="pa">各自的路径。/src/index.js </em></h2><ul class=""><li id="4b02" class="nc nd iq ky b kz mw lc mx lf pb lj pc ln pd lr nh ni nj nk bi translated">在<code class="fe nx ny nz oa b">resolve</code>下，为css文件夹添加一个新的别名(这是为了引用应用程序中的所有css文件)</li></ul><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="af3d" class="of lt iq oa b be og oh l oi oj">{<br/>    context: __dirname,<br/>    mode: 'production',<br/>    devtool: 'inline-source-map',<br/>    entry: {<br/>        app: ['webpack-hot-middleware/client', './src/app/index.js']<br/>    },<br/>    resolve: {<br/>        alias: {<br/>            cesium: path.resolve(__dirname, cesiumSource),<br/>            css: path.resolve(__dirname, 'src/app/css')<br/>        },<br/>        mainFiles: ['index', 'Cesium']<br/>    },<br/>    plugins: [<br/>        new webpack.HotModuleReplacementPlugin(),<br/>        new webpack.NoEmitOnErrorsPlugin(), <br/>        new HtmlWebpackPlugin({<br/>            template: 'src/app/index.html'<br/>        }),<br/>        new CopyWebpackPlugin({<br/>            patterns: [                <br/>            { from: path.join(cesiumSource, cesiumWorkers), <br/>              to: 'Workers' },                <br/>            { from: path.join(cesiumSource, 'Assets'), <br/>              to: 'Assets' },                <br/>            { from: path.join(cesiumSource, 'Widgets'), <br/>              to: 'Widgets' }            <br/>            ]        <br/>        }),        <br/>        new webpack.DefinePlugin({<br/>            // Define relative base path in cesium for loading assets             <br/>            CESIUM_BASE_URL: JSON.stringify(''),<br/>            'process.env': {<br/>              'NODE_ENV': JSON.stringify('production')<br/>            }        <br/>        })<br/>    ]<br/>}</span></pre><ul class=""><li id="2f3e" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated">更新对<em class="nt"> src/app/index.js </em>文件中<em class="nt"> main.css </em>文件的引用</li></ul><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="488f" class="of lt iq oa b be og oh l oi oj">import "css/main.css" // changed from "../src/css/main.css"</span></pre><h2 id="7ba6" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">第五步。更新package.json</h2><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="df6f" class="of lt iq oa b be og oh l oi oj">{  <br/>  "main": "src/server/index.js",<br/>  "scripts": {<br/>    "build": "rimraf dist &amp;&amp; cross-env webpack",<br/>    "start": "node src/server/index.js"<br/>  }<br/>}</span></pre><h2 id="3bd8" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">➜测试运行修改后的Webpack应用程序</h2><p id="9c74" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">要确保成功实施热重装功能，请运行以下命令来运行更新的铯网络包应用程序:</p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="d8f6" class="of lt iq oa b be og oh l oi oj">npm run build<br/>npm start</span></pre><p id="e14c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样，当高度属性从“100vh”更改为“50vh”时，以下更改将反映在地图位置不变的情况下<strong class="ky ir">(仅供参考:这可能需要1分钟)</strong>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pe"><img src="../Images/89c902bd166f2a53bd9b5e56c36423ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3eycr56Y0VYSU-6HMuwPnA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by Author | Similar to before, when the height property is changed the layout of the map re-renders accordingly</figcaption></figure><h1 id="03c1" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">减少热重装的渲染时间</h1><p id="5776" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">显然，虽然webpack-dev-server的热重新加载只需要几秒钟就可以重新呈现地图，但是中间件服务器的热重新加载需要49秒才能完成，因为这个过程涉及到重新构建导入的节点模块。为了减少包的重建过程，有几个方面需要修改。</p><h2 id="00c7" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">1) webpack.config.js —优化参数</h2><p id="3792" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">回想一下<code class="fe nx ny nz oa b">mode</code>参数值现在是“生产”。将参数<code class="fe nx ny nz oa b">optimization</code>添加到webpack.config.js文件中:</p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="c981" class="of lt iq oa b be og oh l oi oj">{<br/>    optimization: {<br/>        // chunkIds: 'named',<br/>        // moduleIds: 'deterministic',<br/>        concatenateModules: true,<br/>        mangleExports: true,<br/>        mangleWasmImports: true,<br/>        // mergeDuplicateChunks: false,<br/>        minimize: false,<br/>        innerGraph: false,<br/>        minimizer: [<br/>            new CssMinimizerPlugin(),<br/>            new TerserPlugin({<br/>                parallel: true,<br/>                terserOptions: {<br/>                    compress: true,<br/>                    // minify: TerserPlugin.uglifyJsMinify,<br/>                    mangle: true<br/>                },<br/>            extractComments: false<br/>          })<br/>        ],<br/>        emitOnErrors: false,<br/>        nodeEnv: 'production',<br/>        removeAvailableModules: false<br/>        // splitChunks: {<br/>        //     chunks: 'all',<br/>        //     name: false<br/>        // }<br/>   },<br/>}</span></pre><p id="bfa9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如上所示，使用了最小化插件，如<a class="ae kv" href="https://www.npmjs.com/package/css-minimizer-webpack-plugin" rel="noopener ugc nofollow" target="_blank">CSS-minimizer-web pack-plugin</a>和<a class="ae kv" href="https://www.npmjs.com/package/terser-webpack-plugin" rel="noopener ugc nofollow" target="_blank"> terser-webpack-plugin </a>。因此，通过运行以下命令来安装这些模块:</p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="7c15" class="of lt iq oa b be og oh l oi oj">npm install terser-webpack-plugin css-minimizer-webpack-plugin --save</span></pre><p id="f14d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用以下代码将这两个模块导入webpack.config.js:</p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="85b5" class="of lt iq oa b be og oh l oi oj">const CssMinimizerPlugin = require('css-minimizer-webpack-plugin');<br/>const TerserPlugin = require('terser-webpack-plugin');</span></pre><p id="7aec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">仅供参考:</strong>您可以在<a class="ae kv" href="https://webpack.js.org/configuration/optimization/" rel="noopener ugc nofollow" target="_blank"> Optimization | webpack </a>查看关于这些参数的官方文件，以评估哪些设置最适合您的webpack应用程序的最终版本。</p><h2 id="bd65" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">2) webpack.config.js —文件加载器</h2><p id="1f92" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">请注意，根据应用程序提供的文件类型，不同的加载器可以显著减少渲染时间。因为这个演示的应用程序由文件扩展名组成，比如<em class="nt">。json </em>和<em class="nt">。jpg </em>文件，可以分别使用<a class="ae kv" href="https://www.npmjs.com/package/json-perf-loader" rel="noopener ugc nofollow" target="_blank"> json-perf-loader </a>和<a class="ae kv" href="https://www.npmjs.com/package/image-webpack-loader" rel="noopener ugc nofollow" target="_blank"> image-webpack-loader </a>(注意:可以随意使用其他加载器。这些只是建议。)</p><ul class=""><li id="bb01" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated">通过npm命令安装加载程序</li></ul><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="7beb" class="of lt iq oa b be og oh l oi oj">npm install json-perf-loader image-webpack-loader file-loader --save</span></pre><ul class=""><li id="0035" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated">在webpack.config.js中的参数<code class="fe nx ny nz oa b">module</code>下，配置这些加载器来处理各自的文件类型</li></ul><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="c8a8" class="of lt iq oa b be og oh l oi oj">{   <br/>    module: {<br/>        rules: [{<br/>            test: /\.css$/,<br/>            use: [ 'style-loader', 'css-loader' ]<br/>        },<br/>        {<br/>            test: /\.(png|gif|jpg|jpeg|svg)$/i, <br/>            use: [<br/>                'file-loader?name=[path][name][ext]',<br/>                {<br/>                    loader: 'image-webpack-loader',<br/>                    options: { <br/>                      bypassOnDebug: true, // webpack@1.x<br/>                      disable: true, // webpack@2.x and newer                           <br/>                      optipng: {                <br/>                        enabled: false<br/>                      }<br/>                    }<br/>                }<br/>            ]<br/>        },<br/>        {        <br/>            test: /\.(json|geojson)$/,<br/>            use: [<br/>                'file-loader?name=[path][name][ext]',<br/>                {  <br/>                    loader: 'json-perf-loader'<br/>                }<br/>            ]<br/>        },<br/>        {<br/>            test: /\.(png|gif|jpg|jpeg|svg|xml|json)$/,<br/>            use: [ 'url-loader' ]<br/>        }]<br/>    },<br/>}</span></pre><h2 id="6713" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">3) src/server/index.js —捆绑压缩</h2><p id="444e" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">除了点<strong class="ky ir"> 1) </strong>和点<strong class="ky ir"> 2) </strong>之外，在<strong class="ky ir"> src/server/index.js </strong>文件中设置了webpack-dev-中间件和webpack-hot-中间件的express.js服务器的地方，通过运行<code class="fe nx ny nz oa b">npm install compression --save</code>安装模块<a class="ae kv" href="https://www.npmjs.com/package/compression" rel="noopener ugc nofollow" target="_blank">压缩</a></p><p id="ad55" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在文件顶部包括以下行:<strong class="ky ir"> src/server/index.js </strong></p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="dc94" class="of lt iq oa b be og oh l oi oj">const express= require('express');<br/>const app = express();<br/><br/>const compression = require('compression');<br/>app.use(compression());</span></pre><h2 id="c27e" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">➜重新运行应用程序</h2><p id="60cc" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">通过执行以下npm命令运行更新的Celsium Webpack应用程序:</p><pre class="kg kh ki kj gt ob oa oc bn od oe bi"><span id="dfa0" class="of lt iq oa b be og oh l oi oj">npm run build<br/>npm start</span></pre><p id="19f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与之前类似，调整CSS并观察在开发人员控制台中重建webpack模块所需的时间:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/ccdade5bf3ce7b3bdd3574cf576e283b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vRSkpLYnFQJh-EErdvOLGQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by Author | The above console belongs to the initial reload time taken by the middleware. The console below (with yellow outline) belongs to the current reload time taken.</figcaption></figure><blockquote class="ok"><p id="f757" class="ol om iq bd on oo op oq or os ot lr dk translated">显然，虽然之前只花了~48秒，但经过上述调整后，花的时间要短得多~9秒。</p></blockquote><p id="78a7" class="pw-post-body-paragraph kw kx iq ky b kz ou jr lb lc ov ju le lf ow lh li lj ox ll lm ln oy lp lq lr ij bi translated">完整的源代码可以在我的GitHub Repo上找到:<a class="ae kv" href="https://github.com/incubated-geek-cc/Celsium-Webpack-Boilerplate" rel="noopener ugc nofollow" target="_blank">Celsium-Webpack-样板文件</a></p></div><div class="ab cl pg ph hu pi" role="separator"><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl"/></div><div class="ij ik il im in"><h1 id="1097" class="ls lt iq bd lu lv pn lx ly lz po mb mc jw pp jx me jz pq ka mg kc pr kd mi mj bi translated">结论</h1><p id="03b8" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">虽然内置的热重新加载功能使NodeJS web开发人员能够在设置Webpack中间件时节省大量时间，但它确实限制了应用程序的可伸缩性，因此更适合于基本上是静态的简单用例。</p><p id="77fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，如果应用程序需要额外的功能数组或框架迁移，那么从长远来看，在Node.js webpack应用程序上投入更多的时间和精力是值得的。</p><h1 id="1d07" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">Webpack中间件应用程序中的潜在加载项列表</h1><ul class=""><li id="ee98" class="nc nd iq ky b kz mw lc mx lf pb lj pc ln pd lr nh ni nj nk bi translated">记录</li><li id="1a69" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">在express.js服务器中构建API</li><li id="be2e" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">提供静态文件路径</li><li id="fa1b" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">使用express.js路由器配置代理请求</li></ul></div><div class="ab cl pg ph hu pi" role="separator"><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl"/></div><div class="ij ik il im in"><h2 id="c888" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">非常感谢你坚持到这篇文章的结尾！❤希望你觉得这个指南有用，如果你想了解更多GIS、数据分析&amp; Web应用相关的内容，请随时<a class="ae kv" href="https://medium.com/@geek-cc" rel="noopener">关注我的Medium </a>。会非常感激😀</h2></div><div class="ab cl pg ph hu pi" role="separator"><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl"/></div><div class="ij ik il im in"><h2 id="39d7" class="mk lt iq bd lu ml mm dn ly mn mo dp mc lf mp mq me lj mr ms mg ln mt mu mi mv bi translated">以防你错过了这个链接，这里是本教程的完整源代码。随意叉为己用:<a class="ae kv" href="https://github.com/incubated-geek-cc/Celsium-Webpack-Boilerplate" rel="noopener ugc nofollow" target="_blank">Celsium-web pack-Boilerplate</a></h2><div class="ps pt gp gr pu pv"><a href="https://geek-cc.medium.com/membership" rel="noopener follow" target="_blank"><div class="pw ab fo"><div class="px ab py cl cj pz"><h2 class="bd ir gy z fp qa fr fs qb fu fw ip bi translated">通过我的推荐链接加入灵媒——李思欣·崔</h2><div class="qc l"><h3 class="bd b gy z fp qa fr fs qb fu fw dk translated">获得李思欣·崔和其他作家在媒体上的所有帖子！😃您的会员费直接…</h3></div><div class="qd l"><p class="bd b dl z fp qa fr fs qb fu fw dk translated">geek-cc.medium.com</p></div></div><div class="qe l"><div class="qf l qg qh qi qe qj kp pv"/></div></div></a></div><p id="1b57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nt">更多内容看</em> <a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="nt">说白了就是</em> </strong> </a> <strong class="ky ir"> <em class="nt">。</em> </strong> <em class="nt">报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="nt">免费每周简讯点击这里</em> </strong> </a> <strong class="ky ir"> <em class="nt">。</em> </strong></p></div></div>    
</body>
</html>