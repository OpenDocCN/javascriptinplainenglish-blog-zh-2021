<html>
<head>
<title>How to Prevent Nesting <button> Descendant Error in React</button></title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何防止嵌套<button>后代错误在反应</button></h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/prevent-validatedomnesting-button-descendant-error-21d9a34e5984?source=collection_archive---------11-----------------------#2021-06-03">https://javascript.plainenglish.io/prevent-validatedomnesting-button-descendant-error-21d9a34e5984?source=collection_archive---------11-----------------------#2021-06-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="03e0" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">你熟悉这个错误吗？💻</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi kc"><img src="../Images/7a77f1166d3666d2143d622c8d25be18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*6QlRWacrfgOvidz_GMF7ww.jpeg"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Every day is a miracle 🌸</figcaption></figure><p id="5fde" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在我最近正在做的项目中，我需要创建一个“<strong class="kq io">对话框</strong>”作为包含一个基本的“<strong class="kq io">输入表单</strong>”的<strong class="kq io">覆盖图</strong>。在这个覆盖图中，还有一个可点击的<strong class="kq io">按钮</strong>，可以打开一个“<strong class="kq io">电子邮件确认</strong>覆盖图。</p><p id="141e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为了让它更清晰，我们先来看看“输入表单”的叠加，它应该是这样的:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lk"><img src="../Images/bc04772cfe44ae47a9e6f7d025bc742c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wJbztfCORU6ZYvpN9m5OKw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">The overlay in the middle is opened by the red button at the top right of the background page</figcaption></figure><p id="9cb2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="lp">🔴红色按钮是使用</em><a class="ae lq" href="https://reakit.io/docs/get-started/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="lp">Reakit</em></strong></a><em class="lp">库创建的按钮组件。Reakit是一个低级组件库，用于构建可访问的高级UI库，用React设计系统和应用程序。</em></p><p id="c49f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">点击这个"<strong class="kq io">输入表单上的按钮</strong>叠加，经过一些验证后，你将能够打开"<strong class="kq io">邮件确认"</strong>叠加:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lr"><img src="../Images/11c78f8ff86084d21cab8c854a768d1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*14VWF1cxchvyfveY46LBJQ.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk"><strong class="bd ls">“email confirmation”</strong> overlay is opened from the button within “<strong class="bd ls">input form</strong>” overlay, the email address is just an example</figcaption></figure></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><p id="dd95" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">步骤非常简单:</p><p id="f705" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">首先，我们创建一个<strong class="kq io">可重用按钮组件</strong>(在本例中是<strong class="kq io"> </strong>红色的<strong class="kq io"><em class="lp">通知我</em></strong>按钮)，为了使整个页面看起来和谐统一，没有必要重复创建类似的按钮:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/d6a2588b5d06b23014cf56fac154eda3.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*ZqwLTtS6Xey7UZvhVg_arA.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">part of reusable Button Component example</figcaption></figure><p id="aae6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">其次，创建带有这个红色按钮的"<strong class="kq io">input verlay</strong>"组件，它可以打开"<strong class="kq io"> email confirmation </strong>"覆盖图(<strong class="kq io"> Modal </strong>)，我们在其中导入我们的按钮组件，类似如下:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mb"><img src="../Images/1f60e8dd0f39ef9dd014f7aa4eb67b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GXZAbsK3vbuc_CH2CXyLng.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">“<strong class="bd ls">email confirmation</strong>” overlay(in this case: <strong class="bd ls">Modal,</strong> which is another reusable component) will be opened from this button within DialogDisclosure</figcaption></figure></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><p id="7ff4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">就这样？！那很容易！让我们打开控制台检查一下。</p><p id="bee4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">💥啊，在这里！一切正常，页面看起来不错，但是我注意到实际上存在一个错误:<code class="fe mc md me mf b">validateDOMNesting(…): &lt;button&gt; cannot appear as a descendant of &lt;button&gt; ...</code></p><p id="e1a0" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">作为一个追求完美的开发者，我不希望那些红字出现，我得做点什么来防止，忘了文章开头的笑话吧…</p></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><p id="70a4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">经过一系列检查，我找到了原因:</p><p id="5649" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">默认<a class="ae lq" href="https://reakit.io/docs/dialog/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io">dialog Disclosure</strong></a>使用<a class="ae lq" href="https://reakit.io/docs/disclosure/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> Disclosure </strong> </a>，由PopoverDisclosure及其衍生产品使用，Disclosure使用<strong class="kq io">按钮</strong>。</p><p id="4ffa" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这意味着:</p><p id="ea54" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在“input form”覆盖中，<strong class="kq io"> DialogDisclosure </strong>已经嵌套在一个<strong class="kq io">按钮</strong>组件中，因此出现了错误，像我之前那样将按钮包装在DialogDisclosure中并不是最好的方式，这就是为什么“<em class="lp"> validateDOMNesting(…): &lt;按钮&gt;不能作为&lt;按钮&gt; … </em>的后代出现，虽然这并不影响程序的运行。🌦</p><p id="4d66" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">以下是我的简单解决方案:</p><p id="2de0" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">🌟创建了一个简单的类似<strong class="kq io">按钮的</strong>组件，并在对话框中使用它代替<strong class="kq io">按钮</strong>:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mg"><img src="../Images/44372011278ae88870f1f7af89000cd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tjTHSjxB31E4Tpm67aETnw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">“Button-like” component: NotifyOverlayButton returns a simple “div”</figcaption></figure><p id="77d2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">给它一些样式，使它看起来像我们的按钮:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/1626be9a8e638f508d9ffafae9d6c699.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*OSpqKaugZPYtoDex_F_KRQ.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Please ignore the scss module for this example</figcaption></figure><p id="3d7e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在<strong class="kq io"> InputOverlay </strong>组件中，导入并使用它代替“<strong class="kq io">按钮</strong>”。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mi"><img src="../Images/1e8b1c662290ac07db4e4a97de7bb775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5P7ku6q3ke05idcUlo1IQ.png"/></div></div></figure><p id="9f8d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在错误没有了！</p></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><h2 id="54e7" class="mj mk in bd ml mm mn dn mo mp mq dp mr kx ms mt mu lb mv mw mx lf my mz na nb bi translated">结论</h2><p id="1f05" class="pw-post-body-paragraph ko kp in kq b kr nc jo kt ku nd jr kw kx ne kz la lb nf ld le lf ng lh li lj ig bi translated">从这个简单的经历中，我学会了如何正确阅读错误信息，以及一步一步找到错误根源的重要性。有时候有些错误并不影响应用，但是你学到的每一个知识点都会让你感到快乐！</p><p id="d6b9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我希望你喜欢这篇文章，还有一篇文章与这个例子有关:</p><div class="nh ni gp gr nj nk"><a href="https://medium.com/geekculture/react-email-validation-with-dialog-overlay-472ee564d585" rel="noopener follow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd io gy z fp np fr fs nq fu fw im bi translated">用对话框覆盖反应电子邮件验证</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">—电子邮件验证有时令人头疼，🧊</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">medium.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny ki nk"/></div></div></a></div><p id="bb4d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">谢谢大家，编码快乐！</p><p id="9964" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="lp">更多内容看</em> <a class="ae lq" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="lp">说白了. io </em> </strong> </a></p></div></div>    
</body>
</html>