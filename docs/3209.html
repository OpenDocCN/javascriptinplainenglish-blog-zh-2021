<html>
<head>
<title>5 Essential Tips for Testing JavaScript UIs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">测试JavaScript用户界面的5个基本技巧</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/5-essential-tips-for-testing-javascript-uis-3cbf57d507e0?source=collection_archive---------7-----------------------#2021-06-30">https://javascript.plainenglish.io/5-essential-tips-for-testing-javascript-uis-3cbf57d507e0?source=collection_archive---------7-----------------------#2021-06-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3994" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">说到为(JavaScript)ui编写测试，你要么喜欢，要么不喜欢。但是，如果你在一个要求一定测试覆盖阈值的公司里，或者你想要覆盖逻辑，你最终将不得不这样做。不管你的情况如何，我相信下面的五个建议会帮助你写出更好的测试。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/d89e1301ea32fffb4cff50b2a29502f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6wehmIg6j6R9KvrY"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Photo by <a class="ae lb" href="https://unsplash.com/@anniespratt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Annie Spratt</a> on <a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1370" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">开始的时候，我在编写测试方面做了很多努力。这个概念非常简单——您编写代码来验证您编写的其他代码。但是，当时有些不对劲，起初我并不太喜欢它。一晃几年过去了，我现在对写作测试还算满意。我已经想好了。这些是我发现在日常编写UI测试中最有用的技巧。</p><h1 id="560b" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated"><strong class="ak"> 1。测试行为，而不是实现</strong></h1><p id="cacb" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">对于一些人来说，遵循测试UI行为而不是实现的原则可能是很自然的。但是请相信我，有时候，在测试代码的深处，您可能会失去这个想法，并试图通过破解来摆脱测试。</p><p id="544a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你熟悉测试驱动开发(<a class="ae lb" href="https://en.wikipedia.org/wiki/Test-driven_development" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> TDD </strong> </a>)，还有行为驱动开发(<a class="ae lb" href="https://en.wikipedia.org/wiki/Behavior-driven_development" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> BDD </strong> </a>)。这个想法是使用DSL(领域特定语言)创建一个几乎项目中每个人都能理解的脚本。很长一段时间，制作它的主要工具是黄瓜(图书馆，而不是蔬菜)。它将允许您像这样形成一个测试脚本:</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="b6c1" class="mk ld iq mg b gy ml mm l mn mo">Feature: Put items in the cart</span><span id="0b5a" class="mk ld iq mg b gy mp mm l mn mo">  Scenario: Breaker joins a game<br/>    Given the user has visited the awesome shopping page<br/>    When the user adds an item to the cart<br/>    Then the user should see the item in the cart</span></pre><p id="1095" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个想法很简单，实现使用带有“给定”、“当”和“然后”格式的Gherkin语法。像这样的脚本是为了让涉众阅读它们并理解特性和场景，但是我很少看到他们在实践中阅读它们。</p><p id="7010" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">无论如何，如果你不是这类工具的粉丝，你可以跳过使用它(咄)，但是记住你应该测试行为。</p><h1 id="8519" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">2.一次测试一件事</h1><p id="fc85" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">几年前我给自己的一个很好的建议是在一次测试中专注于测试一件事情。我过去常常在一次测试中测试许多不同的东西。Cypress framework做的一件好事是，他们建议只测试登录功能<strong class="jp ir">一次</strong>，并在所有其他测试中以编程方式登录。</p><p id="b903" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设您正在测试向购物车添加商品。理想情况下，如果您在测试中关注UI功能，那将是最好的。所有其他的事情，比如:</p><ul class=""><li id="0f05" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk mv mw mx my bi translated">登录中，</li><li id="aaeb" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">播种要添加到卡中的项目，</li><li id="4c3c" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">发布用户将购买商品的商店</li></ul><p id="00cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">都应该是计划的一部分。您不应该在测试中直接做所有这些事情，相反，只需要关注用户向购物车中添加商品所采取的操作。</p><h1 id="25fd" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">3.适当地构造测试</h1><p id="4b1d" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">另一件让你在测试中成功的事情是遵循AAA模式。AAA代表以下内容:</p><ul class=""><li id="be78" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk mv mw mx my bi translated">第一个A — <strong class="jp ir">安排</strong>:为即将被测试的功能设置测试所需的一切。播种数据、登录用户、存根调用等。</li><li id="edea" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">第二个A — <strong class="jp ir">动作</strong>:执行向购物车中添加商品这样的动作。</li><li id="0bb5" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">第三个A — <strong class="jp ir">断言</strong>:确保收到的值满足期望值。确保测试验证了预期的行为。</li></ul><p id="f7ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">继续，并在您的下一次测试中尝试它。</p><h1 id="84ff" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">4.使用助手来生成测试数据</h1><p id="6622" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">通常，您会面临同样的问题——在测试中创建特定的数据对象。无论是产品、用户还是随机物品，您都必须在测试设置中以某种方式创建对象。这里有一个软件设计模式可以帮助你，那就是工厂模式。</p><p id="8e2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个可以帮助我们生成对象的库是<a class="ae lb" href="https://github.com/thoughtbot/fishery" rel="noopener ugc nofollow" target="_blank">渔业</a>库。如果你用的是TypeScript，这两个可以完美契合。假设我们想在测试中生成一个用户。一种方法是这样的:</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="26d0" class="mk ld iq mg b gy ml mm l mn mo">// factories/user.ts<br/>import { Factory } from 'fishery';<br/>import { User } from '../my-types';<br/>import postFactory from './post';</span><span id="9be9" class="mk ld iq mg b gy mp mm l mn mo">export default Factory.define&lt;User&gt;(({ sequence }) =&gt; ({<br/>  id: sequence,<br/>  name: 'Rosa',<br/>  address: { city: 'Austin', state: 'TX', country: 'USA' },<br/>  posts: postFactory.buildList(2),<br/>}));</span></pre><p id="24a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我们可以轻松地创建用户，如下所示:</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="175a" class="mk ld iq mg b gy ml mm l mn mo">const user = userFactory.build({ name: 'Sandra' });</span></pre><p id="e97f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您现在应该有更精确的测试，因为您可以在不指定所有属性的情况下生成对象，只指定那些与您正在编写的当前测试相关的属性。此外，用户工厂定义在一个地方，您可以很容易地从那里编辑它，当一些属性改变时，不需要进行所有的测试。</p><h1 id="210c" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">5.避免睡觉(在考试中)</h1><p id="899d" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我们都遇到过这种情况，设置一些超时来处理一个异步测试用例或强制下一个节拍。有了新工具，你就不必这么做了。如果您正在测试一些异步代码，您可以使用Jest来测试它:</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="bb7f" class="mk ld iq mg b gy ml mm l mn mo">test('the data is peanut butter', async () =&gt; {<br/> const data = await fetchData();<br/> expect(data).toBe('peanut butter');<br/>});</span></pre><p id="b849" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有了简单的<em class="ne"> async / await </em>语法，就不再需要<em class="ne"> setTimeout </em>了。或者，更好的是，如果您使用的是<a class="ae lb" href="https://www.cypress.io/" rel="noopener ugc nofollow" target="_blank"> Cypress </a>，它们有一个集成的等待机制，可以为每个命令的执行提供一定的时间。同样，在<em class="ne">测试库</em>中，你可以像<a class="ae lb" href="https://testing-library.com/docs/dom-testing-library/api-async/#waitfor" rel="noopener ugc nofollow" target="_blank"> its文档</a>中描述的那样<em class="ne">等待</em>。</p><p id="551b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">无论如何，无论你做什么，在你调用setTimeout或任何其他与时间相关的方法之前要三思，因为这将使你的测试可读性更差，并且可能不可靠。</p><h1 id="54a6" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">总结</h1><p id="edee" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">感谢你阅读这五条建议。我希望你在他们之后获得了一些洞察力。另外，我希望这些能帮助你为你的JavaScript应用程序编写更好的UI测试。</p><p id="e57c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你对更多类似的博客文章感兴趣，可以考虑订阅<a class="ae lb" href="https://pragmaticpineapple.com/newsletter" rel="noopener ugc nofollow" target="_blank">时事通讯</a>。此外，如果你觉得这篇博文有用，你可以在下面的Twitter上与你的朋友和同事分享:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="fb0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下次再见，干杯。</p><p id="ba8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ne">更多内容尽在</em><a class="ae lb" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="ne">plain English . io</em></strong></a></p></div></div>    
</body>
</html>