<html>
<head>
<title>How to Convert XLSX to JSON</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将XLSX转换成JSON</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-convert-xlsx-to-json-4439cc3d6a81?source=collection_archive---------3-----------------------#2021-12-16">https://javascript.plainenglish.io/how-to-convert-xlsx-to-json-4439cc3d6a81?source=collection_archive---------3-----------------------#2021-12-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/596e6595a8eb55546b823921e3a92ec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DQ5y83TjF804miVd7hSGxA.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@mbaumi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Mika Baumeister</a> on <a class="ae jz" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="bfdd" class="ka kb in bd kc kd ke dn kf kg kh dp ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">你需要从电子表格中获取数据并将其转换成JSON吗？那不是🚀科学，我要证明它！</h2><p id="80fa" class="pw-post-body-paragraph kw kx in ky b kz la lb lc ld le lf lg kj lh li lj kn lk ll lm kr ln lo lp lq ig bi translated">首先，安装<strong class="ky io"> xlsx </strong>包。</p><p id="faa5" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">使用npm:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="ac6f" class="ka kb in mb b gy mf mg l mh mi">// NPM<br/>npm  install  xlsx</span><span id="ddf6" class="ka kb in mb b gy mj mg l mh mi">// Yarn<br/>yarn  add  xlsx</span></pre><p id="673a" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">在<strong class="ky io"> app.js </strong>文件中，导入xlsx和fs读取excel文件，并声明一个我们后面会用到的变量。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="8412" class="ka kb in mb b gy mf mg l mh mi">const XLSX = require('xlsx');<br/>const fs = require('fs');<br/>const finalObject = {};</span></pre><p id="fb28" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">要读取和获取缓冲区类型的文件内容:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="3ec2" class="ka kb in mb b gy mf mg l mh mi">const data = XLSX.read(myFile, { type: 'buffer' });</span></pre><p id="ee39" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated"><em class="mk">注意:不同的类型是“字符串”、“缓冲区”、“base64”、“二进制”、“文件”、“数组”</em></p><p id="8e80" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">如果你写<strong class="ky io"> console.log(数据。您将看到您的电子表格和单元格的内容。</strong></p><p id="0d0f" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">然后，您必须为每个电子表格的每一行编写流程。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="6b29" class="ka kb in mb b gy mf mg l mh mi">data.SheetNames.forEach(sheetName =&gt; {<br/>  let rowObject = XLSX.utils.sheet_to_json(data.Sheets[sheetName]);</span><span id="a7c2" class="ka kb in mb b gy mj mg l mh mi">  finalObject[sheetName] = rowObject;<br/>});</span></pre><p id="a163" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">函数允许你将一个电子表格转换成一个对象数组。</p><p id="11db" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">它采用不同的可选参数，你可以在这里找到<a class="ae jz" href="https://www.npmjs.com/package/xlsx" rel="noopener ugc nofollow" target="_blank"/></p><p id="fe06" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">在这里我们什么都不需要。</p><p id="05b0" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">如果您执行console.log( <strong class="ky io"> rowObject </strong>)，您将看到它包含一个数组，并且电子表格的每一行都被转换成一个对象，如下所示:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="275b" class="ka kb in mb b gy mf mg l mh mi">[<br/>  { "ID": 1, "Last name": "Doe", "First name": "John" },</span><span id="e4ad" class="ka kb in mb b gy mj mg l mh mi">  { "ID": 2, "Last Name": "Doe", "First name": "Jane" }<br/>]</span></pre><p id="0f8b" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">还记得我们一开始声明的变量吗？是时候使用它了。我们将为每个电子表格创建一个键，并将<strong class="ky io"> rowObject </strong>分配给它:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="959d" class="ka kb in mb b gy mf mg l mh mi">data.SheetNames.forEach(sheetName =&gt; {<br/>  let rowObject = XLSX.utils.sheet_to_json(data.Sheets[sheetName]);</span><span id="2fba" class="ka kb in mb b gy mj mg l mh mi">  finalObject[sheetName] = rowObject;<br/>});</span></pre><p id="b64e" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">如果你<strong class="ky io">console . log(final object)</strong>:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="b528" class="ka kb in mb b gy mf mg l mh mi">"Utilisateurs": [<br/>{ "ID": 1, "Last name": "Doe", "First name": "John" },<br/>{ "ID": 2, "Last name": "Doe", "First name": "Jane" }<br/>]</span></pre><p id="a26e" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">如果您想将输出写入一个文件，只需添加这一行:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="ea15" class="ka kb in mb b gy mf mg l mh mi">fs.writeFileSync('./target.json', JSON.stringify(dataObject));</span></pre><p id="d169" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">瞧啊。🎉</p><p id="3a47" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">现在您知道如何将Excel电子表格转换成JSON了！</p><p id="1b40" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated">最初发布于<a class="ae jz" href="https://blog.ludivineachouri.com" rel="noopener ugc nofollow" target="_blank">我的博客</a>。</p><p id="792f" class="pw-post-body-paragraph kw kx in ky b kz lr lb lc ld ls lf lg kj lt li lj kn lu ll lm kr lv lo lp lq ig bi translated"><em class="mk">更多内容请看</em><strong class="ky io"><em class="mk"/></strong><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky io"><em class="mk">说白了. io </em> </strong> </a> <strong class="ky io"> <em class="mk">。</em> </strong> <em class="mk">报名参加我们的</em> <a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky io"> <em class="mk">免费每周简讯这里</em> </strong> </a> <strong class="ky io"> <em class="mk">。</em>T47】</strong></p></div></div>    
</body>
</html>