<html>
<head>
<title>Integrate Redux Toolkit, Redux persist, and React-Native Debugger with a React Native App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Redux Toolkit、Redux persist和React-Native调试器与React本机应用程序集成在一起</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/integrating-redux-toolkit-redux-persist-and-react-native-debugger-to-a-react-native-app-f41e63476016?source=collection_archive---------3-----------------------#2021-09-19">https://javascript.plainenglish.io/integrating-redux-toolkit-redux-persist-and-react-native-debugger-to-a-react-native-app-f41e63476016?source=collection_archive---------3-----------------------#2021-09-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/5165dbdecfc76528ac273c7e30aa0894.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BHUJB_SeelMNPfFFXGmamg.png"/></div></div></figure><h1 id="baae" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">背景:</h1><p id="a35b" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">当您作为一名新的开发人员来到全局状态管理时，最常见的事情之一就是“Redux太复杂了”、“它有太多的样板文件”等等。在你下结论之前，我请求你检查一下新的Redux文档和Redux Toolkit (RTK)。</p><p id="9f23" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">对我个人来说，我喜欢使用redux作为我的全局状态管理解决方案。因为以下原因:</p><ol class=""><li id="31e3" class="lw lx in kv b kw lr la ls le ly li lz lm ma lq mb mc md me bi translated">我已经明白Redux的概念了。</li><li id="094a" class="lw lx in kv b kw mf la mg le mh li mi lm mj lq mb mc md me bi translated">Redux在业界久经考验。</li><li id="9f08" class="lw lx in kv b kw mf la mg le mh li mi lm mj lq mb mc md me bi translated">它在就业市场上有很高的技能需求。</li><li id="b753" class="lw lx in kv b kw mf la mg le mh li mi lm mj lq mb mc md me bi translated">RTK解决了我们以前使用Redux时面临的所有痛点。</li></ol><p id="8829" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">作为一名react原生开发人员，我最近玩了Redux Toolkit、react原生调试器和Redux persist，以便在我的React原生应用程序中保持全局状态。这篇博文试图记录我所学到的东西。</p><h1 id="5d43" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">创建我们的注册护士应用程序</h1><p id="9109" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">我们将创建一个React本地应用程序的最小示例来演示redux集成。让我们通过运行它来创建应用程序</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="3abc" class="mt jw in mp b gy mu mv l mw mx">expo init rn-redux-boilerplate</span></pre><p id="8e0a" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">一旦完成，我们将安装redux相关的包</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="e10d" class="mt jw in mp b gy mu mv l mw mx">yarn add redux @reduxjs/toolkit react-redux redux-persist</span></pre><h1 id="4cdc" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">我们的应用程序是做什么的？</h1><p id="7010" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">出于文档目的，该应用程序非常简单，这里的想法是将redux与we react原生应用程序集成，在本文的下一部分，我们将使用一个实际的示例。现在，我们只想创建一个计数器功能，我们可以增加和减少计数。</p><h1 id="8cae" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">初始化我们的Redux</h1><p id="efec" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">现在让我们为您的演示目的创建redux功能。如果您以前使用过redux，您可能记得我们曾经创建多个文件来管理一个状态。例如，我们可能已经创建了<strong class="kv io">反还原</strong>、<strong class="kv io">反作用</strong>、<strong class="kv io">反作用类型</strong>来处理我们的计数器状态</p><p id="42a3" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">感谢redux工具包，现在一切都非常整洁干净。我们可以将所有与count相关的redux逻辑放在一个文件中，我将其命名为<strong class="kv io"> counterSlice.js. </strong>我们可以将所有内容放在一个文件中，如下所示</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="a879" class="mt jw in mp b gy mu mv l mw mx">import { createSlice } from '@reduxjs/toolkit'<br/><br/>export const counterSlice = createSlice({<br/>  name: 'counter',<br/>  initialState: {<br/>    value: 0<br/>  },<br/>  reducers: {<br/>    increment: state =&gt; {<br/>      // Redux Toolkit allows us to write "mutating" logic in reducers. It<br/>      // doesn't actually mutate the state because it uses the immer library,<br/>      // which detects changes to a "draft state" and produces a brand new<br/>      // immutable state based off those changes<br/>      state.value += 1<br/>    },<br/>    decrement: state =&gt; {<br/>      state.value -= 1<br/>    },<br/>    incrementByAmount: (state, action) =&gt; {<br/>      state.value += action.payload<br/>    }<br/>  }<br/>})<br/><br/>export const { increment, decrement, incrementByAmount } = counterSlice.actions<br/>export const selectCount = state =&gt; state.counter.value<br/><br/>export default counterSlice.reducer</span></pre><p id="39bc" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">因为这篇文章的目的不是解释redux概念，所以我将继续讨论与React native的集成部分。</p><h1 id="9c17" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">创建商店</h1><p id="b9a9" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">设置好我们的反切片后，我们现在可以创建我们的商店并链接到我们的RN应用程序。让我们在redux文件夹中创建一个名为store.js的文件，并用counterSlice中的counterReducer创建存储。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="455e" class="mt jw in mp b gy mu mv l mw mx">import { configureStore } from '@reduxjs/toolkit'<br/>import counterReducer from './counterSlice'<br/><br/>export default configureStore({<br/>  reducer: {counter : counterReducer},<br/>})</span></pre><p id="adb4" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">我们的商店现在设置好了，我们可以用这个商店包装我们的应用程序，redux中的所有状态都可以用于我们的应用程序。</p><h1 id="6cb0" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">提供商店</h1><p id="8ea2" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在我们的根组件中，我们现在需要用商店包装应用程序。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="f929" class="mt jw in mp b gy mu mv l mw mx">import store from './redux/store'<br/>import { Provider } from 'react-redux'<br/><br/>export default function App() {<br/>  return (<br/>    &lt;Provider store={store}&gt;<br/>      &lt;ReduxDemo /&gt;<br/>    &lt;/Provider&gt;<br/>    <br/>  );<br/>}</span></pre><p id="5b6a" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">太好了，这样我们的应用程序就可以连接Redux Store了。</p><h1 id="b162" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">在我们的组件中调用动作并从redux获取值。</h1><p id="2b50" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在我们的组件中，我们现在可以使用选择器获得计数器值，使用dispatch获得递增/递减值。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="ddb0" class="mt jw in mp b gy mu mv l mw mx">export default function ReduxDemo() {<br/>    const count = useSelector(selectCount) // getting the counter value<br/>    const dispatch = useDispatch(); // will use dispatch to call actions<br/>    return (<br/>        &lt;View style={styles.container}&gt;<br/>            &lt;Text&gt;Counter Value = {count}&lt;/Text&gt;<br/>            &lt;Button title="increment" onPress={() =&gt; dispatch(increment())}/&gt;<br/>            &lt;Button title="decrement" onPress={() =&gt; dispatch(decrement())}/&gt;<br/>        &lt;/View&gt;<br/>    );<br/>}</span></pre><figure class="mk ml mm mn gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi my"><img src="../Images/5ead365b3ece0dce5b4d6dcca3826ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*wjBRRfE0_XaedCldYQRDBA.gif"/></div></div></figure><h1 id="fa3b" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">Redux持续</h1><p id="2ee7" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">如果我们想保持我们的状态，这样如果用户关闭应用程序并返回，他们仍然会看到以前的值，我们可以使用redux persist。Redux persist会将状态保存在我们的本地AsyncStorage中。我们现在就开始吧。我们需要对store.js文件做一些修改。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="8cf0" class="mt jw in mp b gy mu mv l mw mx">const persistConfig = {<br/>	key: "root",<br/>	version: 1,<br/>	storage: AsyncStorage,<br/>}</span><span id="19e1" class="mt jw in mp b gy mz mv l mw mx">const rootReducer = combineReducers({<br/>	counter: counterReducer,<br/>})</span><span id="f232" class="mt jw in mp b gy mz mv l mw mx">const persistedReducer = persistReducer(persistConfig, rootReducer)</span><span id="5351" class="mt jw in mp b gy mz mv l mw mx">export default configureStore({<br/>  reducer: persistedReducer<br/>})</span></pre><p id="7ab7" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">然后，我们还需要添加我们的App.tsx文件。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="13ad" class="mt jw in mp b gy mu mv l mw mx">import { persistStore } from "redux-persist"<br/>import { PersistGate } from "redux-persist/integration/react"</span><span id="86a3" class="mt jw in mp b gy mz mv l mw mx">let persistor = persistStore(store)<br/>export default function App() {<br/>  return (<br/>    &lt;Provider store={store}&gt;<br/>      &lt;PersistGate loading={null} persistor={persistor}&gt;<br/>        &lt;ReduxDemo /&gt;<br/>      &lt;/PersistGate&gt;<br/>    &lt;/Provider&gt;<br/>    <br/>  );<br/>}</span></pre><p id="020f" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">如果我们关闭应用程序并再次回到我们的应用程序，我们将看到我们的计数器值设置为关闭应用程序之前的值。这意味着我们持续的全球状态正在起作用。</p><figure class="mk ml mm mn gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi my"><img src="../Images/9e931fd8dea50f4d5b5dfe2957380db5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BmXUy-r4N2tq8aMem5koBA.gif"/></div></div></figure><h1 id="8f52" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">反应本机调试器</h1><p id="854b" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">Redux的主要优势之一是它有一个非常强大的开发工具。您可以看到您的状态变化，实时调度操作。你可以在你的行动之间进行时间旅行，并得到你的全局状态的整体快照。在你开发的时候超级有用。对于react native，您需要从这个开源repo下载这个调试器</p><p id="1d86" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><a class="ae na" href="https://github.com/jhen0409/react-native-debugger" rel="noopener ugc nofollow" target="_blank">GitHub—jhen 0409/React-Native-debugger:基于React Native官方调试器的独立应用，包含React Inspector/Redux dev tools</a></p><p id="4712" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">一旦安装完毕，保持打开状态，从RN菜单进入调试器选项。你会看到它会自动开始显示所有的日志。确保您的Chrome浏览器调试器已关闭，并且您在正确的端口上。下面是调试器的简短预览:</p><figure class="mk ml mm mn gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/5b4a1a930daa928ea5f2a54dbaf54b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6vXWDBrpEDsk6yaOb3MIUQ.gif"/></div></div></figure><p id="0040" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">这篇文章的目的是记录Redux Toolkit、Redux persist和RN调试器的集成。所以我没有解释任何redux的概念，希望在以后的博客文章中，我会给出一个实际的例子来解释Redux。</p><p id="5b9c" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><em class="nc">更多内容尽在</em><a class="ae na" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nc">plain English . io</em></strong></a></p></div></div>    
</body>
</html>