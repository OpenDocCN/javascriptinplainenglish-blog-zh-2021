<html>
<head>
<title>How to Test a Local React NPM Package With Ease</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何轻松测试本地React NPM包</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/testing-a-local-react-npm-package-with-ease-7d0668676ddb?source=collection_archive---------4-----------------------#2021-06-14">https://javascript.plainenglish.io/testing-a-local-react-npm-package-with-ease-7d0668676ddb?source=collection_archive---------4-----------------------#2021-06-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7b79" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">关于何时需要安装本地npm软件包而不使用符号链接的教程</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/39a3c714abeb8e5421a311085cea40f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jIvJUz9yl2hze3DRaniXsw.jpeg"/></div></div></figure><p id="fdc8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae ln" href="https://medium.com/geekculture/how-to-test-a-local-react-npm-package-still-on-development-9bed7f199164" rel="noopener">在我之前的帖子</a>中，我尽力解释了一个关于开发本地npm包的有趣细节。</p><p id="5911" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可能知道，我目前正在开发<code class="fe lo lp lq lr b"><a class="ae ln" href="https://github.com/chesslablab/redux-chess" rel="noopener ugc nofollow" target="_blank">redux-chess</a></code>，这是一个基于Redux的棋盘，主要用于连接WebSocket服务器进行棋步验证、位置评估和许多更酷的功能。</p><p id="5aa2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从包本身之外的宿主应用程序中测试包是一个好主意。然而，事实证明<code class="fe lo lp lq lr b">npm install</code>在安装本地包时会创建一个符号链接，这可能会导致不友好的测试体验。</p><p id="0703" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有关这个不太明显的主题的更多信息，请访问:</p><ul class=""><li id="8be2" class="ls lt iq kt b ku kv kx ky la lu le lv li lw lm lx ly lz ma bi translated"><a class="ae ln" href="https://github.com/npm/npm/issues/18503" rel="noopener ugc nofollow" target="_blank"> npm安装不应创建符号链接#18503 </a></li><li id="ae18" class="ls lt iq kt b ku mb kx mc la md le me li mf lm lx ly lz ma bi translated"><a class="ae ln" href="https://github.com/nicojs/node-install-local" rel="noopener ugc nofollow" target="_blank">Nico js/node-install-local</a></li></ul><p id="8a08" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">顺便说一下，我用来测试<code class="fe lo lp lq lr b">redux-chess</code>的主机应用程序叫做<code class="fe lo lp lq lr b">testing-redux-chess</code>，可以在<a class="ae ln" href="https://github.com/chesslablab/testing-redux-chess" rel="noopener ugc nofollow" target="_blank">的GitHub repo </a>上下载。</p><p id="dcb7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">今天，让我详细说明如何在测试应用程序中测试一个有前途的、令人惊奇的本地npm包。</p><p id="6789" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这种情况下，我们依靠<code class="fe lo lp lq lr b">nicojs/node-install-local</code>来帮助我们摆脱<code class="fe lo lp lq lr b">npm install</code>将在<code class="fe lo lp lq lr b">./node_modules/redux-chess/node_modules</code>中自动创建的令人不安的符号链接。</p><p id="1a08" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">于是，我全球安装了<code class="fe lo lp lq lr b">install-local</code>。</p><pre class="kg kh ki kj gt mg lr mh mi aw mj bi"><span id="6345" class="mk ml iq lr b gy mm mn l mo mp">$ npm install -g install-local</span></pre><p id="d090" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后是<code class="fe lo lp lq lr b">redux-chess</code>——我的npm包，记住，它仍在开发中——在我的测试应用程序的主文件夹中:<code class="fe lo lp lq lr b">~/projects/testing-redux-chess</code>。</p><pre class="kg kh ki kj gt mg lr mh mi aw mj bi"><span id="6f8d" class="mk ml iq lr b gy mm mn l mo mp">$ cd ~/projects/testing-redux-chess/<br/>$ install-local --save ../redux-chess</span></pre><p id="b309" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe lo lp lq lr b">install-local</code>在<code class="fe lo lp lq lr b">testing-redux-chess/package.json</code>文件中创建了<code class="fe lo lp lq lr b">localDependencies</code>键，如下所述。</p><pre class="kg kh ki kj gt mg lr mh mi aw mj bi"><span id="16c5" class="mk ml iq lr b gy mm mn l mo mp">...<br/>"localDependencies": {<br/>    "redux-chess": "../redux-chess"<br/>}<br/>...</span></pre><p id="9683" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">那时，我在<code class="fe lo lp lq lr b">package.json</code>文件中写了一些方便的脚本，目的是让我的开发体验更加愉快。</p><pre class="kg kh ki kj gt mg lr mh mi aw mj bi"><span id="6e7a" class="mk ml iq lr b gy mm mn l mo mp">...<br/>"scripts": {<br/>    "start": "react-scripts start",<br/>    "build": "react-scripts build",<br/>    "test": "react-scripts test",<br/>    "eject": "react-scripts eject",<br/>    "stop": "kill -9 $(lsof -t -i:$npm_config_port)",<br/>    "restart": "kill -9 $(lsof -t -i:$npm_config_port) &amp;&amp; react-scripts start",<br/>    "update:local:redux-chess": "rm -rf ./node_modules/redux-chess/dist &amp;&amp; cp -r ../redux-chess/dist ./node_modules/redux-chess/dist"<br/>  },<br/>...</span></pre><p id="c871" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以下是有助于自动化测试过程的<code class="fe lo lp lq lr b">scripts</code>:</p><ul class=""><li id="ef7f" class="ls lt iq kt b ku kv kx ky la lu le lv li lw lm lx ly lz ma bi translated"><code class="fe lo lp lq lr b">npm run stop --port=3000</code></li><li id="2f1f" class="ls lt iq kt b ku mb kx mc la md le me li mf lm lx ly lz ma bi translated"><code class="fe lo lp lq lr b">npm run restart --port=3000</code></li><li id="a8e4" class="ls lt iq kt b ku mb kx mc la md le me li mf lm lx ly lz ma bi translated"><code class="fe lo lp lq lr b">npm run update:local:redux-chess</code></li></ul><p id="d39a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">轻松测试<code class="fe lo lp lq lr b">redux-chess</code>的命令序列最终看起来是这样的。</p><p id="a41c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将代码传输到包的文件夹中。</p><pre class="kg kh ki kj gt mg lr mh mi aw mj bi"><span id="f5f6" class="mk ml iq lr b gy mm mn l mo mp">$ npm run publish:npm</span></pre><p id="d5eb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在测试应用程序中更新包。</p><pre class="kg kh ki kj gt mg lr mh mi aw mj bi"><span id="b97e" class="mk ml iq lr b gy mm mn l mo mp">$ npm run update:local:redux-chess</span></pre><p id="f334" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">重启测试应用。</p><pre class="kg kh ki kj gt mg lr mh mi aw mj bi"><span id="dcc4" class="mk ml iq lr b gy mm mn l mo mp">$ npm run restart --port=3000</span></pre><p id="cb6d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这些命令可以链接在一起，构建一个运行在<code class="fe lo lp lq lr b">~/projects/testing-redux-chess</code>文件夹中的命令。</p><pre class="kg kh ki kj gt mg lr mh mi aw mj bi"><span id="315c" class="mk ml iq lr b gy mm mn l mo mp">$ npm run publish:npm --prefix /home/standard/projects/redux-chess &amp;&amp; npm run update:local:redux-chess &amp;&amp; npm run restart --port=3000</span></pre><p id="05f5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有了这个方案，我能够在浏览器上动态显示我的本地包中的更改，这有助于在进行测试时节省时间和精力。</p><p id="ddbf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我猜想在一个完美的世界里，你会希望在不重启React应用程序的情况下立即传输包的代码并观察变化，但似乎我们离它只有一步之遥。</p><p id="9955" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是目前所有的，非常感谢您的阅读。</p><div class="mq mr gp gr ms mt"><a href="https://medium.com/geekculture/how-to-test-a-local-react-npm-package-still-on-development-9bed7f199164" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd ir gy z fp my fr fs mz fu fw ip bi translated">如何测试仍在开发中的本地React Npm包</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">所需的设置并不太复杂，但足够有趣的是，如果没有测试计划，你可能会浪费大量的时间…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">medium.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh kp mt"/></div></div></a></div><h2 id="b98f" class="mk ml iq bd ni nj nk dn nl nm nn dp no la np nq nr le ns nt nu li nv nw nx ny bi translated">您可能还对以下内容感兴趣:</h2><ul class=""><li id="509b" class="ls lt iq kt b ku nz kx oa la ob le oc li od lm lx ly lz ma bi translated"><a class="ae ln" href="https://medium.com/geekculture/a-react-chessboard-with-redux-and-hooks-in-few-lines-6009cb724bb" rel="noopener">一个反作用棋盘，棋盘上有几行圈圈和钩子</a></li><li id="f1dc" class="ls lt iq kt b ku mb kx mc la md le me li mf lm lx ly lz ma bi translated"><a class="ae ln" href="https://programarivm.medium.com/tdding-a-react-app-with-jest-the-easy-way-8ddb64aeaba6" rel="noopener">用Jest最简单的方法开发React应用</a></li><li id="d01d" class="ls lt iq kt b ku mb kx mc la md le me li mf lm lx ly lz ma bi translated"><a class="ae ln" href="https://programarivm.medium.com/looking-forward-to-testing-react-components-with-joy-5bb3f86c21d7" rel="noopener">满心期待测试React组件</a></li><li id="7158" class="ls lt iq kt b ku mb kx mc la md le me li mf lm lx ly lz ma bi translated"><a class="ae ln" href="https://programarivm.medium.com/my-first-integration-test-in-a-redux-hooked-app-3b189addd46e" rel="noopener">我在Redux Hooked应用中的第一次集成测试</a></li></ul><p id="565c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="oe">更多内容请看</em><a class="ae ln" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="oe">plain English . io</em></a></p></div></div>    
</body>
</html>