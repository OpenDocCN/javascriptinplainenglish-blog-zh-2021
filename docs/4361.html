<html>
<head>
<title>You Might Not Need Redux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你可能不需要Redux</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/you-might-not-need-redux-a9b6be495949?source=collection_archive---------16-----------------------#2021-08-30">https://javascript.plainenglish.io/you-might-not-need-redux-a9b6be495949?source=collection_archive---------16-----------------------#2021-08-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/5fa059515cffb7d86727699ec4176770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VPedi4bwMzYDWNPT"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@beatriz_perez?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Beatriz Pérez Moya</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b48a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我不认为找到一个<strong class="kc io">不</strong>使用专用状态管理库的现代web应用程序会特别困难——公平地说，它很可能会是Redux。</p><p id="8fdd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">状态是web开发世界中很难弄清楚的事情之一。有很多选择，包括React在内的大多数前端库也提供开箱即用的状态管理。但是，如果设计和实施不正确，糟糕的状态会很快导致延迟、头痛和技术债务。这通常意味着一个项目将有许多样板代码、reducers、actions、providers，甚至更多——占用一堆单独的文件和太多的函数，所有这些函数都相互通信，以便在状态树的某个黑暗角落将布尔值从<code class="fe ky kz la lb b">true</code>更改为<code class="fe ky kz la lb b">false</code>。</p><p id="fd17" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">公平地说，Redux提供了真正优秀的Redux Tookit，它在减少大量代码方面做得非常好，让开发人员工作起来更加愉快。还有值得注意的<em class="lc"> thinner </em>状态管理库比如<a class="ae jz" href="https://github.com/pmndrs/zustand" rel="noopener ugc nofollow" target="_blank"> Zustand </a>值得一探究竟！</p><p id="37a4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这篇文章中，我将演示一种与API交互的方法，并跟踪一些事情，例如我们是否在等待响应，我们有什么数据，以及是否有任何错误。</p></div><div class="ab cl ld le hr lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ig ih ii ij ik"><h1 id="c113" class="lk ll in bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">Redux方式</strong></h1><p id="8755" class="pw-post-body-paragraph ka kb in kc b kd mi kf kg kh mj kj kk kl mk kn ko kp ml kr ks kt mm kv kw kx ig bi translated">传统上，我会用状态管理库来跟踪这些东西；尤其是如果在我们的组件层次结构中，需要跨越多个组件的信息，而这些组件又相隔几层。</p><p id="b285" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，让我们构建一个与API交互的简单应用程序，并使用Redux和Redux Toolkit来管理其状态。</p><p id="5667" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我将使用<code class="fe ky kz la lb b">create-react-app</code>和<code class="fe ky kz la lb b">redux</code>模板快速启动一个React + Redux应用程序:</p><pre class="mn mo mp mq gt mr lb ms mt aw mu bi"><span id="e022" class="mv ll in lb b gy mw mx l my mz">$ npx create-react-app my-app —-template redux</span></pre><p id="82ec" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这个创建的应用程序可以在<a class="ae jz" href="https://github.com/phobos101/blog/tree/2a5c3932d61717bfb5e68a3b83edb97af14ac277/you-might-not-need-redux" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="eb97" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们有一个所有Redux位都将使用的主存储，计数器组件本身，计数器的API，最后是计数器片。如果你不熟悉这个术语，切片处理所有以前用动作、缩减器和选择器处理的东西。你可以在<a class="ae jz" href="https://redux-toolkit.js.org/api/createSlice" rel="noopener ugc nofollow" target="_blank"> RTK文档</a>网站上了解更多。尽管切片很神奇，但它仍然有大量的代码，需要大量的抽象，这使得它不是最直观的构造。</p><p id="9fe6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我将修改代码，这样主页将通过Redux获取并显示用户:</p><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi na"><img src="../Images/cc41b05f8a3c3e2b0b7266189a5f51f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jU8azfSMjUPREcd8fFWPkg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">src/redux/profileSlice.js</figcaption></figure></div><div class="ab cl ld le hr lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ig ih ii ij ik"><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/52492979c6abb26900cb11219d999e20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lDVErpOWgMhyFriX3e4L1w.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">src/pages/Homepage.js</figcaption></figure><p id="fe1b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">完整的代码示例可以在<a class="ae jz" href="https://github.com/robwilson1/blog-examples/tree/276ecc8662075da9869f34179445466c53baa7e2/you-might-not-need-redux/src" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div><div class="ab cl ld le hr lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ig ih ii ij ik"><h1 id="3985" class="lk ll in bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">介绍SWR</h1><p id="8ddf" class="pw-post-body-paragraph ka kb in kc b kd mi kf kg kh mj kj kk kl mk kn ko kp ml kr ks kt mm kv kw kx ig bi translated">SWR包是一个强大的数据读取库，它被用作一个React钩子。多个组件可以调用钩子，传入一个标识符来订阅特定的HTTP响应。幕后有这么多聪明的东西，它真的带走了很多样板代码，同时给了我们很多开箱即用的选项。</p><p id="46fc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这个例子中，我们将从Redux例子中保留的唯一东西是获取模拟用户的API调用。我们将对其稍加修改，使其成为SWR fetcher，如下所示:</p><pre class="mn mo mp mq gt mr lb ms mt aw mu bi"><span id="49f0" class="mv ll in lb b gy mw mx l my mz"><strong class="lb io">const</strong> fetcher = (...args) =&gt; fetch(...args).then(res =&gt; res.json())</span></pre><p id="3b6e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果我们愿意，我们可以简单地将所有的逻辑保存在“主页”组件中，不再进一步抽象，或者，我们可以将这个逻辑抽象到一个定制的钩子中，并将其命名为<code class="fe ky kz la lb b">useProfile</code>。</p><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nc"><img src="../Images/5ff222d713746ae7217ea23d67faf9fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NtgePOMUxOPy1o888sQbrg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">src/hooks/useProfile.js</figcaption></figure></div><div class="ab cl ld le hr lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ig ih ii ij ik"><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nd"><img src="../Images/795c36b0305f5a72abac8e846ef2ce6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VN9Ym0fzYBegWT52EEvUrA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">src/pages/Homepage.js</figcaption></figure><p id="efb3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">SWR钩子的导入、取出和消耗总共是3行。这个HTTP调用的惟一标识符是URL字符串，它作为钩子的第一个参数提供。如果另一个组件要调用<code class="fe ky kz la lb b">useProfile</code>，SWR不会复制HTTP调用。还有大量的配置选项和对更高级用例的支持。</p><p id="5f1c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">完整的代码示例可以在<a class="ae jz" href="https://github.com/robwilson1/blog-examples/tree/da886c8473895bd7d8158636b72b7a9edc6e3c30/you-might-not-need-redux/src" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="1df9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在实际项目中，我已经删除了数百行Redux和React上下文代码，以支持这种最小的内存占用和强大的替代方案，从而使代码更容易阅读和维护。你可以在SWR官方文档页面<a class="ae jz" href="https://swr.vercel.app/docs/getting-started" rel="noopener ugc nofollow" target="_blank">找到更多信息。</a></p><p id="268d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">编码快乐！</p><p id="fefa" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="lc">更多内容请看</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="lc">plain English . io</em></strong></a></p></div></div>    
</body>
</html>