<html>
<head>
<title>The Beginner’s Guide to ‘Lazy Loading’ Images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">“惰性加载”图像的初学者指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-beginners-guide-to-lazy-loading-images-7b49ceb9af8c?source=collection_archive---------10-----------------------#2021-11-16">https://javascript.plainenglish.io/the-beginners-guide-to-lazy-loading-images-7b49ceb9af8c?source=collection_archive---------10-----------------------#2021-11-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="a3e2" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">图片占了你网页的很大一部分！优化它们！</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/81cf0fd491cbecf21eb85d9ca2ba0d92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CbrAF6WdJoajL2EZ"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by<a class="ae ks" href="https://www.instagram.com/laviperchik/" rel="noopener ugc nofollow" target="_blank"> Lavi Perchik</a></figcaption></figure><p id="f116" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">网站越来越多地在网页中使用更多的图片，这确实会降低网站的初始加载时间。正如分析专家尼尔·帕特尔(Neil Patel)在他的文章<a class="ae ks" href="https://neilpatel.com/blog/optimize-images-web-design/" rel="noopener ugc nofollow" target="_blank">中提到的，如何处理重图像的网站设计</a>，你应该关心网站的速度，因为它会影响网站的谷歌排名和观众保留率——以及其他原因。如果你的网站加载时间太长，浏览者更有可能点击离开你的网页。</p><p id="96ae" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">到目前为止，我们已经讨论了实现<a class="ae ks" href="https://medium.com/@kyledeguzmanx/how-css-sprites-can-improve-performance-212d01ee6605" rel="noopener"> CSS精灵</a>来优化我们的网页。该方法实质上是将多个图像组合成一个图像文件。这减少了浏览器获取所有图像的请求数量。</p><p id="1055" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在本文中，我们将探索延迟加载。</p><h1 id="7d41" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">什么是懒装？</h1><p id="e2ef" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">延迟加载适用于图像和iframes。它本质上是告诉网络浏览器，“嘿，浏览器！在此图像或iframe在视口中可见之前，不要加载它。</p><p id="9b89" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">换句话说，如果您必须向下滚动来查看这些图像或iframe，那么在查看者向下滚动并实际遇到这些图像和iframe之前，不要获取和加载它们。</p><h1 id="869a" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">为什么应该使用延迟加载？</h1><p id="a9fa" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">当您告诉浏览器只在用户向下滚动并遇到图像/iframe时获取和加载它们时，它会减少浏览器最初必须加载的内容量。例如，如果您有20个图像，其中18个在初始视口中不可见(在加载您的站点时)，那么您的浏览器只需要在初始加载过程中加载其中2个。这样可以节省很多时间，对于使用大量图片的大型网页来说更是如此。</p><p id="c23e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">想象一下:加载20张图片中的2张和加载20张图片之间的差别。</p><p id="f6f5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">除此之外，我们还要考虑用户体验。随着加载速度的加快，用户已经可以开始与你的网页进行交互了，尽管事实上并不是所有的内容都被加载了。但从他们的角度来看，他们甚至不会意识到并非所有的内容都已加载。他们不会意识到图像是在滚动时被获取和加载的。</p><p id="f738" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因为用户可以快速地与网站互动，所以你提供了更好的用户体验。相比之下，如果没有延迟加载，网站将不得不加载整个文档中的所有20张图片。如果用户不得不等待很长一段时间，最后甚至不能滚动整个页面，这将是一个遗憾。</p><p id="10f3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">此外，作为互联网探索者，有多少次网站加载时间太长，我们点击关闭以找到一个新的网站？实现延迟加载是为了防止你的用户有类似的经历。</p><h1 id="35a3" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">实施#1</h1><p id="7a68" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">幸运的是，HTML为图像和iframes提供了一个名为“<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Web/Performance/Lazy_loading" rel="noopener ugc nofollow" target="_blank"> loading </a>的属性。将该值设置为“懒惰”。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mm"><img src="../Images/8827eedaa1b2ee60f0ace2799bedf6e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1rZRqahf7phBWQgJ2_jcVg.png"/></div></div></figure><p id="8fba" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">只需将属性附加到非关键映像和iframes即可开始。</p><p id="3982" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">有些人可能会遇到这方面的问题。如果您想测试您的延迟加载实现是否工作正常，请继续阅读。</p><p id="2db4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">此实施的快速求解:</p><ul class=""><li id="6f6f" class="mn mo in kv b kw kx kz la lc mp lg mq lk mr lo ms mt mu mv bi translated">设置图像的宽度和高度</li><li id="2451" class="mn mo in kv b kw mw kz mx lc my lg mz lk na lo ms mt mu mv bi translated"><a class="ae ks" href="https://caniuse.com/loading-lazy-attr" rel="noopener ugc nofollow" target="_blank">检查</a>是否支持浏览器。您的浏览器可能不支持loading属性。</li></ul><h1 id="011a" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">实施#2</h1><p id="46f3" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">这个实现需要更多的努力，但是非常容易。因此，有许多库和脚本提供了实现延迟加载的另一种方法。他们都做同样的事情。</p><p id="3d8c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我非常喜欢这个实现。这是非常简单和初学者友好的。它是由GitHub上一个名为<a class="ae ks" href="https://github.com/verlok/vanilla-lazyload" rel="noopener ugc nofollow" target="_blank"> Vanilla LazyLoad </a>的库提供的。说明在自述文件或Andrea的个人网站上。</p><p id="cc71" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这个视频令人惊讶地一步一步解释了必须做的事情。它只是简单地重复了GitHub自述文件中的内容。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="b6d4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">该过程从导入脚本开始。将它放在正文结束标记之前的最后一行代码中。</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="79b4" class="ni lq in ne b gy nj nk l nl nm">&lt;script src="<a class="ae ks" href="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.5.0/dist/lazyload.min.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.5.0/dist/lazyload.min.js</a>"&gt;&lt;/script&gt;</span></pre><p id="77fb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在script元素下面，我们将编写视频中提供的以下脚本。</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="2084" class="ni lq in ne b gy nj nk l nl nm">&lt;script&gt;        <br/>const myLazyLoad = new LazyLoad({            <br/>elements_selector: "<strong class="ne io">.img-container</strong>"        <br/>});     <br/>&lt;/script&gt;</span></pre><p id="8371" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">请注意粗体文本。这实质上是一个类选择器。如果你从来没有使用过CSS，基本上，只需在类名后面加上一个句号。</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="9d81" class="ni lq in ne b gy nj nk l nl nm">.className</span></pre><p id="0a32" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您可以选择自己的类名。您更改了类选择器。做你需要做的。</p><p id="9494" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">加载脚本后，我们将查看图像。</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="364e" class="ni lq in ne b gy nj nk l nl nm">&lt;img class = "img-container" data-src="https://images.wsj.net/im-407095?width=1280&amp;size=1" alt=""&gt;</span></pre><p id="a9cb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是一个将被延迟加载的图像的例子。</p><p id="035a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">首先，你会注意到这个类。如前所述，这个类名可以是您想要的任何名称。只要确保它与脚本中的类选择器匹配即可。这就是脚本如何理解您想要延迟加载哪些图像。</p><p id="f6e7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">接下来，我们有数据-src。这将替换图像的src属性。它具有与src相同的功能目的；但是，您不能使用src。</p><p id="4850" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后，你有你的标准替代文本。</p><p id="5e3d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">对于iframes来说，这是相同的一般概念。确保您有适当的类和数据-src。有关更多信息，请查阅文档。</p><h1 id="0a56" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">测试</h1><p id="e693" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">最后，必须进行测试。您必须看到您的延迟加载过程实际上减少了处理时间。</p><p id="bfce" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">首先，在实现延迟加载之前，收集关于您的网站的数据。然后实现懒加载，收集数据。最后，对比一下。</p><p id="8c40" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是你如何做的。</p><ol class=""><li id="59f5" class="mn mo in kv b kw kx kz la lc mp lg mq lk mr lo nn mt mu mv bi translated">在浏览器上查看您的网页。</li><li id="b705" class="mn mo in kv b kw mw kz mx lc my lg mz lk na lo nn mt mu mv bi translated">右键单击。单击检查</li></ol><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi no"><img src="../Images/ad27efc3b97ec6a54b8a757e6bd8bc3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*BclWtCMFul75v9aO7tq-EA.png"/></div></figure><p id="c80b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">3.在最顶端，单击网络</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/3a29cfdd9df7cc097cacb980427951fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3KxqTN7rZarq92_iXGFtZg.png"/></div></div></figure><p id="0aa3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">4.标记“禁用缓存”</p><p id="87bd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">基本上，当您访问网站时，您的浏览器可能会暂时保存资源。这样，如果您再次访问该网站，它将已经加载了资源。它将不必与服务器通信来检索它们。我们想禁用它。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/748c8e5b64ed8360e4736e481c0368f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ywOGeqYl6tCfvKnGn8a5SQ.png"/></div></div></figure><p id="4c16" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">5.选择图像</p><p id="dd48" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们只想看看图像是如何加载的(最初和滚动时)。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/517262504f734690dcda0beb678708d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*083QA1MAfpGghzg5ivXyRQ.png"/></div></div></figure><p id="0f8c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，我们准备好出发了。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nq"><img src="../Images/c7321e04b4ad5de7ba0dc2f7c6998846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sQ-qluPDD1p1NjANlR9DWQ.png"/></div></div></figure><p id="b963" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是你的检查器标签应该看起来的样子。黄色显示为您的网页加载的图像列表。</p><p id="e678" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在实现延迟加载之前，您应该看到网页上所有图像的列表。在延迟加载之后，您应该看不到列表中的所有图像。当你滚动时，新的图像应该出现在列表中。</p><p id="076e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">另外，用绿色突出显示的是发出的请求数、传输的数据和使用的资源数。</p><p id="b675" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在实现了延迟加载之后，请求的数量应该会减少。不应该是零，但绝对应该更低。此外，传输的数据量也应该更低。</p><p id="e0c0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">通常，在以绿色突出显示的文本所在的同一行中，可能还有以毫秒或秒为单位的总加载时间。如果您能看到，则该数字也应该减少。</p><p id="e2e1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">希望整个过程是成功的。现在，您可以在您的站点中实现延迟加载，并改善您的用户体验！</p><p id="6765" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="nr">更多内容看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nr">plain English . io</em></strong></a></p></div></div>    
</body>
</html>