<html>
<head>
<title>How You Can Serve React Build Folder From an Express Endpoint</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从Express端点提供React构建文件夹</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-you-can-serve-react-js-build-folder-from-an-express-end-point-127e236e4d67?source=collection_archive---------2-----------------------#2021-12-27">https://javascript.plainenglish.io/how-you-can-serve-react-js-build-folder-from-an-express-end-point-127e236e4d67?source=collection_archive---------2-----------------------#2021-12-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="649e" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">关于如何从Express端点提供React构建文件夹的指南。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/e8586da1c3bd04c16a2e9dccaeb3a069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u7A0F0uSK_7dXz-cBbw7Wg.jpeg"/></div></div></figure><p id="acd3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在本文中，我们将创建一个简单的React应用程序，运行npm，运行build，并从Express提供build文件夹。</p><p id="9b5d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">第一件事是创建一个新文件夹并将cd放入该文件夹，然后运行通常的<code class="fe lk ll lm ln b">npx create-react-app frontend</code>。这是创建一个反应应用程序，并命名为文件夹前端。将光盘放入<em class="lo">前端</em>文件夹，然后<em class="lo">运行</em> <code class="fe lk ll lm ln b">npm build</code> <em class="lo">。</em>一旦命令执行完毕，你将得到一个构建文件夹。这是我们快递服务的文件夹。</p><p id="5199" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Cd放回根文件夹。这是我们初始化Express应用程序的地方。运行<code class="fe lk ll lm ln b">npm init -y</code>，和<code class="fe lk ll lm ln b">npm i express</code> <em class="lo">。</em>这将在根文件夹中安装express。安装完成后，创建一个名为index.js的文件。在这个文件夹中需要path模块(Node.js提供给我们的一个模块)。现在像往常一样设置一个Express服务器。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lp"><img src="../Images/c30c0ae8180e9a22d9f4e7b593c4470a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4PkJkJBDSgxC1vqhdlJLRQ.png"/></div></div></figure><p id="09de" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这就是你的文件夹结构和应用程序应该的样子。</p><p id="176d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">下一步是让由<em class="lo"> npm运行构建</em>创建的构建文件夹成为静态的。为此，您需要调用<em class="lo"> express.static() </em>并将路径(绝对路径)传递给express.static()。而express.static()要在app.use()中调用，作为中间件。现在的问题变成了我们如何获得构建文件夹的绝对路径。最简单的方法是利用我们之前引入的path模块。</p><p id="7f93" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果您使用console.log(__dirname)，您将获得根目录的绝对路径，但是我们需要将前端文件夹中的构建文件夹设为静态。这就是路径模块的用武之地。path.join为我们轻松构建路径。我们将path.join()称为path.join(__dirname，' frontend '，' build ')。这将返回构建文件夹的绝对路径。所以在最后，我们应该有；</p><pre class="kd ke kf kg gt lq ln lr ls aw lt bi"><span id="afb1" class="lu lv in ln b gy lw lx l ly lz">app.use(express.static(path.join(__dirname, ‘frontend’, ‘build’)))</span></pre><p id="9bd3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">你可以继续使用<code class="fe lk ll lm ln b">console.log(path.join(__dirname, ‘frontend’, ‘build’))</code>来让path.join()做得更清楚。</p><p id="8f83" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在我们在Express中创建了一条路线。路由应该是app.get(*，callback)。这里的通配符(*)表示一旦您向任何路由发送get请求，就会触发该路由。</p><p id="a18d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">通常情况下，由于express的工作方式(寻找与您发送请求的URL匹配的第一个路由)，这个(*)路由通常被放置在所有其他路由之后，这给了您定义其他路由(如/api/)的机会，以便您不会总是在发送任何get请求时让react应用程序提供服务。因为实际上，除了为React应用程序提供服务之外，您还希望将其他get请求发送到Express API。</p><p id="3146" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在到回调，我们将传递给app.get(*，callback)。在回调中，我们希望发送构建文件夹中的HTML文件。Lucky for us express提供了一种从响应对象发送HTML文件的方法(第二个参数传递给回调)。所以我们只调用res.sendFile()。现在，我们必须再次提供该HTML文件的绝对路径。就像我们在调用path.join之前所做的一样，只是多了一个参数' index.html '。path.join(__dirname，' frontend '，' build '，' index.html ')。最后我们有:</p><pre class="kd ke kf kg gt lq ln lr ls aw lt bi"><span id="5b03" class="lu lv in ln b gy lw lx l ly lz">res.sendFile(path.join(__dirname, ‘frontend’, ‘build’, ‘index.html’))</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ma"><img src="../Images/278e14edbf023e6118fe97ddd8347c17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e_hhwHMGbQIYSr9fKuyqFg.png"/></div></div></figure><p id="2530" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这是你最后应该有的。</p><p id="6c96" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">注意:我创建了一个app.get('/api ')来展示您也可以向其他路由发送其他get请求，只要服务于React应用程序的路由不在这些路由之前。</p><p id="135e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我还制作了一个视频来解释同样的事情，在视频中，我还展示了如何在Heroku(PAAS)上部署这个应用程序。视频如下:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="eb92" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="lo">更多内容请看</em><a class="ae md" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="lo">plain English . io</em></strong></a><em class="lo">。报名参加我们的</em> <a class="ae md" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="lo">免费周报</em> </strong> </a> <em class="lo">。关注我们关于</em><a class="ae md" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="lo">Twitter</em></strong></a><em class="lo">和</em><a class="ae md" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="lo">LinkedIn</em></strong></a><em class="lo">。加入我们的</em> <a class="ae md" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="lo">社区不和谐</em> </strong> </a> <em class="lo">。</em></p></div></div>    
</body>
</html>