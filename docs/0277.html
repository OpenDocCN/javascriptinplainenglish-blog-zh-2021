<html>
<head>
<title>How to handle forgotten passwords with Angular and Firebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Angular和Firebase处理忘记密码</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/angular-node-and-postgresql-forgot-password-a1a104c3795a?source=collection_archive---------4-----------------------#2021-01-16">https://javascript.plainenglish.io/angular-node-and-postgresql-forgot-password-a1a104c3795a?source=collection_archive---------4-----------------------#2021-01-16</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><figure class="iq ir gq gs is it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj ip"><img src="../Images/090e49961c5a44f3bfdafccaff555f94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bkcct8znfTCu5jrtiIXEOA.png"/></div></div></figure><div class=""/><div class=""><h2 id="626f" class="pw-subtitle-paragraph jz jb jc bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">Angular、Node和PostgreSQL:忘记密码</h2></div><h1 id="dcd5" class="kr ks jc bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">先决条件</h1><p id="1ddf" class="pw-post-body-paragraph lj lk jc ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me ik bi translated">您应该能够遵循这个故事，并利用Firebase建立自己的忘记密码工作流。然而，如果你好奇的话，这是以下先前故事的延续:</p><div class="iq ir gq gs is mf"><a href="https://medium.com/swlh/angular-node-and-postgresql-4a07d597be07" rel="noopener follow" target="_blank"><div class="mg ab fp"><div class="mh ab mi cl cj mj"><h2 class="bd jd gz z fq mk fs ft ml fv fx jb bi translated">角度、节点和PostgreSQL</h2><div class="mm l"><h3 class="bd b gz z fq mk fs ft ml fv fx dk translated">AngularJS到Angular和更多…我的个人旅程❤️☕️</h3></div><div class="mn l"><p class="bd b dl z fq mk fs ft ml fv fx dk translated">medium.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt iy mf"/></div></div></a></div><div class="iq ir gq gs is mf"><a href="https://medium.com/swlh/angular-node-and-postgresql-registration-61abd1751bb4" rel="noopener follow" target="_blank"><div class="mg ab fp"><div class="mh ab mi cl cj mj"><h2 class="bd jd gz z fq mk fs ft ml fv fx jb bi translated">角度、节点和PostgreSQL:注册</h2><div class="mm l"><h3 class="bd b gz z fq mk fs ft ml fv fx dk translated">AngularJS到Angular和更多…我的个人旅程❤️☕️</h3></div><div class="mn l"><p class="bd b dl z fq mk fs ft ml fv fx dk translated">medium.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt iy mf"/></div></div></a></div><p id="4d89" class="pw-post-body-paragraph lj lk jc ll b lm mu kd lo lp mv kg lr ls mw lu lv lw mx ly lz ma my mc md me ik bi translated">今天的故事将展示我们如何使用AngularFireAuth创建一个密码恢复工作流程。</p><h1 id="94f3" class="kr ks jc bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">页面/表单设计</h1><p id="67e0" class="pw-post-body-paragraph lj lk jc ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me ik bi translated">我们将要设计的网页就像登录和注册。所以我们可以重用我们已经设置好的CSS🎉！我们唯一要做的改变是在我们的能力范围内。我们将有共享相同的<code class="fe mz na nb nc b">font-weight</code>和<code class="fe mz na nb nc b">color</code>的导航链接。将CSS行<code class="fe mz na nb nc b">.form-section .register .link</code>修改为<code class="fe mz na nb nc b">.form-section .link</code>。</p><h1 id="b692" class="kr ks jc bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">忘记密码服务方法</h1><p id="016d" class="pw-post-body-paragraph lj lk jc ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me ik bi translated">在<code class="fe mz na nb nc b">authentication.service.ts</code>中，我们想要创建三个新方法来处理忘记密码的工作流。这些方法中的每一个都将使用<em class="nd"> AngularFireAuth </em>来完成工作。我们的第一种方法将处理向用户发送密码重置电子邮件:</p><pre class="ne nf ng nh gu ni nc nj nk aw nl bi"><span id="a830" class="nm ks jc nc b gz nn no l np nq">async resetPassword(email: string): Promise&lt;void&gt; {<br/>   await this.afAuth.auth.sendPasswordResetEmail(email).then(() =&gt; {<br/>      this.router.navigate(['auth/reset-confirm']);<br/>   }).catch((error) =&gt; {<br/>      this.notifier.showError(error.message);<br/>   });<br/>}</span></pre><p id="e3d6" class="pw-post-body-paragraph lj lk jc ll b lm mu kd lo lp mv kg lr ls mw lu lv lw mx ly lz ma my mc md me ik bi translated">一旦用户收到电子邮件，他们将点击提供的链接，这将引导他们到我们的自定义重置密码页面。在URL中，将传递一个查询参数<code class="fe mz na nb nc b">code</code>,我们需要验证它是否仍然有效:</p><pre class="ne nf ng nh gu ni nc nj nk aw nl bi"><span id="b6f6" class="nm ks jc nc b gz nn no l np nq">async verifyPasswordResetCode(<br/>    code: string<br/>): Promise&lt;any&gt; {<br/>    return await this.afAuth.auth<br/>      .verifyPasswordResetCode(code)<br/>      .then((email) =&gt; {<br/>          return email;<br/>      }).catch((error) =&gt; {<br/>          console.log(error.message);<br/>      });<br/>}</span></pre><p id="7d9c" class="pw-post-body-paragraph lj lk jc ll b lm mu kd lo lp mv kg lr ls mw lu lv lw mx ly lz ma my mc md me ik bi translated">一旦代码通过验证，用户就可以用新的密码重置他们的密码。我们向该方法传递<code class="fe mz na nb nc b">code</code>和<code class="fe mz na nb nc b">newPassword</code>，该方法将返回它是成功了<code class="fe mz na nb nc b">true</code>还是遇到了错误<code class="fe mz na nb nc b">false</code>:</p><pre class="ne nf ng nh gu ni nc nj nk aw nl bi"><span id="519d" class="nm ks jc nc b gz nn no l np nq">async confirmPasswordReset(<br/>    code: string, <br/>    newPassword: string<br/>): Promise&lt;boolean&gt; {<br/>    return await this.afAuth.auth<br/>      .confirmPasswordReset(code, newPassword).then(() =&gt; {<br/>          return true;<br/>      }).catch((error) =&gt; {<br/>          this.notifier.showError(error.message);<br/>          return false;<br/>      });<br/>}</span></pre><h1 id="aac8" class="kr ks jc bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">Firebase —密码重置模板</h1><p id="dd2c" class="pw-post-body-paragraph lj lk jc ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me ik bi translated">我在Firebase设置中做了一个小小的调整，将动作URL值改为指向我们的自定义路径http://localhost:4200/<em class="nd">auth/reset-password。</em>我还修改了href链接中的文字说:重置密码。见下图。</p><figure class="ne nf ng nh gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj nr"><img src="../Images/aed36eba89e4cb006ded3c7a939a7ff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-9wYPLfL8PxFhBaJ-h_vPA.png"/></div></div><figcaption class="ns nt gk gi gj nu nv bd b be z dk">Password Reset Template</figcaption></figure><p id="3a64" class="pw-post-body-paragraph lj lk jc ll b lm mu kd lo lp mv kg lr ls mw lu lv lw mx ly lz ma my mc md me ik bi translated">现在我们将能够在本地测试我们的工作流。</p><blockquote class="nw nx ny"><p id="5b5e" class="lj lk nd ll b lm mu kd lo lp mv kg lr nz mw lu lv oa mx ly lz ob my mc md me ik bi translated">⚠️只是不要忘记在部署到生产环境时将这个值更改为指向您的托管地址</p></blockquote><h1 id="3624" class="kr ks jc bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">页面/表单组件</h1><p id="8ab1" class="pw-post-body-paragraph lj lk jc ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me ik bi translated">这些组件遵循我们其他身份验证页面中的大量设计和编码实践。我们新的只是有不同的形式和验证。下面是它们的图像:</p><h2 id="c6e5" class="nm ks jc bd kt oc od dn kx oe of dp lb ls og oh ld lw oi oj lf ma ok ol lh om bi translated">忘记密码</h2><p id="13f2" class="pw-post-body-paragraph lj lk jc ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me ik bi translated">首先，用户需要能够输入他们的电子邮件，这样我们就可以给他们发送一个重置链接。下面是我们的表单的外观:</p><figure class="ne nf ng nh gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj on"><img src="../Images/14d1bda53d2d0497303841bf57382590.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zyT3MBwskIIqjJz7DekE3w.png"/></div></div><figcaption class="ns nt gk gi gj nu nv bd b be z dk">Forgot Password</figcaption></figure><h2 id="21b2" class="nm ks jc bd kt oc od dn kx oe of dp lb ls og oh ld lw oi oj lf ma ok ol lh om bi translated">发送的电子邮件</h2><p id="a5fd" class="pw-post-body-paragraph lj lk jc ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me ik bi translated">输入他们的电子邮件后，Firebase将发送我们的重置密码。我们想通知用户检查他们的电子邮件。下面是我们的表单的外观:</p><figure class="ne nf ng nh gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj on"><img src="../Images/efe2ca8719ac0a4d2bf7e3c2f9a5345a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*slhj2-FH9SNRlkxxhAdG8Q.png"/></div></div><figcaption class="ns nt gk gi gj nu nv bd b be z dk">Email Sent</figcaption></figure><h2 id="8a8a" class="nm ks jc bd kt oc od dn kx oe of dp lb ls og oh ld lw oi oj lf ma ok ol lh om bi translated">重置密码</h2><p id="517c" class="pw-post-body-paragraph lj lk jc ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me ik bi translated">用户点击电子邮件中的链接后，他们将被引导至下图所示的屏幕，在那里他们可以重置密码:</p><figure class="ne nf ng nh gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj on"><img src="../Images/dc7093e83864c526f8a40ded7e5745f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_EcOgwAN5DRwbQZ0wqBC1w.png"/></div></div><figcaption class="ns nt gk gi gj nu nv bd b be z dk">Reset Password</figcaption></figure><h2 id="db61" class="nm ks jc bd kt oc od dn kx oe of dp lb ls og oh ld lw oi oj lf ma ok ol lh om bi translated">重置密码—成功</h2><p id="6f98" class="pw-post-body-paragraph lj lk jc ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me ik bi translated">成功完成更改用户密码后，将出现以下屏幕提示:</p><figure class="ne nf ng nh gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj on"><img src="../Images/bad0e36f66ce2df9275cfffb2d46af76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o7mfDGpYaJMtwQdZk95TPQ.png"/></div></div><figcaption class="ns nt gk gi gj nu nv bd b be z dk">Reset Success</figcaption></figure><h2 id="4720" class="nm ks jc bd kt oc od dn kx oe of dp lb ls og oh ld lw oi oj lf ma ok ol lh om bi translated">重置密码—失败</h2><p id="5921" class="pw-post-body-paragraph lj lk jc ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me ik bi translated">如果密码已过期或已被用于重置密码，用户将收到以下屏幕提示:</p><figure class="ne nf ng nh gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj on"><img src="../Images/d2b668101f8dd8d60f7159354e65662b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PFTyp2gTNzyqnJpgh3AjMg.png"/></div></div><figcaption class="ns nt gk gi gj nu nv bd b be z dk">Reset Expired</figcaption></figure><p id="749f" class="pw-post-body-paragraph lj lk jc ll b lm mu kd lo lp mv kg lr ls mw lu lv lw mx ly lz ma my mc md me ik bi translated">像我之前的故事一样，我正在努力编写代码，当另一个开发人员阅读时，他们可以很容易地知道它在做什么。也就是说，您可以通过点击本文末尾的repository分支链接来阅读代码。</p><p id="84a3" class="pw-post-body-paragraph lj lk jc ll b lm mu kd lo lp mv kg lr ls mw lu lv lw mx ly lz ma my mc md me ik bi translated">😃如果有些事情仍然没有意义或者需要进一步解释，请不要犹豫，我可以将细节融入这个故事。</p><h1 id="5653" class="kr ks jc bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">知识库分支</h1><div class="iq ir gq gs is mf"><a href="https://github.com/zo103181/angular-journey/tree/angular-node-postgresql-forgot-password" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fp"><div class="mh ab mi cl cj mj"><h2 class="bd jd gz z fq mk fs ft ml fv fx jb bi translated">zo 103181/角度-旅程</h2><div class="mm l"><h3 class="bd b gz z fq mk fs ft ml fv fx dk translated">棱角到棱角更多...我的个人旅程❤️☕️-zo 103181/角度-旅程</h3></div><div class="mn l"><p class="bd b dl z fq mk fs ft ml fv fx dk translated">github.com</p></div></div><div class="mo l"><div class="oo l mq mr ms mo mt iy mf"/></div></div></a></div><h1 id="33d8" class="kr ks jc bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">结论</h1><p id="416c" class="pw-post-body-paragraph lj lk jc ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me ik bi translated">这是休息的好地方。随意拿点小吃或一杯☕️.如果你对我的故事有任何问题、意见或建议，请告诉我。</p><p id="d1e1" class="pw-post-body-paragraph lj lk jc ll b lm mu kd lo lp mv kg lr ls mw lu lv lw mx ly lz ma my mc md me ik bi translated">感谢你花时间阅读我的故事，如果你是一个追随者，我很感激❤️</p></div></div>    
</body>
</html>