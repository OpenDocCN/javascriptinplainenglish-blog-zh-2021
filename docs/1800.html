<html>
<head>
<title>Introducing Quell: A Better Caching Solution for GraphQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">引入Quell:一个更好的GraphQL缓存解决方案</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/introducing-quell-caching-solution-for-graphql-4579bdb4e231?source=collection_archive---------4-----------------------#2021-04-16">https://javascript.plainenglish.io/introducing-quell-caching-solution-for-graphql-4579bdb4e231?source=collection_archive---------4-----------------------#2021-04-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="50ce" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">缓存变得更容易了</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi kc"><img src="../Images/a9132adacc038c5072c8236ecde563fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*HHORGLiZDAVR52HXctxh6Q.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Quell, caching solution for GraphQL</figcaption></figure><p id="1cc9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><a class="ae lk" href="http://www.quellql.io" rel="noopener ugc nofollow" target="_blank"> Quell </a>是一个轻量级的JavaScript库，为客户端和服务器端提供了一个配备了规范化缓存的GraphQL缓存解决方案。</p></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><h1 id="4aa0" class="ls lt in bd lu lv lw lx ly lz ma mb mc jt md ju me jw mf jx mg jz mh ka mi mj bi translated">什么是奎尔？</h1><p id="7783" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated"><a class="ae lk" href="https://graphql.org" rel="noopener ugc nofollow" target="_blank"> GraphQL </a>旨在使API快速、灵活且对开发人员友好。它甚至可以部署在一个名为<a class="ae lk" href="https://github.com/graphql/graphiql" rel="noopener ugc nofollow" target="_blank"> GraphiQL </a>的<a class="ae lk" href="https://www.redhat.com/en/topics/middleware/what-is-ide" rel="noopener ugc nofollow" target="_blank">集成开发环境(IDE) </a>中。作为<a class="ae lk" href="https://www.redhat.com/en/topics/integration/whats-the-difference-between-soap-rest" rel="noopener ugc nofollow" target="_blank"> REST </a>的替代方案，GraphQL允许开发人员在一次API调用中构造从多个数据源获取数据的请求。</p><p id="ff55" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Quell是为GraphQL提供缓存的解决方案。Quell是一个缓存GraphQL，通过本地<a class="ae lk" href="https://redis.io" rel="noopener ugc nofollow" target="_blank"> Redis </a>实例创建一个缓存层。</p><p id="898c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们非常兴奋地向您展示奎尔。让我们开始缓存！</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mp"><img src="../Images/254628c7eb2c504b0f00559cce67d18b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ZQFFCtxgXtZspfvVANACw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Quell only requests the data it needs.</figcaption></figure><h1 id="95ea" class="ls lt in bd lu lv mu lx ly lz mv mb mc jt mw ju me jw mx jx mg jz my ka mi mj bi translated"><strong class="ak">奎尔是做什么的？</strong></h1><p id="c0d6" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated">Quell的模式控制、类型级规范化算法将GraphQL查询响应分解为单个的图形节点，作为时间可读的键值对单独缓存，并引用连接的节点。</p><p id="a207" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，根据缓存的数据存储检查后续的GraphQL请求，通过动态地重新构建一个新的查询来弥补缺失，从而允许Quell只请求它需要的数据。</p><p id="dda2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，查询响应与缓存中的数据合并，无缝返回完整响应。</p></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><h1 id="7c41" class="ls lt in bd lu lv lw lx ly lz ma mb mc jt md ju me jw mf jx mg jz mh ka mi mj bi translated">您如何使用奎尔？</h1><p id="bfc0" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated"><a class="ae lk" href="https://www.npmjs.com/package/@quell/client" rel="noopener ugc nofollow" target="_blank">奎尔/客户</a></p><p id="9792" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Quell/Client是一个易于实现的JavaScript库，为GraphQL提供了客户端缓存解决方案。奎尔的模式控制、类型级规范化算法将GraphQL查询响应缓存为图形节点的展平的键值表示，使得部分满足浏览器会话存储的查询、重构查询以及仅从其他API或数据库中获取尚未缓存的数据成为可能。</p></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><p id="2a0c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">不带Quell的提取请求的示例代码:</p><pre class="kd ke kf kg gt mz na nb nc aw nd bi"><span id="8d4a" class="ne lt in na b gy nf ng l nh ni">const sampleQuery = `query {<br/>    countries {<br/>        id<br/>        name<br/>        cities {<br/>            id<br/>            name<br/>            population<br/>        }<br/>    }<br/>}`<br/><br/>function fetchMe(sampleQuery) {<br/>    let results;<br/>    fetch('/graphQL', {<br/>        method: "POST",<br/>        body: JSON.stringify(sampleQuery)<br/>    })<br/>    .then(res =&gt; res.json())<br/>    .then(parsedRes =&gt; {<br/>      // use parsed results<br/>     });<br/><br/>fetchMe(sampleQuery)</span></pre><p id="687a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">“平息”方法采用四个参数:</p><ol class=""><li id="0e1d" class="nj nk in kq b kr ks ku kv kx nl lb nm lf nn lj no np nq nr bi translated"><strong class="kq io">终点</strong> —您的GraphQL终点为sting(例如。/graph QL’)。</li><li id="c2fd" class="nj nk in kq b kr ns ku nt kx nu lb nv lf nw lj no np nq nr bi translated"><strong class="kq io">查询</strong>——将您的GraphQL查询为字符串。</li><li id="142f" class="nj nk in kq b kr ns ku nt kx nu lb nv lf nw lj no np nq nr bi translated"><strong class="kq io">map</strong>——一个将命名查询映射到它们返回的用户定义的GraphQL类型的对象。</li></ol><pre class="kd ke kf kg gt mz na nb nc aw nd bi"><span id="9283" class="ne lt in na b gy nf ng l nh ni">const sampleMap = {<br/>  countries: 'Country',<br/>  country: 'Country',<br/>  citiesByCountryId: 'City',<br/>  cities: 'City',<br/>}</span></pre><p id="66df" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">4.<strong class="kq io"> <em class="nx"> fieldsMap </em> </strong> —将字段映射到它们返回的<a class="ae lk" href="https://graphql.org/learn/schema/#object-types-and-fields" rel="noopener ugc nofollow" target="_blank">用户定义的GraphQL类型</a>的对象。</p><pre class="kd ke kf kg gt mz na nb nc aw nd bi"><span id="c353" class="ne lt in na b gy nf ng l nh ni">const sampleFieldsMap = {<br/>  cities: 'City'<br/>}</span></pre><p id="121d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">关于Quell客户端的更多信息，你可以在我们的<a class="ae lk" href="https://www.npmjs.com/package/@quell/client" rel="noopener ugc nofollow" target="_blank">文档</a>中了解更多。</p><h1 id="f328" class="ls lt in bd lu lv mu lx ly lz mv mb mc jt mw ju me jw mx jx mg jz my ka mi mj bi translated">奎尔/服务器</h1><p id="73f7" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated">Quell/server是一个易于实现的Node.js/Express中间件，可以满足并缓存GraphQL查询。Quell的模式管理、类型级规范化算法将GraphQL查询响应缓存为图形节点的扁平键值表示，从而可以部分满足来自服务器Redis缓存的查询，重新制定查询，并仅从其他API或数据库获取尚未缓存的数据，下面是<a class="ae lk" href="https://www.npmjs.com/package/@quell/server" rel="noopener ugc nofollow" target="_blank">安装</a>步骤。</p></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><p id="734b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">您的服务器文件可能如下所示:</p><pre class="kd ke kf kg gt mz na nb nc aw nd bi"><span id="03aa" class="ne lt in na b gy nf ng l nh ni">const express = require('express');<br/>const myGraphQLSchema = require('./schema/schema');<br/>const { QuellCache } = require('@quell/server')<br/><br/>// create a new Express server<br/>const app = express();<br/><br/>// instantiate quell-server<br/>const quellCache = new QuellCache(myGraphQLSchema, 6379, 3600);<br/><br/>// apply Express's JSON parser<br/>app.use(express.json());<br/><br/>// GraphQL route<br/>app.use('/graphql',<br/>    quellCache.query,<br/>    (req, res) =&gt; {<br/>    return res<br/>        .status(200)<br/>        .send(res.locals.queryResponse);<br/>    }<br/>);<br/><br/>// expose Express server on port 3000<br/>app.listen(3000);</span></pre><p id="8f86" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">关于Quell和服务器端渲染的更多信息，你可以在我们的<a class="ae lk" href="https://www.npmjs.com/package/@quell/server" rel="noopener ugc nofollow" target="_blank">文档</a>中了解更多。</p></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><h2 id="5ec4" class="ne lt in bd lu ny nz dn ly oa ob dp mc kx oc od me lb oe of mg lf og oh mi oi bi translated">贮藏</h2><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi oj"><img src="../Images/6b99d1aa27a523845b976eb0b543f858.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sKaMionERx5TSujyVXHzkQ.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Example of caching by Quell <a class="ae lk" href="http://www.quellql.io/#demo" rel="noopener ugc nofollow" target="_blank">Demo</a></figcaption></figure><p id="acd6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">图形QL:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ok"><img src="../Images/63a73f164969ba2dda638181c9886211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ojWkjIHUJXUaEElxJtfrAw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Example of graphiQL with Quell <a class="ae lk" href="http://www.quellql.io/#demo" rel="noopener ugc nofollow" target="_blank">Demo</a></figcaption></figure></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><h2 id="8ef3" class="ne lt in bd lu ny nz dn ly oa ob dp mc kx oc od me lb oe of mg lf og oh mi oi bi translated">证明文件</h2><p id="6598" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated">我们已经在我们的网站上提供了大量的文档。如果您在文档中发现错误，请通过<a class="ae lk" href="https://github.com/oslabs-beta/Quell" rel="noopener ugc nofollow" target="_blank"> GitHub </a>提交问题。</p><h2 id="62f6" class="ne lt in bd lu ny nz dn ly oa ob dp mc kx oc od me lb oe of mg lf og oh mi oi bi translated">开源和社区贡献</h2><p id="7c72" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated">Quell是在技术加速器<a class="ae lk" href="https://opensourcelabs.io/" rel="noopener ugc nofollow" target="_blank">操作系统实验室</a>下开发的开源项目。我们欢迎通过<a class="ae lk" href="https://github.com/oslabs-beta/Quell" rel="noopener ugc nofollow" target="_blank"> GitHub </a>的贡献和反馈，如果你喜欢使用Quell或者你只是对这个项目感到兴奋，我们感谢每一位GitHub明星。</p><h2 id="06db" class="ne lt in bd lu ny nz dn ly oa ob dp mc kx oc od me lb oe of mg lf og oh mi oi bi translated">团队QuellQL</h2><p id="c117" class="pw-post-body-paragraph ko kp in kq b kr mk jo kt ku ml jr kw kx mm kz la lb mn ld le lf mo lh li lj ig bi translated">基于: 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于: GitHub 基于:</p></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><p id="976f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="nx"> More content at </em> <a class="ae lk" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nx"> plainenglish.io </em> </strong> </a></p></div></div>    
</body>
</html>