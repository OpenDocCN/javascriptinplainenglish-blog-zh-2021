<html>
<head>
<title>useQuery Instead of Fetch While Calling an API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">调用API时使用Query而不是Fetch</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/usequery-instead-of-fetch-while-calling-an-api-ef12964457c5?source=collection_archive---------5-----------------------#2021-05-17">https://javascript.plainenglish.io/usequery-instead-of-fetch-while-calling-an-api-ef12964457c5?source=collection_archive---------5-----------------------#2021-05-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/8be9d47fda6532d6de4f0d7e1a73d5d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rbiPV-an4TGs6DPfaqnZQQ.png"/></div></div></figure><h1 id="7d1f" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">介绍</h1><p id="889d" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">与Angular不同，React没有自己的抓取库。所以开发人员用他们自己的实现从服务器获取数据。但问题是，很难编写基于缓存的获取系统来有效地避免网络调用重复。</p><p id="c630" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">所以他们选择了一个非常简单的库来获取数据，比如<code class="fe lw lx ly lz b">fetch</code>、<code class="fe lw lx ly lz b">Axios</code>等等。</p><h1 id="54f7" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">反应查询</h1><p id="9807" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">React Query经常被描述为React缺少的数据获取库。它用自己的缓存机制将数据提取到服务器。</p><p id="bb99" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">它有自己的开发工具，名为<code class="fe lw lx ly lz b">ReactQueryDevtools</code></p><figure class="mb mc md me gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ma"><img src="../Images/2c98b558277f0aca47bac0e3afe0c988.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hEtK_ZG0wb02_D3dIDlxkw.png"/></div></div></figure><h1 id="dee5" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">装置</h1><p id="55a0" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">通过NPM或纱线安装<code class="fe lw lx ly lz b">react-query</code></p><pre class="mb mc md me gt mf lz mg mh aw mi bi"><span id="d087" class="mj jw in lz b gy mk ml l mm mn">$ npm i react-query</span><span id="d620" class="mj jw in lz b gy mo ml l mm mn"><em class="mp"># or</em></span><span id="2714" class="mj jw in lz b gy mo ml l mm mn">$ yarn add react-query</span></pre><p id="bbde" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">React Query与React v16.8+兼容，可与ReactDOM和React Native配合使用。</p><h1 id="ba07" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">基本示例</h1><p id="3b9b" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在这个例子中，我们将通过使用<code class="fe lw lx ly lz b">react-query</code>来调用Github API</p><figure class="mb mc md me gt jo"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="1d2f" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">它给出了这样的输出</p><figure class="mb mc md me gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/85367ac3ece80268f70f4c6dfdd1e9c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*05F0xO-P0PML6cdLv1qc-Q.png"/></div></div></figure><p id="c188" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><strong class="kv io">性能测试</strong></p><p id="e38f" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">在这里，我将测试网络呼叫重复避免系统。所以我添加了一个简单的带有反应状态的计数器。当状态更新时，组件应该重新呈现，因此<code class="fe lw lx ly lz b">react-query</code>应该避免多个网络调用。</p><figure class="mb mc md me gt jo"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="aa86" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">它会产生这样的输出。</p><figure class="mb mc md me gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/85367ac3ece80268f70f4c6dfdd1e9c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*05F0xO-P0PML6cdLv1qc-Q.png"/></div></div></figure><p id="87ab" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">让我们看看网络选项卡。</p><figure class="mb mc md me gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mt"><img src="../Images/b22873402ef6d5cdb82f30d6e0993842.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Ent15YyOShkpDpWee2BVjg.gif"/></div></div></figure><p id="3c29" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">我们可以清楚地看到，<code class="fe lw lx ly lz b">react-query</code>从缓存中加载数据，避免了多次网络调用。</p><p id="8fff" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">请尝试使用react-query来获取数据。</p><h1 id="a10e" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">TL；速度三角形定位法(dead reckoning)</h1><p id="fd27" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在React应用程序中，使用<code class="fe lw lx ly lz b">useQuery</code>而不是<code class="fe lw lx ly lz b">fetch</code>进行网络调用。它为缓存提供了极好的支持，避免了对同一个API的多次调用，记忆查询结果等等。</p><p id="2ccf" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">官方链接:<a class="ae mu" href="https://react-query.tanstack.com/" rel="noopener ugc nofollow" target="_blank">https://react-query.tanstack.com/</a></p><p id="366c" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">安装命令:<code class="fe lw lx ly lz b">npm install react-query</code></p><p id="d344" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><strong class="kv io">感谢您的阅读！</strong>如果你喜欢这篇文章，可以考虑<a class="ae mu" href="https://twitter.com/NaveenDA_" rel="noopener ugc nofollow" target="_blank">在Twitter上关注我</a>，并与你的开发者朋友分享这篇文章🐋😀</p><p id="4697" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><em class="mp">更多内容请看</em><a class="ae mu" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="mp">plain English . io</em></strong></a></p></div></div>    
</body>
</html>