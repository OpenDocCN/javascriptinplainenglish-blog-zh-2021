<html>
<head>
<title>Creating a React Timer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建反应计时器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-timer-7bbb321cbb4f?source=collection_archive---------17-----------------------#2021-05-17">https://javascript.plainenglish.io/react-timer-7bbb321cbb4f?source=collection_archive---------17-----------------------#2021-05-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/a2b0a682e36b4527a3eb1fe5c388d251.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GNgPXtJ2Ufx-A2gA"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@marceloleal80?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marcelo Leal</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1405" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最近，我决定在React中练习使用音程。上周，我做了一个秒表，然后我马上想到要做一个计时器。它真的很像秒表，只是它是倒着走的。所以，我想我应该试一试。虽然它看起来就像秒表一样简单，但是建造一个计时器有它自己的挑战。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><p id="cf79" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我使用React钩子来让这个组件工作。所以，首先，我设置了一个时间和开始状态。时间的默认值为零，开始的默认值为false。这就是它的样子。</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="ccaa" class="lo lp in lk b gy lq lr l ls lt">const [time, setTime] = useState(0);<br/>const [start, setStart] = useState(false);</span></pre><p id="bfe1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了让time以秒、分、小时显示时间，我使用了一种非常类似于秒表的方法。我们对时间值应用一些数学运算，并将数字切片，使其显示为两位数。这是它看起来的样子。</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="0d2c" class="lo lp in lk b gy lq lr l ls lt">let seconds = ("0" + (Math.floor((time / 1000) % 60) % 60)).slice(-2);<br/>let minutes = ("0" + Math.floor((time / 60000) % 60)).slice(-2);<br/>let hours = ("0" + Math.floor((time / 3600000) % 60)).slice(-2);</span></pre><p id="cefb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们将使用我们的useEffect钩子用一个间隔从每秒钟的时间中减去10。当start的值改变时，这个钩子将运行。如果start为true，间隔将运行，如果start为false，间隔将被清除。</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="1847" class="lo lp in lk b gy lq lr l ls lt">useEffect(() =&gt; {</span><span id="a359" class="lo lp in lk b gy lu lr l ls lt">  let interval = null;</span><span id="a28f" class="lo lp in lk b gy lu lr l ls lt">  if (start) {</span><span id="73c9" class="lo lp in lk b gy lu lr l ls lt">    interval = setInterval(() =&gt; {</span><span id="1268" class="lo lp in lk b gy lu lr l ls lt">    if (time &gt; 0) {</span><span id="9e41" class="lo lp in lk b gy lu lr l ls lt">      setTime(prevTime =&gt; prevTime - 10)</span><span id="a6cf" class="lo lp in lk b gy lu lr l ls lt">    }</span><span id="6210" class="lo lp in lk b gy lu lr l ls lt">    }, 10)</span><span id="4c5c" class="lo lp in lk b gy lu lr l ls lt">  } else {</span><span id="de00" class="lo lp in lk b gy lu lr l ls lt">    clearInterval(interval);</span><span id="6744" class="lo lp in lk b gy lu lr l ls lt">  }</span><span id="73d3" class="lo lp in lk b gy lu lr l ls lt">  return () =&gt; {</span><span id="158d" class="lo lp in lk b gy lu lr l ls lt">    clearInterval(interval)</span><span id="c3a3" class="lo lp in lk b gy lu lr l ls lt">  }</span><span id="e28f" class="lo lp in lk b gy lu lr l ls lt">}, [start])</span></pre><p id="217b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了设置计时器，我创建了一些按钮来增加时间。每个按钮将增加一小时、一分钟或一秒钟。这对于递减也是一样的。为了实现这一点，我创建了一个接受输入的函数。如果计时器尚未启动，时间可以根据按下的按钮增加。</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="3712" class="lo lp in lk b gy lq lr l ls lt">function adjustTimer(input) {</span><span id="46ac" class="lo lp in lk b gy lu lr l ls lt">  if (!start) {</span><span id="27aa" class="lo lp in lk b gy lu lr l ls lt">    switch (input) {</span><span id="97c7" class="lo lp in lk b gy lu lr l ls lt">      case "incHours":</span><span id="49d4" class="lo lp in lk b gy lu lr l ls lt">        setTime(prevTime =&gt; prevTime + 3600000)</span><span id="3660" class="lo lp in lk b gy lu lr l ls lt">        break;</span><span id="b8f8" class="lo lp in lk b gy lu lr l ls lt">      case "incMinutes":</span><span id="8e59" class="lo lp in lk b gy lu lr l ls lt">        setTime(prevTime =&gt; prevTime + 60000)</span><span id="40c3" class="lo lp in lk b gy lu lr l ls lt">        break;</span><span id="6b12" class="lo lp in lk b gy lu lr l ls lt">      case "incSeconds":</span><span id="de1e" class="lo lp in lk b gy lu lr l ls lt">        setTime(prevTime =&gt; prevTime + 1000)</span><span id="6242" class="lo lp in lk b gy lu lr l ls lt">        break;</span><span id="b1b3" class="lo lp in lk b gy lu lr l ls lt">      case "decHours":</span><span id="6ef4" class="lo lp in lk b gy lu lr l ls lt">        setTime(prevTime =&gt; prevTime - 3600000)</span><span id="7daa" class="lo lp in lk b gy lu lr l ls lt">      case "decMinutes":</span><span id="0f25" class="lo lp in lk b gy lu lr l ls lt">        setTime(prevTime =&gt; prevTime - 60000)</span><span id="7e44" class="lo lp in lk b gy lu lr l ls lt">        break;</span><span id="398e" class="lo lp in lk b gy lu lr l ls lt">      case "decSeconds":</span><span id="f8d0" class="lo lp in lk b gy lu lr l ls lt">        setTime(prevTime =&gt; prevTime - 1000)</span><span id="cf30" class="lo lp in lk b gy lu lr l ls lt">        break;</span><span id="f123" class="lo lp in lk b gy lu lr l ls lt">      default:</span><span id="a458" class="lo lp in lk b gy lu lr l ls lt">        break;</span><span id="8560" class="lo lp in lk b gy lu lr l ls lt">    }</span><span id="4f16" class="lo lp in lk b gy lu lr l ls lt">  }</span><span id="5e55" class="lo lp in lk b gy lu lr l ls lt">}</span></pre><p id="6256" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这就是为我们提供计时器主要功能的所有逻辑。现在我们只需要将所有这些渲染到我们的屏幕上。时间显示将位于一组按钮之间，有助于增加和减少时间。还会有一个开始，停止和复位按钮。我们的return语句将如下所示。</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="fd8d" class="lo lp in lk b gy lq lr l ls lt">return (</span><span id="42e6" class="lo lp in lk b gy lu lr l ls lt">  &lt;div className="App"&gt;</span><span id="14bc" class="lo lp in lk b gy lu lr l ls lt">  &lt;button onClick={() =&gt; adjustTimer("incHours")}&gt;&amp;#8679;&lt;/button&gt;</span><span id="e983" class="lo lp in lk b gy lu lr l ls lt">  &lt;button onClick={() =&gt; adjustTimer("incMinutes")}&gt;&amp;#8679;&lt;/button&gt;</span><span id="cb76" class="lo lp in lk b gy lu lr l ls lt">  &lt;button onClick={() =&gt; adjustTimer("incSeconds")}&gt;&amp;#8679;&lt;/button&gt;</span><span id="c3a6" class="lo lp in lk b gy lu lr l ls lt">  &lt;div&gt;{hours} : {minutes} : {seconds}&lt;/div&gt;</span><span id="7925" class="lo lp in lk b gy lu lr l ls lt">  &lt;button onClick={() =&gt; adjustTimer("decHours")}&gt;&amp;#8681;&lt;/button&gt;</span><span id="1e01" class="lo lp in lk b gy lu lr l ls lt">  &lt;button onClick={() =&gt; adjustTimer("decMinutes")}&gt;&amp;#8681;&lt;/button&gt;</span><span id="a781" class="lo lp in lk b gy lu lr l ls lt">  &lt;button onClick={() =&gt; adjustTimer("decSeconds")}&gt;&amp;#8681;&lt;/button&gt; &lt;br/&gt;&lt;br/&gt;</span><span id="5b4a" class="lo lp in lk b gy lu lr l ls lt">  &lt;button onClick={() =&gt; setStart(true)}&gt;Start&lt;/button&gt;</span><span id="0561" class="lo lp in lk b gy lu lr l ls lt">  &lt;button onClick={() =&gt; setStart(false)}&gt;Stop&lt;/button&gt;</span><span id="5ad7" class="lo lp in lk b gy lu lr l ls lt">  &lt;button onClick={() =&gt; {setStart(false); setTime(0)}}&gt;Reset&lt;/button&gt;</span><span id="d5c9" class="lo lp in lk b gy lu lr l ls lt">&lt;/div&gt;</span><span id="38b3" class="lo lp in lk b gy lu lr l ls lt">);</span></pre></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><p id="6450" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是我的计时器！公平地说，它并不完美。有些怪癖需要改正。我正在考虑有条件地渲染按钮，以便它们只在计时器进程的不同步骤中显示。</p><p id="06b8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">尽管如此，仍有很大的改进空间，但这是开始工作所需要的。编码快乐！</p><p id="d269" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="lv">更多内容尽在</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="lv">plain English . io</em></a></p></div></div>    
</body>
</html>