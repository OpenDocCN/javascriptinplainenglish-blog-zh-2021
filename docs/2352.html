<html>
<head>
<title>Identify Performance Issues of React Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">确定React组件的性能问题</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/why-did-your-react-component-render-a8c95e8310e6?source=collection_archive---------6-----------------------#2021-05-16">https://javascript.plainenglish.io/why-did-your-react-component-render-a8c95e8310e6?source=collection_archive---------6-----------------------#2021-05-16</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="62ca" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">为什么我的React组件重新呈现？</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/052ea4b2353411fd71789111325e3544.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oj6SEXd6g-7bwVCy7rppdg.jpeg"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Photo by <a class="ae kw" href="https://www.pexels.com/@olly?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Andrea Piacquadio</a> from <a class="ae kw" href="https://www.pexels.com/photo/pensive-male-teen-on-gray-background-3854130/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><p id="6727" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">反应很快。我是说非常非常快。这是它受欢迎的主要原因之一。</p><p id="ecd7" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是有时我们滥用它的特性会在应用程序中产生性能问题。组件不应该渲染超过他们需要的！</p><p id="c9da" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">今天我们就来看看如何使用一个名为<code class="fe lt lu lv lw b"><a class="ae kw" href="https://www.npmjs.com/package/@welldone-software/why-did-you-render" rel="noopener ugc nofollow" target="_blank"><strong class="kz is">why-did-you-render</strong></a></code>的牛逼库来自动识别组件不必要的渲染，以及如何解决！</p><h1 id="6dc2" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">安装依赖项</h1><p id="9adc" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">首先，将包安装到您的项目中。</p><pre class="kh ki kj kk gu mu lw mv mw aw mx bi"><span id="4fc1" class="my ly ir lw b gz mz na l nb nc">yarn add @welldone-software/why-did-you-render</span></pre></div><div class="ab cl nd ne hv nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ik il im in io"><h1 id="0307" class="lx ly ir bd lz ma nk mc md me nl mg mh jx nm jy mj ka nn kb ml kd no ke mn mo bi translated">创建配置文件</h1><p id="cd8b" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">在项目的根文件夹中创建一个名为<code class="fe lt lu lv lw b">wydr.js</code>的文件。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="np nq l"/></div></figure><p id="6a7e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在这里你可以找到更多的选项<a class="ae kw" href="https://www.npmjs.com/package/@welldone-software/why-did-you-render" rel="noopener ugc nofollow" target="_blank">。我们保持简单。</a></p><h1 id="ea02" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">添加到项目</h1><p id="8b99" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">将这个文件作为<strong class="kz is">的第一件事</strong>导入到你的项目的根中(即<code class="fe lt lu lv lw b">index.js</code>)。这一点很重要！</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="np nq l"/></div></figure></div><div class="ab cl nd ne hv nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ik il im in io"><h1 id="90b5" class="lx ly ir bd lz ma nk mc md me nl mg mh jx nm jy mj ka nn kb ml kd no ke mn mo bi translated">让我们看看它的实际效果</h1><p id="ddf2" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">让我们创建一个名为<code class="fe lt lu lv lw b">WhyDidYouRenderDemo.js</code>的新组件。并添加下面这段代码。</p><p id="f828" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这段代码的作用是在你每次点击<code class="fe lt lu lv lw b">Update</code>按钮时设置用户对象。这不是一个实际的例子，但对于演示来说足够了。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="np nq l"/></div></figure><p id="e2b3" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们添加了一个控制台来识别何时渲染。</p></div><div class="ab cl nd ne hv nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ik il im in io"><h1 id="a936" class="lx ly ir bd lz ma nk mc md me nl mg mh jx nm jy mj ka nn kb ml kd no ke mn mo bi translated">浪费渲染的问题</h1><p id="4d93" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">现在我们先试着理解一下问题。每当有人点击<code class="fe lt lu lv lw b">Update</code>按钮，整个组件将重新呈现。</p><p id="688e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在javascript中，每次创建一个新的对象引用，这就是组件被重新呈现的原因。但是这是一个问题，因为实际上用户对象的内容是相同的。</p><p id="49f3" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您可以通过反复单击更新按钮来验证这一点。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nr"><img src="../Images/d10f824945717cbda2c715e889127992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CgwrhGBtVCg9FnLESb38Yw.png"/></div></div></figure><p id="09ea" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这是一个浪费的渲染，因为在视图方面没有任何更新应该通知用户。</p></div><div class="ab cl nd ne hv nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ik il im in io"><h1 id="55c1" class="lx ly ir bd lz ma nk mc md me nl mg mh jx nm jy mj ka nn kb ml kd no ke mn mo bi translated">让我们打开“为什么渲染”</h1><p id="9ea3" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">现在让我们打开<code class="fe lt lu lv lw b">why-did-you-render</code>,看看它是否能给我们一些启示。在要跟踪的组件的末尾添加下面一行。</p><pre class="kh ki kj kk gu mu lw mv mw aw mx bi"><span id="3a28" class="my ly ir lw b gz mz na l nb nc">WhyDidYouRender.whyDidYouRender= true;</span></pre><p id="4106" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">最终的组件看起来像这样。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="np nq l"/></div></figure></div><div class="ab cl nd ne hv nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ik il im in io"><h1 id="2a80" class="lx ly ir bd lz ma nk mc md me nl mg mh jx nm jy mj ka nn kb ml kd no ke mn mo bi translated">现在看看魔法</h1><p id="a5fb" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">现在，当你点击<code class="fe lt lu lv lw b"><strong class="kz is">Update</strong></code>按钮时，你要留意控制台。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj ns"><img src="../Images/a6826d72f78d8cb352a4a88fc1f60582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hcdRgY3okZrHZPNE_a5GDQ.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Magic!</figcaption></figure><p id="ee28" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">看看这个。控制台上写着。</p><ul class=""><li id="537f" class="nt nu ir kz b la lb ld le lg nv lk nw lo nx ls ny nz oa ob bi translated">为什么会发生这种情况-&gt;因为钩子的变化</li><li id="4414" class="nt nu ir kz b la oc ld od lg oe lk of lo og ls ny nz oa ob bi translated">底层原因<strong class="kz is">-&gt;-</strong>不同的对象即值相等</li><li id="2bf3" class="nt nu ir kz b la oc ld od lg oe lk of lo og ls ny nz oa ob bi translated">上一个和下一个值-&gt;用户的值</li></ul><p id="498a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is">多酷啊？</strong>现在我们清楚了为什么会发生这种情况，并试图解决这个问题。</p></div><div class="ab cl nd ne hv nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ik il im in io"><h1 id="ce88" class="lx ly ir bd lz ma nk mc md me nl mg mh jx nm jy mj ka nn kb ml kd no ke mn mo bi translated">解决办法</h1><p id="74c8" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">因为我们的组件因为一个新的对象引用而被重新渲染，所以让我们把对象放到全局范围来解决这个问题。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="np nq l"/></div></figure><p id="b959" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在，如果你点击<code class="fe lt lu lv lw b">Update</code>按钮，你的组件应该不会重新渲染。</p></div><div class="ab cl nd ne hv nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ik il im in io"><h1 id="5e59" class="lx ly ir bd lz ma nk mc md me nl mg mh jx nm jy mj ka nn kb ml kd no ke mn mo bi translated">结论</h1><p id="a2ca" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">React的设计非常具有性能。你不应该经常使用这个图书馆。因为大多数时候都是你要负责任。因此，先学习React的基础知识和最佳实践。</p><p id="c5e6" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是如果你不能用概念解决问题，那么你可以把它作为最后的手段。</p><p id="8586" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">祝您愉快！</p><p id="e5e4" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is">视频格式:</strong>T5】https://www.youtube.com/watch?v=0wneu4s1xDo&amp;t = 180s</p><p id="2841" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is">有话要说？通过</strong> <a class="ae kw" href="https://www.linkedin.com/in/56faisal/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> LinkedIn </strong> </a>联系我</p><div class="oh oi gq gs oj ok"><a href="https://betterprogramming.pub/top-7-libraries-for-blazingly-fast-reactjs-applications-c0069e87c8b7" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fp"><div class="om ab on cl cj oo"><h2 class="bd is gz z fq op fs ft oq fv fx iq bi translated">快速反应应用的7大库</h2><div class="or l"><h3 class="bd b gz z fq op fs ft oq fv fx dk translated">摇滚明星开发人员的必备工具</h3></div><div class="os l"><p class="bd b dl z fq op fs ft oq fv fx dk translated">better编程. pub</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy kq ok"/></div></div></a></div><div class="oh oi gq gs oj ok"><a rel="noopener  ugc nofollow" target="_blank" href="/20-essential-parts-of-any-large-scale-react-app-ee4bd35436a0"><div class="ol ab fp"><div class="om ab on cl cj oo"><h2 class="bd is gz z fq op fs ft oq fv fx iq bi translated">任何大型React应用程序的20个基本部分</h2><div class="or l"><h3 class="bd b gz z fq op fs ft oq fv fx dk translated">如果您正在编写企业级代码，您需要了解这一点</h3></div><div class="os l"><p class="bd b dl z fq op fs ft oq fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="ot l"><div class="oz l ov ow ox ot oy kq ok"/></div></div></a></div></div></div>    
</body>
</html>