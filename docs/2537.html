<html>
<head>
<title>How to Calculate APY for any LP Token using JavaScript in 4 Simple Steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用JavaScript通过4个简单的步骤计算任意LP令牌的APY</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-calculate-apy-for-any-lp-token-using-javascript-in-four-simple-steps-956d8543a239?source=collection_archive---------3-----------------------#2021-05-25">https://javascript.plainenglish.io/how-to-calculate-apy-for-any-lp-token-using-javascript-in-four-simple-steps-956d8543a239?source=collection_archive---------3-----------------------#2021-05-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/50f74385efa559a10e01a7788a93890b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MvxL_9d--S2tqN3x-oDtzA.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Credits — <a class="ae jz" href="https://www.lcmsfoundation.org/investment-services/investment-funds" rel="noopener ugc nofollow" target="_blank">https://www.lcmsfoundation.org/investment-services/investment-funds</a></figcaption></figure><p id="54a1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">嘿，我是一名MERN堆栈开发人员，最近开始学习区块链领域的一两件事。我试图为农业合同构建一个用户界面，并把前端与智能合同集成在一起。一切都很顺利。然后，我编写代码来计算LP令牌的APY，并将其显示在UI上。</p><p id="df14" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我谷歌了很多，也加入了多个开发者论坛，以获得关于我应该如何实现它的帮助。不幸的是，我没有找到一个好的教程，也没有找到一个简单的解决方案。</p><p id="5fcb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">经过三天的努力，经过无数的项目和文章，我终于找到了答案。我想对全程指导我的Xoheb表示感谢。</p><p id="6829" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下面我在分享解决方案。我想一步一步地解释它，以便像我这样的传统软件开发人员和最近开始在区块链领域工作的人可以在需要时轻松地构建相同的功能。</p><p id="4060" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">更进一步来说，我从事的农业合同是<a class="ae jz" href="https://github.com/sushiswap/sushiswap/blob/master/contracts/MasterChef.sol" rel="noopener ugc nofollow" target="_blank">厨艺大师合同</a>的一个分支。以下方法适用于Kovan Testnet、BSC Testnet、Ethereum Mainnet和BSC Mainnet。我还没有在其他人身上测试过，但它应该可以无缝工作。我的项目在React中，代码是普通的JavaScript，只使用几个npm包来计算和获取代币的价格。</p><p id="b7f1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于那些想直接查看代码的人，请查看<a class="ae jz" href="https://gist.github.com/bhavya2611/fc379f9ada752c60a6df57bc0fbf2c65" rel="noopener ugc nofollow" target="_blank"> calculateAPY.js </a></p><p id="d4bb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">其他的，开始吧！</p><p id="3292" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">第一步</strong> <br/>如果你还没有安装“web3”、“bignumber.js”和“@ uni WAP/SDK”，我们需要下面的包。</p><p id="ac64" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">注意——如果你为BigNumber使用其他的包，那也可以。</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="a39e" class="li lj in le b gy lk ll l lm ln">To install all of them together -</span><span id="07ec" class="li lj in le b gy lo ll l lm ln">npm install --save web3 @uniswap/sdk bignumber.js</span></pre><p id="c156" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">第二步<br/> </strong>让我们现在开始写一些代码，首先我们将添加所有需要的导入。</p><figure class="kz la lb lc gt jo"><div class="bz fp l di"><div class="lp lq l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Imports</figcaption></figure><p id="bc10" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">步骤3 <br/> </strong>声明将在整个代码中使用的常量变量。</p><figure class="kz la lb lc gt jo"><div class="bz fp l di"><div class="lp lq l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Declare Constants</figcaption></figure><p id="207b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">步骤4 </strong> <br/>使用以下公式计算LP令牌价格:-</p><figure class="kz la lb lc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lr"><img src="../Images/f73e4f5b93c0654666c1ba32c2808c19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QA7Hc2j4OillHyVc4S7oeQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Credits — <a class="ae jz" href="https://blog.alphafinance.io/fair-lp-token-pricing/" rel="noopener ugc nofollow" target="_blank">https://blog.alphafinance.io/fair-lp-token-pricing/</a></figcaption></figure><p id="04c2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">出于演示目的，我将计算Dogecoin/ETH和Dogecoin/BNB价格。此外，上述价格(p0和p1)必须在同一个单位，就像他们可以在美元或BTC或其他任何东西。为简单起见，为了避免额外的计算，我将根据我所在的网络以ETH/BNB计算价格。</p><p id="c3a8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有人可能会问，为什么用ETH/BNB而不用美元，那是因为我只需要计算Dogecoin的价格，ETH的价格在以太坊主网上是1，同样的，在BSC主网上，BNB的价格是1。<br/>因此p0 (ETH/BNB价格)= 1，下面是计算<br/> p1 (Dogecoin价格)的方法</p><p id="962b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky">注意——由于我们选择了Dogecoin，最终用户在农业合同中存入一些LP代币后将获得Dogecoin奖励，奖励代币最好是您想要奖励的代币或您所在组织的代币。</em></p><figure class="kz la lb lc gt jo"><div class="bz fp l di"><div class="lp lq l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Calculate token price in ETH or BNB</figcaption></figure><p id="0265" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要了解更多有关如何从UniSwap获取代币价格的信息，请参考<a class="ae jz" href="https://uniswap.org/docs/v2/javascript-SDK/pricing/" rel="noopener ugc nofollow" target="_blank">uni WAP/JavaScript-SDK</a>。</p><p id="6cde" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在撰写本文时，我没有找到使用PancakeSwap JavaScript SDK在BSC Mainnet/Testnet上获取价格的方法，因此我直接使用了他们的API。</p><p id="ed62" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">接下来，我们需要获取LP令牌合同中所有令牌的储备，即获取存放在LP令牌合同中的BNB/ETH和Dogecoin的储备。</p><figure class="kz la lb lc gt jo"><div class="bz fp l di"><div class="lp lq l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Get Token Reserve From Lp Token Contract</figcaption></figure><p id="9684" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">接下来，我们将编写一个函数来获取市场上LP令牌的总供应量。</p><figure class="kz la lb lc gt jo"><div class="bz fp l di"><div class="lp lq l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Get LP Token Total Supply</figcaption></figure><p id="9548" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们可以计算LP令牌的价格了</p><figure class="kz la lb lc gt jo"><div class="bz fp l di"><div class="lp lq l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Calculate LP Token Price</figcaption></figure><p id="8a59" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">第四步<br/> </strong>最后，我们现在来计算APY。简而言之，我们将计算每年的<strong class="kc io">总</strong> <strong class="kc io">奖励代币价格，将其除以池</strong>中LP代币的<strong class="kc io">总</strong> <strong class="kc io">价格，然后乘以<strong class="kc io"> 100 </strong>将其转换为百分比。</strong></p><figure class="kz la lb lc gt jo"><div class="bz fp l di"><div class="lp lq l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Calculate APY for LP Token</figcaption></figure><p id="22b2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我希望你能够实现计算APY的目标，我很感谢你花时间阅读这篇文章。</p><p id="f22f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://gist.github.com/bhavya2611/fc379f9ada752c60a6df57bc0fbf2c65" rel="noopener ugc nofollow" target="_blank">链接到完整的代码。</a></p><p id="a691" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果任何信息不正确或您有疑问，您可以在下面评论或通过<a class="ae jz" href="https://t.me/iambhavyamehta" rel="noopener ugc nofollow" target="_blank">电报</a>或<a class="ae jz" href="https://www.linkedin.com/in/bhavya-y-mehta/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p><p id="6a14" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">谢谢大家！</p><p id="c533" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky">更多内容请看</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="ky">plain English . io</em></a></p></div></div>    
</body>
</html>