<html>
<head>
<title>How I Use Excel With React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Excel和React</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-i-use-excel-with-react-js-c6b42f2ec3a1?source=collection_archive---------5-----------------------#2021-06-26">https://javascript.plainenglish.io/how-i-use-excel-with-react-js-c6b42f2ec3a1?source=collection_archive---------5-----------------------#2021-06-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="60b8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我在React中使用excel的方式</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4b9592c5f47fe0aeac48a6770d9b8502.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pwN5g4vvR4eNydK0IFu-EQ.png"/></div></div></figure><p id="dce6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Excel是一个强大的工具。由于许多人非常依赖它，Excel已经成为一种行业标准，用于创建、操作和处理大量数据。</p><p id="369c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我在React中使用了几个库来生成报告。最简单的是react-csv，它几乎不需要配置，就能为您提供一个csv。</p><p id="2310" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是这些天我依赖的图书馆是<a class="ae ku" href="https://www.npmjs.com/package/exceljs" rel="noopener ugc nofollow" target="_blank"> exceljs </a>。</p><h2 id="08e7" class="kv kw in bd kx ky kz dn la lb lc dp ld jv le lf lg jz lh li lj kd lk ll lm ln bi translated">使用exceljs的原因是:</h2><p id="e3eb" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">对于CSV(逗号分隔值)和普通CSV库，某种程度上限制了您对电子表格布局的控制。</p><p id="325e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">CSV只是一个简单的文本文件，但你可以生成。xlsx</p><p id="b91b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，在使用可以生成。xlsx文件，你可以控制每一个细胞。你决定页眉尺寸，你决定对齐方式；您可以决定如何以及在哪里更改字体大小。</p><p id="a6af" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们的一个应用程序中，我们有这样的需求，需要每个用户的数据。那个用户的名字有特定的元数据和独特的风格。</p><p id="1bdb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们已经使用了react-csv，但是由于csv的限制，我们无法在应用程序中找到API或控件来做同样的事情。这就是我们求助于NPM，寻找我们能够以最快的方式达到这一要求的不同方法。</p><p id="16ef" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面是一个简单的excel js编写器方法的例子。</p><pre class="kj kk kl km gt lt lu lv lw aw lx bi"><span id="2188" class="kv kw in lu b gy ly lz l ma mb">const Excel = require('exceljs');</span><span id="e801" class="kv kw in lu b gy mc lz l ma mb">async function exTest(){<br/>  const workbook = new Excel.Workbook();<br/>  const worksheet = workbook.addWorksheet("My Sheet");</span><span id="3d36" class="kv kw in lu b gy mc lz l ma mb">worksheet.columns = [<br/> {header: 'Id', key: 'id', width: 10},<br/> {header: 'Name', key: 'name', width: 32}, <br/> {header: 'D.O.B.', key: 'dob', width: 15,}<br/>];</span><span id="934f" class="kv kw in lu b gy mc lz l ma mb">worksheet.addRow({id: 1, name: 'John Doe', dob: new Date(1970, 1, 1)});<br/>worksheet.addRow({id: 2, name: 'Jane Doe', dob: new Date(1965, 1, 7)});</span><span id="54ae" class="kv kw in lu b gy mc lz l ma mb">// save under export.xlsx<br/>await workbook.xlsx.writeFile('export.xlsx');</span><span id="a031" class="kv kw in lu b gy mc lz l ma mb">//load a copy of export.xlsx<br/>const newWorkbook = new Excel.Workbook();<br/>await newWorkbook.xlsx.readFile('export.xlsx');</span><span id="d52d" class="kv kw in lu b gy mc lz l ma mb">const newworksheet = newWorkbook.getWorksheet('My Sheet');<br/>newworksheet.columns = [<br/> {header: 'Id', key: 'id', width: 10},<br/> {header: 'Name', key: 'name', width: 32}, <br/> {header: 'D.O.B.', key: 'dob', width: 15,}<br/>];<br/>await newworksheet.addRow({id: 3, name: 'New Guy', dob: new Date(2000, 1, 1)});</span><span id="1694" class="kv kw in lu b gy mc lz l ma mb">await newWorkbook.xlsx.writeFile('export2.xlsx');</span><span id="3751" class="kv kw in lu b gy mc lz l ma mb">console.log("File is written");</span><span id="4089" class="kv kw in lu b gy mc lz l ma mb">};</span><span id="0ea0" class="kv kw in lu b gy mc lz l ma mb">exTest();</span></pre><p id="8f88" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是一个针对每一行操作字体的例子。</p><pre class="kj kk kl km gt lt lu lv lw aw lx bi"><span id="1082" class="kv kw in lu b gy ly lz l ma mb">let row = workSheet.addRow(rowValues);<br/>            row.fill = {<br/>                type: 'pattern',<br/>                pattern:'solid',<br/>                fgColor:{argb:'#000000'},<br/>                bgColor:{argb:'#FF0000'}<br/>            };</span></pre><p id="ae56" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用您的UI，您可以将所有复杂的表格数据转换成非常有用的报告。</p><p id="4081" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们可以将这项工作交给所有的专家来完成，只需很少的努力和人工干预，就可以提取尽可能多的数据来支持系统的发展。</p><h2 id="f49c" class="kv kw in bd kx ky kz dn la lb lc dp ld jv le lf lg jz lh li lj kd lk ll lm ln bi translated">一切听起来都很棒，但有一个问题</h2><p id="180f" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">所有这些对我们来说都太顺利了，直到到了上线的时候，我们不得不投入生产。这是我们开始意识到在旧浏览器中对这个包的有限支持的一个缺点。</p><p id="5a2c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请继续关注我如何摆脱这种混乱的局面。</p><p id="78f6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">尽管如此，exceljs是一个出色的库，就在今天，我在工作中使用了它。:D</p><p id="f624" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">快乐编码，不断学习。</p><p id="fe0d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">和平！</p><p id="0406" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="md">更多内容尽在</em><a class="ae ku" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="md">plain English . io</em></strong></a></p></div></div>    
</body>
</html>