<html>
<head>
<title>Using Node.js + S3 to Create, Delete, List Buckets and Upload, List Objects — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js + S3创建、删除、列出存储桶和上传、列出对象—第1部分</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/using-node-js-s3-to-create-delete-list-buckets-and-upload-list-objects-part-1-b9943825c666?source=collection_archive---------6-----------------------#2021-02-21">https://javascript.plainenglish.io/using-node-js-s3-to-create-delete-list-buckets-and-upload-list-objects-part-1-b9943825c666?source=collection_archive---------6-----------------------#2021-02-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/d8dee8fb358920c83e6057776f1e543f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0gpNTmivzmciNqrg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@casparrubin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Caspar Camille Rubin</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="7618" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">简介</strong></h1><p id="06fb" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">大多数网站需要主机来托管图像、视频等。一个显而易见的方法是将其存储在硬盘上。这看起来不错，但如果所需的存储空间超过硬盘存储限制，该怎么办呢？我们将需要相应地扩展它，这是一个有点乏味的任务。</p><p id="56ee" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在这里，像AWS S3这样的托管服务进入了画面，因为它可以存储大量的媒体文件和相应的规模。</p><blockquote class="mb mc md"><p id="bf45" class="ky kz me la b lb lw ld le lf lx lh li mf ly ll lm mg lz lp lq mh ma lt lu lv ig bi translated">本博客最初发布于<a class="ae jz" href="https://www.gyaanibuddy.com/blog/using-nodejs-s3-to-createdeletelist-buckets-and-upload-list-objects-part-1/" rel="noopener ugc nofollow" target="_blank">https://www . gyaanibuddy . com/blog/using-nodejs-S3-to-createdeletelist-buckets-and-upload-list-objects-part-1/</a></p></blockquote><p id="7d6b" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io">这个博客有两部分:</strong></p><p id="36a2" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">第一部分—了解如何设置AWS S3并手动使用它。</p><p id="2cfa" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><a class="ae jz" href="https://medium.com/@rugved-bongale/using-node-js-s3-to-create-delete-list-buckets-and-upload-list-objects-part-2-fb1b76da36dc" rel="noopener">第二部分—以编程方式使用Node.js在S3上执行操作。</a></p><h1 id="6633" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">什么是AWS S3？</strong></h1><p id="7cae" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">亚马逊简单存储服务是互联网存储。它旨在使开发人员更容易进行网络规模的计算。</p><p id="555c" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">亚马逊S3有一个简单的网络服务界面，你可以用它在任何时间从网络上的任何地方存储和检索任何数量的数据。它让任何开发者都可以使用亚马逊用来运行其全球网站网络的高度可扩展、可靠、快速、廉价的数据存储基础设施。该服务旨在最大化规模效益，并将这些效益传递给开发者。</p><p id="117d" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><em class="me">来源:</em><a class="ae jz" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/Welcome.html" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/Amazon S3/latest/dev/welcome . html</a></p><h1 id="ba72" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">我们在建造什么？</strong></h1><p id="03da" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在这篇博客中，我们将看到<strong class="la io"> Node.js实现</strong>执行以下操作:</p><blockquote class="mb mc md"><p id="6f27" class="ky kz me la b lb lw ld le lf lx lh li mf ly ll lm mg lz lp lq mh ma lt lu lv ig bi translated">代码将在第二部分介绍，但在此之前，我们需要做一些设置。因此，在进入第二部分之前，请继续关注这篇博客。</p></blockquote><ol class=""><li id="52f3" class="mi mj in la b lb lw lf lx lj mk ln ml lr mm lv mn mo mp mq bi translated"><em class="me">在S3上创建一个桶(就像一个特定的唯一文件夹来存储我们的媒体)</em></li><li id="07ef" class="mi mj in la b lb mr lf ms lj mt ln mu lr mv lv mn mo mp mq bi translated">列出我们制造的所有水桶。</li><li id="d5df" class="mi mj in la b lb mr lf ms lj mt ln mu lr mv lv mn mo mp mq bi translated"><em class="me">将图像上传到存储桶。</em></li><li id="a189" class="mi mj in la b lb mr lf ms lj mt ln mu lr mv lv mn mo mp mq bi translated"><em class="me">列出桶中的所有对象(图像、视频等)</em></li><li id="601b" class="mi mj in la b lb mr lf ms lj mt ln mu lr mv lv mn mo mp mq bi translated"><em class="me">删除桶。</em></li></ol><h1 id="0bad" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">我们开始吧</h1><p id="509c" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated"><strong class="la io">设置</strong></p><ol class=""><li id="aeac" class="mi mj in la b lb lw lf lx lj mk ln ml lr mm lv mn mo mp mq bi translated">如果没有，创建一个<a class="ae jz" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank"> AWS </a>帐户。登录您的AWS帐户。</li><li id="ab00" class="mi mj in la b lb mr lf ms lj mt ln mu lr mv lv mn mo mp mq bi translated">登录后，在顶栏上，你会看到你的名字和一个下拉标志。点击它。</li><li id="004d" class="mi mj in la b lb mr lf ms lj mt ln mu lr mv lv mn mo mp mq bi translated">选择<strong class="la io"> <em class="me">【我的安全凭证】</em> </strong>。将出现以下屏幕。</li></ol><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/3cd1ace7b168b2222abfa1a38f8efc75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x1_jX5M38CJ--SlWt79SlA.png"/></div></div></figure><p id="30b5" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">4.点击<strong class="la io"> <em class="me">创建新的访问键</em> </strong>按钮。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/1189f2dcfdaac72ac3821cda3fc8a7ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zxEtfeemR7Uu59KN0rkGhA.png"/></div></div></figure><p id="6dc6" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">5.点击<strong class="la io"> <em class="me">下载密钥文件</em> </strong>或<strong class="la io">显示访问密钥</strong></p><p id="a075" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">6.在这两种情况下，您将获得以下<br/> — <strong class="la io"> <em class="me">访问密钥ID </em> </strong> <br/> — <strong class="la io"> <em class="me">秘密访问密钥</em> </strong></p><p id="73cc" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">把它们记下来，我们以后还会需要它们。</p><h1 id="1841" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">访问S3控制台</strong></h1><p id="51ed" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在顶部的搜索栏中，输入S3。单击第一个选项。您将被引导至显示当前存储桶列表的页面。如果您是第一次使用它，它将是一个空列表。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nc"><img src="../Images/fc7c86d089c4faea768ff61a530e6f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2G5E9spkp0KPlA0RB7ABWw.png"/></div></div></figure><p id="bdac" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在转到代码之前，让我们手动<strong class="la io">做</strong>并且理解什么是S3。</p><ol class=""><li id="78ee" class="mi mj in la b lb lw lf lx lj mk ln ml lr mm lv mn mo mp mq bi translated">点击创建存储桶按钮。</li></ol><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nd"><img src="../Images/80e9796e115d9c143912c472ff70e812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WeG9aoYgrvn0eZUfCiFzNA.png"/></div></div></figure><p id="1bd4" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">2.为存储桶指定一个唯一的名称。请注意，这应该是一个唯一的名称。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ne"><img src="../Images/834b89d3a78bdcd778e29048e486b948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ysaIzIx180Ak4xDO7WCUg.png"/></div></div></figure><p id="b3f5" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">3.取消勾选“<strong class="la io"> <em class="me">阻止所有公共访问</em> </strong>”。这不是一个推荐的生产设置，但现在，只是为了了解S3如何工作，让我们解开它。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nf"><img src="../Images/fc27e9a235b775e11806ca45c18f9c3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D0joZ5lfYh6vAEmMoyT0nA.png"/></div></div></figure><p id="3c99" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">4.滚动到底部，点击<strong class="la io"> <em class="me">创建桶</em> </strong>按钮。</p><p id="7652" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">5.它会将您重定向到显示您所有存储桶的页面。从列表中单击您刚刚创建的存储桶名称。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ng"><img src="../Images/75d6b13c04353b0ab2142d970d8ee4f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*prTO1pRSkaTl7s1XKVgPtg.png"/></div></div></figure><p id="0c40" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">7.点击上传按钮，上传一张图片。现在你会在列表中看到上传的图片。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nh"><img src="../Images/ed334786db40a166a7f3c386651041ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xUL3aDP_Pvt3DYhzvzCH6Q.png"/></div></div></figure><p id="d518" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">8.点击列表中的图片项，在下一页，您会发现“<strong class="la io"> <em class="me">对象URL </em> </strong>”。这将是图像url，通过它您可以访问您全局上传的图像。</p><p id="4969" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在我的例子中，对象url是<a class="ae jz" href="https://my-unique-test-bucket-123.s3.us-east-2.amazonaws.com/daniel-norin-lBhhnhndpE0-unsplash.jpg" rel="noopener ugc nofollow" target="_blank"><strong class="la io">https://my-unique-test-bucket-123 . S3 . us-east-2 . Amazon AWS . com/Daniel-norin-lbhhnhndpe 0-unsplash . jpg</strong></a></p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ni"><img src="../Images/4091ba77ffcc98fd51baba6611f51516.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gz0mHMrfYaj7h5IVUzKWOw.png"/></div></div></figure><p id="432b" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">有效吗？？我想不会。别担心。我们需要添加“<strong class="la io"><em class="me"/></strong>”的斗策。</p><p id="1bff" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">9.点击权限。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/461bdda5049a54e8fb6e9133effc71ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*_9CYFo0M5y50U0W4ikeE_Q.png"/></div></figure><p id="d82d" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">10.在<strong class="la io"> <em class="me">下屏蔽公共访问(桶设置)</em> </strong>点击<strong class="la io">编辑</strong>按钮，取消勾选<strong class="la io"> <em class="me">屏蔽所有公共访问</em> </strong>。根据您的要求，您可以勾选/取消勾选选项，但现在取消勾选所有选项，如下所示并保存。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/085c9606e7c5c7c0a0e7f215be119ec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RJjK-qMxYp-iN6r4RuqncQ.png"/></div></div></figure><p id="61e5" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">11.在“permissions”选项卡中，向下滚动到“<strong class="la io"> <em class="me"> Bucket policy </em> </strong>”，单击“<strong class="la io"> <em class="me"> Edit </em> </strong>”按钮，向其中添加以下代码，然后单击“save”。</p><pre class="mx my mz na gt nl nm nn no aw np bi"><span id="0572" class="nq kb in nm b gy nr ns l nt nu">{<br/>    "Version": "2008-10-17",<br/>    "Statement": [<br/>s        {<br/>            "Sid": "AllowPublicRead",<br/>            "Effect": "Allow",<br/>            "Principal": {<br/>                "AWS": "*"<br/>            },<br/>            "Action": "s3:GetObject",<br/>            "Resource": "arn:aws:s3:::my-unique-test-bucket-123/*"<br/>        }<br/>    ]<br/>}</span></pre><p id="ab8b" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io">注意:</strong>用您的bucket名称替换上面代码片段中的“my-unique-test-bucket”。</p><p id="3329" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">要了解如何编写存储桶策略，请阅读<a class="ae jz" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies.html" rel="noopener ugc nofollow" target="_blank"> this </a>。现在，我们将简单地使用上面的代码片段。</p><p id="3fc6" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">10.唷，就是它！现在，再次尝试访问图像URL。我的情况是:</p><p id="d72f" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><a class="ae jz" href="https://my-unique-test-bucket-123.s3.us-east-2.amazonaws.com/daniel-norin-lBhhnhndpE0-unsplash.jpg" rel="noopener ugc nofollow" target="_blank"><strong class="la io">https://my-unique-test-bucket-123 . S3 . us-east-2 . amazonaws . com/Daniel-norin-lbhhnhndpe 0-unsplash . jpg</strong></a></p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nv"><img src="../Images/5d6425531c4680f307730205162258aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WDp_D8TgpYaqPsFe6rvwhQ.png"/></div></div></figure><p id="418a" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">耶！起作用了！</p><p id="fee5" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">这个博客到此为止。</p><p id="a869" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">下一篇博客再见，我们将看到如何使用Node.js上传文件、创建和列出buckets及其内容等。</p><p id="bd4e" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io">第二部分的链接</strong></p><div class="nw nx gp gr ny nz"><a href="https://rugved-bongale.medium.com/using-node-js-s3-to-create-delete-list-buckets-and-upload-list-objects-part-2-fb1b76da36dc" rel="noopener follow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd io gy z fp oe fr fs of fu fw im bi translated">使用Node.js + S3创建、删除、列出存储桶和上传、列出对象—第2部分</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">介绍</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">rugved-bongale.medium.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on jt nz"/></div></div></a></div><h2 id="a889" class="nq kb in bd kc oo op dn kg oq or dp kk lj os ot ko ln ou ov ks lr ow ox kw oy bi translated"><strong class="ak">结论:</strong></h2><p id="9095" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在这篇博客中，我们成功地完成了使用AWS S3所需的最小设置。</p><p id="7ece" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><em class="me">更多内容请看</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="me">plain English . io</em></a></p></div></div>    
</body>
</html>