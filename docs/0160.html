<html>
<head>
<title>Storybook for React — Backgrounds and Globals</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React的故事书—背景和全局</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/storybook-for-react-backgrounds-and-globals-5df687ceba67?source=collection_archive---------9-----------------------#2021-01-09">https://javascript.plainenglish.io/storybook-for-react-backgrounds-and-globals-5df687ceba67?source=collection_archive---------9-----------------------#2021-01-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/afff9335f73224177ba3e5949c3e3e87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lW0RBoOr5aD4eVhF"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@karinalago?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Karina lago</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2c1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Storybook让我们可以用各种参数轻松地构建组件原型。</p><p id="aeb9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将看看如何使用Storybook来处理globals。</p><h1 id="9a3f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">背景</h1><p id="d0fb" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以设置背景工具栏项来添加设置背景的选项。</p><p id="d03e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过在<code class="fe me mf mg mh b">.storybook/preview.js</code>文件中添加选项来实现这一点:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="dedd" class="mq lc iq mh b gy mr ms l mt mu">export const parameters = {<br/>  backgrounds: {<br/>    default: 'twitter',<br/>    values: [<br/>      {<br/>        name: 'twitter',<br/>        value: '#00aced'<br/>      },<br/>      {<br/>        name: 'facebook',<br/>        value: '#3b5998'<br/>      },<br/>    ],<br/>  }<br/>}</span></pre><p id="90a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们设置<code class="fe me mf mg mh b">backgrounds</code>属性来设置背景颜色的选择。</p><p id="9ace" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">values</code>有一系列我们可以设定的选择。</p><p id="9696" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">name</code>是显示在下拉列表中的名称，<code class="fe me mf mg mh b">value</code>是背景颜色值。</p><p id="f1c0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">default</code>是选择要显示的名称。</p><p id="e940" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以选择一组故事。</p><p id="302b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><p id="aa73" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">src/stories/Button.stories.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8988" class="mq lc iq mh b gy mr ms l mt mu">import React from 'react';</span><span id="5118" class="mq lc iq mh b gy mv ms l mt mu">import { Button } from './Button';</span><span id="ae15" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  title: 'Example/Button',<br/>  component: Button,<br/>  argTypes: {<br/>    backgroundColor: { control: 'color' },<br/>  },<br/>  parameters: {<br/>    backgrounds: {<br/>      default: 'twitter',<br/>      values: [<br/>        {<br/>          name: 'twitter',<br/>          value: '#00aced'<br/>        },<br/>        {<br/>          name: 'facebook',<br/>          value: '#3b5998'<br/>        },<br/>      ],<br/>    }<br/>  }<br/>};</span></pre><p id="ff8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在<code class="fe me mf mg mh b">parameters</code>属性内的<code class="fe me mf mg mh b">Button</code>故事集中设置背景颜色。</p><p id="a750" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以只为一个故事设置下拉背景色。</p><p id="abc0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><p id="85ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">src/stories/Button.stories.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3e70" class="mq lc iq mh b gy mr ms l mt mu">import React from 'react';</span><span id="a82c" class="mq lc iq mh b gy mv ms l mt mu">import { Button } from './Button';</span><span id="8369" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  title: 'Example/Button',<br/>  component: Button,<br/>  argTypes: {<br/>    backgroundColor: { control: 'color' },<br/>  },<br/>};</span><span id="fd00" class="mq lc iq mh b gy mv ms l mt mu">const Template = (args) =&gt; &lt;Button {...args} /&gt;;</span><span id="5573" class="mq lc iq mh b gy mv ms l mt mu">export const Primary = Template.bind({});<br/>Primary.args = {<br/>  primary: true,<br/>  label: 'Button',<br/>};</span><span id="6ba9" class="mq lc iq mh b gy mv ms l mt mu">Primary.parameters = {<br/>  backgrounds: {<br/>    default: 'twitter',<br/>    values: [<br/>      {<br/>        name: 'twitter',<br/>        value: '#00aced'<br/>      },<br/>      {<br/>        name: 'facebook',<br/>        value: '#3b5998'<br/>      },<br/>    ],<br/>  }<br/>};</span></pre><p id="9255" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也可以将<code class="fe me mf mg mh b">disable</code>属性设置为<code class="fe me mf mg mh b">true</code>来禁用背景:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4319" class="mq lc iq mh b gy mr ms l mt mu">import React from 'react';</span><span id="fb32" class="mq lc iq mh b gy mv ms l mt mu">import { Button } from './Button';</span><span id="9093" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  title: 'Example/Button',<br/>  component: Button,<br/>  argTypes: {<br/>    backgroundColor: { control: 'color' },<br/>  },<br/>};</span><span id="3bd2" class="mq lc iq mh b gy mv ms l mt mu">const Template = (args) =&gt; &lt;Button {...args} /&gt;;</span><span id="d59e" class="mq lc iq mh b gy mv ms l mt mu">export const Primary = Template.bind({});<br/>Primary.args = {<br/>  primary: true,<br/>  label: 'Button',<br/>};</span><span id="20af" class="mq lc iq mh b gy mv ms l mt mu">Primary.parameters = {<br/>  backgrounds: { disable: true }<br/>};</span></pre><p id="3d52" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们禁用了带有<code class="fe me mf mg mh b">Primary</code>故事的背景下拉菜单。</p><h1 id="3205" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">工具栏和全局</h1><p id="6a35" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以创建自己的故事书工具栏来控制特殊的全局变量。</p><p id="ebd2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">全局变量是对故事呈现的非特定于故事的输入</p><p id="6aeb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们不会作为参数传递到故事中。</p><p id="1f7d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过在<code class="fe me mf mg mh b">.storybook/preview.js</code>文件中放置一些属性来添加我们自己的工具栏:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ed9e" class="mq lc iq mh b gy mr ms l mt mu">export const globalTypes = {<br/>  theme: {<br/>    name: 'Theme',<br/>    description: 'Global theme for components',<br/>    defaultValue: 'light',<br/>    toolbar: {<br/>      icon: 'circlehollow',<br/>      items: ['light', 'dark'],<br/>    },<br/>  },<br/>};</span></pre><p id="6664" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有带有一些属性的<code class="fe me mf mg mh b">theme</code>属性。</p><p id="9b35" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">toolbar</code>属性具有<code class="fe me mf mg mh b">icon</code>属性来设置下拉选项的图标。</p><p id="59ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有一系列可供选择的项目。</p><h1 id="f8c8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建一个装饰器</h1><p id="9777" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用装饰器来消费<code class="fe me mf mg mh b">theme</code>全局。</p><p id="b3d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="0396" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">.storybook/preview.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f1dc" class="mq lc iq mh b gy mr ms l mt mu">import React from 'react';<br/>import { ThemeProvider } from 'styled-components';</span><span id="8c35" class="mq lc iq mh b gy mv ms l mt mu">export const globalTypes = {<br/>  theme: {<br/>    name: 'Theme',<br/>    description: 'Global theme for components',<br/>    defaultValue: 'palevioletred',<br/>    toolbar: {<br/>      icon: 'circlehollow',<br/>      items: ['palevioletred', 'white'],<br/>    },<br/>  },<br/>};</span><span id="36de" class="mq lc iq mh b gy mv ms l mt mu">const withThemeProvider = (Story, context) =&gt; {<br/>  return (<br/>    &lt;ThemeProvider theme={{ main: context.globals.theme }}&gt;<br/>      &lt;Story {...context} /&gt;<br/>    &lt;/ThemeProvider&gt;<br/>  )<br/>}<br/>export const decorators = [withThemeProvider];</span></pre><p id="6f76" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">toolbar</code>属性添加了一些主题选择。</p><p id="dd26" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">context.globals.theme</code>属性得到选择的值。</p><p id="78a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">ThemeProvider</code>包装了<code class="fe me mf mg mh b">Story</code>组件，也就是我们在故事中显示的任何组件。</p><p id="c63c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们导出我们创建的<code class="fe me mf mg mh b">withThemeProvider</code>,放入一个数组中。</p><p id="4562" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以通过从下拉菜单中选择来设置主题。</p><h1 id="d749" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="4ac2" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以为背景添加选项，并设置装饰者使用的全局变量。</p><p id="d989" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>