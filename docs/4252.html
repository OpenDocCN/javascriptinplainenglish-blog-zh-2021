<html>
<head>
<title>The Battle of Express.js Templating Engines — Which One Is the Fastest?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Express.js模板引擎之战——哪个最快？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/handlebars-eta-ejs-1623a6140e56?source=collection_archive---------2-----------------------#2021-08-24">https://javascript.plainenglish.io/handlebars-eta-ejs-1623a6140e56?source=collection_archive---------2-----------------------#2021-08-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2ab2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">车把vs埃塔vs. Eta</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/91e5f27219beaf1fdade71527a0044e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fVs0Wh9J6HNK8UTh-8mzGQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: the author</figcaption></figure><p id="6b3b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们不断地比较JavaScript框架。但是Node.js模板语言呢？是的，那些帮助我们在服务器上呈现HTML的东西——像手柄或EJS这样的模板语言。</p><p id="759d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了做一个小小的比较，我找出了我能找到的最相关的——首先，把手和EJS，这可能是最常用的模板引擎，尤其是对于Express。</p><p id="99b4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">作为挑战者，我选择了Eta，它号称是最快的模板引擎之一。所以，我们走吧！</p><h1 id="d656" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">比较</h1><p id="df5b" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">为了比较模板引擎，我用这三个引擎构建了同一个小网站。然后，我运行一个HTTP基准测试，它向所有三个应用程序发出大量HTTP请求，并列出每个模板引擎可以处理的请求数量。</p><p id="01c0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最初，我希望模板引擎对我们从Express实例传递的数字执行数学运算，如下所示:</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="ef5d" class="mt ls iq mp b gy mu mv l mw mx"><em class="my">&lt;% it.numbers.forEach(function(number){ %&gt;<br/>  &lt;li&gt;&lt;%= number * 100%&gt; &lt;/li&gt;<br/>&lt;% }) %&gt;</em></span></pre><p id="61ea" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，Handlebars不允许您直接在模板中运行像加减这样的操作。</p><p id="f722" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，所有模板将呈现的是一个小的条目列表，通过我们从Express传递给模板的数组来呈现:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/7a3581efa0da2b6c750393fb6850bb77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rCQcXjArZ9-VaYjqMsyOsw.png"/></div></div></figure><p id="9c28" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们来看看每个模板:</p><p id="51da" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">车把模板:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="13e4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Eta模板:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="47a3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">EJS模板:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="c75e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如你所见，埃塔和EJS使用几乎相同的代码。事实上，相同的语法。</p><p id="f2e9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们对所有模板进行基准测试！</p><h1 id="80b3" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">基准测试结果</h1><p id="e87f" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">对于所有不同的模板引擎，我运行了几次HTTP基准测试。我收集了所有结果，以下是平均结果:</p><h2 id="eec2" class="mt ls iq bd lt nc nd dn lx ne nf dp mb le ng nh md li ni nj mf lm nk nl mh nm bi translated">把手</h2><p id="2112" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">每秒请求数:2618 <br/>请求延迟:149毫秒</p><h2 id="675f" class="mt ls iq bd lt nc nd dn lx ne nf dp mb le ng nh md li ni nj mf lm nk nl mh nm bi translated">希腊语字母的第七字</h2><p id="d4f1" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">每秒请求数:4396 <br/>请求延迟:90毫秒</p><h2 id="e8b0" class="mt ls iq bd lt nc nd dn lx ne nf dp mb le ng nh md li ni nj mf lm nk nl mh nm bi translated">EJS</h2><p id="d6e7" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">每秒请求数:4258 <br/>请求延迟:92毫秒</p><p id="eeff" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我非常震惊。埃塔和EJS都拆除了车把。由于Eta号称是最快的模板引擎，它甚至比EJS还快。所以，我们的赢家很明显。</p><p id="f730" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是在这种情况下使用模板引擎有意义吗？</p><h2 id="a432" class="mt ls iq bd lt nc nd dn lx ne nf dp mb le ng nh md li ni nj mf lm nk nl mh nm bi translated">让普通的JavaScript来完成这项工作。</h2><p id="5cbb" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">不要误解我的意思，服务器端的模板引擎很棒，也有它们的用途。然而，对于这样一个最小的用例，比如基于一组数字呈现一个列表HTML-list，我们可以使用其他的东西:Vanilla JS。</p><p id="f302" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如许多人没有意识到的那样，我们有很大的能力自己编写逻辑驱动的模板。这里不是让模板引擎来完成这项工作，而是用JavaScript来呈现数字列表:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="7207" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这样，我们得到的HTML列表与我们之前使用的模板引擎得到的相同。那么，性能呢？</p><p id="329f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">嗯，香草JS，谁会想到它，击败了模板引擎的sh*t:</p><p id="7c62" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">每秒请求数:9623 <br/>请求延迟:41.27毫秒</p><h1 id="38c2" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">我们从中学到了什么？</h1><p id="1fbd" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">让我们总结一下我们的主要经验:</p><ol class=""><li id="0717" class="nn no iq kx b ky kz lb lc le np li nq lm nr lq ns nt nu nv bi translated">Handlebars不允许你运行模板内的数学表达式。</li><li id="4bd9" class="nn no iq kx b ky nw lb nx le ny li nz lm oa lq ns nt nu nv bi translated">埃塔比EJS和车把快。</li><li id="07a0" class="nn no iq kx b ky nw lb nx le ny li nz lm oa lq ns nt nu nv bi translated">普通JS比模板引擎快得多。我从来没想过性能差别会这么大。因此，对于需要在服务器上渲染/计算的较小模板，用普通JS编写代码更有意义——至少在性能方面。</li></ol><p id="500c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢您的阅读！</p><p id="3828" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Node.js世界中的更多比较:</p><div class="ob oc gp gr od oe"><a rel="noopener  ugc nofollow" target="_blank" href="/fastify-express-benchmark-4c4aebb726d6"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd ir gy z fp oj fr fs ok fu fw ip bi translated">我用Fastify，Express &amp; Bare Node.js构建了相同的API，区别如下。</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">让我们看看Fastify快了多少</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="on l"><div class="oo l op oq or on os kp oe"/></div></div></a></div><div class="ob oc gp gr od oe"><a rel="noopener  ugc nofollow" target="_blank" href="/i-built-the-same-api-with-without-express-here-are-the-differences-83bbeb7ddad"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd ir gy z fp oj fr fs ok fu fw ip bi translated">我用&amp;不用Express构建了相同的API。以下是不同之处。</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">运行了一个基准测试</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="on l"><div class="ot l op oq or on os kp oe"/></div></div></a></div><p id="63ab" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="my">更多内容看</em><a class="ae ou" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="my">plain English . io</em></strong></a></p></div></div>    
</body>
</html>