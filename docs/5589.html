<html>
<head>
<title>Use Google Sheets as a CMS or Database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用谷歌工作表作为CMS或数据库</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-google-sheets-as-a-cms-or-database-5303f706d30f?source=collection_archive---------1-----------------------#2021-11-22">https://javascript.plainenglish.io/how-to-use-google-sheets-as-a-cms-or-database-5303f706d30f?source=collection_archive---------1-----------------------#2021-11-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="be01" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Web组件和Google Sheets作为CMS来构建您的个人简历体验网站</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/54fe1c414408c9c1a069aeffba07ae00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VIuUxTLAg1RdEsUUadU68g.png"/></div></div></figure><p id="6f92" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">本文将向您展示如何构建一个web应用程序，用Google Sheets提供的数据显示CV体验时间线。我将向你展示如何通过参考你自己的谷歌电子表格快速建立你的个人简历网站。之后，我将指导您实现Google Sheets API，并向您展示我如何使用Web组件设置前端。</p><p id="063a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae ln" href="https://mariusbongarts.github.io/cv-experience/?id=1SjV3Ho0_EV7oxyf9Mz_JjQJ77CiFRtFR8-YOqi7RJ5s" rel="noopener ugc nofollow" target="_blank">这里</a>可以看到网站的演示。该网站显示了我简历经历的时间表，并在谷歌表单上提供来自这个<a class="ae ln" href="https://docs.google.com/spreadsheets/d/1SjV3Ho0_EV7oxyf9Mz_JjQJ77CiFRtFR8-YOqi7RJ5s/edit#gid=0" rel="noopener ugc nofollow" target="_blank">电子表格</a>的数据。稍后，您将创建一个新的电子表格，并将其链接到应用程序以显示您自己的体验。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="1da9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我进入指南之前，我想解释为什么使用Google Sheets作为内容管理系统(CMS)或数据库可能是有用的。Google Sheets非常简单易懂。拥有谷歌账户的每个人都可以轻松地从谷歌表单中创建和编辑数据。不仅如此，您还可以与其他人共享电子表格。我不想说它将取代数据库或CMS，但它是快速建立一个易于配置的网站或web应用程序的一个很好的方法。</p><p id="6719" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以，事不宜迟，让我们开始设置您的可配置简历网站。</p><div class="lv lw gp gr lx ly"><a rel="noopener  ugc nofollow" target="_blank" href="/fun-with-google-sheets-and-javascript-91a2b027ce92"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">使用Google Sheets和JavaScript的乐趣</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">让我们使用Google Apps脚本编辑器来构建一些东西。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm kp ly"/></div></div></a></div></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="fadc" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">设置您的Google Sheets CMS网站</h1><p id="63c9" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">你可以通过4个简单的步骤建立你的网站。你将在两分钟内完成。显然，你需要一个谷歌账户。如果你没有，可能需要5分钟。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h2 id="f6c1" class="nk mo iq bd mp nl nm dn mt nn no dp mx la np nq mz le nr ns nb li nt nu nd nv bi translated">1.克隆Google Sheets电子表格</h2><p id="2190" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">打开这个<a class="ae ln" href="https://docs.google.com/spreadsheets/d/1SjV3Ho0_EV7oxyf9Mz_JjQJ77CiFRtFR8-YOqi7RJ5s/edit#gid=0" rel="noopener ugc nofollow" target="_blank">链接</a>，进入我的电子表格。这是为我们的网站提供数据的模板。目前，您只能查看但不能编辑工作表，因为我只授予了查看权限。这就是为什么你需要复制一份来生成你的个人电子表格。点击<strong class="kt ir">文件</strong>-&gt;-<strong class="kt ir">制作副本</strong>即可。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/9aa374a4df68c12e43f6d0f6572211c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A1Zz3RWzzsibCfbi5oKCbA.png"/></div></div></figure></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h2 id="c9ea" class="nk mo iq bd mp nl nm dn mt nn no dp mx la np nq mz le nr ns nb li nt nu nd nv bi translated">2.调整数据</h2><p id="3dd5" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">因为您已经创建了模板的副本，所以现在可以调整您的数据。注意，该模板包含两张表:<strong class="kt ir">体验</strong>和<strong class="kt ir">设计</strong>。在第一页，你可以加上你的个人经历。第二个可以改变网站的颜色。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h2 id="8b85" class="nk mo iq bd mp nl nm dn mt nn no dp mx la np nq mz le nr ns nb li nt nu nd nv bi translated">3.共享您的电子表格</h2><p id="2328" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">接下来，您需要共享您的电子表格并使其公开。你可以通过点击<strong class="kt ir">分享- &gt;链接</strong>更改为任何人。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/4cca30891d57629307b9c718dc70f43a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nKThUmbGm7mTFbEZk2CglA.png"/></div></div></figure><p id="3682" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，互联网上的任何人都可以查看您的电子表格。确保你只授予<strong class="kt ir">观看</strong>的权利。否则，任何人都可以改变你网站的数据。现在，您可以复制如下所示的可共享链接:</p><blockquote class="ny nz oa"><p id="21f6" class="kr ks ob kt b ku kv jr kw kx ky ju kz oc lb lc ld od lf lg lh oe lj lk ll lm ij bi translated">https://docs.google.com/spreadsheets/d/<strong class="kt ir">1 sjv 3 ho 0 _ ev 7 oxy F9 mz _ jjqj 77 cif rtfr 8-yoqi 7 rj 5s</strong>/编辑？usp =共享</p></blockquote><p id="6a3b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">只复制中间的<strong class="kt ir">粗体</strong>部分，这是我们的<strong class="kt ir">电子表格id </strong>。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h2 id="0b4b" class="nk mo iq bd mp nl nm dn mt nn no dp mx la np nq mz le nr ns nb li nt nu nd nv bi translated">4.将您的电子表格连接到网站</h2><p id="b7ae" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">有两种方法可以将您的电子表格连接到网站。第一个解决方案是将我们的电子表格id作为查询参数传递给我们的演示网站。第二种选择是直接使用前端web应用程序的web组件。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="3c2f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">传递查询参数</strong></p><p id="a430" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们将电子表格id作为查询参数传递，以将其连接到演示网站。下面是一个引用我的谷歌电子表格的链接示例:</p><blockquote class="ny nz oa"><p id="524d" class="kr ks ob kt b ku kv jr kw kx ky ju kz oc lb lc ld od lf lg lh oe lj lk ll lm ij bi translated"><a class="ae ln" href="https://mariusbongarts.github.io/cv-experience/?id=1SjV3Ho0_EV7oxyf9Mz_JjQJ77CiFRtFR8-YOqi7RJ5s" rel="noopener ugc nofollow" target="_blank"><em class="iq">https://mariusbongarts.github.io/cv-experience/?id=</em><strong class="kt ir"><em class="iq">1 sjv 3 ho 0 _ ev 7 oxy F9 mz _ jjqj 77 cifr TFR 8-yoqi 7 rj 5s</em></strong></a></p></blockquote><p id="bba3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您只需将id替换为您的id:</p><blockquote class="ny nz oa"><p id="2a73" class="kr ks ob kt b ku kv jr kw kx ky ju kz oc lb lc ld od lf lg lh oe lj lk ll lm ij bi translated">https://mariusbongarts.github.io/cv-experience/?你的扩展页面ID </p></blockquote><p id="3d5f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就这样。你现在应该可以看到你的个人简历经历网站了。每当您对Google电子表格进行更改时，只要您刷新页面，就可以看到这些更改应用到网站上。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="9205" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">使用web组件</strong></p><p id="5cfe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因为我们的演示网站只是呈现一个web组件，所以我们也可以将它传递到任何地方。web组件的一个显著优点是，您可以在每个Web应用程序和网页中重用它们。这种易于重用的特性使得它完全独立于特定的前端框架，如Angular、React或Vuejs。</p><p id="16ac" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您唯一需要做的就是将这段代码片段传递给任何HTML:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="413e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这个<a class="ae ln" href="https://codepen.io/marius2502/pen/KKvxvJe" rel="noopener ugc nofollow" target="_blank">密码栏</a>中检查一下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh og l"/></div><figcaption class="oi oj gj gh gi ok ol bd b be z dk">Web Component Demo</figcaption></figure><p id="9407" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这不是很棒吗？我是Web组件的超级粉丝。如果您有兴趣了解更多，请查看我的其他文章:</p><div class="lv lw gp gr lx ly"><a rel="noopener  ugc nofollow" target="_blank" href="/will-web-components-replace-frontend-frameworks-535891d779ba"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">Web组件会取代前端框架吗？</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">它们是为解决不同的问题而构建的。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="mh l"><div class="om l mj mk ml mh mm kp ly"/></div></div></a></div><div class="lv lw gp gr lx ly"><a rel="noopener  ugc nofollow" target="_blank" href="/the-complete-web-component-guide-part-1-custom-elements-a627af805df8"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">完整的Web组件指南:自定义元素</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">成为Web开发未来的专家(第1部分)</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="mh l"><div class="on l mj mk ml mh mm kp ly"/></div></div></a></div><div class="lv lw gp gr lx ly"><a href="https://medium.com/@mariusbongarts11/showcase-your-medium-articles-with-web-components-part-1-basics-d2c6618e9482" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">用Web组件构建自己的博客组合:基础</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">第1部分—定制元素、阴影DOM和HTML模板</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">medium.com</p></div></div><div class="mh l"><div class="oo l mj mk ml mh mm kp ly"/></div></div></a></div></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="0ab8" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">履行</h1><p id="c9bc" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">我希望我能让你相信，在某些用例中，Google Sheets是CMS或数据库的一个很好且简单的替代方案。现在，我想向您展示我是如何处理实现的。首先，我将向您展示如何设置前端。之后，我们将查看负责使用Google Sheets API提供正确数据格式的服务器的实现。</p><h2 id="0edb" class="nk mo iq bd mp nl nm dn mt nn no dp mx la np nq mz le nr ns nb li nt nu nd nv bi translated">设置前端</h2><p id="e747" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">正如我所说的，我正在使用Web组件。当然，你也可以使用任何你选择的前端框架/库，比如React、Angular或VueJs。</p><p id="7c48" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我正在使用<a class="ae ln" href="https://medium.com/@mariusbongarts11/build-your-own-blog-portfolio-with-web-components-lit-library-2701dffc735f" rel="noopener"> Lit </a>库来简化Web组件的开发。让我们来看看根<code class="fe op oq or os b">cv-experience</code>自定义元素:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="0fca" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我们的<code class="fe op oq or os b">firstUpdated</code>生命周期方法中，我们正在获取一个<code class="fe op oq or os b">Config</code>对象，它是从我们的服务器获得的。这个对象包含一个<code class="fe op oq or os b">Experience</code>对象的数组。每个条目都是电子表格的体验表中的一行。此外，它还包含一个<code class="fe op oq or os b">Design</code>对象数组，用于定制应用程序的颜色。</p><p id="d907" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">看看相应的界面:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="dbbf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">也许你已经注意到了,<code class="fe op oq or os b">Experience</code>界面的每个键代表我们电子表格中的一列。</p><p id="d135" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我们的<code class="fe op oq or os b">render()</code>函数中，您可以看到我们正在为每个体验对象呈现一个<code class="fe op oq or os b">experience-content</code>定制元素。</p><p id="c634" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我们继续实现我们的服务器之前，让我们看一下<code class="fe op oq or os b">experience-content</code>定制元素的代码。该组件负责在Google Sheet电子表格中显示我们的每一行经验:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="7505" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里是前端的<a class="ae ln" href="https://github.com/MariusBongarts/cv-experience" rel="noopener ugc nofollow" target="_blank"> Github库</a>。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h2 id="20a1" class="nk mo iq bd mp nl nm dn mt nn no dp mx la np nq mz le nr ns nb li nt nu nd nv bi translated">使用Google Sheets API</h2><p id="b535" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">Google Sheets API是一个RESTful接口，允许您用自己喜欢的编程语言读取和修改电子表格的数据。以下是该API最常见的用法:</p><ul class=""><li id="4019" class="ot ou iq kt b ku kv kx ky la ov le ow li ox lm oy oz pa pb bi translated">创建电子表格</li><li id="b972" class="ot ou iq kt b ku pc kx pd la pe le pf li pg lm oy oz pa pb bi translated">读取和写入电子表格单元格值</li><li id="1706" class="ot ou iq kt b ku pc kx pd la pe le pf li pg lm oy oz pa pb bi translated">更新电子表格格式</li><li id="2b10" class="ot ou iq kt b ku pc kx pd la pe le pf li pg lm oy oz pa pb bi translated">管理连接的工作表</li></ul><p id="003b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于我们的目的，执行读取操作就足够了，这使得一切都更易于管理，因为我们不需要交换OAuth令牌。我们需要提前做的唯一事情是获得一个API密钥。</p><blockquote class="ny nz oa"><p id="21e3" class="kr ks ob kt b ku kv jr kw kx ky ju kz oc lb lc ld od lf lg lh oe lj lk ll lm ij bi translated">“有两种方法可以识别您的应用程序:使用OAuth 2.0令牌(它也授权请求)和/或使用应用程序的API密钥。”— <a class="ae ln" href="https://developers.google.com/sheets/api/guides/authorizing" rel="noopener ugc nofollow" target="_blank"> developers.google </a></p></blockquote><p id="841b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">遵循本<a class="ae ln" href="https://developers.google.com/sheets/api/guides/authorizing#APIKey" rel="noopener ugc nofollow" target="_blank">指南</a>获取和使用API密钥。下一步，我们将使用API键从电子表格中读取一些数据。你可以在<a class="ae ln" href="https://developers.google.com/sheets/api/samples/reading" rel="noopener ugc nofollow" target="_blank">谷歌的文档</a>中了解基本的阅读操作。</p><p id="d013" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是一个关于如何使用Google Sheets API从Google电子表格中读取数据的示例请求:</p><pre class="kg kh ki kj gt ph os pi pj aw pk bi"><span id="6802" class="nk mo iq os b gy pl pm l pn po">GET https://sheets.googleapis.com/v4/spreadsheets/<strong class="os ir">YOUR_SPREADSHEET_ID</strong>/values/Sheet1?key=<strong class="os ir">YOUR_API_KEY</strong></span></pre><p id="ce37" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我们的例子中，我们需要一张以上的数据(<strong class="kt ir"> <em class="ob">经验</em> </strong>和<strong class="kt ir"> <em class="ob">设计</em> </strong>)。这就是为什么我们使用一个<code class="fe op oq or os b">batchGet</code>来利用多个范围。因此，我们的请求看起来像这样:</p><pre class="kg kh ki kj gt ph os pi pj aw pk bi"><span id="7d3e" class="nk mo iq os b gy pl pm l pn po">GET https://sheets.googleapis.com/v4/spreadsheets/<strong class="os ir">YOUR_SPREADSHEET_ID</strong>/values:batchGet?ranges=<strong class="os ir">experiences</strong>&amp;ranges=<strong class="os ir">design</strong>&amp;key=<strong class="os ir">YOUR_API_KEY</strong></span></pre><p id="6acf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对该方法调用的响应是一个包含描述范围值的一组<code class="fe op oq or os b"><a class="ae ln" href="https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values#resource-valuerange" rel="noopener ugc nofollow" target="_blank">ValueRange</a></code>对象的对象:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pp"><img src="../Images/9f1dd17d0960ef273fc60b3aa10f497b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hwrt4oJ-_gn8eHeUXsH7fg.png"/></div></div><figcaption class="oi oj gj gh gi ok ol bd b be z dk">Example result of Google Sheets API</figcaption></figure><p id="3820" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下一步是将这些数据映射到我们前端期望的格式——之前的<code class="fe op oq or os b">Config</code>接口。</p><p id="1186" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为此，我们需要一台服务器来准备我们的数据并安全地存储我们的API密钥。我们不应该在我们的前端存储API密钥！</p><p id="bed1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为此，我使用Netlify创建了一个无服务器lambda函数。但是当然，您也可以使用express或任何其他服务器来设置NodeJs服务器。下面是我的lambda函数的类型脚本代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="ff1b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我创建了一个<code class="fe op oq or os b">fetchGoogleSheetData(params)</code>函数，使用API键从Google Sheets API中获取数据，这个数据是从环境中读取的。之后，<code class="fe op oq or os b">valueRangesToObject(data)</code>方法负责将数据映射到<code class="fe op oq or os b">Config</code>接口。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="52e3" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">最后的想法</h1><p id="aaab" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">使用Google Sheets作为CMS或数据库对每个人来说都是一个简单易用的解决方案。与web组件或任何其他前端框架/库(如React、Angular或VueJs)相结合，这是一种快速设置易于配置的Web应用程序的好方法。</p><p id="28ca" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我希望你喜欢阅读这篇文章！我总是很乐意回答问题，也乐于接受批评。请随时联系我😊</p><p id="fe96" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">关注我，不要错过我的下一篇文章。我写了关于Typescript、Web组件、前端框架、软件设计模式、Chrome扩展以及更多的主题！🙏</p><p id="6b22" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae ln" href="https://medium.com/@mariusbongarts/membership" rel="noopener"> <strong class="kt ir">这里是无限制访问媒体</strong> </a>上每一个内容的链接。如果你用这个链接注册，我会赚一小笔钱，不需要你额外付费。</p><div class="lv lw gp gr lx ly"><a href="https://medium.com/@mariusbongarts/membership" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">通过我的推荐链接加入Medium-Marius bong arts</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">medium.com</p></div></div><div class="mh l"><div class="pq l mj mk ml mh mm kp ly"/></div></div></a></div></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="685b" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">关于作者</h1><p id="2f44" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">Marius Bongarts是埃森哲互动公司的软件工程分析师。他还创建了<a class="ae ln" href="https://chrome.google.com/webstore/detail/web-highlights-+-bookmark/hldjnlbobkdkghfidgoecgmklcemanhm" rel="noopener ugc nofollow" target="_blank"> Web Highlights扩展</a>，允许用户在标签和目录的帮助下组织文本亮点和书签。</p><p id="5869" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通过<strong class="kt ir"/><a class="ae ln" href="https://www.linkedin.com/in/marius-bongarts-6b3638171/" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir">LinkedIn</strong></a><strong class="kt ir">与我联系。</strong></p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><div class="kg kh ki kj gt ly"><a rel="noopener  ugc nofollow" target="_blank" href="/5-skills-you-dont-get-around-to-learn-as-a-fullstack-developer-409f13c394c7"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">作为全栈开发人员，你应该马上学会的5项技能</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">现在就学习吧，你会后悔错过的</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="mh l"><div class="pr l mj mk ml mh mm kp ly"/></div></div></a></div><div class="lv lw gp gr lx ly"><a rel="noopener  ugc nofollow" target="_blank" href="/when-you-should-duplicate-code-b0d747bc1c67"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">何时应该复制代码</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">复制比错误的抽象要便宜得多</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="mh l"><div class="ps l mj mk ml mh mm kp ly"/></div></div></a></div><div class="lv lw gp gr lx ly"><a rel="noopener  ugc nofollow" target="_blank" href="/design-patterns-with-typescript-examples-factory-method-4d145887b141"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">带有类型脚本示例的设计模式:工厂方法</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">工厂方法有助于编程接口，而不是实现。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="mh l"><div class="pt l mj mk ml mh mm kp ly"/></div></div></a></div><p id="3e78" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ob">更多内容请看</em><a class="ae ln" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="ob">plain English . io</em></a><em class="ob">。报名参加我们的</em> <a class="ae ln" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="ob">免费周报在这里</em> </a> <em class="ob">。</em></p></div></div>    
</body>
</html>