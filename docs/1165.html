<html>
<head>
<title>Comparing 5 Different Node.js Logging Libraries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">比较5个不同的Node.js日志库</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/nodejs-logging-library-17932e06695a?source=collection_archive---------8-----------------------#2021-03-11">https://javascript.plainenglish.io/nodejs-logging-library-17932e06695a?source=collection_archive---------8-----------------------#2021-03-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/12e013a3cca24104a9acbe1f59fe6583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U_uWSICxfZUVnk9WobdZqA.jpeg"/></div></div></figure><p id="dabe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最佳日志Node.js日志库可以让您对应用程序的工作方式有前所未有的了解。拥有适当的日志记录就相当于在一个空间中拥有一个强大的望远镜，上面有您所有的应用程序。</p><p id="ba01" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您是否希望能够看到您的应用程序在生产负载下的行为？在这篇文章中，我们将分析5个流行的Node.js日志库，它们可以很容易地帮你完成这项工作。</p><h1 id="1582" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">目录</h1><p id="9056" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><a class="ae lz" href="#3717" rel="noopener ugc nofollow">假设</a> <br/> <a class="ae lz" href="#26bd" rel="noopener ugc nofollow"> Node.js日志库评估</a> <br/> ∘ <a class="ae lz" href="#683c" rel="noopener ugc nofollow">温斯顿</a> <br/> ∘ <a class="ae lz" href="#6c62" rel="noopener ugc nofollow">班扬为Node.js日志库</a><br/>∘<a class="ae lz" href="#ceaa" rel="noopener ugc nofollow">Pino</a><br/>∘<a class="ae lz" href="#d77f" rel="noopener ugc nofollow">log level</a><br/>∘<a class="ae lz" href="#6b0c" rel="noopener ugc nofollow">npmlog</a><br/><a class="ae lz" href="#7d84" rel="noopener ugc nofollow">node . js日志库的快速对比</a> <br/> <a class="ae lz" href="#408c" rel="noopener ugc nofollow">结论【T26</a></p><h1 id="3717" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">假设</h1><ol class=""><li id="59bb" class="ma mb iq ka b kb lu kf lv kj mc kn md kr me kv mf mg mh mi bi translated">您熟悉Node.js的工作方式，并且可以在本地运行Node</li><li id="6a6a" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">您可以安装npm库，并对package.json和npm CLI有基本的了解</li></ol><p id="024b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我们将使用Express.js作为一个示例应用程序，来查看将所有Node.js日志库的日志写入控制台的代码示例。</p><h1 id="26bd" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">要评估的Node.js日志库</h1><p id="c3ae" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">在本文中，我们将评估NPM上5个流行的Node.js日志库。它们每周都被下载超过一百万次，所以它们非常受欢迎。我们开始吧！</p><h2 id="683c" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">1.温斯顿</h2><p id="7d70" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">Winston是一个流行的日志库。它被设计得很简单，支持多种<code class="fe na nb nc nd b">transports</code>的通用日志。Winston将自己定义为“几乎所有事情的记录者”。</p><p id="b9f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过Winston，我们可以将您的日志路由到其他服务，如<a class="ae lz" href="https://www.npmjs.com/package/winston-cloudwatch" rel="noopener ugc nofollow" target="_blank"> AWS cloud watch </a>、<a class="ae lz" href="https://www.npmjs.com/package/@eximius/winston-graylog2" rel="noopener ugc nofollow" target="_blank"> graylog2 </a>、<a class="ae lz" href="https://www.npmjs.com/package/winston-logzio" rel="noopener ugc nofollow" target="_blank"> logz.io </a>，甚至<a class="ae lz" href="https://www.npmjs.com/package/winston-logsene" rel="noopener ugc nofollow" target="_blank"> Sematext Logsene </a>。我们甚至可以添加express中间件，让Winston更好地使用Express 记录日志。</p><p id="1011" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是Winston with Express使用<a class="ae lz" href="https://github.com/bithavoc/express-winston" rel="noopener ugc nofollow" target="_blank"> express-winston中间件</a>的代码示例:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="ebe6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们用<code class="fe na nb nc nd b">node winston.js</code>运行服务器并在浏览器上点击<code class="fe na nb nc nd b">http://localhost:3001/test/api</code>时，它会给出如下输出:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="88db" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上述代码也可作为<a class="ae lz" href="https://github.com/geshan/nodejs-logging/pull/2/files" rel="noopener ugc nofollow" target="_blank">拉取请求</a>使用。</p><h2 id="6c62" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">2.Node.js日志记录的Bunyan</h2><p id="5ae2" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><a class="ae lz" href="https://www.npmjs.com/package/bunyan" rel="noopener ugc nofollow" target="_blank"> Bunyan </a>是另一个著名的Node.js日志库。班扬由<a class="ae lz" href="https://www.joyent.com/node-js/production/modules" rel="noopener ugc nofollow" target="_blank"> Joyent </a>在生产中使用。它将自己定义为一个用于Node.js服务的简单快速的JSON日志库。</p><p id="c346" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">班扬主张日志应该是JSON格式的。它的特性包括一个用于漂亮打印的CLI，序列化器，以及除了Node.js之外对多运行时的支持，如Webpack和Browserify。</p><p id="46ab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是使用<a class="ae lz" href="https://github.com/villadora/express-bunyan-logger" rel="noopener ugc nofollow" target="_blank">快速班扬记录器</a>的快速班扬代码示例:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="1147" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们用<code class="fe na nb nc nd b">node bunyan.js</code>执行代码并点击浏览器上的<code class="fe na nb nc nd b">http://localhost:3002/test/api</code>时，它将显示如下输出:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="ef74" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">默认情况下，Bunyan的日志非常详细。</p><p id="c8ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上述代码也可作为<a class="ae lz" href="https://github.com/geshan/nodejs-logging/pull/3/files" rel="noopener ugc nofollow" target="_blank">拉取请求</a>使用。</p><h2 id="ceaa" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">3.皮诺</h2><p id="2121" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><a class="ae lz" href="https://www.npmjs.com/package/pino" rel="noopener ugc nofollow" target="_blank"> Pino </a>是一个相对流行的Node.js日志库，它将自己标记为“开销非常低的Node.js日志记录器”。它将异步日志记录归功于它的快速性能。在其<a class="ae lz" href="https://github.com/pinojs/pino/blob/master/docs/benchmarks.md" rel="noopener ugc nofollow" target="_blank">基准测试</a>中，Pino声称在许多情况下比替代产品快5倍以上。</p><p id="a8f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其他特性包括<a class="ae lz" href="https://github.com/pinojs/pino/blob/master/docs/child-loggers.md" rel="noopener ugc nofollow" target="_blank">子记录器</a>和<a class="ae lz" href="https://github.com/pinojs/pino/blob/master/docs/web.md" rel="noopener ugc nofollow" target="_blank">对多个web框架的支持</a>。它有多个核心和社区模块，这有助于形成一个繁荣的<a class="ae lz" href="https://github.com/pinojs/pino/blob/master/docs/ecosystem.md" rel="noopener ugc nofollow" target="_blank">生态系统</a>。使用Pino，您可以通过使用适当的传输方式将日志发送到许多服务，如<a class="ae lz" href="https://github.com/pinojs/pino/blob/master/docs/transports.md#pino-mysql" rel="noopener ugc nofollow" target="_blank"> MySQL </a>、<a class="ae lz" href="https://github.com/pinojs/pino/blob/master/docs/transports.md#pino-datadog" rel="noopener ugc nofollow" target="_blank"> Datadog </a>、<a class="ae lz" href="https://github.com/pinojs/pino/blob/master/docs/transports.md#pino-cloudwatch" rel="noopener ugc nofollow" target="_blank"> AWS cloud watch </a>或<a class="ae lz" href="https://github.com/pinojs/pino/blob/master/docs/transports.md#pino-logflare" rel="noopener ugc nofollow" target="_blank"> log flare </a>。</p><p id="b546" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是使用<a class="ae lz" href="https://github.com/pinojs/express-pino-logger" rel="noopener ugc nofollow" target="_blank">快速Pino记录器</a>的快速Pino示例:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="8316" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们用<code class="fe na nb nc nd b">node pino.js</code>运行服务器并在浏览器上点击<code class="fe na nb nc nd b">http://localhost:3003/test/api</code>时，它将发出如下输出:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="c554" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与Bunyan类似，Pino的默认日志也很详细。我们可以使用pino-pretty  CLI来让原木变得更漂亮。</p><p id="4872" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">代码示例可以作为<a class="ae lz" href="https://github.com/geshan/nodejs-logging/pull/4/files" rel="noopener ugc nofollow" target="_blank">拉请求</a>来访问。</p><h2 id="d77f" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">4.Loglevel</h2><p id="870a" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">Loglevel是一个非常流行的日志库，可以在Node.js和浏览器中使用。LogLevel将自己定义为“JavaScript的最小轻量级简单日志记录”它还声称要取代console.log，消除console.log的缺点。</p><p id="db5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Loglevel似乎很容易使用，也很方便。它的自述文件补充道:“这是一个基本可靠的日常日志库。”它不做花哨的事情，但有您实际使用的核心功能。</p><p id="e474" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是一个非常简单的Loglevel的例子，有一个Express服务器，没有中间件:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="d780" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们用<code class="fe na nb nc nd b">node loglevel.js</code>运行执行上述代码并点击浏览器上的<code class="fe na nb nc nd b">http://localhost:3004/test/api</code>时，它将显示如下输出:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="30e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与其他库相比，Loglevel输出非常简单。此外，我们没有使用任何特定于express的中间件来使用Loglevel登录。</p><p id="5d0f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们也可以将上面的例子作为<a class="ae lz" href="https://github.com/geshan/nodejs-logging/pull/5/files" rel="noopener ugc nofollow" target="_blank">拉请求</a>来访问。</p><h2 id="6b0c" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">5.Npmlog</h2><p id="dd6d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><a class="ae lz" href="https://www.npmjs.com/package/npmlog" rel="noopener ugc nofollow" target="_blank"> Npmlog </a>是NPM使用的另一个非常流行的日志库。根据NpmLog的自述文件“这个日志是非常基本的。它为npm进行日志记录。它支持自定义级别和彩色输出。”</p><p id="0ffc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个Node.js日志库并没有什么特别之处，上一个版本是4年前发布的。然而，它是本帖中列出的最受欢迎的日志库。截至2021年1月，唯一一个每周下载量超过1000万的图书馆。</p><p id="f183" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是一个npmlog在Express js和无中间件情况下运行的快速示例:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="66c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们用<code class="fe na nb nc nd b">node npmlog.js</code>启动Express js服务器并点击浏览器上的<code class="fe na nb nc nd b">http://localhost:3005/test/api</code>时，它将显示如下输出:</p><figure class="ne nf ng nh gt jr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="435c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与Loglevel类似，对于npmlog，输出很简单，我们也没有使用任何Express js中间件。</p><p id="a1f2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上述代码也可以作为<a class="ae lz" href="https://github.com/geshan/nodejs-logging/pull/6/files" rel="noopener ugc nofollow" target="_blank">拉请求</a>获得。</p><h1 id="7d84" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">Node.js日志库的快速比较</h1><p id="33cb" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">下面是我们到目前为止讨论的Node.js日志库的快速比较，所有数据都是在2021年1月的最后一周收集的:</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/bc58810f33612b03113ebea65888aed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IXWnzBf_Igjojnpfu0IJoQ.png"/></div></div></figure><p id="25ef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们看看下载趋势，<a class="ae lz" href="https://www.npmtrends.com/winston-vs-bunyan-vs-pino-vs-loglevel-vs-npmlog" rel="noopener ugc nofollow" target="_blank"> NPM趋势</a>描绘了一幅如下图:</p><p id="6396" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">尽管npmlog只有346颗星和53个分叉，但据报道，它每周的下载量超过1000万次。在GitHub恒星方面，温斯顿的恒星数量是第二名班扬的3倍，有513颗恒星。Winston也是创建于2010年12月30日的最古老的图书馆，于2011年1月19日首次发布。</p><p id="2c3f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据<a class="ae lz" href="https://npmcompare.com/compare/bunyan,loglevel,npmlog,pino,winston" rel="noopener ugc nofollow" target="_blank"> npmcompare </a>，Npmlog积分最多，2550万分，Buyan积分最少，290万分。</p><h1 id="408c" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">结论</h1><p id="c0e2" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">为了在Node.js中获得最佳的日志记录和监控体验，最好是选择适合您需求的库，而不是追求数字。</p><blockquote class="nl"><p id="84c7" class="nm nn iq bd no np nq nr ns nt nu kv dk translated">使用最适合你的目的的库，并利用它的插件或特性，使之对你的用例最有意义。</p></blockquote><p id="3796" class="pw-post-body-paragraph jy jz iq ka b kb nv kd ke kf nw kh ki kj nx kl km kn ny kp kq kr nz kt ku kv ij bi translated">如果你遵循一些<a class="ae lz" href="https://geshan.com.np/blog/2019/03/follow-these-logging-best-practices-to-get-the-most-out-of-application-level-logging-slides/" rel="noopener ugc nofollow" target="_blank">日志记录最佳实践</a>来获得最大收益，那也是很棒的，因为它们是<a class="ae lz" href="https://geshan.com.np/blog/2019/11/laracon-au-2019-overall-a-good-experience/" rel="noopener ugc nofollow" target="_blank">软件工程师最好的朋友</a>。很长一段时间以来，我一直在宣扬日志记录的<a class="ae lz" href="https://geshan.com.np/blog/2015/08/importance-of-logging-in-your-applications/" rel="noopener ugc nofollow" target="_blank">重要性，它是可伸缩和弹性应用</a>的<a class="ae lz" href="https://geshan.com.np/blog/2015/10/4-pillars-of-a-solid-software-application-and-tools-to-support-it/#logging-with-monitoring" rel="noopener ugc nofollow" target="_blank"> 4支柱之一。伐木快乐！</a></p></div></div>    
</body>
</html>