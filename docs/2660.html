<html>
<head>
<title>Need to Add Authentication to Your Angular Application?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">需要在Angular应用程序中添加身份验证吗？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/need-to-add-authentication-to-your-angular-application-912c2397f30a?source=collection_archive---------7-----------------------#2021-06-01">https://javascript.plainenglish.io/need-to-add-authentication-to-your-angular-application-912c2397f30a?source=collection_archive---------7-----------------------#2021-06-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1bb8" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">这是用Angular设置登录表单和认证的完整指南。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/abce24c73b3a8b1e82c0a18eeba9e2c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9nG6PGbsIiIlTsaL"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7880" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">棱角分明。</p><p id="b176" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">认证。</p><p id="adf1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">和授权。</p><p id="0a60" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你是怎么做到的？</p><p id="54de" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如何将登录表单添加到Angular应用程序中？</p><p id="bea8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您如何确保未登录的用户自动看到您的登录页面？登录(经过身份验证)的用户会看到仪表板或其他东西吗？</p><p id="5cfd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在本指南中，我将向您展示如何向Angular应用程序添加身份验证。</p><p id="a2d7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为什么？</p><p id="9e5e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因为我想让你成为一个更好的角度开发者。</p><p id="6110" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你能在Angular应用程序中快速添加身份验证功能，你会有什么感觉？或者拼凑一个漂亮的登录表单？或者快速决定你的Angular app哪些部分需要认证，哪些部分不需要认证？</p><p id="d1f5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这就像我们给我们的角度应用添加了一扇门。或者一个密室。只有有钥匙的人才能进去。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/27ebe539543137a113ddef1b14231a25.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*S5UdkdjNvZ6PSyR4.gif"/></div></figure><p id="1544" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">那么，我们开始吧。</p><h1 id="8a32" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">创建我们的角度应用</h1><p id="ccdb" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">在这个演示中，我将创建一个新的Angular应用程序来演示登录和身份验证功能。</p><p id="6313" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">但是，如果你已经有一个角度的应用，然后跳到下一步。我将向您展示如何将登录内容添加到新的Angular应用程序或现有的应用程序中。没关系。</p><p id="f3ce" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，为了创建演示，我们将打开一个终端并使用<a class="ae ks" href="https://danielk.tech/home/how-to-install-and-use-the-angular-cli" rel="noopener ugc nofollow" target="_blank">Angular CLI</a>开始。下面是命令。</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="5847" class="ms lr in mo b gy mt mu l mv mw">ng new angular-authentication-app</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mx"><img src="../Images/2e3c5a583776e0ce9b2b67941a8dc0a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4bzahhJ8DXhi7vc0.png"/></div></div></figure><p id="b279" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是我们全新的角度应用！</p><p id="66e2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在我们开始之前，我们需要清理<code class="fe my mz na mo b">app.component.html</code>文件，并删除CLI生成的所有模板内容。因此，从<code class="fe my mz na mo b">app.component.html</code>文件中删除除这一行之外的所有内容。</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="728f" class="ms lr in mo b gy mt mu l mv mw">&lt;router-outlet&gt;&lt;/router-outlet&gt;</span></pre><p id="47a6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">仅此而已。</p><p id="ed36" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">卷起你的袖子…拿起你的枪…让我们揉揉脑细胞，给这个棱角分明的应用程序添加登录和认证功能！</p><h1 id="ebf6" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">身份验证服务(Typescript)</h1><p id="1db7" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">那么我们从哪里开始呢？</p><p id="6b64" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们将从认证服务开始。该认证服务将用于处理登录调用、认证状态以及注销功能。有些人可能会认为使用服务来处理身份验证状态是个坏主意。我们应该使用像<a class="ae ks" href="https://ngrx.io/" rel="noopener ugc nofollow" target="_blank"> NgRx </a>这样的状态管理解决方案。</p><p id="2494" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我听到了——他们确实有道理。</p><p id="85c6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">载物台管理为您的角度应用带来诸多好处。但是不要忘记，它会使您的生产应用程序变得更大。还增加了很多代码。</p><p id="d926" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，为了使我们的Angular应用程序更小，我们将使用认证服务来处理登录功能和状态。</p><p id="10c8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下面是我们将用来创建身份验证服务的命令。</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="77dc" class="ms lr in mo b gy mt mu l mv mw">ng generate service authentication</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nb"><img src="../Images/24ddac98639ef5805345947d3ce45744.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zX_HNq57_pSpsC-l.png"/></div></div></figure><p id="21f7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们的认证服务需要有3个函数来处理3个基本的认证功能。</p><ul class=""><li id="92c9" class="nc nd in kv b kw kx kz la lc ne lg nf lk ng lo nh ni nj nk bi translated">登录——一个处理登录信息的功能。</li><li id="fdbb" class="nc nd in kv b kw nl kz nm lc nn lg no lk np lo nh ni nj nk bi translated">注销——一个处理注销的功能。</li><li id="fb27" class="nc nd in kv b kw nl kz nm lc nn lg no lk np lo nh ni nj nk bi translated">用户是否登录—检查用户是否登录的功能。</li></ul><p id="b7c1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是我们完成后的身份验证服务的外观。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="848d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你很聪明，我相信你是，你会注意到我们嘲笑了登录功能。这是因为…嗯…因为我很懒，不想为这个演示设置认证服务器，因为我们关注的是如何将认证添加到我们的Angular应用程序中。</p><p id="d1bb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">也就是说，它仍然返回一个可观察值。因此，您需要做的就是用对服务器的HTTP调用来替换它。🥳 🥳 🥳</p><h1 id="718a" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">登录模块</h1><p id="5e7f" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">身份验证服务完成并等待使用后，我们就可以开始登录模块了。</p><p id="d8f1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">登录模块将是一个惰性加载的模块，显示我们的Angular应用程序的登录表单。你可以把它看作是我们角度应用的大门。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/63681b8dee08e713567b9cc8d0375bc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/0*QErqfhHwMNzc9Rzj.gif"/></div></figure><p id="c0d3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下面是您需要运行的命令。</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="9240" class="ms lr in mo b gy mt mu l mv mw">ng generate module --routing login <br/>ng generate component login</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nt"><img src="../Images/a9b554440bce1cfb18d7024740bc8206.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5Upbkd3SRFlvBFiT.png"/></div></div></figure><p id="f61d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，我们需要将路由连接到我们的登录组件，所以将路由添加到<code class="fe my mz na mo b">login-routing.module.ts</code>文件中。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="3435" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后我们必须配置<code class="fe my mz na mo b">app-routing.module.ts</code>来路由到我们的登录模块。。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="451f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">将<a class="ae ks" href="https://angular.io/api/forms/ReactiveFormsModule" rel="noopener ugc nofollow" target="_blank"> ReactiveFormsModule </a>导入我们的<code class="fe my mz na mo b">login.module.ts</code>文件。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="d4db" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">将登录表单的表单组添加到<code class="fe my mz na mo b">login.component.ts</code>文件中。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="75d4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后，使用一些基本的HTML创建一个登录表单。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="fae6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你打开Angular应用程序，进入<a class="ae ks" href="http://localhost:4200/login" rel="noopener ugc nofollow" target="_blank">http://localhost:4200/log in</a>，你会看到一个超级简单的登录界面。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/692630fa36db2017cc7a45bfbdf21fc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/0*zANHOKNPHT7gUKN9.png"/></div></figure><p id="750f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">丑？</p><p id="ed04" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">是的，我知道…</p><p id="df14" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">…但是坐好伙计。这不是一篇关于UX或奇特设计原则的文章。</p><h1 id="992f" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">路线守卫</h1><p id="cb7d" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">还和我在一起吗？那你很酷！😎</p><p id="e95c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">那么，我们如何保护应用程序的其他部分免受未经授权的访问呢？</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/803e868b77b8f1a433a14cb8cb20d177.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/0*ix8Jf8SV0IDQlAxj.gif"/></div></figure><p id="4615" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这就是<a class="ae ks" href="https://angular.io/guide/router#preventing-unauthorized-access" rel="noopener ugc nofollow" target="_blank">路线守卫</a>的作用。</p><p id="6e6d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，再次使用Angular CLI，为您的Angular应用程序创建一个路由保护。</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="1a1d" class="ms lr in mo b gy mt mu l mv mw">ng generate guard authentication-guard</span></pre><p id="fe31" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你会被要求实现什么接口。推荐的选择见下面的截图。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nw"><img src="../Images/2754597f6cffc8139c151fcfcbad6fb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QnDSDPGC8vzoslDx.png"/></div></div></figure><p id="035e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，登录我们的路线守卫。我们将注入我们的<code class="fe my mz na mo b">AuthenticationService</code>以及Angular的<a class="ae ks" href="https://angular.io/guide/router" rel="noopener ugc nofollow" target="_blank">路由器</a>服务。并且还添加了一个私有的<code class="fe my mz na mo b">authenticate()</code>函数，我们的接口会调用它。</p><p id="638e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是调味汁。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="040f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">说，你还和我在一起吗？迷茫？</p><p id="c4df" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">太好了，这意味着你在学习。</p><p id="878c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们刚才做了什么？我们创建了一个route guard，它使用我们的身份验证服务来确保用户在浏览器中存储了令牌。如果没有，我们会将他们重定向到登录模块，并要求他们输入用户名和密码。</p><p id="5e39" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">仅此而已。</p><p id="81b2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">除了…</p><p id="e6b9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们还有多一行代码要处理…</p><p id="2da0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">并使这个有角度的应用嗡嗡作响。</p><p id="2a77" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">打开<code class="fe my mz na mo b">app-routing.module.ts</code>文件，添加<a class="ae ks" href="https://angular.io/api/router/CanActivate" rel="noopener ugc nofollow" target="_blank"> canActivate </a>设置。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="7437" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这就完成了设置身份验证路由保护的部分。</p><p id="4ebf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">总而言之，我们创建了一个路由守卫，当有人试图访问一条路径时，它会被调用。当然，随着您的Angular应用程序的增长，您将添加更多的路径来路由到其他模块和组件。</p><h1 id="75e9" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">最后一步，连接我们的角度应用的各个部分。</h1><p id="ddeb" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">现在，让我们向我们的演示应用程序添加另一个模块，称为仪表板模块。</p><p id="397e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这纯粹是为了展示路线卫士的威力。</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="39f1" class="ms lr in mo b gy mt mu l mv mw">ng generate module --routing dashboard <br/>ng generate component dashboard</span></pre><p id="1b2c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后，我们将更新我们的<code class="fe my mz na mo b">app-routing.module.ts</code>文件，并使仪表板模块成为我们的默认路由。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="1de0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果我尝试加载应用程序，我会立即被重定向到登录页面。我可以用假凭证登录，然后我会看到新的仪表板页面。</p><h1 id="c126" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">我们如何注销？</h1><p id="d7a4" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">在我们的<code class="fe my mz na mo b">dashboard.component.ts</code>文件中，我们将添加一个注销函数，这个函数可以被我们的注销按钮调用。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="d892" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当注销函数被调用时，我们从本地存储中删除令牌并重定向到登录页面。</p><p id="3ee4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果他们按下浏览器中的back按钮返回仪表板，route guards将拦截该请求并重定向到登录页面。</p><p id="27cd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">简单认证演示？</p><p id="4b2c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当然啦！</p><p id="401d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为什么要复杂？</p><h1 id="9139" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">如何基于服务器响应重定向到登录页面？</h1><p id="70c3" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">我的朋友，这需要一个<a class="ae ks" href="https://angular.io/guide/http#intercepting-requests-and-responses" rel="noopener ugc nofollow" target="_blank"> HTTP拦截器</a>。</p><p id="7850" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们将创建一个新的HTTP拦截器来拦截HTTP请求和响应。如果服务器返回401或403，我们将重定向到登录页面。</p><p id="385f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，使用Angular CLI来生成一个空白的HTTP拦截器。</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="005b" class="ms lr in mo b gy mt mu l mv mw">ng generate interceptor authentication</span></pre><p id="2f74" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">打开<code class="fe my mz na mo b">app.module.ts</code>文件，添加新的HTTP拦截器作为提供者。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="6e75" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后但同样重要的是，这是我们的<code class="fe my mz na mo b">AuthenticationInterceptor</code>的代码。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nq nr l"/></div></figure><h1 id="171e" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">结论</h1><p id="f012" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">朋友，这就是Angular的完整登录演示。</p><p id="d5f2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们创建了一个模块来处理登录表单。处理登录和注销功能的认证服务。以及一个路由守卫来决定用户是否可以访问我们的仪表板。</p><p id="8b17" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，在我离开之前，我必须说一句话来结束这篇关于角度认证的文章:</p><p id="d003" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">【Angular应用程序中的身份验证不会取代后端的身份验证。您的API服务器或其他后端服务也必须实现正确的身份验证和授权，因为这是最安全的地方。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><a href="https://school.danielk.tech/course/unleash-your-angular-testing-skills?utm_source=medium&amp;utm_medium=banner&amp;utm_campaign=unleash_testing_skills"><div class="gh gi nx"><img src="../Images/f1b6577fb74e9686aa28b76134fcd343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mIckqGEatusFxMIp0LnzNw.png"/></div></a></figure></div><div class="ab cl ny nz hr oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ig ih ii ij ik"><p id="1b2d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">如果你喜欢这篇文章，并发现它有用，请点击👏按钮，关注我，获取更多类似本文的精彩文章。</strong></p><p id="9282" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">关注我:</strong> <a class="ae ks" href="https://github.com/dkreider" rel="noopener ugc nofollow" target="_blank"> GitHub </a>，<a class="ae ks" href="https://dkreider.medium.com/" rel="noopener">中型</a>，<a class="ae ks" href="https://danielk.tech" rel="noopener ugc nofollow" target="_blank">个人博客</a></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi of"><img src="../Images/769ae0c5a046f563aab6a87bd5193298.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/0*d9zoNP92wjDX3359.png"/></div></figure></div><div class="ab cl ny nz hr oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ig ih ii ij ik"><p id="63b8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="og">最初发布于</em><a class="ae ks" href="https://danielk.tech/home/angular-login-page-and-complete-authentication-demo" rel="noopener ugc nofollow" target="_blank"><em class="og">https://danielk . tech</em></a><em class="og">。</em></p><p id="8f03" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="og">更多内容请看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="og">plain English . io</em></a></p></div></div>    
</body>
</html>