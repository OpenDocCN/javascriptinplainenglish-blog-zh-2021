<html>
<head>
<title>Adding Graphics to a React App with D3 — Format TSVs and Load CSVs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用D3向React应用添加图形—格式化tsv和加载CSV</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/adding-graphics-to-a-react-app-with-d3-format-tsvs-and-load-csvs-8520da109f65?source=collection_archive---------10-----------------------#2021-02-09">https://javascript.plainenglish.io/adding-graphics-to-a-react-app-with-d3-format-tsvs-and-load-csvs-8520da109f65?source=collection_archive---------10-----------------------#2021-02-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d4b13d8b015cb355a1f1042d980b2f94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xa22Vul93QwdnoL4"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@snapsbyclark?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Clark Van Der Beken</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ef56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">D3让我们可以轻松地向前端web应用添加图形。</p><p id="461d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React是一个流行的前端web框架。</p><p id="55a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们合作得很好。在本文中，我们将了解如何使用D3向React应用程序添加图形。</p><h1 id="5b2d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">tsvFormat</h1><p id="cc55" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">tsvFormat</code>方法将对象数组转换成制表符分隔的字符串。</p><p id="c6c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c4ab" class="mq lc iq mh b gy mr ms l mt mu">import React, { useEffect } from "react";<br/>import * as d3 from "d3";</span><span id="213b" class="mq lc iq mh b gy mv ms l mt mu">const data = [<br/>  { year: 2011, population: 10 },<br/>  { year: 2012, population: 20 },<br/>  { year: 2013, population: 30 }<br/>];<br/>export default function App() {<br/>  useEffect(() =&gt; {<br/>    const string = d3.tsvFormat(data, ["year", "population"]);<br/>    console.log(string);<br/>  }, []);</span><span id="7099" class="mq lc iq mh b gy mv ms l mt mu">  return &lt;div className="App"&gt;&lt;/div&gt;;<br/>}</span></pre><p id="2b54" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么<code class="fe me mf mg mh b">string</code>就是:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="e6f1" class="mq lc iq mh b gy mr ms l mt mu">year population<br/>2011 10<br/>2012 20<br/>2013 30</span></pre><p id="cbff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们传入一个对象数组作为第一个参数。</p><p id="14c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个参数有一个列标题字符串数组。</p><h1 id="cd7c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">tsvFormatRows</h1><p id="0c9f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以调用<code class="fe me mf mg mh b">tsvFormatRows</code>方法将嵌套数组转换成制表符分隔的字符串。</p><p id="c76e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="aba2" class="mq lc iq mh b gy mr ms l mt mu">import React, { useEffect } from "react";<br/>import * as d3 from "d3";</span><span id="d41f" class="mq lc iq mh b gy mv ms l mt mu">const data = [<br/>  [2011, 10],<br/>  [2012, 20],<br/>  [2013, 30]<br/>];<br/>export default function App() {<br/>  useEffect(() =&gt; {<br/>    const string = d3.tsvFormatRows(data);<br/>    console.log(string);<br/>  }, []);</span><span id="1c1a" class="mq lc iq mh b gy mv ms l mt mu">  return &lt;div className="App"&gt;&lt;/div&gt;;<br/>}</span></pre><p id="5ffd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过<code class="fe me mf mg mh b">data</code>使用<code class="fe me mf mg mh b">tsvFormatRows</code>方法。</p><p id="f622" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="00ac" class="mq lc iq mh b gy mr ms l mt mu">2011 10<br/>2012 20<br/>2013 30</span></pre><p id="f8ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">记录在案。</p><h1 id="98ad" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">计时器</h1><p id="2bc9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以添加D3自带的定时器，为React应用程序添加动画。</p><p id="2141" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以调用<code class="fe me mf mg mh b">d3.timer</code>方法来创建一个定时器:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="856b" class="mq lc iq mh b gy mr ms l mt mu">import React, { useEffect } from "react";<br/>import * as d3 from "d3";</span><span id="ee9e" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  useEffect(() =&gt; {<br/>    const timer = d3.timer(function (duration) {<br/>      console.log(duration);<br/>      if (duration &gt; 150) {<br/>        timer.stop();<br/>      }<br/>    }, 100);<br/>  }, []);</span><span id="3ab3" class="mq lc iq mh b gy mv ms l mt mu">  return &lt;div className="App"&gt;&lt;/div&gt;;<br/>}</span></pre><p id="0bc5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用一个回调函数调用<code class="fe me mf mg mh b">timer</code>,这个回调函数的参数是<code class="fe me mf mg mh b">duration</code>。</p><p id="2a2e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后如果<code class="fe me mf mg mh b">duration</code>大于150ms，那么我们调用<code class="fe me mf mg mh b">timer.stop</code>来停止定时器。</p><h1 id="eb3a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">正在加载CSV</h1><p id="d80e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">d3.csv</code>方法在React应用程序中加载CSV。</p><p id="9482" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="6bb7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">public/data.csv</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2cf7" class="mq lc iq mh b gy mr ms l mt mu">name,age<br/>John,30<br/>Jane,32</span></pre><p id="c476" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">src/App.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="227f" class="mq lc iq mh b gy mr ms l mt mu">import React, { useEffect } from "react";<br/>import * as d3 from "d3";</span><span id="f665" class="mq lc iq mh b gy mv ms l mt mu">const readCsv = async () =&gt; {<br/>  const data = await d3.csv("/data.csv");<br/>  for (const { name, age } of data) {<br/>    console.log(name, age);<br/>  }<br/>};</span><span id="3da5" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  useEffect(() =&gt; {<br/>    readCsv();<br/>  }, []);</span><span id="2160" class="mq lc iq mh b gy mv ms l mt mu">  return &lt;div className="App"&gt;&lt;/div&gt;;<br/>}</span></pre><p id="b6cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">readCsv</code>函数从<code class="fe me mf mg mh b">public/data.csv</code>中读取数据。</p><p id="973f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们遍历<code class="fe me mf mg mh b">data</code>数组，该数组包含已解析的CSV行。</p><p id="f9c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到了:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8382" class="mq lc iq mh b gy mr ms l mt mu">John 30 <br/>Jane 32</span></pre><h1 id="d18b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="0b35" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在React应用中用D3读取和创建CSV和tsv。</p><p id="70af" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>