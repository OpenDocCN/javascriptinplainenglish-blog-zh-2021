<html>
<head>
<title>Ultimate Interview Questions on JavaScript Closures</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于JavaScript闭包的终极面试问题</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/ultimate-interview-questions-on-javascript-closures-8dd12a210677?source=collection_archive---------5-----------------------#2021-04-09">https://javascript.plainenglish.io/ultimate-interview-questions-on-javascript-closures-8dd12a210677?source=collection_archive---------5-----------------------#2021-04-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1f49" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Ace每个关于JavaScript闭包的问题</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/182c829596c24509f4e3991c61bb9e1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eM7a8c7cH7DIHRO5"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@quinoal?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Quino Al</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d2a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">本文是这个系列的最后一部分，在这里我们将探索闭包的起源、幕后工作、现实生活中的用法以及与闭包相关的面试问题。如果你还没有跟随系列，那么强烈推荐你</em> <a class="ae kv" href="https://medium.com/@polymathsomnath/most-important-feature-ever-put-in-a-programming-language-5b139e1e170f" rel="noopener"> <em class="ls">请过一遍。</em> </a></p><h1 id="771b" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">面试开始</h1><p id="5bfa" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">采访者:你能给我们讲讲JavaScript中的作用域吗？</p><p id="d5ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你</strong>:耶！当然，作用域是代码中变量可用的区域。</p><p id="5451" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">采访者:你能说得详细一点吗？</p><p id="5f18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你:</strong>在JavaScript中，作用域指的是你代码的当前上下文。范围可以是全局定义的<em class="ls">或局部定义的</em>或<em class="ls">。在ES6中，我们现在也有了数据块范围。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/75faef6b3fd77fd21bcd7d4fd4e93022.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gRbzxusNK00rDGXu93_kUQ.png"/></div></div></figure><p id="f2b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个<strong class="ky ir"> <em class="ls">局部作用域</em> </strong>是指定义在<strong class="ky ir"> <em class="ls">全局作用域</em> </strong>之外的任何作用域。典型的<strong class="ky ir"> <em class="ls">有一个全局作用域</em> </strong>，每个定义的函数都有自己的(嵌套的)<strong class="ky ir"> <em class="ls">局部作用域。</em> </strong></p><p id="0695" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">任何在另一个函数中定义的函数都有一个链接到外部函数的局部作用域。如果我定义了一个函数并在其中创建了变量，这些变量就变成了局部变量。举个例子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/0d4d9e77a1e8c8a670905a51d5041397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ZchqobXsKT6rEKgk4tyOw.png"/></div></div></figure><p id="4d37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">任何局部作用域的项在<em class="ls">全局作用域</em><strong class="ky ir"/>—<strong class="ky ir">—<em class="ls">中都是不可见的，除非</em> </strong> <strong class="ky ir"> <em class="ls">暴露</em> </strong>，这意味着如果我在一个新的作用域内定义函数或变量，在当前作用域的之外<em class="ls">是不可访问的。下面是一个简单的例子:</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/38b48b270fdcf63cafc6600065a0d395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_NGTUiklYoW60QE9rhnd1Q.png"/></div></div></figure><p id="1e49" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">变量<code class="fe mt mu mv mw b">name</code>的作用域是局部的，它没有暴露给父作用域，因此是未定义的。</p><p id="c19b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">面试官:很好，你能说说功能范围吗？</p><p id="3b67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你</strong>:当然！JavaScript中的所有作用域都是用<code class="fe mt mu mv mw b">Function Scope</code> <em class="ls">创建的，只有</em>，</p><p id="0e5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每个新函数都创建自己的作用域。我想用一个简单的例子来演示这个范围的创建</p><p id="40d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">面试官:说吧！</p><p id="d1fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你:这意味着在函数中定义的参数和变量在函数外是不可见的，而在函数内任何地方定义的变量在函数内任何地方都是可见的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/37dc94e1014019c1d3dcd9db2d8b5cb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tF2pBV_40HaqNymHYsMCNw.png"/></div></div></figure><p id="7de0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">面试官</strong>:好的！你能告诉我下面哪些函数访问外部作用域变量吗？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/0c7b2c68e8878f77a3c2141d6cff7f58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X3P7IO87-rqY8ej8-bY9PQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">1</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/5fa66b08326d9233db6d15d9df61c5c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j6hGEnAvT1X-DFfvL6N39g.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><code class="fe mt mu mv mw b">2</code></figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/9e1517589ab50bc427c88d26a5579ecb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*joW6gDMkrUqFA13Z2Fy2xQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">3</figcaption></figure><p id="48c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你:</strong><strong class="ky ir"><em class="ls">第一</em> </strong>一个和第<strong class="ky ir"> <em class="ls">第三</em> </strong>一个！</p><p id="8665" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">面试官</strong>:怎么样？</p><p id="847c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你:嗯，</p><ol class=""><li id="57c2" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated"><code class="fe mt mu mv mw b">clickHandler()</code>有<strong class="ky ir"> <em class="ls">从外部范围访问</em></strong><em class="ls"/><em class="ls"/>变量<code class="fe mt mu mv mw b">countClicks</code>。✅</li><li id="7fad" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated"><code class="fe mt mu mv mw b">immediate()</code> <em class="ls">不从外部作用域访问</em>任何变量。❌</li><li id="bbf7" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated"><code class="fe mt mu mv mw b">delayedReload()</code>有<strong class="ky ir"> <em class="ls">访问</em> </strong>从全局作用域(又名最外层作用域)到全局变量<code class="fe mt mu mv mw b">location</code>。✅</li></ol><p id="517f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">采访者:你对词法范围或闭包有所了解吗？<br/> <em class="ls">(读者注意:两者是一回事)</em></p><p id="9921" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你</strong>:是的！(<a class="ae kv" href="https://medium.com/p/5b139e1e170f/edit?source=your_stories_page-------------------------------------" rel="noopener">如果你不</a>，那么<a class="ae kv" href="https://medium.com/p/7e8194924398/edit?source=your_stories_page-------------------------------------" rel="noopener">去这里</a>)</p><p id="e25d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">面试官:什么是封闭？</p><p id="5570" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你</strong>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/5cb89e6c5ca5b888edd497531732e868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zwdV3mHdCL0MEt33jMwThQ.png"/></div></div></figure><p id="2b98" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">面试官:太好了！这个回答不错。能不能用JavaScript做个闭包给我看看？</p><p id="bb1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你</strong>:当然！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/42718b5dddc9a7f0f5ba5c339ecbd8b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2eymx-7jzrBepQXZXo4myQ.png"/></div></div></figure><p id="06b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们也可以用匿名函数写同样的代码</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/18028483d0041d24e2187b53815b5907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MJT-XBdN0D3oX_VwIiJrtA.png"/></div></div></figure><p id="b2e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">面试官</strong>:好的！你能说说9号线吗？你为什么用了多余的<code class="fe mt mu mv mw b">()</code></p><p id="473c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你:是啊，当然！正如我们所知，JavaScript中有<strong class="ky ir">一级函数</strong>，JavaScript中的<strong class="ky ir">函数也是对象</strong>。当我们编写<code class="fe mt mu mv mw b"> Outer() </code>时，它被调用并给我们<code class="fe mt mu mv mw b">Inner()</code>作为返回值，所以为了调用它，我们又使用了一个<code class="fe mt mu mv mw b">()</code>。</p><p id="f3bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">面试官</strong>:好看！你能告诉我下面程序的输出吗？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/ccdc90e42dfdc1db2520c1fd02459f95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6F4N2ucC3bQZvzYzc2pzcg.png"/></div></div></figure><p id="430d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你</strong> : <strong class="ky ir"> 0 </strong></p><p id="2068" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">面试官</strong>:怎么样？</p><p id="bbb8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> You </strong> : <code class="fe mt mu mv mw b">0</code>，是作为实参<code class="fe mt mu mv mw b">IIFE_1</code>传递的，因此<code class="fe mt mu mv mw b">a</code>形参是<code class="fe mt mu mv mw b">0</code>。</p><p id="81d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mt mu mv mw b">IIFE_2</code>函数嵌套在<code class="fe mt mu mv mw b">IIFE_1</code>函数中，是一个从外部<code class="fe mt mu mv mw b">IIFE_2</code>范围捕获<code class="fe mt mu mv mw b">a</code>变量的闭包，其中<code class="fe mt mu mv mw b">a</code>是<code class="fe mt mu mv mw b">0</code>。从而<code class="fe mt mu mv mw b">console.log(a)</code>记录<code class="fe mt mu mv mw b">0</code>。</p><p id="fc5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">面试官:嗯...很好！这个怎么样？第一条和第二条<code class="fe mt mu mv mw b"> console.log()</code>语句中会记录什么</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/73d7b45402df7fae99761ddbc8529559.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g1RHckw6aMJ9zf4txE6mmQ.png"/></div></div></figure><p id="7fc9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你:</strong> <code class="fe mt mu mv mw b">1</code>和<code class="fe mt mu mv mw b">0</code>被登录到控制台。</p><p id="b670" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">采访者</strong>:你能详细说明一下吗？</p><p id="ed9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你:</strong>确定！</p><p id="8bf2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一条语句<code class="fe mt mu mv mw b">let a = 0</code>声明了一个变量<code class="fe mt mu mv mw b">a</code>。</p><p id="c742" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mt mu mv mw b">foo()</code>是一个闭包，它从外部范围捕获<code class="fe mt mu mv mw b">a</code>变量。<code class="fe mt mu mv mw b">foo()</code>功能范围内<code class="fe mt mu mv mw b">a</code>为<code class="fe mt mu mv mw b">0</code>。</p><p id="e492" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，在条件内部，另一个<code class="fe mt mu mv mw b">let a = 1</code>声明了一个局部变量<code class="fe mt mu mv mw b">a</code>，它从作用域外部覆盖了<code class="fe mt mu mv mw b">a</code>。第一篇<code class="fe mt mu mv mw b">console.log(a)</code>日志<code class="fe mt mu mv mw b">1</code>。</p><p id="02dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二个<code class="fe mt mu mv mw b">console.log(a)</code>记录<code class="fe mt mu mv mw b">0</code>，因为这里的<code class="fe mt mu mv mw b">a</code>变量是从外部作用域访问的。</p><p id="0a23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">面试官</strong>:精彩！好的，我有一个循环，里面有<code class="fe mt mu mv mw b">setTimeout()</code>，你能告诉我我应该期待什么样的输出吗？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/1f99157a84de53638f8079626c8b7265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MswLxvGuK7aUaoLb0jWXpg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">(Note to the readers : This is a classic closure question which is asked every other time in Interviews.)</figcaption></figure><p id="6673" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"/>:<code class="fe mt mu mv mw b">3</code>，<code class="fe mt mu mv mw b">3</code>，<code class="fe mt mu mv mw b">3</code>登录控制台。</p><p id="a306" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">面试官</strong>:请详细一点！</p><p id="f05f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你:上面的代码分两个阶段执行。</p><p id="e26e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第一阶段</strong></p><ol class=""><li id="3e7b" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated"><code class="fe mt mu mv mw b">for()</code>循环迭代3次。在每次迭代期间，创建一个新函数<code class="fe mt mu mv mw b">log()</code>，它捕获变量<code class="fe mt mu mv mw b">i</code>。<code class="fe mt mu mv mw b">setTimout()</code>调度<code class="fe mt mu mv mw b">log()</code>在1000毫秒或1秒后执行。</li><li id="2cde" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">当<code class="fe mt mu mv mw b">for()</code>循环完成后，<code class="fe mt mu mv mw b">i</code>变量的值为<code class="fe mt mu mv mw b">3</code>。</li></ol><p id="553f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第二阶段</strong></p><p id="e484" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二阶段发生在1000毫秒之后:</p><ol class=""><li id="f99d" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated"><code class="fe mt mu mv mw b">setTimeout()</code>执行预定的<code class="fe mt mu mv mw b">log()</code>功能。<code class="fe mt mu mv mw b">log()</code>读取变量<code class="fe mt mu mv mw b">i</code>的<em class="ls">当前值</em>，即<code class="fe mt mu mv mw b">3</code>，并记录到控制台<code class="fe mt mu mv mw b">3</code>。</li></ol><p id="77ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是<code class="fe mt mu mv mw b">3</code>、<code class="fe mt mu mv mw b">3</code>、<code class="fe mt mu mv mw b">3</code>被记录到控制台的原因。</p><p id="485d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">面试官</strong>:我想让它<em class="ls">记录</em><code class="fe mt mu mv mw b"><em class="ls">0</em></code><em class="ls"/><code class="fe mt mu mv mw b"><em class="ls">1</em></code><em class="ls"/><code class="fe mt mu mv mw b"><em class="ls">2</em></code><em class="ls">的数值，可能吗？</em></p><p id="f186" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你:当然！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/19b312e478112ae5e9c10cec66e5af2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MhTYFSuf_Mud4mY3cVM5og.png"/></div></div></figure><p id="65da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">面试官:太好了！好吧，告诉我，在JavaScript中没有所谓的<code class="fe mt mu mv mw b">public</code>和<code class="fe mt mu mv mw b">private</code>范围！我们可以使用闭包来模拟私有范围和公共范围吗？</p><p id="4516" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你</strong>:对！事实上，只有在闭包的帮助下，我们才能做这些事情！</p><p id="5f7f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">面试官</strong>:好的！下面的函数<code class="fe mt mu mv mw b">createStack()</code>创建堆栈数据结构的实例:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/f28b4fef27c82257b1eaf41928d59f64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YfDJT3iNl-2Mj3qbbD41Yg.png"/></div></div></figure><p id="ca3c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该堆栈工作正常，但有一个小问题。任何人都可以直接修改items数组，因为<code class="fe mt mu mv mw b">stack.items</code>属性是公开的。</p><p id="12ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个问题，因为它打破了堆栈的封装:只有<code class="fe mt mu mv mw b">push()</code>和<code class="fe mt mu mv mw b">pop()</code>方法应该是公共的，但是<code class="fe mt mu mv mw b">stack.items</code>或任何其他细节都不应该是可访问的。</p><p id="8fad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用闭包的概念重构上面的堆栈实现，这样就没有办法在<code class="fe mt mu mv mw b">createStack()</code>函数范围之外访问<code class="fe mt mu mv mw b">items</code>数组。</p><p id="0a07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你</strong>:好的，这段代码需要一点点重构，<code class="fe mt mu mv mw b">items</code>数组需要在作用域中上移。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/f6c7e1757c20258254f46f47e020c7c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ySYxVbk6MBO60alo74rQFg.png"/></div></div></figure><p id="7fd3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更改后，无法从<code class="fe mt mu mv mw b">createStack()</code>范围之外访问或修改<code class="fe mt mu mv mw b">items</code>数组。</p><p id="6cf9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mt mu mv mw b">items</code>现在是私有变量，堆栈被封装:只有<code class="fe mt mu mv mw b">push()</code>和<code class="fe mt mu mv mw b">pop()</code>方法是公共的。</p><p id="1c3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mt mu mv mw b">push()</code>和<code class="fe mt mu mv mw b">pop()</code>方法是闭包，从<code class="fe mt mu mv mw b">createStack()</code>函数范围捕获<code class="fe mt mu mv mw b">items</code>变量。</p><p id="6459" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">面试官:很好！我还有最后一个问题要问你！</p><p id="d6b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你</strong>:当然！</p><p id="1d19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">面试官:</strong>写一个函数<code class="fe mt mu mv mw b">multiply()</code>，它是2的倍数:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/5637b006bfd8122a9ac922d0d94e3586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ec53tqnIdjlq7gCtkF-VZQ.png"/></div></div></figure><p id="dbfa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果用两个参数调用<code class="fe mt mu mv mw b">multiply(num1, numb2)</code>，它应该返回两个参数的乘积。</p><p id="1a20" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是如果用1个参数<code class="fe mt mu mv mw b">const anotherFunc = multiply(num1)</code>调用，这个函数应该返回另一个函数。调用<code class="fe mt mu mv mw b">anotherFunc(num2)</code>时返回的函数执行乘法<code class="fe mt mu mv mw b">num1 * num2</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/106c78871c2b131533b8044c619ad71b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_xmRWy8YYxAUn7a_BvRNeg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Something like this</figcaption></figure><p id="19ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你:当然可以！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/f7b8b4aff6fe47a402bac34f65c63998.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QkAK3FYJ0aNrKYvzwXcOiw.png"/></div></div></figure><p id="0ad7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">面试官:你能详细说说吗？</p><p id="ac28" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你</strong>:当然！正如我们在代码中看到的，如果<code class="fe mt mu mv mw b">number2</code>参数不是<code class="fe mt mu mv mw b">undefined</code>，那么函数只是返回<code class="fe mt mu mv mw b">number1 * number2</code>。</p><p id="9571" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但如果<code class="fe mt mu mv mw b">number2</code>是<code class="fe mt mu mv mw b">undefined</code>，则说明<code class="fe mt mu mv mw b">multiply()</code>函数已经被一个参数调用了。在这种情况下，我们返回一个函数<code class="fe mt mu mv mw b">doMultiply()</code>,当稍后被调用时，它执行实际的乘法。</p><p id="88ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mt mu mv mw b">doMultiply()</code>是一个闭包，因为它从<code class="fe mt mu mv mw b">multiply()</code>范围捕获了<code class="fe mt mu mv mw b">number1</code>变量。</p><p id="6e53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">面试</strong>:你能告诉我使用闭包有什么缺点吗？</p><p id="bf9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你</strong>:闭包是编程语言的一个特性，和每一个特性一样，它是好是坏取决于实现它的人。</p><p id="30c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我们所知，闭包不是垃圾收集的，它们会保留到程序的最后。在这种情况下，如果我们不必要地继续使用闭包，尤其是在不需要闭包的代码中，可能会导致内存泄漏！</p><p id="d9a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，<a class="ae kv" href="https://v8.dev/blog" rel="noopener ugc nofollow" target="_blank"> JavaScript引擎</a>一天比一天聪明。我们现在拥有的引擎可以区分什么是必要的，什么是不必要的！</p><p id="663b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">面试官:你回答了所有的问题，真是太棒了！期待下一轮再见！</p><h1 id="4b47" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">一封感谢信！</h1><p id="2fcb" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我想利用这最后的机会说声谢谢🙏</p><p id="cda3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您关注这个系列！</p><p id="9f5d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望我没有过分打扰你！</p><p id="57de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你在T2玩得开心。希望你<strong class="ky ir">学到了很多！</strong></p><p id="8a9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">再次感谢你的到来。如果没有像你这样的人跟随并带着信念阅读我的帖子，我就不会有今天的成就。</p><p id="45f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你能加入我的<a class="ae kv" href="https://polymathsomnath.medium.com/" rel="noopener"> <strong class="ky ir">未来博客文章</strong> </a>并留下来，因为我认为我们这里有一些很棒的东西，我希望我能在你未来的职业生涯中帮助你！</p><p id="92ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下次见。再见！👋</p><h1 id="f931" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">如果你错过了这个系列，这里有链接。😊</h1><h2 id="5a69" class="ob lu iq bd lv oc od dn lz oe of dp md lf og oh mf lj oi oj mh ln ok ol mj om bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/most-important-feature-ever-put-in-a-programming-language-5b139e1e170f?sk=baff3bd18de9be10a66bb27eb2d265d4"> 1。编程语言中最重要的特性</a></h2><h2 id="723c" class="ob lu iq bd lv oc od dn lz oe of dp md lf og oh mf lj oi oj mh ln ok ol mj om bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/grokking-closure-in-javascript-7e8194924398?sk=0f6e01511d6400590608f10f0ea85017"> 2。在JavaScript中寻找闭包</a></h2><h2 id="05b3" class="ob lu iq bd lv oc od dn lz oe of dp md lf og oh mf lj oi oj mh ln ok ol mj om bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/practical-usage-of-closures-in-javascript-b3203770ba2?sk=dc404a83106d791c943d16b6b389e26c"> 3。闭包的实际用法</a></h2><h2 id="d2dd" class="ob lu iq bd lv oc od dn lz oe of dp md lf og oh mf lj oi oj mh ln ok ol mj om bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/ultimate-interview-questions-on-javascript-closures-8dd12a210677?sk=4d15f7e3756b76a9e2886b97515975b1"> 4。终极JavaScript面试问题—结束</a></h2></div></div>    
</body>
</html>