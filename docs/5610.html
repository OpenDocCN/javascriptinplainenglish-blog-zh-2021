<html>
<head>
<title>A Complete Guide to Axios POST Requests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Axios POST请求的完整指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/a-complete-guide-to-axios-post-requests-141ae80d75e9?source=collection_archive---------4-----------------------#2021-11-23">https://javascript.plainenglish.io/a-complete-guide-to-axios-post-requests-141ae80d75e9?source=collection_archive---------4-----------------------#2021-11-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/31bc28fa92cf2fa9125f1a6d3a869270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*49tORt7ymB3qwvwh"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@oskaryil?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Oskar Yildiz</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="50e4" class="ka kb in bd kc kd ke dn kf kg kh dp ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">介绍</h2><p id="b5ba" class="pw-post-body-paragraph kw kx in ky b kz la lb lc ld le lf lg kj lh li lj kn lk ll lm kr ln lo lp lq ig bi translated">axios每周从NPM下载超过2100万次，是JavaScript生态系统中最受欢迎的HTTP客户端之一。简洁直观的库API和丰富的第三方插件/扩展使得这个HTTP客户端成为许多web和Node.js开发人员的选择。</p><figure class="ls lt lu lv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lr"><img src="../Images/eb490f68a91227c291d4cf01928f26af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FQPT55Po8ed9mHZi6K8wiw.png"/></div></div></figure><p id="66f8" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">在我们深入示例之前，我只想指出，使用axios编写HTTP请求有不同的方式(风格)，例如，创建一个新的实例并在创建的实例上调用方法。然而，在这篇文章中，我们将结合使用一个全局实例和<a class="ae jz" href="https://github.com/axios/axios#request-method-aliases" rel="noopener ugc nofollow" target="_blank">请求方法别名</a>。</p><h2 id="ddbf" class="ka kb in bd kc kd ke dn kf kg kh dp ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">请求正文</h2><pre class="ls lt lu lv gt mb mc md me aw mf bi"><span id="744b" class="ka kb in mc b gy mg mh l mi mj">axios.post('URL', { name: 'Bob' }).then(console.log)</span></pre><p id="b169" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">在HTTP POST(或PUT和PATCH)的情况下，请求体是该方法采用的第二个参数。默认情况下，在没有任何配置的情况下，axios假设目的是发送一个JSON主体，并将其视为JSON主体。换句话说，JavaScript对象在被发送到服务器之前被序列化为JSON。</p><p id="391e" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated"><strong class="ky io">表单url编码— x-www-form-urlencoded </strong></p><p id="93f9" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">但是，在某些情况下，需要发送一个POST请求，其主体不是JSON，而是表单数据。</p><p id="2169" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">当发送表单POST请求时，还需要一个额外的步骤。根据您是在Node.js还是在browser中使用axios，配置会有所不同。</p><p id="a301" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">在Node.js中，我们可以使用内置库<a class="ae jz" href="https://nodejs.org/docs/latest-v12.x/api/querystring.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ky io"> querystring </strong> </a>。</p><pre class="ls lt lu lv gt mb mc md me aw mf bi"><span id="75d8" class="ka kb in mc b gy mg mh l mi mj">axios.post('URL', querystring.stringify({ 'name': 'Bob' }))<br/>.then(console.log)<br/>.catch(console.error)</span></pre><p id="6731" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">另一方面，在浏览器中，我们可以在浏览器的原生<a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams" rel="noopener ugc nofollow" target="_blank"><strong class="ky io">URLSearchParams</strong></a>上进行中继。</p><pre class="ls lt lu lv gt mb mc md me aw mf bi"><span id="2e5d" class="ka kb in mc b gy mg mh l mi mj">const params = new URLSearchParams();<br/>params.append('name', 'Bob');<br/>axios.post('URL', params);</span></pre><h2 id="51ee" class="ka kb in bd kc kd ke dn kf kg kh dp ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">请求标题</h2><p id="3bb4" class="pw-post-body-paragraph kw kx in ky b kz la lb lc ld le lf lg kj lh li lj kn lk ll lm kr ln lo lp lq ig bi translated">除了向服务器发送请求体之外，我们通常需要包含关于请求的附加信息，这种需求的一个非常常见的例子是auth token或key。在axios中，给请求附加一个头非常简单，通过向<code class="fe mk ml mm mc b">axios.post</code>方法传递第三个参数来完成。</p><pre class="ls lt lu lv gt mb mc md me aw mf bi"><span id="c29c" class="ka kb in mc b gy mg mh l mi mj">axios.post('', {}, { headers: { 'api-key': 'x'}}).then(console.log)</span></pre><p id="2cff" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">然而，在幕后，库附加了关于请求的附加头。值得一提的是，如果没有这些头，比如<code class="fe mk ml mm mc b">content-type</code>和<code class="fe mk ml mm mc b">content-length</code>，一些服务器解析主体内容会有困难，或者请求会被视为无效并被拒绝。<em class="mn">附加头的过程不是axios独有的，大多数HTTP客户端都执行相同的过程。</em></p><p id="a7bc" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">发送JSON body请求时默认头的完整列表。</p><figure class="ls lt lu lv gt jo"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="8958" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">表单数据中出现的所有标题</p><figure class="ls lt lu lv gt jo"><div class="bz fp l di"><div class="mo mp l"/></div></figure><h2 id="3427" class="ka kb in bd kc kd ke dn kf kg kh dp ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">附加配置</h2><p id="101a" class="pw-post-body-paragraph kw kx in ky b kz la lb lc ld le lf lg kj lh li lj kn lk ll lm kr ln lo lp lq ig bi translated">其他一些有用的配置选项不是针对POST请求的，但仍然值得一提。</p><ol class=""><li id="1d85" class="mq mr in ky b kz lw ld lx kj ms kn mt kr mu lq mv mw mx my bi translated">添加请求<strong class="ky io">超时</strong>是<strong class="ky io"> </strong>的方式与头作为第三个方法参数传递的方式相同，可以定义以毫秒为单位的超时。</li></ol><pre class="ls lt lu lv gt mb mc md me aw mf bi"><span id="2f31" class="ka kb in mc b gy mg mh l mi mj">axios.post('...', {name: 'Bob'}, {timeout: 30000}) //30 sec timeout</span></pre><p id="7edf" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">2.<strong class="ky io"> keep-alive </strong>选项(仅Node.js特性)，通知服务器保持底层TCP连接打开，这反过来使后续请求更快(因为建立新TCP连接的过程被完全跳过)</p><pre class="ls lt lu lv gt mb mc md me aw mf bi"><span id="5c5f" class="ka kb in mc b gy mg mh l mi mj">httpAgent: new http.Agent({ keepAlive: true }),<br/>httpsAgent: new https.Agent({ keepAlive: true }),</span></pre><p id="794c" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">3.Axios内置了对<strong class="ky io">基本授权</strong>保护的API的支持。同样，它是以与headers相同的方式完成的(第三个方法参数)。你可以在这里了解更多。</p><pre class="ls lt lu lv gt mb mc md me aw mf bi"><span id="2d2d" class="ka kb in mc b gy mg mh l mi mj">auth: {<br/>    username: 'janedoe',<br/>    password: 's00pers3cret'<br/>},</span></pre><p id="0e40" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">4.设置全局基本URL — <code class="fe mk ml mm mc b">axios.defaults.baseURL = 'https://localhost:3000/api/';</code></p><p id="c2a9" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated">我希望你觉得这很有用，如果你有兴趣了解更多关于axios的信息，这里是我的一些其他帖子。</p><div class="mz na gp gr nb nc"><a href="https://sabljakovich.medium.com/basic-authentication-with-axios-nodejs-browser-cfabe08ced39" rel="noopener follow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd io gy z fp nh fr fs ni fu fw im bi translated">使用axios的基本身份验证—节点和浏览器</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">像许多其他流行的HTTP客户端一样，Axios内置了对基本身份验证的支持。然而，通常在代码中…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">sabljakovich.medium.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq jt nc"/></div></div></a></div><div class="mz na gp gr nb nc"><a href="https://sabljakovich.medium.com/axios-interceptors-log-request-and-response-72b01333a760" rel="noopener follow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd io gy z fp nh fr fs ni fu fw im bi translated">Axios拦截器—日志请求和响应</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">在从事node.js项目时，许多人会求助于第三方的HTTP客户端库。即使有…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">sabljakovich.medium.com</p></div></div><div class="nl l"><div class="nr l nn no np nl nq jt nc"/></div></div></a></div><div class="mz na gp gr nb nc"><a href="https://sabljakovich.medium.com/axios-response-time-capture-and-log-8ff54a02275d" rel="noopener follow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd io gy z fp nh fr fs ni fu fw im bi translated">Axios响应时间—捕获和记录</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">注意:确保使用不同于0.19.0的axios版本，因为它引入了此功能/错误。</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">sabljakovich.medium.com</p></div></div><div class="nl l"><div class="ns l nn no np nl nq jt nc"/></div></div></a></div><p id="0108" class="pw-post-body-paragraph kw kx in ky b kz lw lb lc ld lx lf lg kj ly li lj kn lz ll lm kr ma lo lp lq ig bi translated"><em class="mn">更多内容请看</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="mn">plain English . io</em></a><em class="mn">。报名参加我们的</em> <a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="mn">免费周报在这里</em> </a> <em class="mn">。</em></p></div></div>    
</body>
</html>