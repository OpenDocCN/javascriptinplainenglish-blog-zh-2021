<html>
<head>
<title>Sticky Notes — Business Logic</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">便笺——业务逻辑</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/sticky-notes-business-logic-f69253fb45fd?source=collection_archive---------11-----------------------#2021-12-22">https://javascript.plainenglish.io/sticky-notes-business-logic-f69253fb45fd?source=collection_archive---------11-----------------------#2021-12-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="dec8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第2部分:没有框架的JavaScript应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/39e9d2b86d859b666cca153ee75442d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0TjiQq4szpC7jdjz"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@freegraphictoday?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">AbsolutVision</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="6ab1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls"> Live dev笔记由</em><a class="ae kv" href="https://www.youtube.com/channel/UCjX0FtIZBBVD3YoCcxnDC4g" rel="noopener ugc nofollow" target="_blank"><em class="ls">dcode</em></a><em class="ls">——</em><a class="ae kv" href="https://www.youtube.com/watch?v=Efo7nIUF2JY&amp;ab_channel=dcode" rel="noopener ugc nofollow" target="_blank"><em class="ls">如何使用JavaScript构建一个便签App(初学者项目)</em> </a></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><blockquote class="ma"><p id="3e7d" class="mb mc iq bd md me mf mg mh mi mj lr dk translated">在第2部分中，我们将研究如何集成JavaScript，从引用HTML元素到在与localStorage API交互时添加CRUD功能。</p></blockquote></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="1d51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简单地说，CRUD是以下内容的缩写:</p><ul class=""><li id="b9dc" class="mk ml iq ky b kz la lc ld lf mm lj mn ln mo lr mp mq mr ms bi translated">创造</li><li id="f57a" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">阅读</li><li id="6ee1" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">更新</li><li id="441e" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">删除</li></ul><p id="c582" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">粘滞便笺应用程序将需要能够对localStorage API运行这些函数。</p><h1 id="04d6" class="my mz iq bd na nb nc nd ne nf ng nh ni jw nj jx nk jz nl ka nm kc nn kd no np bi translated">如何访问本地存储</h1><p id="6fdb" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">要打开本地存储，请使用以下命令检查页面:</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="e747" class="oa mz iq nw b gy ob oc l od oe">ctrl + shift + i</span></pre><p id="555d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，打开默认情况下可能隐藏的应用程序选项卡。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/8620c907587c4f3e36431a6f462b41b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qmCphsJoGsWhb1Ou"/></div></div></figure><p id="09d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转到本地存储，在那里您会发现一个键和值列。在这里，我们可以看到应用程序运行时数据发生了什么变化。目前，没有存储任何值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/3918a06a9a1f522a0d222433f4e55275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6HXrb9WPuIPoEQsC"/></div></div></figure><p id="cc5e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本地存储允许您将数据作为字符串存储在键值对中。因为JSON可以转换成字符串，所以它允许你存储数据。</p><p id="16fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是一个示例，展示了便笺数据保存在本地存储时的样子。每个注释都是一个JSON对象，带有id(数字)和内容(字符串)的键</p><h2 id="2613" class="oa mz iq bd na og oh dn ne oi oj dp ni lf ok ol nk lj om on nm ln oo op no oq bi translated"><strong class="ak">键:</strong></h2><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="49c0" class="oa mz iq nw b gy ob oc l od oe">stickynotes-notes</span></pre><h2 id="aa97" class="oa mz iq bd na og oh dn ne oi oj dp ni lf ok ol nk lj om on nm ln oo op no oq bi translated"><strong class="ak">值:</strong></h2><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="9927" class="oa mz iq nw b gy ob oc l od oe">[{<br/>	id: 1234,<br/>	content: "Make some coding tutorials"<br/>},<br/>{<br/>	id: 4321,<br/>	content: "Hello World"<br/>}]</span></pre></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="539f" class="my mz iq bd na nb or nd ne nf os nh ni jw ot jx nk jz ou ka nm kc ov kd no np bi translated">在JavaScript中设置HTML引用</h1><p id="1fb6" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">在我们开始与localStorage API交互之前，我们需要在<code class="fe ow ox oy nw b">main.js</code>中获得对主应用程序div容器的引用</p><p id="5b11" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用容器引用，我们可以访问添加注释按钮。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="f6ad" class="oa mz iq nw b gy ob oc l od oe">const notesContainer = document.getElementById("app");<br/>const addNoteButton = notesContainer.querySelector(".add-note");</span></pre><p id="fcee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此时，有必要从HTML中删除示例便笺，因为便笺内容现在将来自本地存储，并通过JavaScript动态添加。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="3f41" class="oa mz iq nw b gy ob oc l od oe">&lt;div id="app"&gt;<br/>  &lt;button class="add-note" type="button"&gt;+&lt;/button&gt;<br/>&lt;/div&gt;</span></pre></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="7b17" class="my mz iq bd na nb or nd ne nf os nh ni jw ot jx nk jz ou ka nm kc ov kd no np bi translated">读取—从本地存储中获取笔记</h1><p id="aefc" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated"><code class="fe ow ox oy nw b">getNotes()</code>函数的目的是返回一个注释数组。它将首先尝试从本地存储中获取所有笔记。然而，如果这是用户第一次运行您的应用程序，它将返回一个空数组。无论它返回什么值，都会被转换成一个JSON对象。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="5c07" class="oa mz iq nw b gy ob oc l od oe">// retrieves all of the existing notes from local storage in the client's browser</span><span id="1ed8" class="oa mz iq nw b gy oz oc l od oe">function getNotes() {<br/>  return JSON.parse(localStorage.getItem("stickynotes-notes") || "[]");<br/>}</span></pre><p id="626c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们第一次跳转到控制台并运行<code class="fe ow ox oy nw b">getNotes()</code>函数时，我们将得到一个空数组。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/1594515af1243f09dc4d4fe0e9a3be77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/0*GepMXlbhqPL2ciFm"/></div></figure><p id="257e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们跳转到本地存储并将一些数据分配给正确的键名…</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/928cb8f269f7d529596e231963af5b71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KcVeWCqWSorsJC0z"/></div></div></figure><p id="fdc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">…再次运行<code class="fe ow ox oy nw b">getNotes()</code>函数意味着我们获得了新的数据，而不是一个空数组。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pc"><img src="../Images/891c698f2f5412f1c825f8e9d9e41768.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zPryPxK_Zj0CWhV7"/></div></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="660a" class="my mz iq bd na nb or nd ne nf os nh ni jw ot jx nk jz ou ka nm kc ov kd no np bi translated">更新—将注释保存到本地存储</h1><p id="8fcc" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated"><code class="fe ow ox oy nw b">saveNotes()</code>函数将用一些数据填充本地存储字段。</p><p id="0b26" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，音符数组被转换为字符串，并覆盖存储在本地存储器的<code class="fe ow ox oy nw b">stickynotes-notes</code>键中的现有值。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="f8bf" class="oa mz iq nw b gy ob oc l od oe">// takes an array of notes<br/>// save the new notes to the local storage in the client's browser</span><span id="aa1f" class="oa mz iq nw b gy oz oc l od oe">function saveNotes(notes) {<br/>  localStorage.setItem("stickynotes-notes", JSON.stringify(notes))<br/>}</span></pre><p id="f4fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了测试这一点，我们将在控制台中运行<code class="fe ow ox oy nw b">saveNotes()</code>函数来存储一些数据。确保该函数接受一个JSON对象数组。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="7bb8" class="oa mz iq nw b gy ob oc l od oe">saveNotes([id: 2, content: "This is a test"])</span></pre><p id="2475" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们将运行<code class="fe ow ox oy nw b">getNotes()</code>函数，看看它返回什么。</p><blockquote class="pd pe pf"><p id="4921" class="kw kx ls ky b kz la jr lb lc ld ju le pg lg lh li ph lk ll lm pi lo lp lq lr ij bi translated">请注意，<code class="fe ow ox oy nw b">saveNotes()</code>函数会覆盖原来存储在本地存储中的任何数据。</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pj"><img src="../Images/139c0160a2d00ca3b5fe0fab3d867ec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HFWagEC7xq6qjx52"/></div></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="3635" class="my mz iq bd na nb or nd ne nf os nh ni jw ot jx nk jz ou ka nm kc ov kd no np bi translated">创建—创建HTML注释元素</h1><p id="5193" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">在<code class="fe ow ox oy nw b">createNoteElement()</code>函数中，我们想要创建一个新的文本区域来表示一个新的便笺。使用JavaScript我们可以创建一个新的HTML元素，默认情况下它还没有被附加到DOM中。</p><p id="dedf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个新元素现在可以被分配一个“note”类来获得在<code class="fe ow ox oy nw b">styles.css</code>中定义的CSS属性。我们在函数的第二个参数中提供的textarea内容也将被传递给新的注释。</p><p id="5c15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，如果没有提供内容，将使用占位符值(我们需要定义它)。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="dcd2" class="oa mz iq nw b gy ob oc l od oe">// builds a new HTML element to represent a note</span><span id="c466" class="oa mz iq nw b gy oz oc l od oe">function createNoteElement(id, content) {<br/>  const element = document.createElement("textarea");</span><span id="f2ef" class="oa mz iq nw b gy oz oc l od oe">  element.classList.add("note");<br/>  element.value = content;<br/>  element.placeholder = "Empty sticky note";</span><span id="a381" class="oa mz iq nw b gy oz oc l od oe">  // Add event listeners here</span><span id="e92c" class="oa mz iq nw b gy oz oc l od oe">  return element;<br/>}</span></pre><h2 id="5c03" class="oa mz iq bd na og oh dn ne oi oj dp ni lf ok ol nk lj om on nm ln oo op no oq bi translated">事件监听器1 —更新内容</h2><p id="609d" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">在返回元素之前，我们必须在与每个便笺交互时包含一些事件侦听器。</p><p id="69ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一个事件侦听器将侦听textarea内容的任何更改。当发生变化时，它将运行<code class="fe ow ox oy nw b">updateNote()</code>功能。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="adc8" class="oa mz iq nw b gy ob oc l od oe">element.addEventListener("change", () =&gt; {<br/>  updateNote(id, element.value);<br/>})</span></pre><p id="beec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">出于演示的目的，让我们更新<code class="fe ow ox oy nw b">updateNote()</code>函数来登录控制台。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="6485" class="oa mz iq nw b gy ob oc l od oe">// updates existing note</span><span id="fa70" class="oa mz iq nw b gy oz oc l od oe">function updateNote(id, newContent) {<br/>  console.log("Updating note...")<br/>  console.log(id, newContent)<br/>}</span></pre><h2 id="0db9" class="oa mz iq bd na og oh dn ne oi oj dp ni lf ok ol nk lj om on nm ln oo op no oq bi translated">事件监听器2 —删除注释</h2><p id="9628" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">第二个事件监听器将监听双击便笺。当双击它时，它会要求确认删除该笔记。如果确认为真，将运行<code class="fe ow ox oy nw b">deleteNote()</code>功能。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="a4a2" class="oa mz iq nw b gy ob oc l od oe">element.addEventListener("dblclick", () =&gt; {<br/>  // returns a boolean value after you confirm whether to delete<br/>  const doDelete = confirm("Are you sure you wish to delete?")<br/>	<br/>  // if true, delete the note<br/>  if (doDelete) {<br/>    deleteNote(id, element);<br/>  }<br/>})</span></pre><p id="5934" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样，出于演示目的，让我们更新<code class="fe ow ox oy nw b">deleteNote()</code>函数来登录控制台。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="25f7" class="oa mz iq nw b gy ob oc l od oe">// deletes an existing note from the HTML and local storage</span><span id="8e55" class="oa mz iq nw b gy oz oc l od oe">function deleteNote(id, element) {<br/>  console.log("Deleting note...")<br/>  console.log(id, element)<br/>}</span></pre></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="1f43" class="my mz iq bd na nb or nd ne nf os nh ni jw ot jx nk jz ou ka nm kc ov kd no np bi translated">测试功能</h1><h2 id="dd5b" class="oa mz iq bd na og oh dn ne oi oj dp ni lf ok ol nk lj om on nm ln oo op no oq bi translated">测试— createNoteElement()</h2><p id="1e3b" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">为了测试它，我们将在控制台中运行<code class="fe ow ox oy nw b">createNoteElement()</code>函数。我们必须包含参数值，特别是id的数值和内容的字符串。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/476e7106f5a0cf8cb698a2d025c7cb1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T72aU4KxCJsJF5ii"/></div></div></figure><h2 id="93cc" class="oa mz iq bd na og oh dn ne oi oj dp ni lf ok ol nk lj om on nm ln oo op no oq bi translated">测试— getNotes()</h2><p id="5c1b" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">现在<code class="fe ow ox oy nw b">createNoteElement()</code>函数已经工作了，让我们添加一个初始加载函数，它创建并显示应用程序中的所有便笺。</p><p id="58e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在脚本的开始，在查询选择器之后，我们将包括以下内容:</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="5d14" class="oa mz iq nw b gy ob oc l od oe">getNotes().forEach(note =&gt; {<br/>  // create the HTML note element using the JSON data<br/>  const noteElement = createNoteElement(note.id, note.content);</span><span id="22c3" class="oa mz iq nw b gy oz oc l od oe">  // inside the app, insert the HTML note element before the add note button<br/>  notesContainer.insertBefore(noteElement, addNoteButton);<br/>});</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/820a0de95252d90f61abb72129a7260b.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/0*FB8W9g0EINE1Xj5-"/></div></figure><h2 id="c026" class="oa mz iq bd na og oh dn ne oi oj dp ni lf ok ol nk lj om on nm ln oo op no oq bi translated">测试—更新注释()</h2><p id="4548" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">如果我们点击便笺，更新文本区域并点击离开，则<code class="fe ow ox oy nw b">updateNote()</code>功能将运行并登录到控制台。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/ecb027632a4c82aeb7732682b412f6fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p24ChdkRlx5ORMsU"/></div></div></figure><h2 id="ddf0" class="oa mz iq bd na og oh dn ne oi oj dp ni lf ok ol nk lj om on nm ln oo op no oq bi translated">测试—删除注释()</h2><p id="746c" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">如果我们双击便笺，我们会得到一个确认提示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pl"><img src="../Images/062d792a126289d3eb5bcd168879fd35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CQyLfV9QNUixtitH"/></div></div></figure><p id="ca19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们单击确定，则<code class="fe ow ox oy nw b">deleteNote()</code>功能将运行并登录到控制台。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/4243d6a2820a1bfd9662bdde1e09d0e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wx6yVl-Y2y3OMp1L"/></div></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="cf73" class="my mz iq bd na nb or nd ne nf os nh ni jw ot jx nk jz ou ka nm kc ov kd no np bi translated">创建——向DOM添加新的注释元素</h1><p id="3b2d" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">说到添加注释，我们将首先获取对所有现有注释的引用。获取所有现有注释的原因是为了能够将新注释添加到数组的末尾，并最终重新保存数组。</p><p id="f5d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，在向数组添加注释的过程中，我们还会将它附加到DOM中的add按钮之前。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="ef0c" class="oa mz iq nw b gy ob oc l od oe">// adds a new note to the HTML and local storage</span><span id="68d0" class="oa mz iq nw b gy oz oc l od oe">function addNote() {<br/>  // retrieves all existing notes from local storage<br/>  const notes = getNotes()<br/><br/>  // construct a base note object<br/>  const noteObject = {<br/>    id: Math.floor(Math.random() * 100000),<br/>    content: ""<br/>  }<br/><br/>  // create the HTML note element<br/>  const noteElement = createNoteElement(noteObject.id, noteObject.content);<br/><br/>  // add the HTML note element to the DOM<br/>  notesContainer.insertBefore(noteElement, addNoteButton);<br/><br/>  // add the note object to the existing notes<br/>  notes.push(noteObject);<br/><br/>  // overwrite value currently in local storage with new array<br/>  saveNotes(notes)<br/>}</span></pre><p id="a705" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们通过在控制台中运行<code class="fe ow ox oy nw b">addNote()</code>来添加一个新的注释。这将创建一个带有占位符内容的空白便笺。刷新页面时，空的便笺条仍然会出现，因为在创建时，它也会保存到本地存储中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pm"><img src="../Images/34aeaa922ffcc4cbd3227cea0cdae892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3mr5oaWrXrUjvrcB"/></div></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="e713" class="my mz iq bd na nb or nd ne nf os nh ni jw ot jx nk jz ou ka nm kc ov kd no np bi translated">创建—通过添加按钮创建注释</h1><p id="f8f5" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">让我们为add note按钮附加一个事件监听器。就像让点击运行<code class="fe ow ox oy nw b">addNote()</code>功能一样简单。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="3706" class="oa mz iq nw b gy ob oc l od oe">addNoteButton.addEventListener("click", () =&gt; { addNote() });</span></pre><p id="1213" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在添加一个新的便笺会将它添加到本地存储和DOM中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/31f1c4b267f0c724affdf64fe77564cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e2dKB5d-YNpsFOOF"/></div></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="0363" class="my mz iq bd na nb or nd ne nf os nh ni jw ot jx nk jz ou ka nm kc ov kd no np bi translated">更新—更新现有注释</h1><p id="fc8b" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">与所有改变本地存储数据的函数一样，我们需要获取现有笔记的列表。然后，我们将过滤对象数组，找到具有相同id的对象。内容的值随后被覆盖并保存回本地存储。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="836e" class="oa mz iq nw b gy ob oc l od oe">// updates existing note</span><span id="0e1f" class="oa mz iq nw b gy oz oc l od oe">function updateNote(id, newContent) {<br/>  // retrieves all existing notes from local storage<br/>  const notes = getNotes()</span><span id="2e9b" class="oa mz iq nw b gy oz oc l od oe">  // filters through all the notes based on a set of criteria<br/>  // since it returns an array, select the first item<br/>  const targetNote = notes.filter(note =&gt; note.id == id)[0];</span><span id="ed3e" class="oa mz iq nw b gy oz oc l od oe">  // update the content of the note<br/>  targetNote.content = newContent;</span><span id="0c51" class="oa mz iq nw b gy oz oc l od oe">  // overwrite value currently in local storage with new array<br/>  saveNotes(notes);<br/>}</span></pre><p id="9165" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们更新应用程序中的注释，单击注释并刷新页面将会保留注释。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="fa3d" class="my mz iq bd na nb or nd ne nf os nh ni jw ot jx nk jz ou ka nm kc ov kd no np bi translated">删除—删除现有注释</h1><p id="cd23" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">从从本地存储中获取所有现有的笔记开始，我们将应用一个过滤器来返回除已删除的笔记对象(通过其id引用)之外的所有内容。然后，新数组被保存到本地存储中，元素被从DOM中删除。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="547c" class="oa mz iq nw b gy ob oc l od oe">function deleteNote(id, element) {<br/>  // deletes an existing note from the HTML and local storage<br/>	<br/>  // retrieves all existing notes from local storage<br/>  // filter to return all except the note to be deleted<br/>  const notes = getNotes().filter(note =&gt; note.id != id);</span><span id="c22f" class="oa mz iq nw b gy oz oc l od oe">  // overwrite value currently in local storage with new array<br/>  saveNotes(notes);</span><span id="44dd" class="oa mz iq nw b gy oz oc l od oe">  // remove the HTML note element from the DOM<br/>  notesContainer.removeChild(element);<br/>}</span></pre></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="d52f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就完成了便签应用——没有框架！</p><p id="d00d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">更多内容看</em> <a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ls">说白了. io </em> </strong> </a> <strong class="ky ir"> <em class="ls">。</em> </strong> <em class="ls">报名参加我们的</em><strong class="ky ir"><em class="ls"/></strong><a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ls">免费每周简讯点击这里</em> </strong> </a> <strong class="ky ir"> <em class="ls">。</em> </strong></p></div></div>    
</body>
</html>