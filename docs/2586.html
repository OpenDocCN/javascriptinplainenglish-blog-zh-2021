<html>
<head>
<title>Using Zustand and TypeScript to Make a To-Do List in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Zustand和TypeScript在React中制作待办事项列表</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/using-zustand-and-typescript-to-make-a-to-do-list-in-react-fe4a41e76748?source=collection_archive---------1-----------------------#2021-05-28">https://javascript.plainenglish.io/using-zustand-and-typescript-to-make-a-to-do-list-in-react-fe4a41e76748?source=collection_archive---------1-----------------------#2021-05-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="3f06" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">今天，让我们来了解一下Zustand如何通过制作待办事项列表来轻松管理React中的全局客户端状态。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/80c4f5b50afc400a32258a26f9b7a22d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKV3_Y4usDYZKPsNp1yCvA.png"/></div></div></figure><p id="7394" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当我第一次遇到Zustand时，我无法相信它是如此容易使用。学习曲线薄得令人难以置信。如果你熟悉不可变状态在React中是如何工作的，那么你会觉得使用Zustand很舒服。所以，事不宜迟，让我们给自己列一个待办事项清单。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="25ae" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">步骤1:设置我们的项目</h1><p id="7ba4" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">我们需要做的第一件事是获得一个基础项目设置，我们可以通过在终端/Powershell中使用下面的命令来完成。</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="dbbc" class="mj lc in mf b gy mk ml l mm mn">npx create-react-app zustand-todo-demo --template typescript</span></pre><p id="f757" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">运行此命令后，这将在React中为我们创建一个基本的starter typescript项目。接下来，导航到新创建的目录。</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="4c61" class="mj lc in mf b gy mk ml l mm mn">cd zustand-todo-demo</span></pre><p id="71c7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">并运行这些命令来安装我们将使用的包。</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="5aa7" class="mj lc in mf b gy mk ml l mm mn">npm install zustand @material-ui/core @material-ui/icons uuid</span><span id="7a20" class="mj lc in mf b gy mo ml l mm mn">npm install --save-dev @types/uuid</span></pre><p id="f1ba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来我们需要做的是删除<code class="fe mp mq mr mf b">src</code>文件夹中所有不必要的文件，并添加一些我们自己的文件。完成后，我们的<code class="fe mp mq mr mf b">src</code>文件夹应该是这样的。</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="06c4" class="mj lc in mf b gy mk ml l mm mn">src<br/>├── model<br/>│   └── Todo.ts<br/>├── App.tsx<br/>├── index.tsx<br/>├── react-app-env.d.ts<br/>└── todoStore.tsx</span></pre><p id="35ea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">完成这些步骤后，现在是时候在代码编辑器中打开我们的项目了。我将使用VS代码，但是你可以随意使用任何你喜欢的编辑器。</p><p id="ad20" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在是时候开始编码了！</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="78bb" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">步骤2:创建我们的Todo模型</h1><p id="718e" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">首先，在介绍Zustand之前，我们将为我们的待办事项列表创建一个模型，以描述每个待办事项的数据结构将是什么样子。打开<code class="fe mp mq mr mf b">Todo.ts</code>文件，将下面的代码放入其中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="6381" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的代码中没有太多要解释的，但是我们正在定义一个类型，TypeScript可以使用它来为我们提供自动完成功能，并确保传递正确的数据。</p><p id="49e6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们的模型已经创建好了，是时候介绍本教程的关键部分了，Zustand。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="6d18" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">步骤3:创建我们的Zustand商店</h1><p id="b331" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">我们现在将为我们的待办事项应用程序创建状态管理逻辑。这就是Zustand发挥作用的地方。</p><p id="a726" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下面的代码是我们的成品商店将看起来像什么。如果你不明白所有的事情，不要担心，因为我会一行一行地讲解。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="064d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mp mq mr mf b">Lines 6 — 11</code>我们这里有一个界面，定义了我们商店的外观。这有4个部分。我们必须在<code class="fe mp mq mr mf b">line 7</code>上做Todo，这是一个Todo类型的列表。在<code class="fe mp mq mr mf b">line 8</code>上，我们有一个名为addTodo的方法，你可能已经猜到了，这个方法将用于将Todos添加到我们的todo中。在<code class="fe mp mq mr mf b">line 9</code>上，我们有一个从待办事项列表中删除待办事项的方法。在<code class="fe mp mq mr mf b">line 10</code>上，我们有一个方法，给定列表中todo项的id，将切换它的完成状态。</p><p id="c591" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在已经定义了我们的接口，让我们深入到Zustand以及我们如何用它管理状态。</p><p id="5b47" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们正在创建自己的商店。你会注意到我们将使用钩子命名约定(useStore ),这是因为我们使用Zustand提供的钩子来访问我们的商店。稍后将详细介绍。我们正在使用Zustand中内置的一种叫做<code class="fe mp mq mr mf b">create</code>的方法，顾名思义，它负责创建我们的商店。<code class="fe mp mq mr mf b">create</code>函数采用一个有3个不同参数的箭头函数(在这个超级简单的教程中我们将只使用第一个参数),并返回一个匹配我们上面定义的接口的对象。这个箭头函数中的参数<code class="fe mp mq mr mf b">set</code>非常重要，因为它允许我们改变商店的状态。您将在下面的代码中看到这一点。</p><p id="5852" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mp mq mr mf b">Line 15</code>我们在这里做的是设置待办事项列表的初始状态。在这种情况下，我们每次都将其设置为空列表。也许在更真实的场景中，我们会进行网络调用或检查本地存储的数据来确定初始状态。</p><p id="2a21" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mp mq mr mf b">Lines 17 — 28</code>我们正在定义当我们的<code class="fe mp mq mr mf b">addTodo</code>方法稍后在我们的代码中被调用时，它将如何执行。这个方法需要注意的是，它只需要接受todo项的描述，我们使用一个名为uuid的库，我们使用一个spread操作符向数组中添加项(这是因为状态是不可变的，每次都必须重新创建)。你将在<code class="fe mp mq mr mf b">line 18</code>上看到我们正在调用我在上面简单描述过的set方法。基本上，这是一个箭头函数，它接受一个与我们上面定义的接口类型相匹配的参数。这个arrow函数返回一个对象，在这个对象中，我们可以得到部分更新的状态的样子(在这个例子中，更新的是我们的todos)。我们没有更新像我们不同的状态管理函数这样的东西，所以我们不必将它们传递给对象。</p><p id="41fe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mp mq mr mf b">Lines 29 — 32</code>我们正在定义我们的<code class="fe mp mq mr mf b">removeTodo</code>方法将在被调用时执行。我描述的关于集合和不可变状态的所有东西在这里仍然适用。这里需要注意的是，我们传递一个id，这样我们就知道要删除哪个元素。这里移除元素的方法是使用filter函数从数组中过滤出所有与传递的id匹配的元素(显然，应该只有一个)。</p><p id="89c2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mp mq mr mf b">Lines 34 — 42</code>我们正在定义我们的<code class="fe mp mq mr mf b">toggleCompletedState</code>方法。我上面讨论的关于set函数的所有内容在这里仍然适用。我们正在利用JavaScript内置的另一个数组函数(数组映射函数)。这个函数将获取一个数组(在这种情况下，我们的todos数组)并返回另一个相同长度的数组，除了它将被转换成不同的结构。在我们的例子中，我们使用map函数做的是利用另一个奇特的JavaScript特性，即三元运算符。所以如果<code class="fe mp mq mr mf b">line 37</code>上的条件为真，那么我们将在<code class="fe mp mq mr mf b">line 38</code>上运行代码，如果为假，那么<code class="fe mp mq mr mf b">line 39</code>上的代码将被执行。在<code class="fe mp mq mr mf b">line 38</code>上，我们翻转对象的完成状态；在<code class="fe mp mq mr mf b">line 39</code>上，我们只是返回同一个对象，因为我们不想改变完成状态，除非它与我们的id匹配。</p><p id="6178" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们的商店已经创建，实际上只有最后一步，那就是使用我们刚刚在用户界面中为React应用程序编写的代码。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="2589" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">第4步:在我们的反应应用程序中使用Zustand</h1><p id="dbe8" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">在我们继续之前。我想清理我们的<code class="fe mp mq mr mf b">index.tsx</code>文件中的代码，看起来像下面的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="a35d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">不用说了，让我们将Zustand连接到用户界面。下面是使用Zustand的用户界面的代码。不用担心，因为我将在下面介绍重要的部分。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="1d9e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本演练中，我不会触及Material-UI如何工作，因为这超出了本教程的范围，但本质上，它将允许我们轻松地设计和布局我们的应用程序。事不宜迟，让我们看看Zustand在我们的UI中是如何工作的。您将在<code class="fe mp mq mr mf b">line 44</code>上看到，我们正在调用函数<code class="fe mp mq mr mf b">useStore()</code>，该函数将接入我们在上面创建的Zustand商店。多亏了对象析构，我们可以取出所有的函数以及我们将在下面使用的状态。在<code class="fe mp mq mr mf b">line 67</code>上，我们调用了<code class="fe mp mq mr mf b">addTodo</code>方法，它将获取一个描述并在列表上创建一个新的待办事项。在<code class="fe mp mq mr mf b">line 81</code>上，我们正在切换待办事项的完成状态。每当我们选中或取消选中待办事项列表中每个列表项的复选框时，就会出现这种情况。在<code class="fe mp mq mr mf b">line 93</code>我们将从列表中删除一个待办事项。当垃圾桶图标被点击时，这个动作就会发生。最后，你将在<code class="fe mp mq mr mf b">line 75</code>上看到我们正在循环我们的列表，并为待办事项列表中的每一项生成一个<code class="fe mp mq mr mf b">ListItem</code>。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="0f54" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">包扎</h1><p id="e001" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">Zustand可能是我在React中使用过的最简单、最简单的状态管理解决方案。使用它很愉快，对于那些已经理解React的人来说，没有很陡的学习曲线。</p><p id="6882" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一如既往，我欢迎您的任何意见和反馈。请随意分享您最喜欢的React状态管理库。我很想听听。</p></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="673c" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">附加教程</h1><p id="fbce" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">这里是React中其他状态管理库的一些教程，供感兴趣的人参考。</p><div class="mu mv gp gr mw mx"><a rel="noopener  ugc nofollow" target="_blank" href="/making-a-react-to-do-list-with-redux-toolkit-in-typescript-dd852bfb2c67"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd io gy z fp nc fr fs nd fu fw im bi translated">用Redux Toolkit在TypeScript中制作React To-Do列表</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">今天我们将学习如何使用Redux来管理应用程序的状态，从而制作一个待办事项列表。</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl ks mx"/></div></div></a></div><div class="mu mv gp gr mw mx"><a rel="noopener  ugc nofollow" target="_blank" href="/managing-local-state-in-react-with-apollo-immer-and-typescript-e966abe58476"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd io gy z fp nc fr fs nd fu fw im bi translated">使用Apollo、Immer和TypeScript管理本地状态</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">我们将学习如何在Apollo应用中使用反应变量本地管理状态。</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="ng l"><div class="nm l ni nj nk ng nl ks mx"/></div></div></a></div></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h1 id="0ab1" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Github上的源代码</h1><div class="mu mv gp gr mw mx"><a href="https://github.com/13bfrancis/zustand-tut-1" rel="noopener  ugc nofollow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd io gy z fp nc fr fs nd fu fw im bi translated">13bfrancis/zustand-tut-1</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">这个项目是用Create React App引导的。在项目目录中，您可以运行:在…中运行应用程序</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">github.com</p></div></div><div class="ng l"><div class="nn l ni nj nk ng nl ks mx"/></div></div></a></div></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><h2 id="3bb3" class="mj lc in bd ld no np dn lh nq nr dp ll jv ns nt lp jz nu nv lt kd nw nx lx ny bi translated">进一步阅读</h2><div class="mu mv gp gr mw mx"><a href="https://bit.cloud/blog/sharing-types-between-your-frontend-and-backend-applications-l5qih48g" rel="noopener  ugc nofollow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd io gy z fp nc fr fs nd fu fw im bi translated">在前端和后端应用程序之间共享类型</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">您的后端API已经更新，可以返回新类型的数据。必须通知前端团队进行更新…</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">比特云</p></div></div><div class="ng l"><div class="nz l ni nj nk ng nl ks mx"/></div></div></a></div></div><div class="ab cl ku kv hr kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ig ih ii ij ik"><p id="2076" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="oa">更多内容请看</em><a class="ae ob" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="oa">plain English . io</em></strong></a><em class="oa">。报名参加我们的</em> <a class="ae ob" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="oa">免费周报</em> </strong> </a> <em class="oa">。关注我们关于</em><a class="ae ob" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="oa">Twitter</em></strong></a><a class="ae ob" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="oa">LinkedIn</em></strong></a><em class="oa"/><a class="ae ob" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="oa">YouTube</em></strong></a><em class="oa"/><a class="ae ob" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="oa">不和</em> </strong> </a> <em class="oa">。对增长黑客感兴趣？检查</em> <a class="ae ob" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="oa">电路</em> </strong> </a> <em class="oa">。</em></p></div></div>    
</body>
</html>