<html>
<head>
<title>Build your first Discord Bot with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Node.js构建你的第一个不和谐机器人</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/build-your-first-discord-bot-with-node-js-82d29ab0fa21?source=collection_archive---------8-----------------------#2021-03-24">https://javascript.plainenglish.io/build-your-first-discord-bot-with-node-js-82d29ab0fa21?source=collection_archive---------8-----------------------#2021-03-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="1ae9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这篇文章中，我们将推出一个简单的不和谐机器人在一个非常快速和简单的方式。Discord机器人可以为你做很多事情，例如从ex暴雪网站收集高级API数据，显示魔兽世界中的角色信息，跟踪用户编辑或删除消息的时间，或者欢迎新用户加入Discord服务器的简单功能。我将指导你创建一个不和谐机器人，开发机器人，最后托管机器人。所以，让我们开始吧！</p><p id="5143" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将使用<strong class="jm io"> Node.js </strong>来开发Discord bot。为什么是Node.js？因为它非常快。此外，它是异步的。这使得它可以更好地运行应用程序。<strong class="jm io">你只安装你目前需要的软件包</strong>。<strong class="jm io"> Node.js轻量高效</strong>。轻量级基本上意味着应用程序不需要在底层框架中运行大量代码来完成它应该完成的任务。</p><p id="54c0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">假设我有一个机器人，它会返回一条消息。我真的不需要检查其他不需要的包。它只使用执行所需的东西。以下是我们将使用的每个工具的正确链接。如果你已经下载了它们，请跳过这一部分。</p><ul class=""><li id="4a45" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated"><strong class="jm io"> Node.js </strong></li></ul><p id="d621" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kr" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">https://nodejs.org/en/</a></p><ul class=""><li id="e041" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated"><strong class="jm io"> Visual Studio代码</strong></li></ul><p id="5380" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae kr" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank">https://code.visualstudio.com/</a></p><h2 id="708b" class="ks kt in bd ku kv kw dn kx ky kz dp la jv lb lc ld jz le lf lg kd lh li lj lk bi translated">创建新的Discord应用程序</h2><p id="9209" class="pw-post-body-paragraph jk jl in jm b jn ll jp jq jr lm jt ju jv ln jx jy jz lo kb kc kd lp kf kg kh ig bi translated">在哪里创建机器人:<a class="ae kr" href="https://discord.com/developers/applications" rel="noopener ugc nofollow" target="_blank">https://discord.com/developers/applications</a>。在开始之前，你必须有一个不和谐的帐户和自己的服务器。</p><p id="402f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">★点击“新建应用”的蓝色按钮，在网站上创建一个新的Discord应用。这将带您到一个弹出窗口，如下所示。给机器人起一个你喜欢的名字，然后点击“创建”。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lq"><img src="../Images/614b103f49cb1c29bb1f93a50062e362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TDVagH8Q69IvfuB_5eWOVA.png"/></div></div></figure><p id="ceba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">★点击“创建”按钮后，您将被引导至一个如下所示的窗口:</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mc"><img src="../Images/63704a051a610c419a073a5ea741d5b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XJ2GfkplGJY2lN0bsN0UhA.png"/></div></div></figure><p id="6439" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果需要，您可以为机器人提供显示图片并添加描述。那完全是<strong class="jm io">可选</strong>。您将能够看到您的<strong class="jm io">客户端ID </strong>，我们将在开发机器人时使用。</p><p id="758e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">★继续，点击左边导航栏中的机器人选项。在那里你会发现一个“添加机器人”选项。点击它，你就创建了你的第一个Discord应用程序！祝贺你迈出了第一步。现在，你必须能够看到一个包含你的<strong class="jm io">令牌(密码)</strong>的窗口。你可以随时更换你的代币。窗口看起来像这样:</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mc"><img src="../Images/624ad1cec12798d25a2e1676c2481c1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MFJRq6nuKATqgWTyFUGHPA.png"/></div></div></figure><p id="d8c6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">★现在点击上面窗口左上角的“返回应用”。返回后，你会在导航栏中找到一个“文档”选项。单击它，然后从文档窗口的导航栏中选择“主题”下的“OAuth2”选项。现在，向下滚动到“机器人”部分—机器人授权流程。在那里，你会找到你的<strong class="jm io">邀请链接</strong>。我在下面的图片中突出显示了URL。将该链接的ID替换为您的客户端ID，这样就万事俱备了！</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi me"><img src="../Images/bd92dde2f3ebcc80c6619cb5d38e3792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OzEj51MTiqmO1uNCS4DDsQ.png"/></div></div></figure><p id="71fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在您已经有了您的ID、令牌和邀请链接，请将它们存储在一个文本文件中，这样您就不会丢失这些重要信息。<strong class="jm io">使用您自己的客户端ID，邀请链接和文本文件的令牌。不是照片上显示的那种。</strong></p><p id="6d17" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">★为了添加您的Bot进行授权，请将您的邀请链接粘贴到浏览器的新选项卡上。这将把你带到一个窗口，你应该选择一个你拥有的服务器，然后点击“授权”。恭喜你。！您已经成功地将机器人添加到您的服务器。当你打开你的服务器时，它应该在右侧显示你的机器人，如下图所示:</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mf"><img src="../Images/56f3a1c1ae0ffd3b7e6571179ac2dcb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lo6YDX4qFxQhUgyBBkCkPQ.png"/></div></div></figure><h2 id="1416" class="ks kt in bd ku kv kw dn kx ky kz dp la jv lb lc ld jz le lf lg kd lh li lj lk bi translated">npm软件包安装</h2><p id="09f9" class="pw-post-body-paragraph jk jl in jm b jn ll jp jq jr lm jt ju jv ln jx jy jz lo kb kc kd lp kf kg kh ig bi translated">在桌面上创建一个名为<strong class="jm io"> Hello-World-Bot </strong>的文件夹，并在Visual Studio代码中打开该文件夹。创建一个<strong class="jm io"> app.js </strong>文件。这将是我们的主文件，我们将在这里编写所有的代码。但在此之前，我们需要做些事情。在您的VS代码窗口的左侧，您的app.js文件所在的位置，右键单击并选择“在终端中打开”以打开<strong class="jm io"> powershell </strong>窗口。在powershell中键入"<em class="md"> npm init" </em>。(如果无法识别npm，请以管理员身份重新启动/更新您的计算机和/或重新启动visual studio代码)会有几个问题:</p><ul class=""><li id="f02d" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">对于软件包名称、版本、描述:按Enter键</li><li id="c9a5" class="ki kj in jm b jn mg jr mh jv mi jz mj kd mk kh kn ko kp kq bi translated">入口点:app.js(如果已经编写了app.js，则按Enter键)</li><li id="d128" class="ki kj in jm b jn mg jr mh jv mi jz mj kd mk kh kn ko kp kq bi translated">测试命令，git存储库:按Enter键</li><li id="2cfd" class="ki kj in jm b jn mg jr mh jv mi jz mj kd mk kh kn ko kp kq bi translated">关键词:你的名，你的姓</li><li id="5e28" class="ki kj in jm b jn mg jr mh jv mi jz mj kd mk kh kn ko kp kq bi translated">作者:你的全名，你的服务器名</li><li id="e32a" class="ki kj in jm b jn mg jr mh jv mi jz mj kd mk kh kn ko kp kq bi translated">许可证:按Enter键</li><li id="bb3d" class="ki kj in jm b jn mg jr mh jv mi jz mj kd mk kh kn ko kp kq bi translated">这可以吗:键入yes并按Enter键</li></ul><p id="e900" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们已经成功创建了package.json文件。为了在package.json文件中包含discord依赖项，请键入<code class="fe ml mm mn mo b">npm install discord.js --save</code> <em class="md">。</em></p><h2 id="e084" class="ks kt in bd ku kv kw dn kx ky kz dp la jv lb lc ld jz le lf lg kd lh li lj lk bi translated">开发不和谐机器人</h2><p id="dde6" class="pw-post-body-paragraph jk jl in jm b jn ll jp jq jr lm jt ju jv ln jx jy jz lo kb kc kd lp kf kg kh ig bi translated">★要启动节点服务器，也就是<strong class="jm io"> app.js </strong>文件，也就是我们的Discord bot，你在终端/控制台写<code class="fe ml mm mn mo b">node app.js</code>。要停止节点服务器，即停止我们的Discord bot，您可以同时按下这些按钮:Windows系统的<strong class="jm io">ctrl+c</strong>Windows系统的<strong class="jm io">T25】Windows系统的<strong class="jm io">，Mac系统的cmd + c </strong>以及Linux系统的<strong class="jm io"> ctrl + c </strong>。app.js文件的代码如下所示:</strong></p><pre class="lr ls lt lu gt mp mo mq mr aw ms bi"><span id="f91d" class="ks kt in mo b gy mt mu l mv mw">// Require discord.js package</span><span id="b05f" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">const Discord = require(“discord.js”);</strong></span><span id="4ca6" class="ks kt in mo b gy mx mu l mv mw">// Create a new client using the new keyword</span><span id="43d6" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">const client = new Discord.Client();</strong></span><span id="d99a" class="ks kt in mo b gy mx mu l mv mw">// We’re using a lot of strings like ready, reconnecting, disconnect, message, etc. So, instead of writing them individually it’s preferable to create an array to store these strings. That’s called a clean code.</span><span id="8fdd" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">const arr = [“./token.json”, “ready”, “message”, “!hello”, “!help”, “reconnecting”,”!bye”];</strong></span><span id="61e2" class="ks kt in mo b gy mx mu l mv mw">// Add a safer way to store the token (password)</span><span id="40a8" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">const {</strong></span><span id="c444" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">token</strong></span><span id="6570" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">} = require(arr[0]);</strong></span><span id="2632" class="ks kt in mo b gy mx mu l mv mw">// Display a message when the bot comes online. Here, arr[1] i.e. “ready” is an event.</span><span id="ae53" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">client.on(arr[1], () =&gt; {</strong></span><span id="eb40" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">console.log(`Logged in as ${client.user.tag}!`);</strong></span><span id="ee4c" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">});</strong> //` ` is a template string.</span><span id="c1ab" class="ks kt in mo b gy mx mu l mv mw">// Reconnecting event</span><span id="6a93" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">client.on(arr[5], () =&gt; {</strong></span><span id="8086" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">console.log(`This bot is trying to reconnect: ${client.user.tag}!`);</strong></span><span id="2a3e" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">});</strong></span><span id="ab3d" class="ks kt in mo b gy mx mu l mv mw">// Check for new messages. Here, msg is an object. We get an object in return so we created the msg object.</span><span id="c174" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">client.on(arr[2], msg =&gt; {</strong></span><span id="0601" class="ks kt in mo b gy mx mu l mv mw">// Failsafe</span><span id="b879" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">const msgContent = msg.content.toLowerCase();</strong></span><span id="7605" class="ks kt in mo b gy mx mu l mv mw">// Send back a reply when the specific command has been written by a user.</span><span id="8edd" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">if (msgContent === arr[3]){</strong></span><span id="be30" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">msg.reply(“Hello World!”);</strong></span><span id="afdc" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">}</strong></span><span id="c1d6" class="ks kt in mo b gy mx mu l mv mw">// !help command</span><span id="e037" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">else if (msgContent === arr[4]){</strong></span><span id="d837" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">msg.reply(“There are 2 commands: !hello !help”);</strong></span><span id="8cc1" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">}</strong></span><span id="648e" class="ks kt in mo b gy mx mu l mv mw">// !bye command</span><span id="6079" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">else if(msgContent === arr[6]){</strong></span><span id="5cb4" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">msg.reply(“Goodbye World!”);</strong></span><span id="d0a7" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">}</strong></span><span id="59ad" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">});</strong></span><span id="0c74" class="ks kt in mo b gy mx mu l mv mw">// Log in the bot using your token (password)</span><span id="d7b3" class="ks kt in mo b gy mx mu l mv mw"><strong class="mo io">client.login(token);</strong></span></pre><p id="7695" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该机器人特别试图连接到websocket，以便通过互联网进行通信。在“重新连接”事件中，机器人并不试图连接到互联网。如果您在任何操作系统(mac、windows、linux等)上难以浏览CMD..)，实际上可以打开一个visual studio代码的新窗口，通过visual studio代码托管bot。这完全没问题。您可以同时打开多个visual studio代码窗口。</p><h2 id="e04b" class="ks kt in bd ku kv kw dn kx ky kz dp la jv lb lc ld jz le lf lg kd lh li lj lk bi translated">你可以从下面的链接知道什么是Websocket和TCP:</h2><div class="my mz gp gr na nb"><a href="https://en.wikipedia.org/wiki/WebSocket" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd io gy z fp ng fr fs nh fu fw im bi translated">WebSocket -维基百科</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">WebSocket是一种计算机通信协议，通过单个TCP提供全双工通信通道</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">en.wikipedia.org</p></div></div></div></a></div><div class="my mz gp gr na nb"><a href="https://en.wikipedia.org/wiki/Transmission_Control_Protocol" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd io gy z fp ng fr fs nh fu fw im bi translated">传输控制协议-维基百科</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">传输控制协议(TCP)是互联网协议族的主要协议之一。它起源于…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">en.wikipedia.org</p></div></div><div class="nk l"><div class="nl l nm nn no nk np ma nb"/></div></div></a></div><h2 id="2bd2" class="ks kt in bd ku kv kw dn kx ky kz dp la jv lb lc ld jz le lf lg kd lh li lj lk bi translated"><strong class="ak">托管不和谐机器人</strong></h2><p id="178d" class="pw-post-body-paragraph jk jl in jm b jn ll jp jq jr lm jt ju jv ln jx jy jz lo kb kc kd lp kf kg kh ig bi translated">只要你能运行一个节点服务器，你可以用任何你想要的方式让T4托管这个机器人。</p><ol class=""><li id="7fa1" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh nq ko kp kq bi translated">你可以用<strong class="jm io"> Visual Studio代码</strong>托管Discord机器人，并且能够按照你的意愿开发机器人。这是通过在终端中运行命令<code class="fe ml mm mn mo b">node app.js</code>来完成的。</li><li id="056e" class="ki kj in jm b jn mg jr mh jv mi jz mj kd mk kh nq ko kp kq bi translated">您可以通过一个更高效的窗口来托管bot，这就是<strong class="jm io"> cmd </strong>(命令提示符)。在windows上你按下<strong class="jm io"> flag+ R </strong>然后你输入<strong class="jm io"> cmd </strong>和<strong class="jm io">按下enter </strong>。现在你已经打开了<strong class="jm io">命令窗口</strong>。您将需要使用<strong class="jm io"> cd </strong>命令进行导航。<strong class="jm io"> cd </strong>代表<strong class="jm io">变更目录</strong>。您需要使用<strong class="jm io"> cd后跟文件夹名称</strong>来导航到该文件夹。例如:<strong class="jm io"> cd hello-world-bot </strong>。要回到上一级，你要写<strong class="jm io"> cd..</strong>。这个命令窗口一开始会让人望而生畏，需要一段时间才能掌握它，因为它没有可视化的表示，只有文本。但是如果你在桌面上有一个包含机器人文件的文件夹，导航起来就很容易了。<strong class="jm io">首先打开cmd窗口，写入cd桌面和cd文件夹名。</strong></li></ol><h2 id="c390" class="ks kt in bd ku kv kw dn kx ky kz dp la jv lb lc ld jz le lf lg kd lh li lj lk bi translated">令牌安全</h2><p id="4c80" class="pw-post-body-paragraph jk jl in jm b jn ll jp jq jr lm jt ju jv ln jx jy jz lo kb kc kd lp kf kg kh ig bi translated">有一种安全的方法来存储您的bot的令牌，这样即使您向任何人展示您的源代码，其他用户也看不到该令牌。这是通过创建一个. json文件来完成的，在json文件中创建一个包含您的bot令牌的对象。在app.js文件中，我们只需要该文件，并将该文件的数据存储在一个变量中。</p><p id="0760" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在保存bot文件的文件夹中创建一个名为<strong class="jm io"> token.json </strong>的文件，例如<strong class="jm io"> app.js </strong>。</p><p id="3af8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将该代码粘贴到文件中。</p><p id="64df" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe ml mm mn mo b">{ "token" : "your_bots_token" }</code></p><p id="6f90" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你能够实现以上所有的东西，恭喜你！！你绝对可以去。一旦你启动你的节点服务器，你的不和谐机器人将在你的服务器上在线，并能够执行它的功能。大概是这样的:</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi nr"><img src="../Images/33b445f8d15e26920385faf69129ab77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xD6PydCAZwZFQU6RAsYVbQ.png"/></div></div></figure><h2 id="8506" class="ks kt in bd ku kv kw dn kx ky kz dp la jv lb lc ld jz le lf lg kd lh li lj lk bi translated">结论</h2><p id="6c25" class="pw-post-body-paragraph jk jl in jm b jn ll jp jq jr lm jt ju jv ln jx jy jz lo kb kc kd lp kf kg kh ig bi translated">我希望这篇文章对所有的技术爱好者有所帮助。我个人很喜欢开发我的第一个不和谐机器人。希望你也一样！</p></div></div>    
</body>
</html>