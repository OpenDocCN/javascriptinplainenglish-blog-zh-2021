# JavaScript 中自定义事件的完整指南

> 原文：<https://javascript.plainenglish.io/a-complete-guide-to-custom-events-in-javascript-4db599b49551?source=collection_archive---------5----------------------->

## 关于 JavaScript 中的自定义事件，您只需要知道

![](img/0ed41277bb7501c5d6d291d5e31c67d7.png)

***DOMContentLoaded*** 事件，在浏览器完成加载和解析 **HTML** 到 ***unload 事件的瞬间触发，*** 在用户离开你的站点之前触发。在 Web 应用程序中，事件几乎无处不在。这些事件有助于确定应用程序中刚刚发生了什么&用户当时的具体状态以及更多。

但是可用的 **JavaScript** 事件不足以描述应用程序的状态。

例如，当用户登录失败并且您希望父组件知道失败时，就没有这样的登录失败事件。

为了解决这些问题，我们当然可以用 JavaScript 为我们的应用程序创建自定义事件。

**我们将介绍:**

1.  如何在 **JavaScript** 中使用和创建自定义事件
2.  使用**客户事件**构造函数。
3.  调度**自定义事件**。
4.  自定义事件如何工作。
5.  在 JavaScript 中**拖动&放下**。
6.  在 JavaScript 中使用 ***对象析构。***

# 先决条件。

1.  **HTML&CSS。**
2.  ***JavaScrip (ES6)。***
3.  ***DOM & DOM 操纵。***

# 1.如何在 **JavaScript** 中创建自定义事件

创建自定义事件肯定有两种方法:

1.  使用**事件**构造函数。
2.  使用 **CustomEvent** 构造函数。

*可以使用事件构造函数创建自定义事件，如下:*

我们通过将事件名称传递给**事件构造函数来创建事件 **myevent，**。**事件名称区分大小写，因此我们将其命名为 **myEvent** 和 **MyEvent** 。

## a)。**气泡**

***bubbles*** 属性指定事件是否应该向上传播到父元素。

如果我们将此设置为 true，它将在子元素中被调度，父元素可以监听事件并基于此执行操作。这是大多数 **DOM** 事件的行为，对于自定义事件，它默认设置为 **false** 。如果我们只想让它分派一个特定的元素，我们可以通过 ***event.stopPropagation()停止事件的传播。***

## b)。可取消

这个名字包含了一切，cancelable 指定了事件是否应该被取消。

默认情况下，原生 DOM 事件是可取消的，因此我们可以对其调用***event . preventdeafult()***，如果自定义事件的 cancelable 设置为 false，这将阻止事件的默认操作，因为调用***event . preventdeafult()***不会执行任何操作。

## c)。组成

composed 属性指定事件是否应该从影子 **DOM** (使用 web 组件时创建的)冒泡到真正的 **DOM。**

如果 **bubbles** 被设置为 ***false*** ，这个属性的值就无关紧要了，因为我们明确地告诉事件不要向上冒泡。如果您想在 web 组件中调度一个自定义事件，并在 **real DOM** 中的父元素上监听它，那么 composed 属性需要设置为 true。

但是这种方法有一个缺点，因为我们不能通过侦听器发送数据，而且在大多数应用程序中，我们希望能够从事件被发送到侦听器的地方发送数据。为此我们可以使用 ***CustomEvent*** 控制器。

> 还可以使用 DOM 事件发送数据。

# 2.使用 CustomEvent 构造函数

可以使用 **CustomEvent** 构造函数创建自定义事件，如下所示:

通过 **CustomEvent** 构造函数创建一个自定义事件类似于使用 **Event** 构造函数创建一个自定义事件，唯一的区别在于作为第二个参数传递给构造函数的对象。在创建事件构造函数时，我们受到这样一个事实的限制，即我们不能通过事件将数据传递给侦听器。任何需要传递给监听器的数据都可以在初始化事件时创建的 ***detail*** 属性中传递。

# 3.调度自定义事件

创建事件后，您需要调度它们，事件可以被调度到任何扩展**event target**的对象，它们包括所有 **HTML** 元素和文档、窗口。

***例如:***

为了监听自定义事件，我们向您想要监听的元素添加了一个事件监听器。就像我们在原生 DOM 事件中做的一样。

# 4.自定义事件如何工作

为了理解我们如何在 JavaScript 应用程序中使用自定义事件，我们将构建一个简单的应用程序，允许用户添加配置文件并自动获得配置文件卡。

## 用户界面

创建一个文件夹，命名为任何你喜欢的名字，并在文件夹中创建一个 index.html**文件。**

将以下内容添加到*:*

*这将是页面的标记。*

*该页面有两个部分，第一部分是允许用户执行以下操作的表单:*

1.  ***通过拖拽&或手动选择上传图像。***
2.  ***输入姓名。***
3.  ***进入职业。***

*从表单中初始化的数据将显示在部分中，即 profile 卡中。而第二部分仅包含一些占位符文本和图像，则从表单接收的数据将覆盖内容占位符数据。*

*然后创建下面的 **style.css 文件:***

*最后创建一个 **index.js** 文件，这样我们就可以为应用程序添加功能。*

# *5.JavaScript 中的拖放*

*我们将添加通过拖放或手动选择上传图像的功能。为此，将以下内容添加到 index.js 文件中。*

*这允许我们监听允许拖放操作所需的事件**(拖拽、拖拽中心& drop)。***

*在 **handleDragOver** 函数中，我们确保被拖动的项目是一个文件，并将拖放效果设置为 copy，此外 **handleDragCenter** 也执行类似的功能，确保我们正在处理被拖动的文件。实际的工作发生在文件被丢弃的时候，我们使用 **handleDrop** 来处理它。*

*首先，我们阻止浏览器的默认操作，即在提交文件之前打开文件。我们还会验证这是否是一个图像，如果不是，我们会发送一条错误消息，让用户知道我们只接受图像文件。如果验证通过，我们将继续在下一步创建的***handle file upload***函数中处理文件。*

*现在，用以下内容更新 index.js 文件:*

*我们可以像您一样简单地添加事件监听器，并在事件监听器被触发时调用***handlecarddupdate***函数。*

# *6.JavaScript 中的对象析构*

****handle card update***接收事件作为参数。使用析构可以从**事件.细节.**中获取图像属性*

*将 profile 卡片中图片的 **src** 属性设置为事件中的图片 **URL** 。*

*要允许用户通过输入栏上传图像:*

*并且当用户选择图像时，将在文件输入上触发改变事件。我们可以处理第一个图像的上传，因为我们只需要一个图像的个人资料卡。*

*我们必须添加的下一个功能是更新姓名和职业:*

*这里我们监听 change 事件并调度 card update 事件，但是这一次数据不同，因为我们需要更新处理程序，以便能够处理图像以外的内容。*

*现在更新**handlecarddupdate**函数，看起来像上面的代码片段。我们再次使用对象析构从**事件.细节**中获取图像名称&职业，并在获取数据后将它们显示在 profile 卡上。*

> *当您从事件的角度考虑时，更容易理解被调度的自定义和本机 DOM 事件。*

*喜欢这篇文章吗？如果有，通过 [**订阅我们的 YouTube 频道**](https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true) **获取更多类似内容！***