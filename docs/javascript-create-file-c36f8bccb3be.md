# 如何用普通 JavaScript 在浏览器中创建和下载文件

> 原文：<https://javascript.plainenglish.io/javascript-create-file-c36f8bccb3be?source=collection_archive---------2----------------------->

## 我想知道这有多简单

![](img/c31cca6ef9533895304d5d1dbea4df58.png)

Source: the author

想知道 web 应用程序是如何生成文件并让你下载它们的吗？

一种常见的方法是在后端生成文件。然后，在浏览器中发生到文件的重定向，这导致下载。但是还有另一种方法:可以在浏览器中生成和下载文件。我们甚至不需要 JavaScript 库来实现这一点。这是它的工作原理。

# 用 JavaScript 生成文件

为了处理文件，浏览器中有一个 API。它被称为文件 API，并得到广泛支持。为了用它创建一个文件，我们创建了一个新的`File`类实例。就像下面的代码一样简单:

```
const file = new File(['foo'], 'note.txt', {
  type: 'text/plain',
})
```

必要的参数如下:

*   首先，一个数据数组——这可以是一个 Blob、一个 ArrayBuffer，或者像我们的例子一样，是一个兼容的字符串。
*   第二，文件名，包括结尾。
*   作为一个选项，我们传递文件的实际类型。

用于生成文件，包含`text/plain`类型数据(文本、HTML、CSV 等)的文件。)，这就是我们需要的一切。生成更抽象的文件类型需要使用 blobs 或缓冲区。

就目前而言，这就足够了。我们在浏览器中创建了一个新的 txt 文件。那么，下一步是什么？

# 下载文件

为了检查创建文件是否有效，我们需要访问它。访问它需要下载。为了下载文件，我们使用了一个小技巧:

我们生成一个包含文件引用的链接。然后，我们让 JavaScript 点击链接，这样文件就被下载了。但是我们从哪里得到文件在浏览器中的 URL 呢？

为了接收我们的文件 URL，我们使用了`URL.createObjectURL()`,它接收我们的文件对象作为参数。然后，通过设置链接的`download`属性，指定保存文件的默认名称。

最后，我们在 DOM 中挂载链接，人工点击它，并从 DOM 中删除它。以下是完整的代码:

已经完成了——感谢您的阅读！

*更多内容尽在*[***plain English . io***](http://plainenglish.io/)