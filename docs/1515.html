<html>
<head>
<title>Build an AR Drawing App with React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React搭建一个AR画图App</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/building-an-ar-drawing-app-using-react-5f47740a747c?source=collection_archive---------9-----------------------#2021-03-31">https://javascript.plainenglish.io/building-an-ar-drawing-app-using-react-5f47740a747c?source=collection_archive---------9-----------------------#2021-03-31</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="e796" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你刚刚学习了一种新的框架或语言，那么从构建简单、直接的应用程序到构建有许多活动部件的应用程序的跨越似乎是不可逾越的。至少，这是我在react中实现我的第一个项目时的感觉。我有一个充满热情的想法，但没有路线图、例子，甚至不确定它是否可行。</p><p id="63c9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我的目标是构建一个web应用程序，使用户能够绘制AR人脸过滤器，但我是react和javascript的新手，我不确定以我的技能水平是否能做到这一点。我的第一步是寻找有用的第三方库。谢天谢地，我找到了一个很棒的开源javascript库，名为<a class="ae ki" href="https://jeeliz.com/" rel="noopener ugc nofollow" target="_blank"> Jeeliz </a>。他们甚至有一个内置绘图组件和面部跟踪的面部过滤器！你可以试试这里的<a class="ae ki" href="https://jeeliz.com/demos/faceFilter/demos/canvas2D/faceDraw/" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi kj"><img src="../Images/76f3c8317182ed2b30294bf5617734ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*3C8Qvbu6KKTovFl0va2KJg.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The stock library face filter</figcaption></figure><p id="2c49" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是我想做的事情的一个很好的起点。尽管绘图部分不足以满足我的目的，但它给了我继续这个项目的信心。话虽如此，我仍然不知道我将如何实现一个可用的绘图界面，不同的笔画颜色，大小，擦除，并在完成后保存(你如何保存一个图像映射到视频饲料！？这对我来说是一个谜。)</p><p id="5507" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我在前端使用create-react-app，状态管理使用redux，后端使用rails API。第一个障碍是让Jeeliz AI面部识别库与我的react组件合作。我使用的库的一部分是一个大文件，包含了你在上面的面部过滤器的例子中看到的所有行为。我花了很多时间阅读这个文件，试图理解如何让它与react一起工作。我最终发现这个库是通过使用两个HTML画布来工作的。需要在我的react相机视图组件中创建一个画布来显示相机馈送。另一个画布将被映射到用户的面部，并且即使当用户倾斜或旋转他们的头部时，也将保持以他们的面部为中心。这个内部画布是绘画发生的地方。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kv"><img src="../Images/9524a43df6d4bab3d39cfe617eced6ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XmNFGjbmvK3gRmcaes4cTA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">This simple component brought my react app and the facial recognition library together!</figcaption></figure><p id="bb90" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个组件看起来很简单，但由于我没有HTML画布或显示视频提要的经验，我花了很长时间才弄明白，所以当我最终在我的网站上获得视频提要时，我欣喜若狂。我现在可以解决创建一个合适的绘图组件的问题了。在研究了HMTL画布之后，我意识到构建一个“好的”绘图应用程序是多么复杂。我希望这个应用程序有一个直观的界面和流畅的笔画。我很快意识到我的绘图组件也需要一个外部库。我很幸运地找到了另一个很棒的开源库，<a class="ae ki" href="https://github.com/jakubfiala/atrament.js?utm_source=designernews" rel="noopener ugc nofollow" target="_blank">at rement . js</a>。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi la"><img src="../Images/edfeab88d76e8eda07217c7948c1a9c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*JVxLMLfSBfJm446R_qOoww.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The strokes are smooth!</figcaption></figure><p id="078e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这一点上，我有两个不相关的库，我本质上希望它们成为一个。我的计划是用这个新的处理图片库替换Jeeliz face过滤器中已经存在的绘图组件。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/7a7ea3cb9b7ac9c994f69834811249e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/1*OY2FHx5WM1C7ogVfqkXRnw.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Scientific diagram of how I planned to mesh the two libraries.</figcaption></figure><p id="5b40" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当然，事实证明说起来容易做起来难。这些库本身很容易使用。如果我想要的只是创建一个画布，用Atrament库在上面画画，我需要导入这个库，按照他们的文档创建一个画布，这个库会处理剩下的事情。问题是Jeeliz面部过滤器库有着复杂的层次，我不能简单地插入一个装置的绘图组件。Jeeliz库有自己的绘图组件，以及对内置API的调用，该API执行基本操作，如启动和停止相机，每次更改后刷新画布，以及检查当前是否检测到人脸。它自己做了太多的事情，以至于我不得不找出从一个终端输入绘图信息的正确位置，以确保Jeeliz将它放在2D的HTML画布上，这个画布正被固定到检测到的人脸上。</p><p id="dc3e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是我第一次不得不阅读别人的外国复杂代码，理解它，并转换它。最后，我能够让这两个库工作了，因为Atrament绘图库有一个漂亮的编程绘图选项。这允许我通过将绘制笔画的坐标提供给Jeeliz面部过滤器库的事件监听器来连接这些库。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi lc"><img src="../Images/466f6099d69cc9de88a763f67425439a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qELtfNDBIu4VhmYQ9x_Z-A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Mouse down and Mouse move event listeners from Jeeliz library.</figcaption></figure><p id="de48" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的代码中，您可以看到鼠标按下和鼠标移动的事件侦听器。以前，他们使用canvas API (CTX)来绘制，但现在，他们使用鼠标的坐标来调用atrament.draw，以显示用户做出的笔画。我还删除了Jeeliz面部滤镜中最初的华丽框架，但是将图像映射到面部的能力使得在绘制滤镜后尝试滤镜变得容易。</p><p id="6c6e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">结果是一个应用程序，你可以绘制面部过滤器，保存它们，稍后试用，并浏览其他用户绘制的过滤器。以下是绘图界面的最终外观:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ld"><img src="../Images/82c616ed4e0b54a2ba9adb756f717a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*UxtKS4GHCkcvXUbBtk4sTA.gif"/></div></figure><h1 id="8fba" class="le lf in bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="230e" class="pw-post-body-paragraph jk jl in jm b jn mc jp jq jr md jt ju jv me jx jy jz mf kb kc kd mg kf kg kh ig bi translated">总的来说，我从开发这个应用中学到了很多。有太多的时刻，我觉得这是不可能的，我不能让它工作，但成品让我很高兴，我很高兴与朋友分享它，看看他们创造了什么。可以试试这里的app <a class="ae ki" href="http://facepaint.patriciaarnedo.com" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="6989" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mh">更多内容尽在</em><a class="ae ki" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mh">plain English . io</em></strong></a></p></div></div>    
</body>
</html>