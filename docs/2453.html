<html>
<head>
<title>You’re Over-Engineering Your Vue Forms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你过度设计了你的Vue表单</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/youre-over-engineering-your-vue-forms-c9f90dab55c1?source=collection_archive---------12-----------------------#2021-05-20">https://javascript.plainenglish.io/youre-over-engineering-your-vue-forms-c9f90dab55c1?source=collection_archive---------12-----------------------#2021-05-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/de8d77e7fba8341125118d83c2277196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XJgyvx1e7F7N2XuIqbf04A.png"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk">Your Vue forms could look like this. (Created using <a class="ae ja" href="https://twitter.com/carbon_app" rel="noopener ugc nofollow" target="_blank">@carbon_app</a>)</figcaption></figure><h2 id="0a69" class="jb jc jd bd b dl je jf jg jh ji jj dk jk translated" aria-label="kicker paragraph">Vue中的表单</h2><div class=""/><div class=""><h2 id="1410" class="pw-subtitle-paragraph kj jm jd bd b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dk translated">如何快速创建干净的表单组件</h2></div><p id="1885" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">几乎每个应用程序都包含某种形式。无论你是在构建一个todo应用程序，一个聊天机器人，还是下一个克隆的俱乐部会所，你很可能至少需要构建一个。</p><p id="6710" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">Vue的主要卖点之一是它的反应能力和数据绑定系统。如果您以前使用过它，您肯定会遇到将数据绑定到模板元素或子组件的<code class="fe lx ly lz ma b">v-model</code>和其他变体。</p><p id="eefe" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">这通常也是构建新表单时首先想到的事情。</p><p id="2601" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">"只需添加一些输入标签，并在每个标签上添加v-model . "— <em class="mb">不知情的开发人员</em></p><p id="6424" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated"><code class="fe lx ly lz ma b">v-model</code> <strong class="ld jn"> </strong>很棒，在很多Vue组件中都有它(当之无愧)的位置。</p><p id="c6a0" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">但是正如编程中经常出现的情况，通常会有更多的解决方案需要考虑。有时，这些其他解决方案对于特定的用例更有效。</p><p id="69ce" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">因此，让我们来看看如何提升我们的表单，花更多的时间编写实际上需要脑力的东西。</p></div><div class="ab cl mc md hr me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ig ih ii ij ik"><h1 id="b85d" class="mj mk jd bd ml mm mn mo mp mq mr ms mt ks mu kt mv kv mw kw mx ky my kz mz na bi translated">v型车的问题是</h1><p id="fd5f" class="pw-post-body-paragraph lb lc jd ld b le nb kn lg lh nc kq lj lk nd lm ln lo ne lq lr ls nf lu lv lw ig bi translated">使用<code class="fe lx ly lz ma b">v-model</code>是有代价的。</p><p id="c109" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">当您在表单组件中使用<code class="fe lx ly lz ma b">v-model</code>时，您将数据从组件双向绑定到表单中的一些输入标签或子组件。这要求您将属性添加到模板中要使用它的每个标签上。</p><p id="1022" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">让我们看一个简单的登录表单:</p><figure class="ng nh ni nj gt ip"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="dff7" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">我们的<code class="fe lx ly lz ma b">login</code>函数可能看起来像这样:</p><figure class="ng nh ni nj gt ip"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="b6f4" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">这段代码很好，但是为每个标签键入<code class="fe lx ly lz ma b">v-model</code>会很快变得多余。想象一下一个更复杂的注册页面，比如一个金融科技应用。您可能需要收集关于用户的金融专业知识、历史和情况的数据。</p><p id="c4b8" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">这可能很快导致具有许多不同类型输入的长表单。</p><p id="585a" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">你可能会说使用<strong class="ld jn"> v-for </strong>可以很容易地解决这个问题，在某种程度上你是对的。</p><p id="1706" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">如果你只有一堆文本输入，你可能会没事。</p><p id="e690" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">但是如果你有不同的输入类型，一些<em class="mb">文本</em>，一些<em class="mb">数字</em>和一个<em class="mb">密码</em>字段呢？</p><p id="874d" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">现在添加对不同标签的需求，如<code class="fe lx ly lz ma b">textarea</code>或定制子组件。您最终将一个对象的<code class="fe lx ly lz ma b">inputs</code>数组作为道具传递给一个<strong class="ld jn"> FormFields </strong>组件，并使用一堆复杂的逻辑和/或插槽来创建您原本在模板中输入的内容的过度工程版本。</p><p id="ab9b" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">但至少它现在是可重复使用的，对吗？</p><figure class="ng nh ni nj gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi nm"><img src="../Images/597c041fcefc3dc3c434a0b7423b5253.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dbjL9SvCRtXsjKZYhbnj8w.jpeg"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk">Dev explaining how abstracting forms into a global component will “clean up” our codebase. (Found on knowyourmeme.com)</figcaption></figure><p id="e66a" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">一旦你首先想起<code class="fe lx ly lz ma b">v-model</code>的用途，这个架构中的缺陷就变得更加紧迫。</p><p id="9d60" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">这里是摘自Vue文档的第一句话:</p><p id="83a7" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">您可以使用<code class="fe lx ly lz ma b">v-model</code>指令在表单输入、textarea和select元素上创建<strong class="ld jn">双向数据绑定</strong>。</p><p id="1829" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">用于<strong class="ld jn">双向数据绑定</strong>。但是<strong class="ld jn">你不需要在登录表单、注册表单或财务问卷上进行双向数据绑定</strong>！</p><p id="e2c0" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">用户输入数据，提交数据，如此而已。</p><p id="3f04" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">在很多情况下，您根本不需要组件来更新输入中的数据。</p><h1 id="8b6f" class="mj mk jd bd ml mm nn mo mp mq no ms mt ks np kt mv kv nq kw mx ky nr kz mz na bi translated">使用Object.fromEntries</h1><p id="057a" class="pw-post-body-paragraph lb lc jd ld b le nb kn lg lh nc kq lj lk nd lm ln lo ne lq lr ls nf lu lv lw ig bi translated">处理提交的一种方法是在各自表单的<code class="fe lx ly lz ma b">FormData</code>上使用<code class="fe lx ly lz ma b">Object.prototype.fromEntries</code>。</p><p id="b042" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">想想上一个例子中的登录表单。另一种可以让它工作的方法是完全释放任何<code class="fe lx ly lz ma b">v-model</code>和<code class="fe lx ly lz ma b">v-on:click</code>处理程序，只依赖好的旧JavaScript表单来完成这项工作。</p><figure class="ng nh ni nj gt ip"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="842c" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">如果您需要复习一下为什么这样做，没有指定<code class="fe lx ly lz ma b">type</code>属性的<code class="fe lx ly lz ma b">form</code>标签中的<code class="fe lx ly lz ma b">button</code>标签被分配了<code class="fe lx ly lz ma b">submit</code>类型，并在单击时触发父<code class="fe lx ly lz ma b">form</code>标签<code class="fe lx ly lz ma b">submit</code>事件。然后，<code class="fe lx ly lz ma b">submit</code>事件用一个<code class="fe lx ly lz ma b">Event</code>对象调用登录函数，该对象包含一个引用表单元素的<code class="fe lx ly lz ma b">target</code>属性。</p><p id="5896" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">让我们来看看我们闪亮的新<code class="fe lx ly lz ma b">login</code>功能。</p><figure class="ng nh ni nj gt ip"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="10a2" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">我们在这里做的是将表单元素传递给<code class="fe lx ly lz ma b">FormData</code>构造函数，它返回“一组表示表单字段及其值的键/值对”(<a class="ae ja" href="https://developer.mozilla.org/en-US/docs/Web/API/FormData" rel="noopener ugc nofollow" target="_blank">https://developer.mozilla.org/en-US/docs/Web/API/FormData</a>，MDN)。</p><p id="46c6" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">然后，我们将返回值从<code class="fe lx ly lz ma b">new FormData</code>构造函数传递给<code class="fe lx ly lz ma b">Object.fromEntries</code>，将<code class="fe lx ly lz ma b">FormData</code>转换成<code class="fe lx ly lz ma b">Object</code>。</p><p id="557f" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">既然我们现在已经有了简单对象属性的值，我们可以继续使用析构并简单地将相关值传递给<code class="fe lx ly lz ma b">loginWithUsernameAndPassword</code>函数来获取我们需要的值。</p><p id="fb43" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">该方法不创建双向绑定，因此只需创建模板并提取登录函数中的值。</p><h1 id="ea29" class="mj mk jd bd ml mm nn mo mp mq no ms mt ks np kt mv kv nq kw mx ky nr kz mz na bi translated">警告</h1><p id="6083" class="pw-post-body-paragraph lb lc jd ld b le nb kn lg lh nc kq lj lk nd lm ln lo ne lq lr ls nf lu lv lw ig bi translated">请注意，由于此方法不创建任何双向绑定，因此当组件重新呈现时，所有用户输入的值都将丢失。如果使用这种方法，<strong class="ld jn">不要使用v-model </strong>之类的反应属性绑定组件内的任何元素。包含<code class="fe lx ly lz ma b">v-model</code>的输入发出的每个更新事件将导致组件重新呈现，清除所有非反应性输入字段。</p></div><div class="ab cl mc md hr me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ig ih ii ij ik"><h1 id="863c" class="mj mk jd bd ml mm mn mo mp mq mr ms mt ks mu kt mv kv mw kw mx ky my kz mz na bi translated">最后的想法</h1><p id="9d44" class="pw-post-body-paragraph lb lc jd ld b le nb kn lg lh nc kq lj lk nd lm ln lo ne lq lr ls nf lu lv lw ig bi translated">表单是一种非常常见的组件类型。尽管开发人员经常使用它们，但人们很少花时间优化他们的表单工作流，即使这可能会在可读性、开发时间和体验方面产生巨大的差异。</p><p id="2731" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">我希望你喜欢这篇关于一种方法的小文章，我已经学会喜欢这种方法，并且已经在多个产品级项目中应用了。</p><p id="ea78" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">如果你有另一种在Vue中构建干净有效的表单的方法，我很乐意在评论中听到。</p><p id="89ae" class="pw-post-body-paragraph lb lc jd ld b le lf kn lg lh li kq lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated"><em class="mb">更多内容尽在</em><a class="ae ja" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="mb">plain English . io</em></a></p></div></div>    
</body>
</html>