<html>
<head>
<title>What is the most painful part of using TypeScript?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TypeScript最痛苦的是什么？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/what-is-the-most-painful-part-of-using-typescript-62c3a7c4d9c5?source=collection_archive---------17-----------------------#2021-01-11">https://javascript.plainenglish.io/what-is-the-most-painful-part-of-using-typescript-62c3a7c4d9c5?source=collection_archive---------17-----------------------#2021-01-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/1567ee0dd1331923d452c5840547e851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mAVE-XdLfyRWLEjBVZO39A.png"/></div></div></figure><h2 id="b580" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">一般使用TypeScript最痛苦的部分是什么？</strong></h2><p id="2c01" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">处理来自JavaScript的值。</p><h2 id="d299" class="jv jw in bd jx jy jz dn ka kb kc dp kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">为什么？</strong></h2><p id="911f" class="pw-post-body-paragraph kr ks in kt b ku kv kw kx ky kz la lb ke lc ld le ki lf lg lh km li lj lk ll ig bi translated">对来自输入源(比如html表单)的值感到困难的原因是<strong class="kt io">你事先没有确切的数据类型</strong>。我的意思是，你不能用输入值来写函数，因为输入值可以是任何东西，另一个函数，一个数字，一个字符串，一个对象，或者其他任何东西。这就是为什么许多程序员在这种情况下尽量避免使用名为“any”的类型。一个具有高级TypeScript知识的软件开发人员从不使用“any”类型，因为这等于根本不使用TypeScript，而只是编写本地JavaScript。</p><p id="5107" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">问题很明显:<strong class="kt io">有什么方法可以将一个JavaScript值放入TypeScript上下文中？</strong>简短的回答是:是的。详细答案，我们来看一个例子:</p><p id="f62e" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">您有一个输入值——不管它来自什么源——您希望对它使用TypeScript上下文。但是如何将未知类型的输入值传递给TypeScript提供的类型系统呢？这是一个经常被误解的过程，虽然流程非常简单。</p><p id="db6e" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">首先，让我们明确我们的目标是什么。在JavaScript中，大多数情况下我们需要一些值级验证。多亏了所谓的“动态类型系统”，我们可以在运行时做到这一点。您不需要为此键入脚本。在这种情况下，JavaScript的缺点是我们在运行之前没有类型信息，因为这种语言没有静态类型系统。这正是TypeScript对我们工作的贡献。TypeScript只有一个静态类型系统，这意味着它将存在于我们的程序中，直到我们编译它。结合使用TypeScript提供的静态类型系统和JavaScript使用的动态类型系统，我们可以模拟强类型编程语言的功能。换句话说，我们可以在运行时和编译时验证我们的值。让我们看一下我们的例子。给定一个输入值，它将是一个如我们所期望的代表用户的对象。</p><figure class="lr ls lt lu gt jo"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="c6ea" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">关键是isValidUser函数及其用法。isValidUser函数是一个所谓的<a class="ae lx" href="https://www.typescriptlang.org/docs/handbook/advanced-types.html" rel="noopener ugc nofollow" target="_blank">类型守卫</a>，这是一个TypeScript特性。它用于在静态类型级别检查一个值，然后在检查后利用该块中TypeScript提供的可能性。实际上，这意味着如果在if中使用IsValidUser函数，就可以在if的给定分支上为测试值实现类型安全。为什么？因为在测试之后，TypeScript类型系统可以从一个给定值可靠地确定它将来可以是什么类型。因此，在if的真实分支中，如第29行所示，user1的静态类型将是user，尽管这个user1值以前是作为一个简单的JavaScript值包含的，没有静态类型。如果您愿意，可以在isValidUser类型保护函数中使用任何其他检查，这很好，因为它允许您在编译和运行时检查给定值。</p><p id="9cb3" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">类型保护函数有一个特殊的返回值，它只不过是一个带有关键字的结构，正如您在示例中看到的那样。类型保护函数体中的任何内容都可以是任何内容，唯一的要求是返回一个逻辑类型。这个true / false值将决定被测试的值是否属于返回值中指定的类型。类型保护函数的输入参数应该总是被测试的值。未知的内置TypeScript类型非常适合类型保护，因为它有助于避免使用any类型。</p><p id="6f33" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">如果你问我，你可能想把类型保护函数放在有相关类型定义的文件中。</p><p id="c8fa" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">例如:</p><figure class="lr ls lt lu gt jo"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="1e73" class="pw-post-body-paragraph kr ks in kt b ku lm kw kx ky ln la lb ke lo ld le ki lp lg lh km lq lj lk ll ig bi translated">总之，在TypeScript中，官方的建议是通过正确使用类型保护函数将没有静态类型的值传递给静态类型系统。</p></div></div>    
</body>
</html>