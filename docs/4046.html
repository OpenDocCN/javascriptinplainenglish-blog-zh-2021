<html>
<head>
<title>How to Build and Publish an NPM Module?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何构建和发布NPM模块？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-build-and-publish-an-npm-module-b6478d871a0c?source=collection_archive---------18-----------------------#2021-08-12">https://javascript.plainenglish.io/how-to-build-and-publish-an-npm-module-b6478d871a0c?source=collection_archive---------18-----------------------#2021-08-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="e9dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这比看起来容易。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a9037c817965b3a8f2aa0a881b05b897.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CqIWFK6LvrNC3_wc"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@pinjasaur?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Paul Esch-Laurent</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="4306" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">介绍</h1><p id="dbc7" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">除了在互联网上无处不在之外，Javascript最大的优点之一就是庞大的(并且不断增长的)开发者社区。当<a class="ae ky" href="https://www.ecma-international.org/technical-committees/tc39/?tab=general" rel="noopener ugc nofollow" target="_blank"> TC39 </a>在处理<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Language_Resources" rel="noopener ugc nofollow" target="_blank"> ECMA的脚本</a>时，人群涌向<a class="ae ky" href="https://github.com/npm/npm-expansions" rel="noopener ugc nofollow" target="_blank"> NPM </a>(节点包管理器)为他们的应用程序添加一点魔法。本文解释了在NPM注册中心上从头构建和列出一个包的步骤。它假设初级到中级的Javascript知识。</p><h1 id="9ff7" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">什么是NPM？</h1><p id="ab0c" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated"><a class="ae ky" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> NPM </a>是Javascript运行时环境<a class="ae ky" href="https://nodejs.dev/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>的默认包管理器。它带有命令行客户端和世界上最大的软件注册中心之一。npm上列出的一些最受欢迎的名字是React、Express和Moment。来自各大洲的开发人员通过构建有用的模块来为npm做出贡献，这些模块使世界各地的其他工程师能够高效地构建可靠的软件应用程序。</p><p id="c30c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你感觉特别利他，并且有一个关于npm模块的好主意，那就跟着做吧。</p><h1 id="2240" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">该模块</h1><p id="013f" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">我们今天要建造的模块叫做<strong class="jm io"> yumcha，</strong>意思是喝茶的同时吃点点心。相当于公司的咖啡休息时间。每次调用该模块都会得到一个无用的网站，供您在喝咖啡休息时浏览。</p><h1 id="7b39" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">安装节点</h1><p id="d21a" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">确保您的计算机上安装了Node.js。如果已经安装了，那么在终端中运行下面的命令将会得到版本的响应。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="11b7" class="mh la in md b gy mi mj l mk ml">node -v<br/>v12.22.1 //node version installed on the machine</span></pre><p id="57e6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">或者，也可以在这里下载<a class="ae ky" href="https://nodejs.dev/" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="2fa0" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">创建并初始化项目</h1><p id="c12d" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">现在你的机器已经设置好了，让我们初始化一个新的项目。移动到终端窗口，键入以下命令(一次一个)</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="0042" class="mh la in md b gy mi mj l mk ml">mkdir yumcha<br/>cd yumcha</span></pre><p id="baa6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">已创建新的空目录yumcha。npm命令行客户端作为Node.js安装的一部分安装。因此，您只需输入以下命令，就可以在空目录中启动一个新项目。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="2ded" class="mh la in md b gy mi mj l mk ml">npm init --yes</span></pre><p id="0a11" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> npm init </strong>命令基本上是在yumcha目录中创建一个package.json文件，并且<strong class="jm io"> yes </strong>标志<strong class="jm io">T5】指示npm使用<em class="mm">默认设置</em>用于名称、版本、主要属性等。该文件应该如下所示:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="fd67" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Package.json是节点模块中最重要的文件之一，当您希望将它发布到npm时更是如此。名称字段将是npm上显示的字段，其他人可以使用它来安装模块。另一个需要注意的重要因素是版本。公开列出的npm模块的版本必须在每次向npm推送更新时<strong class="jm io">更新(按照语义版本化规则</strong>)。</p><h1 id="b7fa" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak"> API还是命令行？</strong></h1><p id="ce62" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">NPM模块可以通过导入js文件或在终端中使用关键字来使用。根据模块提供的实用程序，它可以以任何一种方式提供。我们将为<strong class="jm io">API和命令行启用雅木茶。这样做的关键是修改上面创建的package.json。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/9a4b64d323a23dcf5ed7ad3db024ba6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vRIvCn-K3xbLqb4va3Ghog.png"/></div></div></figure><p id="a627" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">package.json中的<strong class="jm io">主字段</strong>定义了进入模块的<em class="mm">主入口点</em>。当包被导入到js文件中时，如下所示</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="95a5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">加载模块的<strong class="jm io"> index.js </strong>(即将创建)文件。</p><p id="bfad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在文件<strong class="jm io">、</strong>中添加一个新字段<strong class="jm io"> bin </strong>，用于将命令<strong class="jm io"> yumcha </strong>(包名)映射到文件<strong class="jm io"> yumcha-bin.js </strong>(即将创建)文件<strong class="jm io">。</strong>只需在终端输入软件包名称，就可以在命令行中使用该软件包。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="3aea" class="mh la in md b gy mi mj l mk ml">$ yumcha<br/><a class="ae ky" href="https://trypap.com/" rel="noopener ugc nofollow" target="_blank">https://trypap.com/</a></span></pre><h1 id="13eb" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">添加功能</h1><p id="fac9" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">现在我们有了背景，让我们给yumcha一些力量。首先创建4个新文件，目录如下所示:</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="09a6" class="mh la in md b gy mi mj l mk ml">Yumcha<br/>  - <strong class="md io">site-list.js</strong><br/>  - <strong class="md io">util.js</strong><br/>  - <strong class="md io">index.js</strong><br/>  - <strong class="md io">yumcha-bin.js</strong><br/>  - package.json</span></pre><h2 id="f690" class="mh la in bd lb mq mr dn lf ms mt dp lj jv mu mv ln jz mw mx lr kd my mz lv na bi translated"><strong class="ak"> Site-list.js </strong></h2><p id="3a49" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">这个文件将有一个无用网站的列表，作为模块的存储库/数据源。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h2 id="69c2" class="mh la in bd lb mq mr dn lf ms mt dp lj jv mu mv ln jz mw mx lr kd my mz lv na bi translated"><strong class="ak"> Util.js </strong></h2><p id="b46d" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">对该模块的每次调用都将从上述列表中选择一个网站作为响应。这个文件将负责从数组中随机选择一个网站。这可以如下实现，</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="88b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">虽然util.js中只定义了一个函数以保持简短，但它可以扩展为拥有<em class="mm">多个函数和实现</em>。</p><h2 id="d66f" class="mh la in bd lb mq mr dn lf ms mt dp lj jv mu mv ln jz mw mx lr kd my mz lv na bi translated"><strong class="ak"> Index.js </strong></h2><p id="4c3c" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">既然已经处理了模块的行为，让我们把重点放在公开它的功能上。Index.js充当模块提供的所有函数的集合。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="33c4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">虽然index.js只导出<em class="mm">一个函数</em>，但在实际模块中，它可以是一个很长的列表。查看一个流行的npm模块<a class="ae ky" href="https://www.npmjs.com/package/uuid" rel="noopener ugc nofollow" target="_blank"> UUID </a>的<a class="ae ky" href="https://gist.github.com/kritiketan/b4d76c36f83e13fdf21ddca12ba8f872" rel="noopener ugc nofollow" target="_blank"> index.js </a>文件。</p><p id="9e95" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> Yumcha-bin.js </strong></p><p id="822b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，设置模块<strong class="jm io">的终端使用。</strong>该文件在每次终端使用关键字<strong class="jm io"> yumcha </strong>时运行。最简单的版本是调用util函数getUrl，并在命令行中显示它的响应。这可以通过以下方法实现:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="ef79" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">或者，可以设置bin文件来处理多个参数、标志甚至菜单(这超出了本文的范围)。</p><h1 id="c111" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">在本地测试</h1><p id="be16" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">是时候试驾我们新开发的模块了。再到终端。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="7ee7" class="mh la in md b gy mi mj l mk ml">cd ~/yumcha</span></pre><p id="e917" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">确保您在项目目录中之后，使用。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="f496" class="mh la in md b gy mi mj l mk ml">node .</span></pre><p id="caac" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上面的命令运行您的模块，并建立变量yumcha和文件(yumcha-bin.js)之间的连接，以便在终端中使用时运行。您可以在终端中键入关键字yumcha来尝试一下。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="769c" class="mh la in md b gy mi mj l mk ml">yumcha<br/>// <a class="ae ky" href="https://smashthewalls.com/" rel="noopener ugc nofollow" target="_blank">https://smashthewalls.com/</a></span></pre><h1 id="7f5c" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">出版给NPM</h1><p id="3557" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">是时候与世界分享你的作品了。将包发布到npm之前需要注意的事项，</p><ol class=""><li id="50b6" class="nb nc in jm b jn jo jr js jv nd jz ne kd nf kh ng nh ni nj bi translated">确保package.json中的名称可用。在npm <a class="ae ky" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank">注册表</a>上快速搜索可以证实这一点。</li><li id="4a89" class="nb nc in jm b jn nk jr nl jv nm jz nn kd no kh ng nh ni nj bi translated">在<a class="ae ky" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>上创建账户</li></ol><p id="88a4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦你确定了以上几点，回到你的终端窗口</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="ed82" class="mh la in md b gy mi mj l mk ml">cd ~/yumcha<br/>npm login</span><span id="433c" class="mh la in md b gy np mj l mk ml">Username: abc-xyz<br/>Password: *******<br/>Email: (this IS public) abc@xyz.com<br/>Logged in as abc-xyz on <a class="ae ky" href="https://registry.npmjs.org/" rel="noopener ugc nofollow" target="_blank">https://registry.npmjs.org/</a>.</span></pre><p id="b55a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦通过身份验证，您需要做的就是</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="16c5" class="mh la in md b gy mi mj l mk ml">npm publish</span></pre><p id="eebc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">几秒钟后，该模块将在npm注册表上可用，你可以享受你的努力带来的荣耀。该模块将可以使用npm命令行客户端公开下载。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="b4a3" class="mh la in md b gy mi mj l mk ml">npm install yumcha</span></pre><p id="656a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您希望关闭该模块，请使用</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="fe57" class="mh la in md b gy mi mj l mk ml">npm unpublish &lt;packagename&gt; -f</span></pre><p id="3448" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">感谢您的关注。我希望你会喜欢创建一个npm模块。</p><p id="02b4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注意:</strong>考虑建立一个模块的存储库，并添加一个README.md文件，解释模块的特性和用法。</p><p id="e000" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mm">更多内容请看</em><a class="ae ky" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mm">plain English . io</em></strong></a></p></div></div>    
</body>
</html>