<html>
<head>
<title>5 Useful Next.js Tricks To Add to Your Toolbox</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">添加到工具箱中的5个有用的Next.js技巧</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/next-js-tricks-6dd97ee66c7c?source=collection_archive---------4-----------------------#2021-08-12">https://javascript.plainenglish.io/next-js-tricks-6dd97ee66c7c?source=collection_archive---------4-----------------------#2021-08-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="05d9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">构建脚本、加载外部JavaScript、重定向等等。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/50b8cfa2d6a8c8256bc182736095ab7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s96M4p7x58T8tQHRWRMMZQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: the author</figcaption></figure><p id="b16b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Next.js在进化。随着时间的推移，它收到了越来越多的酷功能。这里有5个技巧，你可能还不知道。</p><h1 id="dfc3" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">1.在构建或开发过程中运行脚本</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="6718" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">只有当我们运行<code class="fe ml mm mn mo b">npm run build</code>时才需要这个脚本，所以当我们开始构建过程时。当我们处于开发模式时，将不需要和执行该脚本。为了使这个例子完整，所以你可以尝试一下，下面是我用来测试的简单的<code class="fe ml mm mn mo b">generateSitemap.js</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="e32d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当然，你也可以把next.config.js中的逻辑转过来，只在开发模式下执行某个脚本。一切都取决于你。</p><h1 id="cc78" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">2.指定如何加载外部脚本</h1><p id="2792" class="pw-post-body-paragraph kv kw iq kx b ky mp jr la lb mq ju ld le mr lg lh li ms lk ll lm mt lo lp lq ij bi translated">承认吧，我们之前都试图在React中使用<code class="fe ml mm mn mo b">&lt;script&gt;</code>标签。</p><p id="73be" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Next.js现在使之成为可能，因为它为此提供了一个特殊的组件。我们不仅可以使用它来包含外部脚本，还可以指定它们应该如何加载。</p><p id="10e3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们通过提供加载策略来实现这一点，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="47df" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这个例子中，Google Analytics脚本将在页面开始交互之前加载。在网络选项卡中，您可以清楚地看到:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/2c4e680c782b79b0303f0cced4843422.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AnQ59DW-Re-vmIr6SAb4Vg.png"/></div></div></figure><p id="e915" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">另一种策略是在其他事情都完成时加载它——这种策略用于页面中不重要的脚本。当将Google Analytics的脚本组件设置为<code class="fe ml mm mn mo b">strategy='lazyOnload'</code>时，网络选项卡将如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/b9f9db8d771e1a6180f9d6359b421346.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gca1cZ3ksorXwwo2rSA3zg.png"/></div></div></figure><p id="5de2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">是的，分析脚本在最后加载。</p><h1 id="76c8" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">3.重定向URL</h1><p id="bb6e" class="pw-post-body-paragraph kv kw iq kx b ky mp jr la lb mq ju ld le mr lg lh li ms lk ll lm mt lo lp lq ij bi translated">这个很简单。当访问Next.js服务器上的URL时，如果需要，可以重定向它。这既适用于内部重定向，也适用于外部重定向。</p><p id="537e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本例中，您可以看到一个外部重定向。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mj mk l"/></div></figure><h1 id="c624" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">4.共享组件属性</h1><p id="303a" class="pw-post-body-paragraph kv kw iq kx b ky mp jr la lb mq ju ld le mr lg lh li ms lk ll lm mt lo lp lq ij bi translated">我知道有很多方法可以在React的组件之间共享数据。这是另一个。正如你可能知道的，我们可以使用<code class="fe ml mm mn mo b">_app.js</code>文件来包装我们想要渲染的所有页面。例如，这可以用于注入全局CSS。</p><p id="84fa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这个特殊的文件中，我们还可以访问类似props的数据，我们可以在每个组件中指定。这里有一个例子。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="5d56" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这样，我们为这个页面专门定义了一个标题。在<code class="fe ml mm mn mo b">_app.js</code>中，我们现在可以访问这些共享数据，并随心所欲地使用它们:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="5258" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<code class="fe ml mm mn mo b">http://localhost:3000/</code>(默认)打开索引页面时，我们将看到以下输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/082147ce2b5feec6fdc3cab703949728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aXYdZWX4hWlXJsvZ65NM-Q.png"/></div></div></figure><h1 id="539f" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">5.核心网络重要信息</h1><p id="e68d" class="pw-post-body-paragraph kv kw iq kx b ky mp jr la lb mq ju ld le mr lg lh li ms lk ll lm mt lo lp lq ij bi translated">web vitals是Google收集的网站性能指标。如果你以前用过Lighthouse，你已经对它有一点了解了。</p><p id="3893" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是我们可以直接在Next.js组件中报告我们的web重要分数，而不是手动运行Lighthouse基准。下面是它的基本工作原理，在<code class="fe ml mm mn mo b">_app.js</code>中使用:</p><pre class="kg kh ki kj gt mx mo my mz aw na bi"><span id="64f7" class="nb ls iq mo b gy nc nd l ne nf">export function reportWebVitals(metric) {<br/> console.log(metric)<br/>}</span><span id="fa25" class="nb ls iq mo b gy ng nd l ne nf">export default function App({ Component, pageProps }) {<br/> return &lt;Component {…pageProps} /&gt;<br/>}</span></pre><p id="ad8c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这将为您提供一个web vitals对象，包含控制台中的大量信息。要指定想要使用的指标，可以使用:</p><pre class="kg kh ki kj gt mx mo my mz aw na bi"><span id="91a2" class="nb ls iq mo b gy nc nd l ne nf">export function reportWebVitals(metric) {<br/>  switch (metric.name) {<br/>    case 'FCP':<br/>      console.log(metric)<br/>   }<br/>}</span></pre><p id="f015" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这个例子中，我们使用FCP代表第一个内容丰富的油漆。</p><p id="bf42" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢您的阅读！</p><p id="3725" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">关于Next.js的更多信息:</p><div class="nh ni gp gr nj nk"><a rel="noopener  ugc nofollow" target="_blank" href="/next-js-preact-f993c95a3f93"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">想让你的Next.js App更快？启用预先支持(方法如下)</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">如何在你的Next.js应用上启用Preact支持，并几乎免费节省几千字节。</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny kp nk"/></div></div></a></div><div class="nh ni gp gr nj nk"><a rel="noopener  ugc nofollow" target="_blank" href="/next-js-webassembly-77df3537690"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">用Next.js构建您的第一个WebAssembly组件</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">而不必首先设置编译器</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nt l"><div class="nz l nv nw nx nt ny kp nk"/></div></div></a></div><p id="dfc5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="oa">更多内容尽在</em><a class="ae ob" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="oa">plain English . io</em></strong></a></p></div></div>    
</body>
</html>