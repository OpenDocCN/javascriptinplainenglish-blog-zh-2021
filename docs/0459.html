<html>
<head>
<title>Introducing AWS CDK Gen</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">介绍AWS CDK Gen</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/introducing-aws-cdk-gen-d59a6602d516?source=collection_archive---------12-----------------------#2021-01-27">https://javascript.plainenglish.io/introducing-aws-cdk-gen-d59a6602d516?source=collection_archive---------12-----------------------#2021-01-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="cd2b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从命令行构建TypeScript AWS CDK项目</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a506fb2ce74539ba195781d882faf740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zZbz2ioWjL_sA1bS"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@itsdenispavlovic?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Denis Pavlovic</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1f52" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于许多公司来说，部署到云已经成为一个必不可少的战略，没有一个云提供商像亚马逊网络服务(AWS)一样无处不在。</p><p id="3ba3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在过去，在AWS云中维护您的基础设施可能是一个有点繁重的过程。最初，您必须通过控制台来配置您的基础架构，这使得设置和保持您的基础架构一致变得繁琐和手动，尤其是在您使用多个帐户的情况下。</p><p id="c8dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">后来，开发人员能够使用YAML和JSON中定义的云形成模板来定义基础设施。这允许开发者共享他们的基础设施，更好的是，版本控制它！缺点是这些配置文件很容易超过1000行，很难理解。</p><p id="a338" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后一个新的范例出现了——基础设施即代码。开发人员现在能够使用AWS CDK通过代码配置、版本控制和部署他们的AWS基础设施。</p><p id="b9dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">AWS CDK一直是寻求在AWS中开发云原生解决方案的开发者的巨大推动者。但是，作为一名开发人员，我经常发现自己一遍又一遍地编写相同的样板代码。一定有更好的方法来减少这个代码。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="958b" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">AWS CDK Gen——一种快速搭建AWS项目的方法</h1><p id="7c18" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我想向你们介绍AWS CDK Gen 。这个简单的命令行工具允许您通过回答几个提示来生成常见的AWS构造。这个工具不仅处理生成负责创建我们的CDK构造的TypeScript代码，还处理在使用这些构造时有用的附加文件。例如，NodeJs Lambda将附带一个工作示例处理程序文件和一个Lambda集成构造，以便轻松集成到API网关中！开发人员需要做的只是用自己的JavaScript逻辑替换处理程序代码。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="bc6a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">有哪些结构可用？</h1><p id="4dd3" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">该工具中有许多常见的构造。以下是当前支持的选项:</p><ul class=""><li id="d0d9" class="mw mx iq ky b kz la lc ld lf my lj mz ln na lr nb nc nd ne bi translated"><strong class="ky ir">生成一个Goλ</strong></li><li id="2715" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated"><strong class="ky ir">生成一个节点JSλ</strong></li><li id="bafb" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated"><strong class="ky ir">创建一个API网关</strong></li><li id="33a7" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated"><strong class="ky ir">创建一个S3存储桶</strong></li><li id="be32" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated"><strong class="ky ir">生成一个DynamoDB表和Lambdas</strong>——依赖于已经生成的API网关</li><li id="7086" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated"><strong class="ky ir">向API网关添加Lambda路由— </strong>取决于是否生成了API网关和Lambda。</li></ul><p id="1199" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们举一个例子来说明如何在实践中利用这个工具。我们将看看如何在5个简单的步骤中生成部署Go Lambda所需的所有基础设施。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="4cc5" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">在5个步骤中生成一个有效的Go Lambda和API网关</h1><h2 id="ac25" class="nk ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">步骤0。正在设置</h2><p id="5627" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">为了演示的目的，我首先从一个基本的AWS CDK回购开始，但我们可以使用任何现有的CDK项目。我们将通过在一个空目录中运行<code class="fe nw nx ny nz b">cdk init app --language=typescript</code>来初始化这个repo。完成后，我们得到一个类似这样的空堆栈文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/fa50ce6033c921d7f7cb8055429895ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aTTxjmQsrfwq3c8i4MGsyg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Our empty stack.</figcaption></figure><p id="34d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我现在使用<code class="fe nw nx ny nz b">npm i --save-dev aws-cdk-gen</code>安装我的工具，并在我的项目中定义一个脚本来运行它。</p><pre class="kg kh ki kj gt ob nz oc od aw oe bi"><span id="cd86" class="nk ma iq nz b gy of og l oh oi">"aws-cdk-gen": "aws-cdk-gen",</span></pre><p id="eded" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意:</strong>如果你愿意，你也可以在全球范围内安装这个软件包。</p><h2 id="b872" class="nk ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">第一步。生成Go Lambda</h2><p id="3a24" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我现在将运行我的程序并生成一个Go Lambda。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/1a773f8c36421815d48823c2b7aa71ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*HDipUDeASO1ji915-6ZoPw.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Generating the files needed to define a Go Lambda just takes one input- the Lambda name.</figcaption></figure><p id="7287" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们只需命名我们的Lambda函数，就会得到一些为我们生成的文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/0404c925ba0d682ad81bf833cd5382c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SiG9xBz9e9MIBU-sLF2ozw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Here is our generated construct with our Lambda and S3 Asset construct defined.</figcaption></figure><p id="3097" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出的许多文件中包括:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/6b7ccc6f78f080823bc4fdba6101cb80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TiFZC2qtJgE2a3bh8nla6g.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">A working Go handler is provided in our generator.</figcaption></figure><ul class=""><li id="c5f3" class="mw mx iq ky b kz la lc ld lf my lj mz ln na lr nb nc nd ne bi translated">一个S3资产上传我们的压缩编译的Go代码。</li><li id="04b2" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">一个标准的λ函数指向我们的S3桶。</li><li id="6d86" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">一个API网关V2λ集成。</li><li id="86c2" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">一个有效的Go Lambda处理程序。</li><li id="401e" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">关于构建Go代码的自述文件。</li><li id="76eb" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">两个Shell脚本来安装依赖项，并自动构建和压缩编译后的Go工件。</li></ul><p id="d7f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你所看到的，我们已经提供了所有的工具来开始开发我们自己的Go Lambda。</p><p id="d13b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在部署了一个Lambda，但是没有API网关来将我们的Lambda公开为一个路由。没问题！我们可以使用该工具轻松生成一个。</p><h2 id="1739" class="nk ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">第二步。生成API网关</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/9e6a4e91ad8c2d2af46ea893086c5d23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*PPbbiT4_TsGvHDgaaI9r5A.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Generating an API Gateway using AWS CDK Gen</figcaption></figure><p id="aeb4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们重新运行我们的工具，并选择生成一个API网关。同样，我们只需要命名我们的API网关。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/840264f913286d76ec5db21893777c2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*adBqZvdUwFTg4fMntVt32A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The comments in the API Gateway allow us to inject code like routes and imports.</figcaption></figure><p id="9ae1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在有了一个带注释的准系统API网关。当然，我们可以开始手动将预先存在的Lambda导入到这个文件中，但是如果我们已经通过我们的工具生成了Lambda，我们可以使用我们的工具来帮助我们定义Lambda的路径。我们将在下一节看到如何实现。</p><h2 id="2d40" class="nk ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">第三步。为我们的Lambda生成一条路线</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/fe914e740e304df4cd13f5a98a908959.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*QH2S9VSHkxZCNA40LcOJ0Q.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Our tool can be used to connect our previously generated API Gateways and Lambdas.</figcaption></figure><p id="4491" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于我们使用我们的工具生成了我们的Lambda，现在我们可以使用AWS CDK Gen在我们的API网关中添加一个路由</p><p id="65eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你会注意到，现在我们已经生成了一个API网关和一个Lambda，有了一些额外的选项。在回答提示后，我们的API网关现在看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/8edeaeeb551f62e1f994340962db0b99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x1BYZm0lPH88_00LY9clSQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Our tool simplifies integrating our Lambdas with our API Gateway.</figcaption></figure><p id="7a06" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它现在导入了我们的Go Lambdas集成，并根据我们的输入定义了一个GET路由。我们现在已经完成了90%的路程。我们只剩下几个步骤需要部署。</p><h2 id="df7f" class="nk ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">第四步。在我们的基本堆栈中创建API网关的实例</h2><p id="066f" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">因为我们所有的逻辑都在我们的API网关栈中，我们只需要导入它并在我们的基础栈中实例化它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/54622b9b2209b390a7b0ce414eacaf54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*002q2RNv_NN4zHHnAdfW4Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">One line of code is all this needed to start using our Gateway and Lambda.</figcaption></figure><p id="6c4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样。剩下的就是安装我们的项目尚未安装的、我们生成的代码所使用的任何依赖项。</p><h2 id="2939" class="nk ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">第五步。安装任何依赖项，构建和部署</h2><p id="c850" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">由于这是一个新项目，我们必须做安装任何缺失的依赖项这一小步。我们的构造使用了一些aws-cdk包。我们只需要使用npm安装它们。</p><p id="f4d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，我们必须安装Go依赖项，并构建和压缩我们的Go代码。这两个工具都将花费我们不到几分钟的时间来处理handler文件夹中提供的有用的Shell脚本。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/a630c114f8c9168c106eab4d85014c33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U1rhd0Ahm62eIROdRkhNLw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Helpful shell scripts help us do mundane things like building and zipping our code.</figcaption></figure><p id="b357" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦这样做了，我们就可以部署和享受一个完全工作的API网关，并附带一个Go Lambda！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="d663" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">我如何开始？</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/cc8e441faa7acba013b7c7a0c674cdfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A3-scMi3C2lrE9ch"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@giabyte?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Gia Oris</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b77f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我建议查看npm网站并安装软件包。在版本1.85.0之后，它与aws-cdk项目一起工作。</p><p id="01c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">研究一下这个项目，让我知道你的想法。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="3675" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">离别赠言</h1><p id="9d27" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">这是我的第一个开源项目。因此，如果您有任何问题或反馈，或者想要做出贡献，我鼓励人们看一看并伸出手来。</p></div></div>    
</body>
</html>