<html>
<head>
<title>Angular File Upload With Progress Bar</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带进度条的角度文件上传</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/angular-file-upload-with-progress-bar-5780ca4cbb1c?source=collection_archive---------3-----------------------#2021-03-23">https://javascript.plainenglish.io/angular-file-upload-with-progress-bar-5780ca4cbb1c?source=collection_archive---------3-----------------------#2021-03-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1ce8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何在使用Angular上传文件时显示进度条</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2085ecfb83609ce010c1b63daffe61f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4-ny_hTysA1szjcmJHpODQ.png"/></div></div></figure><p id="8480" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本教程中，我们将了解如何使用<strong class="kt ir"> Angular </strong>向服务器上传图像/文件时显示进度百分比。我已经写了一篇关于<a class="ae ln" rel="noopener ugc nofollow" target="_blank" href="/upload-file-using-angular-and-php-7ee12c67a28b">如何使用Angular </a>和PHP上传图像/文件的教程。我将使用前一篇文章中的相同代码来显示进度百分比，只做了少许修改。因此，如果你对Angular中的文件上传没有概念，请阅读之前的文章。</p><p id="c2cf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了上传文件，我们将在Angular中使用<strong class="kt ir"> HttpClient </strong>类。我们已经从HttpClient使用了<strong class="kt ir"> post() </strong>方法来上传文件。为了显示进度百分比，我们需要在POST请求中使用以下选项。</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="85a3" class="lt lu iq lp b gy lv lw l lx ly">reportProgress:true,</span><span id="41b4" class="lt lu iq lp b gy lz lw l lx ly">observe:"events"</span></pre><p id="7892" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果我们在POST请求中使用上面的代码，我们将在订阅它时得到两个输出。</p><ol class=""><li id="b10b" class="ma mb iq kt b ku kv kx ky la mc le md li me lm mf mg mh mi bi translated">上传进度百分比</li><li id="910c" class="ma mb iq kt b ku mj kx mk la ml le mm li mn lm mf mg mh mi bi translated">当请求完成时，最终输出JSON数据。</li></ol><h2 id="87d3" class="lt lu iq bd mo mp mq dn mr ms mt dp mu la mv mw mx le my mz na li nb nc nd ne bi translated"><strong class="ak">上传进度百分比</strong></h2><p id="f24e" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">只有在POST请求中启用reportProgress参数时，我们才能获得上传进度。使用下面的代码获取上传进度百分比。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="5e6c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将事件类型与HttpEventType中的UploadProgress进行比较。如果事件类型是UploadProgress，那么我们将使用事件中加载的值来计算上传的文件大小。</p><h2 id="e64a" class="lt lu iq bd mo mp mq dn mr ms mt dp mu la mv mw mx le my mz na li nb nc nd ne bi translated"><strong class="ak">最终输出(响应)</strong></h2><p id="f32b" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">对于每个请求，我们总是有回应。要从服务器获得响应，请使用下面的代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="4980" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里我们检查事件类型是否为响应。为什么？因为当我们上传图像/文件时，有许多可用的事件类型。</p><p id="d080" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">上传文件功能:</strong></p><p id="829a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们看看下面的代码。这是一个完整的代码上传文件到服务器，并显示百分比。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="b09a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里，我们使用progress变量存储上传进度百分比。我们可以通过HTML使用这些数据，通过显示上传百分比的百分比数字或动画来显示上传百分比。</p><h2 id="6775" class="lt lu iq bd mo mp mq dn mr ms mt dp mu la mv mw mx le my mz na li nb nc nd ne bi translated"><strong class="ak">有角度的材料进度条</strong></h2><p id="a0c5" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">我们已经看到了如何获得上传百分比。现在我们将使用有角度的材质进度条来显示百分比。要使用角度材料进度条，首先将MatProgressBarModule导入到<strong class="kt ir"> app.module.ts </strong>文件的imports部分。</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="3ded" class="lt lu iq lp b gy lv lw l lx ly">import {MatProgressBarModule} from '@angular/material/progress-bar';</span></pre><p id="eb72" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后使用下面的HTML代码来显示进度条。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="7b37" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在TS文件中设置颜色和进度模式。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="9732" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">完整的HTML代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="0d02" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">完整TS代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="2118" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/3e77b4fc70ed32e09617593a4b9bbc87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Haj-Rt8x7VkiFWckM-veJA.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk">File Upload With Percentage Example</figcaption></figure><h2 id="df93" class="lt lu iq bd mo mp mq dn mr ms mt dp mu la mv mw mx le my mz na li nb nc nd ne bi translated"><strong class="ak">结论</strong></h2><p id="d71b" class="pw-post-body-paragraph kr ks iq kt b ku nf jr kw kx ng ju kz la nh lc ld le ni lg lh li nj lk ll lm ij bi translated">在本教程中，您学习了如何使用角度框架显示进度百分比。显示用户期望的百分比。为什么因为用户总是想知道文件上传了多少百分比。它给了用户更好的用户体验。</p><p id="b70f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">希望这篇文章会很有帮助。</p><p id="d178" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢您阅读这篇文章。</p></div></div>    
</body>
</html>