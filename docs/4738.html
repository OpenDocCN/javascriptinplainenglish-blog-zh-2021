<html>
<head>
<title>React Hooks Demystified</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React钩子去神秘化</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-hooks-demystified-2a8370076b82?source=collection_archive---------15-----------------------#2021-09-21">https://javascript.plainenglish.io/react-hooks-demystified-2a8370076b82?source=collection_archive---------15-----------------------#2021-09-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/4baafb3dc68b9942e785c6f4631a7d0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MxEYg2sbfJc5YK9s"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@cgower?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Christopher Gower</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="6c95" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">React Hooks确实很酷，但这不是魔法的问题。这篇文章将介绍一些基础知识，希望能让一些事情变得更清楚。</p><h1 id="4e21" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">到底什么是钩子？</h1><p id="a8c3" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">解释一下，和已知的东西比较要简单得多。因此，一个典型的组件返回JSX，如下例所示:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="b1a1" class="mk kz in mg b gy ml mm l mn mo">import React from 'react';</span><span id="f22b" class="mk kz in mg b gy mp mm l mn mo">const Comp1 = (): JSX.Element =&gt; {<br/>  <strong class="mg io"> return &lt;h1&gt;The time is {new Date().toISOString()}&lt;/h1&gt;;</strong><br/>};</span><span id="804f" class="mk kz in mg b gy mp mm l mn mo">export default Comp1;</span></pre><p id="20e2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">那么hooks呢？他们返回变量和函数而不是JSX。</p><blockquote class="mq"><p id="218c" class="mr ms in bd mt mu mv mw mx my mz kx dk translated">组件返回JSX，钩子返回(一个或多个)函数、变量或对象。</p></blockquote><p id="ed18" class="pw-post-body-paragraph ka kb in kc b kd na kf kg kh nb kj kk kl nc kn ko kp nd kr ks kt ne kv kw kx ig bi translated">好吧，看起来很容易。但是为什么不使用模块呢？类似于:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="37d0" class="mk kz in mg b gy ml mm l mn mo">export function Sum(number1: number, number2: number): number { <br/>  return number1 + number2;<br/>};</span></pre><p id="ef49" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因为模块不能与React“交互”；钩子是用来访问React特性的，比如<code class="fe nf ng nh mg b">useState</code>。请在文章的最后阅读更多相关内容。</p><p id="645b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，让我们深入一些例子。</p><h1 id="8d0d" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">挂钩示例—使用计数器</h1><p id="f1d9" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">考虑下面的代码。它返回一个数字和一个函数(名为“increment”)。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="b3bf" class="mk kz in mg b gy ml mm l mn mo">import React from 'react';</span><span id="73ec" class="mk kz in mg b gy mp mm l mn mo">const useCounter = (): [number, () =&gt; void] =&gt; {</span><span id="5835" class="mk kz in mg b gy mp mm l mn mo">     const [number, setNumber] = React.useState(0);</span><span id="797c" class="mk kz in mg b gy mp mm l mn mo">     function increment() {<br/>        setNumber(randomNumber =&gt; randomNumber + 1);<br/>     }</span><span id="3e1b" class="mk kz in mg b gy mp mm l mn mo">  <strong class="mg io">   return [number, increment];</strong></span><span id="a0c8" class="mk kz in mg b gy mp mm l mn mo">};</span><span id="ab9d" class="mk kz in mg b gy mp mm l mn mo">export default useCounter;</span></pre><p id="236e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用它的完整代码是:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="1f5f" class="mk kz in mg b gy ml mm l mn mo">import React from 'react';<br/><strong class="mg io">import useCounter from './usecounter';</strong></span><span id="aeba" class="mk kz in mg b gy mp mm l mn mo">function Hook1Example() {</span><span id="de8b" class="mk kz in mg b gy mp mm l mn mo"><strong class="mg io">  // Grab the number and the increment-function<br/>  const [number, inc] = useCounter();</strong></span><span id="7201" class="mk kz in mg b gy mp mm l mn mo">return &lt;&gt;<br/>    Number: <strong class="mg io">{number}</strong><br/>    &lt;button <strong class="mg io">onClick={inc}</strong>&gt;Increment&lt;/button&gt;<br/>  &lt;/&gt;</span><span id="41e3" class="mk kz in mg b gy mp mm l mn mo">}</span><span id="e7ca" class="mk kz in mg b gy mp mm l mn mo">export default Hook1Example;</span></pre><p id="8fd0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在他们最简单的例子中，钩子基本上就是这样。</p><h1 id="5d8f" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">挂钩示例— useIsWeekEnd</h1><p id="ab27" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">从钩子返回的参数数量可以是任意的，参数返回的方式也可以改变。让我们用例子来展示一下:</p><h2 id="a12c" class="mk kz in bd la ni nj dn le nk nl dp li kl nm nn lm kp no np lq kt nq nr lu ns bi translated">作为一个数组:</h2><p id="8698" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">…在这种情况下，作为一个数字和一个函数。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="7016" class="mk kz in mg b gy ml mm l mn mo">import React from 'react';</span><span id="d6c2" class="mk kz in mg b gy mp mm l mn mo">const useCounter = ()<strong class="mg io">: [number, () =&gt; void]</strong> =&gt; {</span><span id="3634" class="mk kz in mg b gy mp mm l mn mo">    const [number, setNumber] = React.useState(0);</span><span id="488b" class="mk kz in mg b gy mp mm l mn mo">    function increment() {<br/>        setNumber(randomNumber =&gt; randomNumber + 1);<br/>    }</span><span id="d820" class="mk kz in mg b gy mp mm l mn mo"><strong class="mg io">    return [number, increment];</strong></span><span id="309b" class="mk kz in mg b gy mp mm l mn mo">};</span><span id="9897" class="mk kz in mg b gy mp mm l mn mo">export default useCounter;</span></pre><h2 id="92e8" class="mk kz in bd la ni nj dn le nk nl dp li kl nm nn lm kp no np lq kt nq nr lu ns bi translated">作为单一项目:</h2><p id="dd2a" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">…在这种情况下，一个布尔值:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="5e9f" class="mk kz in mg b gy ml mm l mn mo">import React from 'react';</span><span id="bfec" class="mk kz in mg b gy mp mm l mn mo">const useIsWeekend = ()<strong class="mg io">: boolean</strong> =&gt; {</span><span id="5ddb" class="mk kz in mg b gy mp mm l mn mo">   const [isWeekEnd, setIsWeekEnd] = React.useState&lt;boolean&gt;(false);</span><span id="b0b9" class="mk kz in mg b gy mp mm l mn mo">   React.useEffect(() =&gt; {<br/>      setIsWeekEnd([6, 0].includes(new Date().getDay()))<br/>   }, []);</span><span id="2522" class="mk kz in mg b gy mp mm l mn mo">  <strong class="mg io"> return isWeekEnd;</strong></span><span id="d6bd" class="mk kz in mg b gy mp mm l mn mo">};</span><span id="5ed5" class="mk kz in mg b gy mp mm l mn mo">export default useIsWeekend;</span></pre><h2 id="6fe9" class="mk kz in bd la ni nj dn le nk nl dp li kl nm nn lm kp no np lq kt nq nr lu ns bi translated">作为一个对象:</h2><p id="573a" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">…非常适合解构:)</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="0c5d" class="mk kz in mg b gy ml mm l mn mo">import React from 'react';</span><span id="2007" class="mk kz in mg b gy mp mm l mn mo">const useCalculator = (): <strong class="mg io">{ result: number; Add: (i: number) =&gt; void; Set: (i: number) =&gt; void; }</strong> =&gt; {</span><span id="5e2b" class="mk kz in mg b gy mp mm l mn mo">const [result, setResult] = React.useState(0);</span><span id="6a91" class="mk kz in mg b gy mp mm l mn mo">     function Add(i: number) {<br/>        setResult(result =&gt; result + i);<br/>    }</span><span id="128d" class="mk kz in mg b gy mp mm l mn mo">     function Set(i: number) {<br/>        setResult(result);<br/>    }</span><span id="c677" class="mk kz in mg b gy mp mm l mn mo">  <strong class="mg io">  return { result, Add, Set }</strong></span><span id="3fe4" class="mk kz in mg b gy mp mm l mn mo">};</span><span id="f03d" class="mk kz in mg b gy mp mm l mn mo">export default useCalculator;</span></pre><p id="1097" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">组件:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="ae95" class="mk kz in mg b gy ml mm l mn mo">import React from 'react';<br/>import useCalculator from './usecalculator';</span><span id="6662" class="mk kz in mg b gy mp mm l mn mo">function Hook2() {</span><span id="7cfd" class="mk kz in mg b gy mp mm l mn mo"><strong class="mg io">  const { result, Add, Set } = useCalculator()</strong></span><span id="cae6" class="mk kz in mg b gy mp mm l mn mo">  return &lt;&gt;<br/>      Result: {result}&lt;br /&gt;<br/>      &lt;button onClick={() =&gt; Add(1)}&gt;Increment&lt;/button&gt;<br/>      &lt;button onClick={() =&gt; Add(-1)}&gt;Decrement&lt;/button&gt;<br/>      &lt;button onClick={() =&gt; Set(0)}&gt;Reset&lt;/button&gt;<br/>      &lt;/&gt;</span><span id="fd9f" class="mk kz in mg b gy mp mm l mn mo">}</span><span id="0532" class="mk kz in mg b gy mp mm l mn mo">export default Hook2;</span></pre><h1 id="7cc8" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">挂钩示例— useIsLucky</h1><p id="db05" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">与组件一样，挂钩可能会触发重新呈现。考虑下面的例子:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="0a1f" class="mk kz in mg b gy ml mm l mn mo">import React from 'react';</span><span id="7269" class="mk kz in mg b gy mp mm l mn mo">const useIsLucky = (userID: string): [boolean | undefined] =&gt; {</span><span id="b301" class="mk kz in mg b gy mp mm l mn mo">    const [isLucky, setIsLucky] = React.useState&lt;boolean | undefined&gt;(undefined);</span><span id="cf41" class="mk kz in mg b gy mp mm l mn mo">   React.useEffect(() =&gt; {</span><span id="f923" class="mk kz in mg b gy mp mm l mn mo"><strong class="mg io">         // Fake a call to the API where the user<br/>         // is checked if they're lucky<br/>        setTimeout(() =&gt; {<br/>            setIsLucky(Math.random() &gt; 0.5)<br/>        }, 1000);</strong></span><span id="7fc5" class="mk kz in mg b gy mp mm l mn mo">}, [userID]);</span><span id="383c" class="mk kz in mg b gy mp mm l mn mo">    return [isLucky];</span><span id="323f" class="mk kz in mg b gy mp mm l mn mo">};</span><span id="9b6d" class="mk kz in mg b gy mp mm l mn mo">export default useIsLucky;</span></pre><p id="8f1b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">组件:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="c3c0" class="mk kz in mg b gy ml mm l mn mo">import React from 'react';<br/>import useIsLucky from './useislucky';</span><span id="b4f4" class="mk kz in mg b gy mp mm l mn mo">function Example5() {</span><span id="1529" class="mk kz in mg b gy mp mm l mn mo"><strong class="mg io">  const [result] = useIsLucky("Tomas");</strong></span><span id="cc92" class="mk kz in mg b gy mp mm l mn mo">  if (result !== undefined)<br/>    return &lt;&gt;Was lucky? {result ? "Yes" : "No"}&lt;/&gt;<br/>  else<br/>    return &lt;&gt;Loading..&lt;/&gt;</span><span id="7d5c" class="mk kz in mg b gy mp mm l mn mo">}</span><span id="32e8" class="mk kz in mg b gy mp mm l mn mo">export default Example5;</span></pre><figure class="mb mc md me gt jo gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/fa64938f568e09d2e5bef66ae5c39066.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/1*mzE_Tc0PIy18yTKze7H9og.gif"/></div></figure><h1 id="0830" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">函数vs钩子！</h1><p id="ba4b" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">好了，钩子的基本知识已经讲过了。但在放手之前，还有一件事需要了解:</p><blockquote class="mq"><p id="f3db" class="mr ms in bd mt mu mv mw mx my mz kx dk translated">什么时候应该使用钩子，什么时候应该使用普通模块(例如ts-带代码的文件)？</p></blockquote><p id="594c" class="pw-post-body-paragraph ka kb in kc b kd na kf kg kh nb kj kk kl nc kn ko kp nd kr ks kt ne kv kw kx ig bi translated">嗯，归结为React的依赖性。考虑下面的代码，其中找不到React的依赖项。好吧，它是<em class="nu">命名为</em> useSumHook，但实际上，它不是一个钩子。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="4170" class="mk kz in mg b gy ml mm l mn mo">const useSumHook = (number1: number, number2: number): number =&gt; {<br/>   return number1+number2;<br/>};</span><span id="29e4" class="mk kz in mg b gy mp mm l mn mo">export default useSumHook;</span></pre><p id="7a36" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">就我个人而言，我会将这个函数存储在. ts文件中，如下所示:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="ae57" class="mk kz in mg b gy ml mm l mn mo">export function Sum(number1: number, number2: number): number { <br/>  return number1 + number2;<br/>};</span></pre><p id="a52a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后将其用作:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="6114" class="mk kz in mg b gy ml mm l mn mo">import { Sum } from './misc';</span></pre><h2 id="58b0" class="mk kz in bd la ni nj dn le nk nl dp li kl nm nn lm kp no np lq kt nq nr lu ns bi translated">Git回购</h2><p id="9b0e" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">它不漂亮，但很有用。<a class="ae jz" href="https://github.com/tomnil/hooksexample" rel="noopener ugc nofollow" target="_blank">https://github.com/tomnil/hooksexample</a></p><h1 id="cc1e" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">享受:)</h1><p id="51ba" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated"><em class="nu">更多内容请看</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="nu">plain English . io</em></strong></a></p></div></div>    
</body>
</html>