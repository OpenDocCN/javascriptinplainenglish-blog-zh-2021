<html>
<head>
<title>Upload Images in Your Node.js App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Node.js应用程序中上传图像</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/upload-images-in-your-node-app-e05d0423fd4a?source=collection_archive---------1-----------------------#2021-02-05">https://javascript.plainenglish.io/upload-images-in-your-node-app-e05d0423fd4a?source=collection_archive---------1-----------------------#2021-02-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/afb279efa8eef0ae86407a215fed15c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WwfwhDocUTQvZ531.png"/></div></div></figure><p id="afa2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您知道使用Multer存储和检索图像非常容易吗？</p><blockquote class="kt ku kv"><p id="47fd" class="jv jw kw jx b jy jz ka kb kc kd ke kf kx kh ki kj ky kl km kn kz kp kq kr ks ig bi translated">"<a class="ae la" href="http://expressjs.com/en/resources/middleware/multer.html" rel="noopener ugc nofollow" target="_blank"> Multer是处理<code class="fe lb lc ld le b">multipart/form-data</code>的Node.js </a>中间件，主要用于上传文件。它写在<a class="ae la" href="https://github.com/mscdex/busboy" rel="noopener ugc nofollow" target="_blank">勤杂工</a>的上面，以获得最高效率。”</p></blockquote><p id="7bfe" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我构建了一个应用程序，向您展示如何在前端使用multi和Node.js上传图像。</p><p id="f641" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要在您的本地机器上使用Node，前往<strong class="jx io">nodejs.org</strong>和<strong class="jx io">T12】根据您的操作系统安装它。</strong></p><p id="1560" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">什么是节点程序包管理器(NPM)？NPM是自动安装到您的本地机器与节点。js。NPM是世界上最大的注册软件。开源开发者广泛使用它来共享软件。它充当节点JS的包管理器。它管理依赖项，依赖项在package.json文件中定义。</p><p id="d4af" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">安装后，使用以下命令检查版本:</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lf"><img src="../Images/bf0a48d42b3334b631133f215e56b804.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*mDc35SL1AgyDzf4-Plxj1g.png"/></div></div></figure><p id="9d59" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，让我们开始使用我们的第一个节点应用程序:</p><p id="cf0f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在你的机器上创建一个文件夹，用VS代码打开它。</p><p id="a4c6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你输入VS代码后~</p><p id="fa90" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第一步:</strong> <em class="kw">运行</em> <code class="fe lb lc ld le b">npm init</code></p><p id="5f9f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kw">该命令在您的文件夹中创建一个新的package.json文件。</em></p><p id="7f1c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是我的文件夹结构现在的样子-</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lk"><img src="../Images/37874aa92fa18668c47e0db9a410ca0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BM1TLDCfnfMG825vYnuySg.png"/></div></div></figure><p id="d95f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第二步:</strong> <em class="kw">运行</em><code class="fe lb lc ld le b">npm install express</code><strong class="jx io"><em class="kw"/></strong><em class="kw">在你的终端</em> <strong class="jx io"> <em class="kw">。</em> </strong></p><p id="08ca" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这将安装<strong class="jx io"> node_modules文件夹并创建一个package-lock.json文件</strong>。</p><p id="071d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">模块</strong>在<strong class="jx io">节点。js </strong>是组织在单个或多个JavaScript文件中的简单或复杂的功能，这些文件可以在整个<strong class="jx io">节点中重用。js </strong>应用。<strong class="jx io">节点中的每个<strong class="jx io">模块</strong>。js </strong>有它的上下文，所以不能干扰其他<strong class="jx io">模块</strong>。</p><p id="4a79" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤3: </strong>安装依赖项</p><p id="9637" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kw">运行命令</em>T3】</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ll"><img src="../Images/af8275314d4090cfccd3a3ae98aad296.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tZ6a8zGmuklPYqaEq40WWw.png"/></div></div></figure><p id="e0e1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第四步</strong>:创建app.js</p><p id="cce2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">打开app.js并将以下代码粘贴到那里。</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/f307fb425f3353787a0910f5f963b0fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*yNiCamSzQqgXLJLGfew-Ew.png"/></div></figure><p id="10e7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤5 </strong>:使用<code class="fe lb lc ld le b">node app.js</code>运行你的服务器端代码</p><p id="6217" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">打开浏览器，键入localhost<a class="ae la" href="http://localhost:4000/" rel="noopener ugc nofollow" target="_blank">http://localhost:4000/</a></p><p id="70e9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你将会看到<strong class="jx io"> Hello peeps！屏幕上……瞧！</strong></p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ln"><img src="../Images/2ab3ce695f2c9e283bde7f517ee4164e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vw9yfhqAOv_ZQho3wypnZA.png"/></div></div></figure><p id="775f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤6: </strong>将multer添加到您的应用程序中</p><pre class="lg lh li lj gt lo le lp lq aw lr bi"><span id="04a1" class="ls lt in le b gy lu lv l lw lx">var multer = require(‘multer’);</span></pre><p id="5f40" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们为multer创建一个目的地来存储图像，并创建一个自定义名称设置器来命名它们。</p><p id="18b4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第7步:</strong>在第6步的代码行下面添加以下代码</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ly"><img src="../Images/294fda0bce90dffbf6bcf2df217617f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_TkEC2X0ygaHT9opwIY1PQ.png"/></div></div></figure><p id="5246" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Multer配有存储引擎<code class="fe lb lc ld le b">DiskStorage</code>和<code class="fe lb lc ld le b">MemoryStorage</code>。我们将使用如图所示的磁盘存储器。</p><p id="880d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">磁盘存储引擎让您可以完全控制在磁盘上存储文件。</p><p id="6840" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意:</strong>如果没有给出<code class="fe lb lc ld le b">destination</code>，则使用操作系统默认的临时文件目录。</p><p id="bdc2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当作为一个功能提供<code class="fe lb lc ld le b">destination</code>时，您负责创建目录。当传递一个字符串时，multer将确保为您创建目录。</p><p id="2116" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe lb lc ld le b">Filename</code>用于确定文件夹内的文件应该命名为什么。如果没有给定<code class="fe lb lc ld le b">filename</code>，每个文件将被赋予一个不包含任何文件扩展名的随机名称。</p><p id="876f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意:</strong> Multer不会为你附加任何文件扩展名，你的函数应该返回一个带有文件扩展名的文件名。</p><p id="5c63" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">第8步:</strong>创建一个名为public的新文件夹，并在其中创建另一个文件夹来上传保存您的图像。</p><p id="9073" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这里，我将使用一个函数来控制文件上传，因为我只想要这个应用程序的图像。</p><p id="f6a2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤9: </strong>继续将下面的代码粘贴到您的app.js中</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lz"><img src="../Images/6e762f86b9505045877a52298ad1a462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZV_hXJO_lZwqapK-mVlx1g.png"/></div></div></figure><p id="510b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">文件过滤器</strong>是控制文件上传的功能。</p><p id="a4ed" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">只有<strong class="jx io"> <em class="kw">。jpg，。jpeg、</em>、T24、<strong class="jx io">、T26。允许使用png  </strong>。</strong></p><p id="27b6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在将<strong class="jx io">存储属性设置为存储</strong>并将<strong class="jx io"> fileFilter属性设置为fileFilter函数。</strong></p><p id="580b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Multer支持单次上传和多次上传。<code class="fe lb lc ld le b">upload.single</code>用于上传单个文件。</p><p id="1d0c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如<a class="ae la" href="http://expressjs.com/en/resources/middleware/multer.html" rel="noopener ugc nofollow" target="_blank">文档</a>所述~</p><blockquote class="kt ku kv"><p id="9fab" class="jv jw kw jx b jy jz ka kb kc kd ke kf kx kh ki kj ky kl km kn kz kp kq kr ks ig bi translated">Multer将一个<code class="fe lb lc ld le b"><strong class="jx io">body</strong></code> <strong class="jx io">对象</strong>和一个<code class="fe lb lc ld le b"><strong class="jx io">file</strong></code> <strong class="jx io">或</strong> <code class="fe lb lc ld le b"><strong class="jx io">files</strong></code> <strong class="jx io"> </strong>对象添加到<code class="fe lb lc ld le b">request</code>对象中。<code class="fe lb lc ld le b">body</code>对象包含表单文本字段的值，<code class="fe lb lc ld le b">file</code>或<code class="fe lb lc ld le b">files</code>对象包含通过表单上传的文件。</p></blockquote><p id="42ff" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这里，我将只处理一个文件！</p><p id="3ac3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤10: </strong>让我们创建端点。</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/6fdec23b0592571d5740ee702262b674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*S4QUAiYHxER7W_FxCPyybQ.png"/></div></figure><p id="5b38" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们和<strong class="jx io">邮递员</strong>核实一下</p><p id="6da2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以，在这里，它工作得很好…我们得到了上传文件夹中的文件名，也得到我们上传的文件的数据。</p><figure class="lg lh li lj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mb"><img src="../Images/eb7301de3fac697a1142b1a0bdeebf43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z6TpXj9ohsO38gk3Qhh4Wg.png"/></div></div></figure><p id="b9fc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">试试这个吧！</p><p id="f7ae" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在Node.js中使用文件上传的最佳方式…</p><p id="2ac7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另外，我将把它与一个<strong class="jx io"> React客户端</strong>应用程序连接起来。我将很快发布这个故事！</p></div><div class="ab cl mc md hr me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ig ih ii ij ik"><p id="6a8a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">参考资料:</p><div class="mj mk gp gr ml mm"><a href="https://www.npmjs.com/package/multer" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd io gy z fp mr fr fs ms fu fw im bi translated">穆尔特</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">Multer是一个用于处理多部分/表单数据的node.js中间件，主要用于上传文件。这是…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">www.npmjs.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na jt mm"/></div></div></a></div><p id="0456" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是我的GitHub简介！</p><div class="mj mk gp gr ml mm"><a href="https://github.com/Sristi27" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd io gy z fp mr fr fs ms fu fw im bi translated">srist 27-概述</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">对Web开发和机器学习领域感兴趣的编程爱好者。- Sristi27</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">github.com</p></div></div><div class="mv l"><div class="nb l mx my mz mv na jt mm"/></div></div></a></div><p id="c768" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">此应用程序的Git存储库:</p><div class="mj mk gp gr ml mm"><a href="https://github.com/Sristi27/react-img" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd io gy z fp mr fr fs ms fu fw im bi translated">GitHub-srist 27/react-img:用你的MERN应用上传和预览图片。</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">使用你的MERN应用程序上传和预览图像。在前端用React创建，在后端用Node创建。这个回购是…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">github.com</p></div></div><div class="mv l"><div class="nc l mx my mz mv na jt mm"/></div></div></a></div><p id="6233" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">喜欢的话别忘了给它一颗星！希望你喜欢。</p><p id="f112" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kw">更多内容看</em> <a class="ae la" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="kw">说白了就是</em> </strong> </a> <strong class="jx io"> <em class="kw">。</em> </strong> <em class="kw">报名参加我们的</em><strong class="jx io"><em class="kw"/></strong><a class="ae la" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="kw">免费每周简讯这里</em> </strong> </a> <strong class="jx io"> <em class="kw">。</em>T46】</strong></p></div></div>    
</body>
</html>