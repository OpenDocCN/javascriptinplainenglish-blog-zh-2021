<html>
<head>
<title>Create Vue 3 Apps with the Composition API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用复合API创建Vue 3应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-vue-3-apps-with-the-composition-api-76a776195072?source=collection_archive---------20-----------------------#2021-04-10">https://javascript.plainenglish.io/create-vue-3-apps-with-the-composition-api-76a776195072?source=collection_archive---------20-----------------------#2021-04-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/be38e1d732fab76135b81f6a6a56f21c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5NuDSrTqm_96NEjC"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@betteratf8?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Weston MacKinnon</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2a9b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue 3自带内置的Composition API。</p><p id="4aaf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它让我们可以轻松地提取逻辑，而不必担心代码中<code class="fe lb lc ld le b">this</code>的值。</p><p id="77ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用TypeScript也能更好地工作，因为不再需要键入<code class="fe lb lc ld le b">this</code>的值。</p><p id="46b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用复合API创建Vue 3应用程序。</p><h1 id="751b" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">基本示例</h1><p id="a474" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们可以通过定义反应属性并在模板中使用它们来创建一个基本的应用程序。</p><p id="1a21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="90a6" class="mq lg iq le b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;button @click="increment"&gt;increment&lt;/button&gt;<br/>    {{ count }}<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="701c" class="mq lg iq le b gy mv ms l mt mu">&lt;script&gt;<br/>import { ref } from "vue";</span><span id="399d" class="mq lg iq le b gy mv ms l mt mu">export default {<br/>  setup() {<br/>    const count = ref(0);</span><span id="3b31" class="mq lg iq le b gy mv ms l mt mu">    function increment() {<br/>      count.value++;<br/>    }</span><span id="a993" class="mq lg iq le b gy mv ms l mt mu">    return {<br/>      count,<br/>      increment,<br/>    };<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="c4e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe lb lc ld le b">ref</code>函数定义了<code class="fe lb lc ld le b">count</code>无功属性。</p><p id="64c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">0是它的初始值。</p><p id="27e9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们添加了<code class="fe lb lc ld le b">increment</code>函数来更新它的值。</p><p id="b249" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它的更新不同于选项API中的更新。我们必须更新<code class="fe lb lc ld le b">value</code>属性，用原始值更新反应属性。</p><p id="b66c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们返回<code class="fe lb lc ld le b">count</code>和<code class="fe lb lc ld le b">increment</code>，这样我们就可以使用它们作为模板。</p><p id="29d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">setup</code>是一个在我们挂载组件时运行的方法。</p><p id="5334" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe lb lc ld le b">reactive</code>函数定义对象值反应属性。</p><p id="6289" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="bbf0" class="mq lg iq le b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;button @click="increment"&gt;increment&lt;/button&gt;<br/>    {{ state.count }}<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="7381" class="mq lg iq le b gy mv ms l mt mu">&lt;script&gt;<br/>import { reactive } from "vue";</span><span id="807b" class="mq lg iq le b gy mv ms l mt mu">export default {<br/>  setup() {<br/>    const state = reactive({<br/>      count: 0,<br/>    });<br/>    function increment() {<br/>      state.count++;<br/>    }</span><span id="5632" class="mq lg iq le b gy mv ms l mt mu">    return {<br/>      state,<br/>      increment,<br/>    };<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="ea00" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用一个初始对象值调用<code class="fe lb lc ld le b">reactive</code>。</p><p id="1ade" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将其分配给<code class="fe lb lc ld le b">state</code>反应属性。</p><p id="743e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe lb lc ld le b">increment</code>函数中，我们更新<code class="fe lb lc ld le b">state.count</code>属性来更新它的值。</p><p id="956d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们返回<code class="fe lb lc ld le b">state</code>和<code class="fe lb lc ld le b">count</code>以便在模板中使用它们。</p><h1 id="45e2" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">计算属性</h1><p id="87e5" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">为了创建一个计算属性，我们可以使用<code class="fe lb lc ld le b">computed</code>函数。</p><p id="337a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="cde7" class="mq lg iq le b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;button <a class="ae kc" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="increment"&gt;increment&lt;/button&gt;<br/>    {{ state.count }}<br/>    {{ double }}<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="0d51" class="mq lg iq le b gy mv ms l mt mu">&lt;script&gt;<br/>import { reactive, computed } from "vue";</span><span id="8de7" class="mq lg iq le b gy mv ms l mt mu">export default {<br/>  setup() {<br/>    const state = reactive({<br/>      count: 0,<br/>    });<br/>    const double = computed(() =&gt; state.count * 2);</span><span id="c3c5" class="mq lg iq le b gy mv ms l mt mu">    function increment() {<br/>      state.count++;<br/>    }</span><span id="17da" class="mq lg iq le b gy mv ms l mt mu">    return {<br/>      state,<br/>      double,<br/>      increment,<br/>    };<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="9713" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将一个回调传递到<code class="fe lb lc ld le b">computed</code>方法中，以返回我们想要的计算属性的值。</p><p id="e4b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以在我们传递给<code class="fe lb lc ld le b">reactive</code>的对象中调用<code class="fe lb lc ld le b">computed</code>来添加计算的属性作为另一个反应属性的属性。</p><h1 id="f853" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">观察者</h1><p id="57bf" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们可以使用<code class="fe lb lc ld le b">watch</code>功能在Vue应用程序中添加一个观察器。</p><p id="8706" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="8a8f" class="mq lg iq le b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;button <a class="ae kc" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="increment"&gt;increment&lt;/button&gt;<br/>    {{ state.count }}<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="0299" class="mq lg iq le b gy mv ms l mt mu">&lt;script&gt;<br/>import { reactive, watch } from "vue";</span><span id="aa81" class="mq lg iq le b gy mv ms l mt mu">export default {<br/>  setup() {<br/>    const state = reactive({<br/>      count: 0,<br/>    });<br/>    function increment() {<br/>      state.count++;<br/>    }<br/>    watch(<br/>      () =&gt; state.count,<br/>      (count) =&gt; {<br/>        console.log(count);<br/>      },<br/>      { immediate: true }<br/>    );<br/>    return {<br/>      state,<br/>      increment,<br/>    };<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="ae7f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">来补充一下。</p><p id="1bdb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">watch</code>的第一个参数是一个返回<code class="fe lb lc ld le b">state.count</code>反应属性的函数。</p><p id="67cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第二个参数中，我们用<code class="fe lb lc ld le b">count</code>获取<code class="fe lb lc ld le b">state.count</code>的最新值并记录下来。</p><p id="57b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第三个参数是一个带有观察器选项的对象。</p><p id="c783" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在那里设置<code class="fe lb lc ld le b">deep</code>和<code class="fe lb lc ld le b">immediate</code>，就像我们对选项API所做的那样。</p><p id="133b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">deep</code>表示观察对象的所有嵌套属性的变化。</p><p id="72a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">immediate</code>表示当组件安装后，观察器立即运行。</p><h1 id="21d8" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="3a93" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们可以使用Vue 3组合API来定义我们的组件。</p><p id="ff1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在options API中拥有的所有东西仍然可用，只是做了一些改进。</p><p id="77c2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mw">更多内容尽在</em><a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mw">plain English . io</em></strong></a></p></div></div>    
</body>
</html>