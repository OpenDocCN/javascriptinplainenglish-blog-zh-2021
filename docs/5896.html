<html>
<head>
<title>Node.js — module.exports vs. exports</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Node.js — module.exports与exports</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/nodejs-module-exports-vs-exports-b7dfff86bfdd?source=collection_archive---------4-----------------------#2021-12-17">https://javascript.plainenglish.io/nodejs-module-exports-vs-exports-b7dfff86bfdd?source=collection_archive---------4-----------------------#2021-12-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/4f74538cf624ccbea40ab732d6046147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2PSVA6l5-kBIuVKX_RLCTw.jpeg"/></div></div></figure><p id="04b3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果您是Node.js开发人员，您可能在代码中使用过<em class="kt"> module.exports </em>和<em class="kt"> exports </em>。这篇文章是关于深入了解它的。在进入正题之前，最好先了解几件事。</p><blockquote class="ku kv kw"><p id="7aa0" class="jv jw kt jx b jy jz ka kb kc kd ke kf kx kh ki kj ky kl km kn kz kp kq kr ks ig bi translated">除了模块<em class="in">和</em>导出<em class="in">关键字之外，你可能还在Node.js中使用了诸如</em>要求<em class="in">、</em> __filename <em class="in">、</em> __dirname <em class="in">的关键字，但是它们实际上是从哪里来的呢</em>？</p></blockquote><p id="be50" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">假设您有一个console.log()语句。在运行时，Node.js会将它转换成如下所示的形式。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="1445" class="lj lk in lf b gy ll lm l ln lo">(function (exports, require, module, __filename, __dirname){<br/>    console.log()<br/>})();</span></pre><p id="bb6b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这个函数被称为<strong class="jx io">模块包装函数</strong>。现在你知道Node.js魔值<em class="kt">导出</em>、<em class="kt">模块</em>、<em class="kt">要求</em>从哪里来了。这些只是模块包装函数的参数。</p><p id="e1cc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">只需尝试console.log(模块)。你会看到这样的东西。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="7e5c" class="lj lk in lf b gy ll lm l ln lo">Module {<br/>  id: '.',<br/>  path: &lt;path-to-project&gt;,<br/>  exports: {},<br/>  parent: null,<br/>  filename: &lt;path-to-project&gt;&lt;filename&gt;,<br/>  loaded: false,<br/>  children: [],<br/>  paths: []<br/>}</span></pre><p id="64be" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以，<strong class="jx io"> <em class="kt">导出</em> </strong>是<strong class="jx io"> <em class="kt">模块</em> </strong>的一个对象。那么模块包装函数的<em class="kt">导出</em>参数呢？过一会儿你就会看到了。</p><p id="aacf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">考虑以下代码:</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="62ef" class="lj lk in lf b gy ll lm l ln lo">console.log(module) // Before assigning the value to exports<br/>const value = "Hello Node!"<br/>exports.value = value<br/>console.log(module) // After assigning the value to exports</span></pre><p id="a237" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这将是上述两个日志上的<em class="kt">导出</em>对象的输出。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="9bc7" class="lj lk in lf b gy ll lm l ln lo">exports: {} // Before assigning the value<br/>exports: { value: 'Hello Node' } // After assigning the value</span></pre><p id="12ac" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">仔细观察<em class="kt">出口</em>处两根圆木的物体。<em class="kt"> module.exports </em>已经获得了与我们通过<em class="kt"> exports </em>给出的值相同的值(exports.value = value)。这是什么意思？</p><p id="fc37" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这意味着最初，<em class="kt">模块导出</em>和<em class="kt">导出</em>都指向同一个对象。</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/6fbfacf6501099f1b4b39e639ff59544.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*iU_29aJMVx5jouomvSGvfg.png"/></div></figure><p id="45d1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">需要记住的重要事情是<strong class="jx io">当从其他地方需要一个模块时，将返回<em class="kt"> module.exports </em>。不是“<em class="kt">出口</em>”。</strong></p><p id="7674" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，遵循这两条语句的行为是相同的。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="8e14" class="lj lk in lf b gy ll lm l ln lo">module.exports.someFunction = someFunction<br/>exports.someFunction = someFunction</span></pre><p id="c118" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您也可以执行以下操作:</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="eb67" class="lj lk in lf b gy ll lm l ln lo">module.exports = someFunction</span></pre><p id="4d44" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在<em class="kt">不是一个对象而是一个函数。</em></p><p id="3bf2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但是你能做到以下几点吗？</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="acbf" class="lj lk in lf b gy ll lm l ln lo">exports = someFunction</span></pre><p id="a985" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在<em class="kt"> module.exports </em>和<em class="kt"> exports </em>不再引用同一个对象。<em class="kt"> module.exports </em>仍然是空对象，同时<em class="kt"> exports </em>正在引用一个函数。并且提醒一下，当我们从另一个地方需要这个的时候，<em class="kt"> module.exports </em>将被返回，并且是一个<strong class="jx io">空对象！</strong></p><p id="321a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们看一个例子:</p><p id="9eff" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">假设我们有下面这个简单的NodeJS程序，它有两个文件app.js和square.js. square.js将有一个函数来查找给定数字的平方。</p><p id="bdf2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你可以这样做:</p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="lq lr l"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">square.js</figcaption></figure><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="lq lr l"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">app.js</figcaption></figure><p id="8a10" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们也可以有如下的情况:</p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="lq lr l"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">square.js</figcaption></figure><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="lq lr l"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">app.js</figcaption></figure><p id="7fe7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但是，如果您执行以下操作，它将不起作用:</p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="lq lr l"/></div></figure><p id="de79" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在你知道它不起作用的原因了吧！</p><p id="65a3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">感谢您的阅读。</p><p id="62f9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kt">更多内容看</em> <a class="ae lw" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="kt">说白了. io </em> </a> <em class="kt">。报名参加我们的</em> <a class="ae lw" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="kt">免费每周简讯</em> </a> <em class="kt">。在我们的</em> <a class="ae lw" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <em class="kt">社区</em> </a> <em class="kt">获得独家写作机会和建议。</em></p></div></div>    
</body>
</html>