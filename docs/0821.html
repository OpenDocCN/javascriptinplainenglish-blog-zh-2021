<html>
<head>
<title>How to lint Git commit messages</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何lint Git提交消息</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-lint-git-commit-messages-5864dc695d75?source=collection_archive---------9-----------------------#2021-02-20">https://javascript.plainenglish.io/how-to-lint-git-commit-messages-5864dc695d75?source=collection_archive---------9-----------------------#2021-02-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/8c7ed4cd0ce1970e1478247ee1ea22bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*RJLss2tdIVtihhBiSzw7VQ.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk"><a class="ae jv" href="https://b.remarkabl.org/commitlint" rel="noopener ugc nofollow" target="_blank">commitlint</a></figcaption></figure><p id="74db" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">这篇文章讲述了如何用<a class="ae jv" href="https://b.remarkabl.org/commitlint" rel="noopener ugc nofollow" target="_blank">commit list</a>和<a class="ae jv" href="https://b.remarkabl.org/husky" rel="noopener ugc nofollow" target="_blank">husky</a>lint Git commit消息(参见<a class="ae jv" href="https://b.remarkabl.org/3qIwXlU" rel="noopener ugc nofollow" target="_blank">演示库</a>)。</p><h1 id="f56f" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">先决条件</h1><ul class=""><li id="e9fc" class="ls lt in jy b jz lu kd lv kh lw kl lx kp ly kt lz ma mb mc bi translated"><a class="ae jv" href="https://b.remarkabl.org/nodejs-site" rel="noopener ugc nofollow" target="_blank"> Node.js </a></li></ul><h1 id="51bf" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">哈士奇5号</h1><p id="0f3c" class="pw-post-body-paragraph jw jx in jy b jz lu kb kc kd lv kf kg kh md kj kk kl me kn ko kp mf kr ks kt ig bi translated">观看<a class="ae jv" href="https://youtu.be/2J9VnYiZ_Ts?list=PLVgOtoUBG2mdLpj6qT5DXfg5_pGPTDrJZ" rel="noopener ugc nofollow" target="_blank"> YouTube视频</a>:</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="8b1e" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">用配置文件安装<code class="fe mm mn mo mp b"><a class="ae jv" href="https://www.npmjs.com/package/commitlint" rel="noopener ugc nofollow" target="_blank">commitlint</a></code>:</p><pre class="mg mh mi mj gt mq mp mr ms aw mt bi"><span id="87e7" class="mu kv in mp b gy mv mw l mx my">npm install @commitlint/{cli,config-conventional}</span></pre><blockquote class="mz na nb"><p id="6fde" class="jw jx nc jy b jz ka kb kc kd ke kf kg nd ki kj kk ne km kn ko nf kq kr ks kt ig bi translated">这个命令同时安装<code class="fe mm mn mo mp b"><a class="ae jv" href="https://www.npmjs.com/package/@commitlint/cli" rel="noopener ugc nofollow" target="_blank">@commitlint/cli</a></code>和<code class="fe mm mn mo mp b"><a class="ae jv" href="https://www.npmjs.com/package/@commitlint/config-conventional" rel="noopener ugc nofollow" target="_blank">@commitlint/config-conventional</a></code>。</p></blockquote><p id="e0d3" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><a class="ae jv" href="https://github.com/conventional-changelog/commitlint/tree/master/%40commitlint/config-conventional" rel="noopener ugc nofollow" target="_blank">配置-常规</a>是基于<a class="ae jv" href="https://github.com/angular/angular/blob/22b96b9/CONTRIBUTING.md#-commit-message-guidelines" rel="noopener ugc nofollow" target="_blank">角度常规</a>的<a class="ae jv" href="https://www.conventionalcommits.org/" rel="noopener ugc nofollow" target="_blank">标准</a>。</p><p id="cd7f" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">创建<code class="fe mm mn mo mp b">.commitlintrc.json</code>，它扩展了<a class="ae jv" href="https://github.com/conventional-changelog/commitlint/tree/master/%40commitlint/config-conventional" rel="noopener ugc nofollow" target="_blank">配置-常规</a>的规则:</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="ng ml l"/></div></figure><p id="60a2" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">或者导出<code class="fe mm mn mo mp b">commitlint.config.js</code>中的规则:</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="ng ml l"/></div></figure><p id="a3b4" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">安装<code class="fe mm mn mo mp b"><a class="ae jv" href="https://www.npmjs.com/package/husky" rel="noopener ugc nofollow" target="_blank">husky</a></code>:</p><pre class="mg mh mi mj gt mq mp mr ms aw mt bi"><span id="bac2" class="mu kv in mp b gy mv mw l mx my">npm install husky</span></pre><p id="4c36" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">启用<a class="ae jv" href="https://git-scm.com/docs/githooks" rel="noopener ugc nofollow" target="_blank"> Git挂钩</a>:</p><pre class="mg mh mi mj gt mq mp mr ms aw mt bi"><span id="c2c5" class="mu kv in mp b gy mv mw l mx my">npx husky install</span></pre><p id="5594" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">或者给<code class="fe mm mn mo mp b">package.json</code>添加<code class="fe mm mn mo mp b">postinstall</code>脚本，在<code class="fe mm mn mo mp b">npm install</code>之后启用Git挂钩:</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="ng ml l"/></div></figure><blockquote class="mz na nb"><p id="26c7" class="jw jx nc jy b jz ka kb kc kd ke kf kg nd ki kj kk ne km kn ko nf kq kr ks kt ig bi translated">假设包是私有的。如果这个包是<strong class="jy io"> public </strong>，那么确保使用<code class="fe mm mn mo mp b"><a class="ae jv" href="https://github.com/typicode/pinst" rel="noopener ugc nofollow" target="_blank">pinst</a></code>禁用<code class="fe mm mn mo mp b">postinstall</code>脚本。更多信息见<a class="ae jv" href="https://typicode.github.io/husky/#/?id=install" rel="noopener ugc nofollow" target="_blank">哈士奇文件</a>。</p></blockquote><p id="3b01" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">添加<code class="fe mm mn mo mp b">commit-msg</code>钩:</p><pre class="mg mh mi mj gt mq mp mr ms aw mt bi"><span id="b5ca" class="mu kv in mp b gy mv mw l mx my">npx husky add .husky/commit-msg 'npx commitlint --edit $1'</span></pre><blockquote class="mz na nb"><p id="3b3a" class="jw jx nc jy b jz ka kb kc kd ke kf kg nd ki kj kk ne km kn ko nf kq kr ks kt ig bi translated">确保使用单引号而不是双引号，以便正确添加<code class="fe mm mn mo mp b">$1</code>。</p></blockquote><p id="e8ee" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">提交并验证消息是否遵循<a class="ae jv" href="https://www.conventionalcommits.org/" rel="noopener ugc nofollow" target="_blank">常规提交</a>:</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="ng ml l"/></div></figure><h1 id="1a01" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">哈士奇4号</h1><p id="795a" class="pw-post-body-paragraph jw jx in jy b jz lu kb kc kd lv kf kg kh md kj kk kl me kn ko kp mf kr ks kt ig bi translated">用配置文件安装<code class="fe mm mn mo mp b">commitlint</code>:</p><pre class="mg mh mi mj gt mq mp mr ms aw mt bi"><span id="6a5e" class="mu kv in mp b gy mv mw l mx my">npm install @commitlint/{cli,config-conventional}</span></pre><p id="e88d" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">创建<code class="fe mm mn mo mp b">.commitlintrc.json</code>，它扩展了<a class="ae jv" href="https://github.com/conventional-changelog/commitlint/tree/master/%40commitlint/config-conventional" rel="noopener ugc nofollow" target="_blank">配置-常规</a>的规则:</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="ng ml l"/></div></figure><p id="a101" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">或者导出<code class="fe mm mn mo mp b">commitlint.config.js</code>中的规则:</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="ng ml l"/></div></figure><p id="bb23" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">安装<code class="fe mm mn mo mp b">husky@4</code>，设置<a class="ae jv" href="https://git-scm.com/docs/githooks" rel="noopener ugc nofollow" target="_blank">挂钩</a>:</p><pre class="mg mh mi mj gt mq mp mr ms aw mt bi"><span id="2d56" class="mu kv in mp b gy mv mw l mx my">npm install husky@4</span></pre><p id="9e11" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">创建<code class="fe mm mn mo mp b">.huskyrc</code>(或<code class="fe mm mn mo mp b">.huskyrc.json</code>)并添加运行<code class="fe mm mn mo mp b">commitlint</code>的Git <code class="fe mm mn mo mp b">commit-msg</code>钩子:</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="ng ml l"/></div></figure><p id="769d" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">或者给<code class="fe mm mn mo mp b">package.json</code>加上挂钩:</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="ng ml l"/></div></figure><p id="b381" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated">测试提交挂钩是否有效:</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="ng ml l"/></div></figure></div><div class="ab cl nh ni hr nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ig ih ii ij ik"><p id="a31b" class="pw-post-body-paragraph jw jx in jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ig bi translated"><a class="ae jv" href="https://b.remarkabl.org/3u0Vdlc" rel="noopener ugc nofollow" target="_blank"> <em class="nc">本文原载于2019年5月29日《remarkablemark.org》。</em> </a></p></div></div>    
</body>
</html>