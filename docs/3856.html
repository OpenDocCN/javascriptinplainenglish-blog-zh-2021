<html>
<head>
<title>Custom Error Handler Using Node.js and TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js和TypeScript的自定义错误处理程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/custom-error-handler-using-nodejs-typescript-2ab744aa4ef7?source=collection_archive---------1-----------------------#2021-08-03">https://javascript.plainenglish.io/custom-error-handler-using-nodejs-typescript-2ab744aa4ef7?source=collection_archive---------1-----------------------#2021-08-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="ff0f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当你在一个单片应用上工作时，不为你的应用构建一个定制的错误处理程序可能是可以的(这真的不行),但是当你在使用微服务时，那么就必须创建它，因为你的每个微服务可以使用不同的技术栈，并且开发者得到不同的错误模式。这不是表现你的错误的好方法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7848c7f01de95cdfe59bca538022fea4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UaqaXgdZiAqaCA9UcYRI_Q.jpeg"/></div></div></figure><p id="1a66" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是之前，我们没有使用任何错误处理程序的时候。你可以看到每个微服务产生不同类型的错误。现在让我们看看当我们使用自定义处理程序时会发生什么——</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ku"><img src="../Images/98757f981f1206a90dcbe9711d98f48e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9KOXaITuEj6XQElbe_X-cg.jpeg"/></div></div></figure><p id="5004" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在你可以看到我们的开发人员很容易处理一种模式的错误。让我们来建造它—</p><p id="329d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">开始之前，让我们看看文件夹结构，这样你会很容易理解。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi kv"><img src="../Images/c033fe26e98c1e167738fd368345d04d.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*OnasYU3WSODNjuofKOMaxg.png"/></div></figure><p id="7f16" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">先说说<em class="kw">错误</em>文件夹。我们有<em class="kw">customer error . ts</em>文件，其中包含抽象类(它用于维护你的子类的结构)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="kx ky l"/></div></figure><p id="b25a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个文件中，你可以看到我们刚刚在这里创建了一个所有错误类的结构，每个错误类都应该包含消息和状态代码，所有其他东西都只是模板和JavaScript。</p><p id="ad11" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，让我们构建我们的第一个<strong class="jm io"> <em class="kw">数据库-连接-错误</em> </strong> <em class="kw"> </em>，这非常简单。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="kx ky l"/></div></figure><p id="4ce7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，你可以看到我们导入了抽象类并将其扩展到当前类。因此它将检查代码结构。它有助于代码对称。当我们的微服务无法连接到数据库时，出现了数据库错误，其状态代码为500。</p><p id="62eb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在是时候构建<strong class="jm io"> <em class="kw">未发现错误了。</em>T15】</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="kx ky l"/></div></figure><p id="44e3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在可以比较一下这个NotFoundError类和上面的抽象类了。它将符合所有的要求。</p><p id="046b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在是最后一个，也是最普遍和最常见的一个，你会从这个得到错误，<strong class="jm io"> <em class="kw">请求-验证-错误。</em>T19】</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="kx ky l"/></div></figure><p id="baed" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我知道这有点难以理解，但是我们会像JavaScript一样一行一行地看。</p><p id="4932" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，我们导入抽象类，然后导入validationError，它包含验证错误的数组，我们将它放入构造函数的errors变量中，然后以适当的格式返回该方法，就像我们在抽象类中讨论的那样。</p><p id="a608" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们终于达到了我们的错误处理中间件，主要的一个。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="kx ky l"/></div></figure><p id="9f0e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个中间件中，在if语句中，我们检查错误类型的实例。如果错误是我们在错误文件夹中定义的类型，那么它将捕获它。</p><p id="204d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当抛出一个错误时，我们简单地使用类名<code class="fe kz la lb lc b">throw new DatabaseConnectionError() </code>，而不是<code class="fe kz la lb lc b">throw new Error()</code>。</p><p id="548c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="kw">如果您对此有任何疑问，请在</em> <a class="ae ld" href="https://twitter.com/xByZero" rel="noopener ugc nofollow" target="_blank"> <em class="kw"> Twitter </em> </a> <em class="kw">上发表评论或给我发DM。我将很乐意与您联系，并消除您的疑虑。；)</em></p><p id="e74b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="kw">更多内容请看</em><a class="ae ld" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="kw">plain English . io</em></strong></a></p></div></div>    
</body>
</html>