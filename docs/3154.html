<html>
<head>
<title>How to Set Up a Google Firestore Database as an API Endpoint</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Google Firestore数据库设置为API端点</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/set-up-a-google-firestore-database-as-an-api-endpoint-a946f8d824d?source=collection_archive---------6-----------------------#2021-06-26">https://javascript.plainenglish.io/set-up-a-google-firestore-database-as-an-api-endpoint-a946f8d824d?source=collection_archive---------6-----------------------#2021-06-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="0f42" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">这个过程比预期的要容易</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/48018a1cf05bea0f07b4a126cd1499bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yhFm1tmADTmgOUHPrBtcEw.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Source: <a class="ae ks" href="https://www.pexels.com/@thisisengineering" rel="noopener ugc nofollow" target="_blank">ThisIsEngineering</a></figcaption></figure><p id="8df7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">作为一名有抱负的全栈iOS开发者，我对实现这一梦想所需的学习过程和耐心抱有雄心。无论您使用哪种堆栈，使用和全面连接API端点对于成为一名开发人员来说都是非常重要的。</p><p id="4806" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最近，我开始深入到将应用程序连接到API端点的更实际的场景中。最近，<a class="ae ks" href="https://medium.com/codex/fetch-data-from-api-using-urlsessiontask-and-users-gps-coordinates-b8f56234f28d?sk=f66acb1bf44666e973dee69d4baf6f74" rel="noopener"> OpenWeatherMap使用用户的GPS坐标</a>获取数据。此外，我还学到了一些用URLComponents添加查询项和使用字典向URL添加查询项的知识。当查询像iTunes Search这样的API来查找某个艺术家的歌曲或某个演员主演的电影时，这很有帮助。</p><p id="2188" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">虽然连接到现有的API端点很有趣，但我想挑战自己，创建自己的API端点，并能够从客户端运行CRUD操作。这样做会让我脱离使用Xcode和Swift的舒适区，但我喜欢挑战。如果你想跟着做，确保你已经安装了<a class="ae ks" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> VSCode </a>、<a class="ae ks" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>和<a class="ae ks" href="https://www.postman.com/downloads/" rel="noopener ugc nofollow" target="_blank"> Postman </a>。此外，你需要有一个谷歌账户才能使用Firestore。</p><p id="d859" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">前往<a class="ae ks" href="https://www.postman.com/downloads/" rel="noopener ugc nofollow" target="_blank"> Google Firebase控制台</a>并登录。登录后，<strong class="kv io">创建一个新项目</strong>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lp"><img src="../Images/a3910be8943fa1214831e4dbaede0437.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a5f37xwxfbfwouYR2N5xGg.png"/></div></div></figure><p id="9f90" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">创建新项目有几个步骤:</p><p id="9186" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> 1。</strong>为您的项目命名。我将我的命名为<em class="lq"> apiendpoint </em>。</p><p id="0cda" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> 2。</strong>我选择不安装谷歌分析，所以我禁用了切换。</p><p id="cf87" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> 3。</strong>点击<em class="lq">创建项目</em></p><p id="02d5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">创建您的项目需要几秒钟的时间。完成后，你将进入项目的<em class="lq">概述</em>。需要注意的是，为了创建一个API端点，您需要将您的帐户升级到一个Blaze层，该层允许您使用我们将用来部署CRUD操作的云功能。你可以通过点击<em class="lq">星火计划</em>切换到<em class="lq">火焰</em>来改变等级。当切换到Blaze时，您需要注册一个支付选项。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lr"><img src="../Images/b100b903c18ef04c363418f5d2e45614.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iu9Q1EZYP3cUxkipJC5J0A.png"/></div></div></figure><p id="e539" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">接下来，在左侧面板中选择Firestore数据库。然后选择<em class="lq">创建数据库</em>。将出现一个弹出窗口，询问您是要将数据库设置为生产模式还是测试模式。在本演练中，我们将选择测试模式，但在生产环境(即公共网站、web/移动应用程序等)中使用数据库时，保护数据库的安全非常重要。</p><p id="ed0d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">选择测试模式后，单击下一步。下一个窗口将询问您希望数据库存储在什么位置。最好根据你的地理位置，在下拉菜单中选择一个选项。在我的情况下，它是<em class="lq"> nam5(美国中部)</em>，因为我住在美国。一旦你选择了最适合你的位置的选项，点击启用。</p><p id="80a7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">之后，您的数据库将开始创建，您选择的安全规则将被应用。如果一切顺利，当您的数据库成功创建后，您应该会看到下面的屏幕:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ls"><img src="../Images/a2ed5368a9ec150c1fc14f03bb12308f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pUT1QSb9l5lCsshxmFPUtA.png"/></div></div></figure><p id="2e7c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你得到了上面的结果，恭喜你！您已经创建了您的云Firestore数据库🙌🏻。</p><p id="4531" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在我们已经在Firestore中设置了数据库，让我们设置项目的本地目录。我将在我的桌面上创建一个名为<em class="lq"> apiendpoint </em>的文件夹，这样它就与我的数据库名相匹配了。接下来，我将打开VSCode，通过在VSCode中拖动文件夹，将我的项目文件夹添加到VSCode中。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lt"><img src="../Images/dcdd22b6a465a60a17467eac9d501d3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uposX_QUajn8xzaua1LENg.png"/></div></div></figure><p id="6e0e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">接下来，我们将在项目中安装Firebase。您可以通过使用嵌入在VSCode中的来实现这一点。点击终端&gt;新终端，下面会打开一个终端窗口。确保路径设置在项目文件夹内。比如我的设置为<em class="lq">Joes-MacBook-Pro:~/Desktop/API endpoint</em>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lu"><img src="../Images/ab6e09d05295797ac47858a17cb60aba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wOLxm_KSbrnv8LUMyE0WVA.png"/></div></div></figure><p id="bb38" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一旦终端运行，输入<em class="lq"> firebase init </em>，这是将firebase安装到您的项目中的命令。按Enter键，您应该会看到以下结果:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lv"><img src="../Images/fbd7003534b3e9b0d8fc7ebbabaebed0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qOh80rZn_PoeXrLP9PGDxw.png"/></div></div></figure><p id="7c74" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">从上面的问题开始，接下来会有一系列的问题。下面是我们设置API端点所需的答案/功能:</p><ol class=""><li id="9404" class="lw lx in kv b kw kx kz la lc ly lg lz lk ma lo mb mc md me bi translated">您想为此目录设置哪些Firebase功能？<em class="lq">功能:配置云功能目录及其文件</em></li><li id="2aec" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated"><em class="lq">使用现有项目</em>并选择您的项目名称。</li><li id="da29" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">语言将会是JavaScript。</li><li id="6036" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">键入<em class="lq"> n </em>然后按回车键退出安装ESLint。我发现ESLint会产生<a class="ae ks" href="https://github.com/eslint/eslint/issues/10127" rel="noopener ugc nofollow" target="_blank">问题</a>阻止功能部署，所以我拒绝安装它。</li><li id="aed4" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">键入<em class="lq"> y </em>,然后按Enter键安装npn的依赖项。</li></ol><p id="5093" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">将开始安装Firebase依赖项。根据您的互联网连接，应该需要大约一分钟。在我们继续之前，还需要安装几个依赖项。键入<em class="lq"> npm i cors </em>并按enter安装。要了解更多关于cors的信息，点击<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS" rel="noopener ugc nofollow" target="_blank">这里</a>。安装好cors之后，输入<em class="lq"> npm i express </em>并输入Enter。你可以在这里阅读关于快递<a class="ae ks" href="https://www.npmjs.com/package/express" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mk"><img src="../Images/076c979cf8c2721d2e711378dbf19088.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4F1n9tDAjt3gied4w-rfEQ.png"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ml"><img src="../Images/78a8c0d62a979c0ac973fd66b1cbe6f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HaA6NIL3fOTr3h83SBZ52w.png"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/9532003282f2f4a1c4b9191a25d4f04b.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*XoutAuxMvCBW6g68Y1liag.png"/></div></figure><p id="e821" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">开始编码吧！</p><p id="ec83" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在Firebase依赖项的安装过程中，一系列文件夹和文件被添加到您的项目中。</p><p id="d258" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">👈🏼我们将使用的文件是functions文件夹中的index.js文件。</p><p id="d58b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果还没有打开index.js文件，请打开它。我们需要首先在顶部建立一些常量。以下是所述常数。注意databaseURL键值是一个空字符串。当我们稍后将这些功能部署到Firebase时，我们将填写URL。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="d18a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们开始研究构建数据库时需要的基本功能。首先，我们将从<strong class="kv io"> POST </strong>函数开始。该功能允许我们向数据库中添加数据。在常量下面，编写以下代码行:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mp mo l"/></div></figure><p id="51d6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在POST函数下面，我们将开始编写<strong class="kv io"> GET </strong>函数，但是这个函数将根据ID获取数据库中的特定文档:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mo l"/></div></figure><p id="a5ca" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">接下来，我们将使用<strong class="kv io"> GET </strong>函数，该函数从数据库中获取<strong class="kv io">所有</strong>数据，包括嵌套数据。在按ID获取数据的GET函数下面，编写以下代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr mo l"/></div></figure><p id="9252" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们要放在一起的下一个函数是<strong class="kv io"> PUT </strong>函数，它只是一个更新函数。这个特殊的函数根据它的ID更新数据。在GET(所有数据)函数下，编写以下内容:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mp mo l"/></div></figure><p id="1c5f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们要添加的最后一个函数和CREATE一样必要。如果不能删除数据，就不能拥有功能端点。在PUT函数下面，我们将添加<strong class="kv io"> DELETE </strong>函数:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="e114" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在我们的函数已经写好了，我们需要在文件的底部再写一行代码。这一行将在我们每次部署时将我们的API导出到Firebase云函数。因为可以在这个文件中编写无数的函数来管理数据库中的数据，所以每次更新时都必须部署这个文件。以下代码行帮助您将项目导出到Firebase:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ms mo l"/></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mt"><img src="../Images/bb40263af9e425b8945656914c09fb29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q_V6q9s_mvuKuTkIvNDrxQ.png"/></div></div></figure><p id="ff5d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在将代码部署到Firestore之前，我们还有一件小事要做。我们需要确保通过Firestore验证我们的代码。为此，请打开项目的Firebase控制台。点击项目概述旁边的齿轮图标，并选择<em class="lq">用户和权限</em>。</p><p id="b682" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">接下来，在项目设置中选择服务帐户。确保选择Node.js，然后单击Generate new private key:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mu"><img src="../Images/8e6e8fb7f0aea1b9da4eaf4ea072616a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z8z7jKCp0ieoqgH7Y5qCxg.png"/></div></div></figure><p id="48e5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">将此文件另存为<em class="lq"> permissions.json </em>到您项目的<em class="lq">函数</em>文件夹路径</strong>。这一点至关重要，因为我们的index.js文件被配置为位于以下路径:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mv"><img src="../Images/e7ab9be1d84e60dc0c2babe26fe39e40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i_rc2sSQKp1M-sPlqI467w.png"/></div></div></figure><p id="f63a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一旦将<em class="lq"> permissions.json </em>保存到项目的function文件夹中，就该将代码部署到Firestore了。返回到VSCode终端，键入<em class="lq"> firebase deploy </em>，并点击Enter:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mw"><img src="../Images/7395b53b34c5e1dc7eac7e571db77ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i7Yk2PGPs1YZtYphTxRHWw.png"/></div></div></figure><p id="be55" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这个过程检查您的代码，以确保没有错误。如果一切顺利，您应该会看到消息<em class="lq">部署完成！</em>如果它返回错误，确保你的index.js与我提供的代码相同。</p><p id="0f6b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">注意结果中的函数URL</strong>。这是您将用来配置您的Postman客户机的API端点。请突出显示并复制URL。</p><p id="75d8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Open Postman，我们将通过它连接到端点并执行CRUD操作。单击最左侧窗格上的收藏。然后点击“+”号。这将允许我们创建一个请求集合，并保持我们的项目有组织。你可以随意命名你的收藏。我将我的项目命名为与我的Firestore项目相同的名称，<em class="lq"> APIENDPOINT </em>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mx"><img src="../Images/7f6ccdf5c286b2a72a9a4be897d73c5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QuUIh12XDMpRvBOqENuvFw.png"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi my"><img src="../Images/79095276334a9f4066ea87c182eaa1f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oLXNhSRgeUNrmmgf28uR3w.png"/></div></div></figure><p id="0e9e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">👈🏼创建收藏后，点击方便提供的<em class="lq">添加请求</em>链接。</p><h1 id="e31a" class="mz na in bd nb nc nd ne nf ng nh ni nj jt nk ju nl jw nm jx nn jz no ka np nq bi translated">发布请求</h1><p id="b812" class="pw-post-body-paragraph kt ku in kv b kw nr jo ky kz ns jr lb lc nt le lf lg nu li lj lk nv lm ln lo ig bi translated">我们要构建的第一个请求是POST，即在数据库中创建数据的操作。命名您的请求帖子，然后从下拉菜单中选择帖子:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/10012e939331bf95c1bcb1511e1884e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*U1MkTsrkVFJBenmU5kt_tw.png"/></div></figure><p id="23c6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">接下来，我们将通过一系列步骤开始构建我们的POST请求:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nx"><img src="../Images/5555177e8aaf7381c2aa6c783a4f129b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nllRDzqDgbZ7ShAktMzO_w.png"/></div></div></figure><p id="4957" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在第一步中，粘贴好你的网址后，在最后添加<strong class="kv io"> <em class="lq"> /API/create </em> </strong>。这就是所谓的POST函数。</p><p id="34f9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在第5步中，您必须按照index.js文件中POST函数的写法构造JSON主体。当您试图将数据发送到端点时，将会收到一个错误。</p><p id="246e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">点击发送按钮将我们的数据发送到我们的数据库。几秒钟后，如果一切顺利，您将获得200 OK状态代码。如果您得到任何其他东西，请确保URL和JSON主体结构是正确的。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ny"><img src="../Images/8ee09b67fcaa6b38c85840665806fbcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jqpC1XaWm3Qo4dp-yJAxMQ.png"/></div></div></figure><p id="09c3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在浏览器中打开Firestore数据库，您应该会看到我们刚刚发布的数据:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nz"><img src="../Images/947eacb482393d35c553983aa8cac9b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aNV77A4BVrqrgo-27qOftQ.png"/></div></div></figure><p id="11f2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我想发出的下一个请求是GET，但在此之前，让我们向数据库添加更多数据。在Postman中，编辑JSON主体结构，将id改为<strong class="kv io"> <em class="lq"> 2 </em> </strong>，将名称改为<strong class="kv io"> <em class="lq">产品B，</em> </strong>并将描述改为<strong class="kv io"> <em class="lq">这是产品B的描述</em> </strong>，我们可以将价格值保留为<strong class="kv io"> <em class="lq"> 100 </em> </strong>。然后点击发送。一旦得到状态码200 OK，再次编辑JSON体；id为<strong class="kv io"> <em class="lq"> 3 </em> </strong>，名称为<strong class="kv io"> <em class="lq">产品C，</em> </strong>和描述为<strong class="kv io"> <em class="lq">这是产品C的描述</em> </strong>。单击发送。一旦你得到200 OK，回到你的Firestore数据库，你应该会看到所有3个条目。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oa"><img src="../Images/3252dbabdeae38ca2b74114b17329f7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IWWNB5LO-WJzgGOrNXnwFw.png"/></div></div></figure><h1 id="b99d" class="mz na in bd nb nc nd ne nf ng nh ni nj jt nk ju nl jw nm jx nn jz no ka np nq bi translated">获取请求</h1><p id="6b5c" class="pw-post-body-paragraph kt ku in kv b kw nr jo ky kz ns jr lb lc nt le lf lg nu li lj lk nv lm ln lo ig bi translated">既然我们已经能够将数据发送到数据库中，那么让我们创建GET请求来查看数据库中的数据。点击您收藏的省略号图标，并选择<em class="lq">添加请求:</em></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ob"><img src="../Images/d4afacc05fe62329cc4312d2aefc4978.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7arzLx4Gl8ksTP9yDTiv2A.png"/></div></div></figure><p id="8666" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">设置GET请求如下:</p><ol class=""><li id="b4f9" class="lw lx in kv b kw kx kz la lc ly lg lz lk ma lo mb mc md me bi translated">将请求命名为GET</li><li id="2406" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">从请求类型下拉菜单中选择获取。</li><li id="97cd" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">粘贴你的网址，最后加上<strong class="kv io"> <em class="lq">读作</em> </strong>。这个函数查询并返回数据库中的所有文档。</li><li id="8d5c" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">单击发送。</li><li id="423d" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">通过从下拉列表中选择<em class="lq"> Pretty </em>和<em class="lq"> JSON </em>来配置响应部分。这将把我们查询的数据组织成一种JSON格式，更易于阅读。</li><li id="c84d" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">最后，您应该能够查看我们数据库中当前的数据。</li></ol><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oc"><img src="../Images/3139e514502841c303521ee7d5b1b4d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iy0dGq4Wi-VT7Mvtabbmmw.png"/></div></div></figure><h1 id="78f1" class="mz na in bd nb nc nd ne nf ng nh ni nj jt nk ju nl jw nm jx nn jz no ka np nq bi translated">按id获取</h1><p id="5a15" class="pw-post-body-paragraph kt ku in kv b kw nr jo ky kz ns jr lb lc nt le lf lg nu li lj lk nv lm ln lo ig bi translated">下一个调用不像我们之前放在一起的GET请求那样常见，但是很方便。这个调用根据传入的id从我们的数据库中获取一个文档。</p><p id="ff6e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因为这个请求类似于前面的GET请求，所以我们可以复制它，这样可以节省一些时间:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi od"><img src="../Images/90a1672ff13b6fe49296edf5a639e722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y-NH2kemqI5Dalf3Vr0AcQ.png"/></div></div></figure><p id="ba68" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下面我们设置了一个URL来查询id值设置为1的文档，即产品a。如果有一个文档具有您设置的id值，它将随该文档一起返回。因为我们目前只有3个文档，所以它将只查询其中的一个。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oe"><img src="../Images/13d290097cb6a5ac2b1ea4493c1f58e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o3oaYHrxrF9p0uKeWmrSZA.png"/></div></div></figure><h1 id="beb2" class="mz na in bd nb nc nd ne nf ng nh ni nj jt nk ju nl jw nm jx nn jz no ka np nq bi translated">按id请求删除</h1><p id="1054" class="pw-post-body-paragraph kt ku in kv b kw nr jo ky kz ns jr lb lc nt le lf lg nu li lj lk nv lm ln lo ig bi translated">我们要处理的下一个基本请求是删除请求。该请求将请求删除id，类似于之前的读取请求。虽然您可以创建一个删除所有数据的请求，但您真的不想拥有这种权力，所以最好按id删除。继续复制GET by id请求，并将其重命名为DELETE by id。在您的URL中，将<em class="lq">改为</em>并删除。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi of"><img src="../Images/828317ebc0d993c24b5aefe18f228406.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OQwL6p-jcB5fBbBgL4SVdg.png"/></div></div></figure><p id="2fd1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">目前，我的数据库中有3个文档，这意味着我可以删除<em class="lq"> /1 </em>、<em class="lq"> /2、</em>或<em class="lq"> /3 </em>。选择要删除的id，然后单击发送。一旦请求成功，返回到读取整个数据库的GET请求，单击send，您应该会注意到您删除的文档不再可用。</p><h1 id="48f5" class="mz na in bd nb nc nd ne nf ng nh ni nj jt nk ju nl jw nm jx nn jz no ka np nq bi translated">按id请求放置</h1><p id="2a52" class="pw-post-body-paragraph kt ku in kv b kw nr jo ky kz ns jr lb lc nt le lf lg nu li lj lk nv lm ln lo ig bi translated">最后但同样重要的是，我们可以配置我们的PUT请求，也就是更新请求。复制您的删除请求，将请求重命名为PUT by id，在request-type下拉菜单中选择PUT，并通过用<em class="lq"> update </em>替换<em class="lq"> delete </em>来更新URL。</p><p id="dbd7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我决定更新id为3的文档，但是您可以更改任何现有的文档。对于名称，我已将其更改为<em class="lq">产品X </em>，对于描述，我已将其更改为<em class="lq">这是产品X的描述</em>。完成后，点击发送。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi og"><img src="../Images/05b17175e88788d4ac771511d52e6857.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d7BPuGpm3A700V7R5KrQHw.png"/></div></div></figure><p id="49c5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果您打开了Firestore数据库，您会注意到您正在更新的文档会发出橙色光，这表示它已被更新:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oh"><img src="../Images/667807fc025c08031986bc65c2fb13c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ayhn32fxxFtZUIDd0VixGw.png"/></div></div></figure><p id="bae4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">关于使用Google Firestore、Express、Node.js、VSCode和Postman构建API端点的指南到此结束。</p><h1 id="4f71" class="mz na in bd nb nc nd ne nf ng nh ni nj jt nk ju nl jw nm jx nn jz no ka np nq bi translated">从这里你能去哪里？</h1><p id="2c48" class="pw-post-body-paragraph kt ku in kv b kw nr jo ky kz ns jr lb lc nt le lf lg nu li lj lk nv lm ln lo ig bi translated">你有一个功能数据库，你可以连接到一个网络或移动应用程序，并用Postman更新它。作为一名有抱负的iOS开发人员，这帮助我获得了如何为我心目中的未来iOS项目构建数据库的知识。一旦我建立了Firestore数据库，我只需要<a class="ae ks" href="https://firebase.google.com/docs/firestore/quickstart" rel="noopener ugc nofollow" target="_blank">将Firestore依赖项</a>安装到我的iOS项目中，这样它就可以与我的数据库通信。只要Firestore支持这种语言，您也可以对您的项目做同样的事情。</p><p id="307a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">编码快乐！</p><p id="b337" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="lq">更多内容请看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="lq">plain English . io</em></strong></a></p></div></div>    
</body>
</html>