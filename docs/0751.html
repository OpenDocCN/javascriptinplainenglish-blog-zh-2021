<html>
<head>
<title>Webpack in 2023: TypeScript + Jest + Sass + ESLint</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2023年的web pack:TypeScript+Jest+Sass+ESLint</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/webpack-in-2021-typescript-jest-sass-eslint-7b4640842e27?source=collection_archive---------0-----------------------#2021-02-16">https://javascript.plainenglish.io/webpack-in-2021-typescript-jest-sass-eslint-7b4640842e27?source=collection_archive---------0-----------------------#2021-02-16</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="f71f" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">如何在2023年用Webpack 5构建你的项目</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/e5e07b6242ff2cd394ce1b2cc66047ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RRZ_4k07vGDUamH2pe37Sw.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Webpack 5</figcaption></figure><p id="c8ea" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">几乎每年，我都会遇到需要建立一个新的javascript项目的情况。像Angular这样的现代框架项目已经为我们配置好了。但是更简单的应用程序或小部件呢，它们应该是框架不可知的？通常，我们需要:一个肝脏重装程序、类型脚本、CSS预处理器、一个单元测试框架和一个linter。本指南将介绍如何构建一个生产就绪的初学者工具包，它将满足我们的所有需求。</p><p id="7a6e" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">我将使用:Webpack 5、Jest、SCSS和ESLint。您可以滚动到末尾查看seed项目链接，或者一步一步地阅读，了解如何从头开始设置它。</p><p id="bbeb" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><strong class="ky is"> <em class="ls">最近更新时间:2023年1月14日</em> </strong></p></div><div class="ab cl lt lu hv lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ik il im in io"><h2 id="38a9" class="ma mb ir bd mc md me dn mf mg mh dp mi lf mj mk ml lj mm mn mo ln mp mq mr ms bi translated">初始化项目</h2><p id="038a" class="pw-post-body-paragraph kw kx ir ky b kz mt js lb lc mu jv le lf mv lh li lj mw ll lm ln mx lp lq lr ik bi translated">首先，我们需要创建一个npm项目，但是如果你愿意，你可以用yarn代替。</p><p id="49df" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe my mz na nb b">npm init -y</code></p><p id="b99a" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">重命名项目，如果需要，在<code class="fe my mz na nb b">package.json</code>中提供更多细节。</p><p id="b5bc" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">创建一个src文件夹，并在其中创建<strong class="ky is"> index.ts </strong>文件。这个文件将是我们应用程序的入口点。</p><h1 id="8791" class="nc mb ir bd mc nd ne nf mf ng nh ni mi jx nj jy ml ka nk kb mo kd nl ke mr nm bi translated">网络包</h1><p id="8364" class="pw-post-body-paragraph kw kx ir ky b kz mt js lb lc mu jv le lf mv lh li lj mw ll lm ln mx lp lq lr ik bi translated">现在我们需要安装构建过程的核心工具— <strong class="ky is"> Webpack 5 </strong>(这是写作日的最新版本)。</p><p id="bb5a" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe my mz na nb b">npm install webpack webpack-cli --save-dev</code></p><p id="4af8" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">为了更好地准备生产，我们将创建多个webpack配置，一个用于开发，另一个用于构建生产工件。</p><p id="a284" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><strong class="ky is"> webpack.common.js </strong>将包含设置，这将被两个配置使用。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="6b04" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">加载器和插件的规则现在是空的，但不会很久。</p><p id="a0ba" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">基于这个文件，我们可以实现两种配置:</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="f112" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">和</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="259f" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">我用ESLint规则添加了第一行，因为在接下来的步骤中，在我们的项目中将禁止使用require。</p><h1 id="606c" class="nc mb ir bd mc nd ne nf mf ng nh ni mi jx nj jy ml ka nk kb mo kd nl ke mr nm bi translated">以打字打的文件</h1><p id="5a14" class="pw-post-body-paragraph kw kx ir ky b kz mt js lb lc mu jv le lf mv lh li lj mw ll lm ln mx lp lq lr ik bi translated">支持typescript webpack需要两件事:</p><ol class=""><li id="075d" class="np nq ir ky b kz la lc ld lf nr lj ns ln nt lr nu nv nw nx bi translated">tsconfig.json</li><li id="6d33" class="np nq ir ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">ts-loader</li></ol><p id="f335" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">在我们项目的根创建<code class="fe my mz na nb b">tsconfig.json</code>。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="6950" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">然后安装typescript和ts-loader。这是一个webpack加载器，它将向webpack解释如何处理ts文件。</p><p id="c7b9" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe my mz na nb b">npm install --save-dev typescript ts-loader</code></p><p id="f8d6" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">安装之后，我们可以将第一个Webpack加载器添加到公共配置中。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="d57b" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">这时，我们已经可以构建我们的主<code class="fe my mz na nb b">index.ts</code>文件了。但这只是开始。</p><h1 id="2931" class="nc mb ir bd mc nd ne nf mf ng nh ni mi jx nj jy ml ka nk kb mo kd nl ke mr nm bi translated">厚颜无耻</h1><p id="9e75" class="pw-post-body-paragraph kw kx ir ky b kz mt js lb lc mu jv le lf mv lh li lj mw ll lm ln mx lp lq lr ik bi translated">为了支持sass，我们需要做与处理typescript几乎相同的事情。</p><p id="e641" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">安装sass和加载程序:</p><p id="86ea" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe my mz na nb b">npm install --save-dev sass-loader style-loader css-loader node-sass</code></p><p id="5fb6" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">另外，我们需要安装MiniCssExtractPlugin。我们需要这个插件来为dist文件夹生成单独的CSS文件。</p><p id="c47a" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe my mz na nb b">npm install --save-dev mini-css-extract-plugin</code></p><p id="ba9b" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">将MiniCssExtractPlugin添加到Webpack插件数组:</p><pre class="kh ki kj kk gu od nb oe of aw og bi"><span id="4997" class="ma mb ir nb b gz oh oi l oj ok">plugins: [<br/>   new MiniCssExtractPlugin({<br/>     // Options similar to the same options in webpackOptions.output<br/>     // both options are optional<br/>     filename: '[name].[contenthash].css',<br/>     chunkFilename: '[id].css'<br/>   }),<br/>]</span></pre><p id="b3af" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">然后将加载程序添加到webpack.common.js配置中，紧挨着ts-loader:</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="b19b" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">正如您所看到的，对于产品构建，我们使用MiniCssExtractPlugin将样式编译为单独的文件。对于开发，我们将把它们直接添加到HTML中。</p><p id="cf51" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">现在您可以创建任何scss文件并将其导入index.ts. <br/>例如，让我们在src文件夹中创建styles.scss。</p><p id="a1dd" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">添加到<code class="fe my mz na nb b">index.ts</code>的下一行:<br/>T1】</p><p id="fa17" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">万岁！我们支持萨斯。如果你需要使用less，你需要安装less-loader而不是sass和sass-loader。</p><h1 id="05cb" class="nc mb ir bd mc nd ne nf mf ng nh ni mi jx nj jy ml ka nk kb mo kd nl ke mr nm bi translated">Webpack插件</h1><p id="d4bd" class="pw-post-body-paragraph kw kx ir ky b kz mt js lb lc mu jv le lf mv lh li lj mw ll lm ln mx lp lq lr ik bi translated">我们需要添加一些有用的插件，对我来说它们是强制性的:</p><p id="7360" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><strong class="ky is"> clean-webpack-plugin </strong> —每次webpack进行新构建时清理dist文件夹。</p><p id="9b04" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><strong class="ky is"> html-webpack-plugin </strong> —从带有脚本和样式标签的模板生成index.html文件。</p><p id="2c47" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><strong class="ky is">fork-ts-checker-web pack-plugin</strong>—这个插件允许我们作为一个单独的过程来检查打字稿的打字情况。它将提高构建性能。</p><p id="e3ec" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><strong class="ky is"> copy-webpack-plugin </strong> —这个插件让我们能够将assets文件夹及其内容复制到dist文件夹。</p><p id="4a52" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">使用npm安装它们:</p><p id="72e7" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe my mz na nb b">npm install clean-webpack-plugin copy-webpack-plugin fork-ts-checker-webpack-plugin html-webpack-plugin --save-dev</code></p><p id="adc3" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">并将它们添加到Webpack公共配置:</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nn no l"/></div></figure><h1 id="236f" class="nc mb ir bd mc nd ne nf mf ng nh ni mi jx nj jy ml ka nk kb mo kd nl ke mr nm bi translated">玩笑</h1><p id="92eb" class="pw-post-body-paragraph kw kx ir ky b kz mt js lb lc mu jv le lf mv lh li lj mw ll lm ln mx lp lq lr ik bi translated">我惊讶于添加这个框架来为我们的项目进行单元测试是如此的容易。</p><p id="ced4" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">您需要安装它:</p><p id="36e4" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe my mz na nb b">npm install --save-dev jest ts-jest @types/jest</code></p><p id="c961" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">又跑:<br/> <code class="fe my mz na nb b">npx ts-jest config:init</code></p><p id="ab7d" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">它会生成一个简单的<code class="fe my mz na nb b">jest.config.js file</code>，但是足够开始测试了！</p><pre class="kh ki kj kk gu od nb oe of aw og bi"><span id="a3d7" class="ma mb ir nb b gz oh oi l oj ok">module.exports = {<br/> preset: 'ts-jest',<br/> testEnvironment: 'node',<br/>};</span></pre><p id="a26a" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">创建一个spec文件夹，并在其中创建任何*.spec.ts文件。Jest会找到它并运行单元测试。</p><p id="e506" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">要启动测试，您需要运行一个小命令:</p><p id="4b9d" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe my mz na nb b">npx jest</code></p><p id="db79" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">将其添加到<code class="fe my mz na nb b">package.json</code>文件中的npm脚本:<br/> <code class="fe my mz na nb b">“test”: “npx jest”</code></p><p id="3c02" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">您的测试应该在spec文件夹中，名称格式为<strong class="ky is"> *.spec.ts </strong>。</p><h1 id="1f08" class="nc mb ir bd mc nd ne nf mf ng nh ni mi jx nj jy ml ka nk kb mo kd nl ke mr nm bi translated">埃斯林特</h1><p id="cc71" class="pw-post-body-paragraph kw kx ir ky b kz mt js lb lc mu jv le lf mv lh li lj mw ll lm ln mx lp lq lr ik bi translated">最后一件事是林挺。不是强制性的，但是它可以显著提高代码的一致性和风格。</p><p id="4249" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">安装它:</p><p id="4d26" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><code class="fe my mz na nb b">npm i @typescript-eslint/eslint-plugin @typescript-eslint/parser — save-dev</code></p><p id="6145" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">然后更新webpack.common.js配置:</p><pre class="kh ki kj kk gu od nb oe of aw og bi"><span id="fdc3" class="ma mb ir nb b gz oh oi l oj ok">const ESLintPlugin = require('eslint-webpack-plugin');</span><span id="8564" class="ma mb ir nb b gz ol oi l oj ok">module.exports = {<br/>  ...<br/>  plugins: [<br/>     ...<br/>     new ESLintPlugin({<br/>        extensions: ['.tsx', '.ts', '.js'],<br/>        exclude: 'node_modules'<br/>     })<br/>  ],<br/>  ...<br/>};</span></pre><p id="65c0" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">用棉绒配置创建<code class="fe my mz na nb b">.eslintrc.js</code>。以下是默认示例:</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nn no l"/></div></figure><h1 id="9fb0" class="nc mb ir bd mc nd ne nf mf ng nh ni mi jx nj jy ml ka nk kb mo kd nl ke mr nm bi translated">NPM剧本</h1><p id="8ae7" class="pw-post-body-paragraph kw kx ir ky b kz mt js lb lc mu jv le lf mv lh li lj mw ll lm ln mx lp lq lr ik bi translated">向package.json添加一些脚本来简化构建过程:</p><pre class="kh ki kj kk gu od nb oe of aw og bi"><span id="2712" class="ma mb ir nb b gz oh oi l oj ok">"scripts": {<br/>  "start": "webpack serve --open --config webpack.dev.js",<br/>  "build": "NODE_ENV=production webpack --config webpack.prod.js",<br/>  "test": "npx jest"<br/>}</span></pre><h1 id="646e" class="nc mb ir bd mc nd ne nf mf ng nh ni mi jx nj jy ml ka nk kb mo kd nl ke mr nm bi translated">决赛成绩</h1><p id="8917" class="pw-post-body-paragraph kw kx ir ky b kz mt js lb lc mu jv le lf mv lh li lj mw ll lm ln mx lp lq lr ik bi translated">这里是<a class="ae om" href="https://github.com/Golosay/webpack-seed" rel="noopener ugc nofollow" target="_blank">到最终源代码</a>的链接。您可以将它用作示例或种子项目。</p><p id="e17d" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">在运行<code class="fe my mz na nb b">npm run build</code>之后，<strong class="ky is"> dist </strong>文件夹应该看起来像这样:</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj on"><img src="../Images/3812f150a16e39db08b21f38a7f01f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tNz_jd-DKGJ74nCG909f4w.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Dist folder structure example</figcaption></figure><p id="fcc7" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">感谢您的阅读，祝您愉快！</p><div class="oo op gq gs oq or"><a rel="noopener  ugc nofollow" target="_blank" href="/vite-vs-webpack-a-look-at-vite-as-a-replacement-for-webpack-in-2023-eca90d70aa42"><div class="os ab fp"><div class="ot ab ou cl cj ov"><h2 class="bd is gz z fq ow fs ft ox fv fx iq bi translated">Vite VS Webpack:看看2023年Vite作为Webpack的替代品</h2><div class="oy l"><h3 class="bd b gz z fq ow fs ft ox fv fx dk translated">从头开始构建项目:TypeScript + Jest + Sass + ESLint</h3></div><div class="oz l"><p class="bd b dl z fq ow fs ft ox fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf kq or"/></div></div></a></div></div><div class="ab cl lt lu hv lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ik il im in io"><p id="2103" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">如果你不是一个中型成员，并想支持我，你可以通过<a class="ae om" href="https://golosay.medium.com/membership" rel="noopener">以下这个链接</a>这样做。中型会员将允许你阅读我的帖子和其他人的帖子。再次感谢大家的支持！</p></div></div>    
</body>
</html>