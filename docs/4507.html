<html>
<head>
<title>How To Create and Download Files in the Browser With Vanilla JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用普通JavaScript在浏览器中创建和下载文件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-create-file-c36f8bccb3be?source=collection_archive---------2-----------------------#2021-09-08">https://javascript.plainenglish.io/javascript-create-file-c36f8bccb3be?source=collection_archive---------2-----------------------#2021-09-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ba25" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我想知道这有多简单</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c31cca6ef9533895304d5d1dbea4df58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2TRZLjPBPQE7-vnoazOtzA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: the author</figcaption></figure><p id="99e8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">想知道web应用程序是如何生成文件并让你下载它们的吗？</p><p id="6e51" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一种常见的方法是在后端生成文件。然后，在浏览器中发生到文件的重定向，这导致下载。但是还有另一种方法:可以在浏览器中生成和下载文件。我们甚至不需要JavaScript库来实现这一点。这是它的工作原理。</p><h1 id="ec7f" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">用JavaScript生成文件</h1><p id="cf47" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">为了处理文件，浏览器中有一个API。它被称为文件API，并得到广泛支持。为了用它创建一个文件，我们创建了一个新的<code class="fe mo mp mq mr b">File</code>类实例。就像下面的代码一样简单:</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="5118" class="mw ls iq mr b gy mx my l mz na">const file = new File(['foo'], 'note.txt', {<br/>  type: 'text/plain',<br/>})</span></pre><p id="ef06" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">必要的参数如下:</p><ul class=""><li id="fa8d" class="nb nc iq kx b ky kz lb lc le nd li ne lm nf lq ng nh ni nj bi translated">首先，一个数据数组——这可以是一个Blob、一个ArrayBuffer，或者像我们的例子一样，是一个兼容的字符串。</li><li id="6dbb" class="nb nc iq kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">第二，文件名，包括结尾。</li><li id="8c7d" class="nb nc iq kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">作为一个选项，我们传递文件的实际类型。</li></ul><p id="a55d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">用于生成文件，包含<code class="fe mo mp mq mr b">text/plain</code>类型数据(文本、HTML、CSV等)的文件。)，这就是我们需要的一切。生成更抽象的文件类型需要使用blobs或缓冲区。</p><p id="4b60" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">就目前而言，这就足够了。我们在浏览器中创建了一个新的txt文件。那么，下一步是什么？</p><h1 id="39ee" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">下载文件</h1><p id="d605" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">为了检查创建文件是否有效，我们需要访问它。访问它需要下载。为了下载文件，我们使用了一个小技巧:</p><p id="8018" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们生成一个包含文件引用的链接。然后，我们让JavaScript点击链接，这样文件就被下载了。但是我们从哪里得到文件在浏览器中的URL呢？</p><p id="be61" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了接收我们的文件URL，我们使用了<code class="fe mo mp mq mr b">URL.createObjectURL()</code>,它接收我们的文件对象作为参数。然后，通过设置链接的<code class="fe mo mp mq mr b">download</code>属性，指定保存文件的默认名称。</p><p id="5956" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们在DOM中挂载链接，人工点击它，并从DOM中删除它。以下是完整的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="b9b7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">已经完成了——感谢您的阅读！</p><p id="8ed5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="nr">更多内容尽在</em><a class="ae ns" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="nr">plain English . io</em></strong></a></p></div></div>    
</body>
</html>