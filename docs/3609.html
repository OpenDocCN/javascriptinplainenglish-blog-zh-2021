<html>
<head>
<title>React useEffect Hook Tutorial for Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React useEffect Hook初学者教程</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-useeffect-hook-tutorial-for-beginners-30626402b739?source=collection_archive---------13-----------------------#2021-07-20">https://javascript.plainenglish.io/react-useeffect-hook-tutorial-for-beginners-30626402b739?source=collection_archive---------13-----------------------#2021-07-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bce9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">React useEffect初学者教程，提供真实示例和日常使用模式。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d7ac78eaaa7f5fead84922a539a237cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OGN_W4mTKqjRHUuf.jpg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">useEffect hook in react</figcaption></figure><p id="b6a4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本文中，您将学习如何在编码项目中轻松使用useEffect挂钩。您将了解useEffect参数，如何用useEffect钩子替换componentDidMount()生命周期，以及更多内容。我还添加了useEffect钩子的不同使用模式。</p><p id="181c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设您需要从数据库中获取一组数据，并使用它们来填充React应用程序。或者您需要更改页面标题或在页面加载时进行一些DOM操作。您可以使用useEffect挂钩来轻松实现这一点。</p><p id="c7be" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">或者想象一下，一旦有人点击导航栏中的“items”选项卡，就会显示一组项目。可以使用useEffect钩子调用要加载的初始项目集。</p><div class="lr ls gp gr lt lu"><a href="https://levelup.gitconnected.com/learn-react-usestate-hook-a09ccf955537" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd ir gy z fp lz fr fs ma fu fw ip bi translated">学习反应使用状态挂钩</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">有例子和练习</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="md l"><div class="me l mf mg mh md mi kp lu"/></div></div></a></div><p id="67e5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">React hooks引入了<code class="fe mj mk ml mm b">useEffect()</code>方法来替换类组件的生命周期。</p><h1 id="2826" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">使用效果参数</h1><p id="0aa6" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">useEffect挂钩将一个<strong class="kx ir">函数</strong>作为第一个参数，将一组<strong class="kx ir">依赖关系</strong>作为第二个参数。</p><pre class="kg kh ki kj gt nk mm nl nm aw nn bi"><span id="279f" class="no mo iq mm b gy np nq l nr ns">React.useEffect(function, [dependencies])</span></pre><p id="5207" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可能已经读到过效果钩子让你在功能组件中执行副作用。这是真的，所以…</p><h1 id="6180" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">有什么副作用？</h1><p id="4ef2" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">副作用基本上是组件当前执行范围之外的任何东西。它可能类似于调用API来填充页面。用户单击display products页面，后台发送一个API调用，将产品从数据库提取到组件中。</p><p id="d24e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">API调用、身份验证调用、错误跟踪调用或任何不直接在当前执行范围内的调用都可能是副作用。</p><p id="267e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你熟悉类组件内部使用的react生命周期，那么<code class="fe mj mk ml mm b">useEffect</code>钩子可以用作<code class="fe mj mk ml mm b">componentDidMount</code>、<code class="fe mj mk ml mm b">componentDidUpdate</code>和<code class="fe mj mk ml mm b">componentWillUnmount</code>生命周期。</p><p id="fabb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们从导入useEffect钩子开始</p><div class="lr ls gp gr lt lu"><a href="https://medium.com/geekculture/why-senior-developers-do-not-watch-facebook-clone-videos-and-crash-courses-like-us-9f50095e5d2b" rel="noopener follow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd ir gy z fp lz fr fs ma fu fw ip bi translated">为什么高级开发者不像我们一样看脸书克隆视频和速成班</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">你看得越多，学到的越少——这是一个严酷的事实</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">medium.com</p></div></div><div class="md l"><div class="nt l mf mg mh md mi kp lu"/></div></div></a></div><h1 id="e5df" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">导入效果挂钩</h1><p id="7f99" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">首先你需要导入如下效果挂钩。</p><pre class="kg kh ki kj gt nk mm nl nm aw nn bi"><span id="f6be" class="no mo iq mm b gy np nq l nr ns">import React, { useState, useEffect } from 'react';</span></pre><h2 id="916b" class="no mo iq bd mp nu nv dn mt nw nx dp mx le ny nz mz li oa ob nb lm oc od nd oe bi translated">代码示例</h2><pre class="kg kh ki kj gt nk mm nl nm aw nn bi"><span id="2e33" class="no mo iq mm b gy np nq l nr ns">import React, { useState, useEffect } from 'react';<br/>function Example() {<br/>  const [count, setCount] = useState(0);<br/> <br/><strong class="mm ir">useEffect(() =&gt; {    <br/>document.title = `You clicked ${count} times`;  <br/>});</strong><br/>  return (<br/>    &lt;div&gt;<br/>      &lt;p&gt;You clicked {count} times&lt;/p&gt;<br/>      &lt;button onClick={() =&gt; setCount(count + 1)}&gt;<br/>        Click me<br/>      &lt;/button&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="3540" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上面是一个非常基本的例子，只是为了理解useEffect功能。</p><p id="b063" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里发生的是react在初始呈现后更改文档标题。所以每次渲染后，<code class="fe mj mk ml mm b">useEffect</code>钩子都会运行并改变标题。</p><h1 id="afaf" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">React useEffect钩子什么时候被调用？</h1><p id="c103" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">假设一个人点击了react网页。</p><ul class=""><li id="0c3c" class="of og iq kx b ky kz lb lc le oh li oi lm oj lq ok ol om on bi translated">首先，React读取状态值并准备UI</li><li id="c395" class="of og iq kx b ky oo lb op le oq li or lm os lq ok ol om on bi translated">将JSX结果呈现为HTML格式。</li><li id="3125" class="of og iq kx b ky oo lb op le oq li or lm os lq ok ol om on bi translated">将结果传递并提交给DOM</li><li id="80da" class="of og iq kx b ky oo lb op le oq li or lm os lq ok ol om on bi translated">浏览器在屏幕上创建视图</li><li id="a5b6" class="of og iq kx b ky oo lb op le oq li or lm os lq ok ol om on bi translated">React调用<strong class="kx ir"> useEffect </strong>来运行</li></ul><h1 id="219d" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">useEffect在每个渲染上都运行吗？</h1><p id="6757" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">是的，默认行为是useEffect钩子在每次渲染时运行。但是我们可以改变。</p><p id="acde" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以修改useEffect，使其只在特定的更改上运行。例如，我们只能在更改特定值时调用useEffect。它将提高我们应用程序的性能(因为它减少了不必要的useEffect调用)。为此，我们可以将一个数组作为第二个参数传递给<code class="fe mj mk ml mm b">useEffect</code></p><p id="cf4e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在下面的代码中，我们将<code class="fe mj mk ml mm b">count</code>作为第二个值发送给了useEffect钩子。所以只有在count变量有更新时才会调用useEffect。</p><pre class="kg kh ki kj gt nk mm nl nm aw nn bi"><span id="ee4e" class="no mo iq mm b gy np nq l nr ns">useEffect(() =&gt; {<br/>  document.title = `You clicked ${count} times`;<br/>}, [count]); // Only re-run the effect if count changes</span></pre><p id="78ff" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果计数从1变到2，useEffect将在渲染后再次运行，否则useEffect将不会执行。</p><p id="6148" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们看看<code class="fe mj mk ml mm b">useEffect</code>钩子的更多用法。</p><h1 id="09c3" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">使用效果挂钩的不同模式/用例</h1><ul class=""><li id="e64a" class="of og iq kx b ky nf lb ng le ot li ou lm ov lq ok ol om on bi translated">在每个组件挂载上使用一次效果。</li><li id="1dc3" class="of og iq kx b ky oo lb op le oq li or lm os lq ok ol om on bi translated">在每个组件渲染上使用效果。</li><li id="fb04" class="of og iq kx b ky oo lb op le oq li or lm os lq ok ol om on bi translated">用一个条件在每个组件上渲染useEffect。</li><li id="88d2" class="of og iq kx b ky oo lb op le oq li or lm os lq ok ol om on bi translated">组件卸载时使用Effect。</li></ul><h1 id="522f" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">什么是安装、渲染、重新渲染</h1><p id="1d43" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">react第一次渲染组件时会发生挂载。挂载构建初始DOM</p><p id="98a7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">渲染是每次调用函数组件时都会发生的事情。它创建一组指令来创建DOM。</p><p id="b653" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">重新呈现是指React调用一个已经挂载的组件来获取一组新的指令来构建DOM。</p><h1 id="5c43" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">当安装组件时</h1><p id="e429" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">现在你知道组件安装是什么意思了。元件安装只发生一次。所以我们也可以让useEffect只运行一次。通过简单地将一个空数组作为第二个参数传递给useEffect钩子，我们可以让useEffect在安装组件时只运行一次。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ow ox l"/></div></figure><h1 id="c718" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">在每个组件渲染上</h1><p id="760f" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">如果你想在每一次渲染时触发useEffect，你可以不传递任何东西作为钩子的第二个参数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ow ox l"/></div></figure><h1 id="6fae" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">基于条件的组件渲染研究</h1><p id="84d6" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">您可以将依赖项集作为第二个参数传递给useEffect挂钩，以便有条件地运行它。如果我们传递一个变量名，useEffect只有在变量发生变化时才会触发。该变量可以是状态值或任何变量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ow ox l"/></div></figure><h1 id="752b" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">当组件卸载时</h1><p id="db84" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">react中有两种useEffect实现。需要清理的效果和不需要清理的效果。</p><h1 id="1dd4" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">清理？？</h1><p id="f57f" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">是的，清理就像用后关上水龙头一样。如果不是这样，那就是漏水了，没有用。在React中，这被称为内存泄漏。</p><p id="a84b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我想我们订阅了一个API来获取一些数据。使用完API后，我们应该取消订阅它。</p><p id="c2c8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我认为我们连接到了一个数据库，在访问和使用数据库之后，我们应该关闭数据库连接。这叫做清理。</p><p id="db67" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以我们也可以在使用效果钩子时做同样的清理。</p><p id="f1cc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">只需在useEffect钩子上添加一个return语句，我们就可以完成清理工作。这个返回函数在一个组件被卸载后被触发。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ow ox l"/></div></figure><h1 id="5960" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">最后</h1><p id="c5ca" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">我已经讨论了如何使用效果钩子的流行用例。如果你理解了基本概念，使用效果挂钩就没有问题了。大多数情况下，您将来可能面临的问题只是因为在效果挂钩内部实现了复杂的逻辑和功能。</p><div class="lr ls gp gr lt lu"><a rel="noopener  ugc nofollow" target="_blank" href="/beginners-guide-to-javascript-callbacks-d8195be73dc5"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd ir gy z fp lz fr fs ma fu fw ip bi translated">JavaScript回调初学者指南</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">通过真实的项目代码样本学习回调的A-Z。</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="md l"><div class="oy l mf mg mh md mi kp lu"/></div></div></a></div><p id="8eff" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="oz">更多内容看</em><a class="ae pa" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="oz">plain English . io</em></strong></a></p></div></div>    
</body>
</html>