<html>
<head>
<title>How to Event Stream from Your Gatsby Website Using Open Source RudderStack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用开源RudderStack从Gatsby网站获取事件流</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-event-stream-from-your-gatsby-website-using-open-source-rudderstack-ad667e252ec7?source=collection_archive---------20-----------------------#2021-06-22">https://javascript.plainenglish.io/how-to-event-stream-from-your-gatsby-website-using-open-source-rudderstack-ad667e252ec7?source=collection_archive---------20-----------------------#2021-06-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/17ee80aa43e1bb19eeedb3770fbca670.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5KUSLYKPD11Awdf17XtnPw.png"/></div></div></figure><p id="af7f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><a class="ae kt" href="https://rudderstack.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> RudderStack </strong> </a>是一个开源的<strong class="jx io">客户数据管道</strong>，允许您跟踪并发送来自web、移动和服务器端来源的实时事件到您的整个客户数据堆栈。我们的主存储库—<a class="ae kt" href="https://github.com/rudderlabs/rudder-server" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">rudder-server</strong></a>—在GitHub上是开源的。</p><p id="c0eb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">借助RudderStack的开源<a class="ae kt" href="https://github.com/rudderlabs/gatsby-plugin-rudderstack" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> Gatsby插件</strong> </a>，你可以轻松地将你的Gatsby站点与RudderStack整合，并从中实时跟踪和捕捉客户事件。</p><p id="50d0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要使用RudderStack在Gatsby网站上检测实时事件流，我们需要遵循以下四个步骤:</p><ol class=""><li id="af93" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks kz la lb lc bi translated">使用Gatsby插件在你的Gatsby网站上安装RudderStack</li><li id="f3f5" class="ku kv in jx b jy ld kc le kg lf kk lg ko lh ks kz la lb lc bi translated">(可选)为您的网站设置方向舵堆栈跟踪代码</li><li id="4f34" class="ku kv in jx b jy ld kc le kg lf kk lg ko lh ks kz la lb lc bi translated">在RudderStack中为您的Gatsby站点的事件数据创建一个工具/仓库目的地</li><li id="202f" class="ku kv in jx b jy ld kc le kg lf kk lg ko lh ks kz la lb lc bi translated">部署您的Gatsby站点并验证事件流</li></ol><h1 id="e812" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">先决条件</h1><p id="3849" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">这篇文章假设你已经安装并建立了你的Gatsby网站。如果你还没有这样做，我们建议按照<a class="ae kt" href="https://www.gatsbyjs.com/docs/tutorial/part-zero/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">盖茨比官方文档</strong> </a>开始。</p><h1 id="8591" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">第1步:使用Gatsby插件，用RudderStack装备您的Gatsby网站</h1><h1 id="01e7" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">在RudderStack中创建源</h1><p id="618f" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">在用RudderStack装备Gatsby站点之前，您需要在RudderStack仪表板中设置一个JavaScript源，它将跟踪和捕获来自您的网站的事件。为此，请按照下列步骤操作:</p><ul class=""><li id="9439" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">登录你的<a class="ae kt" href="https://app.rudderstack.com/" rel="noopener ugc nofollow" target="_blank">方向舵仪表盘</a>。如果您没有帐户，请注册。</li><li id="643b" class="ku kv in jx b jy ld kc le kg lf kk lg ko lh ks ml la lb lc bi translated">登录后，您应该会看到以下控制面板:</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mm"><img src="../Images/1357de6c377d6bf19fb02d3a62ebab9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mBGC_-NMMlwEdxtq.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">RudderStack Dashboard</strong></figcaption></figure><ul class=""><li id="61e5" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">注意<strong class="jx io">数据平面URL </strong>，这是用RudderStack检测Gatsby站点所需要的。</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/5eda4856cd225bd80427f7a4c8c120cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/0*-FZi7AWXBeJRj5rf.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Data Plane URL</strong></figcaption></figure><ul class=""><li id="a335" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">下一步是创建一个源。为此，点击<strong class="jx io">添加信号源</strong>按钮。也可以选择左侧导航栏上的<strong class="jx io">目录</strong>选项，选择<strong class="jx io">源</strong>下的<strong class="jx io">事件流</strong>。</li></ul><p id="b485" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">对于Gatsby插件，我们将设置一个简单的<strong class="jx io"> JavaScript </strong>源。</p><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/f5f834b76eb161c6d053e20c5c1e43b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*THSKh5aFk0CQvNug.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Adding a Source</strong></figcaption></figure><ul class=""><li id="37ef" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">给你的信号源命名，点击<strong class="jx io">下一个</strong>。</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/83b6ed99c7bc232a405fef715dbb927f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-9BfcuL4CiN7MqwT.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Name the Source</strong></figcaption></figure><ul class=""><li id="5701" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">您的事件源现已配置完毕。注意与该源相关的<strong class="jx io">写键</strong>。这也是配置RudderStack-Gatsby集成所必需的。</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi my"><img src="../Images/eba3daf107e9bb8e5d38388e540d85b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vNr1yRv5GLQPgxPA.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Note the Write Key</strong></figcaption></figure><h1 id="0196" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">用RudderStack装备您的Gatsby站点</h1><p id="92cc" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">为了用RudderStack装备您的Gatsby网站，我们将利用RudderStack的开源Gatsby插件。请遵循以下步骤:</p><ul class=""><li id="e7ca" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">导航到根目录，其中包含您站点的资产和资源。</li><li id="ecea" class="ku kv in jx b jy ld kc le kg lf kk lg ko lh ks ml la lb lc bi translated">根据您选择的软件包管理器，键入以下命令:</li></ul><p id="f1f2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">对于NPM </strong> : <code class="fe mz na nb nc b">$ npm install --save gatsby-plugin-rudderstack</code></p><p id="f3bd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">供纱</strong> : <code class="fe mz na nb nc b">$ yarn add gatsby-plugin-rudderstack</code></p><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nd"><img src="../Images/239e2b82881329b25ebf8e928244b57c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_6lu9hets01RCLCI.jpg"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">NPM Install</strong></figcaption></figure><ul class=""><li id="3120" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">要设置这个插件，您需要使用从上一节获得的源<strong class="jx io">写键</strong>和<strong class="jx io">数据平面URL </strong>来配置您的<strong class="jx io"> gatsby-config.js </strong>文件。</li><li id="3c31" class="ku kv in jx b jy ld kc le kg lf kk lg ko lh ks ml la lb lc bi translated">配置选项如下所示:</li></ul><p id="5c8d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe mz na nb nc b">plugins: [<br/>{<br/>resolve: `gatsby-plugin-rudderstack`,<br/>options: {<br/>prodKey: `RUDDERSTACK_PRODUCTION_WRITE_KEY`,<br/>devKey: `RUDDERSTACK_DEV_WRITE_KEY`,<br/>trackPage: false,<br/>trackPageDelay: 50,<br/>dataPlaneUrl: `https://override-rudderstack-endpoint`,<br/>controlPlaneUrl: `https://override-control-plane-url`,<br/>delayLoad: false,<br/>delayLoadTime: 1000,<br/>manualLoad: false,<br/>}<br/>}<br/>];</code></p><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ne"><img src="../Images/133054631d24a5867412cae710305a98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hw0IYBvPzE7Qf7Q9.jpg"/></div></div></figure><p id="86f7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">有关上述每个参数的详细信息，请查看我们的<a class="ae kt" href="https://docs.rudderstack.com/how-to-guides/how-to-integrate-rudderstack-with-a-gatsby-website#the-configuration-options" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">文档</strong> </a>。</p><h1 id="b7da" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">重要注意事项</h1><ul class=""><li id="1bb1" class="ku kv in jx b jy mg kc mh kg nf kk ng ko nh ks ml la lb lc bi translated">如果您使用的是生产环境，则将源写入键分配给<code class="fe mz na nb nc b">prodKey</code>参数。否则，将其分配给<code class="fe mz na nb nc b">devKey</code>参数。</li><li id="5bfa" class="ku kv in jx b jy ld kc le kg lf kk lg ko lh ks ml la lb lc bi translated">如果您使用自托管控制平面来管理您的事件流配置，请输入<code class="fe mz na nb nc b">controlPlaneUrl</code>的URL。在这篇文章中，我们使用了RudderStack托管的免费控制平面，不需要任何设置。它还拥有比开源控制平面更多的功能，例如<strong class="jx io">实时事件</strong>——允许您查看从事件源捕获的实时事件。</li></ul><h1 id="988b" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">(可选)步骤2:为您的网站设置方向舵堆栈跟踪代码</h1><p id="9610" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated"><strong class="jx io">注</strong>:本节描述如何使用下面的JavaScript代码片段手动跟踪页面浏览量。这样做的先决条件是您已经在您的<strong class="jx io"> gatsby-config.js </strong>文件中将<code class="fe mz na nb nc b">trackPage</code>设置为<code class="fe mz na nb nc b">false</code>。(上一节中的步骤4，<strong class="jx io">用ruder stack</strong>检测您的Gatsby站点)。</p><p id="d2a5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你想自动跟踪浏览量，在你的<strong class="jx io"> gatsby-config.js </strong>文件中设置<code class="fe mz na nb nc b">trackPage</code>为<code class="fe mz na nb nc b">true</code>。关于自动跟踪页面浏览量的更多细节，请参考我们的<a class="ae kt" href="https://docs.rudderstack.com/how-to-guides/how-to-integrate-rudderstack-with-a-gatsby-website#tracking-pageviews" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">文档</strong> </a>。</p><p id="e5b4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，我们将为RudderStack设置代码来跟踪Gatsby站点的页面浏览量。这意味着RudderStack将在用户每次访问/查看您网站上的页面时捕获每个页面查看活动。</p><p id="a59e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为此，请按照下列步骤操作:</p><ul class=""><li id="5875" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">转到您的本地站点存储库并导航到<strong class="jx io">node _ modules</strong>—<strong class="jx io">Gatsby-plugin-rudder stack</strong>文件夹。</li><li id="2998" class="ku kv in jx b jy ld kc le kg lf kk lg ko lh ks ml la lb lc bi translated">找到并打开<strong class="jx io"> gatsby-browser.js </strong>文件。</li><li id="c11a" class="ku kv in jx b jy ld kc le kg lf kk lg ko lh ks ml la lb lc bi translated">将以下代码添加到该文件的末尾:</li></ul><p id="51be" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe mz na nb nc b">// gatsby-browser.js<br/>exports.onRouteUpdate = () =&gt; {<br/>window.rudderanalytics &amp;&amp; window.rudderanalytics.page();<br/>};</code></p><ul class=""><li id="bd04" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">保存文件。</li></ul><h1 id="013a" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">步骤3:在RudderStack中为您的Gatsby站点的事件数据创建一个工具目的地</h1><p id="c69a" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">RudderStack支持80多种工具，您可以将事件数据可靠地发送到这些工具。对于本教程，我们将在RudderStack中配置一个<strong class="jx io"> Google Analytics </strong>目的地。要在RudderStack中配置此目的地，请执行以下步骤:</p><ul class=""><li id="a2f4" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">选择仪表板左侧导航栏中的<strong class="jx io">目的地</strong>选项，并点击<strong class="jx io">添加目的地</strong>按钮。由于您已经配置了信号源，您也可以点击<strong class="jx io">添加目的地</strong>按钮，如下所示:</li></ul><p id="e7c7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意</strong>:如果您之前已经在RudderStack中配置了一个目的地，并且想要将您的事件数据发送到那个平台，使用<strong class="jx io">连接目的地</strong>选项连接到您的源。</p><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ni"><img src="../Images/2deb7e990c0b4644845374a660d0a38e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OWjP8EkTOeBehy-j.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Add a Destination</strong></figcaption></figure><ul class=""><li id="5cc4" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">从目的地列表中选择<strong class="jx io">谷歌分析</strong>。</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ni"><img src="../Images/a3da3483f1829e40c743d483bc53c429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*95KmnKaYoDE2a0_L.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Select Google Analytics</strong></figcaption></figure><ul class=""><li id="b290" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">为您的目的地指定一个名称，然后点击下一个的<strong class="jx io">。</strong></li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nj"><img src="../Images/f82b3a8d858bb426dacab150465549e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2bbl09sxEiw7QxG5.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Name your Destination</strong></figcaption></figure><ul class=""><li id="b39f" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">选择来源。我们将选择已经为本教程配置的<strong class="jx io"> JavaScript </strong>源。</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nj"><img src="../Images/f21c06b0a8f0b8fdff87309230219924.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Dns8Gp8hLapwkIfm.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Choose the Source</strong></figcaption></figure><ul class=""><li id="746f" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">添加相关的<strong class="jx io">连接设置</strong>。最重要的是，你需要输入谷歌分析<strong class="jx io">跟踪ID </strong>。您也可以如下图所示配置其他可选设置，然后点击<strong class="jx io">下一步</strong>。</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/eb1f53d57cbf7a4b4609aa91cb98dad3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1f5mKbXEcWABCaLB.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Add the Connection Settings</strong></figcaption></figure><ul class=""><li id="ee36" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">RudderStack为您提供了在将事件发送到目的地之前转换事件的选项。在我们的<a class="ae kt" href="https://docs.rudderstack.com/adding-a-new-user-transformation-in-rudderstack" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">文档</strong> </a>中获取更多关于RudderStack的用户转换特性的信息。</li><li id="7e98" class="ku kv in jx b jy ld kc le kg lf kk lg ko lh ks ml la lb lc bi translated">您的目的地现已配置完毕。现在，您应该会在仪表板中看到以下源-目标连接:</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/1e55044781e211a63a56f8c7b3474d0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fXbHxiGyESFfDNar.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Source-Destination Connection</strong></figcaption></figure><h1 id="48ca" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">(可选)步骤3:在RudderStack中为您的Gatsby站点的事件数据创建一个仓库目的地</h1><p id="3fac" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated"><strong class="jx io">重要提示</strong>:在将数据仓库配置为RudderStack目的地之前，您需要在您的仓库中建立一个新项目。此外，您将需要创建一个具有相关权限的新RudderStack用户角色。按照我们的<a class="ae kt" href="https://docs.rudderstack.com/data-warehouse-integrations" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">文档</strong> </a>获取关于如何为您选择的数据仓库执行此操作的详细、逐步说明。</p><p id="9f10" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本教程中，我们将设置一个Google BigQuery仓库目的地，以路由来自Gatsby网站的所有事件。如上所述，按照<a class="ae kt" href="https://docs.rudderstack.com/data-warehouse-integrations/google-bigquery" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">我们的文档</strong> </a>建立一个具有服务账户所需权限的BigQuery项目。</p><p id="82f1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一旦设置了项目和所需的用户权限，请按照下列步骤操作:</p><ul class=""><li id="c2e5" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">从目的地列表中选择<strong class="jx io"> Google BigQuery </strong>，如图所示:</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/1eb275253587392cac760b4d9da1b73a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AUu4LYgmFoRh_YzC.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Select BigQuery</strong></figcaption></figure><ul class=""><li id="fa97" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">为此目的地指定一个名称，并点击下一个的<strong class="jx io">。</strong></li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/add2a92bc374d86c49a8b9a2d7ec8fba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dCggBmK-1ZJI5u87.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Name the Destination</strong></figcaption></figure><ul class=""><li id="4897" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">选择要发送事件的来源。我们将为这个目的地选择与我们的Gatsby网站相关联的<strong class="jx io"> JavaScript </strong>源。</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/f7dc5ebd5def448d55c3e69b0d74688d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dGc1o1sBJ_UDZE1r.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Select JavaScript as the Source</strong></figcaption></figure><ul class=""><li id="9aad" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">指定<strong class="jx io">连接凭证</strong>。输入<strong class="jx io"> BigQuery项目ID </strong>和<strong class="jx io">暂存桶名称</strong>。按照这些<a class="ae kt" href="https://docs.rudderstack.com/data-warehouse-integrations/google-bigquery#setting-up-google-bigquery" rel="noopener ugc nofollow" target="_blank">说明</a>获取这些信息。</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div class="gh gi no"><img src="../Images/26abc750ea91c6633df526dc826cbae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/0*aQOE81hD_kI3EG_Y.png"/></div></figure><p id="c672" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">指定连接设置</strong></p><ul class=""><li id="f34e" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">复制私有JSON文件的内容。在我们的<a class="ae kt" href="https://docs.rudderstack.com/data-warehouse-integrations/google-bigquery#setting-up-the-service-account-for-rudderstack" rel="noopener ugc nofollow" target="_blank">文档</a>中有更多关于如何做的信息。</li></ul><p id="f78a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">就是这样！您已经成功地在RudderStack中将BigQuery设置为仓库目的地。</p><h1 id="ac9f" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">步骤4:部署您的Gatsby站点并验证事件流</h1><p id="151f" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">为了验证一切是否正常，让我们最后部署我们的网站并测试事件是否被传递到目的地。在这篇文章中，我们将测试Google Analytics目的地的事件流，这是我们在<strong class="jx io">步骤3(在RudderStack中插入工具目的地)</strong>中设置的。</p><p id="a5b9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">请遵循以下步骤:</p><ul class=""><li id="a48e" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">导航到本地站点的文件夹，如下所示:</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/757290671afd20fef11d556dbd828dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XqgCOEcZCByiLt13.jpg"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Local Site Folder</strong></figcaption></figure><ul class=""><li id="bb7b" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">如果您正在使用生产环境，运行命令<code class="fe mz na nb nc b">gatsby build</code>。如果您正在使用开发环境，运行命令<code class="fe mz na nb nc b">gatsby develop</code>。</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/08445c493713972eda2f18010cac5909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hn-xJPSFNyvnDvGm.jpg"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Gatsby Build</strong></figcaption></figure><ul class=""><li id="0927" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">因为我们使用的是生产环境，所以让我们使用<code class="fe mz na nb nc b">gatsby serve</code>来部署我们的站点。将提供一个本地主机URL，然后我们可以使用它来访问我们的站点:</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/0b192f1da6057a6bc202f6f9993dfc18.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/0*UNWfflgpGUWw_zd0.jpg"/></div></figure><ul class=""><li id="bc60" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">通过点击不同的帖子或页面浏览你的网站。</li><li id="60a9" class="ku kv in jx b jy ld kc le kg lf kk lg ko lh ks ml la lb lc bi translated">查看RudderStack是否可以通过访问源仪表板页面上的<strong class="jx io">实时事件</strong>部分来跟踪不同的页面浏览量:</li></ul><blockquote class="ns nt nu"><p id="a604" class="jv jw nv jx b jy jz ka kb kc kd ke kf nw kh ki kj nx kl km kn ny kp kq kr ks ig bi translated"><strong class="jx io"> <em class="in">注意:</em> </strong> <em class="in">在部署您的生产站点之后，在事件开始发送之前可能会有一个延迟。别担心。捕获并发送所有事件；请注意，在生产部署完成后，它们可能需要几分钟才能显示在实时事件查看器和您的下游目的地中。</em></p></blockquote><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nz"><img src="../Images/8b5f8a2dc575d755082e1e8c64d2a880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vHg5RqPS786SZ2Jr.jpg"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Gatsby Serve</strong></figcaption></figure><ul class=""><li id="4360" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">RudderStack可以成功跟踪并捕获页面视图事件，如下图所示:</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oa"><img src="../Images/c8385894c17bc7b0b41d4c6a0db17eec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*I7HgO69DaXWu5Gx0.jpg"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Pageview Events</strong></figcaption></figure><ul class=""><li id="e3ea" class="ku kv in jx b jy jz kc kd kg kw kk kx ko ky ks ml la lb lc bi translated">现在，让我们通过转到您的Google Analytics仪表板并导航到<strong class="jx io">实时</strong> — <strong class="jx io">事件</strong>来检查事件是否也被发送到Google Analytics。</li></ul><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ob"><img src="../Images/efee8e9e171fbeb2943f344be7f1cc89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fE1_dddrXAELA_YJ.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><strong class="bd mv">Google Analytics Dashboard</strong></figcaption></figure><p id="ebb6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们在Gatsby网站上看到一个活跃用户，这意味着页面视图事件被成功发送。类似地，您也应该能够看到在您的Google BigQuery仓库中接收到的事件。</p><h1 id="4ca6" class="li lj in bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">免费注册并开始发送数据</h1><p id="a217" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">测试我们的事件流、ELT和反向ETL管道。使用我们的HTTP源在不到5分钟的时间内发送数据，或者在您的网站或应用程序中安装我们12个SDK中的一个。<a class="ae kt" href="https://app.rudderlabs.com/signup?type=freetrial" rel="noopener ugc nofollow" target="_blank">T20】入门T22】。</a></p><p id="6122" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这篇博客最初发表于<br/><a class="ae kt" href="https://rudderstack.com/guides/how-to-event-stream-from-your-gatsby-website-using-open-source-rudderstack" rel="noopener ugc nofollow" target="_blank">https://rudder stack . com/guides/how-to-event-stream-from-your-Gatsby-website-using-open-source-rudder stack</a></p><p id="e69c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="nv">更多内容尽在</em><a class="ae kt" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="nv">plain English . io</em></strong></a></p></div></div>    
</body>
</html>