<html>
<head>
<title>How to Get Image Data as a Base64 URL in JavaScript?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在JavaScript中获取Base64 URL形式的图像数据？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-get-image-data-as-a-base64-url-in-javascript-223a0f2dc514?source=collection_archive---------9-----------------------#2021-07-07">https://javascript.plainenglish.io/how-to-get-image-data-as-a-base64-url-in-javascript-223a0f2dc514?source=collection_archive---------9-----------------------#2021-07-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1a781974e7b8ce9e198d926a66c945df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sQtyPoguDWzk0ATN"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@honeypoppet?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sandie Clarke</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c7cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有时，我们可能希望在web应用程序中获得base64 URL格式的图像数据。</p><p id="339a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何在JavaScript中获取base64 URL形式的图像数据。</p><h1 id="12b4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将图像放入上下文中，并将画布数据转换为Base64</h1><p id="35eb" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">将图像文件转换为base64字符串的一种方法是将其放入画布。</p><p id="3360" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以调用canvas的<code class="fe me mf mg mh b">toDataURL</code>方法将其转换成base64字符串。</p><p id="713d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5973" class="mq lc iq mh b gy mr ms l mt mu">const getBase64Image = (url) =&gt; {<br/>  const img = new Image();<br/>  img.setAttribute('crossOrigin', 'anonymous');<br/>  img.onload = () =&gt; {<br/>    const canvas = document.createElement("canvas");<br/>    canvas.width = img.width;<br/>    canvas.height = img.height;<br/>    const ctx = canvas.getContext("2d");<br/>    ctx.drawImage(img, 0, 0);<br/>    const dataURL = canvas.toDataURL("image/png");<br/>    console.log(dataURL)<br/>  }<br/>  img.src = url<br/>}</span><span id="c83b" class="mq lc iq mh b gy mv ms l mt mu">getBase64Image('https://uploads.sitepoint.com/wp-content/uploads/2015/12/1450377118cors3.png')</span></pre><p id="3fd5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了<code class="fe me mf mg mh b">getBase64Image</code>函数，它将<code class="fe me mf mg mh b">url</code>字符串作为图像的URL。</p><p id="79c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe me mf mg mh b">Image</code>构造函数创建一个<code class="fe me mf mg mh b">img</code>ek element。</p><p id="6485" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们调用<code class="fe me mf mg mh b">seAttribute</code>来将<code class="fe me mf mg mh b">crossOrigin</code>属性设置为<code class="fe me mf mg mh b">anonymous</code>，这样我们就可以得到与我们所拥有的域不同的图像。</p><p id="1b15" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们创建用<code class="fe me mf mg mh b">document.createElement</code>创建画布元素的<code class="fe me mf mg mh b">img.onload</code>方法。</p><p id="114c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将画布的宽度和高度设置为<code class="fe me mf mg mh b">img</code>元素的宽度和高度。</p><p id="298e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们用<code class="fe me mf mg mh b">getContext</code>获得画布上下文。</p><p id="fc4b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe me mf mg mh b">drawImage</code>在画布上绘制图像。</p><p id="53d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个和第三个参数是左上角的x和y坐标。</p><p id="b0e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们用我们想要成像的MIME类型调用<code class="fe me mf mg mh b">toDataURL</code>,将它转换成图像的base64字符串版本。</p><p id="3f7c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后<code class="fe me mf mg mh b">console.log</code>应该记录base64 URL。</p><p id="6556" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将<code class="fe me mf mg mh b">img.src</code>设置为<code class="fe me mf mg mh b">url</code>来触发<code class="fe me mf mg mh b">onload</code>方法运行。</p><p id="d913" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，当我们用一个图像URL运行<code class="fe me mf mg mh b">getBase64Image</code>时，我们将看到它的base64字符串版本被记录。</p><h1 id="7175" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="2882" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过将带有给定URL的图像加载到画布中，然后调用<code class="fe me mf mg mh b">toDataURL</code>将其转换为base64 URL。</p><p id="6b26" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mw">更多内容请看</em><a class="ae kc" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mw">plain English . io</em></strong></a></p></div></div>    
</body>
</html>