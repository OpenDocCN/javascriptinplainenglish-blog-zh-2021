<html>
<head>
<title>Never get stuck again with object updates (RxJS Patterns)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">永远不要再被对象更新(RxJS模式)所困扰</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/never-get-stuck-again-with-object-updates-rxjs-e8806b0a1a96?source=collection_archive---------1-----------------------#2021-12-08">https://javascript.plainenglish.io/never-get-stuck-again-with-object-updates-rxjs-e8806b0a1a96?source=collection_archive---------1-----------------------#2021-12-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/0d3ad2924eefe4f489ae492fc9d9f422.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ucz8bRcywvpVEv4N5ZIRCg.png"/></div></div></figure><h2 id="5750" class="iw ix iy bd b dl iz ja jb jc jd je dk jf translated" aria-label="kicker paragraph">使用RxJS发现更好的代码模式</h2><div class=""/><p id="89a7" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">你好。能不能看看下面的代码，真实的回答一下？</p><ul class=""><li id="3b01" class="lc ld iy kg b kh ki kl km kp le kt lf kx lg lb lh li lj lk bi translated">下面的代码和你的相似吗？</li><li id="8f5a" class="lc ld iy kg b kh ll kl lm kp ln kt lo kx lp lb lh li lj lk bi translated">你仍然以这种方式更新对象吗？</li><li id="21ec" class="lc ld iy kg b kh ll kl lm kp ln kt lo kx lp lb lh li lj lk bi translated">你有没有想过有没有更好的方法可以做到这一点？</li></ul><p id="6e64" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">如果你的答案是肯定的，那么你来对地方了！本文将发现一种更好的模式用于对象更新。</p><figure class="lr ls lt lu gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/076b1c3634759f137193bac3ad53178b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tc3gLZu2OCiLmm96X1jPiw.png"/></div></div></figure></div><div class="ab cl lv lw hr lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ig ih ii ij ik"><h1 id="0e20" class="mc md iy bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">你想跟着去吗？</h1><p id="9593" class="pw-post-body-paragraph ke kf iy kg b kh na kj kk kl nb kn ko kp nc kr ks kt nd kv kw kx ne kz la lb ig bi translated">最终版本可以在<a class="ae nf" href="https://github.com/obaranovskyi/update-pattern-rxjs" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。移除<code class="fe ng nh ni nj b">src/index.ts</code>中的所有东西，你就可以开始了。</p><p id="c7d5" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">否则，您可能要从头开始建立一个新的TypeScript项目。</p></div><div class="ab cl lv lw hr lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ig ih ii ij ik"><h1 id="dc90" class="mc md iy bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">#我们要解决什么难题？</h1><ol class=""><li id="b6b3" class="lc ld iy kg b kh na kl nb kp nk kt nl kx nm lb nn li lj lk bi translated">通常，我们不想同时更新所有字段。</li><li id="ba5b" class="lc ld iy kg b kh ll kl lm kp ln kt lo kx lp lb nn li lj lk bi translated">只有一些属性必须设置为默认值。</li><li id="9a02" class="lc ld iy kg b kh ll kl lm kp ln kt lo kx lp lb nn li lj lk bi translated">每当我们想要修改一个特定的部分时，传递整个对象是没有必要的。</li><li id="f259" class="lc ld iy kg b kh ll kl lm kp ln kt lo kx lp lb nn li lj lk bi translated">我们想去掉一个额外的对象引用，它的任务是从表单中收集数据。最好一劳永逸。我们的使命是SRP(单一责任原则)。</li></ol></div><div class="ab cl lv lw hr lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ig ih ii ij ik"><h1 id="62c0" class="mc md iy bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">#那么解决方案是什么？</h1><p id="f09e" class="pw-post-body-paragraph ke kf iy kg b kh na kj kk kl nb kn ko kp nc kr ks kt nd kv kw kx ne kz la lb ig bi translated">解决方案是结合使用<code class="fe ng nh ni nj b">scan</code>操作符和<code class="fe ng nh ni nj b">Partial</code>实用程序类型。请看看下面的代码。它解决了什么是需要的。此外，没有任何复杂性就没有什么非凡之处。</p><figure class="lr ls lt lu gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/2a3963f8170147a35a15182ffe30d180.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EGwiEg2khk1f55HswM-1Lg.png"/></div></div></figure><p id="e258" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">基本上，<code class="fe ng nh ni nj b">scan</code>操作符可以用来管理状态。在建立初始值之后，它将累加器应用于来自源的每个值。您可以在<a class="ae nf" href="https://rxjs.dev/api/operators/scan" rel="noopener ugc nofollow" target="_blank">文档</a>中找到更多信息。</p><p id="7647" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">当我们有一个带有必填字段的接口或类型时，一个<code class="fe ng nh ni nj b">Partial</code>内置类型可以帮助我们从已经存在的部分实现中创建一个新的类型。</p><p id="297a" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">如果您想进一步熟悉实用程序类型，请访问下面的这篇文章。</p><div class="im in gp gr io no"><a href="https://obaranovskyi.medium.com/typescript-understand-built-in-utility-types-5aa9ea44fe45" rel="noopener follow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd ji gy z fp nt fr fs nu fu fw jh bi translated">TypeScript:了解内置/实用程序类型</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">如今打字稿变得越来越受欢迎。许多人出于不同的目的使用它，而不仅仅是为了…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">obaranovskyi.medium.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc iu no"/></div></div></a></div><p id="d29f" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">现在让我们将我们的解决方案应用到现有的代码中。</p><figure class="lr ls lt lu gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/9dbbad85cf5f2301d2dae25c6f5e2967.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2N8i-h3LDtVtD7MRDsfc3w.png"/></div></div></figure><p id="85b8" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">好吧，看来我们成功了。到目前为止，我们可以将部分对象传递到<code class="fe ng nh ni nj b">BehaviorSubject</code>，因此只有必要的属性才会有预定义的值。因为我们不需要传递整个对象来只更新修改过的属性，所以不需要额外的对象引用。</p></div><div class="ab cl lv lw hr lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ig ih ii ij ik"><h1 id="0fd6" class="mc md iy bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">#让它变得可重复使用</h1><p id="623e" class="pw-post-body-paragraph ke kf iy kg b kh na kj kk kl nb kn ko kp nc kr ks kt nd kv kw kx ne kz la lb ig bi translated">为了使它可重用，我们需要提取我们的<code class="fe ng nh ni nj b">scan</code>操作符，以便我们能够在其他地方使用它。</p><p id="87f9" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">这里有一个关于这种策略的小案例:</p><figure class="lr ls lt lu gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/4ff5af37e697fcf7434196e60f90b77a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CAeldo0Bsda9Eoj_xn2Bxg.png"/></div></div></figure></div><div class="ab cl lv lw hr lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ig ih ii ij ik"><h1 id="2819" class="mc md iy bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">#让我们添加验证</h1><p id="6c6b" class="pw-post-body-paragraph ke kf iy kg b kh na kj kk kl nb kn ko kp nc kr ks kt nd kv kw kx ne kz la lb ig bi translated">最有可能的是，您会将这种策略与表单一起使用。这意味着您将有一个提交按钮。因此，这自然会引导我们进行表单验证。让我们添加一个，看看它是如何工作的:</p><figure class="lr ls lt lu gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/6af065b558c1c68a26accc5683ccaec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ph2pJrPIH032sY55J7V9pA.png"/></div></div></figure><p id="9157" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">现在，我们一切就绪。您可能做的唯一更新是将<code class="fe ng nh ni nj b">Partial&lt;Car&gt;</code>提取到一个新的类型中，如下所示:</p><figure class="lr ls lt lu gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/55ab296eacd43b9b8cb0ac366403aa32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GGwa0uCOAiSRmllL27CEDg.png"/></div></div></figure><p id="b15e" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">差不多就是这样。</p></div><div class="ab cl lv lw hr lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ig ih ii ij ik"><h1 id="70a2" class="mc md iy bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">#进一步阅读</h1><p id="b944" class="pw-post-body-paragraph ke kf iy kg b kh na kj kk kl nb kn ko kp nc kr ks kt nd kv kw kx ne kz la lb ig bi translated">如果你对RxJS感兴趣，这里有更多可能让你着迷的文章:</p><div class="im in gp gr io no"><a href="https://obaranovskyi.medium.com/rxjs-data-reload-pattern-with-custom-operators-factory-functions-b929a2103dd8" rel="noopener follow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd ji gy z fp nt fr fs nu fu fw jh bi translated">这是使用RxJS重新加载数据的最简单的方法</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">大多数时候，我们必须从服务器加载数据。为了执行操作，客户端通常会发送请求以及…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">obaranovskyi.medium.com</p></div></div><div class="nx l"><div class="od l nz oa ob nx oc iu no"/></div></div></a></div><div class="im in gp gr io no"><a href="https://obaranovskyi.medium.com/micro-frontends-cross-application-communication-with-single-spa-and-rxjs-aa55084bf344" rel="noopener follow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd ji gy z fp nt fr fs nu fu fw jh bi translated">微前端:与单Spa和RxJS的跨应用程序通信</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">在上一篇文章“用单Spa框架连接微前端”中。一步一步引导。”，我们是…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">obaranovskyi.medium.com</p></div></div><div class="nx l"><div class="oe l nz oa ob nx oc iu no"/></div></div></a></div></div><div class="ab cl lv lw hr lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ig ih ii ij ik"><h1 id="07a8" class="mc md iy bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">#结论</h1><p id="c7e9" class="pw-post-body-paragraph ke kf iy kg b kh na kj kk kl nb kn ko kp nc kr ks kt nd kv kw kx ne kz la lb ig bi translated">有趣的事实是——你知道吗，你可以按下“拍手”按钮，而不是多次点击。我相信你知道👻👻👻</p><figure class="lr ls lt lu gt ip gh gi paragraph-image"><div class="gh gi of"><img src="../Images/e9860e90cb352e6105b7491015a150fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*2KdFe4XPS_En1yrfZZh6Cg.gif"/></div></figure><p id="b869" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">我希望你和我一样喜欢它。如果你喜欢这篇文章，或者你学到了新的东西，请点赞并订阅。</p><p id="27c7" class="pw-post-body-paragraph ke kf iy kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated"><em class="lq">更多内容看</em> <strong class="kg ji"> <em class="lq"> </em> </strong> <a class="ae nf" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kg ji"> <em class="lq">说白了. io </em> </strong> </a> <strong class="kg ji"> <em class="lq">。</em> </strong> <em class="lq">报名参加我们的</em><strong class="kg ji"><em class="lq"/></strong><a class="ae nf" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kg ji"><em class="lq">免费每周简讯点击这里</em> </strong> </a> <strong class="kg ji"> <em class="lq">。</em> </strong></p></div></div>    
</body>
</html>