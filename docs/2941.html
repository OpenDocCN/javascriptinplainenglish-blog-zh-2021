<html>
<head>
<title>How to Query GraphQL Endpoint with Vanilla JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用普通JavaScript查询GraphQL端点</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-query-graphql-endpoint-with-vanilla-javascript-e2ebdb266b98?source=collection_archive---------5-----------------------#2021-06-15">https://javascript.plainenglish.io/how-to-query-graphql-endpoint-with-vanilla-javascript-e2ebdb266b98?source=collection_archive---------5-----------------------#2021-06-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/43278b5ed2f3dc726eb81014e40dfb78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q4OCbLGw2W7BWJe39XKqTg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Image</figcaption></figure><p id="cb4c" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><a class="ae kx" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> GraphQL </a>是一种用于读取和改变API中数据的查询语言。它为后端开发人员提供了一个描述数据模式的系统。它为API的消费者提供了探索他们需要的确切数据的灵活性。</p><p id="056e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">使用GraphQL构建解决了提取过量/不足的问题，并限制了传统REST APIs带来的数据传输成本。JavaScript、C#、Go、PHP、Java等编程语言提供了库和工具来帮助开发人员开始使用Graphql。</p><p id="ffc7" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们将使用React开发我们的前端应用程序。(<em class="ky">注意:您可以在其他前端库/框架上使用相同的方法。</em>)。对于GraphQL端点，我们将使用<a class="ae kx" href="https://api.github.com/graphql" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> GitHub GraphQL API </strong> </a>来获取用户的详细信息和存储库。</p><p id="d66d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在本教程中，我们将学习如何只用普通的JavaScript查询GraphQL端点。</p><h1 id="99fb" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">沙箱</h1><p id="bfe8" class="pw-post-body-paragraph jz ka in kb b kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks mb ku kv kw ig bi translated">我们在一个<a class="ae kx" href="https://codesandbox.io/s/reactgraphql-tcnxe?file=/src/App.js:2094-2705" rel="noopener ugc nofollow" target="_blank"> Codesandbox </a>中完成了这个项目，你可以派生它来运行代码。</p><h1 id="d652" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">先决条件</h1><ul class=""><li id="bf97" class="mc md in kb b kc lx kg ly kk me ko mf ks mg kw mh mi mj mk bi translated">JavaScript和React.js的基础知识。</li><li id="9f2c" class="mc md in kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated">GraphQL不是必需的，但是拥有它很好。</li><li id="74f9" class="mc md in kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated">GitHub账户。我们需要一个帐户来为我们的应用程序生成个人访问令牌，并使用GitHub GraphQL explorer。</li></ul><h1 id="7837" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">生成GitHub个人访问令牌。</strong></h1><p id="7024" class="pw-post-body-paragraph jz ka in kb b kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks mb ku kv kw ig bi translated">首先，我们需要生成一个个人访问令牌。当使用GitHub API或命令行时，个人访问令牌是使用密码对Github进行身份验证的替代方法。</p><p id="35fd" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">要获取我们的个人访问令牌，<a class="ae kx" href="https://github.com/login" rel="noopener ugc nofollow" target="_blank">登录您的GitHub帐户</a>，导航至<strong class="kb io">设置</strong>页面</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/1a2d967a086cbcd7fcebc5aafd2ba9c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*pDyETC6jhr45lEf6iQIuDw.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">click on settings</figcaption></figure><p id="2718" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在左侧工具条中，点击<strong class="kb io">开发者设置</strong></p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/a0d340246d23b77b106d83c36c2557c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*orIb9AfHXvZGN0-JW7w-QQ.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">click developer settings</figcaption></figure><p id="f088" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在左侧工具条中，点击<strong class="kb io">个人访问令牌</strong></p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/83e3607a82bec9995102b2d5de39f3f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*QY1UwGvQbd6xATj59G0i_w.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">click personal access token</figcaption></figure><p id="99de" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">点击<strong class="kb io">生成新令牌</strong></p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/ad060d85774c35dc5d098e5ee96d2c1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D2PaM27-rwlSdxEja_wmBw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">click generate new token</figcaption></figure><p id="b5c4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">给你的令牌命名，勾选<strong class="kb io">回购</strong>和<strong class="kb io">用户</strong>复选框。然后点击<strong class="kb io">生成令牌</strong>按钮。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/e73a602184c446ce916ed58a0a50f389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A89M3EHOq6FgznRT5l0icw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">name and check</figcaption></figure><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi my"><img src="../Images/ddd5379b977f32e592c0ebcb4b9d4665.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8dCPfrxwvvhNyfgZ8HPGDg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">generate token</figcaption></figure><p id="7143" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们需要将我们的访问令牌复制并粘贴到一个安全的地方。出于安全原因，如果我们离开页面，GitHub不会再次显示令牌。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mz"><img src="../Images/c75a03e0b6306b56f0662ce30acca5a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p1ovlXArTFmuoCS_Z5dvFw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">click on the circle icon to copy token.</figcaption></figure><h1 id="f3ca" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">用普通JavaScript查询GraphQL端点</h1><p id="65c2" class="pw-post-body-paragraph jz ka in kb b kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks mb ku kv kw ig bi translated">现在我们有了个人访问令牌。我们可以构建我们的查询并修改<code class="fe na nb nc nd b">App.js</code>来查询GitHub API并显示结果。</p><p id="866b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">第一步</strong> <br/>首先，在浏览器上进入<a class="ae kx" href="https://docs.github.com/en/graphql/overview/explorer" rel="noopener ugc nofollow" target="_blank">https://docs.github.com/en/graphql/overview/explorer</a>，点击<strong class="kb io">用GitHub </strong>按钮登录。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ne"><img src="../Images/fc93c2942d0e2b77ca73afa08e626a8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OYhOi-_r77v8C0yLLOGG-A.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Graphiql interface</figcaption></figure><p id="cdf3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">上一页的图形界面叫做<a class="ae kx" href="https://github.com/graphql/graphiql" rel="noopener ugc nofollow" target="_blank"> GraphiQL </a>。GraphQL是一个基于浏览器的集成开发环境，可以帮助我们轻松构建graph QL查询。</p><p id="070f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">接下来，用下面的代码片段替换GraphiQL中的查询。这个代码片段接受一个GitHub用户名作为参数，获取最近20个存储库、主要语言和用户的基本信息。</p><figure class="mr ms mt mu gt jo"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">sample query.</figcaption></figure><p id="60bb" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">单击播放图标查看我们的查询结果。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nh"><img src="../Images/28cffc0e9fe1b0c566cd1a7e06435da1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9aQ3Za0x8dAY9poCorVgSw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">play</figcaption></figure><p id="bf6e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">GraphiQL还支持使用explorer选项卡构建查询。点击<strong class="kb io">执行</strong>按钮开始。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nh"><img src="../Images/06df30c338ae4921b264ade8cfbb81d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-w4iVzTpkZ_kb_eW8nhypQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">GraphiQL with explorer</figcaption></figure><p id="cc21" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><strong class="kb io">第2步<br/> </strong>整理好我们的查询结构后，我们可以更新<code class="fe na nb nc nd b">App.js</code>，如下所示:</p><figure class="mr ms mt mu gt jo"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Updated App.js</figcaption></figure><p id="6563" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">上述代码执行这些任务:</p><ul class=""><li id="d402" class="mc md in kb b kc kd kg kh kk ni ko nj ks nk kw mh mi mj mk bi translated">创建状态来管理应用程序，并将其初始化为默认值。</li><li id="7123" class="mc md in kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated">创建了一个助手函数<code class="fe na nb nc nd b">getUserQuery</code>,它将用户的输入作为参数，并将其与我们之前测试的示例查询一起返回。</li><li id="11cb" class="mc md in kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated">修改了<code class="fe na nb nc nd b">handleSubmit</code>函数，首先创建一个对象来定义方法类型，包括带有我们之前创建的<strong class="kb io">个人访问令牌</strong>的header对象，然后调用<code class="fe na nb nc nd b">getUserQuery</code>函数并将状态(值)作为参数传递。<br/>最后，我们使用JavaScript <code class="fe na nb nc nd b">fetch API</code>对<a class="ae kx" href="https://api.github.com/graphql" rel="noopener ugc nofollow" target="_blank"><strong class="kb io">GitHub graph QL API</strong></a>进行API调用，传递<code class="fe na nb nc nd b">options</code>对象并相应地更新状态。</li><li id="ec31" class="mc md in kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated">设置一个错误界限，并显示一条适当的消息(如果有的话)。然后我们使用<code class="fe na nb nc nd b">result</code>对象来显示用户详细信息和存储库列表。</li></ul><p id="6564" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这样，我们现在可以通过输入GitHub用户名来测试应用程序。</p><figure class="mr ms mt mu gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/60bc88388688b4d039dea27c17a4890b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qxcygengX78WYsL0VwmNWg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">result of a query</figcaption></figure><h1 id="66e5" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">结论</h1><p id="508f" class="pw-post-body-paragraph jz ka in kb b kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks mb ku kv kw ig bi translated">这篇文章讨论了什么是GraphQL，它的重要性以及如何使用普通JavaScript查询GraphQL端点</p><p id="dc38" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">您可能会发现这些资源很有用:</p><ul class=""><li id="3be8" class="mc md in kb b kc kd kg kh kk ni ko nj ks nk kw mh mi mj mk bi translated"><a class="ae kx" href="https://graphql.org" rel="noopener ugc nofollow" target="_blank">图表QL </a></li><li id="39b6" class="mc md in kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated"><a class="ae kx" href="https://api.github.com/graphql" rel="noopener ugc nofollow" target="_blank"> GitHub GraphQL API </a></li><li id="7742" class="mc md in kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated"><a class="ae kx" href="https://docs.github.com/en/graphql/overview/explorer" rel="noopener ugc nofollow" target="_blank"> GitHub GraphQL浏览器</a></li><li id="4615" class="mc md in kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated"><a class="ae kx" href="https://github.com/graphql/graphiql" rel="noopener ugc nofollow" target="_blank">图形1</a></li></ul><p id="328d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><em class="ky">更多内容尽在</em><a class="ae kx" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank">T5】plain English . ioT7】</a></p></div></div>    
</body>
</html>