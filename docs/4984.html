<html>
<head>
<title>How I Built my First Twitch Bot with Natural Language Understanding (NLU)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何用自然语言理解构建我的第一个Twitch机器人(NLU)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-i-built-my-first-twitch-bot-with-nlu-66000facdc38?source=collection_archive---------9-----------------------#2021-10-08">https://javascript.plainenglish.io/how-i-built-my-first-twitch-bot-with-nlu-66000facdc38?source=collection_archive---------9-----------------------#2021-10-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/e66b5bb36818281a7400561a734f6748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2Rzkv7cI-J7wjJDQ"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@afgprogrammer?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mohammad Rahmani</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="af35" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">介绍</h1><p id="0aad" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在过去的几个月里，我一直在尝试机器学习和人工智能的不同领域。最近，我试图建立一个能够从图像中识别头发类型的卷积神经网络。要了解更多关于我的实验，你可以看看我的视频<a class="ae jz" href="https://www.youtube.com/watch?v=LtqaumBsuPM" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="d505" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">尽管探索卷积神经网络没有成功的结果，但我仍然受到启发，想了解更多关于AI/ML的知识。这让我了解了这个空间中的一个子集，叫做自然语言理解，具体来说就是“问答”在我的新项目中，我决定建造一个Twitch机器人，它将回答关于三位黑人女性的问题，她们是人工智能/人工智能行业的先驱，<strong class="la io">蒂姆尼特·格布鲁</strong>，<strong class="la io">雷迪特·阿贝贝</strong>和<strong class="la io">乔伊·波伦维尼</strong>。</p><h1 id="678d" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">什么是自然语言理解？</h1><p id="fada" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在机器学习和人工智能的文本世界中，有两个副主题:自然语言处理和自然语言理解。<strong class="la io">自然语言处理</strong>就是我教机器提取、分类、分解句子结构的时候。比如“敏捷的棕色狐狸跳过懒惰的狗”这句话。使用一种叫做“<strong class="la io"> <em class="mb">名称实体识别</em> </strong>的方法，机器会将“狐狸”和“狗”识别为“<strong class="la io"> <em class="mb">事物</em> </strong>”，然后使用“<strong class="la io"> <em class="mb">词性标注</em> </strong>”，机器会解析出“棕色”、“敏捷”和“懒惰”作为<strong class="la io">形容词</strong>，“跳跃”作为<strong class="la io">动词</strong>。NLP中的这两种方法只是帮助机器识别自然语言中的成分，但并没有真正赋予机器理解句子的能力。</p><p id="34e5" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">这就是副主题<strong class="la io">自然语言理解</strong>介绍的地方。NLU训练机器对它处理的自然语言进行阅读理解。NLU有一种叫做“<strong class="la io">问答</strong>的方法，教机器如何根据接收到的数据回答问题。在我的例句中，如果我问机器“狐狸是什么颜色的？”，它会回答“狐狸是棕色的。”模型可以回答“定义”问题，“如何和为什么”问题，以及语义约束问题。此外，Q &amp; A模型可以在任何事情上进行训练，这被称为“<strong class="la io">开放域</strong>”或者它可以在特定主题上进行训练，“<strong class="la io">封闭域</strong>”。对于我将建立的模型，它将是一个封闭的领域，因为它将只能回答关于人工智能/人工智能行业中三位女士的问题，并且它将能够回答“定义”问题和“如何以及为什么”问题。</p><h1 id="b63c" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">建造机器人</h1><p id="beea" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">为了构建我的Twitch机器人，我必须将三个主要组件拼凑在一起:连接到我自己的个人Twitch频道，为数据建立缓存数据库，以及构建“问答”模型。Twitch有一个非常灵活的API，允许我在我的频道上阅读和发布消息。我选择与他们的API接口的库是<strong class="la io"> TMI.js </strong>，一个Twitch消息接口库。我的数据是几个小于100KB的文本文件。每次我的模型运行时，它都会检索数据并进行分析。为了加快处理速度，我将创建一个内存缓存数据库。缓存数据库增加了处理时间，减少了检索数据的时间。我选择的库是<strong class="la io"> memory-cache.js </strong>，这是一个简单的Node.js内存缓存。</p><p id="fcb8" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">最后，我将使用流行的开源机器学习库，名为<strong class="la io"> TensorFlow </strong>。TensorFlow最初是用Python编写的，但它已经发展到其他编程语言。<strong class="la io"> TensorFlow </strong>写在<strong class="la io"> Node.js </strong>中，包含预先训练好的模型。TensorFlow有两个版本:CPU和GPU。所有这些都意味着模型将在我的机器的CPU或GPU上运行。众所周知，在GPU上运行模型处理速度更快。对于我的模型，我将使用CPU。我将用来支持我的模型的库是<strong class="la io">@ tensor flow-models/qna . js</strong>、<strong class="la io"> @tensorflow/tfjs </strong>和<strong class="la io"> @tensorflow/tfjs-node </strong>。</p><h1 id="d36e" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">设置抽动</h1><p id="febc" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">我要做的第一步是初始化我的Twitch客户端。<strong class="la io"> TMI.js </strong>要求我提供用户名、密码和频道，以便在我的Twitch频道中查看和回复消息。</p><figure class="md me mf mg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mc"><img src="../Images/4583333cfad87e6d2a34e5fe05305919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FiQVCRCgzMweUjZXg7pp-w.png"/></div></div></figure><p id="8a90" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">因为这三项是敏感信息，所以我将它们放在。环境文件。"<strong class="la io"> dotenv </strong>"是一个将环境文件加载到process.env对象的库。它对于为不同环境配置服务器非常安全和有用。我可以用Twitch客户端设置的另一个配置是连接类型。为了遵循最佳实践，我将设置我的连接是安全的(HTTPS)。我还将设置我的Twitch客户端，以便在连接中断时不断重新连接。</p><h1 id="71ad" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">构建模型</h1><p id="e15e" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">初始化我的Twitch客户端后，接下来要做的是构建我的模型。前面我提到TensorFlow使用预先训练好的模型。<strong class="la io">预训练模型</strong>是由另一方开发的模型，作为扩展的基础模型。举个例子，如果我想建立一个可以在图片中检测猫品种的模型。我可以选择从头开始构建模型。这意味着我必须训练这个模型，让它知道猫和其他物体之间的区别。这需要包括猫在内的数百万张各种类型的图片。然而，如果我使用一个预先训练好的模型，它就会知道猫和物体之间的区别。这让我有机会更快地建立模型来解决问题。对于我们的用例，我将为“<strong class="la io">问答</strong>”使用一个预先训练好的模型</p><p id="efac" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在我使用这个模型之前，我需要输入我自己的数据。数据将存储在文本文件中。这样做的缺点是，每次模型运行时，服务器都必须读取文件系统。</p><figure class="md me mf mg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mh"><img src="../Images/ae2b6c7f993f308637b97f86bfa02f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chtXQxoN_V-90mOSOdQIhA.png"/></div></div></figure><p id="3323" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">为了绕过这一点，我可以将数据存储在内存中，并从内存缓存中检索数据。我将通过创建一个自调用函数来实现这一点。这将读取文本文件并将它们放入内存缓存中。我将使用文件名作为关键字来检索信息。<br/> <br/>现在我已经准备好了数据，我可以拼凑模型了。我的模型将回答三个主题的问题。我将制作一个通用的函数，而不是针对这三个主题定制代码。该函数将捕获主题的名称和提出的问题。</p><figure class="md me mf mg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mi"><img src="../Images/363be97fa26a72dd31805cce03ca2f1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HnebLne3ojgg9XqlWkCSTA.png"/></div></div></figure><p id="4620" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">我将把这个函数命名为“<strong class="la io"> qnaModel </strong>”它要做的第一件事是初始化来自TensorFlow的Q &amp; A预训练模型。然后，根据给定的名称，它将从内存缓存中检索相关的文本。这些信息和问题一起被输入到TensorFlow的函数中，名为“<strong class="la io"> findAnswers </strong>”这个函数有两个参数，数据和问题。作为回报，它将为我提供一个对象数组。下面是一个例子:</p><figure class="md me mf mg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mj"><img src="../Images/500ae5efb6f5951e046c8798c9c8008a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*owEHiQzTFzRCY0AQLJineQ.png"/></div></div></figure><p id="1f09" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">对象有四个属性:<strong class="la io">文本</strong>、<strong class="la io"> startIndex </strong>、<strong class="la io"> endIndex </strong>和<strong class="la io">分数</strong>。“<strong class="la io">文本</strong>”显示模型得出的答案。“<strong class="la io"> startIndex </strong>”和“<strong class="la io"> endIndex </strong>”都指向模型在文本中找到答案的位置。"<strong class="la io">得分</strong>"衡量模型对其答案的信心程度。数字越接近1，模型对答案越有信心。默认情况下，数组中的第一个条目将具有模型中较高的分数。在代码中，我决定放置一个条件语句。如果数组大于1，则返回数组中的第一个元素。最后，我导出这个函数供我的Twitch客户机使用。</p><h1 id="a6f1" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">将模型连接到Twitch Bot</h1><p id="75c1" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">Twitch API有几个事件，我可以用它们在我的Twitch通道中进行交互。我将需要使用一个允许我监听“消息”的通道事件。在那里，我可以分析这些消息，并确定用户是否试图与我们的机器人进行交互。我将查找包含<strong class="la io">的邮件！joybuolamwini！redietabebe </strong>和<strong class="la io">！timnitgebru </strong>。这些消息前面会有一个问题。</p><figure class="md me mf mg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/e0e9c0f61a95c3f1693e3e36725ea243.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QkUNUA1v6d66aIxcFbFJ5g.png"/></div></div></figure><p id="2ff2" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">最后，我将引入为我的问题进行数据分析的函数。在代码片段中，我将删除除“文本”之外的所有属性这是因为我只想在我的Twitch频道上显示答案。</p><figure class="md me mf mg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/10b1a2ae47509253c4ddce92ea902c95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l1YPkArlFMUvleSVGSu68g.png"/></div></div></figure><p id="41dd" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">之后我准备把答案发到我的Twitch频道。为了做到这一点，我使用了“T20”说“T21”的方法。该方法接受两个参数:<strong class="la io">通道名称</strong>和<strong class="la io">消息</strong>。</p><figure class="md me mf mg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/bbcec4d0a8d733b0a6f76397612299f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sdzvzP6VXpL6ZGYl1fXqKQ.png"/></div></div></figure><p id="4858" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">下面的代码片段显示了<strong class="la io"> src/index.js </strong>文件中的所有内容。</p><figure class="md me mf mg gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mm"><img src="../Images/5096afddecf504755d7efd8d36876b22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xfu9_3tKpdczsWuIjXfdbQ.png"/></div></div></figure><p id="d6ef" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">这是我的Twitch机器人在我的Twitch频道中工作的一个短片。</p><figure class="md me mf mg gt jo"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="4f21" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="1d31" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">上面的代码是我结合NLU和Twitch API的第一次迭代。我可以对这段代码做一些改进。一个例子是缓存常见问题的答案。这将减少服务器和模型的响应时间。然而，我想分享我在自然语言理解实验中的旅程。</p><p id="7165" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">我希望这篇教程能给你使用JavaScript来涉猎TensorFlow的灵感。你可以在这里查看完整代码<a class="ae jz" href="https://github.com/thestrugglingblack/struggle-bot" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="acaa" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><em class="mb">如果你喜欢这个教程，可以看看我在</em><a class="ae jz" href="http://www.twitch.tv/thestrugglingblack" rel="noopener ugc nofollow" target="_blank"><strong class="la io"><em class="mb">www.twitch.tv/thestrugglingblack</em></strong></a>上的技术流</p><p id="a039" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><em class="mb">更多内容看</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="la io"><em class="mb">plain English . io</em></strong></a></p></div></div>    
</body>
</html>