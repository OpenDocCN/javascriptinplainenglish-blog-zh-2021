<html>
<head>
<title>Ionic 5 and above: SSL Pinning for iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ionic 5及以上版本:iOS的SSL Pinning</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/ionic-5-and-above-ssl-pinning-for-ios-b77f17d9e6a6?source=collection_archive---------2-----------------------#2021-11-23">https://javascript.plainenglish.io/ionic-5-and-above-ssl-pinning-for-ios-b77f17d9e6a6?source=collection_archive---------2-----------------------#2021-11-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0f69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我花了点时间才想明白。事实上快两个月了。开始质疑我寻找这个问题的解决方案的理智，但我最终做到了！我能够理解如何使用Ionic框架为iOS进行SSL锁定。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/5f7b767c96983e3b9570e86ccf028731.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AKvx90Ej-uMRTp2I"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Photo by <a class="ae lb" href="https://unsplash.com/@sarahle?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sarah Le</a> on <a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9b20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我写这篇文章，只是为了以防我自己需要回去，或者如果有一些不幸的灵魂在StackOverflow/Google hole的角落里寻找这个问题的解决方案。给你:</p><h2 id="cd0c" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">什么是SSL pin？</h2><p id="c000" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">如果你想知道更多关于什么是SSL固定，请通读下面的文章。</p><div class="ma mb gp gr mc md"><a href="https://medium.com/flawless-app-stories/ssl-pinning-254fa8ca2109" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd ir gy z fp mi fr fs mj fu fw ip bi translated">SSL固定</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">SSL pinning代表安全套接字层。SSL证书通过建立一个安全的…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">medium.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr kv md"/></div></div></a></div><h2 id="6bb1" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak">你需要知道什么(先决条件)？</strong></h2><ol class=""><li id="9ade" class="ms mt iq jp b jq lv ju lw jy mu kc mv kg mw kk mx my mz na bi translated">在这里，使用Ionic开发移动应用程序至关重要。如果你不知道Ionic，但对移动应用开发非常感兴趣，或者你是Ionic的新手，你可以查看以下页面:</li></ol><div class="ma mb gp gr mc md"><a href="https://www.ionicframework.com" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd ir gy z fp mi fr fs mj fu fw ip bi translated">跨平台移动应用开发:Ionic框架</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">Ionic Framework的应用程序开发平台构建了令人惊叹的跨平台移动、web和桌面应用程序，只需一个…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">www.ionicframework.com</p></div></div><div class="mm l"><div class="nb l mo mp mq mm mr kv md"/></div></div></a></div><p id="42f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.你需要知道如何做HTTPS发布/获取请求。如果你对此不熟悉，对你来说这是一个陌生的概念，那么这篇文章就不适合你。</p><h2 id="d8af" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak">你需要什么？</strong></h2><ol class=""><li id="9723" class="ms mt iq jp b jq lv ju lw jy mu kc mv kg mw kk mx my mz na bi translated">一个准备实现SSL锁定的Ionic应用程序</li><li id="711f" class="ms mt iq jp b jq nc ju nd jy ne kc nf kg ng kk mx my mz na bi translated">我用电容器构建了这个Ionic应用程序，但我认为这种方法与Cordova完全相同，因为这是使用Cordova插件</li><li id="3f9e" class="ms mt iq jp b jq nc ju nd jy ne kc nf kg ng kk mx my mz na bi translated">您的服务器的SSL证书(确保您有一个带有SSL证书的HTTPS服务器准备就绪)</li><li id="4e6e" class="ms mt iq jp b jq nc ju nd jy ne kc nf kg ng kk mx my mz na bi translated">确保你的Ionic应用上安装了这个插件(【https://ionicframework.com/docs/native/http】T4)</li><li id="906e" class="ms mt iq jp b jq nc ju nd jy ne kc nf kg ng kk mx my mz na bi translated">Xcode(嗯，因为你知道，iOS)</li><li id="2422" class="ms mt iq jp b jq nc ju nd jy ne kc nf kg ng kk mx my mz na bi translated">x509格式的。cer文件(下面将详细介绍)</li></ol><h2 id="dcd4" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">如何生成x509格式的？cer文件？</h2><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nh"><img src="../Images/697728884fe1f0dbc0f0ef3885e855eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a6SkcUiclTkHSQ1nJReQrg.png"/></div></div></figure><p id="836e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您将certificate.cer文件放在证书中，并且它工作正常，那么，<em class="ni">对您来说，</em>一切正常。</p><p id="4e7a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但有时，certificate.cer文件不起作用，这就是它让您疯狂地寻找这个问题的解决方案的原因。</p><p id="6c23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ni">你已经拥有了。cer文件，那么它应该正常工作吧？？？？</em></p><p id="f481" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不→这花了我2个月才搞清楚ok。</p><p id="8973" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，如何解决这个问题，以及如何继续确保您收到的certificate.cer正常工作呢？</p><p id="bba0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">答案是确保您收到的certificate.cer文件是用<strong class="jp ir"> x509格式化的。</strong></p><p id="11ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如何判断是否有x509格式的certificate.cer文件？运行以下命令:</p><pre class="km kn ko kp gt nj nk nl nm aw nn bi"><span id="22aa" class="lc ld iq nk b gy no np l nq nr"><strong class="nk ir">openssl x509 -in certificate.cer -inform der -text -noout</strong></span></pre><p id="4527" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更多的时候会喷出一大堆台词。这可能是一件好事，但是，如果结果以类似于<em class="ni">‘无法加载证书…’</em>的内容开始</p><p id="73ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，您没有x509格式。cer文件。重要的是，您需要运行以下命令来生成x509格式的。cer文件:</p><pre class="km kn ko kp gt nj nk nl nm aw nn bi"><span id="163b" class="lc ld iq nk b gy no np l nq nr">openssl x509 -in certificate.cer -outform PEM -out cert.pem</span><span id="8e78" class="lc ld iq nk b gy ns np l nq nr">openssl x509 -outform der -in cert.pem -out certificate.cer</span></pre><p id="faf3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个接一个地运行这些命令，然后您可以使用前面的<code class="fe nt nu nv nk b">openssl </code>命令再次测试，以检查您的certificate.cer文件是否是x509格式的并且工作正常。</p><p id="03fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果一切都好，那么你可以继续前进。</p><h2 id="6891" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">如何在您的Ionic应用程序中进行SSL锁定？</h2><h2 id="aabf" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">第一步</h2><p id="859a" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">确保您在首次加载应用程序时激活了SSL pin。在我的例子中，这是在构造函数内部的app.component.ts中完成的，如下所示:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="6f41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，这不用说，你将需要安装Cordova高级HTTP的离子电容器。安装该插件的指南可从以下网址获得:</p><div class="ma mb gp gr mc md"><a href="https://ionicframework.com/docs/native/http" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd ir gy z fp mi fr fs mj fu fw ip bi translated">HTTP服务器插件文档:iOS和Android的优势</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">HTTP是用于与HTTP服务器通信的Cordova / Phonegap插件。查看我们的文档以了解…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">ionicframework.com</p></div></div><div class="mm l"><div class="ny l mo mp mq mm mr kv md"/></div></div></a></div><h2 id="7c8c" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">第二步</h2><p id="3f70" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">运行以下命令:</p><pre class="km kn ko kp gt nj nk nl nm aw nn bi"><span id="9983" class="lc ld iq nk b gy no np l nq nr">ionic build</span><span id="0467" class="lc ld iq nk b gy ns np l nq nr">npx cap add ios (run only once)</span><span id="769f" class="lc ld iq nk b gy ns np l nq nr">npx cap copy ios</span><span id="073f" class="lc ld iq nk b gy ns np l nq nr">npx cap sync ios</span></pre><p id="63ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些命令将生成一个ios文件夹，其中包含您的Ionic iOS应用程序。现在您需要做的就是将certificate.cer文件(x509格式的。cer文件！记住这个！)放入以下文件夹:</p><pre class="km kn ko kp gt nj nk nl nm aw nn bi"><span id="1d2f" class="lc ld iq nk b gy no np l nq nr">ios/App/App/www/certificates/</span></pre><p id="31b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我知道有些人可能会说，有一种更简单的方法可以做到这一点，那就是将证书文件放在assets文件夹中。我想真正确保证书确实在它的位置上，所以我通常自己手动将其放入。</p><h2 id="f5ad" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak">第三步</strong></h2><p id="eb07" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">使用Xcode构建您的应用程序。你可以试着在一个模拟器上运行它，或者只是在一个连接到你的Mac的设备上试用它。</p><p id="4ad1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在构建应用程序之后，您应该能够检查您的SSL连接是否有效。我已经在模拟器和本地iPhone上进行了尝试，SSL工作正常。就是这样！</p><h2 id="2568" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">结论</h2><p id="f499" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">这是我的个人经验:我必须强调，我花了一段时间才想出这个问题。通过写下它，这对我来说更多的是一种治疗，除了提醒我如何解决这个问题，为我自己，也为你，在未来。</p><p id="37ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">能够把一个问题打得落花流水，这种感觉真的很棒。一种满足感，我相信类似于在世界杯决赛中对巴西的进球。这就是移动应用开发者的生活。</p><p id="1910" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢你和<em class="ni"> Selamat Mengaturcara！</em></p><p id="c0f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ni">更多内容尽在</em><a class="ae lb" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="ni">plain English . io</em></a><em class="ni">。在这里注册我们的</em> <a class="ae lb" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="ni">免费周报</em> </a> <em class="ni">。</em></p></div></div>    
</body>
</html>