<html>
<head>
<title>Create a Custom Hook to Show/Hide Password Visibility in React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建一个自定义挂钩来显示/隐藏React Native中的密码可见性</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-a-custom-hook-for-show-hide-password-visibility-in-react-native-db184a48126e?source=collection_archive---------4-----------------------#2021-12-13">https://javascript.plainenglish.io/create-a-custom-hook-for-show-hide-password-visibility-in-react-native-db184a48126e?source=collection_archive---------4-----------------------#2021-12-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/a731d71af50c4d1f8ebae7d2489e66ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nf3NO1mz-MVDpv4ouGFP_Q.png"/></div></div></figure><p id="9e8f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在React本地应用程序中构建登录和注册表单包括输入字段和按钮。您会发现自己经常添加到这些表单中的一个字段是密码字段。这个密码字段由React Native的<code class="fe kt ku kv kw b">TextInput</code>组件组成。</p><p id="407e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">该字段的常见行为是将用户密码隐藏在晦涩的字符后面。</p><p id="6436" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">看看用于创建密码字段的<code class="fe kt ku kv kw b">TextInput</code>组件的例子。</p><pre class="kx ky kz la gt lb kw lc ld aw le bi"><span id="557c" class="lf lg in kw b gy lh li l lj lk">import React, { useState } from <a class="ae ll" href="https://github.com/facebook/react/tree/master/packages/react" rel="noopener ugc nofollow" target="_blank">'react'</a>;<br/>import { StyleSheet, TextInput, View } from <a class="ae ll" href="https://github.com/facebook/react-native" rel="noopener ugc nofollow" target="_blank">'react-native'</a>;</span><span id="da73" class="lf lg in kw b gy lm li l lj lk">export default function App() {<br/>  const [password, setPassword] = useState('');</span><span id="00b0" class="lf lg in kw b gy lm li l lj lk">  return (<br/>    &lt;View style={styles.container}&gt;<br/>      &lt;View style={styles.inputContainer}&gt;<br/>        &lt;TextInput<br/>          style={styles.inputField}<br/>          name='password'<br/>          placeholder='Enter password'<br/>          autoCapitalize='none'<br/>          autoCorrect={false}<br/>          textContentType='newPassword'<br/>          secureTextEntry<br/>          value={password}<br/>          enablesReturnKeyAutomatically<br/>          onChangeText={text =&gt; setPassword(text)}<br/>        /&gt;<br/>      &lt;/View&gt;<br/>    &lt;/View&gt;<br/>  );<br/>}</span><span id="ce85" class="lf lg in kw b gy lm li l lj lk">const styles = StyleSheet.create({<br/>  container: {<br/>    flex: 1,<br/>    backgroundColor: '#F5EEDC',<br/>    alignItems: 'center',<br/>    justifyContent: 'center',<br/>    paddingHorizontal: 12<br/>  },<br/>  inputContainer: {<br/>    backgroundColor: 'white',<br/>    width: '100%',<br/>    borderRadius: 8,<br/>    flexDirection: 'row',<br/>    alignItems: 'center',<br/>    borderWidth: 4,<br/>    borderColor: '#d7d7d7'<br/>  },<br/>  inputField: {<br/>     padding: 14,<br/>    fontSize: 22,<br/>    width: '90%'<br/>  }<br/>  }<br/>});</span></pre><p id="30df" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">它使用了<code class="fe kt ku kv kw b">secureTextEntry</code>属性，这样当一个文本值被输入到输入字段中时，就不清楚在那个字段中输入了什么。</p><p id="4283" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是上述片段在设备上的输出:</p><figure class="kx ky kz la gt jo gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/6fa3b9d09c139bf966aae737b1d3cad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/0*VdUiQ4JdrZ9QrT2R"/></div></figure><p id="7942" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然而，给用户一个选项，让他们看到他们输入的当前值，可以带来良好的体验，在某些情况下可能是必要的。</p><h1 id="9d36" class="lo lg in bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">显示或隐藏密码可见性挂钩</h1><p id="92e8" class="pw-post-body-paragraph jv jw in jx b jy ml ka kb kc mm ke kf kg mn ki kj kk mo km kn ko mp kq kr ks ig bi translated">为了增加显示或隐藏密码字段可见性的能力，让我们在一个名为<code class="fe kt ku kv kw b">useTogglePasswordVisibility.js.js</code>的新文件中创建一个定制钩子。</p><p id="6d72" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先从React库中导入<code class="fe kt ku kv kw b">useState</code>钩子。您需要创建两个不同的状态变量来切换字段的可见性和改变图标。</p><p id="e67c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后定义一个函数叫做<code class="fe kt ku kv kw b">useTogglePasswordVisibility</code>。在这个函数中，创建两个新的状态变量。第一个叫<code class="fe kt ku kv kw b">passwordVisibility</code>。它的初始值被设置为布尔型<code class="fe kt ku kv kw b">true</code>。原因是这个变量将是<code class="fe kt ku kv kw b">TextInput</code>组件上的属性<code class="fe kt ku kv kw b">secureTextEntry</code>的值。当用户在输入字段中输入密码时，您可能希望最初隐藏密码字段。</p><p id="ef5b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">定义的第二个状态变量称为<code class="fe kt ku kv kw b">rightIcon</code>。它的默认值为<code class="fe kt ku kv kw b">eye</code>。该值取决于您在React本机应用程序中使用的图标库。对于这个例子，我使用的是来自<a class="ae ll" href="https://docs.expo.dev/guides/icons/" rel="noopener ugc nofollow" target="_blank"> Expo矢量图标</a>的MaterialCommunityIcons。</p><pre class="kx ky kz la gt lb kw lc ld aw le bi"><span id="e925" class="lf lg in kw b gy lh li l lj lk">export const useTogglePasswordVisibility = () =&gt; {<br/>  const [passwordVisibility, setPasswordVisibility] = useState(true);<br/>  const [rightIcon, setRightIcon] = useState('eye');</span><span id="e55b" class="lf lg in kw b gy lm li l lj lk">  // ...<br/>};</span></pre><p id="dc98" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，添加一个名为<code class="fe kt ku kv kw b">handlePasswordVisibility</code>的方法，允许应用程序用户在显示和隐藏状态之间切换密码字段的可见性。</p><p id="aebf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最后，不要忘记返回所有变量和处理程序方法。</p><pre class="kx ky kz la gt lb kw lc ld aw le bi"><span id="5ee7" class="lf lg in kw b gy lh li l lj lk">export const useTogglePasswordVisibility = () =&gt; {<br/>  const [passwordVisibility, setPasswordVisibility] = useState(true);<br/>  const [rightIcon, setRightIcon] = useState('eye');</span><span id="bbd7" class="lf lg in kw b gy lm li l lj lk">  const handlePasswordVisibility = () =&gt; {<br/>    if (rightIcon === 'eye') {<br/>      setRightIcon('eye-off');<br/>      setPasswordVisibility(!passwordVisibility);<br/>    } else if (rightIcon === 'eye-off') {<br/>      setRightIcon('eye');<br/>      setPasswordVisibility(!passwordVisibility);<br/>    }<br/>  };</span><span id="3bf0" class="lf lg in kw b gy lm li l lj lk">  return {<br/>    passwordVisibility,<br/>    rightIcon,<br/>    handlePasswordVisibility<br/>  };<br/>};</span></pre><h1 id="5e3c" class="lo lg in bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">使用密码可见性挂钩</h1><p id="72db" class="pw-post-body-paragraph jv jw in jx b jy ml ka kb kc mm ke kf kg mn ki kj kk mo km kn ko mp kq kr ks ig bi translated">首先更新<code class="fe kt ku kv kw b">App.js</code>文件中的导入语句:</p><pre class="kx ky kz la gt lb kw lc ld aw le bi"><span id="efb8" class="lf lg in kw b gy lh li l lj lk">import React, { useState } from <a class="ae ll" href="https://github.com/facebook/react/tree/master/packages/react" rel="noopener ugc nofollow" target="_blank">'react'</a>;<br/>import { StyleSheet, Pressable, TextInput, View } from <a class="ae ll" href="https://github.com/facebook/react-native" rel="noopener ugc nofollow" target="_blank">'react-native'</a>;<br/>import { MaterialCommunityIcons } from <a class="ae ll" href="https://github.com/expo/vector-icons" rel="noopener ugc nofollow" target="_blank">'@expo/vector-icons'</a>;</span><span id="3dc4" class="lf lg in kw b gy lm li l lj lk">import { useTogglePasswordVisibility } from './hooks/useTogglePasswordVisibility';</span></pre><p id="453a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，从<code class="fe kt ku kv kw b">useTogglePasswordVisibility</code>钩子访问所需的变量和方法。在<code class="fe kt ku kv kw b">App</code>组件的顶部添加以下行:</p><pre class="kx ky kz la gt lb kw lc ld aw le bi"><span id="7bbc" class="lf lg in kw b gy lh li l lj lk">export default function App() {<br/>  const { passwordVisibility, rightIcon, handlePasswordVisibility } =<br/>    useTogglePasswordVisibility();<br/>  const [password, setPassword] = useState('');</span><span id="8976" class="lf lg in kw b gy lm li l lj lk">  // ...<br/>}</span></pre><p id="e114" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">修改<code class="fe kt ku kv kw b">TextInput</code>组件的道具。确保将<code class="fe kt ku kv kw b">passwordVisibility</code>作为值添加到<code class="fe kt ku kv kw b">secureTextEntry</code>属性中。</p><pre class="kx ky kz la gt lb kw lc ld aw le bi"><span id="4e64" class="lf lg in kw b gy lh li l lj lk">&lt;TextInput<br/>  secureTextEntry={passwordVisibility}<br/>  // ... rest of the props remain unchanged<br/>/&gt;</span></pre><p id="7fe7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在包装<code class="fe kt ku kv kw b">TextInput</code>的<code class="fe kt ku kv kw b">View</code>组件内，使用<code class="fe kt ku kv kw b">Pressable</code>组件添加一个按钮。该按钮将允许用户在密码字段的隐藏和显示状态之间切换。</p><p id="e334" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">该按钮包装图标组件。</p><pre class="kx ky kz la gt lb kw lc ld aw le bi"><span id="7a0a" class="lf lg in kw b gy lh li l lj lk">&lt;View style={styles.inputContainer}&gt;<br/>  {/* After TextInput component */}<br/>  &lt;Pressable onPress={handlePasswordVisibility}&gt;<br/>    &lt;MaterialCommunityIcons name={rightIcon} size={22} color="#232323" /&gt;<br/>  &lt;/Pressable&gt;<br/>&lt;/View&gt;</span></pre><p id="91a9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">仅此而已！这是此步骤后的输出:</p><figure class="kx ky kz la gt jo gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/e2ba5517c1743398413b85a987388b2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/0*_NN4hvWqKUNc2yw5"/></div></figure><p id="c33c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">以下是<code class="fe kt ku kv kw b">App.js</code>文件的完整代码:</p><pre class="kx ky kz la gt lb kw lc ld aw le bi"><span id="ceb5" class="lf lg in kw b gy lh li l lj lk">import React, { useState } from <a class="ae ll" href="https://github.com/facebook/react/tree/master/packages/react" rel="noopener ugc nofollow" target="_blank">'react'</a>;<br/>import { StyleSheet, Pressable, TextInput, View } from <a class="ae ll" href="https://github.com/facebook/react-native" rel="noopener ugc nofollow" target="_blank">'react-native'</a>;<br/>import { MaterialCommunityIcons } from <a class="ae ll" href="https://github.com/expo/vector-icons" rel="noopener ugc nofollow" target="_blank">'@expo/vector-icons'</a>;</span><span id="ee36" class="lf lg in kw b gy lm li l lj lk">import { useTogglePasswordVisibility } from './hooks/useTogglePasswordVisibility';</span><span id="761a" class="lf lg in kw b gy lm li l lj lk">export default function App() {<br/>  const { passwordVisibility, rightIcon, handlePasswordVisibility } =<br/>    useTogglePasswordVisibility();<br/>  const [password, setPassword] = useState('');</span><span id="d94e" class="lf lg in kw b gy lm li l lj lk">  return (<br/>    &lt;View style={styles.container}&gt;<br/>      &lt;View style={styles.inputContainer}&gt;<br/>        &lt;TextInput<br/>          style={styles.inputField}<br/>          name="password"<br/>          placeholder="Enter password"<br/>          autoCapitalize="none"<br/>          autoCorrect={false}<br/>          textContentType="newPassword"<br/>          secureTextEntry={passwordVisibility}<br/>          value={password}<br/>          enablesReturnKeyAutomatically<br/>          onChangeText={text =&gt; setPassword(text)}<br/>        /&gt;<br/>        &lt;Pressable onPress={handlePasswordVisibility}&gt;<br/>          &lt;MaterialCommunityIcons name={rightIcon} size={22} color="#232323" /&gt;<br/>        &lt;/Pressable&gt;<br/>      &lt;/View&gt;<br/>    &lt;/View&gt;<br/>  );<br/>}</span><span id="6a18" class="lf lg in kw b gy lm li l lj lk">const styles = StyleSheet.create({<br/>  container: {<br/>    flex: 1,<br/>    backgroundColor: '#F5EEDC',<br/>    alignItems: 'center',<br/>    justifyContent: 'center',<br/>    paddingHorizontal: 12<br/>  },<br/>  inputContainer: {<br/>    backgroundColor: 'white',<br/>    width: '100%',<br/>    borderRadius: 8,<br/>    flexDirection: 'row',<br/>    alignItems: 'center',<br/>    borderWidth: 4,<br/>    borderColor: '#d7d7d7'<br/>  },<br/>  inputField: {<br/>    padding: 14,<br/>    fontSize: 22,<br/>    width: '90%'<br/>  }<br/>});</span></pre></div><div class="ab cl mq mr hr ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ig ih ii ij ik"><ul class=""><li id="1b3c" class="mx my in jx b jy jz kc kd kg mz kk na ko nb ks nc nd ne nf bi translated"><a class="ae ll" href="https://github.com/amandeepmittal/react-native-examples/tree/master/custom-hook-password-toggle" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">源代码在此GitHub回购</strong> </a> <strong class="jx io">🐙</strong></li><li id="e286" class="mx my in jx b jy ng kc nh kg ni kk nj ko nk ks nc nd ne nf bi translated"><a class="ae ll" href="https://amanhimself.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">看看我在React Native和Expo上写的其他博文</strong> </a>📄</li><li id="3e48" class="mx my in jx b jy ng kc nh kg ni kk nj ko nk ks nc nd ne nf bi translated"><a class="ae ll" href="https://twitter.com/amanhimself" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">在推特上打招呼</strong> </a>👋</li></ul><p id="3c27" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="nl">更多内容看</em> <a class="ae ll" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="nl">说白了就是</em> </a> <em class="nl">。在这里注册我们的</em> <a class="ae ll" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="nl">免费周报</em> </a> <em class="nl">。</em></p></div></div>    
</body>
</html>