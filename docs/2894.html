<html>
<head>
<title>Seamlessly Validate React Forms Using Formik and Yup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Formik和Yup无缝验证React表单</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/easily-validate-react-forms-using-formik-and-yup-677d2191c785?source=collection_archive---------12-----------------------#2021-06-12">https://javascript.plainenglish.io/easily-validate-react-forms-using-formik-and-yup-677d2191c785?source=collection_archive---------12-----------------------#2021-06-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3417" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">反应形式可以很快变得复杂。福米克会节省你们两个人流泪的时间。</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/fa381be97b2c2da57281fe73c51debc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lJ8Iur536kg255FK"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@joshuaryanphoto?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joshua Reddekopp</a> on <a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="0534" class="kx ky iq bd kz la lb lc ld le lf lg lh jw li jx lj jz lk ka ll kc lm kd ln lo bi translated">React中的表单与传统的HTML、CSS和普通JS:</h1><p id="db15" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">React表单可能会有点麻烦，只是因为多组件结构的作用域问题(<em class="ml">由模块化组件的概念</em>带来)。</p><p id="58b2" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">再加上这些独立组件之间复杂的数据流—就状态管理而言，很容易忽略全局。</p><p id="2afe" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">在时间紧迫的专业环境中工作时，时间至关重要。代码<strong class="lr ir">必须以干净、可伸缩、可维护和可重用的方式写好</strong>,并具有适当的安全性。</p><h2 id="5793" class="mr ky iq bd kz ms mt dn ld mu mv dp lh ly mw mx lj mc my mz ll mg na nb ln nc bi translated">因此，您已经在React web应用程序中构建了一个联系人表单，布局如下(去掉占位符):</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nd"><img src="../Images/a3dcc082357463cef547538d1e560288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IG9nRYJ6B8l6gxEm-f7HZg.png"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">Screenshot belongs to PJ Codes.</figcaption></figure><p id="e80b" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">出于本教程的考虑，我不会浪费任何时间向您解释React中处理表单的传统(非库)方式。</p><p id="359f" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">假设对于这个联系表单，我们有<strong class="lr ir"> 2 </strong>组件:<strong class="lr ir">如上图<strong class="lr ir">所示的联系表单</strong>和一个名为</strong> <code class="fe ne nf ng nh b">InputField</code>的组件，该组件接受一些表单元素属性作为道具，并基于这些道具动态返回HTML输入字段。</p><p id="855a" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">为了让我们的<code class="fe ne nf ng nh b">inputField</code>组件获得它的<em class="ml">属性</em>属性，我们首先需要定义某种数据结构，这将允许我们定义属性名称并赋予它们值— <em class="ml">这里每个输入类型一个对象就足够了，我们可以将它们整齐地放入一个数组中。</em></p><p id="f44b" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated"><strong class="lr ir">我们可以很容易地做这样的事情:</strong></p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="a0cf" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">现在，在我们开始使用Formik之前，让我们先简单介绍一下它们:</p><h2 id="3855" class="mr ky iq bd kz ms mt dn ld mu mv dp lh ly mw mx lj mc my mz ll mg na nb ln nc bi translated">福米克:</h2><p id="8cd0" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">一个轻量级和直观的React库，用于构建、验证和提交表单。Formik使用核心的React状态管理特性，如<strong class="lr ir">状态</strong>和<strong class="lr ir">道具</strong>，而不是花哨的订阅和幕后观察。这使得学习曲线相对平坦，并使调试更加容易。</p><p id="634a" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">其核心是，Formik是一个简化复杂表单验证的工具。它还支持同步和异步验证<strong class="lr ir">到现场级</strong>。</p><h2 id="d7e0" class="mr ky iq bd kz ms mt dn ld mu mv dp lh ly mw mx lj mc my mz ll mg na nb ln nc bi translated">这里有更多的规格:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nk"><img src="../Images/d39e5f31bec8dd4d0f11640b5b8f6d27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O6kKgzTp8AR0E_3ex4Cv_Q.png"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">Credit: Screenshot taken from formik.org</figcaption></figure><p id="1de6" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated"><strong class="lr ir">看看这个简单的例子:</strong></p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="674d" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">对于经验丰富的React开发人员来说，这是显而易见的，但是对于那些对这个有点陌生的人来说，让我用简单的英语为你解释一下:</p><p id="2cb8" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated"><em class="ml">(反应过来的大神可以跳过这部分)</em></p><ul class=""><li id="d171" class="nl nm iq lr b ls mm lv mn ly nn mc no mg np mk nq nr ns nt bi translated">第5行:我们创建一个名为<code class="fe ne nf ng nh b">SignupForm</code>的功能组件。</li><li id="6a66" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><strong class="lr ir">第7–14行:</strong>我们使用了<code class="fe ne nf ng nh b">useFormik</code>钩子，向它传递一些初始值和一个提交函数，这个函数在提交时被调用。我们使用<code class="fe ne nf ng nh b">JSON.stringify(value, replacer, space)</code>最初记录我们提交的数据。如果你不熟悉这个函数是如何工作的，让我很快地解释给你听。<strong class="lr ir"> <em class="ml">值</em> </strong>表示我们通过提交时传入的实际值。<strong class="lr ir"> <em class="ml"> replacer </em> </strong>表示改变字符串化过程行为的函数。在这种情况下既然是<code class="fe ne nf ng nh b">null</code>，我们就把<strong class="lr ir"> <em class="ml">值</em> </strong>对象的所有属性和值作为我们的最终结果。最后，<strong class="lr ir"> <em class="ml">空格</em> </strong>参数表示一些空白字符，以便于阅读。值<strong class="lr ir"> &lt; 1 </strong>表示没有空格。</li><li id="abad" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><strong class="lr ir">第15–27行</strong>:我们返回一个<code class="fe ne nf ng nh b">form</code>元素，这个元素附加了我们的<code class="fe ne nf ng nh b">onSubmit</code>事件处理程序。然后，我们呈现一个<code class="fe ne nf ng nh b">input</code>字段，并传入一些属性，如<code class="fe ne nf ng nh b">onChange</code>记录了我们的键入输入的<em class="ml">和<code class="fe ne nf ng nh b">value</code>实际捕获了我们的键入输入。</em></li></ul><p id="219a" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">现在我们对Formik有了基本的了解，让我们运行下面的代码:<code class="fe ne nf ng nh b">npm install formik</code> ( <em class="ml">只是为了让它运行</em>)。</p><h2 id="b675" class="mr ky iq bd kz ms mt dn ld mu mv dp lh ly mw mx lj mc my mz ll mg na nb ln nc bi translated">是的:</h2><p id="0737" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">一个Javascript模式构建器和验证器，允许您定义JSON模式、转换值、指定必填字段等等。Yup将解析和验证分成不同的步骤，使用起来非常直观。</p><p id="dc04" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated"><strong class="lr ir">检查这个快速示例(<em class="ml">与Formik示例</em>分开):</strong></p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="6979" class="mr ky iq bd kz ms mt dn ld mu mv dp lh ly mw mx lj mc my mz ll mg na nb ln nc bi translated">简单解释一下，因为我想让你们理解这些东西:</h2><ul class=""><li id="91b4" class="nl nm iq lr b ls lt lv lw ly nz mc oa mg ob mk nq nr ns nt bi translated"><strong class="lr ir">第4-12行</strong>:我们通过链接我们的数据类型来定义一个模式(本例中是<em class="ml">对象</em>)。对于每个键，我们指定该键是否是必需的，我们通过链接<code class="fe ne nf ng nh b">positive()</code>函数调用来设置整数的界限，并格式化我们的URL和日期。</li><li id="b2bf" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><strong class="lr ir">第15–22行</strong>:然后我们通过向我们的对象传递实际数据来做一些有效性检查，如果有效性评估为true，我们在<code class="fe ne nf ng nh b">.then</code>函数中执行一些逻辑。</li><li id="2301" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><strong class="lr ir">第25–29行</strong> : <code class="fe ne nf ng nh b">schema.cast</code>基本上将尝试对模式的值进行类型转换。比如说。<code class="fe ne nf ng nh b">age:'24'</code>作为<code class="fe ne nf ng nh b">age: 24</code>输出。</li></ul><p id="c356" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">很简单，对吧？<em class="ml">那么Formik和Yup是如何合作的呢</em>？</p><p id="2d54" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">让我们看看前面的联系表单示例。因为我们已经创建了一个对象数组(<em class="ml">每个对象代表一个HTML输入元素</em>)，现在我们需要开始为我们的表单启动<strong class="lr ir">验证</strong>逻辑。</p><h2 id="c7ea" class="mr ky iq bd kz ms mt dn ld mu mv dp lh ly mw mx lj mc my mz ll mg na nb ln nc bi translated">简洁明了:</h2><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="f372" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">在<code class="fe ne nf ng nh b">useFormik</code>钩子中，我们传入3个东西:</p><ul class=""><li id="7cd4" class="nl nm iq lr b ls mm lv mn ly nn mc no mg np mk nq nr ns nt bi translated">初始值。</li><li id="6817" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated">使用Yup验证模式。这里是我们规定验证规则的地方(<em class="ml">要求，消息长度，电子邮件格式等。</em>)。</li><li id="cdec" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><code class="fe ne nf ng nh b">onSubmit</code>函数，在里面我们可以执行一些用户界面逻辑(显示错误标签等)。).</li></ul><h2 id="1605" class="mr ky iq bd kz ms mt dn ld mu mv dp lh ly mw mx lj mc my mz ll mg na nb ln nc bi translated">然后，我们简单地呈现我们的表单:</h2><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="8781" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">我们映射字段数组，并使用简洁的简写方式传递每个元素:<code class="fe ne nf ng nh b">{...el}</code>。我们另外传入一些额外的道具。</p><p id="712c" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">他们在这里，他们做什么</p><ul class=""><li id="0d76" class="nl nm iq lr b ls mm lv mn ly nn mc no mg np mk nq nr ns nt bi translated"><code class="fe ne nf ng nh b">key</code> =每个单独元素的唯一标识符(罩下的<em class="ml"/>)。</li><li id="caf6" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><code class="fe ne nf ng nh b">onChange</code> =变更的通用事件处理程序。这将更新<code class="fe ne nf ng nh b">values[key]</code>，其中<code class="fe ne nf ng nh b">key</code>表示输入的<code class="fe ne nf ng nh b">name</code>属性。</li><li id="0246" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><code class="fe ne nf ng nh b">value</code> =查找输入的<code class="fe ne nf ng nh b">name</code>属性的必需值。</li><li id="f749" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><code class="fe ne nf ng nh b">errors</code> =使用输入的<code class="fe ne nf ng nh b">name</code>属性触发<code class="fe ne nf ng nh b">handleBlur</code>、<code class="fe ne nf ng nh b">handleSubmit</code>等的错误。</li><li id="6fb1" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><code class="fe ne nf ng nh b">name</code> =输入的<code class="fe ne nf ng nh b">name</code>属性的必需值。</li><li id="1891" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><code class="fe ne nf ng nh b">onBlur</code> =当输入失去焦点时触发某些逻辑的函数。</li><li id="2ba7" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><code class="fe ne nf ng nh b">touched</code> =跟踪用户是否触摸了该区域(<em class="ml">点击</em>)。</li></ul><h1 id="0254" class="kx ky iq bd kz la lb lc ld le lf lg lh jw li jx lj jz lk ka ll kc lm kd ln lo bi translated">现在，让我们看看我们的输入字段组件！</h1><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="42a0" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">我们接受从表单组件传入的道具，首先检查我们的元素名称是否是<code class="fe ne nf ng nh b">input</code>。如果是，我们用适当的属性和值等呈现一个输入字段。否则，我们返回一个带有适当属性和值的<code class="fe ne nf ng nh b">textarea</code>。</p><p id="d5b5" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">然后，如果用户在没有输入任何数据或任何不正确数据的情况下点击进入和离开字段(<em class="ml">触摸</em>)，我们会呈现一个错误通知。这就是Formik和Yup大放异彩的地方:)</p><p id="9913" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">所有的验证和错误处理逻辑都是由两个库在幕后执行的，这节省了您的时间、精力和眼泪！记住，我们所做的只是在我们的<code class="fe ne nf ng nh b">useFormik</code>钩子的<code class="fe ne nf ng nh b">validationSchema</code>键中规定一些规则。</p><p id="5961" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">注意，我们有一个单独的<strong class="lr ir">通知小部件组件</strong>(红色)，它根据我们在<strong class="lr ir">第41–43行传递给它的属性动态显示一条消息。</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oc"><img src="../Images/b65bf0aba567202d84ca9e1fad2ea1ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cOwoKwn37JMx9LdA148GVQ.png"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">Screenshot belongs to PJ Codes.</figcaption></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi od"><img src="../Images/fc0f46c4801e4a7aead78d696a76ca13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ow8GuLcTFgtRz-4M8lwU5A.png"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">Screenshot belongs to PJ Codes.</figcaption></figure><h2 id="c2ae" class="mr ky iq bd kz ms mt dn ld mu mv dp lh ly mw mx lj mc my mz ll mg na nb ln nc bi translated">下面是我们的通知小部件的代码:</h2><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="6071" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">在<strong class="lr ir">第6行</strong>上，我们有一个函数<strong class="lr ir">检查来自道具</strong>的通知类型，并且<em class="ml">在我们的<code class="fe ne nf ng nh b">styles</code>对象内调用<strong class="lr ir">第23行</strong> &amp; <strong class="lr ir">第25行</strong>上的那个函数</em>。</p><p id="38ba" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">然后我们在<strong class="lr ir">行34 </strong>返回一个<code class="fe ne nf ng nh b">&lt;p&gt;</code>标签，并传入我们的通知类型、样式规则和错误消息…以及<em class="ml"> violaah </em>。</p><p id="01d7" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">希望这对你有帮助:)</p><p id="5bb6" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">请到—<a class="ae kw" href="https://www.pjcodes.com/" rel="noopener ugc nofollow" target="_blank">PJcodes.com</a>来见我</p><h2 id="77ff" class="mr ky iq bd kz ms mt dn ld mu mv dp lh ly mw mx lj mc my mz ll mg na nb ln nc bi translated">资源</h2><p id="b5b6" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated"><strong class="lr ir">福米克公文</strong>:<a class="ae kw" href="https://formik.org/docs/overview" rel="noopener ugc nofollow" target="_blank">https://formik.org/docs/overview</a></p><p id="7722" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated"><strong class="lr ir">是的官方文件</strong>:<a class="ae kw" href="https://github.com/jquense/yup" rel="noopener ugc nofollow" target="_blank">https://github.com/jquense/yup</a></p><p id="1cbd" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated"><em class="ml">更多内容请看</em><a class="ae kw" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="lr ir"><em class="ml">plain English . io</em></strong></a></p></div></div>    
</body>
</html>