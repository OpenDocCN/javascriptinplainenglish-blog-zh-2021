<html>
<head>
<title>Event Loop in JavaScript: How JavaScript Works Under the Hood</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的事件循环:JavaScript如何在幕后工作</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/event-loop-in-javascript-how-javascript-works-51c7bd73f07?source=collection_archive---------3-----------------------#2021-07-27">https://javascript.plainenglish.io/event-loop-in-javascript-how-javascript-works-51c7bd73f07?source=collection_archive---------3-----------------------#2021-07-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7aa8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">JavaScript是一种单线程语言。换句话说，它一次只能做一件事。JavaScript在单线程上执行所有操作，但是使用一些智能数据结构，给了我们多线程的错觉。<strong class="jp ir">事件循环</strong>是JavaScript异步编程背后的秘密。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/3b08f26f5bb325aabe8ca70fc4f34974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*dyMBJT8pjYBlyelZ.jpeg"/></div></figure><p id="e6e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">JavaScript引擎自上而下执行脚本，创建执行上下文，将函数推入和弹出调用堆栈。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/b913cabcd18c4dd49f5420af0113f258.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*G5GpW93hnJywtYWng1z_Dw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop" rel="noopener ugc nofollow" target="_blank">link</a></figcaption></figure><blockquote class="kz la lb"><p id="efe6" class="jn jo lc jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated"><strong class="jp ir">幕后——奇迹是如何发生的..！！</strong></p></blockquote><p id="37b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Javascript有一些有趣的数据结构，帮助它看起来像一种多线程语言。</p><p id="0848" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">1—</strong>T0】</p><p id="2d11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">随着执行逐行进行，方法调用按执行顺序被推送到调用堆栈上。一旦执行完成，该方法将从堆栈中弹出。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/2958bbdc5aa8e31170d492b4e3989c4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*Vj_UQKsOhbYfiih5X1qv7g.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://www.educative.io/edpresso/what-is-an-event-loop-in-javascript" rel="noopener ugc nofollow" target="_blank">link</a></figcaption></figure><p id="6fa7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">2—</strong>T1】</p><p id="c057" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对象被分配在一个堆中，堆只是一个名称，用来表示一个大的(大部分是非结构化的)内存区域。</p><p id="bf33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">3—</strong>T2】</p><p id="7fa5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">事件队列</strong>负责将新函数发送到轨道进行处理。它遵循队列数据结构来维护所有操作发送执行的正确顺序。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/1dc4eec5678334105cc3408637b2ced1.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CRdNgF35zbRnxXt1HxX25g.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://www.educative.io/edpresso/what-is-an-event-loop-in-javascript" rel="noopener ugc nofollow" target="_blank">link</a></figcaption></figure><p id="22a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop#event_loop" rel="noopener ugc nofollow" target="_blank">事件循环</a>的某个时刻，运行时开始处理队列中的消息，从最老的开始。为此，从队列中删除消息，并使用该消息作为输入参数调用其相应的函数。像往常一样，调用一个函数会创建一个新的堆栈框架供该函数使用。</p><p id="735f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每当调用一个异步函数时，它就被发送到一个<em class="lc">浏览器API </em>。这些是浏览器内置的API。根据从调用堆栈收到的命令，API启动自己的单线程操作。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi lm"><img src="../Images/157260c8e157ef0439f9a86aa6bce2db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*iF8sxHKMSohnN2tUsNpKkw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://blog.sessionstack.com/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5" rel="noopener ugc nofollow" target="_blank">link</a></figcaption></figure><blockquote class="kz la lb"><p id="48ec" class="jn jo lc jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated"><strong class="jp ir">事件循环是做什么的？</strong></p></blockquote><p id="cc26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">事件循环有一个简单的任务——监视调用堆栈和回调队列。如果调用堆栈为空，事件循环将从队列中取出第一个事件，并将它推送到调用堆栈，调用堆栈将有效地运行它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/2ae24d06f1db862d8fe885dd8da1b604.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*0Br6IQB-H37VEgcvVQpGHw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://blog.sessionstack.com/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5" rel="noopener ugc nofollow" target="_blank">link</a></figcaption></figure><p id="e44c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样的迭代在事件循环中被称为<strong class="jp ir">滴答</strong>。每个事件只是一个函数回调。</p><blockquote class="kz la lb"><p id="a7d0" class="jn jo lc jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated"><strong class="jp ir">例子</strong></p></blockquote><p id="9a36" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我从<a class="ae ky" href="https://blog.sessionstack.com/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5" rel="noopener ugc nofollow" target="_blank">这里</a>拿了这个绝妙的例子。这是我目前为止看到的最好的解释。<br/>我就在这里浓缩一下。</p><pre class="km kn ko kp gt ls lj lt lu aw lv bi"><span id="d755" class="lw lx iq lj b gy ly lz l ma mb">console.log(‘Hi’);<br/>setTimeout(function cb1() { <br/>  console.log(‘cb1’);<br/>}, 5000);<br/>console.log(‘Bye’);</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi mc"><img src="../Images/64e62bb8b0cf49b6477267d05e71eed3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8umD8xblDHU1O1kiiwcFCA.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi md"><img src="../Images/81deb0b9a81cea889d7289f9d85fc1f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9-mxBLYXA5BAWdBu.gif"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://blog.sessionstack.com/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5" rel="noopener ugc nofollow" target="_blank">link</a></figcaption></figure><h2 id="4a68" class="lw lx iq bd me mf mg dn mh mi mj dp mk jy ml mm mn kc mo mp mq kg mr ms mt mu bi translated"><strong class="ak">来源和好读物</strong></h2><p id="761a" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated"><a class="ae ky" href="https://blog.sessionstack.com/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5" rel="noopener ugc nofollow" target="_blank">https://blog . session stack . com/how-JavaScript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f 077 c 4438 b 5</a></p><p id="6d37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae ky" href="https://www.educative.io/edpresso/what-is-an-event-loop-in-javascript" rel="noopener ugc nofollow" target="_blank">https://www . educative . io/edpresso/what-a-event-loop-in-JavaScript</a></p><p id="0a38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae ky" href="https://www.javascripttutorial.net/javascript-event-loop/" rel="noopener ugc nofollow" target="_blank">https://www.javascripttutorial.net/javascript-event-loop/</a></p><p id="15e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/JavaScript/event loop</a></p><p id="2ce1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lc">更多内容请看</em><a class="ae ky" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="lc">plain English . io</em></strong></a></p></div></div>    
</body>
</html>