<html>
<head>
<title>Create a React Component for More/Less Text Transition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为更多/更少文本过渡创建一个React组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-a-react-component-for-more-less-text-transition-b8896f098773?source=collection_archive---------0-----------------------#2021-11-05">https://javascript.plainenglish.io/create-a-react-component-for-more-less-text-transition-b8896f098773?source=collection_archive---------0-----------------------#2021-11-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="133a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">许多网络应用程序的一个共同特点是让用户体验一下内容，然后允许他们切换查看更多内容。在这篇文章中，我们将看到如何创建一个平滑的显示更多/更少的文本切换过渡效果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3e2090df6620ed656d9b7532bc4cd9d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aGuc6R-QJkEj4Bzk"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@mdisc?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Michael Discenza</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="3e57" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">先决条件</h1><p id="cfbb" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">希望您对Javascript、React和CSS有基本的了解。要按照本文构建组件，您需要在机器上安装以下应用程序。版本是我运行的当前版本，但不一定需要匹配。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="a8c4" class="mh la in md b gy mi mj l mk ml">git v2.30.2<br/>node v12.19.0<br/>npm v8.1.2<br/>create-react-app v4.0.3</span></pre><p id="bd66" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们也应该清楚为什么我们要把我们的转换建立在高度之上。使用<code class="fe mm mn mo md b">max-height</code>属性可以创建类似的效果，其中最大高度被设置为某个值，而<strong class="jm io">不应该</strong>被设置。这有一个关键问题:为了给出一致的过渡速度，您需要设置一个不太高的高度，以便效果不会被过分强调。要做到这一点，同时足够高而不会导致滚动条出现在文本显示区域，通常会导致大量的手挥舞，以最大高度的神奇数字结束，最终成为没有人，包括你自己，想要触摸或改变的代码。</p><p id="0339" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了正确地应用<code class="fe mm mn mo md b">transition</code> CSS，你可以注意使用属性值<code class="fe mm mn mo md b">auto</code>，因此为了使用height，我们需要确定显示我们想要显示的所有文本所需的高度。</p><p id="2ae3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了避免<code class="fe mm mn mo md b">max-height</code>过渡，这篇文章将介绍基于<code class="fe mm mn mo md b">height</code>的过渡，以及如何设置相应的高度。</p><h1 id="5e9e" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">创建应用程序</h1><p id="c554" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">虽然您可以在现有的应用程序中构建这个组件，但是对于本文来说，我们将使用create-react-app npm包生成一个新的应用程序。为此，运行命令<code class="fe mm mn mo md b">create-react-app more-leass-medium-app</code>。在整篇文章中，应用程序的名称将是<strong class="jm io"> more-less-medium-app </strong>。</p><h2 id="0eac" class="mh la in bd lb mp mq dn lf mr ms dp lj jv mt mu ln jz mv mw lr kd mx my lv mz bi translated">应用清理</h2><p id="3895" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">当应用程序生成时，它会添加许多我们不会使用的额外内容，因此我们可以在开始构建之前删除并清理应用程序。首先，在<strong class="jm io"> package.json </strong>中，所有与测试相关的命令和依赖项都可以删除，因为我们不打算在本文中进行测试。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/4c41395f416868b16801687049fe5ff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a8B1A0HIhke2zlVhv07OSQ.png"/></div></div></figure><p id="b41d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，在<strong class="jm io"> src/App.js </strong>文件中，整个文件可以替换为下面的代码片段。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="3bd4" class="mh la in md b gy mi mj l mk ml">const App = () =&gt; {<br/>  return (<br/>    &lt;div className="root"&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};<br/>export default App;</span></pre><p id="cf5a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有几个文件是不需要的。都可以删除:<strong class="jm io"> yarn.lock </strong> <strong class="jm io"> App.css </strong>，<strong class="jm io"> logo.svg </strong>，<strong class="jm io"> reportWebVitals.js </strong>，<strong class="jm io"> App.test.js </strong>，<strong class="jm io"> setupTests.js </strong>。删除所有这些文件后，您可以删除旧的节点模块，重新安装应用程序，然后使用以下命令检查所有更改:</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="7550" class="mh la in md b gy mi mj l mk ml">rm -rfv node_modules<br/>npm install --verbose<br/>git status</span></pre><p id="ceb5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您应该会在文件中看到以下更改。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/5587bb71a48539c9a0c75da231f28fb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NVEDtQAmf4JLKCE4_AwB5w.png"/></div></div></figure><p id="9d11" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">运行<code class="fe mm mn mo md b">git add . &amp;&amp; git commit -m "cleanup app"</code>准备并提交我们刚刚做的所有更改，开始创建组件。</p></div><div class="ab cl nc nd hr ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ig ih ii ij ik"><h1 id="7f1c" class="kz la in bd lb lc nj le lf lg nk li lj lk nl lm ln lo nm lq lr ls nn lu lv lw bi translated">构建组件</h1><p id="2d4f" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">现在我们可以开始构建包含我们组件的应用程序了。我们要做的第一步是为根容器设置CSS。我们将使用<strong class="jm io"> src/index.css </strong>文件，它可以完全替换为以下代码片段。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="42d0" class="mh la in md b gy mi mj l mk ml">.root {<br/>  background-color: lightgray;<br/>  margin: 12px auto;<br/>  min-height: 100px;<br/>  padding: 4px;<br/>  width: 600px;<br/>}</span></pre><p id="0c70" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦添加了CSS，您就可以通过在终端中运行<code class="fe mm mn mo md b">npm run start</code>来启动应用程序。您的默认浏览器应该在端口3000上对本地主机开放。如果没有自动打开，可以直接导航到<a class="ae ky" href="http://localhost:3000." rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>。您应该会看到类似于以下屏幕帽的内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/88a1cc654b57b50db1c08dd2df000cc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8rcuPLnamZ9ni7Rktqh79g.png"/></div></div></figure><p id="3c2a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在确认基本根容器CSS按预期工作后，我们应该提交我们的更改。简单的消息就像，<code class="fe mm mn mo md b">git commit -am "add basic styles"</code>。</p><p id="b9a6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦提交了更改，我们就可以开始添加文本了。为此，我们可以使用一个<strong class="jm io"> lorem ipsum </strong>生成器:<a class="ae ky" href="https://www.lipsum.com/" rel="noopener ugc nofollow" target="_blank">https://www.lipsum.com/</a>。我们应该获取足够的lorem ipsum来创建覆盖页面上大约10行的副本。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/1775b26772df63749419e1c4628aa517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SMoqOPRxHATru5Wcu4EI3w.png"/></div></div></figure><p id="264f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">通过这些代码更改，localhost应该会更新，您的显示将如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/5a00d4d3e489cddea9994480e5874fac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2zGfvOjznP0GmXiMpMSbxw.png"/></div></div></figure><p id="fe42" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里是提交更改的另一个好地方。另一个简单的消息也应该在这里起作用:<code class="fe mm mn mo md b">git commit -am "add lorem ipsum copy"</code>。</p><p id="a18a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们在文本下面添加一个切换按钮，我们最终将使用它来显示更多或更少的文本。我们可以直接在<strong class="jm io"> src/App.js </strong>文件的顶部添加切换按钮。切换按钮代码将类似于下面的代码片段。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="1c35" class="mh la in md b gy mi mj l mk ml">const ToggleButton ({ isExpanded, onClick }) =&gt; {<br/>  return (<br/>    &lt;button className="btn-toggle" onClick={onClick}&gt;<br/>      {isExpanded ? "Show Less" : "Show More"}<br/>    &lt;/button&gt;<br/>  );<br/>};</span></pre><p id="5950" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">切换按钮样式非常简单，可以添加到<strong class="jm io"> src/index.css </strong>中。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="6c8f" class="mh la in md b gy mi mj l mk ml">.root .btn-toggle {<br/>  margin-top: 4px;<br/>}</span></pre><p id="add2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在实现新代码之前，我们可以用另一个简单的消息<code class="fe mm mn mo md b">git commit -am "add toggle button"</code>提交对<strong class="jm io"> App.js </strong>和<strong class="jm io"> index.css </strong>的更改。</p><p id="f2dd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在让我们将切换按钮添加到现有的根容器中。为此，首先将<code class="fe mm mn mo md b">useState</code>从react导入到组件中。这个钩子将用于跟踪几个状态。现在，我们将添加两个州旗，<code class="fe mm mn mo md b">isExpanded</code>和<code class="fe mm mn mo md b">isOverflow</code>。我们还想添加一个点击处理函数，当它被调用时切换<code class="fe mm mn mo md b">isExpanded</code>标志。用下面的代码片段添加状态和处理程序。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="65e9" class="mh la in md b gy mi mj l mk ml">const App = ({ isLongCopy = true }) =&gt; {<br/>  const text = `${copyStart} ${isLongCopy ? copyEnd : ""}`;<br/>  // new state variables<br/>  const [isExpanded, setIsExpanded] = useState(false);<br/>  const [isOverflow, setIsOverflow] = useState(false);</span><span id="afd1" class="mh la in md b gy nr mj l mk ml">  const handleClickBtn = () =&gt; {<br/>    setIsExpanded((prev) =&gt; !prev);<br/>  };<br/>  ...</span></pre><p id="a59f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在将<strong class="jm io"> ToggleButton </strong>组件添加到return中。根据<code class="fe mm mn mo md b">isOverflow</code>标志，动态渲染组件。我们还将<code class="fe mm mn mo md b">isExpanded</code>标志和点击处理函数作为道具传递到组件中。return语句应该类似于下面的屏幕cap。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/451a78bacc45dcd563b4192d482cac70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*yXhe_oHzR3-XDMIIPTi5kA.png"/></div></figure><p id="47a0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当标志默认为false时，您在应用程序中看不到任何变化。如果您想看到按钮，您可以将默认值更改为true，但是应该在验证它出现后将其重置为false。一旦添加了所有这些更改，我们应该用命令<code class="fe mm mn mo md b">git commit -am “add dynamic toggle component"</code>提交它们。</p><p id="0a16" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">设置好动态切换后，我们现在要将其功能连接到组件的其余部分。为此，首先我们要将<code class="fe mm mn mo md b">useEffect</code>添加到react的导入中。然后我们要确保我们的<code class="fe mm mn mo md b">text</code>变量是<strong class="jm io"> App </strong>组件函数的第一行。然后我们要设置一个<code class="fe mm mn mo md b">useEffect</code>来监听<code class="fe mm mn mo md b">text</code>变量。现在，<code class="fe mm mn mo md b">useEffect</code>函数可以看起来像下面的代码片段。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="b734" class="mh la in md b gy mi mj l mk ml">useEffect(() =&gt; {<br/>  console.info("TODO - implement text useEffect");<br/>}, [text]);</span></pre><p id="cd8b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> TODO </strong>实现将是添加到组件的最后一部分。尽管我们只做了一些小的更改，但让我们用一条简单的消息<code class="fe mm mn mo md b">git commit -am "add use effect"</code>再次提交这些更改。</p><p id="c2cf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们可以在CSS中设置文本显示区域样式，并添加内联样式来设置文本显示区域的高度。对于CSS，添加以下代码片段。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="9363" class="mh la in md b gy mi mj l mk ml">.root .text-display {<br/>  font-size: 16px;<br/>  line-height: 18px;<br/>  overflow: hidden;<br/>  transition: height 0.5 ease-in-out;<br/>}</span></pre><p id="89cc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mm mn mo md b">font-size</code>和<code class="fe mm mn mo md b">line-height</code>属性是专门设置的，以便在折叠时，最多显示四行文本，其余的隐藏起来。<code class="fe mm mn mo md b">overflow: hidden</code>属性实际上隐藏了前四行。使用<code class="fe mm mn mo md b">height</code>的<code class="fe mm mn mo md b">transition</code>属性已经在文章的顶部解释过了。但要重申的是，当切换展开/折叠值时，它给我们一种清晰一致的感觉。现在我们用这段代码创建一个当前高度状态变量。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="4a96" class="mh la in md b gy mi mj l mk ml">const [heightCurr, setHeightCurr] = useState(72);</span></pre><p id="a660" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们使用值72，这是我们想要使用的默认高度值，它将与上面CSS中设置的<code class="fe mm mn mo md b">line-height</code>值一起工作，以便隐藏任何穿过第四行文本的文本。创建状态后，使用以下代码片段的内联样式设置当前高度状态。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="091a" class="mh la in md b gy mi mj l mk ml">&lt;div className="text-display" style={{ height: `${heightCurr}px` }}&gt;</span></pre><p id="d037" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">经过这些更改，当我们刷新应用程序并显示长副本时，现在应该在localhost上呈现以下内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/549047db63b6571159e7438c730a3acc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ChhrX-1COQLWzaXE1aWBRg.png"/></div></div></figure><p id="95fa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此时，您可以提交您的更改:<code class="fe mm mn mo md b">git commit -am "setup initial height and display styling"</code>。</p><h2 id="1015" class="mh la in bd lb mp mq dn lf mr ms dp lj jv mt mu ln jz mv mw lr kd mx my lv mz bi translated">创建切换效果</h2><p id="2ba0" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">现在，我们可以设置逻辑来确定是否需要显示展开/折叠按钮，并显示有限和全文版本。第一步是添加两个状态来跟踪高度:<code class="fe mm mn mo md b">heightMax</code>和<code class="fe mm mn mo md b">heightMin</code>。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="bb16" class="mh la in md b gy mi mj l mk ml">const [heightMax, setHeightMax] = useState(72);<br/>const [heightMin, setHeightMin] = useState(72);</span></pre><p id="80d2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将“最大高度”和“最小高度”的初始值设定为“最大”，与默认的当前高度值相同。下一步是点击切换按钮，在最小和最大高度之间切换。当单击切换按钮且文本当前展开时，将当前高度设置为折叠文本的最小值。否则，将当前高度设置为最大以扩展文本。您可以在当前高度设置器函数中使用三元语句来实现这一点。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="9916" class="mh la in md b gy mi mj l mk ml">const hendleClickBtn = () =&gt; {<br/>  setHeightCurr(isExpanded ? heightMin : heightMax);<br/>  setIsExpanded((prev) =&gt; !prev);<br/>};</span></pre><p id="fecf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此时，我们不会在应用程序中看到任何明显的变化，但是您可以提交我们所做的更改:<code class="fe mm mn mo md b">git commit -am "add state and toggle effect for min/max height"</code>。</p><p id="f509" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">启用切换效果的最后一步是更新监听<code class="fe mm mn mo md b">text</code>变量变化的<code class="fe mm mn mo md b">useEffect</code>。在<code class="fe mm mn mo md b">useEffect</code>内，我们将执行以下步骤</p><ul class=""><li id="afe2" class="nt nu in jm b jn jo jr js jv nv jz nw kd nx kh ny nz oa ob bi translated">查询页面中的<code class="fe mm mn mo md b">.text-display</code>类元素</li><li id="915d" class="nt nu in jm b jn oc jr od jv oe jz of kd og kh ny nz oa ob bi translated">确定元件的<code class="fe mm mn mo md b">clientHeight</code>和<code class="fe mm mn mo md b">scrollHeight</code>值</li><li id="f701" class="nt nu in jm b jn oc jr od jv oe jz of kd og kh ny nz oa ob bi translated">当这些高度不同时，更新元件状态</li></ul><p id="d75c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对组件状态的更新首先将<code class="fe mm mn mo md b">isOverflow</code>标志切换为真。然后<code class="fe mm mn mo md b">scrollHeight</code>被设置为最大高度状态，并且<code class="fe mm mn mo md b">clientHeight</code>被设置为当前高度和最小高度。这是那个函数更新后的代码片段。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="fbb7" class="mh la in md b gy mi mj l mk ml">useEffect(() =&gt; {<br/>  const element = document.querySelector(".text-display");<br/>  const clientHeight = element?.clientHeight || 72;<br/>  const scrollHeight= element?.scrollHeight || 72;<br/>  if (scrollHeight &gt; clientHeight) {<br/>    setIsOverflow(true);<br/>    setHeightMax(scrollHeight);<br/>    setHeightMin(clientHeight);<br/>    setHeightCurr(clientHeight);<br/>  }<br/>}, [text]);</span></pre><p id="d728" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请注意，当获取元素的高度时，如果在尝试查找元素或确定元素的高度时发生了一些问题，我们使用带有逻辑OR的可选链接来设置默认值。此时，刷新本地主机将有一个功能正常、可切换的文本显示区域。这是运行中的组件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/df96e76616bb2db5074e2a640a7b597a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/1*x3P2Fhz6M0z3YdasOCQRAQ.gif"/></div></figure><h2 id="6421" class="mh la in bd lb mp mq dn lf mr ms dp lj jv mt mu ln jz mv mw lr kd mx my lv mz bi translated">结论</h2><p id="eb65" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">就是这样。我们现在有了一个功能组件，可以根据文本显示区域的高度切换和转换显示更多或更少的文本。要查看代码，您可以使用完成的项目<a class="ae ky" href="https://github.com/cameronDz/more-less-medium-app" rel="noopener ugc nofollow" target="_blank">来检查我的存储库。</a></p><p id="3179" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦构建好这个组件，您也可以自己添加一些增强功能。传文当道具是个不错的。你还可以添加一些效果，让它在折叠时更平滑/更闪亮(显示更少)，比如添加<code class="fe mm mn mo md b">text-overflow</code>和<code class="fe mm mn mo md b">line-clamp</code>属性，或者使用<code class="fe mm mn mo md b">-webkit-mask-image</code>属性添加<code class="fe mm mn mo md b">linear-gradient</code>。</p><p id="ace6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">希望你从这篇文章中获得了乐趣。祝你好运，并快乐编码。</p><p id="94da" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="oi">更多内容请看</em><a class="ae ky" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="oi">plain English . io</em></strong></a></p></div></div>    
</body>
</html>