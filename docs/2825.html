<html>
<head>
<title>How to Add Analytics to your React Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何向React应用程序添加分析</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/adding-analytics-to-your-react-application-b584265f9fae?source=collection_archive---------3-----------------------#2021-06-09">https://javascript.plainenglish.io/adding-analytics-to-your-react-application-b584265f9fae?source=collection_archive---------3-----------------------#2021-06-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="f2fd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用Amplitude的npm库</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f0b35800e742dcdb33663e76b89130d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RIpXYT-xmKpeXK8hvxgWHQ.png"/></div></div></figure><h1 id="4217" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">振幅</h1><p id="0ced" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">Amplitude是一家数据分析初创公司，旨在让向网络或移动应用添加分析变得简单易行。这是一家Y Combinator公司，并得到了红杉等一些大型风险投资公司的支持。</p><p id="9696" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">由于其有效性和简单性，他们在疫情期间看到了客户增长的巨大繁荣，以及随之而来的估值的大幅上升(在撰写本文时最近估值为40亿美元)。</p><p id="a6e4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所有这些原因(简单性、定制选项、干净的用户界面、在行业中的广泛采用)是我的公司选择使用它们来处理React应用程序上的数据分析的原因。以下是您将它添加到您的邮箱中的方法:</p><h1 id="0ec7" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">注册</h1><p id="f741" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">第一步将是在<a class="ae lx" href="https://amplitude.com/" rel="noopener ugc nofollow" target="_blank"> Amplitude的网站</a>上注册试用。你需要创建一个帐户，并提供一些关于你的公司/应用程序的基本信息。</p><p id="66c7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦您创建了一个帐户，您将被带到仪表板，在那里您的所有数据都将存在。它看起来会像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ly"><img src="../Images/892e652df8bb206ee859cfdfe7f15046.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xq8FSN9JXUs6A2Wf775tIg.png"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk">Source: <a class="ae lx" href="https://analytics.amplitude.com/login/my-demo" rel="noopener ugc nofollow" target="_blank">https://analytics.amplitude.com/login/my-demo</a></figcaption></figure><p id="8121" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这里，您可以访问一些极其重要的信息，如每日、每周和每月活跃用户的数量，以及这些趋势是如何随着时间的推移而演变的。</p><p id="2216" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你还可以看到一些信息，比如用户留存率、花在应用上的时间、各种营销活动的转换率，以及你的网站或登陆页面的A/B测试结果。你甚至可以微调结果，例如，如果你想查看从Twitter访问你的应用程序的用户数量，以及点击你的应用程序至少2个页面的用户数量，你可以使用Amplitude dashboard查看！</p><h1 id="7bf9" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">与React集成</h1><p id="ce23" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">将振幅跟踪添加到您的应用程序的最简单方法是通过他们的<a class="ae lx" href="https://www.npmjs.com/package/amplitude-js" rel="noopener ugc nofollow" target="_blank"> npm包</a>。只需运行:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="5457" class="mi kv in me b gy mj mk l ml mm">npm i amplitude-js</span></pre><p id="073e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后在React应用程序中创建一个名为“amplitude.js”的文件</p><p id="eb2a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在内部添加以下内容:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="c5da" class="mi kv in me b gy mj mk l ml mm">import amplitude from "amplitude-js";</span><span id="1e3a" class="mi kv in me b gy mn mk l ml mm">//Code to import config info about your app</span><span id="ec99" class="mi kv in me b gy mn mk l ml mm">import { env } from "services/configs";</span><span id="e5ad" class="mi kv in me b gy mn mk l ml mm">const API_KEY =</span><span id="9c2a" class="mi kv in me b gy mn mk l ml mm">env === "app"</span><span id="22a6" class="mi kv in me b gy mn mk l ml mm">? "PRODUCTION_API_KEY_HERE"</span><span id="2233" class="mi kv in me b gy mn mk l ml mm">: "DEV_API_KEY_HERE";</span><span id="a1b6" class="mi kv in me b gy mn mk l ml mm">//If you only have one environment, just put the single API key</span><span id="36b2" class="mi kv in me b gy mn mk l ml mm">amplitude.getInstance().init(API_KEY, null, {</span><span id="a166" class="mi kv in me b gy mn mk l ml mm">// optional configuration options</span><span id="8cb7" class="mi kv in me b gy mn mk l ml mm">  includeUtm: true,</span><span id="884a" class="mi kv in me b gy mn mk l ml mm">  includeGclid: true,</span><span id="a30f" class="mi kv in me b gy mn mk l ml mm">  includeReferrer: true,</span><span id="65f3" class="mi kv in me b gy mn mk l ml mm">});</span><span id="df2b" class="mi kv in me b gy mn mk l ml mm">export { amplitude };</span></pre><p id="742f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以让我们解开这段代码。</p><p id="d6bd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在顶部，我从configs文件夹中导入了一个名为env的东西。这是我的应用程序的配置文件，包含了一些关于我如何加载它的信息。它包含一些API密钥和我的数据库的信息，但也包含这行代码:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="53a9" class="mi kv in me b gy mj mk l ml mm">export const env = process.env.REACT_APP_ENV;</span></pre><p id="1d8e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果设置正确，这将提供关于您的React应用程序当前使用的环境的信息。在我的例子中，它只有两种可能性“dev”(用于开发，非实时环境)或“app”(用于真正的实时部署应用)。</p><p id="2cfa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，您将需要您的API密钥。根据您工作的环境，您可能设置了不同的振幅项目，每个项目都有自己的调。你可以在你的项目的<a class="ae lx" href="https://help.amplitude.com/hc/en-us/articles/360043750992" rel="noopener ugc nofollow" target="_blank">设置页面</a>找到钥匙。确保用项目的正确密钥替换上面的字符串。</p><p id="e051" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，您有一个options对象，您可以传递init函数来加载带有某些特性的振幅。</p><p id="df35" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里列出了所有可能的选项及其描述。在我的例子中，我使用includeUtm、includeGclid和includeReferrer选项进行初始化。</p><p id="3e7e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后，您只想在文件底部导出这个初始化的振幅对象。这将是您导入到您的应用程序中以添加事件跟踪的内容。</p><h2 id="4514" class="mi kv in bd kw mo mp dn la mq mr dp le jv ms mt li jz mu mv lm kd mw mx lq my bi translated">向组件添加跟踪</h2><p id="b738" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">现在，无论您想在哪里使用振幅跟踪，您都需要确保在代码的顶部导入新创建的振幅对象(如果它与我的不匹配，请确保放置正确的文件路径)。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="3bb4" class="mi kv in me b gy mj mk l ml mm"><strong class="me io">import { amplitude } from "components/amplitude";</strong></span><span id="a8b3" class="mi kv in me b gy mn mk l ml mm">import logo from './logo.svg';</span><span id="80d9" class="mi kv in me b gy mn mk l ml mm">import './App.css';</span><span id="97e8" class="mi kv in me b gy mn mk l ml mm">function App() {</span><span id="3938" class="mi kv in me b gy mn mk l ml mm">return (<br/>  &lt;div className="App"&gt;<br/>    &lt;div&gt; My App &lt;/div&gt;<br/>  &lt;/div&gt;<br/>  );<br/>}</span><span id="b87f" class="mi kv in me b gy mn mk l ml mm">export default App;</span></pre><p id="65f4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">假设您想要跟踪电子商务应用程序中购物车按钮被点击的次数。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="0ce8" class="mi kv in me b gy mj mk l ml mm"><strong class="me io">import { amplitude } from "components/amplitude";</strong></span><span id="8907" class="mi kv in me b gy mn mk l ml mm">import logo from './logo.svg';<br/>import ItemCard from 'components/ItemCard';</span><span id="7b8e" class="mi kv in me b gy mn mk l ml mm">import './App.css';</span><span id="870d" class="mi kv in me b gy mn mk l ml mm">function App() {</span><span id="bc7d" class="mi kv in me b gy mn mk l ml mm">displayItems = () =&gt; {<br/>  props.items.map(item =&gt; &lt;ItemCard name=item.name/&gt;<br/>}</span><span id="f9b1" class="mi kv in me b gy mn mk l ml mm"><strong class="me io">logClick = () =&gt; {<br/>  </strong><strong class="me io">amplitude.getInstance().logEvent('cartButtonClicked', itemsInCart)<br/></strong><strong class="me io">}</strong></span><span id="a84f" class="mi kv in me b gy mn mk l ml mm">return (<br/>  &lt;div className="App"&gt;<br/>    &lt;h1&gt;My E-Commerce Store&lt;/h1&gt;<br/>      {displayItems}<br/>      &lt;Button onClick={<strong class="me io">logClick</strong>}&gt; Add to Cart &lt;/Button&gt;</span><span id="a2f9" class="mi kv in me b gy mn mk l ml mm">  &lt;/div&gt;<br/>  );<br/>}</span><span id="9254" class="mi kv in me b gy mn mk l ml mm">export default App;</span></pre><p id="3e76" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，您可以将类似这样的内容添加到您的代码中，每次单击按钮时，它都会记录一个“cartButtonClicked”类型的事件，然后跟踪用户购物车中的所有商品。</p><p id="2038" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">发挥创造力，你就可以追踪各种事物。</p><p id="0b31" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">很多人也用它来跟踪错误。</p><p id="c774" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">假设您想要跟踪某个广告活动的用户注册。您可以在代码中添加这样的内容，其中状态3表示用户已完成注册:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="bb21" class="mi kv in me b gy mj mk l ml mm">&lt;Route</span><span id="8956" class="mi kv in me b gy mn mk l ml mm">{...rest}<br/>  render={(routeProps) =&gt; {<br/>    if (RedirectComponent &amp;&amp; status !== 3) {<br/>      return &lt;RedirectComponent {...props} {...routeProps} /&gt;;<br/>    } else if (status === 0) {<br/>      return &lt;NotLoggedIn /&gt;;<br/>    } else if (status === 1 || status === 2) {<br/>      return &lt;Redirect to="/onboarding" /&gt;;<br/>    } else if (status === 3) {<br/>      analyticsMessage &amp;&amp; analytics.logEvent(analyticsMessage);<br/>      analyticsMessage &amp;&amp;<br/>        <strong class="me io">amplitude.getInstance().logEvent(analyticsMessage)</strong>;<br/>    return &lt;Component {...props} {...routeProps} /&gt;;<br/>    }<br/>  }}<br/>/&gt;</span></pre><p id="7617" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，如果用户处于状态3，事件将被记录到振幅中，以便您可以跟踪转换率。</p><p id="4332" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mz">更多内容尽在</em><a class="ae lx" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank">T5】plain English . ioT7】</a></p></div></div>    
</body>
</html>