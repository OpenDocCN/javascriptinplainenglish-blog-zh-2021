<html>
<head>
<title>7 Steps to Modernize and Optimize Your React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实现React应用现代化和优化的7个步骤</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/7-steps-to-modernize-and-optimize-your-react-app-466cbea51b8f?source=collection_archive---------1-----------------------#2021-05-15">https://javascript.plainenglish.io/7-steps-to-modernize-and-optimize-your-react-app-466cbea51b8f?source=collection_archive---------1-----------------------#2021-05-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/0cf23b84bceec4ab3c3bfb7878471881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DWLDMsHwL5ydstgG"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@flowforfrank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ferenc Almasi</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="ka kb kc"><p id="76fd" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">由于前端环境和社区的性质，工具和技术堆栈正在快速转变。这些转变旨在为开发者和最终用户提供更好的体验。由于开发人员每天面临的挑战，心态得到了改善。这些经验带来了高度参与的社区方法的进步，产生了在可伸缩性、性能和适应性方面更好的应用。</p></blockquote><p id="5b3b" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">在这种变化速度下，并不是每个应用都能成功保持其流通性。即使这是你的应用程序或你刚开始工作的公司的应用程序，你也需要重构应用程序，以拥有更现代的方法和策略。</p><p id="b665" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">我和我在<a class="ae jz" href="https://oplog.com.tr/" rel="noopener ugc nofollow" target="_blank"><strong class="kg io"><em class="kf">OPLOG</em></strong></a><strong class="kg io"><em class="kf"/></strong>的团队现在就在这个现代化的进程中。该应用程序的代码库建立于2018年，出于某种原因，主要结构自那以来一直没有改变。我们的目标是使我们的应用适应前端世界的最新发展，并增加开发者和最终用户的体验。对于相关人员，我们的技术堆栈是<a class="ae jz" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank"> TypeScript </a>、<a class="ae jz" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> ReactJS </a>、<a class="ae jz" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>、<a class="ae jz" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> Jest </a> - <a class="ae jz" href="https://enzymejs.github.io/enzyme/" rel="noopener ugc nofollow" target="_blank">酵素</a>、<a class="ae jz" href="https://styled-system.com/" rel="noopener ugc nofollow" target="_blank">风格化系统(CSS-in-Props) </a>、<a class="ae jz" href="https://bradfrost.com/blog/post/atomic-web-design/" rel="noopener ugc nofollow" target="_blank">原子设计</a>。</p><p id="b7bf" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">下面，我将分享我们遵循的步骤，以及我们经历的原因和不可理解的影响。</p></div><div class="ab cl lf lg hr lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ig ih ii ij ik"><h2 id="7b1c" class="lm ln in bd lo lp lq dn lr ls lt dp lu lc lv lw lx ld ly lz ma le mb mc md me bi translated">1)将有类组件转换为功能组件</h2><blockquote class="ka kb kc"><p id="5991" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">作为React 16.8我们遇到了React钩子。在此之前，为了使用生命周期方法，我们使用有类组件。在钩子的帮助下，我们可以拥有类组件对于功能组件的所有能力。</p></blockquote><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mf"><img src="../Images/2926fba86ad4840c2e41615b53e6cbcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0zuThBNQf3EAdxMZ"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@flowforfrank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ferenc Almasi</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="49c1" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">由于基本输入输出机制的性质和钩子的力量，react社区建议在每个秤应用中使用功能组件。此外，大多数流行的库都建立了定制的钩子，以避免在HOC中注入道具。</p><p id="a33d" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">借助将有类组件转换为功能组件的简易性，我们已经在很短的时间内转换了应用程序中的所有组件。通过这样做，我们为应用程序现代化的下一步奠定了基础。</p></div><div class="ab cl lf lg hr lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ig ih ii ij ik"><h2 id="6337" class="lm ln in bd lo lp lq dn lr ls lt dp lu lc lv lw lx ld ly lz ma le mb mc md me bi translated">2)重新设计文件结构，将组件分解成更小的部分</h2><blockquote class="ka kb kc"><p id="b9b5" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">当我们谈到可伸缩性和可维护性时，文件结构是最关键的一点。</p></blockquote><p id="15fa" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">我们使用Brad Frost的原子设计方法来设计我们的组件结构。我们有原子、分子、有机体、页面和模板。你可以阅读Brad Frost的博客页面，了解更多关于原子设计方法论的想法。</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/67a5355ca4ed7217cb9e1481791f3d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uo5tF1reZzfhzjkkGVtlvw.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Atomic Design Methodology by <a class="ae jz" href="https://bradfrost.com/blog/post/extending-atomic-design/" rel="noopener ugc nofollow" target="_blank">Brad Frost</a></figcaption></figure><p id="dbec" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">作为一个团队，我们非常喜欢这种方法。感觉很有条理，很容易确定哪些组件放在哪里。在WMS(仓库管理系统)领域编码近两年后，它也证明了自己的可伸缩性。找到你正在寻找的代码块并操作它是非常舒适的。</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/5c5da9611bdd05f2cf3bfeb54ba74aaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*6MFgo29GHShOq0lGBK_kOg.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Atomic Design Methodology with Bones</figcaption></figure><p id="3a1e" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">尽管有这些积极的观点，但组件的大小还是有问题。与业务逻辑或设计需求相关，组件代码的行数可能会增加1000多行。</p><p id="18e1" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">为了解决这个问题，我们在系统中添加了另一个文件夹，我们称之为<strong class="kg io">“骨头”</strong>。我们用300行代码限制了组件的长度。如果组件需要300行以上的代码，我们会把它们分成骨骼，这些骨骼是主要组件的较小块，它们有自己的逻辑。这些组件具体属于被划分为骨骼的主要组件。它们不应用于任何其他组件。</p><p id="cf53" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">你可以看到上面的图片，看看我们是如何将<em class="kf"> OrderDetails </em>组件分割成骨骼的。我们还将包含规范文件的“tests”文件夹放在组件的并行文件中。</p><p id="1dbd" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">我们意识到300是一个很好的心理极限，可以拥有更干净易读的原子组件。</p></div><div class="ab cl lf lg hr lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ig ih ii ij ik"><h2 id="6bc5" class="lm ln in bd lo lp lq dn lr ls lt dp lu lc lv lw lx ld ly lz ma le mb mc md me bi translated">3)使用Webpack 5</h2><blockquote class="ka kb kc"><p id="417f" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">有了Webpack 5，我们在Webpack和webpack-dev-server上得到了许多新奇而显著的改进。我们还向微前端基础设施迈进了一步(参见<a class="ae jz" href="https://engineering.telia.no/blog/micro-frontends-with-webpack-module-federation" rel="noopener ugc nofollow" target="_blank">带Webpack模块联盟的微前端</a>)。</p></blockquote><p id="1ddb" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">将详细的webpack 4配置转换到webpack 5是一项颇具挑战性的任务。有许多突破性的变化。幸运的是，webpack团队分享了一份<a class="ae jz" href="https://webpack.js.org/migrate/5/" rel="noopener ugc nofollow" target="_blank">迁移指南</a>以供遵循。经过细致的工作，我们将我们的webpack版本升级到了5，将webpack-dev-server升级到了4。</p><p id="ae86" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">我在另一篇<a class="ae jz" href="https://mucahitgurbuz.medium.com/webpack-4den-5-e-ge%C3%A7i%C5%9F-e89236086ab1" rel="noopener">博客文章</a>中详细分享了我将webpack升级到v5的经历。这个博客是土耳其语的，所以土耳其人可以阅读并应用到他们的项目中。对于其他人，您可以查看以下链接，以便更好地了解webpack 5及其迁移:</p><p id="62ed" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">【https://webpack.js.org/blog/2020-10-10-webpack-5-release/<br/>T5】https://webpack.js.org/migrate/5/<br/><a class="ae jz" href="https://frontend-digest.com/whats-new-in-webpack-5-ef619bb74fae" rel="noopener ugc nofollow" target="_blank">https://frontend-digest . com/whats-new-in-web pack-5-ef 619 bb 74 FAE</a></p><p id="b2f0" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">我将分享我们应用程序的一些结果，包括关键绩效指标的变化。除了指标之外，最终用户和开发人员的体验也有显著改善。</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mm"><img src="../Images/1f87e013cc1365e7886c5c3f46ee5257.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PKnxhcwDBfhptnj0.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Webpack 4.* Lighthouse Values</figcaption></figure><p id="0679" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">您可以在图表中看到几乎100%的改进。此外，webpack 5为更大的改进奠定了基础。</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mm"><img src="../Images/61efb6cef50a476f9118decad1ffd59d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tdMkSexjARBcbsHg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Webpack 5.* Lighthouse Values</figcaption></figure><p id="cd83" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">这次版本升级可能没有那么困难，甚至这可能是将所有库升级到最新版本的好机会。</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mn"><img src="../Images/a234f67412eff90b7e22c733839270fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AyiDQ1a4EhGq3bbE.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">The change in the performance indicators between webpack v4 and v5</figcaption></figure></div><div class="ab cl lf lg hr lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ig ih ii ij ik"><h2 id="f646" class="lm ln in bd lo lp lq dn lr ls lt dp lu lc lv lw lx ld ly lz ma le mb mc md me bi translated">4)将React和TypeScript升级到最新版本</h2><blockquote class="ka kb kc"><p id="283a" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">拥有主要库的最新主要版本总是好的。尽管React 17和TypeScript 4没有突破性的变化，但它们提供了一些不错的特性，并与其他最近升级的库具有对等依赖兼容性。</p></blockquote><p id="13dc" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">在这个现代化过程中，我们已经升级了React(到v17)和TypeScript(到v4)库。</p><p id="f6e5" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">升级TypeScript版本是一项简单的任务。代码库中没有冲突或中断。然而，在React的升级过程中，一些版本过时的库出现了一些对等依赖冲突。</p><p id="6210" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">为了解决这些冲突，必须对这些库进行一些主要的版本升级，这导致了代码库的一些重大变化。正如我前面提到的，这是将您的依赖项升级到最新版本的好机会。</p><p id="edac" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">由于这不在本文的讨论范围内，您可以在下面的博客文章中找到这些升级后所获得的变化:</p><p id="2f22" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">react 17:<a class="ae jz" href="https://betterprogramming.pub/whats-new-in-react-v17-68b7e15576e1" rel="noopener ugc nofollow" target="_blank">https://better programming . pub/whats-new-in-react-v17-68b7e 15576 e 1</a><br/>TypeScript 4:<a class="ae jz" rel="noopener ugc nofollow" target="_blank" href="/features-and-breaking-changes-in-typescript-4-111e6551cd7">https://JavaScript . plain English . io/features-and-breaking-changes-in-TypeScript-4-111 e 6551 CD 7</a></p><p id="1f7a" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">特别是，即时热重新加载功能和不再需要在组件中导入react库是React 17中我们喜欢的两个主要改进。</p></div><div class="ab cl lf lg hr lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ig ih ii ij ik"><h2 id="0ee7" class="lm ln in bd lo lp lq dn lr ls lt dp lu lc lv lw lx ld ly lz ma le mb mc md me bi translated">5)升级react-router并使用其新的基于钩子的函数来导航</h2><p id="46a5" class="pw-post-body-paragraph kd ke in kg b kh mo kj kk kl mp kn ko lc mq kr ks ld mr kv kw le ms kz la lb ig bi translated">我们使用<code class="fe mt mu mv mw b">withRouter</code> HOC将路由器属性注入到组件中，并从组件的属性中读取路由器状态。作为v5.1，我们现在可以使用钩子来访问组件内部的路由器状态和导航器功能。</p><blockquote class="ka kb kc"><p id="d7b6" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">这有助于我们摆脱注入的道具和需要包装组件的特设函数的不必要的复杂性。</p></blockquote><p id="e4fb" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated"><code class="fe mt mu mv mw b">useHistory</code>、<code class="fe mt mu mv mw b">useLocation</code>、<code class="fe mt mu mv mw b">useParams</code>是最受欢迎的挂钩。</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/98f9d321adc5000cd1b19478a426ad30.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*JpuLybvxnZi9cJWe1iy0Zg.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Example usage of the react-router hooks</figcaption></figure><p id="1925" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated"><code class="fe mt mu mv mw b">useHistory</code>钩子让您可以访问<code class="fe mt mu mv mw b"><a class="ae jz" href="https://reactrouter.com/web/api/history" rel="noopener ugc nofollow" target="_blank">history</a></code>实例，您可以用它来导航。<code class="fe mt mu mv mw b">useLocation</code>钩子返回代表当前URL的<code class="fe mt mu mv mw b"><a class="ae jz" href="https://reactrouter.com/web/api/location" rel="noopener ugc nofollow" target="_blank">location</a></code>对象。<code class="fe mt mu mv mw b">useParams</code>返回URL参数的键/值对的对象。</p></div><div class="ab cl lf lg hr lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ig ih ii ij ik"><h2 id="e512" class="lm ln in bd lo lp lq dn lr ls lt dp lu lc lv lw lx ld ly lz ma le mb mc md me bi translated">6)替换或升级您的i18n库，以使用基于钩子的翻译功能</h2><p id="5176" class="pw-post-body-paragraph kd ke in kg b kh mo kj kk kl mp kn ko lc mq kr ks ld mr kv kw le ms kz la lb ig bi translated">我们使用的i18n库是<code class="fe mt mu mv mw b"><a class="ae jz" href="https://formatjs.io/docs/react-intl/" rel="noopener ugc nofollow" target="_blank">react-intl</a></code>。我们需要升级它的两个主要版本，以拥有一个定制的钩子特性来达到组件内部的<code class="fe mt mu mv mw b">intl</code>状态。有太多的突破性变化需要配置。因此，尽管它有足够的能力，但是考虑到易用性和社区支持，我们决定将我们的i18n库迁移到<code class="fe mt mu mv mw b"><a class="ae jz" href="https://www.i18next.com/" rel="noopener ugc nofollow" target="_blank"><strong class="kg io">i18next</strong></a></code>和<code class="fe mt mu mv mw b"><a class="ae jz" href="https://react.i18next.com/" rel="noopener ugc nofollow" target="_blank"><strong class="kg io">react-i18next</strong></a></code>。</p><p id="bcd7" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">迁移过程非常顺利。我们在<code class="fe mt mu mv mw b">i18next</code>中使用了完全相同的翻译文件，并根据我们的需求进行了配置。</p><p id="b833" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">为了从<code class="fe mt mu mv mw b">injectIntl</code> HOC中解放出来，去修改app中的每一个组件。我们已经移除了<code class="fe mt mu mv mw b">injectIntl</code> HOCs，并使用<code class="fe mt mu mv mw b">useTranslation()</code> hook来实现翻译功能。</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi my"><img src="../Images/8130032f8e29d93c7c1712e4f11654e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c_diURKHrTHFjHRkdRhxMg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Before (left) and after (right) of usage of the i18n libraries to translation</figcaption></figure><p id="5f23" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">我们也修改了我们的单元测试，因为有突破性的变化。然而，为用钩子而不是HOC来包装组件的组件编写单元测试要容易得多。</p></div><div class="ab cl lf lg hr lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ig ih ii ij ik"><h2 id="3c0b" class="lm ln in bd lo lp lq dn lr ls lt dp lu lc lv lw lx ld ly lz ma le mb mc md me bi translated">7)对Redux调度程序和选择器使用钩子</h2><blockquote class="ka kb kc"><p id="b297" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">我总是倾向于忘记<code class="fe mt mu mv mw b">mapStateToProps</code>、<code class="fe mt mu mv mw b">mapDispatchToProps</code>和<code class="fe mt mu mv mw b">connect</code>的结构来包装组件。如果您正在使用TypeScript，那么您总是需要从其他组件中进行复制，这可能会更加混乱。此外，当我们看我们想要的东西时，显然有一种多余的复杂性。</p></blockquote><p id="b34c" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">随着<code class="fe mt mu mv mw b"><a class="ae jz" href="https://react-redux.js.org/" rel="noopener ugc nofollow" target="_blank">react-redux</a></code> v7.1.0、<code class="fe mt mu mv mw b">useSelector</code>和<code class="fe mt mu mv mw b">useDispatch</code>挂钩加入了我们的生活。在这些的帮助下，我们不再需要编写两个独立的函数(<em class="kf"> mapStateToProps </em>和<em class="kf">mapdispatctoprops</em>)和一个包装器HOC来为组件注入redux props。这些钩子足以订阅Redux存储和调度操作。</p><p id="4eff" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">正如react-redux医生所说；</p><blockquote class="mz"><p id="c2e7" class="na nb in bd nc nd ne nf ng nh ni lb dk translated">“我们<strong class="ak">建议</strong>使用React-Redux hooks API作为React组件中的默认方法。</p><p id="b436" class="na nb in bd nc nd ne nf ng nh ni lb dk translated">现有的<code class="fe mt mu mv mw b">connect</code> API仍然工作，并将继续得到支持，但是hooks API更简单，并且与TypeScript一起工作得更好。"</p></blockquote><p id="a4ec" class="pw-post-body-paragraph kd ke in kg b kh nj kj kk kl nk kn ko lc nl kr ks ld nm kv kw le nn kz la lb ig bi translated">你可以在<a class="ae jz" href="https://react-redux.js.org/api/hooks" rel="noopener ugc nofollow" target="_blank">文档</a>中找到更多关于在React Redux应用中使用钩子的信息。</p><p id="259a" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">这一变化对开发人员的体验产生了积极的影响。我们已经删除了所有容器组件，这些组件仅用于redux、translation和router包装器。现在，处理TypeScript并达到组件内部所需的状态变得更加简单。</p><figure class="mg mh mi mj gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi no"><img src="../Images/de85d5b6b4f86fefb5769a7a17bcdce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7U_uSOLjIlB8FTomTO_4yw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Before (left) and after (right) of usage of the redux hooks to subscribe to the Redux store and dispatch actions</figcaption></figure><p id="ac91" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">从上面你可以清楚地看到这一变化的影响。</p></div><div class="ab cl lf lg hr lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ig ih ii ij ik"><p id="8800" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">即使对现有的React应用程序进行优化和现代化还有更多工作要做，这也是一个非常好的开始。作为一个团队，我们在开发人员和最终用户体验方面经历了巨大的差异。编写一个组件要容易得多，也快得多，而且花在代码库上的时间也更少。</p><p id="9c68" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">下面两个gists具有相同的输出。你可以看到组件缩短了多少。</p><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="np nq l"/></div></figure><figure class="mg mh mi mj gt jo"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="6c4b" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">我们在可持续性和可扩展性问题上积累了多年的经验后，提出了这些步骤。正在开发的React应用程序应该始终与最近的开发保持同步。</p><blockquote class="ka kb kc"><p id="c39f" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">保持持续发展的心态是非常重要的，尤其是对于前端世界。</p></blockquote><p id="3499" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">我要感谢我的队友埃姆雷·克斯金和T2·乌尔坎·达夫兰，他们的高水平视野和经验激励了我们。</p><p id="5d76" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">保持联系！</p><p id="208b" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated"><em class="kf">更多内容尽在</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="kf">plain English . io</em></a></p></div></div>    
</body>
</html>