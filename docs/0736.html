<html>
<head>
<title>Gatsby.js — Sitemap and RSS Feed</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Gatsby.js —网站地图和RSS源</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/gatsby-js-sitemap-and-rss-feed-4b3890050f3d?source=collection_archive---------17-----------------------#2021-02-14">https://javascript.plainenglish.io/gatsby-js-sitemap-and-rss-feed-4b3890050f3d?source=collection_archive---------17-----------------------#2021-02-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8a16f1faed1054305bf0bd9ad859339e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KTzJ3e-quarPO4pb"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@jesseschoff?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jesse Schoff</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="524e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">盖茨比是一个基于反应的静态网站框架。</p><p id="f7a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用它来从外部数据源创建静态网站等等。</p><p id="fb08" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用盖茨比创建一个网站。</p><h1 id="7ed7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">网站地图</h1><p id="968c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">gatsby-plugin-sitemap</code>插件添加网站地图。</p><p id="973f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1b28" class="mq lc iq mh b gy mr ms l mt mu">module.exports = {<br/>  siteMetadata: {<br/>    siteUrl: `https://www.example.com`,<br/>  },<br/>  plugins: [`gatsby-plugin-sitemap`],<br/>}</span></pre><p id="19c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">gatsby-config.js</code>中。</p><p id="e70c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过运行以下程序来安装插件:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8701" class="mq lc iq mh b gy mr ms l mt mu">npm i gatsby-plugin-sitemap</span></pre><p id="308b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">siteUrl</code>有网站的基本网址。这是必需的。</p><p id="9db3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将插件添加到<code class="fe me mf mg mh b">plugins</code>数组中。</p><p id="84c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后当我们用<code class="fe me mf mg mh b">npm run build</code>进行生产制造时，我们会得到网站地图。</p><h1 id="23dd" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">简单讯息聚合订阅</h1><p id="feaf" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">gatsby-plugin-feed</code>插件添加一个RSS源。</p><p id="7184" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><p id="a688" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">gatsby-config.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d83c" class="mq lc iq mh b gy mr ms l mt mu">module.exports = {<br/>  plugins: [<br/>    `gatsby-transformer-remark`,<br/>    `gatsby-plugin-feed`,<br/>    {<br/>      resolve: `gatsby-source-filesystem`,<br/>      options: {<br/>        name: `content`,<br/>        path: `${__dirname}/src/content`,<br/>      },<br/>    },<br/>  ],<br/>  siteMetadata: {<br/>    siteUrl: `https://www.example.com`,<br/>  },<br/>}</span></pre><p id="9211" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要<code class="fe me mf mg mh b">siteMetadata.siteUrl</code>来生成RSS提要。</p><p id="75e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">gatsby-node.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="582c" class="mq lc iq mh b gy mr ms l mt mu">const path = require("path")<br/>const _ = require("lodash")<br/>const { createFilePath } = require(`gatsby-source-filesystem`)</span><span id="3e4c" class="mq lc iq mh b gy mv ms l mt mu">exports.onCreateNode = ({ node, actions, getNode }) =&gt; {<br/>  const { createNodeField } = actions<br/>  if (node.internal.type === `MarkdownRemark`) {<br/>    const value = createFilePath({ node, getNode })<br/>    createNodeField({<br/>      name: `slug`,<br/>      node,<br/>      value,<br/>    })<br/>  }<br/>}</span><span id="f389" class="mq lc iq mh b gy mv ms l mt mu">exports.createPages = async ({ actions, graphql, reporter }) =&gt; {<br/>  const { createPage } = actions<br/>  const blogPostTemplate = path.resolve("src/templates/post.js")<br/>  const result = await graphql(`<br/>    {<br/>      postsRemark: allMarkdownRemark(<br/>        sort: { order: DESC, fields: [frontmatter___date] }<br/>        limit: 2000<br/>      ) {<br/>        edges {<br/>          node {<br/>            fields {<br/>              slug<br/>            }<br/>            frontmatter {<br/>              tags<br/>            }<br/>          }<br/>        }<br/>      }<br/>      tagsGroup: allMarkdownRemark(limit: 2000) {<br/>        group(field: frontmatter___tags) {<br/>          fieldValue<br/>        }<br/>      }<br/>    }<br/>  `)<br/>  if (result.errors) {<br/>    reporter.panicOnBuild(`Error while running GraphQL query.`)<br/>    return<br/>  }<br/>  const posts = result.data.postsRemark.edges<br/>  posts.forEach(({ node }) =&gt; {<br/>    const slug = node.fields.slug<br/>    createPage({<br/>      path: slug,<br/>      component: blogPostTemplate,<br/>      context: { slug },<br/>    })<br/>  })<br/>}</span></pre><p id="5ae6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">src/templates/post.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a027" class="mq lc iq mh b gy mr ms l mt mu">import React from "react"<br/>import { graphql } from "gatsby"</span><span id="b6fe" class="mq lc iq mh b gy mv ms l mt mu">export default function BlogPost({ data }) {<br/>  const post = data.markdownRemark<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;h1&gt;{post.frontmatter.title}&lt;/h1&gt;<br/>      &lt;div dangerouslySetInnerHTML={{ __html: post.html }} /&gt;<br/>    &lt;/div&gt;<br/>  )<br/>}<br/>export const query = graphql`<br/>  query($slug: String!) {<br/>    markdownRemark(fields: { slug: { eq: $slug } }) {<br/>      html<br/>      frontmatter {<br/>        title<br/>      }<br/>    }<br/>  }<br/>`</span></pre><p id="17dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">gatsby-plugin-feed</code>插件添加到<code class="fe me mf mg mh b">gatsby-config.js</code>中。</p><p id="ed97" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过运行以下程序来安装插件:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d15a" class="mq lc iq mh b gy mr ms l mt mu">npm i gatsby-plugin-feed</span></pre><p id="688e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">gatsby-node.js</code>中，我们进行GraphQL查询来获取降价帖子，并调用<code class="fe me mf mg mh b">createPage</code>来创建帖子。</p><p id="5482" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">post.js</code>从<code class="fe me mf mg mh b">data</code>道具获取数据后显示帖子。</p><p id="ae94" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在当我们运行<code class="fe me mf mg mh b">npm run build</code>时，我们看到<code class="fe me mf mg mh b">public/rss.xml</code>文件生成了。</p><h1 id="2cb1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="43f3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以和盖茨比一起给我们的网站添加一个网站地图和RSS源。</p><p id="e105" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果是这样，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获得更多类似的内容！</strong></p></div></div>    
</body>
</html>