<html>
<head>
<title>React Hooks: The Ultimate Guide (useState/useEffect)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React钩子:最终指南(使用状态/使用效果)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-hooks-the-ultimate-guide-usestate-useeffect-cdb3b1ce19c4?source=collection_archive---------4-----------------------#2021-12-07">https://javascript.plainenglish.io/react-hooks-the-ultimate-guide-usestate-useeffect-cdb3b1ce19c4?source=collection_archive---------4-----------------------#2021-12-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/4a0dc61df0c9a79e32da46f20611d790.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bx5C-5huNovk7qLt"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@lautaroandreani?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Lautaro Andreani</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f6c0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你不是React新手(或者这些年一直住在山洞里)，你可能听说过React hooks。我在这里的目的不仅是介绍它，而且是展示如何使用它来避免React经常发生的许多不必要的重新渲染。</p><h1 id="a9d0" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">基本的东西</h1><h2 id="12c1" class="lw kz in bd la lx ly dn le lz ma dp li kl mb mc lm kp md me lq kt mf mg lu mh bi translated">什么是钩子？</h2><p id="1cfd" class="pw-post-body-paragraph ka kb in kc b kd mi kf kg kh mj kj kk kl mk kn ko kp ml kr ks kt mm kv kw kx ig bi translated"><em class="mn">“React钩子是React 16.8中引入的，允许我们在不使用类的情况下使用状态和其他React资源。”</em></p><p id="1ebb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好吧，但那是什么意思？基本上，React将允许更新变量值，并将触发这些变化，所以我们可以在屏幕上看到一些特定的动作发生时的结果。</p><h2 id="acbb" class="lw kz in bd la lx ly dn le lz ma dp li kl mb mc lm kp md me lq kt mf mg lu mh bi translated">什么是DOM？</h2><p id="770c" class="pw-post-body-paragraph ka kb in kc b kd mi kf kg kh mj kj kk kl mk kn ko kp ml kr ks kt mm kv kw kx ig bi translated">我知道。更多理论？为什么不直接看例子呢？</p><p id="49f7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因为在使用前端时，理解这一点非常重要。DOM(文档对象模型)是加载网页时创建的浏览器元素的树对象。这个DOM表示整个页面及其元素(div、图像、文本等)。</p></div><div class="ab cl mo mp hr mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="ig ih ii ij ik"><h2 id="2eab" class="lw kz in bd la lx ly dn le lz ma dp li kl mb mc lm kp md me lq kt mf mg lu mh bi translated">使用状态</h2><p id="2364" class="pw-post-body-paragraph ka kb in kc b kd mi kf kg kh mj kj kk kl mk kn ko kp ml kr ks kt mm kv kw kx ig bi translated">让我们创建一个计数器和一个给它加1的按钮。如果我们用JavaScript的方式来做，那么:</p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="89a6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">屏幕上什么都不会改变。为什么？因为DOM已经呈现了，即使您更改了<code class="fe nb nc nd ne b">counter</code>的值，也不会在DOM上更新。</p><p id="8576" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这一刻就是<code class="fe nb nc nd ne b">useState</code>出现的地方。这个钩子将返回给我们一个有两个值的数组。第一个是您将使用的值，第二个是将更新该值的函数，如下所示:</p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="0c2e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们有了一个可以工作的计数器！</p><p id="80e0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我更深入地解释一下正在发生的事情:</p><ul class=""><li id="5148" class="nf ng in kc b kd ke kh ki kl nh kp ni kt nj kx nk nl nm nn bi translated"><code class="fe nb nc nd ne b">counter</code>是我们将在屏幕中显示的值</li><li id="6252" class="nf ng in kc b kd no kh np kl nq kp nr kt ns kx nk nl nm nn bi translated"><code class="fe nb nc nd ne b">setCounter</code>是更新<code class="fe nb nc nd ne b">counter</code>值的函数</li><li id="9b3f" class="nf ng in kc b kd no kh np kl nq kp nr kt ns kx nk nl nm nn bi translated"><code class="fe nb nc nd ne b">useState(0)</code>中的<code class="fe nb nc nd ne b">0</code>是计数器的初始值</li><li id="490d" class="nf ng in kc b kd no kh np kl nq kp nr kt ns kx nk nl nm nn bi translated"><code class="fe nb nc nd ne b">setCounter((oldCounter) =&gt; oldCounter + 1)</code>是更新计数器值的函数。当使用这个函数时，我们有两个选择:像<code class="fe nb nc nd ne b">setCounter(1)</code>一样返回我们想要的值，或者我们可以返回一个函数来获取我们状态的旧值(就像我们所做的)</li></ul><p id="b05b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">很简单，对吧？！</p><h2 id="dc05" class="lw kz in bd la lx ly dn le lz ma dp li kl mb mc lm kp md me lq kt mf mg lu mh bi translated">使用效果</h2><p id="2c9d" class="pw-post-body-paragraph ka kb in kc b kd mi kf kg kh mj kj kk kl mk kn ko kp ml kr ks kt mm kv kw kx ig bi translated"><em class="mn">“use effect允许我们在功能组件中执行效果。获取数据、设置订阅以及在React组件中手动更改DOM都是副作用的例子。”</em></p><p id="94fb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">它的作用基本上是让我们在特定状态改变时运行一些功能。<code class="fe nb nc nd ne b">useEffect</code>接收两个参数:第一个参数是一个函数，它将在每次指定的一个状态发生变化时运行，第二个参数是一个数组，它包含了我们想要检查它是否发生变化的所有状态。</p><p id="90cf" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，让我们假设，如果计数器能被2整除，我们也想得到信息。一种方法是使用useEffect:</p><figure class="mv mw mx my gt jo"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="1356" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">所以在这段代码中，每次<code class="fe nb nc nd ne b">counter</code>状态改变时，它都会运行函数<code class="fe nb nc nd ne b">updateIsDivisibleByTwo</code>，就像这样简单。如果你已经在你的项目中配置了<code class="fe nb nc nd ne b">eslint</code>(你应该这样做),它会告诉你</p><pre class="mv mw mx my gt nt ne nu nv aw nw bi"><span id="7458" class="lw kz in ne b gy nx ny l nz oa">React Hook useEffect has a missing dependency: updateIsDivisibleByTwo. Either include it or remove the dependency array. (react-hooks/exhaustive-deps) eslint</span></pre><p id="8110" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">发生这种情况是因为<code class="fe nb nc nd ne b">updateIsDivisibleByTwo</code>可以在渲染之间改变，并且linter阻止我们引用那种“陈旧数据”。</p><p id="1c58" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我将在我们下一篇讨论useCallback和useMemo的文章中解释如何解决这个问题。</p><p id="560a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">希望有所帮助！</p><p id="fd80" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">干杯！</p><p id="5284" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mn">更多内容看</em> <a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="mn">说白了。报名参加我们的</em> </a><a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="mn">免费周报</em> </a> <em class="mn">。在我们的</em> <a class="ae jz" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <em class="mn">社区</em> </a> <em class="mn">获得独家写作机会和建议。</em></p></div></div>    
</body>
</html>