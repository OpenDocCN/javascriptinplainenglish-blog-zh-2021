<html>
<head>
<title>Build a Video, Audio + Screen Recorder Web App with JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript构建一个视频、音频+屏幕录制的Web应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/build-audio-video-and-screen-recorder-for-web-with-javascript-583584dd3c75?source=collection_archive---------0-----------------------#2021-02-12">https://javascript.plainenglish.io/build-audio-video-and-screen-recorder-for-web-with-javascript-583584dd3c75?source=collection_archive---------0-----------------------#2021-02-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/18d45edb66a1bf2be2289193b9dd9304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CpWMOOcgRcWCo1vX"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@surface?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Surface</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4165" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这个疫情，发生了很多变化，因此工作文化中有一些我们无法摆脱的东西，是的<em class="ky">“远程会议”</em>。在其中一次会议上，我对<a class="ae jz" href="https://meet.google.com" rel="noopener ugc nofollow" target="_blank">会议平台</a>产生了好奇，经过一番搜索，我了解到我们的浏览器能够做什么(内置浏览器API)。</p><p id="4e0e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，我计划开发一个简单的记录器，支持音频、视频和屏幕记录，可从<a class="ae jz" href="https://recorder.dhruv479.dev" rel="noopener ugc nofollow" target="_blank">http://recorder . dhruv 479 . dev</a>获得</p><p id="3cf1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你喜欢这篇文章，不要错过鼓掌和关注。</p><p id="13b9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要继续学习，您应该熟悉一些术语:</p><p id="1199" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">MediaRecorder:</strong><a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStream_Recording_API" rel="noopener ugc nofollow" target="_blank">media stream API</a>的media recorder接口提供了轻松录制媒体<a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder" rel="noopener ugc nofollow" target="_blank"> <em class="ky"> ref: MDN </em> </a>的功能</p><p id="ca49" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">media devices:</strong>media devices接口提供对连接的媒体输入设备(如照相机和麦克风)的访问，以及屏幕共享<a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices" rel="noopener ugc nofollow" target="_blank"> <em class="ky"> ref: MDN </em> </a></p><p id="3736" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了，准备好了吗？让我们添加一些代码！</p><p id="4274" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">记录处理程序:</strong>首先，我们将编写一个函数来获取<code class="fe kz la lb lc b">stream</code>和<code class="fe kz la lb lc b">mimeType</code>，收集数据块，然后允许从浏览器下载本地机器上的文件。</p><figure class="ld le lf lg gt jo"><div class="bz fp l di"><div class="lh li l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">handle-stream-record.js</figcaption></figure><p id="1d08" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，用输入流创建一个<code class="fe kz la lb lc b">MediaRecorder</code>实例。然后，为<code class="fe kz la lb lc b">ondataavailable</code>(当数据进入数据流时)和<code class="fe kz la lb lc b">onstop</code>(当数据流停止时)添加事件。</p><p id="047e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在chunk可用之后，它被推入数组，在stop事件之后，所有的chunk被放在一起形成一个指定mimeType的<code class="fe kz la lb lc b"><a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/API/Blob" rel="noopener ugc nofollow" target="_blank">Blob</a></code>。</p><p id="d00e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">稍后，为blob对象创建URL，并且可以从浏览器下载。</p><p id="f24e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">音频记录器:</strong>接下来，我们将编写一个函数来调用音频记录，该函数进一步调用带有所需参数的<code class="fe kz la lb lc b">handleRecord</code>。</p><figure class="ld le lf lg gt jo"><div class="bz fp l di"><div class="lh li l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">audio-stream-record.js</figcaption></figure><p id="c2f2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里，我们将使用<code class="fe kz la lb lc b">mediaDevices.getUserMedia</code>来访问用户机器上的资源。调用这个之后，我们会在浏览器中得到一个请求许可的提示，确认之后，我们就可以访问那些资源了。此外，我们可以向约束传递额外的参数，比如减少声音回声的<code class="fe kz la lb lc b">audio: { echoCancellation: true }</code>。</p><p id="4236" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">录像机:</strong>与录音类似，我们需要在<em class="ky"> getUserMedia </em>函数的参数中添加<code class="fe kz la lb lc b">video</code>。</p><figure class="ld le lf lg gt jo"><div class="bz fp l di"><div class="lh li l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">video-stream-record.js</figcaption></figure><p id="870a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在<code class="fe kz la lb lc b">getUserMedia</code>中添加<code class="fe kz la lb lc b">video</code>约束后，你会得到一个额外的相机许可提示，确认后，你猜怎么着，我们可以访问相机流了。另外，额外的参数可以传递到<code class="fe kz la lb lc b">video</code>，例如:<code class="fe kz la lb lc b">video: { width: {min: 640}, height: {min: 480}}</code></p><p id="61d7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">屏幕记录器:</strong>这是最有趣的，因为显示流由<code class="fe kz la lb lc b">getDisplayMedia</code>提供，音频由<code class="fe kz la lb lc b">getUserMedia</code>提供。因此，如果需要屏幕记录的音频背景，我们需要在这里合并不同的流。</p><figure class="ld le lf lg gt jo"><div class="bz fp l di"><div class="lh li l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">screen-stream-record.js</figcaption></figure><p id="bf8c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们合并不同的流来创建一个新的流，并将其传递给<code class="fe kz la lb lc b">handleRecord</code>函数。这里，我们也可以根据需要添加更具体的约束。</p><p id="c18b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky">传递给捕获媒体的约束可以更具体，如分辨率、回声、光标，而不是真/假。</em></p><h1 id="faac" class="lj lk in bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">结论</h1><p id="b335" class="pw-post-body-paragraph ka kb in kc b kd mh kf kg kh mi kj kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">瞧，JavaScript部分完成了😁。我们只需要添加一些基本的HTML来调用这些功能，停止记录，当然，下载文件。</p><p id="f26b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">以下是完整代码的参考:</p><div class="mm mn gp gr mo mp"><a href="https://github.com/dhruv479/recorder/blob/master/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd io gy z fp mu fr fs mv fu fw im bi translated">DH ruv 479/记录器</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">在GitHub上创建一个帐户，为DH ruv 479/记录器的开发做出贡献。</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">github.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd jt mp"/></div></div></a></div><p id="a023" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">希望你喜欢这篇文章，鼓掌并关注更多内容。</p></div></div>    
</body>
</html>