<html>
<head>
<title>Using Node.js + S3 to Create, Delete, List Buckets and Upload, List Objects— Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js + S3创建、删除、列出存储桶和上传、列出对象—第2部分</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/using-node-js-s3-to-create-delete-list-buckets-and-upload-list-objects-part-2-fb1b76da36dc?source=collection_archive---------1-----------------------#2021-02-28">https://javascript.plainenglish.io/using-node-js-s3-to-create-delete-list-buckets-and-upload-list-objects-part-2-fb1b76da36dc?source=collection_archive---------1-----------------------#2021-02-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/d8dee8fb358920c83e6057776f1e543f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0gpNTmivzmciNqrg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@casparrubin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Caspar Camille Rubin</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="791d" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">介绍</h1><p id="7726" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">这是博客的第<strong class="la io">第二</strong>部分。接下来，请访问我之前的<a class="ae jz" href="https://medium.com/@rugved-bongale/using-node-js-s3-to-create-delete-list-buckets-and-upload-list-objects-part-1-b9943825c666" rel="noopener">博客</a>来设置AWS S3——存储桶策略、配置等。</p><p id="06fb" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io">这个博客有两部分:</strong></p><p id="36a2" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><a class="ae jz" href="https://medium.com/@rugved-bongale/using-node-js-s3-to-create-delete-list-buckets-and-upload-list-objects-part-1-b9943825c666" rel="noopener">第一部分——了解如何设置AWS S3并手动使用它。</a></p><p id="2cfa" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io">第二部分—以编程方式使用Node.js在S3上执行操作。</strong></p><h1 id="793b" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">我们在建造什么？</h1><p id="03da" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在这篇博客中，我们将看到<strong class="la io"> Node.js实现</strong>做以下事情:</p><ol class=""><li id="52f3" class="mb mc in la b lb lw lf lx lj md ln me lr mf lv mg mh mi mj bi translated"><em class="mk">在S3上创建存储桶(就像一个特定的唯一文件夹来存储我们的媒体)</em></li><li id="07ef" class="mb mc in la b lb ml lf mm lj mn ln mo lr mp lv mg mh mi mj bi translated">列出我们制造的所有水桶。</li><li id="d5df" class="mb mc in la b lb ml lf mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><em class="mk">将图像上传至铲斗。</em></li><li id="a189" class="mb mc in la b lb ml lf mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><em class="mk">列出桶中的所有对象(图像、视频等)</em></li><li id="601b" class="mb mc in la b lb ml lf mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><em class="mk">删除桶。</em></li></ol><h1 id="8e9d" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">设置</strong></h1><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="e4cc" class="mz kb in mv b gy na nb l nc nd">mkdir nodejs-s3<br/>cd nodejs-s3<br/>npm init -y</span></pre><h1 id="7020" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">安装所需的npm软件包</strong></h1><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="40b8" class="mz kb in mv b gy na nb l nc nd">npm i aws-sdk</span></pre><p id="0c05" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在当前项目目录中创建index.js文件。</p><h1 id="d0c5" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">实施</strong></h1><ol class=""><li id="c8d9" class="mb mc in la b lb lc lf lg lj ne ln nf lr ng lv mg mh mi mj bi translated">我们需要做的第一件事是导入aws-sdk包</li></ol><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="4bb9" class="mz kb in mv b gy na nb l nc nd">const AWS = require('aws-sdk');</span></pre><p id="11d4" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">2.现在，为了连接AWS S3，我们需要“<strong class="la io"> accessKeyId </strong>”和“<strong class="la io"> secretAccessKey </strong>”。我们在之前的<a class="ae jz" href="https://medium.com/@rugved-bongale/using-node-js-s3-to-create-delete-list-buckets-and-upload-list-objects-part-1-b9943825c666" rel="noopener">博客</a>中已经讨论过如何获得。</p><figure class="mq mr ms mt gt jo"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="48c7" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">3.输入我们在之前的<a class="ae jz" href="https://medium.com/@rugved-bongale/using-node-js-s3-to-create-delete-list-buckets-and-upload-list-objects-part-1-b9943825c666" rel="noopener">博客</a>中创建的桶名。<br/>在我这里是<strong class="la io"> <em class="mk">“我的-唯一-测试-桶-123”</em></strong></p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="c8e3" class="mz kb in mv b gy na nb l nc nd">const BUCKET_NAME = 'my-unique-test-bucket-123';</span></pre><p id="e01b" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">I)以编程方式创建存储桶的功能。以铲斗名称为输入<br/> <strong class="la io">注:</strong>要设置基本铲斗配置，请参考之前的<a class="ae jz" href="https://medium.com/@rugved-bongale/using-node-js-s3-to-create-delete-list-buckets-and-upload-list-objects-part-1-b9943825c666" rel="noopener">博客</a>。</p><figure class="mq mr ms mt gt jo"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="c87f" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">II)现在让我们写一个函数来列出我们在S3的所有桶。</p><figure class="mq mr ms mt gt jo"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="a106" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">此功能将列出您的<a class="ae jz" href="https://s3.console.aws.amazon.com/s3/home" rel="noopener ugc nofollow" target="_blank"><strong class="la io">AWS S3</strong></a><strong class="la io"/>仪表盘中的所有存储桶。</p><p id="e0ba" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">III)接下来让我们编写上传图像的函数。为此，选择任何图像并将其放在项目目录中。(与index.js目录相同)</p><figure class="mq mr ms mt gt jo"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="4f50" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">上面的uploadFile函数有两个参数:<br/> - <strong class="la io"> filePath </strong>:要上传到bucket的本地文件的路径。<br/> - <strong class="la io">桶名</strong>:需要上传文件的桶。</p><p id="82d7" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">IV)为了列出特定存储桶中的所有对象，我们将创建一个函数，该函数将单个参数"<strong class="la io"> bucketName </strong>"作为输入。</p><figure class="mq mr ms mt gt jo"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="f1d9" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">v)删除一个桶。将存储桶名称作为输入。</p><figure class="mq mr ms mt gt jo"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="404d" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">现在我们已经准备好了所有的功能，我们可以单独使用它。为了便于演示，我构建了一个函数，它将在5秒的时间间隔内一个接一个地运行上面讨论的所有函数。</p><h1 id="852b" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">完成index.js文件</strong></h1><figure class="mq mr ms mt gt jo"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="3333" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">输出</strong></h1><figure class="mq mr ms mt gt jo gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/6f1da481c15dd2796e37ffdb4df79dac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*vpnwAWwBcqOoXLZd_ZQMtA.png"/></div></figure><figure class="mq mr ms mt gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/0fd0ae0f96d25ad6e12758a29d1f2c9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*Frmwm-ACsDYKED9GeV5M7Q.png"/></div></div></figure><p id="11a2" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><strong class="la io"> <em class="mk">搞定！</em> </strong>朋友，这个博客到此为止。</p><p id="8d21" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">如果你觉得这个博客有帮助，请鼓掌，并与你的朋友分享。</p><h1 id="917f" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">结论:</strong></h1><p id="128f" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">因此，我们已经成功地学习了如何使用Node.js来创建S3存储桶、上传文件、列出存储桶、列出对象和删除存储桶。</p><p id="c707" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">对于代码，您可以访问:<a class="ae jz" href="https://github.com/RugvedB/Nodejs-s3" rel="noopener ugc nofollow" target="_blank">https://github.com/RugvedB/Nodejs-s3</a></p><p id="2f69" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated"><em class="mk">更多内容请看</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="mk">plain English . io</em></a></p></div></div>    
</body>
</html>