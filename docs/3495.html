<html>
<head>
<title>Yarn Workspaces: Create the Perfect Monorepo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">纱线工作空间:创造完美的Monorepo</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/yarn-workspaces-create-the-perfect-monorepo-d0b6295e6838?source=collection_archive---------7-----------------------#2021-07-14">https://javascript.plainenglish.io/yarn-workspaces-create-the-perfect-monorepo-d0b6295e6838?source=collection_archive---------7-----------------------#2021-07-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9031" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用yarn workspaces创建一个非常酷的monorepo？</h2></div><p id="21fa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Yarn Workspaces是一个非常强大的工具，可以创建令人难以置信的monorepos。今天，你将学习如何创建你自己的纱线工作空间monorepo！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/0f3676b18b2fd0f23584ea4dd0f143e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GmslBgG0w2wjotzV"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">Photo by <a class="ae lr" href="https://unsplash.com/@frankiefoto?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">frank mckenna</a> on <a class="ae lr" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="e047" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">🐣第一步</h1><p id="a873" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">在本教程中，您将学习:</p><ul class=""><li id="7e1d" class="mp mq iq kh b ki kj kl km ko mr ks ms kw mt la mu mv mw mx bi translated">如何安装纱线</li><li id="9901" class="mp mq iq kh b ki my kl mz ko na ks nb kw nc la mu mv mw mx bi translated">使用纱线设置项目</li><li id="8eaa" class="mp mq iq kh b ki my kl mz ko na ks nb kw nc la mu mv mw mx bi translated">创建纱线工作空间</li><li id="f3b2" class="mp mq iq kh b ki my kl mz ko na ks nb kw nc la mu mv mw mx bi translated">管理单一回购</li></ul><h2 id="2125" class="nd lt iq bd lu ne nf dn ly ng nh dp mc ko ni nj me ks nk nl mg kw nm nn mi no bi translated">安装纱线</h2><p id="af90" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">当然，第一步是确保你安装了纱线。如果不是这样，那么您可以通过运行<code class="fe np nq nr ns b">npm install -g yarn</code>来全局安装它。</p><h2 id="e2e1" class="nd lt iq bd lu ne nf dn ly ng nh dp mc ko ni nj me ks nk nl mg kw nm nn mi no bi translated">创建新项目</h2><p id="f6f2" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">安装Yarn后，我们将创建一个新项目。进入一个新文件夹，运行以下命令。</p><pre class="lc ld le lf gt nt ns nu nv aw nw bi"><span id="de85" class="nd lt iq ns b gy nx ny l nz oa">yarn init -y</span></pre><h2 id="a783" class="nd lt iq bd lu ne nf dn ly ng nh dp mc ko ni nj me ks nk nl mg kw nm nn mi no bi translated">使我们的项目私人化</h2><p id="56ad" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">前面的命令将在您的文件夹中生成一个<code class="fe np nq nr ns b">package.json</code>文件。我们需要改变这个文件中的一个东西！</p><p id="2350" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请不要跳过这一步，这一点很重要！</p><blockquote class="ob oc od"><p id="7081" class="kf kg oe kh b ki kj jr kk kl km ju kn of kp kq kr og kt ku kv oh kx ky kz la ij bi translated">注意<code class="fe np nq nr ns b">private: true</code>是必填项！工作区不应该被发布，所以我们增加了这个安全措施来确保没有东西会意外地暴露它们。</p></blockquote><p id="6d51" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">给你的对象添加<code class="fe np nq nr ns b">"private": "true"</code>参数。</p><p id="2ede" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你的<code class="fe np nq nr ns b">package.json</code>看起来应该和这个差不多。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oi"><img src="../Images/c8e90d0c0f2a55fbb3adbb98395a4844.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OGG-LVAlXQzjKynjc07VbQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">Make sure your package.json has the private flag!</figcaption></figure><h2 id="ab9b" class="nd lt iq bd lu ne nf dn ly ng nh dp mc ko ni nj me ks nk nl mg kw nm nn mi no bi translated">添加两个工作区</h2><p id="7516" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">让我们给我们的<code class="fe np nq nr ns b">package.json</code>添加两个工作区。通过添加<code class="fe np nq nr ns b">workspaces</code>参数可以做到这一点。为了简单起见，我们将称它们为<code class="fe np nq nr ns b">workspace-a</code>和<code class="fe np nq nr ns b">workspace-b</code>。</p><p id="b8fb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您的<code class="fe np nq nr ns b">package.json</code>现在应该看起来像这样。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oj"><img src="../Images/742dfa2ec9484cc28f073a4679ef55ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nLrna5-rsLU3UEi0-TqY-g.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">Add an array of workspaces to your package.json</figcaption></figure><p id="1183" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">之后，我们将创建实际的工作区。重要的是，要像在workspaces数组中一样对它们进行命名。</p><ul class=""><li id="a2cd" class="mp mq iq kh b ki kj kl km ko mr ks ms kw mt la mu mv mw mx bi translated">添加两个新文件夹，并将其命名为您的工作区。</li><li id="8900" class="mp mq iq kh b ki my kl mz ko na ks nb kw nc la mu mv mw mx bi translated">在每个文件夹中添加一个<code class="fe np nq nr ns b">package.json</code>，并确保它们的<code class="fe np nq nr ns b">name</code>与工作区相同！</li></ul><p id="a03b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你按照教程，那么你的文件夹结构应该是这样的。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ok"><img src="../Images/66a4a49fcb9a45304b39626ca4bde08d.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*7u4uQbP_Qrta4z4KPX9ZNw.png"/></div></div></figure><h2 id="b0f8" class="nd lt iq bd lu ne nf dn ly ng nh dp mc ko ni nj me ks nk nl mg kw nm nn mi no bi translated">添加一些依赖项</h2><p id="268d" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">为了看到工作空间的真正威力，我们需要添加一些依赖项。我们将手动完成这项工作，这样更容易展示我们工作区的强大功能。</p><p id="4bea" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们添加以下依赖项:</p><ul class=""><li id="43bb" class="mp mq iq kh b ki kj kl km ko mr ks ms kw mt la mu mv mw mx bi translated">工作区-a <br/> - dotenv <br/> - express</li><li id="2208" class="mp mq iq kh b ki my kl mz ko na ks nb kw nc la mu mv mw mx bi translated">工作空间-b <br/> - dotenv</li></ul><p id="a553" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们就有了一个在两个工作空间中都存在的依赖项，而且是唯一的！</p><p id="3620" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">工作空间-A </strong></p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="67f6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">工作区-B </strong></p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ol om l"/></div></figure><h2 id="48a9" class="nd lt iq bd lu ne nf dn ly ng nh dp mc ko ni nj me ks nk nl mg kw nm nn mi no bi translated">安装我们的依赖项</h2><p id="dab0" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">完成所有这些设置后，是时候展示工作区的真正威力了！</p><p id="5dd9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在你所要做的就是在你的项目的根目录下运行<code class="fe np nq nr ns b">yarn install</code>,让奇迹发生吧！</p><p id="0bed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Yarn安装两个工作区的依赖项，并创建一个共享的node_modules文件夹。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi on"><img src="../Images/2d94a0bced5213ffebdc39332573da98.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*jEHPcNQ9y9dj5F4OHXuYyw.png"/></div></figure><h1 id="4518" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">🦹‍♂️有些很酷的把戏</h1><h2 id="ba4d" class="nd lt iq bd lu ne nf dn ly ng nh dp mc ko ni nj me ks nk nl mg kw nm nn mi no bi translated">在工作区中调用脚本</h2><p id="2e88" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">如果你想从你的项目的根目录调用一个工作空间的脚本，那么你可以毫不费力地做到。</p><p id="1323" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们给我们的<code class="fe np nq nr ns b">workspace-a</code>添加一个新脚本。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="43ff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您希望从项目的根目录运行这个打印脚本，那么您需要做的就是通过<code class="fe np nq nr ns b">yarn workspace</code>调用它。调用我们的<code class="fe np nq nr ns b">print</code>脚本是这样工作的</p><pre class="lc ld le lf gt nt ns nu nv aw nw bi"><span id="1f03" class="nd lt iq ns b gy nx ny l nz oa">yarn workspace workspace-a print</span></pre><p id="2fb9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">想让它变得更简单吗？你可以把<code class="fe np nq nr ns b">yarn workspace</code>命令放在你的根<code class="fe np nq nr ns b">package.json</code>的<code class="fe np nq nr ns b">scripts</code>对象中。</p><h2 id="5eef" class="nd lt iq bd lu ne nf dn ly ng nh dp mc ko ni nj me ks nk nl mg kw nm nn mi no bi translated">工作空间模式匹配</h2><p id="4059" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">在我们的例子中，我们在一个数组中声明了所有的工作空间，但是yarn也支持全局模式匹配。</p><p id="0927" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我们希望将<code class="fe np nq nr ns b">packages/</code>目录中的每个文件夹都视为一个独立的工作区，那么我们的模式应该是这样的。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ol om l"/></div></figure></div><div class="ab cl oo op hu oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="ij ik il im in"><p id="1f17" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">祝你有美好的一天！💛</p><h2 id="8626" class="nd lt iq bd lu ne nf dn ly ng nh dp mc ko ni nj me ks nk nl mg kw nm nn mi no bi translated"><em class="ov">延伸阅读</em></h2><div class="ow ox gp gr oy oz"><a href="https://bit.cloud/blog/painless-monorepo-dependency-management-with-bit-l4f9fzyw" rel="noopener  ugc nofollow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd ir gy z fp pe fr fs pf fu fw ip bi translated">使用Bit进行无痛monorepo依赖管理</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">简化monorepo中的依赖关系管理，以避免虚拟依赖关系和版本问题。了解…</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">比特云</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn ll oz"/></div></div></a></div><p id="262b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="oe">更多内容看</em> <a class="ae lr" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="oe">说白了。报名参加我们的</em> <a class="ae lr" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="oe">免费周报</em> </strong> </a> <em class="oe">。关注我们关于</em> <a class="ae lr" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="oe">推特</em> </strong> </a>，<a class="ae lr" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="oe">领英</em> </strong> </a> <strong class="kh ir"> <em class="oe">，</em></strong><a class="ae lr" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="oe">YouTube</em></strong></a><strong class="kh ir"><em class="oe">，以及</em></strong><em class="oe"><a class="ae lr" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="oe">不和</em> </strong> </a></em> </strong> <em class="oe">对成长黑客感兴趣？检查出</em> </a><a class="ae lr" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="oe">电路</em> </strong> </a> <strong class="kh ir"> <em class="oe">。</em>T76】</strong></p></div></div>    
</body>
</html>