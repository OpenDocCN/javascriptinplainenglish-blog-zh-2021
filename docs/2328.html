<html>
<head>
<title>Host a Node Server on Firebase for Free</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Firebase上免费托管一个节点服务器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/hosting-a-node-server-on-firebase-for-free-82c0d123e369?source=collection_archive---------3-----------------------#2021-05-15">https://javascript.plainenglish.io/hosting-a-node-server-on-firebase-for-free-82c0d123e369?source=collection_archive---------3-----------------------#2021-05-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="fb25" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">好吧，也许会有一点点费用，但实际上是免费的。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/6661a35d6ec166b2281c1420ff0f437f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F-o3D07YSf-w6qyIhrH4Og.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@_ferh97?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Fernando Hernandez</a> on <a class="ae ks" href="https://unsplash.com/s/photos/programming-minimal?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="cf69" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">问题是</h1><p id="a93f" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">最近，我开始创建自己的网站(是的，对于一个软件开发人员来说，早就应该这样做了),我立刻遇到了所有这些问题:编码堆栈、托管、模板；仅举几个例子。我最大的问题似乎是托管，因为我不想在托管一个可能不会收到太多流量的网站上超支。</p><h1 id="61c9" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">解决方案</h1><p id="019e" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">引入Firebase托管。</p><p id="51d1" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">你不仅可以获得免费的静态网站托管，你还可以免费托管一个节点服务器。</p><blockquote class="mm mn mo"><p id="be78" class="ll lm mp ln b lo mh jo lq lr mi jr lt mq mj lw lx mr mk ma mb ms ml me mf mg ig bi translated">这里假设您已经安装了Firebase CLI，并且在Firebase上有一个帐户设置，如果没有，您可以按照<a class="ae ks" href="https://firebase.google.com" rel="noopener ugc nofollow" target="_blank">这个</a>创建一个配置文件，然后按照<a class="ae ks" href="https://firebase.google.com/docs/cli" rel="noopener ugc nofollow" target="_blank">这个</a>设置CLI。</p></blockquote><h1 id="971b" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">创建项目</h1><blockquote class="mm mn mo"><p id="4ea3" class="ll lm mp ln b lo mh jo lq lr mi jr lt mq mj lw lx mr mk ma mb ms ml me mf mg ig bi translated">如果你不想经历创建项目和设置Firebase的过程，你可以从我的GitHub repo这里拉一个模板:<a class="ae ks" href="https://github.com/DarrynJ/nodejs-firebase-backend" rel="noopener ugc nofollow" target="_blank">https://github.com/DarrynJ/nodejs-firebase-backend</a></p></blockquote><p id="c2a4" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">好了，一旦你启动并运行了Firebase CLI，导航到你的项目文件夹并打开你的终端。</p><p id="ef46" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">有趣的事情来了！</p><p id="af82" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">您希望首先使用以下命令初始化Firebase主机:</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="9766" class="my ku in mu b gy mz na l nb nc">firebase init hosting</span></pre><p id="9d28" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">您应该会遇到类似以下的情况:</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="0364" class="my ku in mu b gy mz na l nb nc">You're about to initialize a Firebase project in this directory:</span><span id="f501" class="my ku in mu b gy nd na l nb nc">/{your project directory}/{project name}</span><span id="13b9" class="my ku in mu b gy nd na l nb nc">=== Project Setup</span><span id="8c12" class="my ku in mu b gy nd na l nb nc">First, let's associate this project directory with a Firebase project.<br/>You can create multiple project aliases by running firebase use --add, <br/>but for now we'll just set up a default project.</span><span id="2161" class="my ku in mu b gy nd na l nb nc">? Please select an option: (Use arrow keys)<br/>❯ Use an existing project <br/>  Create a new project <br/>  Add Firebase to an existing Google Cloud Platform project <br/>  Don't set up a default project</span></pre><p id="a019" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">如果您已经在控制台中创建了Firebase项目，选择<strong class="ln io">使用现有项目，</strong>否则选择<strong class="ln io">创建新项目</strong>并按照提示进行操作。</p><p id="91e0" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">一旦完成，你应该有一个如下的文件夹结构:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/df17b11e9524e696438cebf03f4700da.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*AcSiIidDa28C23_ZUZxFqw.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">VSCode folder structure</figcaption></figure><p id="6cc9" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">现在，您想使用以下命令初始化Firebase函数:</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="a2e5" class="my ku in mu b gy mz na l nb nc">firebase init functions</span></pre><p id="9d83" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">您应该会遇到以下情况:</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="3abf" class="my ku in mu b gy mz na l nb nc">=== Project Setup</span><span id="fb13" class="my ku in mu b gy nd na l nb nc">First, let's associate this project directory with a Firebase project.<br/>You can create multiple project aliases by running firebase use --add, <br/>but for now we'll just set up a default project.</span><span id="644c" class="my ku in mu b gy nd na l nb nc">=== Functions Setup</span><span id="81f9" class="my ku in mu b gy nd na l nb nc">A functions directory will be created in your project with a Node.js<br/>package pre-configured. Functions can be deployed with firebase deploy.</span><span id="e3ac" class="my ku in mu b gy nd na l nb nc">? What language would you like to use to write Cloud Functions? (Use arrow keys)<br/>❯ JavaScript <br/>  TypeScript</span></pre><p id="9487" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">为了简单起见，选择JavaScript，然而前面提到的GitHub项目使用的是TypeScript。</p><p id="7a1c" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">我想这完全取决于你的喜好。</p><p id="da3f" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">按照提示操作，直到一切完成，并且您看到了以下更新的文件夹结构:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/7650a70b55a78e2826155d2035e64046.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*SqEejZdv2L6wtzyDbSGw6g.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Updated folder structure.</figcaption></figure><p id="8a55" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">就这样，您已经设置好了您的主机和功能，并且几乎准备好部署到Firebase了。</p><p id="6113" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">要设置您的服务器，打开<strong class="ln io">功能</strong>文件夹下的<code class="fe nf ng nh mu b">index.js</code>。初始化应该添加几行注释掉的代码。您可以取消对这些行的注释，并使用<code class="fe nf ng nh mu b">firebase serve</code>运行您的项目，您可以看到您的项目在运行。</p><p id="5782" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">您可以继续部署您的项目，并在真实环境中查看它的运行情况，但首先，让我们真正将它变成一个后端服务器。</p><p id="63aa" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">首先，使用以下命令安装<strong class="ln io"> express </strong>:</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="86bf" class="my ku in mu b gy mz na l nb nc">npm i express --save</span></pre><p id="3382" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">一旦安装了express，在<strong class="ln io"> index.js </strong>文件中，添加以下代码行:</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="2742" class="my ku in mu b gy mz na l nb nc">const functions = require("firebase-functions");</span><span id="eb9b" class="my ku in mu b gy nd na l nb nc">const express = require("express");</span><span id="8caa" class="my ku in mu b gy nd na l nb nc">const server = express();<br/></span><span id="d531" class="my ku in mu b gy nd na l nb nc">server.get("/some-data", (<em class="mp">request</em>, <em class="mp">response</em>) =&gt; {</span><span id="b2c7" class="my ku in mu b gy nd na l nb nc"><em class="mp">    response</em>.send("Hello world");</span><span id="7c56" class="my ku in mu b gy nd na l nb nc">});<br/></span><span id="5aca" class="my ku in mu b gy nd na l nb nc"><em class="mp">exports</em>.app = functions.https.onRequest(server);</span></pre><p id="3f17" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">这只是添加了一个简单的express服务器，它处理端点请求并返回<strong class="ln io"> Hello World </strong>作为响应。</p><p id="1744" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">最后，您希望用以下配置更新<strong class="ln io"> firebase.json </strong>文件:</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="53fe" class="my ku in mu b gy mz na l nb nc">"rewrites": [</span><span id="150c" class="my ku in mu b gy nd na l nb nc">    {</span><span id="4961" class="my ku in mu b gy nd na l nb nc">        "source": "**",</span><span id="918a" class="my ku in mu b gy nd na l nb nc">        "function": "app"</span><span id="79a7" class="my ku in mu b gy nd na l nb nc">    }</span><span id="fcc2" class="my ku in mu b gy nd na l nb nc">],</span></pre><blockquote class="mm mn mo"><p id="9579" class="ll lm mp ln b lo mh jo lq lr mi jr lt mq mj lw lx mr mk ma mb ms ml me mf mg ig bi translated">请确保将其置于您的<strong class="ln io">“公共”</strong>配置设置下。</p></blockquote><p id="2f66" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">这样做的目的是指定所有的<strong class="ln io">重写</strong>都将指向你的<strong class="ln io">函数</strong> <strong class="ln io">应用</strong>。</p><h1 id="0615" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">部署您的项目</h1><p id="6f30" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">部署您的项目很简单，只需要执行一行命令:</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="18c0" class="my ku in mu b gy mz na l nb nc">firebase deploy</span></pre><p id="bb46" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">这将执行您的主机和功能到您的中的<strong class="ln io"> Firebase应用程序</strong>的部署。<strong class="ln io"> firebaserc </strong>文件。</p><p id="c217" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">在这里，您可能需要将您的计划更新为<strong class="ln io">现收现付</strong>计划。</p><blockquote class="mm mn mo"><p id="b4be" class="ll lm mp ln b lo mh jo lq lr mi jr lt mq mj lw lx mr mk ma mb ms ml me mf mg ig bi translated">如果您的请求没有超过该计划规定的最低限额，您最终可能会免费获得所有东西。只是一定要监控你的流量。</p></blockquote><h1 id="e8b8" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">结论</h1><p id="d2f1" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">仅此而已。您已经创建了一个节点服务器项目，并部署到Firebase，几乎没有任何托管开销。</p><p id="6db3" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">用Firebase托管有一些好处，特别是如果你只是想托管一个静态网站，但是我会让你自己去弄清楚。这样做的目的是向您展示使用Firebase作为托管平台来启动和运行节点服务器是多么容易和快速。</p><p id="9c1e" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">请随时关注我在<a class="ae ks" href="https://github.com/DarrynJ" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上的文章，查看我添加一个<a class="ae ks" href="https://github.com/DarrynJ/nodejs-firebase-backend" rel="noopener ugc nofollow" target="_blank">节点服务器的实现，该服务器使用Firebase作为托管平台</a>。</p><p id="c993" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">感谢您的阅读！</p><p id="f96c" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated"><em class="mp">更多内容请看</em><a class="ae ks" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="ln io"><em class="mp">plain English . io</em></strong></a></p></div></div>    
</body>
</html>