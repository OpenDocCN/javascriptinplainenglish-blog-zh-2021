<html>
<head>
<title>How to Get the Current Value of an RxJS Subject or Observable</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何获得RxJS主题或可观察对象的当前值</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-get-the-current-value-of-an-rxjs-subject-or-observable-b5eb666b20f6?source=collection_archive---------0-----------------------#2021-07-28">https://javascript.plainenglish.io/how-to-get-the-current-value-of-an-rxjs-subject-or-observable-b5eb666b20f6?source=collection_archive---------0-----------------------#2021-07-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a795" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">获取RxJS可观察值的当前值——每日角度提示、技巧和最佳实践</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/76bbfc57152f38706e81e8e8cebbbdd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KcO7peN5BibbR5af"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@sharonmccutcheon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sharon McCutcheon</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="19cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为开发人员，学无止境。我们总是需要与时俱进的技术，以及即将到来的或当前的市场趋势特征。</p><p id="5ace" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最近，我在寻找优化我的角度代码的最佳方法。我读过很多文章，我们都知道这是无限的。然后我想到了合并清单，为Angular编写更干净的代码，这对我有帮助，也可能对其他人有帮助。</p><p id="a633" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些小文章不仅能帮助你编写更好的TypeScript或JavaScript代码，还能理清前端技术的概念。这将有助于你建立强大的基础，并能在即将到来的前端面试中帮助你。</p><blockquote class="ls"><p id="b62b" class="lt lu iq bd lv lw lx ly lz ma mb lr dk translated">让我们进入我们的主要讨论</p></blockquote><p id="4060" class="pw-post-body-paragraph kw kx iq ky b kz mc jr lb lc md ju le lf me lh li lj mf ll lm ln mg lp lq lr ij bi translated">前端开发中最基本的主题之一是RxJS的正确使用，它有助于同步我们的代码。我们在日常生活中确实会大量使用Observables，比如使用后端服务或在不同组件之间进行通信。想到的基本问题是我们如何得到可观测值的当前值。</p><p id="37a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在<a class="ae kv" href="https://stackoverflow.com/users/16940/simon-weaver" rel="noopener ugc nofollow" target="_blank"> Simon_Weaver </a>的回答中找到了最好的参考之一。</p><h1 id="5064" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">一般的规则是，你只能用<code class="fe mz na nb nc b">subscribe()</code>从一个可观测值中得到一个值</h1><p id="9c16" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated"><em class="ni">(或异步管道，如果使用角形)</em></p><p id="b688" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> BehaviorSubject: </strong>当我们一订阅它，BehaviorSubject就会保存之前的值，它会发送之前的值或者初始化它的值。</p><pre class="kg kh ki kj gt nj nc nk nl aw nm bi"><span id="d200" class="nn mi iq nc b gy no np l nq nr"><a class="ae kv" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank">@Component</a>({<br/>    selector: 'my-app',<br/>    providers: [],<br/>    template: `<br/>    &lt;h3&gt;Accessing BehaviorSubject's Value&lt;/h3&gt;</span><span id="6b1e" class="nn mi iq nc b gy ns np l nq nr">&lt;input [(ngModel)]="currentValue" type="text"&gt; <br/>    &lt;br&gt;<br/>    &lt;br&gt;</span><span id="8764" class="nn mi iq nc b gy ns np l nq nr">current Value is: &lt;b&gt;{{currentValue}}&lt;/b&gt;<br/>  `,<br/>})<br/>export class AppComponent {<br/>    subject = new BehaviorSubject('default');</span><span id="32a5" class="nn mi iq nc b gy ns np l nq nr">get currentValue() {<br/>        return this.subject.value;<br/>    }</span><span id="acc7" class="nn mi iq nc b gy ns np l nq nr">set currentValue(v) {<br/>        this.subject.next(v);<br/>    }<br/>}</span></pre><h1 id="8bc5" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">方法:1</h1><p id="aeae" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">更好的方法总是使用<code class="fe mz na nb nc b">subscribe</code>来获取一个值。</p><pre class="kg kh ki kj gt nj nc nk nl aw nm bi"><span id="8fcc" class="nn mi iq nc b gy no np l nq nr">//emit 1,2,3,4,5</span><span id="a3c3" class="nn mi iq nc b gy ns np l nq nr">const source = of(1, 2, 3, 4, 5);</span><span id="99c5" class="nn mi iq nc b gy ns np l nq nr">//take the first emitted value then complete</span><span id="d717" class="nn mi iq nc b gy ns np l nq nr">const example = source.pipe(take(1));</span><span id="8b76" class="nn mi iq nc b gy ns np l nq nr">//output: 1</span><span id="712a" class="nn mi iq nc b gy ns np l nq nr">const subscribe = example.subscribe(val =&gt; console.log(val));</span></pre><p id="b4f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运筹学</p><pre class="kg kh ki kj gt nj nc nk nl aw nm bi"><span id="4548" class="nn mi iq nc b gy no np l nq nr">const source = from([1, 2, 3, 4, 5]);</span><span id="faa0" class="nn mi iq nc b gy ns np l nq nr">//no arguments, emit first value</span><span id="657f" class="nn mi iq nc b gy ns np l nq nr">const example = source.pipe(first());</span><span id="8f91" class="nn mi iq nc b gy ns np l nq nr">//output: "First value: 1"</span><span id="f121" class="nn mi iq nc b gy ns np l nq nr">const subscribe = example.subscribe(val =&gt; console.log(`First value: ${val}`));</span></pre><p id="a21c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果流已经完成，这两个实体之间的差异<code class="fe mz na nb nc b">first()</code>将产生错误<strong class="ky ir">；如果流已经完成或者没有立即可用的值，则</strong>将不会发出任何可观察到的结果。</p><h1 id="c90c" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">方法:2</h1><p id="2550" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">不要试图访问你的函数中的值，<strong class="ky ir">而是考虑一个函数，它创建了一个新的可观测值，甚至没有订阅它！</strong></p><p id="e4f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过保持一切都是可观察的，并使用<code class="fe mz na nb nc b">switchMap</code>来做决定，你可以创造新的可观察的事物，这些事物本身可以成为其他可观察事物的来源。</p><pre class="kg kh ki kj gt nj nc nk nl aw nm bi"><span id="056d" class="nn mi iq nc b gy no np l nq nr">bear$: Observable&lt;string&gt; = of('Beary');<br/>lion$: Observable&lt;string&gt; = of('Liony');<br/>zooOpen$: Observable&lt;boolean&gt; = of(true);</span><span id="ebb0" class="nn mi iq nc b gy ns np l nq nr">getZooReport() {</span><span id="4cfd" class="nn mi iq nc b gy ns np l nq nr">return this.data$.pipe(switchMap(zooOpen =&gt; {</span><span id="9f2b" class="nn mi iq nc b gy ns np l nq nr">if (zooOpen) {</span><span id="f2d7" class="nn mi iq nc b gy ns np l nq nr">return combineLatest(this.bear$, this.lion$).pipe(map(([bear, lion] =&gt; {</span><span id="1f6a" class="nn mi iq nc b gy ns np l nq nr">// this is inside 'map' so return a regular string<br/>                 return "Welcome to the zoo! Today we have a bear called ' + bear + ' and a lion called ' + lion;<br/>              }<br/>          );<br/>      }<br/>      else {</span><span id="7398" class="nn mi iq nc b gy ns np l nq nr">// this is inside 'switchMap' so *must* return an observable<br/>         return of('Sorry the zoo is closed today!');<br/>      }</span><span id="a1ba" class="nn mi iq nc b gy ns np l nq nr">});<br/> }</span></pre><p id="2465" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">来源:</strong></p><div class="nt nu gp gr nv nw"><a href="https://stackoverflow.com/questions/37339016/get-current-value-from-observable-without-subscribing-just-want-value-one-time" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ir gy z fp ob fr fs oc fu fw ip bi translated">从不订阅的可观察值中获取当前值(只需要一次值)</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">我只想要一次当前值，而不是新值，因为它们正在到来…您仍将使用subscribe，但是…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">stackoverflow.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok kp nw"/></div></div></a></div><h2 id="90a8" class="nn mi iq bd mj ol om dn mn on oo dp mr lf op oq mt lj or os mv ln ot ou mx ov bi translated">如果你喜欢并想获得更多这样的内容，请做<a class="ae kv" href="https://medium.com/@patel_ap/membership" rel="noopener">订阅</a></h2><h1 id="6053" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">延伸阅读:</h1><div class="nt nu gp gr nv nw"><a rel="noopener  ugc nofollow" target="_blank" href="/a-guide-to-the-20-best-vscode-extensions-for-frontend-developers-f75a5d716091"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ir gy z fp ob fr fs oc fu fw ip bi translated">面向前端开发人员的20个最佳VSCode扩展指南</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">面向前端开发的VSCode最有用扩展的综合指南</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="of l"><div class="ow l oh oi oj of ok kp nw"/></div></div></a></div><div class="nt nu gp gr nv nw"><a rel="noopener  ugc nofollow" target="_blank" href="/top-100-questions-you-must-prepare-for-to-ace-your-next-angular-interview-10-20-c3f5ab854be"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ir gy z fp ob fr fs oc fu fw ip bi translated">为赢得下一次面试，你必须准备的100个问题(10-20)</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">最常见的角度面试问题2021</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="of l"><div class="ox l oh oi oj of ok kp nw"/></div></div></a></div><div class="nt nu gp gr nv nw"><a rel="noopener  ugc nofollow" target="_blank" href="/33-javascript-useful-shorthands-cheat-list-2021-e08b46a1a688"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ir gy z fp ob fr fs oc fu fw ip bi translated">33 JavaScript有用的速记作弊清单:2021</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">使用现代速记技术、技巧和诀窍优化您的JavaScript代码。</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="of l"><div class="oy l oh oi oj of ok kp nw"/></div></div></a></div><p id="de78" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ni">更多内容看</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ni">plain English . io</em></strong></a></p></div></div>    
</body>
</html>