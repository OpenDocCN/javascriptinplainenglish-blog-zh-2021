<html>
<head>
<title>Still Using Twilio Functions Classic? Here are 8 Reasons Why You Should Migrate to the CLI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">还在用Twilio Functions Classic？以下是您应该迁移到CLI的8个原因</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/still-using-twilio-functions-classic-here-are-8-reasons-why-you-should-migrate-to-the-cli-8dcbec8b46a?source=collection_archive---------12-----------------------#2021-06-17">https://javascript.plainenglish.io/still-using-twilio-functions-classic-here-are-8-reasons-why-you-should-migrate-to-the-cli-8dcbec8b46a?source=collection_archive---------12-----------------------#2021-06-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ca37" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">命令行界面是现代的，易于管理，完全可定制。这是显而易见的。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/38cd5837c009bd6676e1e2ea8d5b8b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gK1JgpZZZ-L-A9f_"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@whoisdenilo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Who’s Denilo ?</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="dd77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与标准API相比，运行函数是与Twilio交互的一种很好的方式，该公司最近的开源命令行界面(CLI)进一步展示了传统UI (Functions Classic)的众多优势。</p><p id="d12f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于那些还没有过渡到CLI的人来说，这里有8个你应该迁移Twilio函数的理由。</p><h2 id="e967" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">1.节省时间和创造效率</h2><p id="83e6" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">如果您在多种环境下运行代码，您会理解即使是最简单的更新也是如此耗时。</p><p id="8c75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你在你的一个函数中发现了一个bug。您在您的开发环境中进行并确认修复。然后将它部署到试运行和生产环境中。首先，您必须复制您修复的函数的整个代码，然后登录到临时环境，导航到函数，找到适当的部分并粘贴更新。接下来，您需要花时间验证您在staging中的修复，以确保您的更新没有破坏任何东西。完成所有这些后，冲洗并重复进行生产。</p><p id="57d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个例子涵盖了一个函数中的一个bug。在一切顺利的最佳情况下，这个过程可能需要15分钟以上。但是如果你在多个不同的功能中有多个变化，你可能会浪费几个小时。</p><p id="afef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">相比之下，使用CLI时，工作流要简单得多。您在代码编辑器中进行了更改，并启动了一个本地实例来验证修复。然后你写一些单元测试，推送到Github审核。一旦合并，拉动主分支，用一条线就可以部署到任何环境。任务完成。</p><h2 id="ed58" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">2.复制和粘贴容易出错</h2><p id="05dc" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在不同环境之间复制和粘贴时，很容易产生错误，这种风险会随着更改数量的增加而成倍增加。</p><p id="8766" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您在暂存环境中拥有的阻止事件发送到统计和监控仪表板的一行程序很容易在您忘记其重要性时被覆盖，从而导致进一步升级和更多麻烦。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/e854a20609bbe50cd7de73e7ddf7ac58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Pwsv_YLiUr-o_mzP"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@yancymin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Yancy Min</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="103f" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">3.改进的版本控制</h2><p id="b953" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">想象一下这样的场景:您刚刚点击了保存按钮，部署了一个小的更改，应该可以解决您的所有问题，但却意识到这个小的更改已经破坏了您的整个会议基础架构，现在代理无法拨打或接听电话。现在，您必须遍历所有代码，试图找出问题所在。</p><p id="3092" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你幸运的话，浏览器窗口可能仍然是打开的，也许cmd + z可以工作。或者，您可以在本地使用代码编辑器进行编辑，这样您就可以通过历史记录进行循环。如果没有，这将是一个漫长的夜晚，而你通过工作的错误。</p><p id="914b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Twilio的Functions UI没有任何版本控制，所以如果出现问题，没有恢复到工作版本的选项。如果你在凌晨4点回复页面，很难知道谁做了最后的更新，他们修改了什么，什么时候发布的。</p><p id="4bba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您使用的是CLI，您可以从Git中调出以前的版本，在几秒钟内重新部署，然后就可以睡觉了。</p><h2 id="534d" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">4.更好的代码突出显示和林挺</h2><p id="69d8" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">第4点和第5点是一脉相承的，目标是开发人员在函数编辑器中的体验。</p><p id="d324" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个好的代码编辑器(比如VS代码)最有用的部分之一是语法高亮和代码完成。虽然函数UI提供了一些代码完成功能，但它并不接近代码编辑器中可用的标准。代码高亮也是静音的，不可定制，限制了它的有效性。</p><p id="2d99" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">定制的方式也延伸到了林挺。使用函数UI，编辑器显示警告和潜在的错误，但它们通常不是很有用。没有办法自定义警告或禁用你认为不必要的通知。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/540f25ced888401073448376f3215e07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4E9UOPNq4g4ayl_2lreXrA@2x.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Side by side comparison of the Twilio Functions Classic UI (left) vs The same code in VS code (right). Being able to customise appearance and styles makes working with functions much nicer. VS code supports dark mode and allows you to disable warnings for missing semicolons (if that’s your code style).</figcaption></figure><h2 id="aa02" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">5.使用CLI实现更好的日志记录</h2><p id="2a74" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">当试图编写代码或调试问题时，使用简单的<code class="fe ms mt mu mv b">console.log</code>调用是查看变量当前状态的有效方法。在Functions Classic中，这些控制台日志出现在日志记录窗口中，并且经常被截断，使得处理大型对象或数据集成为一项挑战。每次会话结束时，日志也会被清除，这限制了您离开后的访问。</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="b413" class="ls lt iq mv b gy na nb l nc nd">{"PATH":"/helloWorld","WORKFLOW_ABSENCE_VOICEMAIL_SID":"WWxxxxxxxxxxxxxxxxxxxxxxxEXAMPLE","CHAT_TASKCHANNEL_SID":"TCxxxxxxxxxxxxxxxxxxxxxxxEXAMPLE","TWILIO_WORKFLOW_EMERGENCYROUTING_SID":"WWxxxxxxxxxxxxxxxxxxxxxxxEXAMPLE","OUTBOUND_TASK_CHANNEL":"outboundcall","CHAT_BACK_END_DOMAIN":"<a class="ae kv" href="https://chat-demo.ta-kube-d.com" rel="noopener ugc nofollow" target="_blank">https://example.com</a>","ENV":"DEV","RUNTIME_DOMAIN":"<a class="ae kv" href="https://byzantine-caterpillar-1773.twil.io" rel="noopener ugc nofollow" target="_blank">https://funky-kangeroo-1823.twil.io</a>","JAPANESE_C...</span></pre><p id="2130" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用CLI时，您可以使用端点旋转本地实例并对其进行调用。Console.logs完全按照它们应该的方式工作，将带有堆栈跟踪的完整日志打印到终端中。这意味着您可以比在UI上更快地迭代修复，因此您可以找到破坏您的构建的打字错误，并继续进行重要的工作。</p><h2 id="a785" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">6.用于更新包的改进工具</h2><p id="d006" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">维护安全代码的一个重要部分是在代码中保持与包更新同步的过程。Twilio函数依赖项可以在环境变量下的配置选项卡中找到，但是没有办法知道哪些已经过时，更重要的是，哪些由于安全漏洞需要更新。</p><p id="a864" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">配置后，CLI允许您使用dependabot监控过时的依赖关系。在Github的pull请求中，会自动标记和修复过期的包。如果你有很好的测试覆盖率，这些更新可以很快合并，让你完全放心。如果你愿意，你也可以使用<code class="fe ms mt mu mv b">npm outdated</code>和<code class="fe ms mt mu mv b">npm audit</code>在本地显示过时的包。</p><h2 id="a17f" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated"><strong class="ak"> 7。没有本地单元测试</strong></h2><p id="33ce" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在部署到生产环境时，测试代码让您高枕无忧。如果测试通过，您可以相当自信地认为您的代码将继续运行良好，并且不太可能在凌晨4点中断(显然这取决于具有良好覆盖率的编写良好的测试)。对于每天被调用数百次甚至数千次的函数来说，知道您的修复没有破坏所有东西是很重要的。</p><p id="5559" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Twilio Functions经典UI不提供单元测试。是的，您可能会创建类似于API测试的东西，在那里您调用端点并查看返回的内容，但是这是次优的。</p><h2 id="8822" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">8.这是一个传统工具</h2><p id="becf" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">自从Twilio <a class="ae kv" href="https://www.twilio.com/changelog/new-serverless-api-deploy-functions-and-assets" rel="noopener ugc nofollow" target="_blank">在2019年8月宣布其新的无服务器API </a>以来，Functions UI的日子已经屈指可数，该API允许工程师通过CLI部署功能。</p><p id="9fbe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2020年8月31日<a class="ae kv" href="https://www.twilio.com/changelog/all-new-functions-and-assets-ui-now-available" rel="noopener ugc nofollow" target="_blank">，Twilio更新了函数UI </a>，增加了一系列新功能，使CLI版本更好，将原始版本重命名为“函数经典”，并将其命名为Legacy。这意味着Twilio将不再推送该版本的更新，因此不会对之前的7个问题进行修复。考虑到这一点，没有任何理由说明Functions Classic应该放在开发人员的工具箱中。</p><h2 id="3215" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">更好的选择</h2><p id="5fed" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">开始使用CLI真的非常容易。只需前往由传奇人物菲尔·纳什和其他人维护的<a class="ae kv" href="https://github.com/twilio-labs/create-twilio-function" rel="noopener ugc nofollow" target="_blank">Create-Twilio-Function repo</a>，然后运行<code class="fe ms mt mu mv b">npm init twilio-function your-directory-name-here</code>。这将安装和配置一个工作函数环境，您可以在其中构建和运行函数。</p><p id="cee1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你缺乏想法或者被一个bug卡住了，那么<a class="ae kv" href="https://github.com/twilio-labs/function-templates" rel="noopener ugc nofollow" target="_blank">函数模板repo </a>有一个知识宝库可以帮助你。</p><p id="fd15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用CLI意味着您拥有在Git中运行项目的所有优势，这对跨团队工作非常有用。您还可以在本机编辑器中编码，该编辑器带有语言突出显示和代码完成功能。通过扩展，这也允许您轻松地配置林挺，以符合编码标准。</p><p id="a883" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在TripActions，我们还使用Jest和Sonarcloud 为我们的函数环境设置了单元测试<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/making-sonarcloud-play-nicely-with-jest-fa271f559024">，目前代码覆盖率约为96%。我们现在可以安心地进行部署，因为我们知道我们的更改不会导致严重的问题。</a></p><p id="52cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以这种方式工作是一种非常愉快的经历。</p><p id="d0e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/twilio-labs/create-twilio-function" rel="noopener ugc nofollow" target="_blank">Create-Twilio-Function repo</a>是<a class="ae kv" href="https://github.com/twilio-labs/serverless-toolkit" rel="noopener ugc nofollow" target="_blank">无服务器工具包</a>的一部分。这为终端带来了Twilio APIs的强大功能，并允许开发人员无缝、无压力地构建代码并将其部署到多个环境中。</p><p id="b0a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Twilio还继续为新版本的Twilio函数带来新的功能，使其成为一个充满活力的地方。</p><p id="3300" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以就去做吧。进行跳跃。你不会后悔的。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="27d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您花时间阅读本文</p><p id="29df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大卫</p><p id="44d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">高级前端开发者@ <a class="ae kv" href="https://tripactions.com/" rel="noopener ugc nofollow" target="_blank"> TripActions </a>(通常是<a class="ae kv" href="https://grnh.se/cbeb241d1" rel="noopener ugc nofollow" target="_blank">雇佣</a>！)</p><p id="3e2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nn">更多内容请看</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="nn">plain English . io</em></a></p></div></div>    
</body>
</html>