<html>
<head>
<title>Speed Up Your Workflows with GitHub-Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GitHub加速您的工作流程-行动</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/speed-up-your-workflows-with-github-actions-b3928069443f?source=collection_archive---------5-----------------------#2021-08-01">https://javascript.plainenglish.io/speed-up-your-workflows-with-github-actions-b3928069443f?source=collection_archive---------5-----------------------#2021-08-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2226cd749904ab67fb95543859a567f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wr-pTA4_CDWVZ5TuFq4aGw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo from Dev.to</figcaption></figure><p id="3759" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> GitHub Actions </strong>是由GitHub提供的一个工具/服务，帮助您构建、测试和部署应用程序。GitHub Actions帮助您在存储代码的同一个地方实现软件开发工作流的自动化，GitHub。此外，在请求和问题上进行协作。有了它们，您可以直接在存储库中构建端到端的连续集成(CI)和连续部署(CD)功能。</p><p id="edb9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">工作流</strong>是定制的自动化流程，是单个任务(<em class="la">操作</em>的组合，您可以在您的存储库中设置以构建、测试、打包、发布或部署您的项目。我们可以编写我们的定制工作流，或者从GitHub市场获得工作流。我们在YAML配置中配置工作流，我们将在存储库中创建该配置，以定义需要执行的操作。</p><p id="e7e6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">运行程序</strong>是安装了GitHub Actions runner应用程序的服务器。我们可以使用由GitHub托管的跑步者，也可以托管您自己的跑步者。在这个演示中，我将向您展示如何在AWS的EC2实例中设置GitHub runner，并通过示例NodeJS项目执行您的工作流。</p><p id="109c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">首先，您需要在GitHub中创建一个存储库来存储您的代码。当您点击基本URL时，我们将使用一个简单的NodeJS应用程序，它将返回消息“API Running”。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/08085d51112cd0aad61d83cb2d88bd6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCeZYmVVzZhMBWQjU7R-bQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Creating GitHub Repository</figcaption></figure><p id="fdba" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">之后，您需要初始化NodeJS项目，并安装以下依赖项来创建基本的NodeJS应用程序。安装express、dotenv和cors作为一般依赖项。在安装了所有必要的依赖项之后，您的package.json将会是这个样子。</p><ul class=""><li id="76f6" class="lg lh iq ke b kf kg kj kk kn li kr lj kv lk kz ll lm ln lo bi translated"><strong class="ke ir"> express </strong>是一个NodeJS框架</li><li id="0046" class="lg lh iq ke b kf lp kj lq kn lr kr ls kv lt kz ll lm ln lo bi translated"><strong class="ke ir">dot NV</strong>允许从源代码中分离秘密。</li><li id="a572" class="lg lh iq ke b kf lp kj lq kn lr kr ls kv lt kz ll lm ln lo bi translated"><strong class="ke ir"> cors </strong>是一种在网络浏览器中实现的机制，允许或拒绝来自不同域的对web应用的请求</li></ul><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="lu lv l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">package.json</figcaption></figure><p id="44bd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然后创建一个名为server.js的文件来创建一个快速服务器，当你点击基本URL<a class="ae lw" href="http://localhost:5000" rel="noopener ugc nofollow" target="_blank">http://localhost:5000</a>时，它会给你“API Running”文本。</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="lu lv l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">server.js</figcaption></figure><p id="1961" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在一切都准备好了。不要担心，在本文的最后，如果您在这个过程中遗漏了什么，我将分享我的完整代码库供您参考。让我们将更改提交给本地存储库，并将更改推送到我们之前创建的远程存储库。为了自动化我们的更改，我们需要在EC2实例中创建一个GitHub runner。</p><p id="1844" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">转到您的GitHub存储库-&gt;设置-&gt;操作-&gt;运行程序-&gt;添加运行程序。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lx"><img src="../Images/03d9f217891e92316f66d114ad9060ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uN1HZEFs3L3z0AQE0ivvOw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">GitHub runner (self-hosted runner)</figcaption></figure><p id="218a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了托管这个GitHub runner，我用默认配置创建了一个自由层EC2实例。对于安全组，我只打开了HTTP端口(80)、自定义端口(5000)和SSH(22)端口。这里我用的是<strong class="ke ir">亚马逊Linux 2 AMI </strong>。因此，命令可能会不同。登录到您的实例后，您需要使用命令“sudo yum update”将实例中的所有包更新到最新版本。之后，按照下载&amp;配置部分提到的说明安装GitHub runner。您应该在/home/ec2-user中配置您的更改。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ly"><img src="../Images/8a5efd8df18b68107bda60007c86d1a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2eFQnFzwCWfx8OaTIuxwKg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Registering GitHub Runner</figcaption></figure><p id="4e74" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要使GitHub runner成为一项服务，请尝试以下命令。</p><pre class="lc ld le lf gt lz ma mb mc aw md bi"><span id="6a42" class="me mf iq ma b gy mg mh l mi mj">sudo ./svc.sh install<br/>sudo ./svc.sh start</span></pre><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/fbbf5be918ac7220719f37f9d540ec1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p4L3Aigv4Fe82Sht45b7Cw.png"/></div></div></figure><p id="4d53" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们已经成功注册了我们的GitHub runner。现在，让我们设置在同一服务器中部署NodeJS应用程序所需的环境。执行以下命令在服务器上安装NodeJS。</p><h1 id="46cf" class="ml mf iq bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">步骤1 —配置Yum存储库</h1><p id="c6f3" class="pw-post-body-paragraph kc kd iq ke b kf ni kh ki kj nj kl km kn nk kp kq kr nl kt ku kv nm kx ky kz ij bi translated">首先你需要在你的系统中启用node.js官网提供的node.js yum库。您还需要开发工具来构建要安装在您的系统上的本地附加组件。</p><pre class="lc ld le lf gt lz ma mb mc aw md bi"><span id="36ad" class="me mf iq ma b gy mg mh l mi mj">sudo yum install -y gcc-c++ make <br/>curl -sL https://rpm.nodesource.com/setup_14.x | sudo -E bash -</span></pre><h1 id="1947" class="ml mf iq bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">步骤2 —在Amazon Linux上安装Node.js</h1><pre class="lc ld le lf gt lz ma mb mc aw md bi"><span id="7cdb" class="me mf iq ma b gy mg mh l mi mj">sudo yum install -y nodejs</span></pre><h1 id="899e" class="ml mf iq bd mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh bi translated">步骤3 —检查版本</h1><pre class="lc ld le lf gt lz ma mb mc aw md bi"><span id="827e" class="me mf iq ma b gy mg mh l mi mj">node -v</span></pre><p id="19bd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们还需要在服务器上安装PM2。PM2是NodeJS应用程序的生产流程管理器，内置负载平衡器。它允许您<strong class="ke ir">保持应用程序永远运行</strong>，在不停机的情况下重新加载它们，并简化常见的系统管理任务。</p><pre class="lc ld le lf gt lz ma mb mc aw md bi"><span id="cf0c" class="me mf iq ma b gy mg mh l mi mj">sudo npm install pm2@latest -g</span></pre><p id="d276" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们已经在服务器上安装了NodeJS &amp; PM2。让我们在应用程序代码中创建工作流。为了创建工作流，我们需要创建一个名为。github，然后在文件夹里面，我们需要创建另一个文件夹叫做workflows。在workflows文件夹中，我们需要创建一个名为node.js.yml的文件，并在YAML配置中添加以下代码。</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="lu lv l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">YAML Configurations</figcaption></figure><p id="9e54" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">做出更改后，您可以将更改推送到GitHub资源库。该变化将被检测到，并将自动触发管道。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/3896458aaa0a99b904d0804ffbfed3d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v7qq0U7WuQmwFoshHBZI2Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">GitHub Actions Pipeline Execution</figcaption></figure><p id="bbb8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您点击您部署的实例URL，它将显示您在服务器上显示的消息。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/0fa3b7027ab5de6e47248b758abaf9f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*tSMu4qAX4mjJ3kfYjO0uvA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Base URL</figcaption></figure><p id="5e43" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，让我们在应用程序中做一个简单的更改，如下所示，并将您的代码推送到您的存储库。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/8d3a86ccd873af9b825fda6a1895ab59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D71roujxMLJQweku36m-9g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">server.js</figcaption></figure><p id="f5f9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">几秒钟之内，您的页面将启动并运行。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/7375038cc8e8d0b5e1002660c64556a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*ygvbNFUIM6Gz08qKQRd4Eg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Base URL</figcaption></figure><p id="a432" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你在这个过程中遇到任何错误，你可以使用GitHub操作控制台和PM2日志来解决。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/842d140a817a17a58548af0a110f63d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1HXUDchgDEGiFrIy0xLG4A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">GitHub Actions Console</figcaption></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/c45683d432004a701d0a64f664e2e91d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*swDlHHHgunFxF285v8bysw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">pm2 logs</figcaption></figure><p id="2128" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你在这个演示过程中错过了什么，我在这篇文章中附上了我在这个演示中使用的GitHub库。</p><div class="nt nu gp gr nv nw"><a href="https://github.com/ezioguga/github-actions" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ir gy z fp ob fr fs oc fu fw ip bi translated">GitHub-ezioguga/GitHub-行动</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">在github上创建一个帐户，为ezioguga/github-actions的发展做出贡献。</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">github.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok jw nw"/></div></div></a></div><p id="fd28" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我要感谢我的朋友Muljayan，他鼓励我使用GitHub Actions，并修复了设置GitHub runner时出现的一些问题。</p><div class="nt nu gp gr nv nw"><a href="https://www.linkedin.com/in/muljayan/" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ir gy z fp ob fr fs oc fu fw ip bi translated">Muljayan J. -斯里兰卡|职业简介| LinkedIn</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">查看Muljayan J .在LinkedIn上的职业简介。LinkedIn是世界上最大的商业网络，帮助…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">www.linkedin.com</p></div></div></div></a></div><p id="b769" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我希望你们喜欢这篇文章。我们再碰上另一个有趣的话题。谢谢你。</p><p id="c663" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="la">更多内容看</em><a class="ae lw" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ke ir"><em class="la">plain English . io</em></strong></a></p></div></div>    
</body>
</html>