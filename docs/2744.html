<html>
<head>
<title>Live Bindings - Difference Between Export Default and Export as Default</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">动态绑定-导出默认值和导出为默认值之间的区别</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/live-bindings-difference-between-export-default-and-export-as-default-4541c354cdaa?source=collection_archive---------4-----------------------#2021-06-05">https://javascript.plainenglish.io/live-bindings-difference-between-export-default-and-export-as-default-4541c354cdaa?source=collection_archive---------4-----------------------#2021-06-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="85cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">JavaScript模块将值导出为动态绑定，除了使用<code class="fe kl km kn ko b">export default</code>。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/c0223c8e06fdb83d0788483ab86f765c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FboogkO4iM8qivoCc0CARw.png"/></div></div></figure><h1 id="d401" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">什么是实时绑定</h1><p id="cbe4" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">JavaScript模块将值导出为动态绑定。术语<em class="me">动态绑定</em>表示对存储导出值的内存位置的引用。换句话说，导出的值通过引用导入它的模块来传递。除了在动态绑定中，变量在JavaScript中从不通过引用传递。</p><h1 id="0d07" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">活动绑定的属性</h1><p id="7ac9" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我使用两个简单的模块来演示动态绑定的属性。</p><p id="9af8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">子模块<em class="me"> child.js </em>将<code class="fe kl km kn ko b">variable</code>导出为其默认导出:</p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="9097" class="mj lc iq ko b gy mk ml l mm mn">// child.js<br/>let variable = "value";<br/>export { variable as default };</span></pre><p id="eff5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">父模块<code class="fe kl km kn ko b">parent.js</code>导入<code class="fe kl km kn ko b">variable</code>并试图赋予它一个新值:</p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="96b8" class="mj lc iq ko b gy mk ml l mm mn">// parent.js<br/>import variable from './child.js';<br/>variable="test"; // produces error: Assignment to constant variable.</span></pre><p id="b74f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当父模块导入由<code class="fe kl km kn ko b">child.js</code>导出的<code class="fe kl km kn ko b">variable</code>时，在父模块范围内创建一个常量<code class="fe kl km kn ko b">variable</code>。试图给<code class="fe kl km kn ko b">variable</code>赋值会产生错误:<em class="me">给常量变量赋值。</em>因此，子模块导出的变量在父模块中变成了常量。</p><p id="7256" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与父模块不同，子模块可以更改变量值，即使是在导出之后。当子模块修改导出的变量时，导入的值(父模块中常量的值)也会改变。为了说明这种现象，我不得不使用更复杂的模块。新版本的<em class="me"> child.js </em>增加了异步任务的调度，改变了<code class="fe kl km kn ko b">variable</code>的值。</p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="b527" class="mj lc iq ko b gy mk ml l mm mn">// child.js<br/>let variable = "value";<br/>setTimeout(() =&gt; variable = "new value");<br/>export { variable as default };</span></pre><p id="4c95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">父模块打印导入的<code class="fe kl km kn ko b">variable</code>的值，并安排任务再次打印值<code class="fe kl km kn ko b">variable</code>。由于子进程首先调度任务(<a class="ae mo" href="https://marian-caikovski.medium.com/execution-order-of-javascript-modules-ddaca4561220" rel="noopener">更多关于模块执行顺序</a>，父进程调度的任务肯定会在<code class="fe kl km kn ko b">variable</code>改变后执行。</p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="360e" class="mj lc iq ko b gy mk ml l mm mn">// parent.js<br/>import variable from './child.js';</span><span id="3e16" class="mj lc iq ko b gy mp ml l mm mn">console.log(variable); // prints value <br/>setTimeout(()=&gt;console.log(variable)); prints new value</span></pre><p id="8adc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">父级打印出相同的看似常量<code class="fe kl km kn ko b">variable</code>的两个不同值——首先是初始<em class="me">值</em>，然后是更新的<em class="me">新值</em>。</p><h1 id="c2e5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">默认导出语法-导出变量的两种方法</h1><p id="5302" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">可以使用以下两种语句之一将变量导出为默认导出:</p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="7f42" class="mj lc iq ko b gy mk ml l mm mn">export default variable;</span></pre><p id="51f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者</p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="c69d" class="mj lc iq ko b gy mk ml l mm mn">export { variable as default };</span></pre><p id="0ea4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个语句显然更短。那么，为什么我必须使用更麻烦的默认导出语句来演示实时绑定呢？</p><h1 id="4c76" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">导出默认值和导出为默认值之间的区别</h1><p id="2529" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated"><code class="fe kl km kn ko b">export default variable</code>和<code class="fe kl km kn ko b">export { variable as default }</code>产生的活绑定是不等价的。为了说明区别，我在<em class="me"> child.js: </em>中用更短的<code class="fe kl km kn ko b">export default variable</code>替换了<code class="fe kl km kn ko b">export { variable as default }</code></p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="229f" class="mj lc iq ko b gy mk ml l mm mn">// child.js<br/>let variable = "value";<br/>setTimeout(() =&gt; variable = "new value");<br/>export default variable;</span></pre><p id="b164" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在父模块看不到子模块修改了导出的<code class="fe kl km kn ko b">variable.</code>，它打印两倍于导入的<code class="fe kl km kn ko b">variable</code>的初始<em class="me">值</em>:</p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="c554" class="mj lc iq ko b gy mk ml l mm mn">// parent.js<br/>import variable from './child.js';</span><span id="daa9" class="mj lc iq ko b gy mp ml l mm mn">console.log(variable); // prints value<br/>setTimeout(()=&gt;console.log(variable)); // still prints value</span></pre><p id="3cb4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用更简洁的语法<code class="fe kl km kn ko b">export default variable</code>，似乎无法创建动态绑定，或者无法像预期的那样工作。导入的<code class="fe kl km kn ko b">variable</code>现在表现为一个实常量。</p><p id="c9fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是两种默认导出语法的主要区别。<code class="fe kl km kn ko b">export { variable as default }</code>将引用导出到导出的<code class="fe kl km kn ko b">variable</code>，而对于<code class="fe kl km kn ko b">export default variable</code>，导入模块不接收对导出的<code class="fe kl km kn ko b">variable</code>的引用。</p><h1 id="977e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">为什么语句export default variable不导出到变量的活动绑定</h1><p id="4092" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">首先，一点术语。一个<em class="me">文字</em>是代表一个值的源代码。Literal不是变量，它是赋给变量的。</p><p id="01c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">语句<code class="fe kl km kn ko b">export default</code>用于文字和匿名声明的导出。例如，导出匿名函数的模块:</p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="153c" class="mj lc iq ko b gy mk ml l mm mn">export default value =&gt; console.log(value);</span></pre><p id="c4f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者导出字符串文字的模块:</p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="20de" class="mj lc iq ko b gy mk ml l mm mn">export default "value";</span></pre><p id="509d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">JavaScript引擎如何将活动绑定导出到文字？它将文本赋给一个辅助变量，并创建一个到自动创建的变量的活动绑定。基本上，代码行<code class="fe kl km kn ko b">export default value”;</code>被转换成如下代码:</p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="9d9d" class="mj lc iq ko b gy mk ml l mm mn">const automaticallyCreatedVariable="value";<br/>export {automaticallyCreatedVariable as default};</span></pre><p id="bb20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">JavaScript代码无法访问合成变量<code class="fe kl km kn ko b">automaticallyCreatedVariable</code>。</p><p id="2918" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当<code class="fe kl km kn ko b">export default</code>用于导出变量时，情况完全相同。它的值被复制到另一个辅助变量中，对该变量的引用被公开为一个活动绑定。</p><h1 id="06e4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Rollup bundler如何复制默认导出的实时绑定</h1><p id="a1fd" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">在某些应用程序中，捆绑模块是有意义的。Rollup是一个易于定制的用户友好的JavaScript模块捆绑包。</p><p id="305a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Rollup将上面的例子和<code class="fe kl km kn ko b">export { variable as default }</code>组合成一个包，它复制了动态绑定的属性:</p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="9a6c" class="mj lc iq ko b gy mk ml l mm mn">let variable = "value";<br/>setTimeout(() =&gt; variable = "new value");</span><span id="6f9f" class="mj lc iq ko b gy mp ml l mm mn">console.log(variable); // prints value<br/>setTimeout(()=&gt;console.log(variable)); // prints new value</span></pre><p id="fb44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">带有<code class="fe kl km kn ko b">export default variable</code>的示例，其中活动绑定似乎不起作用，被组合在一个捆绑包中，该捆绑包也使用上述机制复制结果:</p><pre class="kq kr ks kt gt mf ko mg mh aw mi bi"><span id="5e54" class="mj lc iq ko b gy mk ml l mm mn">let variable = "value";<br/>setTimeout(() =&gt; variable = "new value");<br/>var variable$1 = variable; // synthetic variable$1 is created</span><span id="faa5" class="mj lc iq ko b gy mp ml l mm mn">console.log(variable$1); // parent does not receive variable<br/>setTimeout(()=&gt;console.log(variable$1));</span></pre></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="7d9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整的示例代码可以从<a class="ae mo" href="https://github.com/marianc000/liveBindings" rel="noopener ugc nofollow" target="_blank">https://github.com/marianc000/liveBindings</a>下载并在浏览器中执行。</p><p id="d187" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="me">更多内容参见</em> <a class="ae mo" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="me">简单英语</em> </a></p></div></div>    
</body>
</html>