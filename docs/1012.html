<html>
<head>
<title>JavaScript: Mutable vs. Immutable</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript:可变与不可变</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-mutable-vs-immutable-1efb662d78c8?source=collection_archive---------10-----------------------#2021-03-03">https://javascript.plainenglish.io/javascript-mutable-vs-immutable-1efb662d78c8?source=collection_archive---------10-----------------------#2021-03-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="48db" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">快速浏览某些数据和结构类型的可变性和不变性。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/43a2a545dbd66891f76206306ffdbb6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vqdcbCtJsUDkkTfA"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@rossf?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ross Findon</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3e53" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">又是一天，又一次深入JS基础知识的世界。当我上周写关于<a class="ae ks" rel="noopener ugc nofollow" target="_blank" href="/javascript-everything-is-an-object-or-is-it-2f1092403dc3">数据&amp;结构类型</a>的文章时，我偶然发现了可变数据和不可变数据。我接近文章的结尾，但意识到我离题太远了(这并不难)，所以我删除了这一部分。然而，这个概念一直困扰着我。</p><p id="6536" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">JavaScript有一些棘手的问题，至今仍然困扰着我。(<em class="lp">我不小心先写了“……至今还在</em> <strong class="kv io"> <em class="lp"> git </em> </strong> <em class="lp">我”，想不出为什么中间加了下划线</em>🤦🏻‍♂️)我偶尔遇到的一个问题涉及变量和值，更具体地说，变量的行为如何受到它们所引用的值是可变的还是不可变的影响。</p><p id="6f3a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">首先，让我们定义可变和不可变。</p><p id="8b0d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">易变的:</strong>易变的</p><p id="74f8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">不可变的:不能够或者不容易改变的</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lq"><img src="../Images/e38dc7de4ce0f8fa57e4a22a2955d262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AnQj57CZh3rzgpoyq18wHA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Immutable vs. Mutable data/structural types in JavaScript</figcaption></figure><p id="446d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">很简单。现在，当谈到JavaScript的数据和结构类型时，它们都可以归为这两类。原始值是不可变的，其他的几乎都是可变的。</p><h1 id="ba68" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">为什么这很重要？</h1><p id="34d5" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">这个问题问得好。可变性与不可变性并不是一个新概念，但是随着React的发布，它与JS社区的相关性呈指数级增长。</p><p id="9624" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在我写JavaScript的最初几年，我不记得在网上看到过任何关于不可变数据的文章。然而，自从React在过去两年中出现以来，提到可变和不可变数据的文章似乎成倍增加，像Immutable.js这样的库和Elm这样的替代前端语言允许用户“使用不可变数据”。——<a class="ae ks" href="https://benmccormick.org/2016/06/04/what-are-mutable-and-immutable-data-structures-2" rel="noopener ugc nofollow" target="_blank"><em class="lp">本·麦考密克</em> </a></p><p id="48b5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">但是，我跑题了。</p><p id="f8d0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们来看一些我之前提到的陷阱的例子，看看这是怎么回事。我写了一大堆，但是本·麦考密克的例子比我的漂亮(不，我没有嫉妒😒)，所以我们就用他的。</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="f59d" class="mt ls in mp b gy mu mv l mw mx">let feeling = 'bemuddle';<br/>feeling[2] = 'f';<br/>console.log(feeling);</span></pre><p id="e801" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你认为会打印到控制台上的是什么？</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="b3e3" class="mt ls in mp b gy mu mv l mw mx">// bemuddle</span></pre><p id="c288" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你说<code class="fe my mz na mp b">bemuddle</code>你是正确的。这是为什么呢？嗯，那是因为变量<code class="fe my mz na mp b">feeling</code>保存的值是一个字符串。这是不可改变的。它不会改变。变量<code class="fe my mz na mp b">feeling</code>引用的是值<code class="fe my mz na mp b">‘bemuddle’</code>，因此要将<code class="fe my mz na mp b">feeling</code>的值改为<code class="fe my mz na mp b">‘befuddle’</code>，您需要输入<code class="fe my mz na mp b">feeling = ‘befuddle’;</code>。<strong class="kv io">变量不是值；变量是对值的引用。</strong>此外，尽管字符串具有<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#instance_properties" rel="noopener ugc nofollow" target="_blank">属性</a>和<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#instance_methods" rel="noopener ugc nofollow" target="_blank">实例方法</a>，使它们的行为类似于对象，如数组，但它们是原始值，不能在其上设置属性。</p><p id="64d0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">试试这个:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="6f02" class="mt ls in mp b gy mu mv l mw mx">let character = {<br/>    firstName: 'Captain',<br/>    lastName: 'America'<br/>}</span><span id="5b4a" class="mt ls in mp b gy nb mv l mw mx">let avenger = character;</span><span id="cefc" class="mt ls in mp b gy nb mv l mw mx">character.lastName = 'Marvel';</span><span id="8f38" class="mt ls in mp b gy nb mv l mw mx">console.log(avenger.lastName);</span></pre><p id="77ca" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你认为会打印到控制台上的是什么？</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="f4f7" class="mt ls in mp b gy mu mv l mw mx">// Marvel</span></pre><p id="90cd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">没错！是漫威。我现在可能没有必要向你解释这个，但是这是因为对象是可变的。变量<code class="fe my mz na mp b">character</code>指的是内存中包含<code class="fe my mz na mp b">{ firstName: ‘Captain’, lastName: ‘America’ }</code>的对象。当我们给一个新变量赋值时，<code class="fe my mz na mp b">avenger</code>指的是同一个对象。因为对象是可变的，所以对该对象的任何引用也会改变。因此，如果您想将该对象的<code class="fe my mz na mp b">firstName</code>属性更改为<code class="fe my mz na mp b">‘Ms.’</code>，您可以输入<code class="fe my mz na mp b">character.firstName = ‘Ms.’;</code>或<code class="fe my mz na mp b">avenger.firstName = ‘Ms.’;</code>。</p></div><div class="ab cl nc nd hr ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ig ih ii ij ik"><h1 id="1624" class="lr ls in bd lt lu nj lw lx ly nk ma mb jt nl ju md jw nm jx mf jz nn ka mh mi bi translated">最后一条切线</h1><p id="1934" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">我知道我说过我不会跑题，但是我发现了一个我认为很有趣的快速广告，关于为什么不变性对于React很重要。看看下面吧…</p><p id="a81e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> <em class="lp">反应倾向于不变性</em> </strong></p><p id="0d2f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在React的例子中，重要的是不要改变状态或道具。对于这条规则来说，组件是函数还是类并不重要。如果你准备写类似 <code class="fe my mz na mp b"><em class="lp">this.state.something = ...</em></code> <em class="lp">或者</em> <code class="fe my mz na mp b"><em class="lp">this.props.something = ...</em></code> <em class="lp">的代码，退一步想一个更好的办法。</em></p><p id="a1a4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="lp">要修改状态，总是使用</em> <code class="fe my mz na mp b"><em class="lp">this.setState</em></code> <em class="lp">。如果你很好奇你可以阅读更多关于</em> <a class="ae ks" href="https://daveceddia.com/why-not-modify-react-state-directly/" rel="noopener ugc nofollow" target="_blank"> <em class="lp">为什么不直接修改状态</em> </a> <em class="lp">。</em></p><p id="5abd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">至于道具，它们是单向的。道具是组件的一部分。它们不是一条双行道，至少不是通过像设置一个新值的道具这样的可变操作。</p><p id="f57d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="lp">如果您需要将一些数据发送回父组件，或者触发父组件中的某个东西，您可以通过传入一个函数作为道具来实现，然后每当您需要与父组件通信时，从子组件内部调用该函数。这里有一个回调道具的简单例子:</em></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/65823dfe62ef7e182c00240a4eec21a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZEVMJIKdhjyjNCsTuBTGqw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk"><a class="ae ks" href="https://daveceddia.com/react-redux-immutability-guide/#react-prefers-immutability" rel="noopener ugc nofollow" target="_blank">Dave Ceddia — Immutability in React and Redux: The Complete Guide</a></figcaption></figure></div><div class="ab cl nc nd hr ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ig ih ii ij ik"><p id="4a14" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">快乐编码🤓</p></div></div>    
</body>
</html>