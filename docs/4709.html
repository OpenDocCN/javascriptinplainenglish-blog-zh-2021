<html>
<head>
<title>Bringing Powerful Functional Programming to the Web With PureScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用PureScript将强大的函数式编程带入网络</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/purescript-3ee759ce05aa?source=collection_archive---------3-----------------------#2021-09-20">https://javascript.plainenglish.io/purescript-3ee759ce05aa?source=collection_archive---------3-----------------------#2021-09-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="33c6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">就像哈斯克尔对于JavaScript一样</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c951390e1006b2cc80d00a0f26b6652e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j9dqogFLMLW8Hrm6eofFkw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: <a class="ae kv" href="https://www.purescript.org/" rel="noopener ugc nofollow" target="_blank">purescript.org</a></figcaption></figure><p id="72f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最近，我对函数式编程产生了兴趣。人们说学习它会让你成为一个更好的程序员。</p><p id="0855" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我想尝试一种纯粹的函数式语言:Haskell。<br/>然而，我没有它的用例。最后，我想把东西带入网络——甚至是功能性编程。所以我研究并发现了一个非常有前景的项目:<strong class="ky ir"> PureScript </strong>。</p><p id="5a8a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个项目让我非常惊讶，所以我想给你看看。如果你和我一样兴奋，让我们深入研究PureScript和纯函数式的网络编程。</p><h1 id="2263" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">那么，什么是PureScript？</h1><p id="044d" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">乍一看，PureScript看起来像Haskell。正如Haskell一样，它是一种纯粹的函数式编程语言。我们在编写代码时会回到这意味着什么。除了语法上的一些差异之外，PureScript与Haskell有一个完全不同的目标:将函数式编程引入网络。</p><p id="4381" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">PureScript完全在Node.js上运行。我们编写的所有代码都将被编译成JavaScript，并在浏览器或Node.js中使用。</p><p id="549c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">尽管它被忽视了，但它有一个丰富的生态系统:一个包管理器，用于Express.js和DOM操作的库，许多用于几乎所有事情的默认包，优秀的文档，一个游戏场和一个测试套件。</p><p id="4ab6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要误解我。PureScript不是即将到来的项目。这是一个项目，它已经将童年时代远远抛在了脑后，准备投入生产。</p><p id="49cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，卡尔达诺·区块链背后的团队在他们的一些网络项目中使用了PureScript。想快速试用吗？太棒了，我们走！</p><h1 id="f2fe" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">让我们从PureScript开始</h1><p id="866e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">安装PureScript很容易。</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="fe6c" class="mv lt iq mr b gy mw mx l my mz">npm install -g purescript <br/>npm install -g spago </span></pre><p id="5043" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">而<code class="fe na nb nc mr b">purescript</code>是编译器本身<code class="fe na nb nc mr b">spago</code>是管理项目的包管理器和工具。一旦两者都创建了，您就可以创建一个空目录并移入其中。然后，运行<code class="fe na nb nc mr b">spago init</code>。</p><h1 id="a3bc" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">了解REPL</h1><p id="ee76" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">对编写一些PureScript代码感到兴奋吗？很好。首先，我们将在航站楼内使用西班牙REPL号进行。要启动它，运行:<code class="fe na nb nc mr b">spago repl</code>。如果您想退出，请键入<code class="fe na nb nc mr b">:quit</code></p><p id="7a43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">REPL是一个强大的原型制作工具。我们也可以在那里导入模块，甚至是我们在项目中编写的模块。让我们编写第一个函数，将两个值相加。在REPL输入以下代码，我会解释的:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="0067" class="mv lt iq mr b gy mw mx l my mz">add a b = a + b</span></pre><p id="4143" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好吧，这看起来很奇怪，对吧？但事实上，这是一种功能。作为函数的名称，我们提供了“add”。然后，用空格分隔，我们提供了参数“a”和“b”。</p><p id="64c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在等号后面，我们定义了我们的返回值。您可能想知道为什么这基本上是返回语句。原因是PureScript是一种纯函数式编程语言。</p><p id="acc2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种编程语言的目的是避免不纯的函数，即依赖于或操纵其范围之外的状态的函数。因此，在Haskell和PureScript中，所有函数都返回一些东西——如果不返回，它们什么也不做。</p><p id="fdc0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们调用我们的函数。要这样，在REPL输入:<code class="fe na nb nc mr b">add 2 4</code>。</p><p id="5dd0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这应该导致“6”被记录—我们得到了第一个函数！</p><h1 id="7683" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">编写和编译PureScript</h1><p id="9dbc" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">要离开REPL，输入:<code class="fe na nb nc mr b">:quit</code> —以防你还在那里。REPL很酷，但是在文本编辑器中写代码更酷。我使用VS代码来实现。幸运的是，对于VS代码，有很多可用的扩展。</p><p id="00b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">确保安装“PureScript IDE”和“PureScript语言支持”,以防你也使用VS代码。因为我们已经用<code class="fe na nb nc mr b">spago init</code>创建了一个新项目，让我们打开那里的文件。</p><p id="67dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">目前，一切都围绕src目录中的<code class="fe na nb nc mr b">Main.purs</code>进行。默认情况下，你会看到一些代码记录了一个意大利面条表情符号。让我们把它改成类似“Hello World”这样的日志——这由您决定。</p><p id="d8b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要运行你的PureScript代码，输入<code class="fe na nb nc mr b">spago run</code>——这会运行你的程序，你记录的所有东西都会显示出来。</p><p id="8460" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我已经说过的，PureScript是在考虑JavaScript世界的情况下创建的。所以要将你的PureScript应用捆绑到JavaScript上，你只需要运行<code class="fe na nb nc mr b">spago bundle-app</code>。您的捆绑应用程序的入口文件是项目根目录下的<code class="fe na nb nc mr b">index.js</code>。</p><p id="2c12" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当你运行<code class="fe na nb nc mr b">node index.js</code>或者在网站的脚本标签中包含这个index.js时，意大利面(默认)就会出现在控制台中。由于“src”目录中的<code class="fe na nb nc mr b">Main.purs</code>包含了我们PureScript app的主要函数，所以无论发生什么，最初都会有运行。</p><h1 id="4765" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">用PureScript编写我们的add函数</h1><p id="c801" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在你可能会想，“我们刚刚在REPL中写了这个函数。为什么还要再来一次？”—我明白你的意思。但是将它写在一个真正的PureScript文件中并捆绑它教给我们更多的东西。</p><p id="ab22" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先在src目录中创建一个名为<code class="fe na nb nc mr b">Add.purs</code>的新文件，紧挨着<code class="fe na nb nc mr b">Main.purs</code>。在这个文件中，我们将创建我们的函数。由于新文件也是新模块，我们在<code class="fe na nb nc mr b">Add.purs</code>中的代码看起来像这样:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="8020" class="mv lt iq mr b gy mw mx l my mz">module Add where</span><span id="f3a3" class="mv lt iq mr b gy nd mx l my mz">import Prelude</span><span id="72fa" class="mv lt iq mr b gy nd mx l my mz">add a b = a + b</span></pre><p id="79ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们想在主函数中使用它，并在控制台中记录结果。<br/>由于我们将模块定义为“add ”,我们现在可以在<code class="fe na nb nc mr b">Main.purs</code>中从该模块导入函数“Add ”:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="13e0" class="mv lt iq mr b gy mw mx l my mz">import Add (add)</span></pre><p id="35d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们文件的完整代码如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="0247" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能注意到了，我们现在使用一个名为<code class="fe na nb nc mr b">show</code>的函数来包装<code class="fe na nb nc mr b">add</code>的函数调用。这个“show”函数允许我们以字符串的形式返回一个整数，这样我们就可以记录它。</p><p id="e6a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，运行<code class="fe na nb nc mr b">spago run</code>，你应该看到“5”出现在控制台中。当运行<code class="fe na nb nc mr b">spago bundle-app</code>并在任何地方导入index.js时，应该会发生同样的情况。</p><p id="f04c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这不是太难，对不对？但是有一件事我们应该改变。<br/> PureScript使用所谓的类型推断。这意味着PureScript仅仅通过查看分配给它的内容来猜测任何函数或变量的类型。这很酷，但不是最佳实践。相反，我们可以为PureScript(和Haskell)提供函数返回的类型和参数。</p><p id="d7a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，这:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="4e21" class="mv lt iq mr b gy mw mx l my mz">add a b = a + b</span></pre><p id="0369" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">变成了这样:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="09af" class="mv lt iq mr b gy mw mx l my mz">add :: Int -&gt; Int -&gt; Int<br/>add a b = a + b</span></pre><p id="afac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面一行表示我们有一个名为“add”的函数，它接受一个整数和另一个整数，然后返回一个整数。但是为什么这条线不像<code class="fe na nb nc mr b">(Int, Int) -&gt; Int</code>？</p><p id="1b01" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好问题！要理解这一点，我们需要知道实际上不存在一个以上参数的函数。事实上，像<code class="fe na nb nc mr b">add a b = a + b</code>这样的语法自动包含了<em class="mp">curry</em>。</p><p id="a0d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Currying？这是函数式编程的概念，我们在函数中返回函数。这有助于将我们的代码分解成函数，每个函数只有一个参数。这里有一个简单的例子:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="7dfe" class="mv lt iq mr b gy mw mx l my mz">function add(a, b) {<br/>  return a +b<br/>}</span></pre><p id="6e66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">会变成:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="3ac5" class="mv lt iq mr b gy mw mx l my mz">function add(a) {<br/>  return function (b) {<br/>    return a + b<br/>  }<br/>}</span></pre><p id="ab54" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以我们调用<code class="fe na nb nc mr b">add(2)(2)</code>来接收“4 ”,而不是调用<code class="fe na nb nc mr b">add(2, 2)</code>。</p><p id="4540" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">PureScript在幕后为我们拍马屁。我们在将代码导出到JavaScript时会看到这一点。为此，再次运行<code class="fe na nb nc mr b">spago bundle-app</code>。然后，在浏览器中打开结果<code class="fe na nb nc mr b">index.js</code>。默认情况下，仍会记录“5”。但是我们也可以调用手动创建的add函数。</p><p id="ea39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它可以通过下面的代码行获得，正如你所看到的，我们可以调用curried函数:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/5e0ee9150d43f8569c6083d3f387eb9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z1XMLpOTJC_wy2hnKN3CdA.png"/></div></div></figure><p id="52b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是我对PureScript的介绍。当然，我们只涉及了该语言的一小部分特性。我还想在未来介绍几件事:</p><ul class=""><li id="7001" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated">PureScripts数据类型&amp;在PureScript中导入JavaScript函数</li><li id="a73c" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">访问DOM</li><li id="4563" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">使用PureScript编写Express或React应用程序</li></ul><p id="2676" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果大家对PureScript有足够的兴趣，我很乐意多写一些——所以，请给我留下您的反馈:)</p><p id="199d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您的阅读！下面是第二部分:</p><div class="nv nw gp gr nx ny"><a rel="noopener  ugc nofollow" target="_blank" href="/purescript-cheatsheet-9ba7da3d393f"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">PureScript:编译成JavaScript的函数式语言</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">PureScript基础:对象、递归、映射等等</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om kp ny"/></div></div></a></div><h2 id="648d" class="mv lt iq bd lu on oo dn ly op oq dp mc lf or os me lj ot ou mg ln ov ow mi ox bi translated">我很想在我的推特上看到你！</h2></div><div class="ab cl oy oz hu pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="ij ik il im in"><p id="4c23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mp">更多内容看</em><a class="ae kv" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="mp">plain English . io</em></strong></a></p></div></div>    
</body>
</html>