<html>
<head>
<title>Create a Currency Converter in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React中创建货币转换器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-a-currency-converter-in-react-7e67ac290c39?source=collection_archive---------4-----------------------#2021-12-18">https://javascript.plainenglish.io/create-a-currency-converter-in-react-7e67ac290c39?source=collection_archive---------4-----------------------#2021-12-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="b7c2" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用最新的可用数据转换货币</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/cc00e50e3ec42973cf7d8de00c544dca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8SY9dx56W9lid9nw"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@snowjam?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">John McArthur</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4675" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">应用程序是使用create-react-app在React中编写的。<a class="ae ks" href="https://reactjs.org/docs/create-a-new-react-app.html" rel="noopener ugc nofollow" target="_blank">https://reactjs.org/docs/create-a-new-react-app.html</a></p><p id="84fe" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这个例子中，我将使用一个外部API来获取最新的货币汇率。</p><p id="369f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在此链接到外部API:</p><div class="lp lq gp gr lr ls"><a href="https://rapidapi.com/natkapral/api/currency-converter5/" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab fo"><div class="lu ab lv cl cj lw"><h2 class="bd io gy z fp lx fr fs ly fu fw im bi translated">货币转换器API文档(natkapral) | RapidAPI</h2><div class="lz l"><h3 class="bd b gy z fp lx fr fs ly fu fw dk translated">提供基于官方银行数据的汇率。</h3></div><div class="ma l"><p class="bd b dl z fp lx fr fs ly fu fw dk translated">rapidapi.com</p></div></div><div class="mb l"><div class="mc l md me mf mb mg km ls"/></div></div></a></div><p id="6922" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">应用程序托管在以下位置:</p><div class="lp lq gp gr lr ls"><a href="https://currency-calculator-app.netlify.app/" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab fo"><div class="lu ab lv cl cj lw"><h2 class="bd io gy z fp lx fr fs ly fu fw im bi translated">React应用</h2><div class="lz l"><h3 class="bd b gy z fp lx fr fs ly fu fw dk translated">使用create-react-app创建的网站</h3></div><div class="ma l"><p class="bd b dl z fp lx fr fs ly fu fw dk translated">货币-计算器-app.netlify.app</p></div></div></div></a></div><h1 id="d7c8" class="mh mi in bd mj mk ml mm mn mo mp mq mr jt ms ju mt jw mu jx mv jz mw ka mx my bi translated">使用货币API</h1><p id="a66d" class="pw-post-body-paragraph kt ku in kv b kw mz jo ky kz na jr lb lc nb le lf lg nc li lj lk nd lm ln lo ig bi translated">为了处理数据，我将使用axios。成功进行API调用需要货币转换器的API密钥。</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="5c0d" class="nj mi in nf b gy nk nl l nm nn">import Axios from 'axios'<br/>const RAPID_KEY = "" // Add your key here</span></pre><p id="dffe" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了获取所有可用的货币，我将创建一个向端点"https://currency-converter5.p.rapidapi.com/currency/list"发送请求的函数。</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="4754" class="nj mi in nf b gy nk nl l nm nn">export async function fetchCurrencies() {    <br/>    let response    <br/>    try {        <br/>        const options = {            <br/>            method: 'GET',            <br/>            url: 'https://currency-converter5.p.rapidapi.com/currency/list',            <br/>            headers: {              <br/>                'x-rapidapi-key': RAPID_KEY,              <br/>                'x-rapidapi-host': 'currency-converter5.p.rapidapi.com'            <br/>            }          <br/>        };                  <br/>        response = await Axios.request(options)    <br/>    } catch (error) {        <br/>        console.log(error)        <br/>        response = "fail"    <br/>    }    <br/>    return response<br/>}</span></pre><p id="6e33" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了转换我想要比较的货币，我将添加一个对新端点的新API调用“https://currency-converter 5 . p . rapidapi . com/currency/convert”。</p><p id="6027" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这个请求需要一个头，包含从货币的<strong class="kv io">，从<strong class="kv io">到</strong>货币，以及要转换的<strong class="kv io">金额</strong>。</strong></p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="33ee" class="nj mi in nf b gy nk nl l nm nn">export async function convertCurrencies(from, to, amount) {    <br/>    let response    <br/>    try {</span><span id="bb55" class="nj mi in nf b gy no nl l nm nn">        const options = {            <br/>            method: ‘GET’,            <br/>            url: ‘https://currency-converter5.p.rapidapi.com/currency/convert’,            <br/>            params: {<br/>                format: ‘json’, <br/>                from: from, <br/>                to: to, <br/>                amount: amount},            <br/>                headers: {              <br/>                    ‘x-rapidapi-key’: RAPID_KEY,                                </span><span id="b638" class="nj mi in nf b gy no nl l nm nn">'x-rapidapi-host': 'currency-converter5.p.rapidapi.com'            <br/>                }          <br/>            };<br/>            response = await Axios.request(options);    <br/>    } catch (error) {         <br/>        response = "fail"    <br/>    }    <br/>    return response<br/>}</span></pre><h1 id="8077" class="mh mi in bd mj mk ml mm mn mo mp mq mr jt ms ju mt jw mu jx mv jz mw ka mx my bi translated">转换货币</h1><p id="26e7" class="pw-post-body-paragraph kt ku in kv b kw mz jo ky kz na jr lb lc nb le lf lg nc li lj lk nd lm ln lo ig bi translated">要兑换货币，您可以向API发出一个请求，其中包含要兑换的货币以及要兑换的金额。</p><p id="045b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">useState挂钩用于处理不同的状态变化。</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="a581" class="nj mi in nf b gy nk nl l nm nn">const [fromCurrency, setFromCurrency] = useState()    <br/>const [toCurrency, setToCurrency] = useState()    <br/>const [amount, setAmount] = useState(0)   <br/> <br/>const [calculatedRate, setCalculatedRate] = useState(0) </span><span id="a732" class="nj mi in nf b gy no nl l nm nn">// Get all currencies and store in a state variable<br/>const [currencies, setCurrencies] = useState([])    <br/>const [currenciesFormattedArray, setCurrenciesFormattedArray] = useState([])     </span><span id="7ea2" class="nj mi in nf b gy no nl l nm nn">// Toggle between from amount and to amount<br/>const [switchMessage, setSwitchMessage] = useState(false)    <br/>const [currencySwitchedTo, setCurrencySwitchedTo] = useState(null)    const [currencySwitchedFrom, setCurrencySwitchedFrom] = useState(null)</span></pre><p id="f746" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">useEffect钩子用于处理对<strong class="kv io">fetch currency()</strong>的API调用。</p><p id="74e5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">函数<strong class="kv io"> calculateCurrency </strong>处理转换所选货币进行比较的请求。</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="0959" class="nj mi in nf b gy nk nl l nm nn">async function calculateCurrency() {        <br/>    if (fromCurrency &amp;&amp; toCurrency &amp;&amp; amount) {            <br/>        try {                <br/>            const calculatedSum = await convertCurrencies(fromCurrency, toCurrency, amount)                   </span><span id="4728" class="nj mi in nf b gy no nl l nm nn">            console.log(calculatedSum)                               console.log(calculatedSum.data.rates[toCurrency].rate_for_amount)                   <br/>   <br/>setCalculatedRate(calculatedSum?.data?.rates[toCurrency]?.rate_for_amount || 0)            <br/>        } catch (error) {                <br/>            console.log(error)            <br/>        }        <br/>    }     <br/>}</span></pre><p id="d274" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">响应将是一个对象，存储在<strong class="kv io"> calculatedSum </strong>变量中。使用以下方式访问计算的比率</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="c45a" class="nj mi in nf b gy nk nl l nm nn">calculatedSum?.data?.rates[toCurrency]?.rate_for_amount</span></pre><p id="fa91" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">使用useState()设置转换后的金额，如下所示:</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="e13c" class="nj mi in nf b gy nk nl l nm nn">setCalculatedRate(calculatedSum?.data?.rates[toCurrency]?.rate_for_amount || 0)</span></pre><p id="8d62" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果计算的金额为空或未定义，它将被设置为0。</p><h1 id="aaba" class="mh mi in bd mj mk ml mm mn mo mp mq mr jt ms ju mt jw mu jx mv jz mw ka mx my bi translated">创建CurrencySelector组件</h1><p id="f4c2" class="pw-post-body-paragraph kt ku in kv b kw mz jo ky kz na jr lb lc nb le lf lg nc li lj lk nd lm ln lo ig bi translated">为了方便地选择要比较的货币，我将使用API调用函数<strong class="kv io">fetchallcurrences</strong>。这些数据将被发送到组件CurrencySelector.jsx中，我们可以在其中更改所选的货币。</p><p id="4218" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">该组件接受三个属性，<strong class="kv io">货币，setCurrency </strong>和<strong class="kv io">货币。</strong>该组件使用两次，一次用于<strong class="kv io">从币</strong>，一次用于<strong class="kv io">到币</strong>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/c50f5cf58a9782df924bfab8ada30f09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kQBfyatQG2CgtFCUfblL3A.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">The currency selector jsx</figcaption></figure><h1 id="3328" class="mh mi in bd mj mk ml mm mn mo mp mq mr jt ms ju mt jw mu jx mv jz mw ka mx my bi translated">列出所有货币</h1><p id="ad65" class="pw-post-body-paragraph kt ku in kv b kw mz jo ky kz na jr lb lc nb le lf lg nc li lj lk nd lm ln lo ig bi translated">AllCurrencies.jsx文件呈现所有可用的货币。它将从api_currency.js文件中调用fetchCurrencies()函数。</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="1cfc" class="nj mi in nf b gy nk nl l nm nn">useEffect(() =&gt; {        <br/>    async function fetchData() {            <br/>        const response = await fetchCurrencies();            <br/>        if (response.data.currencies) {                <br/>            const currenciesArray = Object.keys(response.data.currencies).map((key) =&gt; [String(key),    <br/>response.data.currencies[key]]);   <br/>               <br/>            setCurrencies(currenciesArray)                    <br/>            setFilteredCurrencies(currenciesArray)            <br/>        }                  <br/>        console.log(response.data, "Response useEffect")        <br/>    }          </span><span id="9e9a" class="nj mi in nf b gy no nl l nm nn">    fetchData()     <br/>}, [])</span></pre><h1 id="80aa" class="mh mi in bd mj mk ml mm mn mo mp mq mr jt ms ju mt jw mu jx mv jz mw ka mx my bi translated">使用App.js呈现应用程序</h1><p id="76fd" class="pw-post-body-paragraph kt ku in kv b kw mz jo ky kz na jr lb lc nb le lf lg nc li lj lk nd lm ln lo ig bi translated">App.js文件负责呈现应用程序组件。这是一个只有一页的应用程序，所以没有使用路由。</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="1ada" class="nj mi in nf b gy nk nl l nm nn"><em class="nq">import</em> AllCurrencies <em class="nq">from</em> "./components/AllCurrencies";</span><span id="d09b" class="nj mi in nf b gy no nl l nm nn"><em class="nq">import</em> CurrencyConverter <em class="nq">from</em> "./components/CurrencyConverter";</span><span id="c6f9" class="nj mi in nf b gy no nl l nm nn"><em class="nq"><br/>function</em> App() {</span><span id="9c0e" class="nj mi in nf b gy no nl l nm nn"><em class="nq">    return</em> (</span><span id="a97f" class="nj mi in nf b gy no nl l nm nn">        &lt;div className="bg-light py-4"&gt;</span><span id="df6d" class="nj mi in nf b gy no nl l nm nn">            &lt;div className="container"&gt;</span><span id="9fb9" class="nj mi in nf b gy no nl l nm nn">                &lt;CurrencyConverter /&gt;</span><span id="ac9a" class="nj mi in nf b gy no nl l nm nn">                &lt;AllCurrencies /&gt;</span><span id="9f14" class="nj mi in nf b gy no nl l nm nn">            &lt;/div&gt;</span><span id="8c8b" class="nj mi in nf b gy no nl l nm nn">        &lt;/div&gt;</span><span id="0ea6" class="nj mi in nf b gy no nl l nm nn">   );</span><span id="4c9e" class="nj mi in nf b gy no nl l nm nn">}</span><span id="55b9" class="nj mi in nf b gy no nl l nm nn"><em class="nq">export</em> <em class="nq">default</em> App;</span></pre><h1 id="0358" class="mh mi in bd mj mk ml mm mn mo mp mq mr jt ms ju mt jw mu jx mv jz mw ka mx my bi translated">源代码</h1><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="2316" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="nq">更多内容看</em> <a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nq">说白了. io </em> </strong> </a> <strong class="kv io"> <em class="nq">。</em> </strong> <em class="nq">报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nq">免费每周简讯点击这里</em> </strong> </a> <strong class="kv io"> <em class="nq">。</em> </strong></p></div></div>    
</body>
</html>