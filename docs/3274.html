<html>
<head>
<title>Using the “useContext” Hook in React: A Simpler Alternative to Redux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React中使用“useContext”钩子:Redux的一个更简单的替代方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/using-the-usecontext-hook-in-react-a-more-simple-alternative-to-redux-519c55536ddb?source=collection_archive---------7-----------------------#2021-07-04">https://javascript.plainenglish.io/using-the-usecontext-hook-in-react-a-more-simple-alternative-to-redux-519c55536ddb?source=collection_archive---------7-----------------------#2021-07-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="e116" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">关于如何在React应用程序中使用这个简单而强大的钩子的演练</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/3df2f4015d164862fe6dbcb7f84cffa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4FAbCmINKJaLawSs"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@flowforfrank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ferenc Almasi</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7f2f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">React hooks为我们的功能组件提供了更多的能力——与类组件相比，react hooks成为最近构建应用程序的一种更受欢迎的方法。</p><p id="703e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">useContext挂钩没有什么不同，但同样重要的是要注意，与一些更常见的React挂钩(如useState和useEffect)相比，它的操作稍有不同。</p><p id="3741" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">本周，我得到了一个带回家的评估，重新创建一个流行网站的功能和设计，以计算你的NPS(净推广分数)。</p><p id="196a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="lp">欣喜的NPS计算器:</em>【https://delighted.com/nps-calculator】T2</p><p id="44a7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">正如您在网站上看到的，每一行的输入都依赖于其他行的条目。用户在第一行输入分数，然后在第二行进行分组，最后在第三行进行计算。</p><p id="d1ed" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">基于这种行为，我们可以推断出我们需要一种方法来跟踪状态以及更新我们的状态。虽然我们<em class="lp">可以</em>从我们的父组件传递道具或者使用redux进行状态管理，但是这种类型的应用<em class="lp">要求我们使用所谓的useContext钩子。</em></p><p id="d29c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在我们在代码编辑器中引入钩子之前，让我们快速回顾一下什么是useContext钩子。</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lx"><img src="../Images/5b97ed505ff32e73b46a98a9cf3ee2a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*32YUd1OHzmSPH9Ob"/></div></div></figure><h1 id="fd3b" class="ly lz in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">什么是使用上下文？</h1><p id="535e" class="pw-post-body-paragraph kt ku in kv b kw mq jo ky kz mr jr lb lc ms le lf lg mt li lj lk mu lm ln lo ig bi translated">useContext挂钩是我们访问数据的一种更简单的方式，比如我们的函数和状态。</p><p id="51f7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们想象一下我在React中链接的web应用程序的结构。我们有一个父组件，其中包含不同级别的子组件。</p><p id="b4ef" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，想象将数据从最上面的组件一直传递到最后一个子组件。</p><p id="1209" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">正如我们所知，我们通过所谓的props自上而下地将数据从一个组件传递到另一个组件。</p><p id="7fda" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">可以想象，在数据到达需要它的组件之前，通过每个组件传递数据会非常麻烦。</p><p id="6bda" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您必须通过每个组件传递数据，通过它们的道具，直到到达最后一个子组件。无聊吧？</p><p id="c9a8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这就是<strong class="kv io"> <em class="lp">语境</em> </strong> <em class="lp"> </em>来拯救的地方。</p><p id="adc6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">React上下文API允许您轻松地访问组件树不同级别的数据，而不必通过props向下传递数据。</p><p id="61d6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是一种更简单的状态管理方法，特别是对于较小的React应用程序，只有少数组件需要访问数据。</p><p id="ebf2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，让我们来看看如何将它整合到我们的React应用程序中！</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="a65d" class="ly lz in bd ma mb mv md me mf mw mh mi jt mx ju mk jw my jx mm jz mz ka mo mp bi translated">useContext是如何工作的？</h1><p id="e026" class="pw-post-body-paragraph kt ku in kv b kw mq jo ky kz mr jr lb lc ms le lf lg mt li lj lk mu lm ln lo ig bi translated"><strong class="kv io"> <em class="lp"> useContext </em> </strong>钩子提供了所有与上下文API相同的功能，只是打包成一个简单易用的钩子，可以在功能组件内部使用。</p><p id="62ba" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">通过创建上下文，需要注意的是它提供了消费者和提供者，我们必须传递整个上下文对象。</p><p id="292d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们可以通过使用<strong class="kv io"><em class="lp">React . create Context .</em></strong>在React中创建一个上下文对象。如果我们想给它一个初始值，我们可以在创建上下文时将它作为参数传入。如果没有，我们可以将其留空:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/d90518d806089bad2c8e520c9e70db9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OtFMBrR55S3MpqHeN8vO4g.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Remember to import useContext from react!</figcaption></figure><p id="625b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">接下来，让我们创建我们的包装器组件，它将包装哪些组件可以访问我们的数据。我们称之为TotalProvider。</p><p id="8660" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们还将使用useState钩子来创建我们的初始状态，并将我们的所有值设置为一个空字符串，以及一个更改处理程序来跟踪我们状态的任何更改。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nb"><img src="../Images/cb1cbada1e68adb270a728d496345ab2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hq-BoiFEE-dgUiAR7UmGFg.png"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nc"><img src="../Images/9d6a8562980b491b712d3240be07da03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lYG65IHmV12w0ZfRTCNO9Q.png"/></div></div></figure><p id="7214" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们还将创建几个自定义挂钩，并传入两个新创建的上下文:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/f77acf97c45579ed19b6f47d52dddd0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*eOUqh8JrfEl-7tvtLbRvGQ.png"/></div></figure><p id="ddc8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">正如您在上面的代码片段中看到的，我们将计数状态传递给CountContext，将更改处理函数传递给CountUpdateContext，这样我们就可以跟踪和更新对状态所做的任何更改。然后，我们创建几个定制挂钩，这样我们就可以在其他组件中访问我们的上下文。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/09595446c4a7b0bc9323d9a8c7764576.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*6pHKixVGFroMwng5nE8hAA.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">The count variable now holds our count state, and handleChange holds our change handler</figcaption></figure><p id="5fc4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后，不要忘记用我们的TotalProvider包装我们的组件，以便它可以访问我们的上下文和数据:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/641aca31cb433d4b4d78ea65ad4074e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*J_YQPA8Rq6xn_65Ghn9oyg.png"/></div></figure><p id="0345" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们现在可以灵活地向我们的TotalProvider添加额外的上下文，其中的组件将可以访问数据，因为我们已经设置好了一切，因此我们不需要继续传递额外的props或向我们的Redux存储添加额外的层。</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="00f6" class="ly lz in bd ma mb mv md me mf mw mh mi jt mx ju mk jw my jx mm jz mz ka mo mp bi translated">结论</h1><p id="6cba" class="pw-post-body-paragraph kt ku in kv b kw mq jo ky kz mr jr lb lc ms le lf lg mt li lj lk mu lm ln lo ig bi translated">虽然在React应用程序中有几种方法可以保存状态，但对于只有一个父组件和多层子组件的小型应用程序来说，useContext是管理状态的好方法。</p><p id="949d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在大型应用程序中，传递每一级的属性是非常烦人和混乱的，或者设置redux store对于小型应用程序来说是非常复杂的，作为一种替代方法，useContext允许我们轻松地让我们的组件访问数据，并给我们额外的灵活性来添加更多的数据，而不需要传递额外的属性。所有的跑腿工作基本上都是一扫而空！</p><p id="31b9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在你的下一个项目中尝试一下，看看对你自己有什么好处。</p><p id="f7af" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下次见！</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><h1 id="e4f8" class="ly lz in bd ma mb mv md me mf mw mh mi jt mx ju mk jw my jx mm jz mz ka mo mp bi translated">来源</h1><p id="9788" class="pw-post-body-paragraph kt ku in kv b kw mq jo ky kz mr jr lb lc ms le lf lg mt li lj lk mu lm ln lo ig bi translated">Upmostly:如何在React中使用useContext钩子:<br/>T5】https://up mostly . com/tutorials/How-to-Use-the-Use context-Hook-in-React</p><p id="8c97" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="lp">更多内容请看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="lp">plain English . io</em></strong></a></p></div></div>    
</body>
</html>