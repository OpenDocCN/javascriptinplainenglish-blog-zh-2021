<html>
<head>
<title>Build a Google Assistant with Interactive Canvas and React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用交互式画布构建一个谷歌助手并作出反应</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/building-a-google-assistant-with-interactive-canvas-and-reactjs-part-3-5eaa14f48b6c?source=collection_archive---------12-----------------------#2021-03-29">https://javascript.plainenglish.io/building-a-google-assistant-with-interactive-canvas-and-reactjs-part-3-5eaa14f48b6c?source=collection_archive---------12-----------------------#2021-03-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="d0e1" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">第三部分</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/548190bc29c45fcb8cfb47820f938536.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fFfEznIHvqBHccDD-wxDFA.png"/></div></div></figure><p id="652f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">欢迎来到本教程的最后一部分。在这里，我将介绍如何将参数从你的机器人传递到你的ReactJS应用程序，并向你的应用程序添加onClicks！</p><p id="d40e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在本文结束时，我希望您能够正确地部署您的《纽约时报》畅销书机器人并与之交互——从点击到跟踪会话参数。</p><p id="b6d3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你还没有看过前两部分，给他们看一看，尝试一下，因为第三部分将建立在已经完成的基础上！</p><p id="2d6f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">第一部分:</strong></p><div class="lk ll gp gr lm ln"><a href="https://celiaongsl.medium.com/building-a-google-assistant-with-interactive-canvas-and-reactjs-part-1-5e290eccfdbd" rel="noopener follow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd io gy z fp ls fr fs lt fu fw im bi translated">用交互式画布和ReactJS构建谷歌助手——第1部分</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">如果你一直在探索谷歌助手及其产品，你应该见过谷歌巢枢纽，并可能阅读其…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">celiaongsl.medium.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb km ln"/></div></div></a></div><p id="ba4e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">第二部分:</strong></p><div class="lk ll gp gr lm ln"><a href="https://celiaongsl.medium.com/building-a-google-assistant-with-interactive-canvas-and-reactjs-part-2-3aa88584d4cd" rel="noopener follow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd io gy z fp ls fr fs lt fu fw im bi translated">用交互式画布和ReactJS构建谷歌助手——第2部分</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">在上一部分中，我介绍了一些事情，比如您将需要的工具的基本设置以及在…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">celiaongsl.medium.com</p></div></div><div class="lw l"><div class="mc l ly lz ma lw mb km ln"/></div></div></a></div></div><div class="ab cl md me hr mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ig ih ii ij ik"><p id="5c67" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">假设您已经遵循了，甚至可能创建了自己的页面和设计，您可能会以下面的流程结束:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mk"><img src="../Images/72b47eed5d84b941853e39a06a96ef27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P64rP22vDEbtTUyqxxmmUg.png"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ml"><img src="../Images/45f21d31f3da48445777960663ea479e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WP4lEsOWp9LtHcqSRR6Upw.png"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mm"><img src="../Images/496bcfaa06b50857a56206f95e9176be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9YQgdBt9bLFlGFN5JOsZsA.png"/></div></div></figure><p id="7277" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">正如您所看到的，我们仍然到处都有<code class="fe mn mo mp mq b">lorem ipsums</code>和占位符数据。</p><p id="da94" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">所以让我们先从这个开始。</p><h1 id="bb69" class="mr ms in bd mt mu mv mw mx my mz na nb jt nc ju nd jw ne jx nf jz ng ka nh ni bi translated">将会话变量作为参数发送和跟踪到ReactJS应用程序</h1><p id="7ea2" class="pw-post-body-paragraph ko kp in kq b kr nj jo kt ku nk jr kw kx nl kz la lb nm ld le lf nn lh li lj ig bi translated">由于我不会介绍如何将API连接到您的机器人，我们将创建一些模拟数据供我们使用。</p><h2 id="89d9" class="no ms in bd mt np nq dn mx nr ns dp nb kx nt nu nd lb nv nw nf lf nx ny nh nz bi translated">设置模拟数据</h2><p id="b4cd" class="pw-post-body-paragraph ko kp in kq b kr nj jo kt ku nk jr kw kx nl kz la lb nm ld le lf nn lh li lj ig bi translated">我将在<code class="fe mn mo mp mq b">sdk</code> &gt; <code class="fe mn mo mp mq b">webhooks</code> &gt; <code class="fe mn mo mp mq b">ActionsOnGoogleFulfillment</code> &gt; <code class="fe mn mo mp mq b">index.js</code>中添加虚拟数据。</p><p id="4cbb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">关于书籍封面图片，有很多方法可以存储它们，你可以选择自己喜欢的方式。从最简单的开始:</p><ol class=""><li id="8bbf" class="oa ob in kq b kr ks ku kv kx oc lb od lf oe lj of og oh oi bi translated">只需将图像添加到您的<code class="fe mn mo mp mq b">public</code>文件夹中，然后调用→注意，这意味着您调用的是您的<code class="fe mn mo mp mq b">src</code>文件夹中的图像，而不是您的<code class="fe mn mo mp mq b">sdk</code>文件夹中的图像</li><li id="9ef9" class="oa ob in kq b kr oj ku ok kx ol lb om lf on lj of og oh oi bi translated">上传到一些免费的图像托管网站，如ImgBB，并使用生成的HTML网址</li><li id="47fd" class="oa ob in kq b kr oj ku ok kx ol lb om lf on lj of og oh oi bi translated">用这个项目设置你的Firebase存储，把你的照片存储在里面，然后调用(但是要注意限制，比如10GB的存储空间，直到它开始让你付出代价)</li></ol><p id="6cf9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我将使用ImgBB，但你可以简单地用你喜欢的任何方法替换URL。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="7c43" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">以上是我的数据的一个片段，完整版本在我的存储库中。</p><p id="63cc" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我有一个短摘要和一个长摘要，以便机器人将读出短摘要，长摘要显示在屏幕上。</p><p id="6507" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">一旦你有了你的数据设置，你现在可以添加逻辑，这样当你的对话进入一个意图时，机器人知道如何处理它，并在屏幕上显示它。</p><h2 id="2aae" class="no ms in bd mt np nq dn mx nr ns dp nb kx nt nu nd lb nv nw nf lf nx ny nh nz bi translated">向React应用程序发送参数</h2><p id="acc2" class="pw-post-body-paragraph ko kp in kq b kr nj jo kt ku nk jr kw kx nl kz la lb nm ld le lf nn lh li lj ig bi translated">当用户在<code class="fe mn mo mp mq b">Welcome</code>场景中说“看看小说列表”时，我们只想选择小说列表并将其解析到前端。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="64bc" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">注意这里要做的3件事:</p><ol class=""><li id="9cf3" class="oa ob in kq b kr ks ku kv kx oc lb od lf oe lj of og oh oi bi translated"><code class="fe mn mo mp mq b">conv.session.params.book_categories_options</code>用于让我们知道用户选择了哪个类别。这与在<code class="fe mn mo mp mq b">Welcome</code>场景中完成的填充缝隙相关联。</li><li id="5010" class="oa ob in kq b kr oj ku ok kx ol lb om lf on lj of og oh oi bi translated"><code class="fe mn mo mp mq b">handleTypeOverride</code>使用<code class="fe mn mo mp mq b">conv.session.typeOverrides</code>来覆盖我们最初在谷歌控制台上列出的<code class="fe mn mo mp mq b">books_options</code> <code class="fe mn mo mp mq b">Types</code>。这里，我们需要列出类型中的条目及其<code class="fe mn mo mp mq b">name</code>和<code class="fe mn mo mp mq b">synonyms</code>。这样，每当我们有新数据时，我们就不必手动更新<code class="fe mn mo mp mq b">Types</code>。</li><li id="109b" class="oa ob in kq b kr oj ku ok kx ol lb om lf on lj of og oh oi bi translated"><code class="fe mn mo mp mq b">new Canvas</code>已经通过<code class="fe mn mo mp mq b">params</code>了。<code class="fe mn mo mp mq b">params</code>是React应用程序用来更新屏幕的。</li></ol><p id="c0ad" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">对于<code class="fe mn mo mp mq b">book_details</code> webhook，我们不需要覆盖类型，但是我们需要知道用户选择了哪本书，并再次通过<code class="fe mn mo mp mq b">params</code>将细节传递给React应用程序。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="6696" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">既然已经解决了webhook，让我们看看如何在ReactJS应用程序中使用它。</p><h2 id="0b91" class="no ms in bd mt np nq dn mx nr ns dp nb kx nt nu nd lb nv nw nf lf nx ny nh nz bi translated">在我们的ReactJS应用程序中使用BE中的参数</h2><p id="a0e3" class="pw-post-body-paragraph ko kp in kq b kr nj jo kt ku nk jr kw kx nl kz la lb nm ld le lf nn lh li lj ig bi translated">如果您还记得第2部分，我们的<code class="fe mn mo mp mq b">Canvas.js</code>是这样的:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="a20b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">注意这里调用的<code class="fe mn mo mp mq b">dataEntry.params</code>。我们将用它来设置<code class="fe mn mo mp mq b">this.state.params</code>并将<code class="fe mn mo mp mq b">params</code>传递给我们需要的任何组件。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="aaed" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">就这样！简单地对你的其他组件/页面重复同样的操作(如果你需要参数的话),现在你已经成功地将数据从机器人传递到你的ReactJS应用程序了。</strong></p></div><div class="ab cl md me hr mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ig ih ii ij ik"><p id="fa44" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我要介绍的最后一件事(也是可选的)是在应用程序中添加onClicks，这样用户可以点击屏幕来触发一个意图。</p><h1 id="a2f7" class="mr ms in bd mt mu mv mw mx my mz na nb jt nc ju nd jw ne jx nf jz ng ka nh ni bi translated">在ReactJS应用程序中添加onClicks</h1><p id="878e" class="pw-post-body-paragraph ko kp in kq b kr nj jo kt ku nk jr kw kx nl kz la lb nm ld le lf nn lh li lj ig bi translated">让我们再次以用户在<code class="fe mn mo mp mq b">Welcome</code>场景中点击虚构和非虚构按钮为例。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oq"><img src="../Images/bc7f0bbc894b8819ee15bbfedc9c0c1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*91vdrRvF0ObBr4l7uE6l2Q.png"/></div></div></figure><p id="421e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们要做的就是:</p><ol class=""><li id="0a40" class="oa ob in kq b kr ks ku kv kx oc lb od lf oe lj of og oh oi bi translated">在按钮上添加onClicks</li><li id="cb73" class="oa ob in kq b kr oj ku ok kx ol lb om lf on lj of og oh oi bi translated">利用<code class="fe mn mo mp mq b">interactiveCanvas.sendTextQuery(query)</code></li></ol><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="a2fa" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">就这样！</strong></p><h1 id="37d3" class="mr ms in bd mt mu mv mw mx my mz na nb jt nc ju nd jw ne jx nf jz ng ka nh ni bi translated">总结</h1><p id="0289" class="pw-post-body-paragraph ko kp in kq b kr nj jo kt ku nk jr kw kx nl kz la lb nm ld le lf nn lh li lj ig bi translated">如果你已经完成了教程，这里应该是这样的！</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi or"><img src="../Images/2fcd058843e91dea2d3d2d00f8717cd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HQDS7HGCl-0OtZMoHW5JhQ.png"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi os"><img src="../Images/57c2d7f84cff760aa457ac3d5d219bea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zIjtpdMRzIQyKh1Auzl6Qg.png"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi or"><img src="../Images/15f76e6b487e37ebc28d97ca1bbe87fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*imoPQ-Hlo1DJewnwySGYJQ.png"/></div></div></figure><p id="52b2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你需要我的资料库，这里是:</p><div class="lk ll gp gr lm ln"><a href="https://github.com/celiaongsl/new-york-times-bestseller" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd io gy z fp ls fr fs lt fu fw im bi translated">celiaongsl/纽约时报-畅销书</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">这个项目是用Create React App引导的。在项目目录中，您可以运行:在…中运行应用程序</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">github.com</p></div></div><div class="lw l"><div class="ot l ly lz ma lw mb km ln"/></div></div></a></div><p id="2615" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我已经把各部分分解成各自的分支，这样你就可以看看你需要什么了。</p><p id="aa32" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">当然，你可以为测试者甚至公众使用部署你的机器人。但我相信这应该很容易操作！</p><p id="97a7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">请在评论中告诉我你的想法！</p><p id="8a92" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我相信随着谷歌改进他们的产品，许多事情可能会改变，嘿，你甚至可以找到更好的方式来写东西！但希望这将是你进入交互式画布的第一步，并探索它能做什么！</p><p id="1ddf" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">万事如意:)</p><p id="e1b3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="ou">更多内容尽在</em><a class="ae ov" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="ou">plain English . io</em></strong></a></p></div></div>    
</body>
</html>