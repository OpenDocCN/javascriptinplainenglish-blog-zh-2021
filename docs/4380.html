<html>
<head>
<title>Narrowing in TypeScript Using Type Guards</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用类型保护在类型脚本中缩小范围</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/typescript-narrowing-using-type-guards-268e4c6edc0?source=collection_archive---------5-----------------------#2021-09-01">https://javascript.plainenglish.io/typescript-narrowing-using-type-guards-268e4c6edc0?source=collection_archive---------5-----------------------#2021-09-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="dd57" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">帮助TypeScript通过收缩获得正确的类型</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f29f3b4f37d868cd419a48f381f652e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CpbUzWQ0sq2k-d57"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@lkelly1313?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Lorena Kelly</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e531" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在过去的6个月里，我一直在全职使用TypeScript作为前端开发人员。我觉得我把基本的都记下来了。我知道如何创建类型和接口，以及如何在代码中添加类型。</p><p id="9b97" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，我感觉我的TypeScript整体知识还是偏低。我认为还有很多我没有利用的东西。</p><p id="2151" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了让我的打字技能更上一层楼，我决定花些时间学习一些更中级到高级的概念。</p><p id="6701" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一系列文章中，我将介绍我通过阅读TypeScript文档所学到的一些东西。</p><p id="b848" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您不熟悉TypeScript，请先阅读下面的文章，了解一些基本概念。</p><div class="ls lt gp gr lu lv"><a href="https://levelup.gitconnected.com/type-annotation-vs-type-inference-in-typescript-85ba2194ebe1" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">TypeScript中的类型注释与类型推理</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">如何在TypeScript中向变量添加类型</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><p id="3188" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将研究使用类型保护在TypeScript中缩小。</p><h2 id="2462" class="mk ml iq bd mm mn mo dn mp mq mr dp ms lf mt mu mv lj mw mx my ln mz na nb nc bi translated">缩小和类型保护</h2><p id="2cba" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">缩小是采用不太精确的类型并使其更精确的过程。这可以通过使用类型保护来完成。字体保护是一种特殊的检查，可以帮助您缩小字体范围。</p><p id="fda9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据官方的TypeScript文档，我们可以使用许多不同的类型保护来缩小类型。</p><p id="c0bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看如何使用三种常见的方法来缩小类型:</p><ul class=""><li id="6acc" class="ni nj iq ky b kz la lc ld lf nk lj nl ln nm lr nn no np nq bi translated">防护类型</li><li id="c37e" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">in运算符缩小</li><li id="4f23" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">使用类型谓词</li></ul></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><h1 id="170e" class="od ml iq bd mm oe of og mp oh oi oj ms jw ok jx mv jz ol ka my kc om kd nb on bi translated">防护类型</h1><p id="f68e" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated"><code class="fe oo op oq or b">typeof</code>类型保护将用于检查原始类型，因为它将返回以下类型之一:</p><ul class=""><li id="ddf0" class="ni nj iq ky b kz la lc ld lf nk lj nl ln nm lr nn no np nq bi translated"><code class="fe oo op oq or b">"string"</code></li><li id="cd62" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><code class="fe oo op oq or b">"number"</code></li><li id="727c" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><code class="fe oo op oq or b">"bigint"</code></li><li id="b390" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><code class="fe oo op oq or b">"boolean"</code></li><li id="5d48" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><code class="fe oo op oq or b">"symbol"</code></li><li id="9ab1" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><code class="fe oo op oq or b">"undefined"</code></li><li id="bf65" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><code class="fe oo op oq or b">"object"</code></li><li id="e8bb" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><code class="fe oo op oq or b">"function"</code></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/c1375bfd48108369198c929d589eb8f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*-OK4kdvGMdUa7mPMzgrRxg.png"/></div></figure><p id="2265" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个例子中，我有一个接受字符串或数字作为参数的函数。我想返回该项目的长度属性。但是，TypeScript会报错，因为item参数可以是数字，也可以是字符串。如果项目是数字，则没有长度属性。</p><p id="97fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用JavaScript中的<code class="fe oo op oq or b">typeof</code>操作符和一个<code class="fe oo op oq or b">if</code>语句来解决这个问题。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/21a0f81bb3bbeffe9ecaab529384de81.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*H89pGsB-ls9enUm30K81lQ.png"/></div></figure><p id="c110" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在TypeScript错误已经消失了。如果参数是一个字符串，我将返回字符串的长度。如果项目是一个数字，我将返回数字。</p><h1 id="5507" class="od ml iq bd mm oe ou og mp oh ov oj ms jw ow jx mv jz ox ka my kc oy kd nb on bi translated">in运算符缩小</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/f8ea6084cc594621656b0727b6c73363.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*z-EI8xhZcn3aBmYD8De0Yg.png"/></div></figure><p id="3c15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个例子中，我创建了三个不同的类型别名。一个是有名字和国家财产的基本运动员。然后我扩展运动员类型，用游泳方法创建游泳者类型，用跑步方法创建跑步者类型。</p><p id="c49d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我将创建一个名为<code class="fe oo op oq or b">moveAthelete</code>的函数，它接受游泳者或跑步者作为参数。在这个函数中，我想调用参数中的一个方法。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/4fb5181caeadc985c21d8525b1ecd200.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*dOTLHj2r5E7MwcCQYxAZ7A.png"/></div></figure><p id="ce0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以想象，TypeScript会抱怨，因为游泳者类型上不存在<code class="fe oo op oq or b"><strong class="ky ir">run()</strong></code>方法。这类似于我们在第一个例子中收到的错误。不幸的是，我们不能使用<code class="fe oo op oq or b">typeof</code>类型的守卫，因为它们不是原始类型。</p><p id="2590" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">相反，我们可以使用JavaScript中的<code class="fe oo op oq or b">in</code>操作符。如果指定的属性在指定的对象中，<code class="fe oo op oq or b">in</code>操作符返回<code class="fe oo op oq or b">true</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/506007032969a03b45e0d732e21e4765.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*178UzKQs9DuoAJ1imn3WXg.png"/></div></figure><p id="97b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们可以检查运动员参数上是否存在run属性。如果是，它将是一个Runner类型，我们可以调用<code class="fe oo op oq or b"><strong class="ky ir">run()</strong></code>方法。如果run属性不存在，那一定是游泳者类型，我们可以调用<code class="fe oo op oq or b"><strong class="ky ir">swim()</strong></code>方法。</p><h1 id="8360" class="od ml iq bd mm oe ou og mp oh ov oj ms jw ow jx mv jz ox ka my kc oy kd nb on bi translated">使用类型谓词</h1><p id="a00a" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">类型谓词是一种特殊的返回类型，它通知TypeScript编译器特定值是什么类型。我们可以定义一个返回类型为类型谓词的函数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/03d51611a531fe1e571eccd5ebe5ef70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*eeoTPgQW44L3dUF3WjwSSw.png"/></div></figure><p id="b5e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的例子中，我创建了一个名为<code class="fe oo op oq or b">isRunner</code>的新函数。该函数获取运动员的一个参数，运动员可以是跑步者或游泳者。这个函数的返回类型是<code class="fe oo op oq or b">athlete is Runner</code>的类型谓词，它将返回true或false。</p><p id="21aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个函数中，我们检查运动员参数上是否存在<code class="fe oo op oq or b"><strong class="ky ir">run()</strong></code>方法。如果是，那么这个函数将返回true，运动员参数必须是一个跑步者。如果不存在，该函数将返回false，运动员参数必须是游泳运动员。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/c940d618a1e4631eb4c74b6fa50c4bc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*-BAqJOtio_i19AV0XpqR0w.png"/></div></figure><p id="671c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们将创建一个新的运动员变量，它可以是跑步者，也可以是游泳者。然后我们可以使用<code class="fe oo op oq or b">isRunner</code>函数来检查是否对这个变量调用<code class="fe oo op oq or b"><strong class="ky ir">run()</strong></code>或<code class="fe oo op oq or b"><strong class="ky ir">swim()</strong></code>方法。</p><p id="c22c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们有一组运动员，或者是游泳运动员或者是跑步运动员，并且我们只想要一组跑步运动员，这也会很方便。</p><p id="c15d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用<code class="fe oo op oq or b"><strong class="ky ir">filter()</strong></code>方法并传入我们创建的<code class="fe oo op oq or b">isRunner</code>函数作为参数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/a7093343f8c5683fbb43a7c87a277fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*RQ6SJjToLjJOk8BtMyt9_g.png"/></div></figure><p id="e7b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将过滤掉所有游泳者类型，并返回一个仅包含跑步者类型的数组。如果你想了解更多关于<code class="fe oo op oq or b"><strong class="ky ir">filter()</strong></code>方法的工作原理，请查看下面的文章。</p><div class="ls lt gp gr lu lv"><a rel="noopener  ugc nofollow" target="_blank" href="/javascript-tip-remove-an-item-from-an-array-using-the-filter-method-249b2c720e02"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">JavaScript提示:使用Filter方法从数组中移除一个项</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">探究JavaScript中过滤方法和拼接方法的区别。</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="me l"><div class="pf l mg mh mi me mj kp lv"/></div></div></a></div></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><h1 id="3915" class="od ml iq bd mm oe of og mp oh oi oj ms jw ok jx mv jz ol ka my kc om kd nb on bi translated">结论</h1><p id="8165" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">感谢阅读！我希望这篇文章有助于您了解更多关于TypeScript中的缩小。缩小和类型保护是编写良好的TypeScript代码和减少TypeScript向您抱怨的次数的重要部分。</p><p id="495f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想了解更多关于在TypeScript中缩小范围的知识，一定要查看他们的文档<a class="ae kv" href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="678e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在以后的文章中，我将深入探讨更多中级到高级的TypeScript概念，所以请继续关注即将到来的更多内容！</p><p id="2ebc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">更多阅读</strong></p><div class="ls lt gp gr lu lv"><a rel="noopener  ugc nofollow" target="_blank" href="/getting-started-with-typescript-and-react-function-components-558a6f11dc6d"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">TypeScript和React函数组件入门</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">何时应该使用React。定义一个函数组件？</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="me l"><div class="pg l mg mh mi me mj kp lv"/></div></div></a></div><div class="ls lt gp gr lu lv"><a href="https://levelup.gitconnected.com/redux-toolkit-an-easier-way-to-set-up-redux-6782b4857f8" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">Redux工具包:设置Redux的一种更简单的方法</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">如何在React应用程序中使用Redux Toolkit建立Redux存储</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="me l"><div class="ph l mg mh mi me mj kp lv"/></div></div></a></div><p id="280b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">资源</strong></p><ul class=""><li id="924d" class="ni nj iq ky b kz la lc ld lf nk lj nl ln nm lr nn no np nq bi translated"><a class="ae kv" href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html" rel="noopener ugc nofollow" target="_blank">https://www . typescriptlang . org/docs/handbook/2/narrowing . html</a></li></ul><p id="db5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="pi">更多内容请看</em><a class="ae kv" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="pi">plain English . io</em></strong></a></p></div></div>    
</body>
</html>