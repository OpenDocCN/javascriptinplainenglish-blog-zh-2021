<html>
<head>
<title>Why You Should be Cautious with Sequelize Raw Options</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么您应该谨慎对待Sequelize Raw选项</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/why-you-should-be-cautious-with-sequelize-raw-options-5aaae9fc3ebd?source=collection_archive---------3-----------------------#2021-08-05">https://javascript.plainenglish.io/why-you-should-be-cautious-with-sequelize-raw-options-5aaae9fc3ebd?source=collection_archive---------3-----------------------#2021-08-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="5d20" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在使用Sequelize Raw查询时，您应该更有意识</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/abeea06e264e49bad4053966c5ef2520.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*etSENpqWh7WA1_Mh"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@casparrubin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Caspar Camille Rubin</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c0e3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这个故事中，我将记录我自己在Sequelize ORM中使用<code class="fe lp lq lr ls b">raw</code>选项的经历。</p><p id="99d6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">虽然我告诉你要小心使用raw选项，但这并不意味着我说不要使用它。其实我们用的时候只要更用心就好了。这仅仅意味着<strong class="kv io">我知道自己在做什么，也知道为什么要这样做。</strong>当您尝试使用<code class="fe lp lq lr ls b">raw</code>选项时，请回答以下问题。</p><blockquote class="lt"><p id="a156" class="lu lv in bd lw lx ly lz ma mb mc lo dk translated">我知道我在这个查询中使用了<code class="fe lp lq lr ls b">{ raw: true }</code>,我使用它是因为…</p></blockquote><p id="e46a" class="pw-post-body-paragraph kt ku in kv b kw md jo ky kz me jr lb lc mf le lf lg mg li lj lk mh lm ln lo ig bi translated">这个故事可以分为三个部分:</p><ul class=""><li id="3165" class="mi mj in kv b kw kx kz la lc mk lg ml lk mm lo mn mo mp mq bi translated">为什么我要使用<code class="fe lp lq lr ls b">raw</code>选项？(我的目的)</li><li id="18f3" class="mi mj in kv b kw mr kz ms lc mt lg mu lk mv lo mn mo mp mq bi translated">我遇到了什么问题？</li><li id="3d8b" class="mi mj in kv b kw mr kz ms lc mt lg mu lk mv lo mn mo mp mq bi translated">有没有更好的方法可以毫无问题地达到我的目的？</li></ul><p id="3d03" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">事不宜迟，我们开始吧。</p></div><div class="ab cl mw mx hr my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ig ih ii ij ik"><h1 id="fa1a" class="nd ne in bd nf ng nh ni nj nk nl nm nn jt no ju np jw nq jx nr jz ns ka nt nu bi translated">为什么我要使用<code class="fe lp lq lr ls b">raw</code>选项？</h1><p id="f713" class="pw-post-body-paragraph kt ku in kv b kw nv jo ky kz nw jr lb lc nx le lf lg ny li lj lk nz lm ln lo ig bi translated">此时，你可能会问我——为什么要使用那个<code class="fe lp lq lr ls b">raw</code>选项？你想要的产出到底是什么？我很高兴你问这个问题。</p><p id="5294" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">将<code class="fe lp lq lr ls b">raw</code>设置为<code class="fe lp lq lr ls b">true</code>的主要区别是缺少虚拟设置器、获取器和一堆序列数据。有关返回的输出差异，请参考以下要点。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Sample of different outputs for raw option</figcaption></figure><p id="80a3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">所以在我的大多数情况下，我只想要数据库中的数据。这里可能没有使用Sequelize setters和getters。<strong class="kv io">因此将</strong> <code class="fe lp lq lr ls b"><strong class="kv io">raw</strong></code> <strong class="kv io">设置为true为我提供了想要的输出，看起来&amp;感觉</strong>。</p></div><div class="ab cl mw mx hr my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ig ih ii ij ik"><h1 id="6eb7" class="nd ne in bd nf ng nh ni nj nk nl nm nn jt no ju np jw nq jx nr jz ns ka nt nu bi translated">布尔类型的问题</h1><p id="c446" class="pw-post-body-paragraph kt ku in kv b kw nv jo ky kz nw jr lb lc nx le lf lg ny li lj lk nz lm ln lo ig bi translated">大多数时候，使用<code class="fe lp lq lr ls b">raw</code>属性不会给你带来太多的问题。但是，它会影响<strong class="kv io">布尔</strong>数据类型字段。你们大多数人可能都知道:</p><blockquote class="lt"><p id="1aa4" class="lu lv in bd lw lx ly lz ma mb mc lo dk translated"><strong class="ak"> MySQL不包含内置的布尔</strong>或Bool数据类型。它们提供TINYINT数据类型，而不是Boolean或Bool数据类型。MySQL认为零值为假，非零值为真。——<a class="ae ks" href="https://www.javatpoint.com/mysql-boolean#:~:text=MySQL%20does%20not%20contain%20built,to%200%20and%201%20value." rel="noopener ugc nofollow" target="_blank">Javatpoint.com</a></p></blockquote><p id="9c81" class="pw-post-body-paragraph kt ku in kv b kw md jo ky kz me jr lb lc mf le lf lg mg li lj lk mh lm ln lo ig bi translated">因此，在Sequelize中使用raw选项将为布尔字段返回一个0或1的数字，因为MySQL使用<code class="fe lp lq lr ls b">TINYINT</code>而不是布尔。</p></div><div class="ab cl mw mx hr my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ig ih ii ij ik"><h1 id="71df" class="nd ne in bd nf ng nh ni nj nk nl nm nn jt no ju np jw nq jx nr jz ns ka nt nu bi translated">更好的方法——使用toJSON</h1><p id="d35e" class="pw-post-body-paragraph kt ku in kv b kw nv jo ky kz nw jr lb lc nx le lf lg ny li lj lk nz lm ln lo ig bi translated">更好的方法是在顺序模型中使用<code class="fe lp lq lr ls b">toJSON</code>函数。使用<code class="fe lp lq lr ls b">toJSON</code>时，代码和输出请参考以下要点。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="655f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><code class="fe lp lq lr ls b">toJSON</code>函数调用帮助我获得了想要的结果:</p><ul class=""><li id="3ec2" class="mi mj in kv b kw kx kz la lc mk lg ml lk mm lo mn mo mp mq bi translated">具有更清晰外观和感觉的数据(没有与对象相关的序列)</li><li id="9d82" class="mi mj in kv b kw mr kz ms lc mt lg mu lk mv lo mn mo mp mq bi translated"><code class="fe lp lq lr ls b">sold_out</code>字段作为布尔值而不是数字返回。</li></ul></div><div class="ab cl mw mx hr my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ig ih ii ij ik"><h1 id="5a00" class="nd ne in bd nf ng nh ni nj nk nl nm nn jt no ju np jw nq jx nr jz ns ka nt nu bi translated">结论</h1><p id="3717" class="pw-post-body-paragraph kt ku in kv b kw nv jo ky kz nw jr lb lc nx le lf lg ny li lj lk nz lm ln lo ig bi translated">简而言之，这个故事分享了我使用Sequelize <code class="fe lp lq lr ls b">raw</code>选项的经验，设置<code class="fe lp lq lr ls b">raw</code>为真将改变你的布尔期望字段为数字，最后，我们可以使用一个更好的方法，即<code class="fe lp lq lr ls b">toJSON</code>来实现我想要的结果。</p><p id="dad7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">感谢阅读。</p><p id="3809" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="oc">更多内容请看</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="oc">plain English . io</em></strong></a></p></div></div>    
</body>
</html>