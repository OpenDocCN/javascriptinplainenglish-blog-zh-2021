<html>
<head>
<title>Want To Make Your Next.js App Faster? Enable Preact Support</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">想让你的Next.js App更快？启用预先支持</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/next-js-preact-f993c95a3f93?source=collection_archive---------1-----------------------#2021-08-12">https://javascript.plainenglish.io/next-js-preact-f993c95a3f93?source=collection_archive---------1-----------------------#2021-08-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4300" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何在你的Next.js应用上启用Preact支持，并几乎免费节省几千字节。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/849a06b1a0d3ee6ec2e906efec5eefe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NBp5wbAyRyjocWT_fw3-oA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: the author</figcaption></figure><p id="456e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为什么Preact的使用率如此之低？</p><p id="37c5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">不知何故，我们都知道严格控制饮食的图书馆是存在的。我们大多数人也知道Preact在大多数情况下更快。(我在这里做了一个比较<a class="ae lr" rel="noopener ugc nofollow" target="_blank" href="/i-built-the-same-app-with-react-and-preact-here-are-the-differences-b0da382a6f72"/>)<br/>然而，React是许多开发人员的首选。</p><p id="fd15" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">声称Preact是React.js的100%替代品是错误的。<br/>然而，Preact在许多情况下是一个极好的替代品。</p><p id="2f78" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">例如，因为它支持钩子，就像react中一样，并帮助我们通过preact-compat进行迁移，所以我将几个React应用程序迁移到Preact——没有任何问题。</p><p id="d268" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在有一段时间，Next.js也支持Preact。我创建了同一个小应用程序，一个带有React，一个带有Preact支持——结果相当不错:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/b426fae94cfa8fcef4a79867ca0838aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*K23Hxcevy8c8tq5a08EbYA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Size of the Next + React app</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/53ddab97c723de1dfed7af14a800172e.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*X_o59eZbn5_d8f0u9Rg3wA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Size of the Next + Preact app</figcaption></figure><p id="8e99" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我让你兴奋了吗？太好了！以下是如何几乎毫不费力地将Next.js应用程序转移到Preact上的方法。</p><h2 id="fc9d" class="lu lv iq bd lw lx ly dn lz ma mb dp mc le md me mf li mg mh mi lm mj mk ml mm bi translated">开始基本的Next.js设置</h2><p id="e280" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated">对你们大多数人来说，这并不新鲜，所以让我们尽快完成。</p><p id="b831" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">创建一个新目录。移动到其中，运行<code class="fe ms mt mu mv b">npm init .</code>和<code class="fe ms mt mu mv b">npm install react react-dom next</code>。在根目录下创建一个名为<code class="fe ms mt mu mv b">pages</code>的目录，在那里创建一个名为<code class="fe ms mt mu mv b">index.js</code>的文件。package.json的脚本部分应该如下所示:</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="731b" class="lu lv iq mv b gy na nb l nc nd">"scripts": { <br/>  "start": "next start", <br/>  "dev": "next dev", <br/>  "build": "next build" <br/>}</span></pre><p id="3b13" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们可以填写<code class="fe ms mt mu mv b">pages/index.js</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="3028" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有趣的是，我们现在有了一个充满了React特有内容的文件。然而，我们可以很容易地将其迁移到Preact。</p><h2 id="04d4" class="lu lv iq bd lw lx ly dn lz ma mb dp mc le md me mf li mg mh mi lm mj mk ml mm bi translated">在Next.js中切换到Preact</h2><p id="8358" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated">为此，首先，我们需要安装一些东西:</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="594a" class="lu lv iq mv b gy na nb l nc nd">npm install --save next next-plugin-preact preact react@npm:@preact/compat react-dom@npm:@preact/compat react-ssr-prepass@npm:preact-ssr-prepass preact-render-to-string</span></pre><p id="c93a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">重要提示:如果你现在查看你的<code class="fe ms mt mu mv b">package.json</code>，你会发现以前的依赖项react、react-dom等等被覆盖了。所以，如果你想回到普通反应，不要忘记改变这些。</p><p id="16c2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们需要让Next知道我们的变化。在项目的根目录下创建一个<code class="fe ms mt mu mv b">next.config.js</code>，并像这样填充它:</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="a12f" class="lu lv iq mv b gy na nb l nc nd">const withPreact = require('next-plugin-preact')</span><span id="d2b7" class="lu lv iq mv b gy ng nb l nc nd">module.exports = withPreact({<br/> // all your other Next.js options<br/>})</span></pre><p id="d92b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">就是这样！最初，Preact对钩子和co .使用了与react不同的导入。比如<code class="fe ms mt mu mv b">import { useState } from "preact/hooks"</code>。</p><p id="2d1f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，我们不需要关心这个，因为preact-compat帮助我们迁移。因此，您不需要更改<code class="fe ms mt mu mv b">index.js</code>，即使它从React导入内容。</p><p id="78c4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您现在运行<code class="fe ms mt mu mv b">npm run build</code>，您的Preact页面就准备好了。</p><p id="6f35" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你也可以在<code class="fe ms mt mu mv b">npm run build</code>给你的信息中看到改变的尺寸，而不仅仅是在浏览器中。如果你想把这个和普通的React + Next应用的包大小进行比较，记住要把<code class="fe ms mt mu mv b">package.json</code>改回来，而不仅仅是<code class="fe ms mt mu mv b">next.config.js</code>。</p><h2 id="4b66" class="lu lv iq bd lw lx ly dn lz ma mb dp mc le md me mf li mg mh mi lm mj mk ml mm bi translated">最后的想法</h2><p id="623e" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated">切换到Preact已经帮了我好几次了。但是，Preact不能100%替代react。因为两个库都在不断变化，所以最好自己研究一下，确定哪些React特性可以毫无问题地用在Preact中。</p><p id="ef6c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，对于开发过程，我认为最好坚持使用React。但是，在生产版本中，Preact可以节省几千字节。</p><p id="d568" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢您的阅读！</p><p id="81f9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">关于Preact和Next的更多信息:</strong></p><div class="nh ni gp gr nj nk"><a rel="noopener  ugc nofollow" target="_blank" href="/i-built-the-same-app-with-react-and-preact-here-are-the-differences-b0da382a6f72"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">我用React和Preact构建了相同的应用程序。以下是不同之处</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">以及测量的大小、性能和实现</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny kp nk"/></div></div></a></div><div class="nh ni gp gr nj nk"><a rel="noopener  ugc nofollow" target="_blank" href="/next-js-webassembly-77df3537690"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">用Next.js构建您的第一个WebAssembly组件</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">而不必首先设置编译器</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nt l"><div class="nz l nv nw nx nt ny kp nk"/></div></div></a></div><h2 id="2c34" class="lu lv iq bd lw lx ly dn lz ma mb dp mc le md me mf li mg mh mi lm mj mk ml mm bi translated">进一步阅读</h2><div class="nh ni gp gr nj nk"><a href="https://plainenglish.io/blog/which-database-should-you-use-for-your-next-js-app" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">Next.js应用程序应该使用什么数据库？</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">如果你在2022年要开发一个全栈应用，选择流行的Next.js会让你有95%的机会…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">简明英语. io</p></div></div><div class="nt l"><div class="oa l nv nw nx nt ny kp nk"/></div></div></a></div><div class="nh ni gp gr nj nk"><a href="https://plainenglish.io/blog/how-to-build-a-graphql-ecommerce-app-from-scratch" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">如何从头开始构建一个GraphQL电子商务应用程序</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">这就是你要建造的东西！埃森哲的一项调查(19个国家的20，000多名消费者)发现，47%的人…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">简明英语. io</p></div></div><div class="nt l"><div class="ob l nv nw nx nt ny kp nk"/></div></div></a></div><div class="nh ni gp gr nj nk"><a href="https://blog.bitsrc.io/next-js-13-what-do-the-new-bleeding-edge-features-actually-do-d3e5fd418563" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">Next.js 13:新的前沿特性实际上是做什么的？</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">你听说过Next.js 13是一个游戏改变者，但是为什么？让我们看看有哪些新功能，有哪些变化，以及它们…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">blog.bitsrc.io</p></div></div><div class="nt l"><div class="oc l nv nw nx nt ny kp nk"/></div></div></a></div></div><div class="ab cl od oe hu of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="ij ik il im in"><p id="0288" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls">更多内容请看</em><a class="ae lr" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="ls">plain English . io</em></strong></a><em class="ls">。报名参加我们的</em> <a class="ae lr" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="ls">免费周报</em> </strong> </a> <em class="ls">。关注我们关于</em><a class="ae lr" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="ls">Twitter</em></strong></a><a class="ae lr" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="ls">LinkedIn</em></strong></a><em class="ls"/><a class="ae lr" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="ls">YouTube</em></strong></a><em class="ls"/><a class="ae lr" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="ls">不和</em> </strong> </a> <em class="ls">。对增长黑客感兴趣？检查</em> <a class="ae lr" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="ls">电路</em> </strong> </a> <em class="ls">。</em></p></div></div>    
</body>
</html>