<html>
<head>
<title>Use nvm for Multi-Project Success</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用nvm实现多项目成功</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/use-nvm-for-multi-project-success-a93e8abd1306?source=collection_archive---------6-----------------------#2021-07-25">https://javascript.plainenglish.io/use-nvm-for-multi-project-success-a93e8abd1306?source=collection_archive---------6-----------------------#2021-07-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9c13" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何为Node.js设置开发环境，以控制Node.js版本</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5d93f524a984b6354fa8b19bca63b7ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zKK6dNJC4-0SgTGw"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@jstrippa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">James Harrison</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f0b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我的职业生涯中，我有幸与一些非常聪明的工程师一起工作并向他们学习。他们的一个共同特点是，即使在管理多个项目时，他们都知道如何管理不同的环境。而且他们在日常工作流程中的开销几乎为零。那么，我们如何设置我们的工具来照顾项目环境，并清理我们的头脑来关注实际的编码呢？</p><p id="e8cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为起点，我们在本地机器上有几个Node.js项目，它们都是git存储库。我假设您熟悉bash或zsh这样的shell，并且您将在Linux或Mac上工作。我没有使用Windows的经验，但同样的原则也适用。</p><p id="69e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于任何节点项目，都有两种依赖关系需要考虑:项目期望的节点版本，以及所有必需节点模块的列表。为了管理第一个模块，我们将使用<code class="fe ls lt lu lv b">nvm</code>和模块<code class="fe ls lt lu lv b">npm</code>。本文集中讨论前者，因为<code class="fe ls lt lu lv b">npm</code>在处理后者方面已经做得很好了。</p><h1 id="49db" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">使用nvm管理Node.js版本</h1><p id="10a2" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">要在笔记本电脑上运行任何JavaScript，你需要一个运行时环境来执行你的代码，而<a class="ae kv" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>是目前最流行的。您可以将它安装在您的开发机器上，这样您的第一个节点项目，甚至第二个节点项目都可以正常运行。但是，如果您想在第三个版本中使用较新版本的node，或者您正在处理一个需要旧版本的现有项目，您该怎么办？您是否更新以前的项目以使用新版本，或者您是否接受您可能无法再运行旧项目？</p><p id="7ed9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们希望每个项目都有一个全球版本，而不是一个。这里<code class="fe ls lt lu lv b"><a class="ae kv" href="https://github.com/nvm-sh/nvm" rel="noopener ugc nofollow" target="_blank">nvm</a></code>来救援了。<code class="fe ls lt lu lv b">nvm</code>代表节点版本管理器，具体做法是:你先安装<code class="fe ls lt lu lv b">nvm</code>(这里的说明是<a class="ae kv" href="https://github.com/nvm-sh/nvm#installing-and-updating" rel="noopener ugc nofollow" target="_blank"/>)，然后用它来安装你需要的节点版本。确保当你安装<code class="fe ls lt lu lv b">nvm,</code>时，它会添加一个代码片段到你的<code class="fe ls lt lu lv b">~/.bashrc</code>(或者等效的文件)中。如果没有，您可能需要手动执行此操作，并重启您的shell来使用它。</p><p id="a7a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里列出了最有用的<code class="fe ls lt lu lv b">nvm</code>命令。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="9df0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们可以安装我们需要的所有版本，并根据需要在它们之间切换。不幸的是，我们必须记住哪个项目需要什么版本。但我承诺零开销，所以我们可以做得更好。</p><h1 id="93dd" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">自动切换节点版本</h1><p id="1b2a" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">如果我们不想记住我们为哪个项目使用哪个节点版本，我们必须将它存储在某个地方。为此，我们为每个项目创建<code class="fe ls lt lu lv b">.nvmrc</code>文件，例如通过运行<code class="fe ls lt lu lv b">echo "v16.3" &gt; .nvmrc</code>。这个文件应该被签入到版本控制中，并且在协作项目中，它可能已经存在。现在我们可以运行<code class="fe ls lt lu lv b">nvm use</code>，它将从这个文件中获得正确的版本。</p><p id="a762" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更好的是，<code class="fe ls lt lu lv b">nvm</code> README提供了代码片段，供您添加到您的<code class="fe ls lt lu lv b">~/.bashrc</code>(或等效物)中，在进入目录时，将检查是否有<code class="fe ls lt lu lv b">.nvmrc</code>文件并切换到该版本。当您离开目录时，它也会切换回来。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/0d801ecfbb2b39ea4168060e47d8f68f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*60yyEoOiv4_Y09Nr9oMFqw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">nvm switching node version when you cd into a project with a .nvmrc file</figcaption></figure><p id="9707" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果没有安装节点版本，它会帮你安装！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/93a64e2110c998794317bff76c094687.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fgfDolkWPItKgvOCV5qaSw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">nvm installing a node version when not present</figcaption></figure><p id="eb97" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们知道了:当我们在不同的项目之间切换时，我们自动切换到项目需要的正确的Node.js版本，零操作开销。</p><h1 id="f4ae" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">蛋糕上的视觉樱桃</h1><p id="86e1" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">我使用带有oh-my-zsh的zsh作为shell，它有很多不错的特性，比如显示当前的git分支。所以下一步也是最后一步就是:它还能显示当前的节点版本吗？答案是肯定的，可以！有几种方法可以做到这一点，这取决于您希望您的shell看起来是什么样子。</p><ul class=""><li id="93c8" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated"><a class="ae kv" href="https://gist.github.com/lucas-sonnabend/fda98ed191c69bc44e811d1b4aeb0dca" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/Lucas-sonna bend/FDA 98 ed 191 c 69 BC 44 e 811 D1 B4 aeb 0 DCA</a></li><li id="4830" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated"><a class="ae kv" href="https://github.com/ohmyzsh/ohmyzsh/wiki/Themes#bureau" rel="noopener ugc nofollow" target="_blank">https://github.com/ohmyzsh/ohmyzsh/wiki/Themes#bureau</a></li><li id="f5b4" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated"><a class="ae kv" href="https://www.npmjs.com/package/pure-prompt-nvm" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/pure-prompt-nvm</a></li></ul><p id="c47d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我选择了第一个选项，这是最终的外观:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/6cfe24f21141ecf1f1fac2786b6dac59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m1ala9V6dfB0yGFS03bz2Q.png"/></div></div></figure><h1 id="1acf" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">替代品怎么样？</h1><p id="b762" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">另一种方法是<a class="ae kv" href="https://nodejs.org/en/docs/guides/nodejs-docker-webapp/" rel="noopener ugc nofollow" target="_blank">将你的申请</a>归档。在docker文件中定义节点版本，并在docker容器中运行应用程序和任何测试。如果您将应用程序部署为docker容器，这很有用，但会增加一些开销。在Mac上有一个性能开销，我发现在docker中运行测试和林挺有点烦人。</p><p id="5995" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">编辑:文章发表后有人提到了<a class="ae kv" href="https://volta.sh/" rel="noopener ugc nofollow" target="_blank"> Volta </a>，它的工作原理非常类似于nvm，但是是用rust编写的。我自己没有试过，但它保证很快，并且可以跨操作系统工作，包括Windows。</p><h1 id="d122" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">最后的想法</h1><p id="23a0" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">理解和使用<code class="fe ls lt lu lv b">nvm</code>会让你变成<a class="ae kv" href="https://medium.com/ingeniouslysimple/the-origins-of-the-10x-developer-2e0177ecef60" rel="noopener"> 10x开发者</a>吗？很可能不是。但是它会带你向它迈一小步，因为它会自动执行一些小步骤，并且，在一些初始设置之后，解放你的思想，永远不再想这个问题。</p><p id="dbaa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在开始，我谈到了聪明的工程师使用这种设置。我想到的人不一定是JavaScript或节点开发人员。一旦你环顾四周，你会发现这个问题以不同的方式存在:使用<a class="ae kv" href="https://github.com/pyenv/pyenv" rel="noopener ugc nofollow" target="_blank"> pyenv </a>管理python版本，使用<a class="ae kv" href="https://github.com/ohmyzsh/ohmyzsh/tree/master/plugins/dotenv" rel="noopener ugc nofollow" target="_blank">dotenv</a>/<a class="ae kv" href="https://github.com/ohmyzsh/ohmyzsh/tree/master/plugins/direnv" rel="noopener ugc nofollow" target="_blank">direnv</a>管理环境变量，或者使用<a class="ae kv" href="https://tfswitch.warrensbox.com/" rel="noopener ugc nofollow" target="_blank"> tfswitch </a>管理terraform。当然，伟大的软件工程师会发现这种模式:)</p><p id="8808" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nm">更多内容请看</em><a class="ae kv" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="nm">plain English . io</em></strong></a></p></div></div>    
</body>
</html>