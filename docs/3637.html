<html>
<head>
<title>Integrate React with Django: The Best Full-Stack Web Integration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与Django集成React:最好的全栈Web集成</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-django-full-stack-the-best-web-integration-e9d92af43b96?source=collection_archive---------0-----------------------#2021-07-22">https://javascript.plainenglish.io/react-django-full-stack-the-best-web-integration-e9d92af43b96?source=collection_archive---------0-----------------------#2021-07-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/e73b7c4c4fc936abf3f73691200105f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jS75tVmzU2axwA_q.jpg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">source: codingforentrepreneurs</figcaption></figure><h1 id="e7e4" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">介绍</h1><p id="f2bf" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated"><strong class="kz io"> React </strong>和<strong class="kz io"> Django </strong>是目前最流行的两个框架(当我这么说的时候，我指的是这两个框架),它们被许多流行网站(包括媒体本身)大量用于制作。</p><p id="8c12" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">现在，如果你已经来到这里，那么这意味着你知道这些框架是如何工作的。如果没有，那么马上停止阅读这篇文章。</p><p id="5390" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">那么我们开始吧，集成React和Django的方法有很多。虽然没有"<em class="ma">官方"</em>的方式来做到这一点。这是我的方法，我个人认为可以算作最佳实践。</p><blockquote class="mb mc md"><p id="1aec" class="kx ky ma kz b la lv lc ld le lw lg lh me lx lk ll mf ly lo lp mg lz ls lt lu ig bi translated">在这一个中，我们将分别处理React和Django，最后，为了制作，我们可以运行<code class="fe mh mi mj mk b"><em class="in">npm run build</em></code>(以便将整个React应用程序捆绑到单个文件夹中)，然后可以提供给Django进行渲染。</p></blockquote><p id="d3eb" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">听起来像个计划？😇</p><p id="dcb9" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">好了，不用设置，创建一个新文件夹“DJREACT”。<br/> <em class="ma">(假设你已经安装了Python和Node.js】</em></p><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/03578232255471a04aa0fbd662728cd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*YinnQHh6aJodlpEyJKffPg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Directory structure</figcaption></figure><h1 id="15dc" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">React前端设置</h1><p id="bba8" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">创建一个新文件夹<code class="fe mh mi mj mk b">frontend</code>，运行<code class="fe mh mi mj mk b">npx create-react-app frontend</code>(你可以稍后在<em class="ma"> package.json </em>文件中编辑这个名字)</p><p id="bf9f" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">我们还需要Axios来处理我们稍后将在后端创建的API</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="ad37" class="mu ka in mk b gy mv mw l mx my">npm install axios</span></pre><p id="6704" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">打开<strong class="kz io"> package.json </strong>并添加这个</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="e3c9" class="mu ka in mk b gy mv mw l mx my">{<br/>  "name": "djreact",<br/>  ...<br/>  "proxy": "http://localhost:8000",<br/>  "homepage": "/dist",<br/>  ...<br/>}</span></pre><p id="50c1" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma"> &gt;第一行→ </em> <strong class="kz io">名称</strong>:重命名项目(没有任何区别)</p><p id="eacd" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma"> &gt;第二行→ </em> <strong class="kz io">代理</strong>:这将有助于<strong class="kz io">隧道API请求</strong>到<a class="ae mz" href="http://localhost:8000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8000 </a>，Django应用程序将在那里处理这些请求，因此我们可以在React中像这样简化请求的编写:</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="94cb" class="mu ka in mk b gy mv mw l mx my">axios.get("/webapi/accounts/")</span></pre><p id="3274" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">而不是这个:</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="5759" class="mu ka in mk b gy mv mw l mx my">axios.get("http://localhost:8000/webapi/accounts/")</span></pre><p id="5046" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma"> &gt;第三行→ </em> <strong class="kz io">主页</strong>:这样在<em class="ma"> build </em>文件夹中捆绑的react项目中的所有静态文件都可以匹配Django的URLPATTERN(必须与Django中<code class="fe mh mi mj mk b">settings.py</code>的STATIC_URL变量相同)</p><p id="eb27" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma">现在使用`</em><a class="ae mz" href="https://www.npmjs.com/package/axios" rel="noopener ugc nofollow" target="_blank"><em class="ma">Axios</em></a><em class="ma">`( NPM包)，通过API端点与Django后端通信</em></p><p id="b460" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">以下是如何使用Axios的一个片段:</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="662a" class="mu ka in mk b gy mv mw l mx my">handleSubmit = item =&gt; {<br/>    this.toggle();<br/>    if (item.id) {<br/>    axios<br/>        .put(`http://localhost:8000/webapi/accounts/${item.id}/`, item)<br/>        .then(res =&gt; this.refreshList());<br/>    return;<br/>    }<br/>    axios<br/>      .post("http://localhost:8000/webapi/accounts/", item)<br/>      .then(res =&gt; this.refreshList());<br/>};</span><span id="cb44" class="mu ka in mk b gy na mw l mx my">handleDelete = item =&gt; {<br/>    axios<br/>        .delete(`http://localhost:8000/webapi/accounts/${item.id}`)<br/>        .then(res =&gt; this.refreshList());<br/>};</span></pre><p id="8200" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">运行<code class="fe mh mi mj mk b">npm start</code>来运行应用程序，它应该工作。</p><h2 id="4b6c" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">修复Django的CSRF令牌验证冲突</h2><p id="9db4" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">Django提供的<strong class="kz io">内置CSRF保护</strong>对于<strong class="kz io">保护您的服务器免受恶意网站</strong>攻击非常有用，这些网站可以利用您的访客浏览器来攻击您。然而，当使用现代JavaScript库时，你需要以不同的方式处理CSRF。</p><p id="b3e3" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在前端编辑<code class="fe mh mi mj mk b"><strong class="kz io">src/App.js</strong></code></p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="34c8" class="mu ka in mk b gy mv mw l mx my">import axios from 'axios';</span><span id="d2fc" class="mu ka in mk b gy na mw l mx my">axios.defaults.xsrfCookieName = 'csrftoken'<br/>axios.defaults.xsrfHeaderName = 'X-CSRFToken'</span></pre><p id="d430" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma">我知道，我把Axios的大部分留给你，因为这很容易做到。</em> <a class="ae mz" href="https://www.youtube.com/watch?v=6LyagkoRWYA" rel="noopener ugc nofollow" target="_blank"> <em class="ma">链接教程</em> </a></p><h2 id="4f31" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">输出</h2><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/8f2e7375b2bb911cf038dbd0232c74ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LpEvGkScywgpQRReXUeIgg.png"/></div></div></figure></div><div class="ab cl nn no hr np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ig ih ii ij ik"><h1 id="3ddd" class="jz ka in bd kb kc nu ke kf kg nv ki kj kk nw km kn ko nx kq kr ks ny ku kv kw bi translated">Django后端设置</h1><blockquote class="mb mc md"><p id="2c13" class="kx ky ma kz b la lv lc ld le lw lg lh me lx lk ll mf ly lo lp mg lz ls lt lu ig bi translated">Django的唯一目的是创建一个API，React可以使用它与数据库进行通信。</p></blockquote><h2 id="9d69" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">为Python创建虚拟环境(可选)</h2><p id="dae2" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">在“DJREACT”中打开命令行外壳并运行<code class="fe mh mi mj mk b">$ pip install pipenv</code></p><p id="2523" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><code class="fe mh mi mj mk b">$ pipenv shell</code>(这将创建一个虚拟环境)</p><p id="afe5" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">这一步是可选的，尽管建议使用虚拟Env，因为将来您可能会将代码推到某个地方。</p><h2 id="d210" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">Django实际安装</h2><p id="bb82" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">我推荐你首先阅读<a class="ae mz" href="https://www.django-rest-framework.org/tutorial/1-serialization/" rel="noopener ugc nofollow" target="_blank"> Django Rest框架文档</a></p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="122a" class="mu ka in mk b gy mv mw l mx my">$ pipenv install django djangorestframework djangorestframework-simplejwt django-cors-headers<br/>$ django-admin startproject djreact .<br/>$ python manage.py startapp accounts</span><span id="2746" class="mu ka in mk b gy na mw l mx my">$ python manage.py migrate<br/>$ python manage.py createsuperuser --username admin<br/>  Email: ......<br/>  Password: ........</span></pre><p id="93dd" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在djreact (main)中编辑<code class="fe mh mi mj mk b"><strong class="kz io">settings.py</strong></code> <strong class="kz io"> </strong></p><p id="c33b" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">这些设置看起来很重要。尤其是DRF认证，它为整个应用程序配置API权限，但您也可以为每个视图手动设置。</p><p id="d1a7" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">但是请记住，这些是<strong class="kz io">而不是</strong>生产设置，在某些情况下，您必须更改一些变量。</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="06e8" class="mu ka in mk b gy mv mw l mx my">ALLOWED_HOSTS = ['localhost', 'localhost:3000']</span><span id="c09f" class="mu ka in mk b gy na mw l mx my">CORS_ORIGIN_WHITELIST = [<br/>    'http://localhost:3000',<br/>]</span><span id="8cd3" class="mu ka in mk b gy na mw l mx my">INSTALLED_APPS = [<br/>    ...<br/>    # Third party apps<br/>    'rest_framework',<br/>    'corsheaders',<br/>    <br/>    # My apps<br/>    'accounts.apps.AccountsConfig',<br/>]</span><span id="b74f" class="mu ka in mk b gy na mw l mx my"># <a class="ae mz" href="https://www.django-rest-framework.org/api-guide/authentication/#setting-the-authentication-scheme" rel="noopener ugc nofollow" target="_blank">DRF Authentication Scheme</a> &lt;- you can click here :)</span><span id="f8de" class="mu ka in mk b gy na mw l mx my"># set permission according to your requirements<br/>REST_FRAMEWORK = {<br/>    'DEFAULT_AUTHENTICATION_CLASSES’: [<br/>        'rest_framework_simplejwt.authentication.JWTAuthentication’,<br/>    ],<br/>    'DEFAULT_PERMISSION_CLASSES’: [<br/>        'rest_framework.permissions.DjangoModelPermissions’,<br/>        'rest_framework.permissions.IsAdminUser'<br/>    ]<br/>}</span><span id="0c44" class="mu ka in mk b gy na mw l mx my">MIDDLEWARE = [<br/>    ...,<br/>    'corsheaders.middleware.CorsMiddleware',<br/>    ...,<br/>]</span><span id="6858" class="mu ka in mk b gy na mw l mx my">TEMPLATES = [<br/>    {<br/>        'BACKEND': 'django.template.backends.django.DjangoTemplates',<br/>        'DIRS': [ BASE_DIR / 'frontend' ],<br/>        ...<br/>        },<br/>    },<br/>]</span><span id="9f3d" class="mu ka in mk b gy na mw l mx my">...</span><span id="6901" class="mu ka in mk b gy na mw l mx my">STATIC_URL = '/dist/'</span><span id="c8ff" class="mu ka in mk b gy na mw l mx my"># Extra places for collectstatic to find static files.<br/>STATIC_ROOT = BASE_DIR / 'staticfiles'</span><span id="bbe3" class="mu ka in mk b gy na mw l mx my">STATICFILES_DIRS = [<br/>    BASE_DIR / 'frontend/build',<br/>]</span></pre><p id="4a67" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">现在运行这些命令来确保所有的表都被创建了。</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="3aea" class="mu ka in mk b gy mv mw l mx my">$ python manage.py makemigrations<br/>$ python manage.py migrate</span></pre><h2 id="46cc" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">英寸/帐户文件夹</h2><p id="79c3" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">Django REST框架中的序列化器<strong class="kz io">负责将对象转换成javascript和前端框架能够理解的数据类型</strong>。</p><p id="960c" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在账户中创建<code class="fe mh mi mj mk b"><strong class="kz io">serializers.py</strong></code></p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="6fb6" class="mu ka in mk b gy mv mw l mx my">from rest_framework import serializers<br/>from django.contrib.auth.models import User</span><span id="f7dd" class="mu ka in mk b gy na mw l mx my">class UserSerializer(serializers.ModelSerializer):<br/>    class Meta:<br/>        model = User<br/>        fields = '__all__'</span></pre><p id="2782" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">你已经知道什么是视图了，对吗？没有吗？？那你在这里做什么？</p><p id="f5fd" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在账户中编辑<code class="fe mh mi mj mk b"><strong class="kz io">views.py</strong></code></p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="fe84" class="mu ka in mk b gy mv mw l mx my">from rest_framework import viewsets</span><span id="fc01" class="mu ka in mk b gy na mw l mx my">from django.contrib.auth.models import User<br/>from .serializers import UserSerializer<br/># To make password encryption<br/>from django.contrib.auth.hashers import make_password</span><span id="e4d7" class="mu ka in mk b gy na mw l mx my"># API view for django.contrib.auth.models.User<br/>class UserViewSet(viewsets.ModelViewSet):<br/>    queryset = User.objects.all()<br/>    serializer_class = UserSerializer</span><span id="89b6" class="mu ka in mk b gy na mw l mx my"># it takes recent instance from serialzer and uses `make_password` to encrypt<br/>    <!-- -->def perform_create(self, serializer):<br/>    # Hash password but passwords are not required<br/>    if ('password' in self.request.data):<br/>        password = make_password(self.request.data['password'])<br/>        serializer.save(password=password)<br/>    else:<br/>        serializer.save()</span><span id="ba55" class="mu ka in mk b gy na mw l mx my">def perform_update(self, serializer):<br/>    # Hash password but passwords are not required<br/>    if ('password' in self.request.data):<br/>        password = make_password(self.request.data['password'])<br/>        serializer.save(password=password)<br/>    else:<br/>        serializer.save()</span></pre><p id="9ea0" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在账户中编辑<code class="fe mh mi mj mk b"><strong class="kz io">urls.py</strong></code></p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="b99a" class="mu ka in mk b gy mv mw l mx my">from django.urls import path, include</span><span id="d657" class="mu ka in mk b gy na mw l mx my">from rest_framework.routers import DefaultRouter</span><span id="2495" class="mu ka in mk b gy na mw l mx my">from . import views</span><span id="9e94" class="mu ka in mk b gy na mw l mx my"># <em class="ma">Registering </em>Rest-API routes for Accounts<br/>router = DefaultRouter()<br/>router.register(r'user', views.UserViewSet, 'user')</span><span id="d535" class="mu ka in mk b gy na mw l mx my">urlpatterns = [<br/>    path('', include(router.urls), name='accounts_api'),<br/>]</span></pre><h2 id="e2a1" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">英寸/djreact(主)项目文件夹</h2><p id="8714" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">在djreact (main)中创建<code class="fe mh mi mj mk b"><strong class="kz io">views.py</strong></code></p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="c7a0" class="mu ka in mk b gy mv mw l mx my">from django.shortcuts import render</span><span id="7784" class="mu ka in mk b gy na mw l mx my">def index(request):<br/>    return render(request, 'build/index.html')</span></pre><p id="7d32" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><strong class="kz io"> <em class="ma">注意:</em> </strong> <em class="ma">您可以在开发中将“build”改为“public”，为此您需要将</em> <code class="fe mh mi mj mk b"><em class="ma">webpack.config.js</em></code> <em class="ma">和</em> <code class="fe mh mi mj mk b"><em class="ma">.babelrc</em></code> <em class="ma">配置为将所有src代码转换到一个js文件中。</em></p><p id="857a" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma">阅读更多关于</em><a class="ae mz" href="https://gist.github.com/mr-vaibh/4d59310e5179689f2c4b206d3f19d7fa" rel="noopener ugc nofollow" target="_blank"><em class="ma">webpack</em></a><em class="ma">和</em> <a class="ae mz" href="https://gist.github.com/mr-vaibh/4aee23f15bca778ed479c668eead3926" rel="noopener ugc nofollow" target="_blank"> <em class="ma">巴别塔</em> </a></p><p id="d92a" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在djreact (main)中编辑<code class="fe mh mi mj mk b"><strong class="kz io">urls.py</strong></code></p><p id="a867" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">最后，所有的URL(来自其他应用程序)都包含在这个主URL中<br/>注意，我们还为rest_framework使用了“auth ”,从这里我们可以授权用户使用我们的webapi。</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="e6b4" class="mu ka in mk b gy mv mw l mx my">from django.contrib import admin<br/>from django.urls import path, include</span><span id="46ea" class="mu ka in mk b gy na mw l mx my"># Static files<br/>from . import settings<br/>from django.conf.urls.static import static<br/># DRF Simple JWT library<br/>from rest_framework_simplejwt.views import TokenObtainPairView, TokenRefreshView, TokenVerifyView</span><span id="5b85" class="mu ka in mk b gy na mw l mx my">from . import views</span><span id="f4f3" class="mu ka in mk b gy na mw l mx my">urlpatterns = [<br/>    path('admin/', admin.site.urls),<br/>    path('', views.index),<br/>    <br/>    # For REST login<br/>    path('auth/', include('rest_framework.urls'), name='rest_login'),<br/>    # For accessing Token to authenticate<br/>    path('get-auth-token/', TokenObtainPairView.as_view(), name='get_auth_token'),<br/>    path('refresh-auth-token/', TokenRefreshView.as_view(), name='refresh_auth_token'),<br/>    path('verify-auth-token/', TokenVerifyView.as_view(), name='verify_auth_token'),<br/>    <br/>    # API for other apps<br/>    path('webapi/accounts/', include('accounts.urls'), name='webapi_accounts'),</span><span id="76e3" class="mu ka in mk b gy na mw l mx my">] + static(settings.STATIC_URL, document_root=settings.STATIC_ROOT)</span></pre><h2 id="d6a0" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">输出</h2><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/fde8a417eadbaf47cc1894784110d711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a6gbk-lqPhO6tJn982WJOg.png"/></div></div></figure><h1 id="0854" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">部署</h1><p id="c64a" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">只需运行<code class="fe mh mi mj mk b">npm build</code>，它就会将一个优化的React应用程序捆绑到构建文件夹中。</p><p id="12e7" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">现在你只需要运行<code class="fe mh mi mj mk b">python manage.py runserver</code>来运行整个应用程序。</p><blockquote class="mb mc md"><p id="14c7" class="kx ky ma kz b la lv lc ld le lw lg lh me lx lk ll mf ly lo lp mg lz ls lt lu ig bi translated">现在从技术上讲，你只是在使用一个Django应用程序。但是谁知道你在React JS里面创造了你的全前端。😎</p></blockquote><p id="d705" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">要完全部署到服务器(这在Heroku中是最容易的)，请查看<a class="ae mz" href="https://devcenter.heroku.com/categories/working-with-django" rel="noopener ugc nofollow" target="_blank"> Heroku Django应用程序部署</a>。</p><p id="b023" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">但是我建议不要仅仅依赖Heroku，试着学习它背后的概念，不要只是复制粘贴命令。</p><p id="4a19" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma">更多内容请看</em><a class="ae mz" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kz io"><em class="ma">plain English . io</em></strong></a><em class="ma">。报名参加我们的</em> <a class="ae mz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz io"> <em class="ma">免费周报</em> </strong> </a> <em class="ma">。关注我们</em><a class="ae mz" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kz io"><em class="ma">Twitter</em></strong></a><em class="ma">和</em><a class="ae mz" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kz io"><em class="ma">LinkedIn</em></strong></a><em class="ma">。加入我们的</em> <a class="ae mz" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kz io"> <em class="ma">社区不和谐</em> </strong> </a> <em class="ma">。</em></p><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/e73b7c4c4fc936abf3f73691200105f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jS75tVmzU2axwA_q.jpg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">source: codingforentrepreneurs</figcaption></figure><h1 id="4a8e" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">介绍</h1><p id="7018" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated"><strong class="kz io"> React </strong>和<strong class="kz io"> Django </strong>是目前最流行的两个框架(当我这么说的时候，我的意思是说),在很多热门网站(包括Medium本身)的制作中大量使用。</p><p id="05c7" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">现在，如果您已经来到这里，那么这意味着您知道这些框架是如何简单地工作的。如果没有，请立即停止阅读。</p><p id="1c0b" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">让我们开始吧，有很多方法可以集成React和Django。虽然当然没有“<em class="ma">官方“</em>方式来做这件事。这是我的方法，我个人认为可以算作最佳实践之一。</p><blockquote class="mb mc md"><p id="1061" class="kx ky ma kz b la lv lc ld le lw lg lh me lx lk ll mf ly lo lp mg lz ls lt lu ig bi translated">在本例中，我们将分别处理reactor和Django，最后，为了制作，我们可以运行<code class="fe mh mi mj mk b"><em class="in">npm run build</em></code>(以便将整个reactor应用程序捆绑到一个文件夹中)，然后可以将它提供给Django进行渲染。</p></blockquote><p id="bdf9" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">听起来像是个计划？😇</p><p id="9a8b" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">好的，没有设置，创建一个新的文件夹“DJREACT”。<br/> <em class="ma">(假设您已经安装了Python和Node.js】</em></p><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/03578232255471a04aa0fbd662728cd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*YinnQHh6aJodlpEyJKffPg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Directory structure</figcaption></figure><h1 id="5d75" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">反应前端设置</h1><p id="024d" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">创建一个新文件夹<code class="fe mh mi mj mk b">frontend</code>，并运行<code class="fe mh mi mj mk b">npx create-react-app frontend</code>(您可以稍后在<em class="ma"> package.json </em>文件中编辑该名称)</p><p id="1b3a" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">我们还需要Axios与我们稍后将在后端创建的API一起工作</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="154c" class="mu ka in mk b gy mv mw l mx my">npm install axios</span></pre><p id="1bf1" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">打开<strong class="kz io">包，json </strong>并添加</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="cf24" class="mu ka in mk b gy mv mw l mx my">{<br/>  "name": "djreact",<br/>  ...<br/>  "proxy": "http://localhost:8000",<br/>  "homepage": "/dist",<br/>  ...<br/>}</span></pre><p id="0976" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma"> &gt;第1行*</em><strong class="kz io">名称</strong>:项目更名(没什么区别)</p><p id="0a43" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma"> &gt;第2行*</em><strong class="kz io">代理</strong>:这将有助于在<strong class="kz io">隧道API请求</strong>到<a class="ae mz" href="http://localhost:8000/" rel="noopener ugc nofollow" target="_blank">的http://localhost:8000 </a>中，Django应用程序将处理它们，所以我们可以在React:</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="eb1d" class="mu ka in mk b gy mv mw l mx my">axios.get("/webapi/accounts/")</span></pre><p id="6fff" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">而不是这样:</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="568b" class="mu ka in mk b gy mv mw l mx my">axios.get("http://localhost:8000/webapi/accounts/")</span></pre><p id="65dd" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma"> &gt;第3行;</em> <strong class="kz io">首页</strong>:使<em class="ma"> build </em>文件夹中捆绑的所有静态文件都能匹配姜戈的URLPATTERN(必须与姜戈的<code class="fe mh mi mj mk b">settings.py</code>的STATIC_URL变量相同)</p><p id="b062" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma">现在使用`</em><a class="ae mz" href="https://www.npmjs.com/package/axios" rel="noopener ugc nofollow" target="_blank"><em class="ma">Axios</em></a>(NPM包)通过API端点与Django后端通信</p><p id="e932" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">下面是一个关于如何使用xios的片段:</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="41fa" class="mu ka in mk b gy mv mw l mx my">handleSubmit = item =&gt; {<br/>    this.toggle();<br/>    if (item.id) {<br/>    axios<br/>        .put(`http://localhost:8000/webapi/accounts/${item.id}/`, item)<br/>        .then(res =&gt; this.refreshList());<br/>    return;<br/>    }<br/>    axios<br/>      .post("http://localhost:8000/webapi/accounts/", item)<br/>      .then(res =&gt; this.refreshList());<br/>};</span><span id="68c5" class="mu ka in mk b gy na mw l mx my">handleDelete = item =&gt; {<br/>    axios<br/>        .delete(`http://localhost:8000/webapi/accounts/${item.id}`)<br/>        .then(res =&gt; this.refreshList());<br/>};</span></pre><p id="c19d" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">运行<code class="fe mh mi mj mk b">npm start</code>来运行应用程序，它应该会工作。</p><h2 id="f92b" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">修复姜戈的CSRF令牌验证冲突</h2><p id="8052" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">姜戈提供的<strong class="kz io">内置CSRF保护</strong>对<strong class="kz io">保护您的服务器免受恶意网站</strong>的攻击非常有用，恶意网站可以利用您的浏览器攻击您。然而，当使用现代的JavaScript库时，您将需要以不同的方式处理CSRF。</p><p id="06aa" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在前端编辑<code class="fe mh mi mj mk b"><strong class="kz io">src/App.js</strong></code></p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="b732" class="mu ka in mk b gy mv mw l mx my">import axios from 'axios';</span><span id="0c09" class="mu ka in mk b gy na mw l mx my">axios.defaults.xsrfCookieName = 'csrftoken'<br/>axios.defaults.xsrfHeaderName = 'X-CSRFToken'</span></pre><p id="6479" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma">我知道，我把Axios的大部分留给你，因为这很容易做到。</em> <a class="ae mz" href="https://www.youtube.com/watch?v=6LyagkoRWYA" rel="noopener ugc nofollow" target="_blank"> <em class="ma">链接到教程</em> </a></p><h2 id="b45e" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">输出</h2><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/8f2e7375b2bb911cf038dbd0232c74ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LpEvGkScywgpQRReXUeIgg.png"/></div></div></figure></div><div class="ab cl nn no hr np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ig ih ii ij ik"><h1 id="7643" class="jz ka in bd kb kc nu ke kf kg nv ki kj kk nw km kn ko nx kq kr ks ny ku kv kw bi translated">Django后端设置</h1><blockquote class="mb mc md"><p id="6cc9" class="kx ky ma kz b la lv lc ld le lw lg lh me lx lk ll mf ly lo lp mg lz ls lt lu ig bi translated">Django的唯一目的是创建一个API，React可以使用它与数据库进行通信。</p></blockquote><h2 id="f340" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">为Python创建虚拟环境(可选)</h2><p id="0abf" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">在“DJREACT”中打开命令行外壳并运行<code class="fe mh mi mj mk b">$ pip install pipenv</code></p><p id="4206" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><code class="fe mh mi mj mk b">$ pipenv shell</code>(这将创建一个虚拟环境)</p><p id="c9f5" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">这一步是可选的，尽管建议使用虚拟Env，因为将来您可能会将代码推到某个地方。</p><h2 id="ad8c" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">Django实际安装</h2><p id="c6bf" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">我推荐你首先阅读<a class="ae mz" href="https://www.django-rest-framework.org/tutorial/1-serialization/" rel="noopener ugc nofollow" target="_blank"> Django Rest框架文档</a></p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="294c" class="mu ka in mk b gy mv mw l mx my">$ pipenv install django djangorestframework djangorestframework-simplejwt django-cors-headers<br/>$ django-admin startproject djreact .<br/>$ python manage.py startapp accounts</span><span id="1b76" class="mu ka in mk b gy na mw l mx my">$ python manage.py migrate<br/>$ python manage.py createsuperuser --username admin<br/>  Email: ......<br/>  Password: ........</span></pre><p id="aaeb" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在djreact (main)中编辑<code class="fe mh mi mj mk b"><strong class="kz io">settings.py</strong></code> <strong class="kz io"> </strong></p><p id="49d0" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">这些设置看起来很重要。尤其是DRF认证，它为整个应用程序配置API权限，但您也可以为每个视图手动设置。</p><p id="76c5" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">但是请记住，这些是<strong class="kz io">而不是</strong>生产设置，在某些情况下，您必须更改一些变量。</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="bf2c" class="mu ka in mk b gy mv mw l mx my">ALLOWED_HOSTS = ['localhost', 'localhost:3000']</span><span id="0790" class="mu ka in mk b gy na mw l mx my">CORS_ORIGIN_WHITELIST = [<br/>    'http://localhost:3000',<br/>]</span><span id="9b6f" class="mu ka in mk b gy na mw l mx my">INSTALLED_APPS = [<br/>    ...<br/>    # Third party apps<br/>    'rest_framework',<br/>    'corsheaders',<br/>    <br/>    # My apps<br/>    'accounts.apps.AccountsConfig',<br/>]</span><span id="5eb1" class="mu ka in mk b gy na mw l mx my"># <a class="ae mz" href="https://www.django-rest-framework.org/api-guide/authentication/#setting-the-authentication-scheme" rel="noopener ugc nofollow" target="_blank">DRF Authentication Scheme</a> &lt;- you can click here :)</span><span id="352c" class="mu ka in mk b gy na mw l mx my"># set permission according to your requirements<br/>REST_FRAMEWORK = {<br/>    'DEFAULT_AUTHENTICATION_CLASSES’: [<br/>        'rest_framework_simplejwt.authentication.JWTAuthentication’,<br/>    ],<br/>    'DEFAULT_PERMISSION_CLASSES’: [<br/>        'rest_framework.permissions.DjangoModelPermissions’,<br/>        'rest_framework.permissions.IsAdminUser'<br/>    ]<br/>}</span><span id="668f" class="mu ka in mk b gy na mw l mx my">MIDDLEWARE = [<br/>    ...,<br/>    'corsheaders.middleware.CorsMiddleware',<br/>    ...,<br/>]</span><span id="828d" class="mu ka in mk b gy na mw l mx my">TEMPLATES = [<br/>    {<br/>        'BACKEND': 'django.template.backends.django.DjangoTemplates',<br/>        'DIRS': [ BASE_DIR / 'frontend' ],<br/>        ...<br/>        },<br/>    },<br/>]</span><span id="4b3c" class="mu ka in mk b gy na mw l mx my">...</span><span id="cb9e" class="mu ka in mk b gy na mw l mx my">STATIC_URL = '/dist/'</span><span id="08e5" class="mu ka in mk b gy na mw l mx my"># Extra places for collectstatic to find static files.<br/>STATIC_ROOT = BASE_DIR / 'staticfiles'</span><span id="2946" class="mu ka in mk b gy na mw l mx my">STATICFILES_DIRS = [<br/>    BASE_DIR / 'frontend/build',<br/>]</span></pre><p id="7b01" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">现在运行这些命令来确保所有的表都被创建了。</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="1576" class="mu ka in mk b gy mv mw l mx my">$ python manage.py makemigrations<br/>$ python manage.py migrate</span></pre><h2 id="064d" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">英寸/帐户文件夹</h2><p id="c559" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">Django REST框架中的序列化器<strong class="kz io">负责将对象转换成javascript和前端框架能够理解的数据类型</strong>。</p><p id="d1b7" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在账户中创建<code class="fe mh mi mj mk b"><strong class="kz io">serializers.py</strong></code></p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="6a1d" class="mu ka in mk b gy mv mw l mx my">from rest_framework import serializers<br/>from django.contrib.auth.models import User</span><span id="fb4c" class="mu ka in mk b gy na mw l mx my">class UserSerializer(serializers.ModelSerializer):<br/>    class Meta:<br/>        model = User<br/>        fields = '__all__'</span></pre><p id="236a" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">你已经知道什么是视图了，对吗？没有吗？？那你在这里做什么？</p><p id="beca" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在账户中编辑<code class="fe mh mi mj mk b"><strong class="kz io">views.py</strong></code></p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="3ab3" class="mu ka in mk b gy mv mw l mx my">from rest_framework import viewsets</span><span id="8d61" class="mu ka in mk b gy na mw l mx my">from django.contrib.auth.models import User<br/>from .serializers import UserSerializer<br/># To make password encryption<br/>from django.contrib.auth.hashers import make_password</span><span id="15fe" class="mu ka in mk b gy na mw l mx my"># API view for django.contrib.auth.models.User<br/>class UserViewSet(viewsets.ModelViewSet):<br/>    queryset = User.objects.all()<br/>    serializer_class = UserSerializer</span><span id="4371" class="mu ka in mk b gy na mw l mx my">    # it takes recent instance from serialzer and uses `make_password` to encrypt<br/>    <!-- -->def perform_create(self, serializer):<br/>    # Hash password but passwords are not required<br/>    if ('password' in self.request.data):<br/>        password = make_password(self.request.data['password'])<br/>        serializer.save(password=password)<br/>    else:<br/>        serializer.save()</span><span id="58b9" class="mu ka in mk b gy na mw l mx my">def perform_update(self, serializer):<br/>    # Hash password but passwords are not required<br/>    if ('password' in self.request.data):<br/>        password = make_password(self.request.data['password'])<br/>        serializer.save(password=password)<br/>    else:<br/>        serializer.save()</span></pre><p id="283d" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在账户中编辑<code class="fe mh mi mj mk b"><strong class="kz io">urls.py</strong></code></p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="3db8" class="mu ka in mk b gy mv mw l mx my">from django.urls import path, include</span><span id="3067" class="mu ka in mk b gy na mw l mx my">from rest_framework.routers import DefaultRouter</span><span id="02da" class="mu ka in mk b gy na mw l mx my">from . import views</span><span id="23d4" class="mu ka in mk b gy na mw l mx my"># <em class="ma">Registering </em>Rest-API routes for Accounts<br/>router = DefaultRouter()<br/>router.register(r'user', views.UserViewSet, 'user')</span><span id="cac0" class="mu ka in mk b gy na mw l mx my">urlpatterns = [<br/>    path('', include(router.urls), name='accounts_api'),<br/>]</span></pre><h2 id="018e" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">英寸/djreact(主)项目文件夹</h2><p id="f0ab" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">在djreact (main)中创建<code class="fe mh mi mj mk b"><strong class="kz io">views.py</strong></code></p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="4ef4" class="mu ka in mk b gy mv mw l mx my">from django.shortcuts import render</span><span id="7874" class="mu ka in mk b gy na mw l mx my">def index(request):<br/>    return render(request, 'build/index.html')</span></pre><p id="ebb5" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><strong class="kz io"> <em class="ma">注意:</em> </strong> <em class="ma">你可以在开发中把“构建”改为“公共”，为此你需要把</em> <code class="fe mh mi mj mk b"><em class="ma">webpack.config.js</em></code> <em class="ma">和</em> <code class="fe mh mi mj mk b"><em class="ma">.babelrc</em></code> <em class="ma">配置成把所有的src代码转换成一个js文件。</em></p><p id="75da" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma">阅读更多关于</em> <a class="ae mz" href="https://gist.github.com/mr-vaibh/4d59310e5179689f2c4b206d3f19d7fa" rel="noopener ugc nofollow" target="_blank"> <em class="ma"> webpack </em> </a> <em class="ma">和</em> <a class="ae mz" href="https://gist.github.com/mr-vaibh/4aee23f15bca778ed479c668eead3926" rel="noopener ugc nofollow" target="_blank"> <em class="ma">巴别塔</em> </a></p><p id="d857" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在djreact (main)中编辑<code class="fe mh mi mj mk b"><strong class="kz io">urls.py</strong></code></p><p id="456c" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">最后，所有的URL(来自其他应用程序)都包含在这个主URL中<br/>注意，我们还为rest_framework使用了“auth ”,从这里我们可以授权用户使用我们的webapi。</p><pre class="mm mn mo mp gt mq mk mr ms aw mt bi"><span id="f6c4" class="mu ka in mk b gy mv mw l mx my">from django.contrib import admin<br/>from django.urls import path, include</span><span id="0303" class="mu ka in mk b gy na mw l mx my"># Static files<br/>from . import settings<br/>from django.conf.urls.static import static<br/># DRF Simple JWT library<br/>from rest_framework_simplejwt.views import TokenObtainPairView, TokenRefreshView, TokenVerifyView</span><span id="7a48" class="mu ka in mk b gy na mw l mx my">from . import views</span><span id="37f0" class="mu ka in mk b gy na mw l mx my">urlpatterns = [<br/>    path('admin/', admin.site.urls),<br/>    path('', views.index),<br/>    <br/>    # For REST login<br/>    path('auth/', include('rest_framework.urls'), name='rest_login'),<br/>    # For accessing Token to authenticate<br/>    path('get-auth-token/', TokenObtainPairView.as_view(), name='get_auth_token'),<br/>    path('refresh-auth-token/', TokenRefreshView.as_view(), name='refresh_auth_token'),<br/>    path('verify-auth-token/', TokenVerifyView.as_view(), name='verify_auth_token'),<br/>    <br/>    # API for other apps<br/>    path('webapi/accounts/', include('accounts.urls'), name='webapi_accounts'),</span><span id="b3f7" class="mu ka in mk b gy na mw l mx my">] + static(settings.STATIC_URL, document_root=settings.STATIC_ROOT)</span></pre><h2 id="5a22" class="mu ka in bd kb nb nc dn kf nd ne dp kj li nf ng kn lm nh ni kr lq nj nk kv nl bi translated">输出</h2><figure class="mm mn mo mp gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/fde8a417eadbaf47cc1894784110d711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a6gbk-lqPhO6tJn982WJOg.png"/></div></div></figure><h1 id="6476" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">部署</h1><p id="e250" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">只需运行<code class="fe mh mi mj mk b">npm build</code>，它就会将一个优化的React应用程序捆绑到构建文件夹中。</p><p id="6c22" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">现在你只需要运行<code class="fe mh mi mj mk b">python manage.py runserver</code>来运行整个应用程序。</p><blockquote class="mb mc md"><p id="ac0c" class="kx ky ma kz b la lv lc ld le lw lg lh me lx lk ll mf ly lo lp mg lz ls lt lu ig bi translated">现在从技术上讲，你只是在使用一个Django应用程序。但是谁知道你在React JS里面创造了你的全前端。😎</p></blockquote><p id="48c7" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">要完全部署到服务器(这在Heroku中是最容易的)，请查看<a class="ae mz" href="https://devcenter.heroku.com/categories/working-with-django" rel="noopener ugc nofollow" target="_blank"> Heroku Django应用程序部署</a>。</p><p id="2a28" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">但是我建议不要仅仅依赖Heroku，试着学习它背后的概念，不要只是复制粘贴命令。</p><p id="bf00" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated"><em class="ma">更多内容看</em> <a class="ae mz" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz io"> <em class="ma">说白了。报名参加我们的</em> <a class="ae mz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz io"> <em class="ma">免费每周简讯</em> </strong> </a> <em class="ma">。关注我们</em> <a class="ae mz" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kz io"> <em class="ma">推特</em> </strong> </a> <em class="ma">和</em><a class="ae mz" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kz io"><em class="ma">LinkedIn</em></strong></a><em class="ma">。加入我们的</em> <a class="ae mz" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kz io"> <em class="ma">社区不和谐</em> </strong> </a> <em class="ma">。</em></strong></a></p></div></div>    
</body>
</html>