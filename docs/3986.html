<html>
<head>
<title>Create and Dockerize an Express TypeScript application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建一个Express TypeScript应用程序并对其进行分类</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-and-dockerize-an-express-typescript-application-5c9f6d67ec2f?source=collection_archive---------2-----------------------#2021-08-10">https://javascript.plainenglish.io/create-and-dockerize-an-express-typescript-application-5c9f6d67ec2f?source=collection_archive---------2-----------------------#2021-08-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a218" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">快速应用程序的简易归档方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5a4a0d542aa35567a33c3b13a54fa12e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IdDTiX_xlB0NQTkT"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@carrier_lost?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ian Taylor</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="447f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你知道<a class="ae kv" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>，你可能也知道非常流行的web框架<a class="ae kv" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express </a>。这是一个最小的、经过实战检验的web框架。另一方面，<a class="ae kv" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank"> TypeScript </a>是一种基于JavaScript的开源语言。它已经很受欢迎，而且越来越受欢迎。TypeScript增加的价值是类型定义。由于类型检查可以确保您的程序正确运行，并且所有有效的JavaScript代码也是类型脚本代码，因此许多开发人员认为类型脚本是JavaScript的更好替代方案。因此，结合这两种技术——Express和TypeScript，您可以轻松地构建一个可靠的应用程序。用它添加Docker将使您在部署时的生活变得轻松。</p><h2 id="c045" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">目录</h2><ul class=""><li id="dc0b" class="ml mm iq ky b kz mn lc mo lf mp lj mq ln mr lr ms mt mu mv bi translated">创建一个Express和TypeScript应用程序</li><li id="1f47" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">设置tsconfig.json文件</li><li id="7522" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">添加必要的脚本</li><li id="141e" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">将Docker添加到您的应用程序</li><li id="fe77" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">用Docker运行应用程序</li><li id="0360" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">得到这个例子</li></ul><h1 id="f417" class="nb lt iq bd lu nc nd ne lx nf ng nh ma jw ni jx md jz nj ka mg kc nk kd mj nl bi translated">创建一个Express和TypeScript应用程序</h1><p id="1d8d" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">这是一种非常简单的技术。您可以使用与创建JavaScript express应用程序相同的技术。但是您需要添加一些额外的包来设置TypeScript。在您的终端中运行以下命令:</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="8569" class="ls lt iq nq b gy nu nv l nw nx">$ mkdir express-typescript-docker<br/>$ cd express-typescript-docker<br/>~/express-typescript-docker $ npm init --yes<br/>~/express-typescript-docker $ npm i express typescript ts-node nodemon<br/>~/express-typescript-docker $ npm i --save-dev @types/express<br/>~/express-typescript-docker $ tsc --init</span></pre><ul class=""><li id="c982" class="ml mm iq ky b kz la lc ld lf ny lj nz ln oa lr ms mt mu mv bi translated"><strong class="ky ir"> mkdir &lt;文件夹名&gt;T7】将创建一个项目文件夹。</strong></li><li id="fc88" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">使用<strong class="ky ir">光盘&lt;文件夹名称&gt;进入</strong>文件夹。</li><li id="0b40" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">NPM<strong class="ky ir">init–yes</strong>将在项目目录中创建一个package.json文件。</li><li id="8b01" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated"><strong class="ky ir"> npm i </strong>将安装必要的包，如<strong class="ky ir"> express </strong>、<strong class="ky ir"> typescript </strong>、<strong class="ky ir"> ts-node </strong>、<strong class="ky ir"> nodemon </strong>和—<strong class="ky ir">-save-dev</strong>标志，用于在<strong class="ky ir"> package.json </strong>的<strong class="ky ir"> devDependencies </strong>部分添加依赖项。</li><li id="01a4" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">TSC–init将在您的项目目录中创建一个tsconfig.json文件。该文件表示typescript的编译器选项，这意味着该文件告诉typescript如何使用编译器。</li></ul><h1 id="b444" class="nb lt iq bd lu nc nd ne lx nf ng nh ma jw ni jx md jz nj ka mg kc nk kd mj nl bi translated">设置tsconfig.json文件</h1><p id="134f" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">您可以保留tsconfig.json 的大部分属性，但是我们可能需要修改它的一些属性。我要改变的是，</p><p id="ac9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在compilerOptions属性中，</p><ul class=""><li id="4c2d" class="ml mm iq ky b kz la lc ld lf ny lj nz ln oa lr ms mt mu mv bi translated">将<strong class="ky ir">目标</strong>属性值更改为<strong class="ky ir">“es 2015”</strong>以指定ECMAScript版本。</li><li id="2d89" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">将<strong class="ky ir"> outDir </strong>值设置为<strong class="ky ir">“构建”</strong>。这是typescript编译器的输出目录。</li><li id="d763" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">将<strong class="ky ir"> moduleResolution </strong>设置为<strong class="ky ir">【节点】</strong>。</li></ul><p id="c60f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并添加一个属性<strong class="ky ir">,将</strong>排除在<strong class="ky ir">compile options</strong>属性的同级和外部</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="9de8" class="ls lt iq nq b gy nu nv l nw nx">"compilerOptions": {...}<br/>"exclude": [<br/>    "node_modules"<br/>]</span></pre><p id="274f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了一个项目目录，并设置了必要的环境。让我们创建一个<strong class="ky ir"> index.ts </strong>文件来编写我们的代码并创建一个服务器。</p><p id="d25c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">~/express-typescript-docker $ touch index . ts</p><p id="5bb5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用你最喜欢的代码编辑器打开它。我更喜欢vs代码。它是轻量级的，有很多有用的插件。在index.ts中，让我们编写一些代码。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="a5ba" class="ls lt iq nq b gy nu nv l nw nx">import<!-- --> <!-- -->express from 'express';</span><span id="994d" class="ls lt iq nq b gy ob nv l nw nx">const app = express();</span><span id="e386" class="ls lt iq nq b gy ob nv l nw nx">const PORT = 3000;</span><span id="2764" class="ls lt iq nq b gy ob nv l nw nx">app.get('/', (req, res) =&gt; {</span><span id="32f0" class="ls lt iq nq b gy ob nv l nw nx">res.send('Hello World!');</span><span id="32aa" class="ls lt iq nq b gy ob nv l nw nx">});</span><span id="2d5b" class="ls lt iq nq b gy ob nv l nw nx">app.listen(PORT, () =&gt; {</span><span id="d584" class="ls lt iq nq b gy ob nv l nw nx">console.log(`Express server is listening at ${PORT}`);</span><span id="1280" class="ls lt iq nq b gy ob nv l nw nx">});</span></pre><p id="49b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在index.ts文件中，我们创建了一个只有一个GET路由的基本express服务器。我希望你理解这一部分。</p><h1 id="3e45" class="nb lt iq bd lu nc nd ne lx nf ng nh ma jw ni jx md jz nj ka mg kc nk kd mj nl bi translated">添加必要的脚本</h1><p id="3988" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">现在要运行这个<strong class="ky ir"> index.ts </strong>文件，让我们在<strong class="ky ir"> package.json </strong>文件中添加一个脚本。如果您查看这个包，您可以看到一个名为<strong class="ky ir"> scripts </strong>的属性部分。在这个部分中，您可以添加任意数量的必要脚本，并且可以使用<strong class="ky ir">NPM run&lt;script _ name&gt;</strong>来运行它们。让我们添加一个脚本<strong class="ky ir"> start:dev </strong>。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="a0bb" class="ls lt iq nq b gy nu nv l nw nx">"start:dev": "nodemon index.ts"</span></pre><p id="ba58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在运行下面的命令来启动您的服务器。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="3337" class="ls lt iq nq b gy nu nv l nw nx">~/express-typescript-docker $ npm run start:dev</span></pre><p id="00a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它会在你的控制台上显示结果。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="1b1a" class="ls lt iq nq b gy nu nv l nw nx">&gt; express-typescript-docker@1.0.0 start:dev /home/sbr/express-typescript-docker<br/>&gt; nodemon index.ts</span><span id="78a6" class="ls lt iq nq b gy ob nv l nw nx">[nodemon] 2.0.12<br/>[nodemon] to restart at any time, enter `rs`<br/>[nodemon] watching path(s): *.*<br/>[nodemon] watching extensions: ts,json<br/>[nodemon] starting `ts-node index.ts`<br/>Express server is listening at 3000</span></pre><p id="ee6d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你的服务器现在正在运行，你可以用<strong class="ky ir"> localhost:3000 </strong>连接它。打开浏览器，点击地址，你可以看到服务器发送的信息。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="1699" class="ls lt iq nq b gy nu nv l nw nx">Hello World!</span></pre><p id="f66a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以添加另一个脚本来编译您的typescript代码。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="6aab" class="ls lt iq nq b gy nu nv l nw nx">"build": "tsc"</span></pre><p id="8458" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您运行这个脚本，您的项目将被编译，并且在您的项目目录中将创建一个新的目录构建。因此，您可以查看构建目录来查看编译后的代码。但这不是必须的。</p><h1 id="a586" class="nb lt iq bd lu nc nd ne lx nf ng nh ma jw ni jx md jz nj ka mg kc nk kd mj nl bi translated">将Docker添加到您的应用程序</h1><p id="881c" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">现在我们有了一个用express和typescript构建的可运行的应用程序。所以现在我们可以专注于将Docker添加到我们的应用程序中，因为它将帮助我们部署应用程序。这相当容易。在您的根目录中创建一个docker文件，并将以下配置。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="abf2" class="ls lt iq nq b gy nu nv l nw nx">FROM node:latest</span><span id="b67e" class="ls lt iq nq b gy ob nv l nw nx">WORKDIR /srv/app</span><span id="e520" class="ls lt iq nq b gy ob nv l nw nx">COPY package*.json ./</span><span id="34e7" class="ls lt iq nq b gy ob nv l nw nx">RUN npm install</span><span id="118f" class="ls lt iq nq b gy ob nv l nw nx">COPY . .</span><span id="54df" class="ls lt iq nq b gy ob nv l nw nx">RUN npm run build</span><span id="091d" class="ls lt iq nq b gy ob nv l nw nx">EXPOSE 3000</span><span id="289d" class="ls lt iq nq b gy ob nv l nw nx">CMD ["node", "build/index.js"]</span></pre><p id="52c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用以下命令在Docker文件所在的目录下创建一个. dockerignore文件，这样可以防止本地模块和日志被复制到Docker映像上。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="ce7c" class="ls lt iq nq b gy nu nv l nw nx">node_modules<br/>npm-debug.log</span></pre><h1 id="b224" class="nb lt iq bd lu nc nd ne lx nf ng nh ma jw ni jx md jz nj ka mg kc nk kd mj nl bi translated">用docker运行应用程序</h1><p id="dbf1" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">现在运行下面的命令来构建docker映像。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="a1f9" class="ls lt iq nq b gy nu nv l nw nx">docker build . -t express-typescript-docker</span></pre><p id="0789" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个命令将准备一个最新的docker图像标签，因为我们没有指定任何标签。如果需要，您可以指定标签。</p><p id="4565" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行以下命令来运行docker容器。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="8cea" class="ls lt iq nq b gy nu nv l nw nx">docker run -p 3000:3000 -d express-typescript-docker:latest</span></pre><p id="8eaf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用-d运行容器将在分离模式下运行容器。它将在后台运行容器。标志-p将公共端口重定向到容器内部的私有端口。</p><p id="0146" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">打印应用程序的输出</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="2cf7" class="ls lt iq nq b gy nu nv l nw nx"># Get container Id<br/>docker ps</span><span id="5fc1" class="ls lt iq nq b gy ob nv l nw nx">#Print application output<br/>docker logs &lt;container id&gt;</span><span id="9b32" class="ls lt iq nq b gy ob nv l nw nx"># If you need to go inside the container<br/>docker exec -it &lt;container id&gt; /bin/bash</span></pre><p id="49d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望你已经理解了程序和概念。如果你觉得这篇文章有帮助，请分享给你的朋友。您可能也喜欢这篇关于使用<a class="ae kv" href="https://www.npmjs.com/package/bull" rel="noopener ugc nofollow" target="_blank"> bull </a>实现基于队列的作业管理器的文章。</p></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><p id="7863" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇文章可能对你有帮助。等待你们的消息。</p><p id="333b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="oj">更多内容尽在</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oj">plain English . io</em></strong></a></p></div></div>    
</body>
</html>