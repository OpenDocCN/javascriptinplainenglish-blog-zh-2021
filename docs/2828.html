<html>
<head>
<title>How to Make REST API with Node.js, Express, and MongoDB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Node.js，Express，MongoDB制作REST API</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-make-rest-api-with-node-js-express-and-mongodb-dfce5e70e830?source=collection_archive---------6-----------------------#2021-06-09">https://javascript.plainenglish.io/how-to-make-rest-api-with-node-js-express-and-mongodb-dfce5e70e830?source=collection_archive---------6-----------------------#2021-06-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><h1 id="ea59" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">第一部分。服务器连接设置</h1><p id="dfd2" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">在这篇文章中，您将了解什么是REST API，并学习如何使用MongoDB Atlas在Node.js中为API设置连接。</p></div><div class="ab cl lg lh hr li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ig ih ii ij ik"><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/dc10744fee934062798e2a529ee7a32e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_woXdoGspsNHgWXX4syipA.jpeg"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk">By: umang</figcaption></figure></div><div class="ab cl lg lh hr li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ig ih ii ij ik"><h2 id="7e36" class="md jl in bd jm me mf dn jq mg mh dp ju kt mi mj jy kx mk ml kc lb mm mn kg mo bi translated">首先，什么是Restful API？</h2><p id="88c7" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">REST(<strong class="kk io">RE</strong>presentational<strong class="kk io">S</strong>tate<strong class="kk io">T</strong>transfer)是一种架构风格或模式，它定义了开发web应用程序的约束集。Restful APIs是一种以更简单的方式访问数据或服务的方式。</p><p id="8096" class="pw-post-body-paragraph ki kj in kk b kl mp kn ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf ig bi translated">当向端点发出请求时，它将资源状态的表示传输到端点，并以下列格式之一返回响应:<strong class="kk io"> <em class="mu"> JSON(最常用)</em>、HTML、PHP、Xlt或简单文本。</strong></p><h2 id="95c9" class="md jl in bd jm me mf dn jq mg mh dp ju kt mi mj jy kx mk ml kc lb mm mn kg mo bi translated"><strong class="ak">什么使得API是Restful的？</strong></h2><ul class=""><li id="3e6c" class="mv mw in kk b kl km kp kq kt mx kx my lb mz lf na nb nc nd bi translated">它不应该在服务器上存储客户端的信息。</li><li id="7e0c" class="mv mw in kk b kl ne kp nf kt ng kx nh lb ni lf na nb nc nd bi translated">通过http管理请求的客户机-服务器体系结构。</li></ul><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nj"><img src="../Images/7461e5a716c55b0166e8a82a50e108e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fJsb3XlbfW_4wLRJ.png"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk"><a class="ae nk" href="https://www.altexsoft.com/blog/rest-api-design/" rel="noopener ugc nofollow" target="_blank">https://www.altexsoft.com/blog/rest-api-design/</a></figcaption></figure></div><div class="ab cl lg lh hr li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ig ih ii ij ik"><h1 id="0984" class="jk jl in bd jm jn nl jp jq jr nm jt ju jv nn jx jy jz no kb kc kd np kf kg kh bi translated"><strong class="ak">启动前的要求</strong></h1><ul class=""><li id="b770" class="mv mw in kk b kl km kp kq kt mx kx my lb mz lf na nb nc nd bi translated">您首选的<a class="ae nk" href="https://www.codecademy.com/articles/what-is-an-ide" rel="noopener ugc nofollow" target="_blank"> <strong class="kk io"> IDE </strong> </a> (VSCode、Atom等)</li><li id="5a89" class="mv mw in kk b kl ne kp nf kt ng kx nh lb ni lf na nb nc nd bi translated">Node.js已安装(通过在终端中键入<strong class="kk io"> <em class="mu"> node -v </em> </strong>进行检查)</li><li id="5243" class="mv mw in kk b kl ne kp nf kt ng kx nh lb ni lf na nb nc nd bi translated">PC上的MongoDB或者<a class="ae nk" href="https://www.mongodb.com/cloud/atlas" rel="noopener ugc nofollow" target="_blank"> MongoDB Atlas </a>(设置你的账号，做一个集群)，后者优先。</li><li id="7598" class="mv mw in kk b kl ne kp nf kt ng kx nh lb ni lf na nb nc nd bi translated">API测试工具，如<a class="ae nk" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank"> Postman </a>或<a class="ae nk" href="https://rapidapi.com/blog/best-api-testing-tools/" rel="noopener ugc nofollow" target="_blank">这些替代品</a>中的任何一个。</li></ul><p id="011a" class="pw-post-body-paragraph ki kj in kk b kl mp kn ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf ig bi translated">首先，我们将初始化Node.js项目。要进行初始化，请为项目创建一个新文件夹，并在VSCode中打开该文件夹，然后在终端中键入以下命令:</p><pre class="lo lp lq lr gt nq nr ns nt aw nu bi"><span id="19fe" class="md jl in nr b gy nv nw l nx ny">npm init (and follow the process)<br/>or<br/>npm init --yes (put this flag to make project with default setting)</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nz"><img src="../Images/b9cd968364af5aec11caf41b27eb0942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rcU2xmtel1HUr1330VaGRw.png"/></div></div></figure><p id="000f" class="pw-post-body-paragraph ki kj in kk b kl mp kn ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf ig bi translated">现在您将能够在文件夹中看到<strong class="kk io"> package.json </strong>文件。转到该文件并更改几行代码:</p><pre class="lo lp lq lr gt nq nr ns nt aw nu bi"><span id="d7b3" class="md jl in nr b gy nv nw l nx ny">1. "main": "server.js",</span><span id="4252" class="md jl in nr b gy oa nw l nx ny">2. "scripts": { "start": "nodemon server.js" }</span></pre><p id="4d53" class="pw-post-body-paragraph ki kj in kk b kl mp kn ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf ig bi translated">现在转到终端，通过编写以下代码安装一些依赖项:</p><pre class="lo lp lq lr gt nq nr ns nt aw nu bi"><span id="cbaf" class="md jl in nr b gy nv nw l nx ny">npm install express nodemon cors body-parser mongoose dotenv</span></pre><p id="59c0" class="pw-post-body-paragraph ki kj in kk b kl mp kn ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf ig bi translated">所有的依赖项都是必要的，我会在我们前进的时候告诉他们的用法。<strong class="kk io"> <em class="mu"> nodemon </em> </strong>会在代码更改后自动重启你的服务器。</p></div><div class="ab cl lg lh hr li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ig ih ii ij ik"><ol class=""><li id="d407" class="mv mw in kk b kl mp kp mq kt ob kx oc lb od lf oe nb nc nd bi translated">制造。我们将从这里获取我们的密钥、密码和端口号，这样其他人就不能访问它(不要在GitHub上推送这个文件)。在。环境文件:</li></ol><pre class="lo lp lq lr gt nq nr ns nt aw nu bi"><span id="b9ff" class="md jl in nr b gy nv nw l nx ny">PORT = 5000</span></pre><p id="4b15" class="pw-post-body-paragraph ki kj in kk b kl mp kn ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf ig bi translated">2.现在，在同一个目录下创建一个<strong class="kk io"> server.js </strong>文件，并编写下面的代码来创建我们的服务器:</p><pre class="lo lp lq lr gt nq nr ns nt aw nu bi"><span id="7dc1" class="md jl in nr b gy nv nw l nx ny">const http = require('http')<br/>const app = require('./app')<br/>const port = process.env.PORT || 3000<br/>const server = http.createServer(app)<br/>server.listen(port)</span></pre><p id="aa9b" class="pw-post-body-paragraph ki kj in kk b kl mp kn ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf ig bi translated">3.使<strong class="kk io"> app.js </strong>在同一个目录下。在这里，我们将定义API的基本路径，并连接到我们的MongoDB数据库。您可以将该文件视为API文件的主要入口。现在开始编写该文件中的代码:</p><pre class="lo lp lq lr gt nq nr ns nt aw nu bi"><span id="439f" class="md jl in nr b gy nv nw l nx ny">const express = require('express')<br/>const app = express()<br/>const cors = require('cors')<br/>const bodyParser = require('body-parser')  <br/>const mongoose = require('mongoose')<br/>require('dotenv/config')</span></pre><blockquote class="of og oh"><p id="8b39" class="ki kj mu kk b kl mp kn ko kp mq kr ks oi mr kv kw oj ms kz la ok mt ld le lf ig bi translated">注意:<strong class="kk io"> Body-parser </strong>是一个<em class="in">中间件</em>用于解析即将到来的请求<strong class="kk io">的主体，dotenv </strong>用于获取env变量，<strong class="kk io"> cors </strong>也是一个用于启用cors的中间件，<strong class="kk io"> mongoose </strong>是mongodb和nodejs的对象数据建模库。它管理数据之间的关系，提供模式验证，并用于在代码中的对象和MongoDB中这些对象的表示之间进行转换… <a class="ae nk" href="https://www.freecodecamp.org/news/introduction-to-mongoose-for-mongodb-d2a7aa593c57/" rel="noopener ugc nofollow" target="_blank">🔗</a></p></blockquote><p id="81b5" class="pw-post-body-paragraph ki kj in kk b kl mp kn ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf ig bi translated">现在，要连接MongoDB，请转到您的MongoDB Atlas集群，获取数据库连接代码并将其粘贴到<strong class="kk io"> dotenv </strong>文件中，如下所示:</p><pre class="lo lp lq lr gt nq nr ns nt aw nu bi"><span id="4ac3" class="md jl in nr b gy nv nw l nx ny">DB_CONNECTION = mongodb+srv://<strong class="nr io">Yourname</strong>:<a class="ae nk" href="mailto:1234@cluster0.pi2rv.mongodb.net" rel="noopener ugc nofollow" target="_blank"><strong class="nr io">password</strong>@cluster0.pi2rv.mongodb.net</a>/<strong class="nr io">dbname</strong>?retryWrites=true&amp;w=majority</span><span id="bc8a" class="md jl in nr b gy oa nw l nx ny">Note: Replace all the bold word respectively:<br/>your username (<strong class="nr io">umang</strong>)<br/>password (<strong class="nr io">1234</strong>)<br/>Database name (<strong class="nr io">Shop</strong>)</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ol"><img src="../Images/624ee008417ee8772cb8941d3cfcfdd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5H1ZLe22bhjRthXBAnP0ew.jpeg"/></div></div></figure><p id="5bae" class="pw-post-body-paragraph ki kj in kk b kl mp kn ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf ig bi translated">现在，转到app.js，编写与数据库连接的代码，并完成连接设置。</p><pre class="lo lp lq lr gt nq nr ns nt aw nu bi"><span id="7e2f" class="md jl in nr b gy nv nw l nx ny">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: false }));</span><span id="d37e" class="md jl in nr b gy oa nw l nx ny"># Defining all the http header and the request options<br/>app.use((req, res, next) =&gt; {<br/>res.header('Access-Control-Allow-Origin', '*');<br/>res.header('Access-Control-Allow-Headers', 'Origin, X-Requested-With, Content-Type, Accept, Authorization');<br/>if (req.method === 'OPTIONS') {<br/>     res.header('Access-Control-Allow-Methods', 'PUT, POST, GET,   PATCH, DELETE')<br/>return res.status(200).json({})<br/>}<br/>next();<br/>});</span><span id="7323" class="md jl in nr b gy oa nw l nx ny">mongoose.connect(<br/>          process.env.DB_CONNECTION, <br/>         {useNewUrlParser: true, useUnifiedTopology: true },<br/>         () =&gt; {<br/>             console.log('connected to database')<br/>         })<br/>mongoose.Promise = global.Promise</span><span id="55e9" class="md jl in nr b gy oa nw l nx ny">app.use((req, res, next) =&gt; {<br/>   res.status(200).json({message: "It works"});<br/>})</span></pre><p id="daaf" class="pw-post-body-paragraph ki kj in kk b kl mp kn ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf ig bi translated">现在我们的设置已经完成，转到vscode中的终端并键入</p><pre class="lo lp lq lr gt nq nr ns nt aw nu bi"><span id="5054" class="md jl in nr b gy nv nw l nx ny">nodemon server.js <br/>// it will run a server and database connection will be made</span></pre><blockquote class="om"><p id="5609" class="on oo in bd op oq or os ot ou ov lf dk translated">通过进入<a class="ae nk" href="http://localhost:5000" rel="noopener ugc nofollow" target="_blank"> http://localhost:5000 </a>进行测试。它应该会回复“它工作了”。</p></blockquote></div><div class="ab cl lg lh hr li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ig ih ii ij ik"><h2 id="97ee" class="md jl in bd jm me mf dn jq mg mh dp ju kt mi mj jy kx mk ml kc lb mm mn kg mo bi translated">万岁！您已经在Node.js、Express和MongoDB中完成了REST API的基本连接设置。</h2><p id="4336" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">被一个错误卡住了？没问题！留下评论，我一定会努力解决。否则，在25umangagarwal@gmail.com给我发邮件或者在<a class="ae nk" href="https://www.linkedin.com/in/umang-agrawal07/" rel="noopener ugc nofollow" target="_blank"> <em class="mu"> LinkedIn </em> </a>上联系我。</p><h1 id="32b8" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">第二部分。为/get请求创建API端点</h1><div class="ow ox gp gr oy oz"><a href="https://25umangagarwal.medium.com/making-api-endpoints-for-rest-api-in-nodejs-ec688c18aaa" rel="noopener follow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd io gy z fp pe fr fs pf fu fw im bi translated">在NodeJS中为REST-API创建API端点。</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">第2部分—创建API端点来发布或检索数据。</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">25umangagarwal.medium.com</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn lx oz"/></div></div></a></div><p id="378e" class="pw-post-body-paragraph ki kj in kk b kl mp kn ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf ig bi translated"><em class="mu">更多内容请看</em><a class="ae nk" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="mu">plain English . io</em></a></p></div></div>    
</body>
</html>