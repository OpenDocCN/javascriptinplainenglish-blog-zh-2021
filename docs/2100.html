<html>
<head>
<title>How to Copy Text to a Clipboard Programmatically in JavaScript?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在JavaScript中以编程方式将文本复制到剪贴板？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-copy-text-to-a-clipboard-programmatically-in-javascript-2ea3a23e0255?source=collection_archive---------13-----------------------#2021-05-03">https://javascript.plainenglish.io/how-to-copy-text-to-a-clipboard-programmatically-in-javascript-2ea3a23e0255?source=collection_archive---------13-----------------------#2021-05-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e7e3e9e4e61b4fb9f8b6275a4e076ae2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VwOd120JXEA_7AtT"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@ocollet?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Olivier Collet</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="161b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以编程方式将文本复制到系统剪贴板是我们有时不得不做的事情。</p><p id="c481" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在web应用程序中用普通的JavaScript代码做到这一点。</p><p id="68a4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何以编程方式用JavaScript将文本复制到剪贴板。</p><h1 id="425f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">老办法</h1><p id="052d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">老办法是创建一个文本区域，把我们要复制的文本放进去，然后调用<code class="fe me mf mg mh b">document.execCommand</code>运行<code class="fe me mf mg mh b">copy</code>命令把文本复制到剪贴板。</p><p id="7acc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1273" class="mq lc iq mh b gy mr ms l mt mu">const text = 'hello world'<br/>const textArea = document.createElement("textarea");<br/>textArea.value = text;<br/>textArea.style.top = "0";<br/>textArea.style.left = "0";<br/>textArea.style.position = "fixed";</span><span id="4339" class="mq lc iq mh b gy mv ms l mt mu">document.body.appendChild(textArea);<br/>textArea.focus();<br/>textArea.select();</span><span id="a680" class="mq lc iq mh b gy mv ms l mt mu">try {<br/>  const successful = document.execCommand('copy');<br/>  const msg = successful ? 'successful' : 'unsuccessful';<br/>  console.log(msg);<br/>} catch (err) {<br/>  console.error(err);<br/>}</span><span id="3c81" class="mq lc iq mh b gy mv ms l mt mu">document.body.removeChild(textArea);</span></pre><p id="57c2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">text</code>变量有我们想要复制到剪贴板的文本。</p><p id="3710" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们创建<code class="fe me mf mg mh b">document.createElement</code>方法来创建一个<code class="fe me mf mg mh b">textarea</code>元素。</p><p id="2d04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将<code class="fe me mf mg mh b">textArea</code>的值设置为<code class="fe me mf mg mh b">text</code>，将文本放入文本区域。</p><p id="1f2c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们设置<code class="fe me mf mg mh b">top</code>、<code class="fe me mf mg mh b">left</code>和<code class="fe me mf mg mh b">position</code>样式，防止滚动到底部。</p><p id="03f1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe me mf mg mh b">textArea</code>调用<code class="fe me mf mg mh b">document.body.appendChild</code>将文本区域添加到主体中。</p><p id="5bd8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们把重点放在带有<code class="fe me mf mg mh b">focus</code>的<code class="fe me mf mg mh b">textArea</code>上。</p><p id="d9be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe me mf mg mh b">select</code>来选择文本区域中的文本，这样我们就可以复制它。</p><p id="8ff2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们用<code class="fe me mf mg mh b">'copy'</code>调用<code class="fe me mf mg mh b">document.execCommand</code>来发出复制命令，复制我们在文本区域中选择的文本。</p><p id="2374" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它返回一个布尔值来指示命令是否成功运行。</p><p id="cddd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以将文本粘贴到任何我们想要的地方。</p><h1 id="9684" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">新的方式</h1><p id="19e2" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">用JavaScript以编程方式将文本复制到剪贴板的新方法更加简洁。</p><p id="4897" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只需调用<code class="fe me mf mg mh b">navigator.clipboard.writeText</code>方法，将想要复制的文本作为参数，以编程方式将文本复制到剪贴板。</p><p id="015e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7c53" class="mq lc iq mh b gy mr ms l mt mu">const text = "abc";<br/>(async () =&gt; {<br/>  await navigator.clipboard.writeText(text);<br/>})();</span></pre><p id="072a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只是用<code class="fe me mf mg mh b">text</code>调用<code class="fe me mf mg mh b">navigator.clipboard.writeText</code>来复制文本。</p><p id="3c11" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它返回一个带有复制状态的承诺，因此我们可以将它放在一个<code class="fe me mf mg mh b">async</code>函数中。</p><p id="d1d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">较新的浏览器支持这一功能。</p><h1 id="30b4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="48f1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有多种方法可以用JavaScript以编程方式将数据复制到剪贴板。</p><p id="78d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mw">更多内容尽在</em> <a class="ae kc" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="mw">说白了</em> </strong> </a></p></div></div>    
</body>
</html>