<html>
<head>
<title>How to Make a Drag and Drop List Using react-beautiful-dnd</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用react-beautiful-dnd制作一个拖拽列表</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-make-a-drag-and-drop-list-using-react-beautiful-dnd-bca897774bc8?source=collection_archive---------4-----------------------#2021-02-03">https://javascript.plainenglish.io/how-to-make-a-drag-and-drop-list-using-react-beautiful-dnd-bca897774bc8?source=collection_archive---------4-----------------------#2021-02-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0a1e5a9dbb08e3221b5b91e6585c6fba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NxOkNSSwoE-s6seY7u8bEw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo from Valerii <a class="ae kc" href="https://www.canva.com/p/valeriimingirov/" rel="noopener ugc nofollow" target="_blank">https://www.canva.com/p/valeriimingirov/</a></figcaption></figure><h1 id="28be" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">简介:什么是react-beautiful-dnd？</h1><p id="e970" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">是一个用于创建拖放列表的React库，由Atlassian构建。这个图书馆有许多很大的特点:</p><ul class=""><li id="6cf9" class="md me iq ld b le mf li mg lm mh lq mi lu mj ly mk ml mm mn bi translated">简单易用的API</li><li id="005e" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated">无障碍兼容(<a class="ae kc" href="https://github.com/atlassian/react-beautiful-dnd/blob/master/docs/about/accessibility.md" rel="noopener ugc nofollow" target="_blank"> <em class="mt">全键盘支持和屏幕阅读器支持</em> </a>)</li><li id="494d" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated">移动和触摸设备友好</li></ul><p id="baa5" class="pw-post-body-paragraph lb lc iq ld b le mf lg lh li mg lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly ij bi translated">另一个流行的React拖放库是<code class="fe lz ma mb mc b"><a class="ae kc" href="https://react-dnd.github.io/react-dnd/docs/overview" rel="noopener ugc nofollow" target="_blank">react-dnd</a></code>。<code class="fe lz ma mb mc b">react-beautiful-dnd</code>比<code class="fe lz ma mb mc b">react-dnd</code>简单得多，但是有一些限制，主要是为垂直和水平列表的拖放而设计的。</p><p id="a640" class="pw-post-body-paragraph lb lc iq ld b le mf lg lh li mg lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly ij bi translated">在这篇博客中，我们将关注<code class="fe lz ma mb mc b">react-beautiful-dnd</code>——如何设置它，关于API的一些细节，以及最后如何实现一个可重新排序的列表。</p><h1 id="5c97" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">安装</h1><p id="7eb2" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><code class="fe lz ma mb mc b"><strong class="ld ir">react-beautiful-dnd</strong></code>是一个<a class="ae kc" href="https://github.com/atlassian/react-beautiful-dnd" rel="noopener ugc nofollow" target="_blank"> NPM包</a>。首先，使用npm或yarn在命令行上安装它:</p><pre class="mx my mz na gt nb mc nc nd aw ne bi"><span id="74f9" class="nf ke iq mc b gy ng nh l ni nj"><em class="mt"># Using npm<br/></em>npm i react-beautiful-dnd</span><span id="f985" class="nf ke iq mc b gy nk nh l ni nj"><em class="mt"># Using yarn:<br/></em>yarn add react-beautiful-dnd</span></pre><p id="aba4" class="pw-post-body-paragraph lb lc iq ld b le mf lg lh li mg lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly ij bi translated">然后，通过导入，您可以在您的<code class="fe lz ma mb mc b">React</code>程序中的任何地方使用该包:</p><pre class="mx my mz na gt nb mc nc nd aw ne bi"><span id="cfe9" class="nf ke iq mc b gy ng nh l ni nj">import { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';</span></pre><h1 id="f27b" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">了解API</h1><p id="aa16" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><code class="fe lz ma mb mc b">react-beautiful-dnd</code> API为我们提供了3个主要构件:</p><h2 id="fac4" class="nf ke iq bd kf nl nm dn kj nn no dp kn lm np nq kr lq nr ns kv lu nt nu kz nv bi translated"><strong class="ak"> 1) DragDropContext </strong></h2><p id="68dd" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">要使用拖放，您需要用<code class="fe lz ma mb mc b"><strong class="ld ir">&lt;DragDropContext&gt;</strong></code>包装您的<code class="fe lz ma mb mc b">React</code>树中您希望能够使用拖放的部分。它接受<code class="fe lz ma mb mc b">onDragStart</code>和<code class="fe lz ma mb mc b">onDragEnd</code>回调，允许你在用户开始/停止拖动时做一些事情</p><h2 id="1039" class="nf ke iq bd kf nl nm dn kj nn no dp kn lm np nq kr lq nr ns kv lu nt nu kz nv bi translated"><strong class="ak"> 2)可拖动</strong></h2><p id="e1b3" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">要使特定的元素可拖动，需要用<code class="fe lz ma mb mc b"><strong class="ld ir">&lt;Draggable&gt;</strong></code>包装它。<code class="fe lz ma mb mc b">&lt;Draggable /&gt;</code>的<code class="fe lz ma mb mc b">React</code>子节点必须是返回<code class="fe lz ma mb mc b">ReactNode</code>的函数。该功能有两个支柱:</p><ul class=""><li id="2373" class="md me iq ld b le mf li mg lm mh lq mi lu mj ly mk ml mm mn bi translated"><code class="fe lz ma mb mc b"><strong class="ld ir">provided</strong></code><strong class="ld ir">(</strong><code class="fe lz ma mb mc b"><strong class="ld ir">DraggableProvided</strong></code><strong class="ld ir">)</strong>——这个物体给了我们一个<code class="fe lz ma mb mc b">ref</code>和一些<code class="fe lz ma mb mc b">props</code>需要应用到我们想要拖动的元素上。</li><li id="e0dd" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated"><code class="fe lz ma mb mc b"><strong class="ld ir">snapshot</strong></code><strong class="ld ir">(</strong><code class="fe lz ma mb mc b"><strong class="ld ir">DraggableStateSnapshot</strong></code><strong class="ld ir">)</strong>——包含当前拖动状态的相关数据，如<code class="fe lz ma mb mc b">isDragging</code>存储该元素当前是否被拖动。</li></ul><h2 id="aa56" class="nf ke iq bd kf nl nm dn kj nn no dp kn lm np nq kr lq nr ns kv lu nt nu kz nv bi translated"><strong class="ak"> 3)可丢弃</strong></h2><p id="fd51" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">包裹在<code class="fe lz ma mb mc b"><strong class="ld ir">&lt;Droppable&gt;</strong></code>中的元素代表了<code class="fe lz ma mb mc b"><strong class="ld ir">&lt;Draggable/&gt;</strong></code>元素可以放入的区域。一个<code class="fe lz ma mb mc b">Droppable</code>必须至少包含一个<code class="fe lz ma mb mc b">Draggable</code>项。</p><p id="c2be" class="pw-post-body-paragraph lb lc iq ld b le mf lg lh li mg lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly ij bi translated"><code class="fe lz ma mb mc b">Droppable</code>儿童功能与<code class="fe lz ma mb mc b">Draggable</code>类似，接受<code class="fe lz ma mb mc b"><strong class="ld ir">provided</strong></code> : ( <code class="fe lz ma mb mc b">DroppableProvided</code>)和<code class="fe lz ma mb mc b"><strong class="ld ir">snapshot</strong></code> ( <code class="fe lz ma mb mc b">DroppableStateSnapshot</code>)作为道具。</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/db00077991eb2994bfa8de9b98f536f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TJdKIoiGTj-OIy3sLs_uDQ.png"/></div></div></figure><p id="22fd" class="pw-post-body-paragraph lb lc iq ld b le mf lg lh li mg lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly ij bi translated">关于这些组件的更多细节，我建议查看<a class="ae kc" href="https://github.com/atlassian/react-beautiful-dnd/tree/master/docs/api" rel="noopener ugc nofollow" target="_blank">官方文件</a>。</p><h1 id="1558" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">构建可重新订购的域名列表</h1><p id="d98c" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">利用我们刚刚学到的知识，现在让我们看看如何使用<code class="fe lz ma mb mc b">react-beautiful-dnd</code>构建可重新排序的列表。</p><h2 id="f503" class="nf ke iq bd kf nl nm dn kj nn no dp kn lm np nq kr lq nr ns kv lu nt nu kz nv bi translated">第一步。建造一个可拖动的盒子</h2><p id="2a6f" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">首先，让我们在一个容器中构建一个简单的可拖动的盒子。查看下面的反应代码:</p><ul class=""><li id="4d23" class="md me iq ld b le mf li mg lm mh lq mi lu mj ly mk ml mm mn bi translated">它有一个单一的<code class="fe lz ma mb mc b"><strong class="ld ir">Draggable</strong></code>组件，用<code class="fe lz ma mb mc b">className: item</code>包裹<code class="fe lz ma mb mc b">div</code>。这是用<code class="fe lz ma mb mc b">className: container</code>包裹在<code class="fe lz ma mb mc b"><strong class="ld ir">Droppable</strong></code> <code class="fe lz ma mb mc b">div</code>里面，整个东西都是用<code class="fe lz ma mb mc b"><strong class="ld ir">DragDropContext</strong></code>包裹着的</li><li id="e342" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated">在<code class="fe lz ma mb mc b">onDragEnd</code>中，我们只是给控制台写一条信息</li><li id="ece3" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated">我们根据当前是否被拖动(即<code class="fe lz ma mb mc b">snapshot.isDragging</code>)来添加和删除<code class="fe lz ma mb mc b">item</code>中的类名</li><li id="573a" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated">我们根据当前是否被拖动来添加和删除<code class="fe lz ma mb mc b">container</code>中的一个类名(即<code class="fe lz ma mb mc b">snapshot.isDraggingOver</code></li></ul><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="6543" class="pw-post-body-paragraph lb lc iq ld b le mf lg lh li mg lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly ij bi translated">下面是一些简单的CSS来定位容器和项目，并在拖动时改变每个的<code class="fe lz ma mb mc b">background-color</code>:</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="15c7" class="pw-post-body-paragraph lb lc iq ld b le mf lg lh li mg lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly ij bi translated">这里有一个运行中的代码示例。您会注意到拖动时每个元素的颜色都发生了变化，然后在拖动操作完成时<code class="fe lz ma mb mc b">"Drag ended"</code>会被记录到控制台:</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/759097b23a807ee19616425466424929.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/1*H68v8S00iRzVkGY3FHWRpA.gif"/></div></figure><h2 id="86b7" class="nf ke iq bd kf nl nm dn kj nn no dp kn lm np nq kr lq nr ns kv lu nt nu kz nv bi translated">第二步。添加到我们的解决方案中以构建一个可重新排序的列表</h2><p id="c678" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在让我们扩展上面的代码，得到一个可拖动项目的完整列表。首先，这里有一个小的帮助函数来重新排序一个列表。它接受您想要移动的项目的<code class="fe lz ma mb mc b">list</code>，以及<code class="fe lz ma mb mc b">startIndex</code>和<code class="fe lz ma mb mc b">endIndex</code>，返回重新排序的列表:</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="a72d" class="pw-post-body-paragraph lb lc iq ld b le mf lg lh li mg lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly ij bi translated">现在，让我们扩展一下上面的<code class="fe lz ma mb mc b">DraggableExample</code>组件。在下面的React代码中:</p><ul class=""><li id="af24" class="md me iq ld b le mf li mg lm mh lq mi lu mj ly mk ml mm mn bi translated">我们在React状态下存储了一个列表<code class="fe lz ma mb mc b">items</code>。初始值只是一系列从1到10的数字</li><li id="0f29" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated">我们现在不是只呈现一个<code class="fe lz ma mb mc b">&lt;Draggable&gt;</code>项目，而是循环遍历<code class="fe lz ma mb mc b">this.state.items</code>并为列表中的每个项目呈现一个<code class="fe lz ma mb mc b">&lt;Draggable&gt;</code></li><li id="3bb1" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated"><code class="fe lz ma mb mc b">onDragEnd</code>修改为对列表中的项目进行重新排序。该方法接受类型为<code class="fe lz ma mb mc b">DropResult</code>的<code class="fe lz ma mb mc b">result</code>，它包含拖动操作的源和目标索引。我们使用这个源和目的地从上面调用我们的<code class="fe lz ma mb mc b">reorder()</code>方法</li><li id="0b12" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated">从<code class="fe lz ma mb mc b">reorder()</code>获得更新后的列表后，我们更新<code class="fe lz ma mb mc b">this.state.items</code></li></ul><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="eeec" class="pw-post-body-paragraph lb lc iq ld b le mf lg lh li mg lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly ij bi translated">下面是更新后的CSS来呈现列表项:</p><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="4f97" class="pw-post-body-paragraph lb lc iq ld b le mf lg lh li mg lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly ij bi translated">可再订购免打扰列表现已完成。在下面的GIF中查看最终结果，或者您可以在Codepen上亲自尝试🎉</p><figure class="mx my mz na gt jr gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/f63caff09f85e196eee2c09b99b39f59.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/1*skqFbtBmqoxDMRdob33-Rw.gif"/></div></figure><figure class="mx my mz na gt jr"><div class="bz fp l di"><div class="oa ny l"/></div></figure></div><div class="ab cl ob oc hu od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ij ik il im in"><h1 id="7694" class="kd ke iq bd kf kg oi ki kj kk oj km kn ko ok kq kr ks ol ku kv kw om ky kz la bi translated">资源</h1><p id="c78a" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">以下是一些额外的资源:</p><ul class=""><li id="d938" class="md me iq ld b le mf li mg lm mh lq mi lu mj ly mk ml mm mn bi translated"><code class="fe lz ma mb mc b"><a class="ae kc" href="https://github.com/atlassian/react-beautiful-dnd" rel="noopener ugc nofollow" target="_blank">react-beautiful-dnd</a></code> <a class="ae kc" href="https://github.com/atlassian/react-beautiful-dnd" rel="noopener ugc nofollow" target="_blank">公文</a></li><li id="7d90" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated"><a class="ae kc" href="https://yarnpkg.com/package/react-beautiful-dnd" rel="noopener ugc nofollow" target="_blank">纱线上的包装信息</a></li><li id="5f1e" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated"><a class="ae kc" href="https://react-dnd.github.io/react-dnd/docs/overview" rel="noopener ugc nofollow" target="_blank">反应堆和库</a></li><li id="30fc" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated"><a class="ae kc" href="https://egghead.io/courses/beautiful-and-accessible-drag-and-drop-with-react-beautiful-dnd" rel="noopener ugc nofollow" target="_blank">使用<code class="fe lz ma mb mc b">react-beautiful-dnd</code>将</a>列入黑名单</li><li id="7f14" class="md me iq ld b le mo li mp lm mq lq mr lu ms ly mk ml mm mn bi translated">【freecodecamp教程</li></ul><p id="f358" class="pw-post-body-paragraph lb lc iq ld b le mf lg lh li mg lk ll lm mu lo lp lq mv ls lt lu mw lw lx ly ij bi translated"><em class="mt">感谢您的阅读，希望能有所帮助！</em></p></div></div>    
</body>
</html>