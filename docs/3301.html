<html>
<head>
<title>JavaScript Promise Cheat Sheet — Handing Promise Results</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript承诺备忘单—处理承诺结果</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-promise-cheat-sheet-handing-promise-results-1da3ad25b053?source=collection_archive---------18-----------------------#2021-07-05">https://javascript.plainenglish.io/javascript-promise-cheat-sheet-handing-promise-results-1da3ad25b053?source=collection_archive---------18-----------------------#2021-07-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/19903f7cbba511e1a85a299fb01248aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YbZmGvF-5HX3SEqz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@andrewwwpetrov?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Andrew Petrov</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="efbf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">JavaScript promises让我们可以轻松地将非IO阻塞的异步代码顺序添加到我们的JavaScript应用程序中。</p><p id="624f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，它们在任何地方都被使用。</p><p id="613a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何在JavaScript代码中使用承诺。</p><h1 id="902a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创造一个承诺来解决</h1><p id="6b20" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以创建一个用<code class="fe me mf mg mh b">Promise.resolve</code>解决的承诺。</p><p id="470b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5a7d" class="mq lc iq mh b gy mr ms l mt mu">Promise.resolve(1)<br/>  .then((val) =&gt; console.log(val))</span></pre><p id="df85" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么<code class="fe me mf mg mh b">val</code>就是1，因为我们把1传递给了<code class="fe me mf mg mh b">Promise.resolve</code>。</p><h1 id="ffa7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">做出拒绝的承诺</h1><p id="0d3a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以创建一个用<code class="fe me mf mg mh b">Promise.reject</code>解决的承诺。</p><p id="a887" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="98b0" class="mq lc iq mh b gy mr ms l mt mu">Promise.reject('error')<br/>  .catch((err) =&gt; console.log(err))</span></pre><p id="78d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么err就是<code class="fe me mf mg mh b">'error'</code>，因为<code class="fe me mf mg mh b">catch</code>回调捕捉到了被拒绝承诺的原因值。</p><h1 id="043c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">捕捉被拒绝的承诺</h1><p id="6925" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">Promise.prototype.catch</code>实例方法处理被拒绝的承诺引发的错误。</p><p id="8fe2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5049" class="mq lc iq mh b gy mr ms l mt mu">Promise.reject('error')<br/>  .catch((err) =&gt; console.log(err))</span></pre><p id="9b27" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么err就是<code class="fe me mf mg mh b">'error'</code>，因为<code class="fe me mf mg mh b">catch</code>回调捕获了被拒绝承诺的原因值。</p><p id="f143" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这让我们处理第一个被拒绝的承诺的值。</p><h1 id="18e7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">从承诺中获得价值</h1><p id="3757" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">Promise.prototype.then</code>方法从已解决的承诺中获取价值。</p><p id="ad07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="afce" class="mq lc iq mh b gy mr ms l mt mu">Promise.resolve(1)<br/>  .then(() =&gt; Promise.resolve(2))<br/>  .then((val) =&gt; console.log(val))</span></pre><p id="375d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用带参数的回调调用<code class="fe me mf mg mh b">then</code>,从之前解析的承诺中获取解析的值。</p><p id="1c56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以<code class="fe me mf mg mh b">val</code>是2。</p><h1 id="2b67" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">不管承诺结果如何都运行代码</h1><p id="a59b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">Promise.prototype.finally</code>方法来运行代码，而不管承诺发生了什么。</p><p id="a2c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7460" class="mq lc iq mh b gy mr ms l mt mu">Promise.reject('error')<br/>  .catch((err) =&gt; console.log(err))<br/>  .finally(() =&gt; console.log('finally'))</span></pre><p id="a95f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们会看到<code class="fe me mf mg mh b">'error'</code>和<code class="fe me mf mg mh b">'finally'</code>被记录，因为<code class="fe me mf mg mh b">finally</code>回调运行，而不管承诺是被解决还是被拒绝。</p><h1 id="e503" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="c197" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用承诺来简化异步JavaScript代码的编写。</p><p id="89a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mv">更多内容请看</em><a class="ae kc" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mv">plain English . io</em></strong></a></p></div></div>    
</body>
</html>