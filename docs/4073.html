<html>
<head>
<title>Passwordless login with Next.js and Cotter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Next.js和Cotter进行无密码登录</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/passwordless-login-with-next-js-and-cotter-b07c434a9b51?source=collection_archive---------21-----------------------#2021-08-13">https://javascript.plainenglish.io/passwordless-login-with-next-js-and-cotter-b07c434a9b51?source=collection_archive---------21-----------------------#2021-08-13</a></blockquote><div><div class="fc ic id ie if ig"/><div class="ih ii ij ik il"><div class=""/><figure class="gm go jm jn jo jp gi gj paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="gi gj jl"><img src="../Images/880413cf4e2ee90aa7af97aa50d48835.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UwMiTezffYtv-ak3jXa94Q.png"/></div></div><figcaption class="jw jx gk gi gj jy jz bd b be z dk">An authentication form built using Next.js and Cotter</figcaption></figure><h1 id="680b" class="ka kb io bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">介绍</h1><p id="7489" class="pw-post-body-paragraph ky kz io la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ih bi translated">构建用户身份验证(以及随之而来的所有开销)非常耗时，当您希望并需要首先专注于构建您的产品时，您需要寻找能够帮助您在不打折扣的情况下做正确事情的解决方案。</p><p id="255c" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated">因此，使用身份验证提供者确实可以在早期阶段<strong class="la ip">帮助加快开发</strong>的速度，为您节省构建时间，并为您的用户登录提供简单、经过测试的体验。</p><p id="c14a" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated">找到一个同时支持这两者的提供商是理想的选择，拥有无密码登录是实现这一目标的重要一步，这也是我选择的原因:</p><ul class=""><li id="7fce" class="mb mc io la b lb lw lf lx lj md ln me lr mf lv mg mh mi mj bi translated"><a class="ae mk" href="https://www.cotter.app/" rel="noopener ugc nofollow" target="_blank">密码</a> -一种无代码和低代码的无密码登录提供商，为您的网站/应用添加登录体验提供了可定制的解决方案</li><li id="95e9" class="mb mc io la b lb ml lf mm lj mn ln mo lr mp lv mg mh mi mj bi translated"><a class="ae mk" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a> -一个React框架，为用户和开发人员的工作效率提供了许多聪明的特性，因此您可以专注于构建——我这里使用的是11.1版(我使用的是TypeScript，但是同等的JavaScript应该足够接近了！)</li></ul><h1 id="eb79" class="ka kb io bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">设置</h1><p id="f132" class="pw-post-body-paragraph ky kz io la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ih bi translated">为了缩短本教程，我假设:</p><ol class=""><li id="691d" class="mb mc io la b lb lw lf lx lj md ln me lr mf lv mq mh mi mj bi translated">您的开口销帐户和登录表单是按照您的要求设置的</li><li id="39cd" class="mb mc io la b lb ml lf mm lj mn ln mo lr mp lv mq mh mi mj bi translated">您至少有了一个基本的Next.js应用程序设置，可以开始了！</li></ol><h2 id="dd95" class="mr kb io bd kc ms mt dn kg mu mv dp kk lj mw mx ko ln my mz ks lr na nb kw nc bi translated">开口销集成方法</h2><p id="3d16" class="pw-post-body-paragraph ky kz io la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ih bi translated">现在，科特提到了<strong class="la ip">两种</strong>方法来集成和反应:</p><ol class=""><li id="0f24" class="mb mc io la b lb lw lf lx lj md ln me lr mf lv mq mh mi mj bi translated"><code class="fe nd ne nf ng b">CotterProvider</code>通过<code class="fe nd ne nf ng b">cotter-react</code> — <a class="ae mk" href="https://github.com/cotterapp/cotter-react" rel="noopener ugc nofollow" target="_blank">链接</a></li><li id="ac45" class="mb mc io la b lb ml lf mm lj mn ln mo lr mp lv mq mh mi mj bi translated">或者通过他们的通用JavaScript库<code class="fe nd ne nf ng b">cotter</code> — <a class="ae mk" href="https://github.com/cotterapp/cotter-js" rel="noopener ugc nofollow" target="_blank">链接</a></li></ol><p id="9a80" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated">我在这个阶段也没有使用过，所以在这个教程中，我将使用第一个，即<code class="fe nd ne nf ng b">CotterProvider</code> / <code class="fe nd ne nf ng b">cotter-react</code>。</p><h1 id="e6fb" class="ka kb io bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">开始</h1><p id="d62d" class="pw-post-body-paragraph ky kz io la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ih bi translated"><strong class="la ip">所需时间:约10分钟。</strong></p><p id="af32" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated"><strong class="la ip">参考文献:</strong></p><ul class=""><li id="ee2d" class="mb mc io la b lb lw lf lx lj md ln me lr mf lv mg mh mi mj bi translated"><a class="ae mk" href="https://github.com/cotterapp/cotter-react" rel="noopener ugc nofollow" target="_blank">https://github.com/cotterapp/cotter-react</a></li><li id="b91d" class="mb mc io la b lb ml lf mm lj mn ln mo lr mp lv mg mh mi mj bi translated">OR-cutter Dashboard &gt;<em class="nh">Project</em>&gt;<em class="nh">Form&amp;field-</em>在<em class="nh">设置说明</em>部分，然后在<em class="nh"> With Code </em>部分，然后在选择的下拉列表中<em class="nh">reaction</em></li></ul><p id="6e20" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated"><strong class="la ip"> <em class="nh">注意:</em> </strong> <em class="nh">使用一个React </em> <code class="fe nd ne nf ng b"><em class="nh">Provider</em></code> <em class="nh">在Next.js中需要</em> <a class="ae mk" href="https://nextjs.org/docs/advanced-features/custom-app" rel="noopener ugc nofollow" target="_blank"> <em class="nh">一个自定义App组件</em> </a> <em class="nh">。</em></p><h2 id="c3d4" class="mr kb io bd kc ms mt dn kg mu mv dp kk lj mw mx ko ln my mz ks lr na nb kw nc bi translated">步伐</h2><p id="7e40" class="pw-post-body-paragraph ky kz io la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ih bi translated"><strong class="la ip"> 1。</strong>运行<br/> <code class="fe nd ne nf ng b">npm install cotter-react —-save</code>安装开口销提供器(包含在<code class="fe nd ne nf ng b">cotter-react</code>中)</p><p id="b340" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated"><strong class="la ip"> 2。</strong>如果您没有自定义的Next.js应用程序，请创建一个(<a class="ae mk" href="https://nextjs.org/docs/advanced-features/custom-app" rel="noopener ugc nofollow" target="_blank">详细信息在此处</a>)并用<code class="fe nd ne nf ng b">CotterProvider</code>包装您的应用程序，如下所示:</p><pre class="ni nj nk nl gu nm ng nn no aw np bi"><span id="07f4" class="mr kb io ng b gz nq nr l ns nt">function MyApp({ Component, pageProps }) {<br/>  return (<br/><strong class="ng ip">    </strong><strong class="ng ip">&lt;CotterProvider apiKeyID={process.env.cotterApiKeyId}&gt;</strong><br/>      <!-- -->&lt;Component {...pageProps} /&gt;<br/>    <strong class="ng ip">&lt;/CotterProvider&gt;</strong><br/>  )<br/>}</span></pre><p id="3d86" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated"><strong class="la ip"> <em class="nh">提示:</em></strong><em class="nh"/><code class="fe nd ne nf ng b"><em class="nh">process.env.cotterApiKeyId</em></code><em class="nh">是由</em><a class="ae mk" href="https://nextjs.org/docs/api-reference/next.config.js/environment-variables" rel="noopener ugc nofollow" target="_blank"><em class="nh">next . js环境变量</em> </a> <em class="nh">提供的，你把它添加到你的</em><strong class="la ip"><em class="nh">next . config . js</em></strong><em class="nh">(或者直接把你的粘贴进去就行了！)</em></p><p id="f220" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated"><strong class="la ip"> 3。使用登录页面认证您的用户</strong></p><p id="fae5" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated"><strong class="la ip"/></p><p id="6c54" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated">a)将登录页面添加到您的<code class="fe nd ne nf ng b">pages</code>文件夹— <a class="ae mk" href="https://nextjs.org/docs/basic-features/pages" rel="noopener ugc nofollow" target="_blank"> docs </a></p><p id="acdd" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated">b)将<code class="fe nd ne nf ng b">LoginForm</code>组件导入到您的登录页面:<br/> <code class="fe nd ne nf ng b">import { LoginForm } from 'cotter-react'</code></p><p id="5771" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated">c)添加具有以下<strong class="la ip">占位符</strong>属性的<code class="fe nd ne nf ng b">LoginForm</code>组件(您稍后将根据需要更新这些属性)</p><p id="7ddb" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated">因此，您的登录页面代码现在应该如下所示:</p><pre class="ni nj nk nl gu nm ng nn no aw np bi"><span id="1521" class="mr kb io ng b gz nq nr l ns nt">import React from 'react';</span><span id="4984" class="mr kb io ng b gz nu nr l ns nt"><strong class="ng ip">import { LoginForm } from 'cotter-react'</strong></span><span id="c66b" class="mr kb io ng b gz nu nr l ns nt">function Login() {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;h1&gt;Login&lt;/h1&gt;<br/>      <strong class="ng ip">&lt;LoginForm<br/>        type="undefined"        // EMAIL or PHONE<br/>        authMethod="undefined"  // OTP or MAGIC_LINK<br/>        width={'auto'}          // Width of form<br/>        height={300}            // Cotter recommend 300x300 minimum<br/>        formID={"form_default"} // From your Cotter config (default)</strong></span><span id="e348" class="mr kb io ng b gz nu nr l ns nt"><strong class="ng ip">        // Placeholder/sample authentication handlers:<br/>        onSuccess={(response) =&gt; console.log(response)}<br/>        onError={(err) =&gt; console.log(err)}<br/>      /&gt;</strong><br/>    &lt;/div&gt;<br/>  )<br/>}</span><span id="aa10" class="mr kb io ng b gz nu nr l ns nt">export default Login</span></pre><p id="80c6" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated">根据您的Cotter配置(和应用程序风格)，它应该呈现如下内容:</p><figure class="ni nj nk nl gu jp gi gj paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="gi gj jl"><img src="../Images/880413cf4e2ee90aa7af97aa50d48835.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UwMiTezffYtv-ak3jXa94Q.png"/></div></div><figcaption class="jw jx gk gi gj jy jz bd b be z dk">A Cotter LoginForm component configured to offer an email address or use Google authentication</figcaption></figure><h2 id="56dc" class="mr kb io bd kc ms mt dn kg mu mv dp kk lj mw mx ko ln my mz ks lr na nb kw nc bi translated">完成的</h2><p id="4cc5" class="pw-post-body-paragraph ky kz io la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ih bi translated">您现在可以开始使用<code class="fe nd ne nf ng b">CotterProvider</code>获取信息，如<strong class="la ip">认证状态</strong>或<strong class="la ip">当前用户信息！</strong></p><p id="88a1" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated">例如</p><pre class="ni nj nk nl gu nm ng nn no aw np bi"><span id="e822" class="mr kb io ng b gz nq nr l ns nt">import React, { <strong class="ng ip"><em class="nh">useContext</em></strong><em class="nh"> </em>} from 'react';<br/>import { LoginForm } from 'cotter-react'</span><span id="b701" class="mr kb io ng b gz nu nr l ns nt">function Login() {<br/>  <strong class="ng ip">const {   <br/>    isLoggedIn,<br/>    isLoading,<br/>    </strong>user,<br/>    getAccessToken,<br/>    logout,<br/>    getCotter,<br/>    apiKeyID,<br/>    checkLoggedIn<strong class="ng ip"><br/>  } = <em class="nh">useContext</em>(<em class="nh">CotterContext</em>);</strong></span><span id="9a0d" class="mr kb io ng b gz nu nr l ns nt">return (<br/>    &lt;div&gt;<br/>      &lt;h1&gt;Login&lt;/h1&gt;<br/>      <strong class="ng ip">{isLoading ? (<br/>        'Loading...'<br/>      ) : isLoggedIn ? (<br/>        'Hello user!'<br/>      ) : (</strong><br/>        &lt;LoginForm<br/>          type="EMAIL"<br/>          authMethod="MAGIC_LINK"<br/>          width={'auto'}<br/>          height={300}<br/>          formID={'form_default'}<br/>          onSuccess={(response) =&gt; <em class="nh">console</em>.log(response)}<br/>          onError={(err) =&gt; <em class="nh">console</em>.log(err)}<br/>        /&gt;<br/>      )}<br/>    &lt;/div&gt;<br/>  )<br/>}</span><span id="2df3" class="mr kb io ng b gz nu nr l ns nt">export default Login</span></pre><p id="af0d" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated">更多信息请点击这里:<br/><a class="ae mk" href="https://github.com/cotterapp/cotter-react#using-the-cotterprovider" rel="noopener ugc nofollow" target="_blank">https://github . com/cotter app/cotter-react # using-the-cotter provider</a></p><h1 id="51a4" class="ka kb io bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">接下来呢？</h1><p id="d0ba" class="pw-post-body-paragraph ky kz io la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ih bi translated">这只是与Cotter的初始、基本集成。在适当的时候，我将探索和分享如何将它用于用Next.js构建的面向公众的应用程序，以及其他主题，包括:</p><ul class=""><li id="0e2b" class="mb mc io la b lb lw lf lx lj md ln me lr mf lv mg mh mi mj bi translated">无头CMS集成实践</li><li id="da9e" class="mb mc io la b lb ml lf mm lj mn ln mo lr mp lv mg mh mi mj bi translated">静态和动态服务器端生成</li></ul><p id="ec5e" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated">如果你想看更多关于这个系列的内容，<a class="ae mk" href="https://twitter.com/dfjsc" rel="noopener ugc nofollow" target="_blank">在Twitter </a>(或Medium)上关注我，我会在那里分享更新和更多内容。</p><p id="0e96" class="pw-post-body-paragraph ky kz io la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ih bi translated"><em class="nh">更多内容请看</em><a class="ae mk" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="la ip"><em class="nh">plain English . io</em></strong></a></p></div></div>    
</body>
</html>