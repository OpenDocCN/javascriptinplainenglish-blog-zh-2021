<html>
<head>
<title>Build Your Own Ghost City in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript构建你自己的鬼城</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/build-your-own-ghost-city-in-javascript-dc08260b796a?source=collection_archive---------11-----------------------#2021-05-28">https://javascript.plainenglish.io/build-your-own-ghost-city-in-javascript-dc08260b796a?source=collection_archive---------11-----------------------#2021-05-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="7253" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">利用GSAP和Three.js的力量来建造自己的城市。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e1ce2113d0a814e4ad9ad61b09b7f9c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*I-XInVXuweXdMo5zpMyspg.gif"/></div></div></figure><p id="cfa5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Three.js和GSAP是用JavaScript创建高度互动网站的最好的库，对于那些使用Flex boxes和CSSGrid以及其他CSS3动画的人来说，GSAP和three.js的结合就像魔术一样。</p><p id="572c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在你的职业生涯中，应该有一段时间，你应该从正常的布局走向前进，思考如何最大限度地发挥你内心的创造力。</p><p id="279e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">我们用来在浏览器中实现这种效果的高级工具</strong></p><p id="5e39" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，我们有一个非常基本的场景，我们添加了一些灯光，包括环境光和平行光，以及加载到我们的应用程序中的纹理，这是一个GLTF 3d模型，这是可以导入到我们的three.js应用程序中的许多3d结构之一。</p><p id="ef55" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">提示:如果你决定从互联网上获取一些东西，事先使用某种可视化工具来查看你的3D模型，否则这将是毫无意义的调试，可能会试图修复你的代码，而不是发现模型是问题所在。</p><p id="75f5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在加载了GLTF模型后，感谢three.js文档，这是一个很棒的网站，有很棒的工作示例和实际使用案例和样本。</p><p id="be2b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">让我们过一遍这些步骤，我们只用很少几行代码就能实现这种3d效果。</strong></p><pre class="kj kk kl km gt ku kv kw kx aw ky bi"><span id="6b24" class="kz la in kv b gy lb lc l ld le">var w = window.innerWidth;<br/>var h = window.innerHeight;<br/>var container, stats;<br/>var camera,<br/>  controls,<br/>  scene,<br/>  renderer,<br/>  boxes = [];</span></pre><h1 id="4350" class="lf la in bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak"> 1。渲染器</strong></h1><p id="82df" class="pw-post-body-paragraph jk jl in jm b jn mc jp jq jr md jt ju jv me jx jy jz mf kb kc kd mg kf kg kh ig bi translated">创建一个基本的渲染器，它可以用于任何类型的Three.js设置。</p><pre class="kj kk kl km gt ku kv kw kx aw ky bi"><span id="3fd9" class="kz la in kv b gy lb lc l ld le">renderer = new THREE.WebGLRenderer({ antialias: true });<br/>renderer.setPixelRatio(window.devicePixelRatio);<br/>renderer.setSize(w, h);<br/>container = document.getElementById("container");<br/>container.appendChild(renderer.domElement)</span></pre><h1 id="2917" class="lf la in bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak"> 2。相机</strong></h1><p id="577a" class="pw-post-body-paragraph jk jl in jm b jn mc jp jq jr md jt ju jv me jx jy jz mf kb kc kd mg kf kg kh ig bi translated">我们使用透视相机来模拟人眼的深度处理和角度等等。</p><pre class="kj kk kl km gt ku kv kw kx aw ky bi"><span id="f585" class="kz la in kv b gy lb lc l ld le">// camera<br/>  camera = new THREE.PerspectiveCamera(60, w / h, 1, 1000);<br/>  camera.animAngle = 0;<br/>  camera.position.x = Math.cos(camera.animAngle) * 400;<br/>  camera.position.y = 180;<br/>  camera.position.z = -400;</span></pre><h1 id="554f" class="lf la in bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak"> 3。场景</strong></h1><p id="5410" class="pw-post-body-paragraph jk jl in jm b jn mc jp jq jr md jt ju jv me jx jy jz mf kb kc kd mg kf kg kh ig bi translated">我们的场景将在这个设置中运行，我们的摄像机将在UI中查看。</p><pre class="kj kk kl km gt ku kv kw kx aw ky bi"><span id="1df5" class="kz la in kv b gy lb lc l ld le">scene = new THREE.Scene();<br/>  scene.fog = new THREE.FogExp2(0x1e2630, 0.002);<br/>  renderer.setClearColor(scene.fog.color);</span><span id="cbcf" class="kz la in kv b gy mh lc l ld le">light = new THREE.DirectionalLight(0xfffffff);<br/>  light.position.set(-1, -1, -1);<br/>  scene.add(light);<br/>  light = new THREE.AmbientLight(0x222222);<br/>  scene.add(light);</span></pre><h1 id="58de" class="lf la in bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">4.GLTF是我们城市的榜样</h1><p id="b0ef" class="pw-post-body-paragraph jk jl in jm b jn mc jp jq jr md jt ju jv me jx jy jz mf kb kc kd mg kf kg kh ig bi translated">我们将与之互动并基于我们的互动而移动的城市。</p><pre class="kj kk kl km gt ku kv kw kx aw ky bi"><span id="6b2f" class="kz la in kv b gy lb lc l ld le">const loader = new THREE.GLTFLoader();<br/>  loader.load(<br/>    "<a class="ae mi" href="https://threejsfundamentals.org/threejs/resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf" rel="noopener ugc nofollow" target="_blank">https://threejsfundamentals.org/threejs/resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf</a>",<br/>    function (object) {<br/>      object.scene.scale.x = 0.5;<br/>      object.scene.scale.y = 0.5;<br/>      object.scene.scale.z = 0.5;<br/>      scene.add(object.scene);<br/>    }<br/>  );</span></pre><h1 id="fda6" class="lf la in bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">5.用户交互滚动(GSAP)</h1><p id="044c" class="pw-post-body-paragraph jk jl in jm b jn mc jp jq jr md jt ju jv me jx jy jz mf kb kc kd mg kf kg kh ig bi translated">有不同的方式与我们的3D世界互动，我选择的是添加一个由GSAP GSAP提供的滚动触发著名插件，如果你不知道，这是一个惊人的库，用于处理动画，时间线，插值和类似的东西。它不仅仅是生产就绪，而且已经在许多高质量的网站中被证明是健壮的。</p><p id="8dee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Three.js也有自己的内置控件。</p><pre class="kj kk kl km gt ku kv kw kx aw ky bi"><span id="fbf9" class="kz la in kv b gy lb lc l ld le">gsap.registerPlugin(ScrollTrigger);<br/>gsap.to(camera.position, {<br/>    x: "-=460",<br/>    z: "+=200",<br/>    y: -10,<br/>    ease: "Power2.easeInOut",<br/>    scrollTrigger: {<br/>      trigger: renderer.domElement,<br/>      start: "top top",<br/>      end: "+=100%",<br/>      pin: true,<br/>      scrub: true,<br/>    },<br/>    onUpdate: function () {<br/>     <br/>    },<br/>  });<br/>  gsap.to(camera.rotation, {<br/>    y: 2,</span><span id="943f" class="kz la in kv b gy mh lc l ld le">ease: "Power2.easeOut",<br/>    scrollTrigger: {<br/>      trigger: renderer.domElement,<br/>      start: "top top",<br/>      end: "+=100%",<br/>      pin: true,<br/>      scrub: true,<br/>    },<br/>    onUpdate: function () {<br/>    <br/>    },<br/>  });</span></pre><p id="1b4d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一个动画用于制作摄像机位置的动画，另一个用于制作旋转的动画，从而产生无人机效果。</p><h1 id="6f4d" class="lf la in bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">6.重新播放动画</h1><p id="6982" class="pw-post-body-paragraph jk jl in jm b jn mc jp jq jr md jt ju jv me jx jy jz mf kb kc kd mg kf kg kh ig bi translated">我们有办法再次运行动画来渲染新的帧。</p><pre class="kj kk kl km gt ku kv kw kx aw ky bi"><span id="5b4e" class="kz la in kv b gy lb lc l ld le">function animate() {<br/>  requestAnimationFrame(animate);<br/>  renderer.render(scene, camera);<br/>}</span></pre><p id="fa2e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我还添加了一些雾来提供更真实的效果。</p><p id="55f2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">就这样</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/c252b818d8feaaac3b7a98be60d969f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eWWh6jhPFITFYtkg"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Photo by <a class="ae mi" href="https://unsplash.com/@acharki95?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Aziz Acharki</a> on <a class="ae mi" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="58c7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">完整脚本</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="e5e3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">包含所有依赖项的HTML文件</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="74f3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">只用很少的几行代码，我们就可以实现这个很酷的效果，代码非常直观，不像我们为图形渲染编写自己的颜色。</p><p id="4219" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">快乐的编码和忙碌！！！</p><p id="845b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mq">更多内容尽在</em><a class="ae mi" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="mq">plain English . io</em></a></p></div></div>    
</body>
</html>