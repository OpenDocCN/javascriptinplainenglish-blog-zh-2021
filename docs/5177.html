<html>
<head>
<title>Next.js Firebase v9: Add a New To-Do</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Next.js Firebase v9:添加新的待办事项</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/nextjs-firebase-v9-part-5-add-a-new-todo-a45de9cc5418?source=collection_archive---------17-----------------------#2021-10-20">https://javascript.plainenglish.io/nextjs-firebase-v9-part-5-add-a-new-todo-a45de9cc5418?source=collection_archive---------17-----------------------#2021-10-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bdbd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第5部分:创建一个提交函数来添加新的待办事项</h2></div><p id="36f4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将添加提交功能来提交新的待办事项。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/72b4c0ff411bf8b307d37d169a6e6fea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*H5Rs7g40MxFnWjkx.png"/></div></figure><p id="1b2e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lj" href="https://youtu.be/A-Ce4YyHMGk" rel="noopener ugc nofollow" target="_blank">视频教程</a>和<a class="ae lj" href="https://www.udemy.com/course/complete-nextjs-firebase-firestore-course/?couponCode=FREESOURCE" rel="noopener ugc nofollow" target="_blank">源代码</a></p><p id="cd08" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们需要创建状态“todo”。我们将默认值设置为空标题和空细节。</p><pre class="lc ld le lf gt lk ll lm ln aw lo bi"><span id="f771" class="lp lq iq ll b gy lr ls l lt lu">import { useState } from "react";</span><span id="1eb7" class="lp lq iq ll b gy lv ls l lt lu">const [todo, setTodo] = useState({ title: '', detail: '' })</span></pre><p id="f0ad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将待办事项的值绑定到两个输入字段。设置onChange将使用新值设置todo如果这是设置标题，它将展开原来的todo并合并新的标题值。</p><pre class="lc ld le lf gt lk ll lm ln aw lo bi"><span id="bc43" class="lp lq iq ll b gy lr ls l lt lu">&lt;TextField</span><span id="cc62" class="lp lq iq ll b gy lv ls l lt lu">fullWidth</span><span id="5202" class="lp lq iq ll b gy lv ls l lt lu">label="Title"</span><span id="0f26" class="lp lq iq ll b gy lv ls l lt lu">margin="normal"</span><span id="553f" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">value={todo.title}</strong></span><span id="b208" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">onChange={e =&gt; setTodo({ ...todo, title: e.target.value })}</strong></span><span id="4c55" class="lp lq iq ll b gy lv ls l lt lu">/&gt;</span><span id="da85" class="lp lq iq ll b gy lv ls l lt lu">&lt;TextField</span><span id="8ab2" class="lp lq iq ll b gy lv ls l lt lu">fullWidth</span><span id="bf87" class="lp lq iq ll b gy lv ls l lt lu">label="Detail"</span><span id="47de" class="lp lq iq ll b gy lv ls l lt lu">multiline</span><span id="4392" class="lp lq iq ll b gy lv ls l lt lu">maxRows={4}</span><span id="8a8e" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">value={todo.detail}</strong></span><span id="4506" class="lp lq iq ll b gy lv ls l lt lu"><strong class="ll ir">onChange={e =&gt; setTodo({ ...todo, detail: e.target.value })}<br/>/&gt;</strong></span></pre><p id="b211" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们得到用户输入的待办事项。是时候创建onSubmit函数了，从我们的firebase配置文件导入数据库(db)。</p><pre class="lc ld le lf gt lk ll lm ln aw lo bi"><span id="89ba" class="lp lq iq ll b gy lr ls l lt lu">import { db } from "../firebase";</span></pre><p id="bd18" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们指定集合“todo ”,然后我们添加新的to-do，当前时间戳到该集合。</p><p id="a850" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果待办事项添加成功，它会提示一条带有文档id的消息。</p><pre class="lc ld le lf gt lk ll lm ln aw lo bi"><span id="6857" class="lp lq iq ll b gy lr ls l lt lu">const onSubmit = async () =&gt; {</span><span id="37d6" class="lp lq iq ll b gy lv ls l lt lu">const collectionRef = collection(db, "todos")</span><span id="d2b0" class="lp lq iq ll b gy lv ls l lt lu">const docRef = await addDoc(collectionRef, { ...todo, timestamp: serverTimestamp())<br/>setTodo({ title: '', detail: '' })</span><span id="5d76" class="lp lq iq ll b gy lv ls l lt lu">alert(`Todo with id ${docRef.id} is added successfully`)</span><span id="7e19" class="lp lq iq ll b gy lv ls l lt lu">}</span></pre><p id="73d3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们将onSubmit函数绑定到按钮上。</p><pre class="lc ld le lf gt lk ll lm ln aw lo bi"><span id="07b3" class="lp lq iq ll b gy lr ls l lt lu">&lt;Button sx={{ mt: 3 }} variant="contained"</span><span id="3626" class="lp lq iq ll b gy lv ls l lt lu">onClick={onSubmit}</span><span id="bb01" class="lp lq iq ll b gy lv ls l lt lu">&gt;Add a new Todo&lt;/Button&gt;</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lw"><img src="../Images/64db5fc7ba8cb66f7d42155adf630c27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9R3TrK3iXhRd-SkoTAXbMA.png"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mb"><img src="../Images/46caa4f58692c56f1d0d5a92d07487eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QhZHTKF8xV2sC3HQ5wbEeQ.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk">An alert appears if added successfully</figcaption></figure><h1 id="1aa6" class="mg lq iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">关注我们:<a class="ae lj" href="https://www.youtube.com/channel/UCu4-4FnutvSHVo9WHvq80Ww?sub_confirmation=1" rel="noopener ugc nofollow" target="_blank"> YouTube </a>，<a class="ae lj" href="https://ckmobile.medium.com/" rel="noopener"> Medium </a>，<a class="ae lj" href="https://www.udemy.com/user/cyruschan2/" rel="noopener ugc nofollow" target="_blank"> Udemy </a>，<a class="ae lj" href="https://www.linkedin.com/company/ckmobi/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>，<a class="ae lj" href="https://twitter.com/ckmobilejavasc1" rel="noopener ugc nofollow" target="_blank"> Twitter </a>，<a class="ae lj" href="https://www.instagram.com/ckmobile8050" rel="noopener ugc nofollow" target="_blank"> Instagram </a>，<a class="ae lj" href="https://app.gumroad.com/ckmobile" rel="noopener ugc nofollow" target="_blank"> Gumroad </a></h1><p id="06b6" class="pw-post-body-paragraph kf kg iq kh b ki mx jr kk kl my ju kn ko mz kq kr ks na ku kv kw nb ky kz la ij bi translated"><em class="nc">更多内容请看</em><a class="ae lj" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="nc">plain English . io</em></strong></a></p></div></div>    
</body>
</html>