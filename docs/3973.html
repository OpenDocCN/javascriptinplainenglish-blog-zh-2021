<html>
<head>
<title>Consuming GraphQL APIs in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React中使用GraphQL APIs</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/consuming-graphql-apis-in-react-4d195ccdab09?source=collection_archive---------13-----------------------#2021-08-09">https://javascript.plainenglish.io/consuming-graphql-apis-in-react-4d195ccdab09?source=collection_archive---------13-----------------------#2021-08-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/a90f4abc3137ba307e1b905c86070fe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AC96783_VV6QI-da"/></div></div></figure><div class=""/><div class=""><h2 id="f727" class="pw-subtitle-paragraph jy ja jb bd b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp dk translated">Urql Hooks &amp; Hasura即时云GraphQL API</h2></div><figure class="kr ks kt ku gt is gh gi paragraph-image"><div class="gh gi kq"><img src="../Images/bda2c774c6be75bb39d06b49468cc7ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/0*KHUAHJ0_B_E33iSf"/></div></figure><p id="0a01" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于显而易见的原因，React 是最受欢迎的前端框架(库),它有一个很棒的社区，有许多现成的包来解决每个任务，并允许快速组件驱动的开发，而没有复制粘贴代码的麻烦。</p><p id="2d9b" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">React没有为API请求提供内部解决方案，除了使用现在通过钩子覆盖的通用组件生命周期方法之外，也没有特定的准则可以遵循。这意味着由开发人员来决定消费API的最佳方式，无论是<a class="ae lr" href="https://restfulapi.net/" rel="noopener ugc nofollow" target="_blank"> REST </a>、<a class="ae lr" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> GraphQL </a>还是某些可疑的<a class="ae lr" href="https://www.fxcm.com/markets/insights/fix-api/" rel="noopener ugc nofollow" target="_blank">修复API </a>。</p><p id="6bf7" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将使用<a class="ae lr" href="https://hasura.io/" rel="noopener ugc nofollow" target="_blank"> Hasura </a>构建一个快速可靠的GraphQL API，在最流行的前端库React中使用它，并展示那里最可爱的动物<strong class="kx jc">狗</strong>。</p><h1 id="135b" class="ls lt jb bd lu lv lw lx ly lz ma mb mc kh md ki me kk mf kl mg kn mh ko mi mj bi translated">1.为什么选择GraphQL</h1><figure class="kr ks kt ku gt is gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/2eeafad5e637e45078fb038f25f30282.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/0*dHAQ5hrd3TtGnJmY"/></div></figure><p id="09be" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">基本上很快。极快的开发速度，开箱即用的API文档和选项，可以准确地请求您需要的资源量，或者将多个请求批处理为一个请求。它最初是由脸书开发的，然后作为一个社区项目继续进行，因此它非常适合用于另一个脸书开发的技术，如React。</p><h1 id="92ef" class="ls lt jb bd lu lv lw lx ly lz ma mb mc kh md ki me kk mf kl mg kn mh ko mi mj bi translated">2.什么是哈苏拉</h1><p id="58c8" class="pw-post-body-paragraph kv kw jb kx b ky ml kc la lb mm kf ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">托管GraphQL API的云服务，提供速度，增加API开发，并具有内置的身份验证和缓存。它有一个非常友好的图形用户界面，也有一个免费的计划来测试它的能力。</p><p id="6ec0" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">像其他云提供商一样，它要求我们选择定价方案、服务器位置和项目名称，然后我们可以启动控制台。</p><figure class="kr ks kt ku gt is gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/2e9ee8f759ab5b0277e5e38316896199.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/0*q3rZjhBhXOksNKmW"/></div></figure><p id="cbcb" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了非常快，我们将通过<a class="ae lr" href="https://dashboard.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>配置我们的数据库，只需遵循步骤，我们就有了一个免费的操场来构建我们的API。</p><figure class="kr ks kt ku gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mr"><img src="../Images/1e7c5c34f4c82a255c718b87abb0526d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iRGnGdCFB4FdEx80"/></div></div></figure><p id="8768" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">选择创建的数据库，并添加一个包含3列(id、名称、图像)的动物表。</p><figure class="kr ks kt ku gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ms"><img src="../Images/ae18258263591e6313dd5f145ff29fef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TGDOjOfD4fcUxz-w"/></div></div></figure><p id="1342" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们通过GUI插入一行，然后在我们的项目中进行测试，我们准备编写一些代码🤓。</p><figure class="kr ks kt ku gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/9e4034d2a780e7d7386c81eb0f165702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wRveRBfOZPb9ggNI"/></div></div></figure><p id="62fd" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们想处理查询或变异，我们总是可以使用<a class="ae lr" href="https://hasura.io/learn/graphql/hasura/data-modelling/2-try-user-queries/" rel="noopener ugc nofollow" target="_blank"> GraphiQL接口</a>，它为我们可以进行的查询或变异提供即时文档。</p><h1 id="f155" class="ls lt jb bd lu lv lw lx ly lz ma mb mc kh md ki me kk mf kl mg kn mh ko mi mj bi translated">3.<a class="ae lr" href="https://formidable.com/open-source/urql/" rel="noopener ugc nofollow" target="_blank"> Urql </a></h1><p id="0a47" class="pw-post-body-paragraph kv kw jb kx b ky ml kc la lb mm kf ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">一个<a class="ae lr" href="https://formidable.com/" rel="noopener ugc nofollow" target="_blank">强大的</a>(请原谅双关语)开源轻量级库，用于在React、Svelte、Vue甚至普通JavaScript项目中使用GraphQL APIs。尽管没有人阻止我们使用像<a class="ae lr" href="https://github.com/axios/axios" rel="noopener ugc nofollow" target="_blank"> axios </a>、<a class="ae lr" href="https://react-query.tanstack.com/" rel="noopener ugc nofollow" target="_blank"> react-query </a>甚至是基于浏览器的fetch API(或者其他GraphQL解决方案，如<a class="ae lr" href="https://www.apollographql.com/" rel="noopener ugc nofollow" target="_blank"> Apollo </a>或<a class="ae lr" href="https://relay.dev/" rel="noopener ugc nofollow" target="_blank"> Relay </a>，但是在这里查看<a class="ae lr" href="https://formidable.com/open-source/urql/docs/comparison/" rel="noopener ugc nofollow" target="_blank">以获得更多信息</a>，我相信urql将提高开发速度并隐藏解析的复杂性，使查询&amp;变异。</p><p id="6d00" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了开始使用urql &amp; graphql，我们在之前创建的<a class="ae lr" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> NextJS项目</a>上运行:</p><figure class="kr ks kt ku gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mu"><img src="../Images/8401b13fc610707e5d2d66860bc7e871.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K0vEbF1kBlTThDh52iG-XA.png"/></div></div></figure><p id="6dd2" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将应用程序根组件包装在urql提供程序中，并根据需要设置选项。</p><figure class="kr ks kt ku gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mv"><img src="../Images/b15d53e8202009bf30e8942fb9b3cd73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VenLdZXiEzTEwlsanKpoqw.png"/></div></div></figure><p id="df75" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在可以使用urql中的useQuery和useMutations挂钩来快速访问GraphQL Hasura托管的API，如下所示:</p><figure class="kr ks kt ku gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mw"><img src="../Images/f1494c9280fccd1c9e9f81cdba50520f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNlqB8Ggp_P751XAV_VJ7g.png"/></div></div></figure><p id="bca6" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在添加了一些用于最小样式的TailwindCSS类后，我们得到了</p><figure class="kr ks kt ku gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mx"><img src="../Images/a6f95dfa25bc964c776151c666e022ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fp4fHf5EVPeL95ybjpn0tg.png"/></div></div></figure><p id="2a7a" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">快乐的毛茸茸的节日🐶！</p><figure class="kr ks kt ku gt is gh gi paragraph-image"><div class="gh gi my"><img src="../Images/fabbd187e171adb08eef9913c74d4a7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/0*ix60Hl4wGTbSt9ut"/></div></figure><p id="7b73" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">React中使用Urql进行GraphQL查询和变异的简单、完整的工作示例。</p><p id="32c9" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">可以为urql配置更多选项，如持久性、SSR、调试、验证和测试，但这不是这个简单示例的目的，这个示例介绍了如何在React中快速使用API。</p><p id="2be5" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你想检查这个演示项目(替换api_url &amp; secret in _app.jsx)，这里是<a class="ae lr" href="https://codesandbox.io/s/react-graphql-urql-33u2f?file=/tailwind.config.js" rel="noopener ugc nofollow" target="_blank"> CodeSandbox </a>。</p><p id="3697" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我希望你喜欢这篇在React中使用GraphQL的简短教程，并希望你留下评论！</p><p id="0803" class="pw-post-body-paragraph kv kw jb kx b ky kz kc la lb lc kf ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="mz">更多内容请看</em><a class="ae lr" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kx jc"><em class="mz">plain English . io</em></strong></a></p></div></div>    
</body>
</html>