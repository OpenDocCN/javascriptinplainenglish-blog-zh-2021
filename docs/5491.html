<html>
<head>
<title>How to Upload Files to Amazon S3 using Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨Node.jså°†æ–‡ä»¶ä¸Šä¼ åˆ°äºšé©¬é€ŠS3</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/file-upload-to-amazon-s3-using-node-js-42757c6a39e9?source=collection_archive---------2-----------------------#2021-11-14">https://javascript.plainenglish.io/file-upload-to-amazon-s3-using-node-js-42757c6a39e9?source=collection_archive---------2-----------------------#2021-11-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/1d1d0ae058a8fce8bcd52260a82e3647.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fz8BHPwSE1Yak9YsO4nYIw.jpeg"/></div></div></figure><p id="7852" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£å¦‚ä½•ä½¿ç”¨Node.jså’ŒExpresså°†æ–‡ä»¶æ¨é€åˆ°AWS S3ã€‚</p><h1 id="7f62" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">å…ˆå†³æ¡ä»¶:</h1><ol class=""><li id="085b" class="lr ls in jx b jy lt kc lu kg lv kk lw ko lx ks ly lz ma mb bi translated">ä¸€ä¸ª<a class="ae mc" href="https://ap-south-1.console.aws.amazon.com/console/home?region=ap-south-1" rel="noopener ugc nofollow" target="_blank"> AWSè´¦æˆ·</a>ã€‚</li><li id="6e2d" class="lr ls in jx b jy md kc me kg mf kk mg ko mh ks ly lz ma mb bi translated">åŸºæœ¬å¿«é€Ÿè®¾ç½®å°†ä½¿ç”¨Multeråœ¨åç«¯ä¸Šä¼ æ–‡ä»¶ã€‚å¦‚æœæƒ³äº†è§£Node.jsä¸­åŸºæœ¬çš„æ–‡ä»¶ä¸Šä¼ ï¼Œå¯ä»¥é˜…è¯»<a class="ae mc" rel="noopener ugc nofollow" target="_blank" href="/uploading-files-in-node-js-using-multer-754526aa6817">è¿™ä¸ª</a>ã€‚</li></ol></div><div class="ab cl mi mj hr mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ig ih ii ij ik"><p id="b56c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">æœ¬æ–‡å°†åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†:</p><p id="19e7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">1.åˆ›å»ºAWS S3å­˜å‚¨æ¡¶å¹¶èµ‹äºˆå…¶é€‚å½“çš„æƒé™ã€‚</p><p id="f777" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">2.ä½¿ç”¨JavaScriptä»AWS S3ä¸Šä¼ å’Œè¯»å–æ–‡ä»¶ã€‚</p><h1 id="850d" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">1.åˆ›å»ºAWS S3å­˜å‚¨æ¡¶å¹¶èµ‹äºˆå…¶é€‚å½“çš„æƒé™</h1><p id="fcd2" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg mp ki kj kk mq km kn ko mr kq kr ks ig bi translated"><strong class="jx io"> a .åˆ›å»ºS3æ¡¶</strong></p><p id="dcb0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç™»å½•AWSæ§åˆ¶å°ï¼Œæœç´¢S3æœåŠ¡</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/456544966544ab85531f552c3b7a4e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nPeyNC8zBAWoGJVpKHBatw.png"/></div></div></figure><p id="2a24" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’åˆ›å»ºä¸€ä¸ªæ¡¶ã€‚å•å‡»åˆ›å»ºå­˜å‚¨æ¡¶ã€‚</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/dbc59be8fa370f6db824accaceaf5ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CQp4rmkvBxQcDiVgOAdZwA.png"/></div></div></figure><p id="75d4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’å†™ä¸‹æ‚¨çš„<strong class="jx io">æ¡¶å</strong>å’Œ<strong class="jx io"> AWSåŒºåŸŸ</strong>ã€‚å•å‡»åˆ›å»ºå­˜å‚¨æ¡¶æŒ‰é’®</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/30fc0816feaf49bf54f4dfe8fa0b82ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mqDfxB1PMaVVwpeulvAL5g.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/09f175bdc3eb603e52fc58ad84bbc1d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zX8h7xd4v9FWIzBMYcDIQA.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/f43fc0fcf109fd4e5acdff14f34a22f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*15Mp3XuSJS9zoipkKVI7fg.png"/></div></div></figure><p id="5fc8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’æ¡¶å·²æˆåŠŸåˆ›å»ºã€‚æˆ‘ä»¬å°†ä½¿ç”¨Node.jså°†æ–‡ä»¶ä¸Šä¼ åˆ°è¿™ä¸ªæ¡¶ä¸­</p><p id="1c3e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’åœ¨Node.jsåº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬éœ€è¦å­˜å‚¨æ¡¶åç§°å’ŒåŒºåŸŸã€‚</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/09ecdfc283288e3b1aac340e1156ea7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xS6SPtrbpLjDu7DYaTbBNQ.png"/></div></div></figure><p id="cf39" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç”±äºæˆ‘ä»¬æ˜¯è¿™ä¸ªS3å­˜å‚¨æ¡¶çš„åˆ›å»ºè€…ï¼Œæˆ‘å¯ä»¥ä»AWSæ§åˆ¶å°è¯»å–ã€å†™å…¥ã€åˆ é™¤å’Œæ›´æ–°ã€‚å¦‚æœæˆ‘ä»¬æƒ³åœ¨å¿«é€’æœåŠ¡å™¨ä¸Šåšã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨IAMç­–ç•¥æˆäºˆä¸€äº›æƒé™ã€‚</p><p id="00eb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> b .åˆ›å»ºIAMç­–ç•¥:</strong></p><p id="ec90" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’è½¬åˆ°AWSä¸­çš„IAMæœåŠ¡</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/60f15e51ebeb481fccf41ff94d37a466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-hH9AdCRamq2tTNiWZUJ3g.png"/></div></div></figure><p id="2fc1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç‚¹å‡»æ”¿ç­–</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/af1707f326bca8d9593bdd6d331ae702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cv4VSRC1cRdQuUwXFQAvSA.png"/></div></div></figure><p id="5142" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç‚¹å‡»åˆ›å»ºç­–ç•¥æŒ‰é’®</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/4571baee0f0aa8d67571046c9e65a6d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CYbfsWv3cvOsdV6eFGrBFg.png"/></div></div></figure><p id="73dc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’æˆ‘ä»¬ç°åœ¨å°†åˆ›å»ºæˆ‘ä»¬çš„ç­–ç•¥ã€‚è¿™æ˜¯æˆ‘ä»¬æ–°åˆ›å»ºçš„bucketæ‰€ç‰¹æœ‰çš„ã€‚</p><p id="5116" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç‚¹å‡»é€‰æ‹©æœåŠ¡å¹¶é€‰æ‹©S3</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/6f3c5ef369081b6c52df75f958e22998.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XiazAOZCRZPJjhRHnMl-bw.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/c49cf38509ff3d4f5cd5be9bdd2c54b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ma_WEbZ9TA4UJDVag3hXag.png"/></div></div></figure><p id="15bb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’æˆ‘ä»¬å¯ä»¥ç»™äºˆæ¡¶è®¸å¤šS3æƒé™ã€‚å¯¹äºä¸Šä¼ å’Œé˜…è¯»ä»¥ä¸‹æƒé™å°†è¶³å¤Ÿäº†</p><blockquote class="mx my mz"><p id="32ee" class="jv jw na jx b jy jz ka kb kc kd ke kf nb kh ki kj nc kl km kn nd kp kq kr ks ig bi translated">getObject â€”ä»S3é˜…è¯»</p><p id="b5c4" class="jv jw na jx b jy jz ka kb kc kd ke kf nb kh ki kj nc kl km kn nd kp kq kr ks ig bi translated">putObject â€”ç»™S3å†™ä¿¡</p><p id="0109" class="jv jw na jx b jy jz ka kb kc kd ke kf nb kh ki kj nc kl km kn nd kp kq kr ks ig bi translated">åˆ é™¤å¯¹è±¡â€”ä»S3åˆ é™¤</p></blockquote><p id="de10" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç‚¹å‡»å†™å…¥å¹¶é€‰æ‹©<strong class="jx io">æ”¾ç½®å¯¹è±¡</strong>å’Œ<strong class="jx io">åˆ é™¤å¯¹è±¡</strong></p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/f86fd206c4d2ec240a8b630f45c1bc18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4lF71QckIic0IzjQcih_2g.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/400cf018f77ad64c5dc469080fbe5070.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uOAqPMj4IUXbX5o3CAhsMw.png"/></div></div></figure><p id="d7a0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç‚¹å‡»è¯»å–å¹¶é€‰æ‹©getObject</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/f8c7a3b166564c511b47636a31582a6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5nNzultdI-47u_6LRdzE5A.png"/></div></div></figure><p id="d95b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ä¸‹ä¸€æ­¥æ˜¯æ·»åŠ ARNã€‚ARNçš„æ„æ€æ˜¯ä½ æ–—èº«ä»½</p><pre class="mt mu mv mw gt ne nf ng nh aw ni bi"><span id="a069" class="nj ku in nf b gy nk nl l nm nn"> arn:aws::s3:::&lt;your_bucket_name&gt;       // ARN SYNTAX</span></pre><p id="214b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">arn:was::S3::::AWS-æ¯æ—¥é”€å”®</p><p id="d9bc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’æˆ‘ä»¬é€‰æ‹©ç‰¹å®šçš„ARNï¼Œå› ä¸ºè¿™äº›è§„åˆ™å°†åº”ç”¨äºç‰¹å®šçš„S3æ—¶æ®µã€‚</p><p id="59ea" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç‚¹å‡»æ·»åŠ arn</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/ab32f1433e401904258a441bc8504bb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dz0MKRwap0xj6Kn5moySMg.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/2fad5dbe0d2e4b65ea1162e6ea941536.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1NQZtN2A4vGgQMcHb3Cllw.png"/></div></div></figure><p id="a62b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç²˜è´´æ‚¨çš„å­˜å‚¨æ¡¶åç§°ï¼Œå¹¶å‹¾é€‰ä»»ä½•å¯¹è±¡åç§°ã€‚</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/2afb4b6d80024945cde2e3c69a336d87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D_YYvHHftd2U92jDcGMVPg.png"/></div></div></figure><p id="2f1f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’æˆ‘ä»¬ç°åœ¨åŠ çƒ­å‡ ä¸ªä¸‹ä¸€æ­¥æŒ‰é’®</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/fe794d0e2351281cf5720865249ddac7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z8568LjfKepFkvvGvzzf-w.png"/></div></div></figure><p id="0684" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç‚¹å‡»<strong class="jx io">åˆ›å»ºç­–ç•¥</strong></p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/9f248b713e29773e5a72bd3ef0822364.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y5arOZDa_9ahTSvYiKP5QQ.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/b8ae01f33b3173803e9f18f5d28694c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*efD4rBa2YdvyoFMTa5kzcA.png"/></div></div></figure><p id="01fd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’æˆ‘ä»¬ç°åœ¨çœ‹åˆ°æˆ‘ä»¬çš„ç­–ç•¥å·²åˆ›å»ºã€‚å®ƒå…·æœ‰è¯»å–ã€å†™å…¥å’Œåˆ é™¤æƒé™ã€‚</p><p id="c3da" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> c .åˆ›å»ºä¸€ä¸ªIAMç”¨æˆ·:</strong></p><p id="d3a3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’è¿™å¯ä»¥æ˜¯è®¿é—®S3æ¡¶çš„ç‰©ç†ç”¨æˆ·æˆ–ä»£ç ã€‚</p><p id="15f8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç‚¹å‡»IAMå·¦ä¾§æµè§ˆå™¨ä¸­çš„ç”¨æˆ·</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/0026cd063266b8a6748c536b34e981af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZVXEafyQ_vwSGQ1cHg3idg.png"/></div></div></figure><p id="ef73" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç‚¹å‡»æ·»åŠ ç”¨æˆ·</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/a0e604b847919751543b53fba216ba9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8PP6jZCdBBgobYJpWqS-uA.png"/></div></div></figure><p id="6d54" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’å†™ä¸‹ç”¨æˆ·çš„åå­—ã€‚å› ä¸ºæˆ‘ä»¬çš„å¿«é€Ÿåº”ç”¨ç¨‹åºå°†è®¿é—®S3ã€‚</p><p id="7edb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">ç»™äºˆ<strong class="jx io">ç¼–ç¨‹è®¿é—®</strong>æ„å‘³ç€<strong class="jx io">ä»£ç /æœåŠ¡å™¨</strong>æ˜¯<strong class="jx io">ç”¨æˆ·</strong>å°†è®¿é—®å®ƒã€‚å¯¹äºæˆ‘ä»¬çš„case Node.jsåº”ç”¨</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/313b874131d163b3916c8f1c29003e9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lIKoqEgrlGT4dCCOQ6PB_g.png"/></div></div></figure><p id="950a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’æœ€åï¼Œæˆ‘ä»¬å°†è·å¾—åœ¨JavaScriptåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„<strong class="jx io">è®¿é—®å¯†é’¥Idå’Œå¯†é’¥</strong>ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/a0f076840a73e330e12c2c97ab66d013.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*steqDYUaDkMp2JaTPqYyJA.png"/></div></div></figure><p id="d42d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’åœ¨ç¬¬ä¸‰ä¸ªé€‰é¡¹å¡ä¸­ï¼Œæˆ‘ä»¬é™„åŠ äº†ä¸Šé¢åˆ›å»ºçš„IAMç­–ç•¥ã€‚æˆ‘ä»¬ç°åœ¨å•å‡»å‡ ä¸ªâ€œä¸‹ä¸€æ­¥â€æŒ‰é’®</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/e8a2d1bda0d3dc9082f8deb2c169a09c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LG-Gfpxftq38XcIbtAQ8A.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/ceaebd5047f1a257a8e00877b875b762.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-KUqmUS3uGhcE6qo03QpVw.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/93acf0ed9c2ca9f5ea846d15243b1302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WvnEi5DqKsDly1jmwKmDoA.png"/></div></div></figure><p id="1d63" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç‚¹å‡»åˆ›å»ºç”¨æˆ·æŒ‰é’®</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/c2815a460a38ca5cd4da368f09d7cd60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cU1WvwLUurBxSuJRB3UA9Q.png"/></div></div></figure><p id="29cb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’æˆ‘ä»¬è·å¾—<strong class="jx io">è®¿é—®å¯†é’¥Idå’Œå¯†é’¥</strong>(å‡ºäºå®‰å…¨åŸå› ï¼Œä¸è¦ä¸ä»»ä½•äººå…±äº«æ‚¨çš„å¯†é’¥)</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/dc1b7250806ca6d67e94235236351b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hhYdOb9fJbTtlPYpWoREKg.png"/></div></div></figure><p id="22b9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç²˜è´´æ‚¨çš„ã€‚åº”ç”¨ç¨‹åºçš„envæ–‡ä»¶</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ms"><img src="../Images/f4cb9da573dd4fa1233be415abd8c7d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6aRAiQXRBhdPCj6iBnqNlA.png"/></div></div></figure><p id="be3a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ä¸‹ä¸€æ­¥æ˜¯å†™ä¸€äº›javascriptä»£ç ï¼Œå‘S3è¯»å†™ä»£ç ã€‚</p></div><div class="ab cl mi mj hr mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ig ih ii ij ik"><h1 id="043d" class="kt ku in bd kv kw no ky kz la np lc ld le nq lg lh li nr lk ll lm ns lo lp lq bi translated">2.ä½¿ç”¨JavaScriptä»AWS S3ä¸Šä¼ å’Œè¯»å–æ–‡ä»¶</h1><p id="f6fa" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg mp ki kj kk mq km kn ko mr kq kr ks ig bi translated"><strong class="jx io"> a .æ–‡ä»¶ä¸Šä¼ æ¦‚è¦(ä½¿ç”¨Multer): </strong></p><p id="8baa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ Expressæœ‰ä¸¤ç§å‘å¸ƒè·¯å¾„â€”â€”å•æ¡å’Œå¤šæ¡ï¼Œåˆ†åˆ«ä½¿ç”¨Multerä¸Šä¼ å•å¹…å’Œå¤šå¹…å›¾åƒã€‚</p><p id="2d2e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’å›¾åƒä¿å­˜åœ¨æœåŠ¡å™¨/å…¬å…±/å›¾åƒä¸­ã€‚</p><p id="8ea7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’åˆ©ç”¨å‰ç«¯è°ƒç”¨ä¸¤æ¡è·¯çº¿çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åº</p><p id="7c25" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">å®Œæ•´æ–‡ç« è¯·åœ¨è¿™é‡Œ<a class="ae mc" rel="noopener ugc nofollow" target="_blank" href="/uploading-files-in-node-js-using-multer-754526aa6817">é˜…è¯»ã€‚</a></p><p id="81a1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> b .å°†AWSä¸Expressé›†æˆ</strong></p><p id="5934" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’åˆ›å»ºã€‚envæ–‡ä»¶å¹¶ç²˜è´´æ‚¨çš„AWSå‡­è¯</p><pre class="mt mu mv mw gt ne nf ng nh aw ni bi"><span id="eb01" class="nj ku in nf b gy nk nl l nm nn">AWS_BUCKET_NAME="aws-daily-files"<br/>AWS_BUCKET_REGION="ap-south-1"<br/>AWS_ARN=arn:aws:s3:::aws-daily-files<br/>AWS_ACCESS_KEY=AKIAS3D3V2NC4EJAMEEZ<br/>AWS_SECRET_KEY=3WE************************pcH</span></pre><p id="a96c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…AWS SDK</p><pre class="mt mu mv mw gt ne nf ng nh aw ni bi"><span id="4550" class="nj ku in nf b gy nk nl l nm nn">npm install aws-sdk dotenv</span></pre><p id="dceb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’åœ¨åº”ç”¨ç¨‹åºä¸­åˆ›å»ºs3.jsæ–‡ä»¶</p><p id="cc9a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">c.ç»™S3å†™ä¿¡:</p><pre class="mt mu mv mw gt ne nf ng nh aw ni bi"><span id="ac3a" class="nj ku in nf b gy nk nl l nm nn"><strong class="nf io">require</strong>("dotenv").<strong class="nf io">config</strong>();</span><span id="39b3" class="nj ku in nf b gy nt nl l nm nn">const <strong class="nf io">S3</strong> = <strong class="nf io">require</strong>("aws-sdk/clients/s3");</span><span id="01bc" class="nj ku in nf b gy nt nl l nm nn">const <strong class="nf io">fs</strong> = <strong class="nf io">require</strong>("fs");</span><span id="52ed" class="nj ku in nf b gy nt nl l nm nn">const bucketName = process.env.AWS_BUCKET_NAME;</span><span id="316d" class="nj ku in nf b gy nt nl l nm nn">const region = process.env.AWS_BUCKET_REGION;</span><span id="4b44" class="nj ku in nf b gy nt nl l nm nn">const accessKeyId = process.env.AWS_ACCESS_KEY;</span><span id="ecc8" class="nj ku in nf b gy nt nl l nm nn">const secretAccessKey = process.env.AWS_SECRET_KEY;</span><span id="6b9c" class="nj ku in nf b gy nt nl l nm nn">const s3 = new <strong class="nf io">S3</strong>({</span><span id="a027" class="nj ku in nf b gy nt nl l nm nn">  region,</span><span id="3700" class="nj ku in nf b gy nt nl l nm nn">  accessKeyId,</span><span id="4ea4" class="nj ku in nf b gy nt nl l nm nn">  secretAccessKey,</span><span id="e9ad" class="nj ku in nf b gy nt nl l nm nn">});<br/></span><span id="3582" class="nj ku in nf b gy nt nl l nm nn"><em class="na">// UPLOAD FILE TO S3</em></span><span id="d4c5" class="nj ku in nf b gy nt nl l nm nn">function <strong class="nf io">uploadFile</strong>(file) {</span><span id="2f22" class="nj ku in nf b gy nt nl l nm nn">  const fileStream = <strong class="nf io">fs</strong>.<strong class="nf io">createReadStream</strong>(file.path);</span><span id="7a6d" class="nj ku in nf b gy nt nl l nm nn">  const uploadParams = {</span><span id="184f" class="nj ku in nf b gy nt nl l nm nn">    Bucket: bucketName,</span><span id="7836" class="nj ku in nf b gy nt nl l nm nn">    Body: fileStream,</span><span id="37d7" class="nj ku in nf b gy nt nl l nm nn">    Key: file.filename,</span><span id="b906" class="nj ku in nf b gy nt nl l nm nn">  };</span><span id="ff29" class="nj ku in nf b gy nt nl l nm nn">return s3.<strong class="nf io">upload</strong>(uploadParams).<strong class="nf io">promise</strong>(); // this will upload file to S3</span><span id="fc33" class="nj ku in nf b gy nt nl l nm nn">}</span><span id="addd" class="nj ku in nf b gy nt nl l nm nn">module.exports = { <strong class="nf io">uploadFile </strong>};</span></pre><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/41f31daec572c2a8e2257f258dc29070.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JqNPyzQ66rQpUJ8C1bwNtQ.png"/></div></div></figure><p id="69ad" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç°åœ¨è½¬åˆ°æ‚¨çš„è·¯çº¿æ–‡ä»¶</p><p id="6fca" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">æœåŠ¡å™¨/è·¯ç”±å™¨/ç´¢å¼•. js</p><pre class="mt mu mv mw gt ne nf ng nh aw ni bi"><span id="dc38" class="nj ku in nf b gy nk nl l nm nn">var <strong class="nf io">express</strong> = <strong class="nf io">require</strong>("express");</span><span id="5195" class="nj ku in nf b gy nt nl l nm nn">var router = <strong class="nf io">express</strong>.<strong class="nf io">Router</strong>();</span><span id="df8d" class="nj ku in nf b gy nt nl l nm nn">const upload = <strong class="nf io">require</strong>("../common");</span><span id="6120" class="nj ku in nf b gy nt nl l nm nn">const { <strong class="nf io">uploadFile </strong>} = <strong class="nf io">require</strong>("../s3");</span><span id="bf29" class="nj ku in nf b gy nt nl l nm nn">const <strong class="nf io">fs</strong> = <strong class="nf io">require</strong>("fs");</span><span id="fe7e" class="nj ku in nf b gy nt nl l nm nn">const <strong class="nf io">util</strong> = <strong class="nf io">require</strong>("util");</span><span id="d02d" class="nj ku in nf b gy nt nl l nm nn">const <strong class="nf io">unlinkFile</strong> = <strong class="nf io">util</strong>.<strong class="nf io">promisify</strong>(<strong class="nf io">fs</strong>.<strong class="nf io">unlink</strong>);<br/></span><span id="dabc" class="nj ku in nf b gy nt nl l nm nn">router.<strong class="nf io">post</strong>("/single", upload.<strong class="nf io">single</strong>("image"), async (req, res) =&gt; {</span><span id="2918" class="nj ku in nf b gy nt nl l nm nn">  console.<strong class="nf io">log</strong>(req.file);</span><span id="6f3c" class="nj ku in nf b gy nt nl l nm nn"><em class="na">  // uploading to AWS S3</em></span><span id="7618" class="nj ku in nf b gy nt nl l nm nn">  const result = await <strong class="nf io">uploadFile</strong>(req.file);  // Calling above function in s3.js</span><span id="3194" class="nj ku in nf b gy nt nl l nm nn">  console.<strong class="nf io">log</strong>("S3 response", result);</span><span id="271c" class="nj ku in nf b gy nt nl l nm nn"><em class="na">  // You may apply filter, resize image before sending to client</em></span><span id="e725" class="nj ku in nf b gy nt nl l nm nn"><em class="na">  // Deleting from local if uploaded in S3 bucket</em></span><span id="e466" class="nj ku in nf b gy nt nl l nm nn">  await <strong class="nf io">unlinkFile</strong>(req.file.path);</span><span id="4426" class="nj ku in nf b gy nt nl l nm nn">  res.<strong class="nf io">send</strong>({</span><span id="a28b" class="nj ku in nf b gy nt nl l nm nn">    status: "success",</span><span id="5225" class="nj ku in nf b gy nt nl l nm nn">    message: "File uploaded successfully",</span><span id="368a" class="nj ku in nf b gy nt nl l nm nn">    data: req.file,</span><span id="3cc9" class="nj ku in nf b gy nt nl l nm nn">  });</span><span id="0e32" class="nj ku in nf b gy nt nl l nm nn">});</span><span id="8dcf" class="nj ku in nf b gy nt nl l nm nn">module.exports = router;</span></pre><p id="ba19" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<a class="ae mc" href="https://github.com/AmirMustafa/upload_file_nodejs/blob/master/client/src/App.js" rel="noopener ugc nofollow" target="_blank">åŸºæœ¬å‰ç«¯</a>,å®ƒå‘é€æ•°æ®ä»¥è¡¨ç¤ºåå¤šéƒ¨åˆ†æ•°æ®</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/56a947316cae02acb8e5c60fc75e56b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EtkBp5IcsrYVzIjcgiqB2Q.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/c27eb1d315e92ea37f95d641e990c002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ktvtDRW-mZ6vodzSMt0VfQ.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/8d764c8e76ad3ebeca11b2885a0fb161.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VMRw6YSqzqokWTpb1XVbsw.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nv"><img src="../Images/3a1bb4a40646861097a1c470a2544f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mcQlHg62y8EW2QULB0ndXw.png"/></div></div></figure><p id="23d6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ä»S3è¯»å–æ•°æ®å¹¶åœ¨å®¢æˆ·ç«¯æ‰“å°å¦‚ä¸‹ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°æ•°æ®å°†è¢«ä¸Šä¼ ï¼Œä¹Ÿæ˜¯åœ¨è‡ªåŠ¨æ°”è±¡ç«™æ§åˆ¶å°çš„S3æ¡¶ã€‚</p><p id="9883" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">ä¸Šä¼ å‰çš„AWSæ§åˆ¶å°</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nw"><img src="../Images/397b63e5fd5b2b710e5f958ec5fb4142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*juqLhnK0BjJzH2UHPsNT6g.png"/></div></div></figure><p id="7567" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ç‚¹å‡»å‘é€åˆ°åç«¯æŒ‰é’®</p><p id="33ea" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’åœ¨Node.jsæœåŠ¡å™¨ç»ˆç«¯ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ä»S3æ‰“å°çš„å“åº”ã€‚è¿™é‡Œçš„å…³é”®å­—æ˜¯æ–‡ä»¶åï¼Œè·¯å¾„æ˜¯æ–‡ä»¶çš„ä½ç½®ã€‚</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/8c1063f1652422ec11be5116ae439fdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xS8jr57JA8AJSZOjsqnhRg.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nx"><img src="../Images/71a4b5c8d087e98ad2dcb0833af4d986.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pWB6zSC6wHzl4O8wbvdvdg.png"/></div></div></figure><p id="d5c5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹S3ã€‚æˆ‘ä»¬çœ‹åˆ°S3ä¸Šä¼ äº†ä¸€ä¸ªæ–°æ–‡ä»¶</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/0f0e6010e1f260579224e450fdd3fdef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6xuO6lkD-IMqnlNaZ7kMpA.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/a266843efad6f390a6ab9298dc488dc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q08CWU1Z4xoB2SMMZEon5Q.png"/></div></div></figure><p id="df72" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">d.æ­£åœ¨ä»S3è¯»å–æ–‡ä»¶:</p><p id="e37c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’æˆ‘ä»¬ä»ä¸Šå›¾ä¸­çœ‹åˆ°ï¼Œæ–°å›¾åƒåæ˜ äº†æ¥è‡ªS3çš„å®¢æˆ·ç«¯ã€‚è®©æˆ‘ä»¬ä¸ºå®ƒç¼–å†™ä»£ç ã€‚</p><p id="fae8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">server/s3.js</p><pre class="mt mu mv mw gt ne nf ng nh aw ni bi"><span id="e315" class="nj ku in nf b gy nk nl l nm nn"><strong class="nf io">require</strong>("dotenv").<strong class="nf io">config</strong>();</span><span id="c472" class="nj ku in nf b gy nt nl l nm nn">const <strong class="nf io">S3</strong> = <strong class="nf io">require</strong>("aws-sdk/clients/s3");</span><span id="3479" class="nj ku in nf b gy nt nl l nm nn">const <strong class="nf io">fs</strong> = <strong class="nf io">require</strong>("fs");</span><span id="56e9" class="nj ku in nf b gy nt nl l nm nn">const bucketName = process.env.AWS_BUCKET_NAME;</span><span id="def9" class="nj ku in nf b gy nt nl l nm nn">const region = process.env.AWS_BUCKET_REGION;</span><span id="1ceb" class="nj ku in nf b gy nt nl l nm nn">const accessKeyId = process.env.AWS_ACCESS_KEY;</span><span id="ba24" class="nj ku in nf b gy nt nl l nm nn">const secretAccessKey = process.env.AWS_SECRET_KEY;</span><span id="1500" class="nj ku in nf b gy nt nl l nm nn">const s3 = new <strong class="nf io">S3</strong>({<br/>  region,<br/>  accessKeyId,<br/>  secretAccessKey,<br/>});</span><span id="e75b" class="nj ku in nf b gy nt nl l nm nn"><em class="na">// DOWNLOAD FILE FROM S3</em></span><span id="0915" class="nj ku in nf b gy nt nl l nm nn">function <strong class="nf io">getFileStream</strong>(fileKey) {</span><span id="ee06" class="nj ku in nf b gy nt nl l nm nn">  const downloadParams = {</span><span id="abab" class="nj ku in nf b gy nt nl l nm nn">  Key: fileKey,</span><span id="7b0d" class="nj ku in nf b gy nt nl l nm nn">  Bucket: bucketName,</span><span id="6a46" class="nj ku in nf b gy nt nl l nm nn">};</span><span id="1b22" class="nj ku in nf b gy nt nl l nm nn">return s3.<strong class="nf io">getObject</strong>(downloadParams).<strong class="nf io">createReadStream</strong>();</span><span id="15bf" class="nj ku in nf b gy nt nl l nm nn">}</span><span id="16d0" class="nj ku in nf b gy nt nl l nm nn">module.exports = { <strong class="nf io">uploadFile</strong>, <strong class="nf io">getFileStream</strong> };</span></pre><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/18533d3c3cd3982d4ba104c059b0ccb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Lf4vr3pVzP5vG9GZ4Q4pw.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/9d24296f16bcc6996ab332256a7ad6fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bp5QDtFawhGuvE2i5zEaAg.png"/></div></div></figure><p id="de38" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’ä½¿ç”¨æ­¤åŠŸèƒ½è·¯çº¿</p><p id="d24c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">æœåŠ¡å™¨/è·¯ç”±/ç´¢å¼•. js</p><pre class="mt mu mv mw gt ne nf ng nh aw ni bi"><span id="f696" class="nj ku in nf b gy nk nl l nm nn">var <strong class="nf io">express</strong> = <strong class="nf io">require</strong>("express");</span><span id="640b" class="nj ku in nf b gy nt nl l nm nn">var router = <strong class="nf io">express</strong>.<strong class="nf io">Router</strong>();</span><span id="4571" class="nj ku in nf b gy nt nl l nm nn">const upload = <strong class="nf io">require</strong>("../common");</span><span id="18ba" class="nj ku in nf b gy nt nl l nm nn">const { <strong class="nf io">uploadFile</strong>, <strong class="nf io">getFileStream</strong> } = <strong class="nf io">require</strong>("../s3");</span><span id="afd0" class="nj ku in nf b gy nt nl l nm nn">const <strong class="nf io">fs</strong> = <strong class="nf io">require</strong>("fs");</span><span id="3d04" class="nj ku in nf b gy nt nl l nm nn">const <strong class="nf io">util</strong> = <strong class="nf io">require</strong>("util");</span><span id="b1dd" class="nj ku in nf b gy nt nl l nm nn">const <strong class="nf io">unlinkFile</strong> = <strong class="nf io">util</strong>.<strong class="nf io">promisify</strong>(<strong class="nf io">fs</strong>.<strong class="nf io">unlink</strong>);</span><span id="c0f6" class="nj ku in nf b gy nt nl l nm nn"><br/>router.<strong class="nf io">get</strong>("/images/:key", (req, res) =&gt; {</span><span id="a156" class="nj ku in nf b gy nt nl l nm nn">  const key = req.params.key;</span><span id="8230" class="nj ku in nf b gy nt nl l nm nn">  console.<strong class="nf io">log</strong>(req.params.key);</span><span id="f6ac" class="nj ku in nf b gy nt nl l nm nn">  const readStream = <strong class="nf io">getFileStream</strong>(key);</span><span id="e7c3" class="nj ku in nf b gy nt nl l nm nn">  readStream.<strong class="nf io">pipe</strong>(res);  // this line will make image readable</span><span id="5bb8" class="nj ku in nf b gy nt nl l nm nn">});</span><span id="df1e" class="nj ku in nf b gy nt nl l nm nn">// eg &lt;serverurl&gt;/images/<a class="ae mc" href="https://s3.console.aws.amazon.com/s3/object/aws-daily-files?region=ap-south-1&amp;prefix=1636897090753-Coffee_book.jpeg" rel="noopener ugc nofollow" target="_blank">1636897090753-Coffee_book.jpeg</a> // to be used in client</span></pre><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/af655a5a813b66886623c0d0e2cf9c53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dA9T-1Qf4Mv0JX3nB5ZWbA.png"/></div></div></figure><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/fcb9b96e65f3fd678f67d4d2c1af2ae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xo8pgp8ovuQL7f9gsCTXQQ.png"/></div></div></figure><p id="f5e3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">â†’åœ¨å‰ç«¯ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨<strong class="jx io"> S3å“åº”é”®</strong>å¹¶åœ¨å®¢æˆ·ç«¯ä½¿ç”¨</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/56a947316cae02acb8e5c60fc75e56b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EtkBp5IcsrYVzIjcgiqB2Q.png"/></div></div></figure><h1 id="7dfe" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">è§†é¢‘:</h1><p id="0ef5" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg mp ki kj kk mq km kn ko mr kq kr ks ig bi translated"><a class="ae mc" href="https://secure.vidyard.com/organizations/1904214/players/pkYErcDdJVXuoBrcn8Tcgs?edit=true&amp;npsRecordControl=1" rel="noopener ugc nofollow" target="_blank">https://secure . vidyard . com/organizations/1904 214/players/pkyercdjvxuobrcn 8 tcgsï¼Ÿedit = true&amp;npsRecordControl = 1</a></p><h1 id="8e66" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">å­˜å‚¨åº“:</h1><p id="67db" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg mp ki kj kk mq km kn ko mr kq kr ks ig bi translated"><a class="ae mc" href="https://github.com/AmirMustafa/upload_file_nodejs" rel="noopener ugc nofollow" target="_blank">https://github.com/AmirMustafa/upload_file_nodejs</a></p><h1 id="1046" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">ç»“æŸè¯­:</h1><p id="61c3" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg mp ki kj kk mq km kn ko mr kq kr ks ig bi translated">æˆ‘ä»¬å·²ç»å­¦ä¹ äº†å¦‚ä½•ä»AWS S3å­˜å‚¨æ¡¶ä¸Šä¼ å’Œè¯»å–æ–‡ä»¶ã€‚</p><blockquote class="mx my mz"><p id="5518" class="jv jw na jx b jy jz ka kb kc kd ke kf nb kh ki kj nc kl km kn nd kp kq kr ks ig bi translated">è°¢è°¢ä½ ä¸€ç›´è¯»åˆ°æœ€åğŸ™Œã€‚å¦‚æœæ‚¨å–œæ¬¢è¿™ç¯‡æ–‡ç« æˆ–å­¦åˆ°äº†æ–°ä¸œè¥¿ï¼Œè¯·ç‚¹å‡»ä¸‹é¢çš„åˆ†äº«æŒ‰é’®æ¥æ”¯æŒæˆ‘ï¼Œä¸æ›´å¤šçš„äººè”ç³»ï¼Œå’Œ/æˆ–åœ¨<a class="ae mc" href="https://twitter.com/amir__mustafa" rel="noopener ugc nofollow" target="_blank"> Twitter </a>ä¸Šå…³æ³¨æˆ‘ï¼ŒæŸ¥çœ‹æˆ‘å­¦åˆ°çš„å…¶ä»–æŠ€å·§ã€æ–‡ç« å’Œäº‹æƒ…ï¼Œå¹¶åœ¨é‚£é‡Œåˆ†äº«ã€‚</p></blockquote><div class="ny nz gp gr oa ob"><a href="https://twitter.com/amir__mustafa" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd io gy z fp og fr fs oh fu fw im bi translated">å…³æ³¨Amir Mustafaçš„JavaScriptã€TypeScriptå’ŒAWSå†…å®¹ã€‚</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">twitter.com</h3></div></div><div class="oj l"><div class="ok l ol om on oj oo jt ob"/></div></div></a></div><p id="e059" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="na">æ›´å¤šå†…å®¹å°½åœ¨</em><a class="ae mc" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="na">plain English . io</em></strong></a></p></div></div>    
</body>
</html>