<html>
<head>
<title>How to Use Mongoose with Typescript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Typescript中使用Mongoose</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/using-mongoose-with-typescript-cc1804d7e472?source=collection_archive---------4-----------------------#2021-07-24">https://javascript.plainenglish.io/using-mongoose-with-typescript-cc1804d7e472?source=collection_archive---------4-----------------------#2021-07-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="b2e4" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">我是如何将一个使用Mongoose的JavaScript项目迁移到TypeScript的</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/7b37602c3dc9546531c1ba35cc0e1a56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uVHl97OJFKjBZ70n"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@altumcode?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">AltumCode</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="624d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">几个月前，我的团队开始将一个JavaScript项目转移到使用TypeScript，该项目专门用于使用Mongoose的Mongo集合的数据访问对象模块。这种“迁移”的主要原因是为每个模型/文档的每个属性和方法(静态和实例)提供一个定义良好的接口。</p><p id="21f1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了使这个过程递增，我们没有一次迁移所有集合，而是遵循如下过程:</p><ul class=""><li id="a680" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">创建正确的脚本，将TS代码编译成JS</li><li id="d0da" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">更改模块的入口点</li><li id="3cb7" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">开始迁移文件</li></ul><p id="0bfd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一个主要的目标是永远不要在这个过程中破坏一个已定义的接口，因为这个模块被许多其他项目用来访问所需的数据。</p><p id="d2c7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在此过程中，我们了解到:</p><ul class=""><li id="064c" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">如何创建定义良好的模型和文档</li><li id="773b" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">如何安全地不创建未在导出的接口中定义的新属性或方法</li></ul><p id="e4ac" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">以下是基本步骤:</p><ul class=""><li id="b9ce" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">用文档的所有属性定义一个“接口”。在这里，您定义了未来的集合属性，但是使用ts类型没有mongoose类型(最后，它们应该是“相同的类型”)。</li><li id="29d9" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">定义一个“接口”,扩展前面的接口(具有所需属性的接口)和来自mongoose的“文档”接口。在这个接口中，您将定义可用于每个mongoose文档的每个方法(这些是实例方法)。</li><li id="0426" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">为模型定义一个“接口”(这是集合),使用泛型和之前为文档定义的接口来扩展mongoose中的“模型”接口。在这个接口中，您将为集合定义可用的方法(静态方法)。</li><li id="2f04" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">为第一个接口(具有模型属性的接口)定义一个使用键类型化的对象。使用此类型定义此对象会强制您在接口中定义每个属性。此对象将用于创建架构。每个属性的类型将是可用的猫鼬类型。</li><li id="0ed4" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">创造出“猫鼬”。模式”与先前定义的对象</li><li id="4254" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">将实例方法和静态方法添加到定义的模式中</li><li id="d18c" class="lp lq in kv b kw ly kz lz lc ma lg mb lk mc lo lu lv lw lx bi translated">使用之前为文档和模型定义的接口，使用泛型创建mongoose模型</li></ul><p id="23fe" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">加分</strong></p><p id="8145" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您还可以为您的Mongoose模型添加静态属性。静态属性应该在模型接口中定义，并使用“statics”属性添加到模式中。</p><p id="9cfd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下面是一个完整的例子:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="962c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">正如您所看到的，现在您可以导入模型并拥有自动完成的属性和方法。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mf"><img src="../Images/233bc391458db82053d31c773454cb04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5tpSNn9PCTPTIFYR31C6g.png"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mg"><img src="../Images/d18d82b16a983a922fe26e7cf3be5f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5Z-UNOqINq2mL02_BoB1w.png"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mh"><img src="../Images/2cbd96b588b81357e4a246a22c49f724.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MICYFnxIdNBR_y_l_RQCWA.png"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mi"><img src="../Images/53ee88628ce0dbcdaa84d9a16cb05224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pH4h-B80XM3-3Qv6pw7rXA.png"/></div></div></figure><p id="8d64" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">希望这是有帮助的，并让我知道，如果有一些我们可以改善这种方法。</p><p id="ffad" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="mj">更多内容尽在</em><a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="mj">plain English . io</em></strong></a></p></div></div>    
</body>
</html>