<html>
<head>
<title>How to Integrate Apache Kafka into your Web App using AtomicKafka</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用AtomicKafka将Apache Kafka集成到您的Web应用程序中</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-integrate-apache-kafka-into-your-web-app-using-atomickafka-2eb79b20eaae?source=collection_archive---------8-----------------------#2021-06-03">https://javascript.plainenglish.io/how-to-integrate-apache-kafka-into-your-web-app-using-atomickafka-2eb79b20eaae?source=collection_archive---------8-----------------------#2021-06-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="7e4f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="http://www.atomickafka.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> AtomicKafka首页</strong> </a> <strong class="jm io"> | </strong> <a class="ae ki" href="https://github.com/oslabs-beta/AtomicKafka" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">库</strong> </a> <strong class="jm io"> | </strong> <a class="ae ki" href="https://github.com/AtomicKafka" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">演示应用</strong></a>|<a class="ae ki" href="https://www.npmjs.com/package/atomic-kafka" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">NPM</strong></a></p><p id="b15d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="kj"> AtomicKafka是一个轻量级的</em> <a class="ae ki" href="https://www.npmjs.com/package/atomic-kafka" rel="noopener ugc nofollow" target="_blank"> <em class="kj"> NPM包</em> </a> <em class="kj">开发用于简化在web应用程序中使用Apache Kafka建立双向、实时数据流的过程。</em></p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi kk"><img src="../Images/85dc4ae5c0c42ff0b25bd72983d59a97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kGlwkkl4LP4ce_jcoeZcNA.png"/></div></div></figure><p id="2676" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">什么是阿帕奇卡夫卡？<br/> </strong> Apache Kafka是一个开源的数据流处理总线，用Scala和Java编写，经过优化以高性能的方式处理实时数据流。Kafka平台支持开发高度可扩展的独立微服务应用，这些应用通过Kafka集群<strong class="jm io">产生</strong>、<strong class="jm io">处理</strong>、<strong class="jm io">消费</strong>数据。</p><p id="0eed" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">阿帕奇卡夫卡有很多用例。在支付处理中，使用Apache Kafka实时验证和执行在线商家交易。事务数据被生成到集群，由安全微服务处理和使用。然后，银行使用这些数据向客户提供账户监控服务。如果出现可疑活动，将立即进行标记和记录，并在处理数据时向客户发送通知。</p><p id="65ba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">主要概念<br/>消息</strong>是阿帕奇卡夫卡中的主要有效载荷。当向Kafka集群产生消息时，该消息被记录到数据流中，并在被消费之前被处理。消息包含一个键-值对(业务数据可以以任何格式存储，包括JSON、XML、CSV等)、一个时间戳和经常用于路由的可选元数据头。</p><p id="dd24" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">生产者</strong>是向Kafka发送消息的微服务应用，<strong class="jm io">消费者</strong>是订阅发送到Kafka集群并通过Kafka集群处理的实时数据流的微服务应用。生产者和消费者彼此完全隔离，这意味着他们只通过经纪人与Kafka集群进行交互。假设生产者和消费者各自的<strong class="jm io">主题</strong>在<strong class="jm io">分区</strong>上有足够的伸缩性来处理负载，这使得生产者和消费者理论上可以无限伸缩。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi kw"><img src="../Images/54196457203d280ea169c7ff4a4c12fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8nGzYlSIqt57gLWW98cIqg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Typical Flow of Kafka Messages</figcaption></figure><p id="c2b4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">消息由队列中的<strong class="jm io">主题</strong>进行线程化。主题可以从任意数量的生产者接收消息，并向订阅该主题的任意消费者发出消息。当代理传输来自生产者的消息时，消息被记录到数据流中，经过处理，然后按插入顺序发送给订阅主题的所有消费者。消息根据管理员为主题设置的保留期进行存储，并在其生命周期中根据需要随时准备就绪。Apache Kafka的性能相对于其数据管道的大小保持不变，因此数据可以持久存储而不会对性能产生负面影响。</p><p id="4cdc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">主题被分成<strong class="jm io">个分区</strong>，每个分区被分配给它们自己的代理。这实现了可扩展的容错环境。Kafka主题通过增加分区的数量来扩展，这增加了可以为该主题传输消息的代理的数量，从而增加了主题的负载能力。如果一个分区失败，消息仍然可以通过其他分区传输，因为它们已经存在于日志中。</p></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><p id="c3d4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">AtomicKafka如何工作<br/> </strong>那么，AtomicKafka到底是什么，它如何将您的web应用程序与Apache Kafka集成在一起？在开始之前，让我们先解决web开发人员在连接到动态数据集群时面临的一些问题。</p><p id="8866" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Websockets是web开发人员用来将Kafka微服务应用程序连接到Kafka代理的主要解决方案之一。一个正常工作的Kafka客户端-代理堆栈需要在客户端和代理之间建立一个websocket连接，该连接总是监听向集群产生的消息。在为浏览器开发时，为了保持性能，必须限制这个连接。</p><p id="e93d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此外，由于每个Kafka消费者和生产者微服务是相互隔离的，每个应用程序都需要自己的websocket连接到代理。这将不可避免地导致大量重复代码。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi li"><img src="../Images/6fb275ea6e1153b3045502cf18fa8e63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VO3LrV0GW2fHvQ-ycdukug.png"/></div></div></figure><p id="251c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们看看一个精通技术的企业家如何使用AtomicKafka。假设你经营一家有足够流量的在线B2B消费品商店，这样你的库存就会不断变化。您的许多客户可能是回头客，他们依赖您作为其面向消费者的业务的供应商。您已经有了一个用户友好的店面(可能是使用React在TypeScript中构建的)和某种保存目录和库存信息的数据库。你如何改善体验，让顾客随时看到你的库存？</p><p id="eafb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">轻松点。AtomicKafka抽象掉了所有繁重的工作。你所需要的只是Apache Kafka的一个运行实例——要么是一个<a class="ae ki" href="https://github.com/AtomicKafka/atomicKafkaConsumer/blob/main/docker-compose.yml" rel="noopener ugc nofollow" target="_blank"> Docker </a>映像，要么是一个通过<a class="ae ki" href="https://www.confluent.io/confluent-cloud/" rel="noopener ugc nofollow" target="_blank">融合云</a>的云解决方案。配置您的。env文件来包含Kafka引导服务器(以及安全连接通常需要的任何API密钥/秘密)，并初始化AtomicKafka！图书馆会处理剩下的。以下是内置的功能:</p><ul class=""><li id="d6dc" class="lj lk in jm b jn jo jr js jv ll jz lm kd ln kh lo lp lq lr bi translated">客户端和服务器之间的Websocket连接，接受用户定义的事件字符串和回调</li><li id="24de" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated">代理初始化并连接到Apache Kafka</li><li id="9614" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated">消费者和生产者类被预定义为尽可能模块化</li><li id="bb44" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated">消费者函数接受用户定义的回调函数来支持轻量级流处理</li><li id="56db" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated">React钩子，它用一个时间间隔来调节websocket事件监听器，以维护客户机性能</li></ul><p id="1fee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请随意导航到我们的登录页面或访问我们的<a class="ae ki" href="https://github.com/AtomicKafka" rel="noopener ugc nofollow" target="_blank"> GitHub </a>，在那里您可以访问演示上述用例的免费应用程序。</p></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><p id="e81b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">如何在你的网络应用中实现AtomicKafka</strong></p><p id="1d40" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 1。</strong>在您的服务器上初始化AtomicKafkaServer，并使用<strong class="jm io">组ID </strong>(仅限消费者)、websocket <strong class="jm io">事件字符串</strong>和<strong class="jm io">主题</strong>键在您的服务器上配置消费者和生产者。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="f36b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 2。</strong>在每个<strong class="jm io"> producer </strong>组件上初始化AtomicKafkaClient，该组件从您的应用程序向Kafka集群发送消息。将相应的web socket<strong class="jm io">produceMessageEvent字符串</strong>和<strong class="jm io"> payload </strong>传递给生产者，以向您的集群生成消息。<strong class="jm io">事件字符串</strong>被动态映射到服务器上正确的<strong class="jm io">主题关键字</strong>。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="f1a7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 3。</strong>初始化每个<strong class="jm io">消费者</strong>上的AtomicKafkaClient，他们将订阅您的卡夫卡集群上的一个主题。传入相应的消费者<strong class="jm io">组ID </strong>、websocket <strong class="jm io">消费者消息事件字符串</strong>、以及<strong class="jm io">主题</strong>键，并使用内置的<strong class="jm io"> useInterval钩子</strong>来限制消费者并保持浏览器性能。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="lx ly l"/></div></figure></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><p id="14e3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">路线图<br/> </strong>这只是AtomicKafka的开始。可以添加很多特性，使AtomicKafka成为全栈网络开发人员更健壮的工具。下面的特性包含了我们的长期发展路线图。</p><ul class=""><li id="17fb" class="lj lk in jm b jn jo jr js jv ll jz lm kd ln kh lo lp lq lr bi translated">启用管理代理允许用户访问管理功能，包括对Kafka-JS上可用的主题管理服务的更健壮的访问</li><li id="ae5e" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated">改进对多个流的动态处理</li><li id="e73e" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated">添加对消息批处理的本机支持</li><li id="893a" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated">高级流处理支持</li><li id="5524" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated">添加对用Java编写的卡夫卡微服务的本地支持</li></ul></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><p id="e7fd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">结论&amp;促成<br/> </strong>感谢您的阅读。我们希望对AtomicKafka的介绍会有所帮助。如需了解更多信息，请访问我们的网站。如果您想为AtomicKafka做贡献，请<a class="ae ki" href="https://github.com/oslabs-beta/AtomicKafka" rel="noopener ugc nofollow" target="_blank">岔开本报道</a>。将您的更改提交到一个命名良好的功能分支，然后打开一个请求。我们感谢您对这个开源项目的贡献！</p><p id="52dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">维护人员</strong></p><ul class=""><li id="0fdd" class="lj lk in jm b jn jo jr js jv ll jz lm kd ln kh lo lp lq lr bi translated">杨薇:<a class="ae ki" href="https://github.com/vickiwyang" rel="noopener ugc nofollow" target="_blank">git hub</a>/<a class="ae ki" href="https://www.linkedin.com/in/vwyang/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a></li><li id="7e9a" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated">nikhil Massand:<a class="ae ki" href="https://github.com/nikhilmassand" rel="noopener ugc nofollow" target="_blank">git hub</a>/<a class="ae ki" href="https://www.linkedin.com/in/nikhil-massand/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a></li><li id="e9b7" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated">李宗德:<a class="ae ki" href="https://github.com/amplifygospel" rel="noopener ugc nofollow" target="_blank">git hub</a>/<a class="ae ki" href="https://www.linkedin.com/in/joseph-lee-a97198213/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a></li><li id="8143" class="lj lk in jm b jn ls jr lt jv lu jz lv kd lw kh lo lp lq lr bi translated">David Behmoaras:<a class="ae ki" href="https://github.com/dbehmoaras" rel="noopener ugc nofollow" target="_blank">git hub</a>/<a class="ae ki" href="https://www.linkedin.com/in/david-behmoaras-6a688057/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a></li></ul><p id="40db" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="kj">更内容见于</em><a class="ae ki" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="kj"/></strong></a></p></div></div>    
</body>
</html>