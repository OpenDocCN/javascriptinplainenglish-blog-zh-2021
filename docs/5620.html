<html>
<head>
<title>How Comparisons Work in JavaScript: A Thorough Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的比较是如何工作的:全面指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-comparisons-work-in-javascript-a-thorough-guide-67563d2a2d99?source=collection_archive---------14-----------------------#2021-11-23">https://javascript.plainenglish.io/how-comparisons-work-in-javascript-a-thorough-guide-67563d2a2d99?source=collection_archive---------14-----------------------#2021-11-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/285e4fd3fc0866ed031d8182b09c7957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jXkWks7-UTgx1iV2"/></div></div></figure><p id="4ae5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">几年前看过凯尔·辛普森的JS系列丛书<a class="ae kt" href="https://github.com/getify/You-Dont-Know-JS" rel="noopener ugc nofollow" target="_blank">《你不知道的JS》</a>的部分内容。现在有第二版正在进行中，我开始重读它。正如作者本人所推荐的，这些书要多看几遍。它们需要适当消化，因为内容很重。所以我又读了一遍关于比较的章节，这是我写下我所学到的东西的尝试。</p><h1 id="2cfb" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><code class="fe ls lt lu lv b">==</code>和<code class="fe ls lt lu lv b">===</code>有什么区别？</h1><p id="1ec7" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">当你申请前端开发人员的职位时，你可能会被问到这个问题。你可能会回答,“三等”<code class="fe ls lt lu lv b">===</code>更严格。这意味着<code class="fe ls lt lu lv b">===</code>不允许强制，即从一个值类型到另一个值类型的转换。这里有一个例子:</p><pre class="mb mc md me gt mf lv mg mh aw mi bi"><span id="e803" class="mj kv in lv b gy mk ml l mm mn">‘2’ == 2 =&gt; true <br/>‘2’ === 2 =&gt; false</span></pre><p id="0722" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">很好。我认为这是一个相当充分的答案。但是，哦，亲爱的，还有这么多。让我们回顾更多的Javascript基础知识。有原始值类型和对象。常见的原语有:</p><ul class=""><li id="2100" class="mo mp in jx b jy jz kc kd kg mq kk mr ko ms ks mt mu mv mw bi translated">线</li><li id="9160" class="mo mp in jx b jy mx kc my kg mz kk na ko nb ks mt mu mv mw bi translated">数字</li><li id="ae79" class="mo mp in jx b jy mx kc my kg mz kk na ko nb ks mt mu mv mw bi translated">布尔代数学体系的</li><li id="0c15" class="mo mp in jx b jy mx kc my kg mz kk na ko nb ks mt mu mv mw bi translated">空</li><li id="1a4c" class="mo mp in jx b jy mx kc my kg mz kk na ko nb ks mt mu mv mw bi translated">不明确的</li></ul><p id="608c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">作为对象，我们可以对数组甚至函数进行分类。</p><h1 id="9d30" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">比较原始值</h1><p id="8aaa" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">我们可以使用<code class="fe ls lt lu lv b"><strong class="jx io">typeof</strong></code> <strong class="jx io">运算符</strong>来检查一个类型。在某些情况下，你不会得到你所期望的。</p><pre class="mb mc md me gt mf lv mg mh aw mi bi"><span id="3bde" class="mj kv in lv b gy mk ml l mm mn">typeof(null) =&gt; 'object'</span></pre><p id="7531" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这个运算符在我们进行比较时很有用。考虑下面的例子:</p><pre class="mb mc md me gt mf lv mg mh aw mi bi"><span id="b3f2" class="mj kv in lv b gy mk ml l mm mn">const num1 = 9007199254740992;<br/>const num2 = 9007199254740992n;</span><span id="790d" class="mj kv in lv b gy nc ml l mm mn">num1 == num2    =&gt; true<br/>num1 === num2   =&gt; false</span></pre><p id="159d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这几乎不明显，但是如果我们检查类型，我们可以看到num2实际上是类型<code class="fe ls lt lu lv b">bigint</code>，而num是<code class="fe ls lt lu lv b">number</code>；</p><pre class="mb mc md me gt mf lv mg mh aw mi bi"><span id="e4bc" class="mj kv in lv b gy mk ml l mm mn">typeof(num2) =&gt; bigint</span></pre><p id="e315" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以现在很清楚<code class="fe ls lt lu lv b">==</code>和<code class="fe ls lt lu lv b">===</code>都比较值和类型，但是<code class="fe ls lt lu lv b">==</code>检查类型，如果必要的话<strong class="jx io">在比较之前转换它</strong>。</p><blockquote class="nd ne nf"><p id="36f1" class="jv jw ng jx b jy jz ka kb kc kd ke kf nh kh ki kj ni kl km kn nj kp kq kr ks ig bi translated"><em class="in">JS中所有的值比较都考虑被比较值的类型，而不仅仅是===运算符。具体来说，===在其比较中不允许任何类型转换(也称为“强制”)，而其他JS比较允许强制。</em></p></blockquote><p id="14bd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Triple-equals也有一些不符合预期的边缘情况。</p><pre class="mb mc md me gt mf lv mg mh aw mi bi"><span id="641c" class="mj kv in lv b gy mk ml l mm mn">NaN === NaN;    =&gt; false<br/>0 === -0;       =&gt; true</span></pre><p id="7055" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了检查这些值，我们可以使用<code class="fe ls lt lu lv b">Number.isNaN()</code>方法。有趣的是，还有另一种比较值的方法，它不会给我们那些误导性的答案。它是<code class="fe ls lt lu lv b">Object.is()</code>，它返回正确的值。</p><pre class="mb mc md me gt mf lv mg mh aw mi bi"><span id="7288" class="mj kv in lv b gy mk ml l mm mn">Object.is(null, null);  =&gt; true<br/>Object.is(NaN, NaN) =&gt; true<br/>Object.is(-0, -0) =&gt; true</span></pre><h1 id="4019" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">比较对象</h1><p id="6f67" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">涉及对象的更复杂的场景呢？我们如何比较它们？正如你注意到的基本类型，我们比较了2个值，比如4 === "4 "。对象通常有嵌套的属性，我们不能通过它们的结构或内容(结构相等)来比较它们。以这个物体为例:</p><pre class="mb mc md me gt mf lv mg mh aw mi bi"><span id="0a01" class="mj kv in lv b gy mk ml l mm mn">let books = {<br/>  title: 'Climate Library',<br/>  list: [<br/>    {<br/>      id: 1,<br/>      name: "<a class="ae kt" href="https://speedandscale.com/speed-and-scale/" rel="noopener ugc nofollow" target="_blank">Speed &amp; Scale</a>",<br/>      author: "John Doerr",<br/>      published: "October 28th 2021"<br/>    },<br/>    {<br/>      id: 2,<br/>      name: "<a class="ae kt" href="https://www.amazon.com/New-Earth-Apocalypse-Locus/dp/B09KNGHVSW/ref=sr_1_8?crid=3DJCXYOP836VI&amp;keywords=apocalypse+earth&amp;qid=1637416028&amp;s=books&amp;sprefix=apoca%2Cstripbooks-intl-ship%2C366&amp;sr=1-8#customerReviews" rel="noopener ugc nofollow" target="_blank">A New Earth - The Apocalypse Locus</a>",<br/>      author: "George Tsakraklides",<br/>      published: "November 8th 2021"<br/>    }<br/>  ]<br/>}</span></pre><p id="f203" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">除了上面的例子之外，比较<code class="fe ls lt lu lv b">{ a: 2 } === { a: 2 }</code>会产生false(如果我们试图将它与另一个对象进行比较)。这是为什么呢？</p><blockquote class="nd ne nf"><p id="c2ad" class="jv jw ng jx b jy jz ka kb kc kd ke kf nh kh ki kj ni kl km kn nj kp kq kr ks ig bi translated"><em class="in">在JS中，所有的对象值都是通过引用持有的，都是通过reference-copy赋值和传递的，对于我们目前的讨论，都是通过引用(identity)相等来比较的。</em></p></blockquote><p id="20d3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们可以有另一个变量favouriteBooks，并给它赋值Books。那么我们可以这样比较它们:</p><pre class="mb mc md me gt mf lv mg mh aw mi bi"><span id="a6db" class="mj kv in lv b gy mk ml l mm mn">let books = {...};<br/>let favouriteBooks = {};<br/>favouriteBooks = books;</span><span id="53a7" class="mj kv in lv b gy nc ml l mm mn">books === favouriteBooks   =&gt; true</span></pre><p id="57db" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ls lt lu lv b">favouriteBooks</code>指的是同一个对象<code class="fe ls lt lu lv b">books</code>，所以比较它们返回true。</p><h1 id="be57" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">其他比较</h1><p id="4440" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">请记住，还有其他关系比较运算符，如<code class="fe ls lt lu lv b">&lt;</code>、<code class="fe ls lt lu lv b">&gt;</code>、<code class="fe ls lt lu lv b">&lt;=</code>和<code class="fe ls lt lu lv b">&gt;=</code>。我们在if条件、循环和其他地方使用它们，值类型的转换也适用，所以要小心。</p><h1 id="70c2" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h1><p id="52c9" class="pw-post-body-paragraph jv jw in jx b jy lw ka kb kc lx ke kf kg ly ki kj kk lz km kn ko ma kq kr ks ig bi translated">我们了解到，即使简单的Javascript比较也隐藏了表面下的许多本质细节。应该用<code class="fe ls lt lu lv b">==</code>还是<code class="fe ls lt lu lv b">===</code>？看情况。双相等确实转换了类型！我们可以看到<code class="fe ls lt lu lv b">Object.is()</code>是一种更严格的比较两个值的方法。我觉得我遗漏了很多信息，我必须一遍又一遍地阅读才能完全吸收。看看这本书，正如附录B所说:<a class="ae kt" href="https://github.com/getify/You-Dont-Know-JS/blob/2nd-ed/get-started/apB.md#practicing-comparisons" rel="noopener ugc nofollow" target="_blank">练习，练习，再练习！</a></p><p id="91da" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是书中的一个例子，你可以在上面练习:</p><p id="68ef" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ls lt lu lv b">scheduleMeeting(..)</code>应该取一个开始时间(以24小时格式为字符串“hh:mm”)和一个会议持续时间(分钟数)。如果会议完全在工作日内(根据<code class="fe ls lt lu lv b">dayStart</code>和<code class="fe ls lt lu lv b">dayEnd</code>中指定的时间)，则返回<code class="fe ls lt lu lv b">true</code>；如果会议违反了工作日界限，则返回<code class="fe ls lt lu lv b">false</code>。</p><pre class="mb mc md me gt mf lv mg mh aw mi bi"><span id="e511" class="mj kv in lv b gy mk ml l mm mn">const dayStart = "07:30";<br/>const dayEnd = "17:45";</span><span id="5781" class="mj kv in lv b gy nc ml l mm mn">function scheduleMeeting(startTime,durationMinutes) {<br/>    // ..TODO..<br/>}</span><span id="8c9f" class="mj kv in lv b gy nc ml l mm mn">scheduleMeeting("7:00",15);     // false<br/>scheduleMeeting("07:15",30);    // false<br/>scheduleMeeting("7:30",30);     // true<br/>scheduleMeeting("11:30",60);    // true<br/>scheduleMeeting("17:00",45);    // true<br/>scheduleMeeting("17:30",30);    // false<br/>scheduleMeeting("18:00",15);    // false</span></pre></div><div class="ab cl nk nl hr nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ig ih ii ij ik"><p id="d2fa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="ng">原载于</em><a class="ae kt" href="https://blog.mairo.eu/comparisons-in-javascript" rel="noopener ugc nofollow" target="_blank"><em class="ng">https://blog . mairo . eu</em></a><em class="ng">。</em></p><p id="64e6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="ng">更多内容看</em> <a class="ae kt" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="ng">说白了。在这里注册我们的</em> </a><a class="ae kt" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="ng">免费周报</em> </a> <em class="ng">。</em></p></div></div>    
</body>
</html>