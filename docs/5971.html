<html>
<head>
<title>How to Handle Stream Data Requests in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•åœ¨Node.jsä¸­å¤„ç†æµæ•°æ®è¯·æ±‚</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/handling-stream-data-requests-in-nodejs-91746427c103?source=collection_archive---------0-----------------------#2021-12-22">https://javascript.plainenglish.io/handling-stream-data-requests-in-nodejs-91746427c103?source=collection_archive---------0-----------------------#2021-12-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f0c4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">å®Œæ•´çš„ä»£ç å®ç°å’Œç”¨ä¾‹ã€‚</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1b9239a3cfba9450679be45f5e1ff349.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_Ow91aReqsvgi93T"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="aa6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express Node.jsæ¨¡å—</a>ä½¿Node.js webå¼€å‘äººå‘˜èƒ½å¤Ÿä»¥æœ€å°‘çš„éº»çƒ¦è®¾ç½®webåº”ç”¨å’ŒREST APIsã€‚ç„¶è€Œï¼Œåœ¨æµè§ˆç½‘é¡µæ—¶ï¼Œæˆ‘æ³¨æ„åˆ°ä¸ä»…æœ‰è®¸å¤šå…³äºæ•°æ®æµ/ç¼“å†²åŒº(ä¾‹å¦‚éŸ³é¢‘ã€å›¾åƒ&amp;è§†é¢‘äºŒè¿›åˆ¶æ•°æ®)çš„æŸ¥è¯¢ï¼Œè€Œä¸”è®¸å¤šæè®®çš„è§£å†³æ–¹æ¡ˆä¹Ÿå€¾å‘äºåŒ…æ‹¬é¢å¤–çš„å®ç”¨ç¨‹åºï¼Œä¾‹å¦‚<a class="ae kv" href="https://www.npmjs.com/package/got" rel="noopener ugc nofollow" target="_blank"> got </a>å’Œ<a class="ae kv" href="https://www.npmjs.com/package/axios" rel="noopener ugc nofollow" target="_blank"> Axios </a>ã€‚</p><blockquote class="ls"><p id="d466" class="lt lu iq bd lv lw lx ly lz ma mb lr dk translated">è™½ç„¶è¿™äº›é¢å¤–çš„èŠ‚ç‚¹æ¨¡å—å¯ä»¥åœ¨å¤§è§„æ¨¡é¡¹ç›®ä¸­å®ç°æ›´æ˜“ç»´æŠ¤çš„ä»£ç ï¼Œä½†æ˜¯åœ¨å¼€å‘äººå‘˜è¯•å›¾åˆ›å»ºå°è§„æ¨¡åº”ç”¨ç¨‹åºçš„åœºæ™¯ä¸­ï¼Œå…·æœ‰æœ€å°‘æ’ä»¶çš„è½»é‡çº§è§£å†³æ–¹æ¡ˆå¯èƒ½æ›´åˆé€‚ã€æ›´ç†æƒ³ã€‚</p></blockquote><p id="b5ac" class="pw-post-body-paragraph kw kx iq ky b kz mc jr lb lc md ju le lf me lh li lj mf ll lm ln mg lp lq lr ij bi translated">å› æ­¤ï¼Œæˆ‘å†³å®šå‘å¸ƒè¿™ç¯‡æ–‡ç« ï¼Œå¸Œæœ›å®ƒèƒ½å¯¹å…¶ä»–NodeJSå¼€å‘äººå‘˜æœ‰ç”¨ï¼Œä»–ä»¬æ­£åœ¨å¯»æ‰¾ä¸€ä¸ªåœ¨å®ç°ä¸­åªéœ€è¦æœ€å°‘å®‰è£…çš„è§£å†³æ–¹æ¡ˆã€‚</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="48b0" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated">å…ˆå†³æ¡ä»¶â€”ä½¿ç”¨<a class="ae kv" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Expressæ¨¡å—</a>è®¾ç½®ä¸€ä¸ªæœ€å°çš„Node.jsæœåŠ¡å™¨</h2><p id="9f2a" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated"><strong class="ky ir">ç¬¬ä¸€æ­¥ã€‚</strong>åˆå§‹åŒ–å·¥ä½œåŒºæ–‡ä»¶å¤¹(æ ¹æ–‡ä»¶å¤¹)ã€‚åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­ï¼Œæ‰“å¼€ä¸€ä¸ªç»ˆç«¯å¹¶ç»§ç»­è¿è¡Œä»¥ä¸‹å‘½ä»¤:</p><pre class="kg kh ki kj gt nm nn no bn np nq bi"><span id="532e" class="nr mp iq nn b be ns nt l nu nv">npm init -y<br/>npm i express --save</span></pre><p id="6c3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸Šé¢åˆ›å»ºäº†ä¸€ä¸ª<strong class="ky ir"> package.json </strong>æ–‡ä»¶ï¼Œå¹¶å°†<a class="ae kv" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express NodeJSæ¨¡å—</a>åˆ†åˆ«å®‰è£…åˆ°åº”ç”¨ä¸­ã€‚</p><p id="3d31" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">ç¬¬äºŒæ­¥ã€‚åˆ›å»ºä¸€ä¸ªåä¸º<strong class="ky ir"> server.js </strong>çš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å‡ è¡Œ:</strong></p><pre class="kg kh ki kj gt nm nn no bn np nq bi"><span id="73b2" class="nr mp iq nn b be ns nt l nu nv">const express = require('express');<br/>const app = express();<br/>const port = 9000;<br/>app.get('/', (req, res) =&gt; {<br/> res.send('Hello World!');<br/>});<br/>app.listen(port, () =&gt; {<br/> console.log(`App is listening at http://localhost:${port}`);<br/>});</span></pre><p id="72a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">ç¬¬ä¸‰æ­¥ã€‚</strong>åœ¨åŒä¸€ç»ˆç«¯ä¸­ï¼Œè¿è¡Œ<code class="fe nw nx ny nn b">node server.js</code>å¹¶ç»§ç»­å¯¼èˆªè‡³<a class="ae kv" href="http://localhost:9000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:9000/ </a></p><p id="aef3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">è¾“å‡º:</strong>å•è¯â€œHello Worldï¼â€åº”å‘ˆç°å¦‚ä¸‹æ‰€ç¤º</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/fba8ff45e9e2cc5acb8e69636f5a2d5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lOHnAgCnoR_zN-kTURKcXg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by Author</figcaption></figure><blockquote class="oa ob oc"><p id="613d" class="kw kx od ky b kz la jr lb lc ld ju le oe lg lh li of lk ll lm og lo lp lq lr ij bi translated">è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨Node.jsçš„ <a class="ae kv" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> Expressæ¨¡å—</em> </a> <em class="iq">å»ºç«‹äº†ä¸€ä¸ªè¿è¡Œåœ¨ç«¯å£</em><strong class="ky ir"><em class="iq">9000</em></strong><em class="iq">ä¸Šçš„æç®€webæœåŠ¡å™¨ã€‚</em></p></blockquote><h1 id="b36a" class="oh mp iq bd mq oi oj ok mt ol om on mw jw oo jx mz jz op ka nc kc oq kd nf or bi translated">ç”¨ä¾‹:è¿”å›ä¸€ä¸ªå›¾åƒæ–‡ä»¶æµå“åº”</h1><h2 id="98ca" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated"><strong class="ak">æ³¨æ„:</strong>å®Œæ•´æºä»£ç å¯ä»æˆ‘çš„<a class="ae kv" href="https://github.com/incubated-geek-cc/node-api-stream-demo" rel="noopener ugc nofollow" target="_blank"> GitHub Repo </a>è·å¾—</h2><p id="8bb6" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated"><strong class="ky ir">å‚è€ƒæ¶ˆæ¯:</strong>åœ¨<strong class="ky ir"> server.js </strong>æ–‡ä»¶ä¸­ï¼Œå‘å®¢æˆ·ç«¯è¿”å›å“åº”å¹¶å‘ˆç°é¡µé¢å†…å®¹çš„ä»£ç å—ï¼Œå³â€œHello Worldï¼â€å¦‚ä¸‹æ‰€ç¤º:</p><pre class="kg kh ki kj gt nm nn no bn np nq bi"><span id="8278" class="nr mp iq nn b be ns nt l nu nv">app.get('/', (req, res) =&gt; {<br/>  res.send('Hello World!');<br/>});</span></pre><blockquote class="ls"><p id="909a" class="lt lu iq bd lv lw os ot ou ov ow lr dk translated">åœ¨å‡è®¾çš„åœºæ™¯ä¸­ï¼Œå•†ä¸šç”¨æˆ·åšæŒå±•ç¤ºä¸€å¹…å›¾åƒï¼Œè€Œä¸æ˜¯å‘ˆç°å•è¯â€œHello Worldï¼â€ç›¸åï¼Œåœ¨webé¡µé¢ä¸Šï¼Œéœ€è¦è€ƒè™‘ExpressJSæœåŠ¡å™¨åº”è¯¥å‘å®¢æˆ·æœºæµè§ˆå™¨è¿”å›ä»€ä¹ˆç±»å‹çš„å“åº”æ•°æ®ï¼Œå› ä¸ºæ‰€éœ€çš„å†…å®¹ä¸å†æ˜¯æ™®é€šçš„HTMLæ–‡æœ¬ã€‚</p></blockquote><p id="70c4" class="pw-post-body-paragraph kw kx iq ky b kz mc jr lb lc md ju le lf me lh li lj mf ll lm ln mg lp lq lr ij bi translated">é¦–å…ˆï¼Œé‡è¦çš„æ˜¯é¦–å…ˆè¦ç¡®å®šè¿™ä¸ªç”¨ä¾‹çš„ç›®æ ‡æ˜¯è¿”å›ä¸€ä¸ªåµŒå…¥äº†å›¾åƒçš„äºŒè¿›åˆ¶æ–‡ä»¶æ•°æ®çš„<strong class="ky ir">å“åº”å¯¹è±¡</strong>ã€‚å› æ­¤ï¼Œåœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘å°†ç»§ç»­æ¼”ç¤ºå¦‚ä½•æ¸²æŸ“ä¸€ä¸ªå›¾åƒï¼Œä¾‹å¦‚åœ°å€ä¸º<a class="ae kv" href="http://localhost:9000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:9000/ </a>çš„<a class="ae kv" href="https://github.com/incubated-geek-cc/node-api-stream-demo/raw/main/leaf.png" rel="noopener ugc nofollow" target="_blank">leaf.png</a>ã€‚</p><p id="e691" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œåªéœ€å‚è€ƒå‰é¢æåˆ°çš„ä»£ç è¡Œï¼Œå¹¶åœ¨ä¸‹é¢çš„<strong class="ky ir"> server.js </strong>ä¸­è¿›è¡Œä»¥ä¸‹æ›´æ”¹:</p><pre class="kg kh ki kj gt nm nn no bn np nq bi"><span id="9e77" class="nr mp iq nn b be ns nt l nu nv">const express = require('express');<br/>const app = express();<br/>const port = 9000;<br/>const fs = require('fs');<br/>const path = require('path');<br/>app.get('/', (req, res) =&gt; {<br/>   var filepathToStream=path.join(__dirname, 'leaf.png');<br/>   var readStream = fs.createReadStream(filepathToStream);<br/>   readStream<br/>   .on('open', () =&gt; {<br/>       readStream.pipe(res);<br/>   })<br/>   .on('error', (err_msg) =&gt; {<br/>       console.log(err_msg);<br/>       res.end(err_msg);<br/>   });<br/>});<br/>app.listen(port, () =&gt; {<br/> console.log(`App is listening at http://localhost:${port}`)<br/>});</span></pre><p id="81c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç»§ç»­é‡æ–°è¿è¡Œåº”ç”¨ç¨‹åºã€‚é¢„æœŸè¾“å‡ºåº”ä¸º:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/cfc2e5ec787fd399bc62189a2a147466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MjZFcafghNru6IrtJvRR-Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by Author | The leaf image has been rendered onto the same local address on port 9000 after changes were made to server.js</figcaption></figure><p id="1458" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">é™„æ³¨:</strong>åœ¨æ£€æŸ¥å…ƒç´ æ—¶ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯Transfer-Encodingå±æ€§è¢«å£°æ˜ä¸ºâ€œchunkedâ€</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/beb390e634d695077d01655c717c1f73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JHkKtKXJ6iagS3RsMI1Dbg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by Author | Transfer-Encoding is chunked in this case as outlined by the red box.</figcaption></figure><h2 id="b899" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated"><strong class="ak">è§£é‡Šä¼ è¾“ç¼–ç =åˆ†å—çš„åŸºæœ¬åŸç†</strong></h2><p id="846a" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">åœ¨æœåŠ¡å™¨æ— æ³•ç¡®å®šå“åº”å®ä½“çš„æ€»å¤§å°<em class="od">(å­—èŠ‚æ•°)</em>çš„æƒ…å†µä¸‹ï¼Œå“åº”æ•°æ®çš„ç¼“å†²åŒºæ•°ç»„å°†å› æ­¤è¢«æˆæ‰¹è¿”å›ï¼Œä»¥é˜²æ­¢æœåŠ¡å™¨åœ¨ä¼ è¾“å®Œæˆæ—¶æˆ–ä¹‹å‰è¿‡è½½ã€‚</p><p id="7554" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="od"> â€” </em> </strong>è¿™åœ¨æœåŠ¡å™¨åº”ç”¨ç¨‹åºéœ€è¦ä»å¤–éƒ¨åˆ†é¡µAPIè¿ç»­ä¼ è¾“æ•°æ®çš„ç”¨ä¾‹ä¸­å°¤å…¶å¸¸è§ã€‚</p><p id="c4ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç”±äºåœ¨è¿™ä¸ªç‰¹å®šçš„æ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬å¾ˆæ¸…æ¥šä½œä¸ºå“åº”å®ä½“è¿”å›åˆ°å®¢æˆ·ç«¯çš„æœ¬åœ°æ–‡ä»¶æ˜ åƒæ²¡æœ‰è¶…å‡ºæœåŠ¡å™¨çš„å¤„ç†èƒ½åŠ›ï¼Œå› æ­¤æœ¬èƒ½çš„é€‰æ‹©æ˜¯å®ç°<strong class="ky ir">ç®¡é“</strong>ä»¥å‡å°‘æ‰€éœ€çš„ä»£ç è¡Œã€‚</p><pre class="kg kh ki kj gt nm nn no bn np nq bi"><span id="0f52" class="nr mp iq nn b be ns nt l nu nv">readStream<br/>   .on('open', () =&gt; {<br/>       readStream.pipe(res);<br/>   })<br/>   .on('error', (err_msg) =&gt; {<br/>       console.log(err_msg);<br/>       res.end(err_msg);<br/>   });</span></pre><blockquote class="oa ob oc"><p id="273e" class="kw kx od ky b kz la jr lb lc ld ju le oe lg lh li of lk ll lm og lo lp lq lr ij bi translated"><em class="iq">æˆ–è€…ï¼Œå¦‚æœæˆ‘ä»¬åšæŒæŒ‰å—ä¼ è¾“æ•°æ®çš„ä¼ ç»Ÿæ–¹å¼ï¼Œé‚£ä¹ˆæ£€ç´¢ç¼“å†²åŒºæ•°ç»„çš„æ–¹æ³•å°†ä¸åŒäºä¸Šé¢çš„æ–¹æ³•ï¼Œå¦‚ä¸‹é¢çš„</em><strong class="ky ir"><em class="iq">server . js</em></strong><em class="iq">æ–‡ä»¶ä¸­çš„æ›¿ä»£è§£å†³æ–¹æ¡ˆæ‰€ç¤º(å…¶ä¸­æ‰€éœ€çš„è¾“å‡ºå¯ä»¥é€šè¿‡åœ°å€é“¾æ¥</em><a class="ae kv" href="http://localhost:9000/leaf" rel="noopener ugc nofollow" target="_blank"><em class="iq">http://localhost:9000/leaf</em></a><em class="iq">è®¿é—®)</em></p></blockquote><pre class="kg kh ki kj gt nm nn no bn np nq bi"><span id="5b3f" class="nr mp iq nn b be ns nt l nu nv">const express = require('express');<br/>const app = express();<br/>const port = 9000;<br/>const fs = require('fs');<br/>const path = require('path');<br/>app.get('/', (req, res) =&gt; {<br/>   var filepathToStream=path.join(__dirname, 'leaf.png');<br/>   var readStream = fs.createReadStream(filepathToStream);<br/>   readStream<br/>   .on('open', () =&gt; {<br/>       readStream.pipe(res);<br/>   })<br/>   .on('error', (err_msg) =&gt; {<br/>       console.log(err_msg);<br/>       res.end(err_msg);<br/>   });<br/>});<br/>app.get('/leaf', (req, res) =&gt; {<br/>  var filepathToStream=path.join(__dirname, 'leaf.png');<br/>  var readStream = fs.createReadStream(filepathToStream);<br/>  readStream<br/>  .on('data',(chunk) =&gt; {<br/>    res.write(chunk);<br/>  })<br/>  .on('error', (err_msg) =&gt; {<br/>    console.log(err_msg);<br/>    res.end(err_msg);<br/>  })<br/>  .on('end', () =&gt; {<br/>      res.end();<br/>  });<br/>});<br/>app.listen(port, () =&gt; {<br/> console.log(`App is listening at http://localhost:${port}`)<br/>});</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/3ed60f0c3965fb4d9a951f87d1efa2f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FpxSBMyNdn_S6UFZuHGwlQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by Author | The leaf image has been rendered onto the same local address on port 9000 with the suffix â€˜leafâ€™ after changes made to server.js</figcaption></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="15ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è™½ç„¶æˆ‘å·²ç»å®Œæˆäº†ä»¥ä¸Šå…³äºå¦‚ä½•ä½¿ç”¨<strong class="ky ir">ç®¡é“</strong>åŠŸèƒ½å’Œ/æˆ–é€šè¿‡<strong class="ky ir">å—</strong>è¯»å–æ¥å¤„ç†æµå’Œç¼“å†²åŒºçš„æ¼”ç¤ºï¼Œä½†è¿˜æœ‰ä¸€ç‚¹æˆ‘æƒ³åˆ†äº«ï¼Œå› ä¸ºå®ƒé€šå¸¸ä¸ç›¸å…³ç”¨ä¾‹å¯†åˆ‡ç›¸å…³ã€‚</p><h2 id="05c9" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated">é¢å¤–ææ–™:ä¸ºå›¾ç‰‡æä¾›ä¸€ä¸ªä¸‹è½½é“¾æ¥</h2><p id="3267" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">å¯¹<strong class="ky ir"> server.js </strong>æ–‡ä»¶è¿›è¡Œä¿®æ”¹åï¼Œå¯åœ¨<a class="ae kv" href="http://localhost:9000/download_leaf" rel="noopener ugc nofollow" target="_blank">http://localhost:9000/download _ leaf</a>è®¿é—®ä¸‹è½½é“¾æ¥ï¼›</p><pre class="kg kh ki kj gt nm nn no bn np nq bi"><span id="8f42" class="nr mp iq nn b be ns nt l nu nv">const express = require('express');<br/>const app = express();<br/>const port = 9000;<br/>const fs = require('fs');<br/>const path = require('path');<br/>app.get('/', (req, res) =&gt; {<br/>   var filepathToStream=path.join(__dirname, 'leaf.png');<br/>   var readStream = fs.createReadStream(filepathToStream);<br/>   readStream<br/>   .on('open', () =&gt; {<br/>       readStream.pipe(res);<br/>   })<br/>   .on('error', (err_msg) =&gt; {<br/>       console.log(err_msg);<br/>       res.end(err_msg);<br/>   });<br/>});<br/>app.get('/leaf', (req, res) =&gt; {<br/>  var filepathToStream = path.join(__dirname, 'leaf.png');<br/>  var readStream = fs.createReadStream(filepathToStream);<br/>  readStream<br/>  .on('data',(chunk) =&gt; {<br/>    res.write(chunk);<br/>  })<br/>  .on('error', (err_msg) =&gt; {<br/>    console.log(err_msg);<br/>    res.end(err_msg);<br/>  })<br/>  .on('end', () =&gt; {<br/>      res.end();<br/>  });<br/>});<br/>app.get('/download_leaf', (req, res) =&gt; {<br/>  var allChunks=[];<br/>  var filepathToStream=path.join(__dirname, 'leaf.png');<br/>  var readStream = fs.createReadStream(filepathToStream);<br/>  readStream<br/>  .on('data', (chunk) =&gt; {<br/>    allChunks=allChunks.concat(chunk);<br/>  })<br/>  .on('error', (err_msg) =&gt; {<br/>    console.log(err_msg);<br/>    res.end(err_msg);<br/>  })<br/>  .on('end', () =&gt; {<br/>      var b64URI = 'data:image/png;base64,' + Buffer.from(allChunks[0]).toString('base64');<br/>      var downloadLink="&lt;a href='"+b64URI+"' download='leaf.png' target='_blank'&gt;Download leaf.png&lt;/a&gt;";<br/>      res.send(downloadLink);<br/>  });<br/>});<br/>app.listen(port, () =&gt; {<br/>  console.log(`App is listening at http://localhost:${port}`)<br/>});</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/b6e8f1a8f51aaa4a9ebd210e64c5c733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*kz2DhprkHQCe8srOLjiV2A.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screen Capture by Author | Upon navigating to <a class="ae kv" href="http://localhost:9000/download_leaf" rel="noopener ugc nofollow" target="_blank">http://localhost:9000/download_leaf</a> the download link is generated. Image is then saved successfully.</figcaption></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="3c28" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="od">æˆ‘å…³äºå¦‚ä½•åœ¨ExpressJSä¸­å¤„ç†ç¼“å†²åŒºæ•°ç»„å’Œæµæ•°æ®çš„æ–‡ç« åˆ°æ­¤ç»“æŸï¼éå¸¸æ„Ÿè°¢ä½ åšæŒåˆ°è¿™ç¯‡æ–‡ç« çš„ç»“å°¾ï¼â¤å¸Œæœ›æœ¬æŒ‡å—å¯¹æ‚¨æœ‰ç”¨ï¼Œå¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šGISã€æ•°æ®åˆ†æ&amp; Webåº”ç”¨ç›¸å…³çš„å†…å®¹ï¼Œè¯·éšæ—¶</em> <a class="ae kv" href="https://medium.com/@geek-cc" rel="noopener"> <em class="od">å…³æ³¨æˆ‘çš„Medium </em> </a> <em class="od">ã€‚</em>éå¸¸æ„Ÿè°¢ğŸ˜€</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="ff99" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœä½ å¿˜è®°äº†ï¼Œå®Œæ•´çš„æºä»£ç åœ¨è¿™é‡Œ<a class="ae kv" href="https://github.com/incubated-geek-cc/node-api-stream-demo" rel="noopener ugc nofollow" target="_blank">å¯ä»¥æ‰¾åˆ°</a>å¦‚æœæœ‰äººæƒ³æ£€ç´¢å®ƒä½œä¸ºå‚è€ƒã€‚</p><div class="pa pb gp gr pc pd"><a href="https://geek-cc.medium.com/membership" rel="noopener follow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd ir gy z fp pi fr fs pj fu fw ip bi translated">é€šè¿‡æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥çµåª’â€”â€”ææ€æ¬£Â·å´”</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">è·å¾—ææ€æ¬£Â·å´”å’Œå…¶ä»–ä½œå®¶åœ¨åª’ä½“ä¸Šçš„æ‰€æœ‰å¸–å­ï¼ğŸ˜ƒæ‚¨çš„ä¼šå‘˜è´¹ç›´æ¥â€¦</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">geek-cc.medium.com</p></div></div><div class="pm l"><div class="pn l po pp pq pm pr kp pd"/></div></div></a></div><p id="0fc3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="od">æ›´å¤šå†…å®¹è¯·çœ‹</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="od">plain English . io</em></a><em class="od">ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="od">å…è´¹å‘¨æŠ¥åœ¨è¿™é‡Œ</em> </a> <em class="od">ã€‚</em></p></div></div>    
</body>
</html>