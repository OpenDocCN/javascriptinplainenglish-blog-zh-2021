<html>
<head>
<title>How to Protect Routes in Angular From Unauthorized Access</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何保护Angular中的路由免受未经授权的访问</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-protect-routes-in-angular-from-unauthorized-access-52a131610266?source=collection_archive---------6-----------------------#2021-04-09">https://javascript.plainenglish.io/how-to-protect-routes-in-angular-from-unauthorized-access-52a131610266?source=collection_archive---------6-----------------------#2021-04-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1a4a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何使用AuthGuard保护Angular中的路线</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/24f0c9751ca1dd280025a2f270c3f893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QwNDVv4EeNP__3deTMRb5w.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://unsplash.com/photos/ieic5Tq8YMk" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/ieic5Tq8YMk</a></figcaption></figure><p id="9200" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将看到，如何使用Angular来保护页面/路径免受未经授权的访问。我们可以轻松地创建一个组件，并为该组件创建一条路线。默认情况下，任何人都可以访问<strong class="ky ir"> Angular </strong>中的所有路线。但是当我们开发ERP、CRM等应用时。，这些应用程序必须只能由授权人员访问。</p><p id="6c00" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在使用Angular之前，HTML代码与服务器端代码混合在一起。所以我们之前有一个会话概念来限制用户访问页面。用户登录后，将为特定用户创建会话。每当用户访问新页面时，都会在每次请求页面时验证会话。这就是我们如何使用会话概念来限制用户访问。</p><p id="cb9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们使用<strong class="ky ir"> REST API </strong>来获取数据。Angular完全独立于服务器端代码。我们使用的是无状态REST API。所以我们不能使用Angular中的会话概念来验证用户。因此，每个Angular开发人员都会想到这个问题。</p><p id="bc39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">我们如何保护页面免受未授权用户的访问？</em></p><p id="4d5d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Angular为我们提供了解决这个问题的终极方案。那叫<strong class="ky ir"> AuthGuard </strong>。AuthGuard用于保护路由免受未经授权的访问。</p><h2 id="abb1" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">【AuthGuard如何工作？</h2><p id="225e" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">AuthGuard有许多生命周期事件。最常用的生命周期事件之一是<strong class="ky ir"> canActivate </strong>。canActivate就像一个构造函数。它将在访问路线之前被调用。canActivate必须返回true才能访问页面。如果它返回false，我们就无法访问该页面。我们可以在canActivate函数中编写我们的用户授权和认证逻辑。</p><h2 id="617f" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated"><strong class="ak">创建授权卫士</strong></h2><p id="5ceb" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">我们可以在您的终端上使用下面的命令创建一个AuthGuard。使用终端在Angular项目中执行下面的代码。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="8261" class="lt lu iq ms b gy mw mx l my mz">ng g guard services/auth</span></pre><p id="e9ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我已经在services文件夹中创建了AuthGuard。AuthGuard名称为auth。你可以用任何名字。获得下面的AuthGuard的完整代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="7111" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，在canActivate内部，我从登录服务调用了verify()函数。我使用JWT令牌来授权用户。因此verify()函数从cookies中获取JWT令牌，并每次使用HTTP请求在服务器中验证它。您可以在这里实现自己的逻辑。</p><h2 id="3a6a" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated"><strong class="ak">将AuthGuard包含到路由中</strong></h2><p id="da3e" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">将创建的AuthGuard包含到您的路线中，如下所示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="c4fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅此而已。现在，对于路由的每个请求，将调用verify()函数，如果verify()函数返回true，那么只有我们可以访问特定的路由。如果它返回false，我们就无法访问它。</p><p id="b9fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是我们如何限制未经授权的用户访问路由。</p><h2 id="5e7c" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated"><strong class="ak">结论</strong></h2><p id="348a" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">在本教程中，您学习了如何创建一个<strong class="ky ir"> AuthGuard </strong>以及如何将AuthGuard添加到您的路线中以防止未经授权的用户访问。本教程对于试图创建使用认证和授权的应用程序的初学者来说非常有用。对于来自会话概念的开发人员，本文将帮助他们使用Angular实现访问限制。</p><p id="5056" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Angular完全独立于服务器。我们使用无状态REST API来获取数据。所以使用AuthGuard来保护路由免受未授权的访问。</p><p id="7c53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您阅读这篇文章。</p><p id="1a39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">延伸阅读。</p><div class="nc nd gp gr ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/angular-routing-and-navigation-example-998d14c01f8e"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">角度路由和导航示例</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">创建组件并创建路线，然后导航到路线</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="no l"><div class="np l nq nr ns no nt kp nf"/></div></div></a></div><div class="nc nd gp gr ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/implement-jwt-based-authorization-using-nodejs-and-angular-9f75ab5904ac"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">使用NodeJS和Angular实现基于JWT的授权</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">如何使用NodeJS，MySQL创建JWT授权的完整示例，并使用Angular</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="no l"><div class="nu l nq nr ns no nt kp nf"/></div></div></a></div><div class="nc nd gp gr ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/create-rest-api-using-nodejs-and-mysql-from-scratch-d1844601e21"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">从头开始使用NodeJS和MySQL创建REST API</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">从头开始使用MySQL的CRUD示例</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="no l"><div class="nv l nq nr ns no nt kp nf"/></div></div></a></div><p id="e60f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">更多内容尽在</em><a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ls">plain English . io</em></strong></a></p></div></div>    
</body>
</html>