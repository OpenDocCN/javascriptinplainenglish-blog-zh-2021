<html>
<head>
<title>Create a Typing Test with React and JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React和JavaScript创建一个类型测试</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-a-typing-test-with-react-and-javascript-3a92db0a9719?source=collection_archive---------7-----------------------#2021-05-09">https://javascript.plainenglish.io/create-a-typing-test-with-react-and-javascript-3a92db0a9719?source=collection_archive---------7-----------------------#2021-05-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4aac751ddcac6538a9c342fe0f7912b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A0Q7x15VNylOfxeJ"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@lucaonniboni?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Luca Onniboni</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="163a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React是一个易于使用的JavaScript框架，让我们可以创建前端应用程序。</p><p id="497b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用React和JavaScript创建一个类型测试。</p><h1 id="bcb5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建项目</h1><p id="a1b8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用Create React App创建React项目。</p><p id="5322" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要安装它，我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="011e" class="mn lc iq mj b gy mo mp l mq mr">npx create-react-app typing-test</span></pre><p id="5666" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和NPM一起创建我们的React项目。</p><h1 id="c534" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建打字测试</h1><p id="e01d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了创建类型测试，我们编写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9957" class="mn lc iq mj b gy mo mp l mq mr">import React, { useEffect, useMemo, useState } from "react";<br/>const text =<br/>  "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus sit amet tellus tortor. ";</span><span id="9e89" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  const [textToType] = useState(text);<br/>  const [typedText, setTypedText] = useState("");<br/>  const [timer, setTimer] = useState();<br/>  const [elapsedMs, setElapsedMs] = useState(0);<br/>  const [started, setStarted] = useState(false);<br/>  const [wpm, setWpm] = useState(0);</span><span id="bc70" class="mn lc iq mj b gy ms mp l mq mr">  const parts = useMemo(() =&gt; {<br/>    const splitTextToType = textToType.split("");<br/>    let endIndexMatch = 0;<br/>    for (const [index, s] of splitTextToType.entries()) {<br/>      if (s !== typedText[index]) {<br/>        endIndexMatch = index;<br/>        break;<br/>      }<br/>    }<br/>    return {<br/>      matchedPart: textToType.slice(0, endIndexMatch),<br/>      unmatchedPart: textToType.slice(endIndexMatch)<br/>    };<br/>  }, [textToType, typedText]);</span><span id="9c7d" class="mn lc iq mj b gy ms mp l mq mr">  const start = () =&gt; {<br/>    const timer = setInterval(() =&gt; {<br/>      setElapsedMs((elapsedMs) =&gt; elapsedMs + 1);<br/>      if (!started) {<br/>        setStarted(true);<br/>      }<br/>    }, 1000);<br/>    setTimer(timer);<br/>  };</span><span id="04e1" class="mn lc iq mj b gy ms mp l mq mr">  const restart = () =&gt; {<br/>    setStarted(started);<br/>    setElapsedMs(0);<br/>    setTypedText("");<br/>  };</span><span id="93b8" class="mn lc iq mj b gy ms mp l mq mr">  useEffect(() =&gt; {<br/>    if (parts.unmatchedPart.length === 1) {<br/>      clearInterval(timer);<br/>      setWpm(textToType.split(" ").length / (elapsedMs / (60 * 1000)));<br/>    }<br/>  }, [parts, textToType, timer, elapsedMs]);</span><span id="08f2" class="mn lc iq mj b gy ms mp l mq mr">  if (parts.unmatchedPart.length &gt; 1) {<br/>    return (<br/>      &lt;div&gt;<br/>        &lt;div&gt;<br/>          &lt;b&gt;{parts.matchedPart}&lt;/b&gt;<br/>          {parts.unmatchedPart}<br/>        &lt;/div&gt;<br/>        &lt;button onClick={start}&gt;start&lt;/button&gt;<br/>        &lt;textarea<br/>          disabled={!started}<br/>          value={typedText}<br/>          onChange={(e) =&gt; setTypedText(e.target.value)}<br/>          style={{ width: "90vw", height: "300px" }}<br/>        &gt;&lt;/textarea&gt;<br/>      &lt;/div&gt;<br/>    );<br/>  } else {<br/>    return (<br/>      &lt;div&gt;<br/>        Your words per minute is {wpm}<br/>        &lt;button onClick={restart}&gt;restart&lt;/button&gt;<br/>      &lt;/div&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="762b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用输入的文本来定义<code class="fe mt mu mv mj b">textToType</code>状态，以完成测试。</p><p id="9a9c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">typedText</code>有我们输入的文本。</p><p id="012b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">timer</code>有打字测试的计时器。</p><p id="55a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">elaspedMs</code>以毫秒为单位设置经过的时间。</p><p id="e8bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">started</code>设置测试是否已经开始。</p><p id="a588" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">wpm</code>每分钟字数达到了吗？</p><p id="95fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们用<code class="fe mt mu mv mj b">useMemo</code>钩子创建<code class="fe mt mu mv mj b">parts</code>变量。</p><p id="bef3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它的回调函数返回一个对象，其中包含我们输入的部分和我们还没有输入的部分。</p><p id="76e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有我们输入的部分。</p><p id="5e9c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有我们尚未输入的部分。</p><p id="3f57" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过计算最后一个索引得到<code class="fe mt mu mv mj b">matchedPart</code>，在这个索引中，我们输入的文本与<code class="fe mt mu mv mj b">text</code>字符串中的内容相匹配。</p><p id="e344" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们分割<code class="fe mt mu mv mj b">textToType</code>字符串并将其存储在<code class="fe mt mu mv mj b">splitTextToType</code>中</p><p id="2b24" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们循环遍历<code class="fe mt mu mv mj b">splitTextToType</code>，得到<code class="fe mt mu mv mj b">typedText</code>的第一个与<code class="fe mt mu mv mj b">splitTextToType</code>数组不匹配的索引。</p><p id="b14d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们定义开始测试的<code class="fe mt mu mv mj b">start</code>函数。</p><p id="a682" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe mt mu mv mj b">setInterval</code>来创建设置<code class="fe mt mu mv mj b">elaspedMs</code>状态的定时器。</p><p id="64b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它还将<code class="fe mt mu mv mj b">started</code>状态设置为<code class="fe mt mu mv mj b">false</code>。</p><p id="9b13" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回调每秒运行一次。</p><p id="2771" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe mt mu mv mj b">setTimer</code>来设置<code class="fe mt mu mv mj b">timer</code>值。</p><p id="77bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">restart</code>功能只是将数值重置为初始值。</p><p id="8ed4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe mt mu mv mj b">useEffect</code>回调中，我们检查<code class="fe mt mu mv mj b">parts.unmatchedPart</code>属性的长度，并清除<code class="fe mt mu mv mj b">clearInterval</code>为<code class="fe mt mu mv mj b">unmatchedPart</code>为1的计时器。</p><p id="d9ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe mt mu mv mj b">setWpm</code>来设置每分钟的字数。</p><p id="06e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个数组包含我们正在观察的反应状态，只要其中任何一个发生变化，回调就会运行。</p><p id="bd3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe mt mu mv mj b">parts.unmatchedPart.length &gt; 1</code>检查测试是否完成。</p><p id="f0ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果<code class="fe mt mu mv mj b">parts.unmatchedPart.length &gt; 1</code>是<code class="fe mt mu mv mj b">true</code>，那么测试还没有完成，所以我们呈现了已键入和未键入的文本。</p><p id="79ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们渲染按钮让ys开始测试。</p><p id="d2af" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个文本区域让用户输入测试。</p><p id="7b36" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果<code class="fe mt mu mv mj b">started</code>是<code class="fe mt mu mv mj b">false</code>，我们禁用文本区域。</p><p id="4fae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe mt mu mv mj b">value</code>和<code class="fe mt mu mv mj b">onChange</code>获取并设置输入的值。</p><p id="25ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，测试完成，我们显示每分钟的单词和一个按钮，我们可以单击该按钮重新开始测试。</p><h1 id="a20f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="85dd" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用React和JavaScript轻松创建一个类型测试。</p><p id="0e46" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mw">更多内容请看</em><a class="ae kc" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mw">plain English . io</em></strong></a></p></div></div>    
</body>
</html>