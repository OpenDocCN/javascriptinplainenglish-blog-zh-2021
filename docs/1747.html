<html>
<head>
<title>What are Polyfills?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是Polyfills？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/polyfills-what-the-hell-are-they-596baaab4a0e?source=collection_archive---------16-----------------------#2021-04-13">https://javascript.plainenglish.io/polyfills-what-the-hell-are-they-596baaab4a0e?source=collection_archive---------16-----------------------#2021-04-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="f582" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">您如何创建Polyfill？</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/fc7bddbec30c6deb329de8152c865f03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vqzJMrEKxV_oFugT"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://www.pexels.com/@deepanker70" rel="noopener ugc nofollow" target="_blank">Deepanker Verma</a> on <a class="ae ks" href="https://www.pexels.com/photo/black-google-smartphone-on-box-1482061/" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><h1 id="3484" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">介绍</h1><p id="4d97" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">当建立一个网站时，确保它在所有主要浏览器上一致工作是很重要的。毕竟，每个浏览器在它提供的开发功能上都是独一无二的。</p><p id="6124" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">例如，查看以下图表:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mm"><img src="../Images/9e4ac56fd76f3eea88ca05424f10b47c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4x8bQmojT63xdtkeV6dQZw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Diagram by <a class="ae ks" href="https://github.com/guybedford" rel="noopener ugc nofollow" target="_blank">guybedford</a> on <a class="ae ks" href="https://github.com/guybedford/es-module-shims" rel="noopener ugc nofollow" target="_blank">Github</a></figcaption></figure><p id="e8b2" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">上图列出了ECMAScript模块的特性及其对Chrome、火狐、Safari和Edge的支持。请注意，有些浏览器支持某些功能，而有些浏览器不支持。例如，如果导入地图是你的应用程序中的一个关键组件，你的应用程序会在除了Chrome之外的所有浏览器中崩溃。</p><p id="7f48" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated"><strong class="ln io">这是聚合填料进入的地方。</strong></p><h1 id="38c4" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">什么是聚合填料/聚合填充？</h1><p id="784b" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">举个例子，假设<code class="fe mn mo mp mq b">fetch</code>不是所有的浏览器都支持，我们经常在我们的应用程序中使用它。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="b4a5" class="mv ku in mq b gy mw mx l my mz">/* <br/>Let's say that Chrome supported the fetch api, but Firefox didn't.<br/>*/<br/>fetch('https://BACKEND/ROUTE').then((response) =&gt; {<br/>   console.log("Got Response");<br/> });</span></pre><p id="ceb5" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">结果，我们的应用程序会在火狐中崩溃。为了弥补这一点，我们可以为不支持它的浏览器创建自己的<code class="fe mn mo mp mq b">fetch</code>实现，并将其设置为<code class="fe mn mo mp mq b">window.fetch</code>(获取聚合池的<a class="ae ks" href="https://github.com/github/fetch" rel="noopener ugc nofollow" target="_blank">示例</a>)。这就是聚合填充。</p><p id="bc1e" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated"><strong class="ln io">如果某个特性在某个环境中不存在，我们可以用我们的实现来修补它。</strong></p><p id="fb68" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">Polyfills使我们能够使用相同的代码库支持多种环境。虽然我们需要实现polyfill，但从长远来看，创建polyfill比为每个浏览器/环境维护单独的应用程序版本更快、更容易。</p><h1 id="497b" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">制作泡沫塑料</h1><p id="01b9" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">让我们用普通的JavaScript实现一个用于网络的<code class="fe mn mo mp mq b">Array.prototype.forEach</code>poly fill。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="b103" class="mv ku in mq b gy mw mx l my mz">let fruits = ["Strawberry", "Melon", "Orange"];</span><span id="e865" class="mv ku in mq b gy na mx l my mz">// super convienent way of iterating through a collection<br/>fruits.forEach((fruit) =&gt; {<br/>    console.log("I ate", fruit);<br/>});</span></pre><p id="ca5d" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">让我们把它分成两个步骤:</p><ul class=""><li id="a522" class="nb nc in ln b lo mh lr mi lu nd ly ne mc nf mg ng nh ni nj bi translated">对Polyfill进行编码</li><li id="6921" class="nb nc in ln b lo nk lr nl lu nm ly nn mc no mg ng nh ni nj bi translated">导入Polyfill</li></ul><h2 id="4ddc" class="mv ku in bd kv np nq dn kz nr ns dp ld lu nt nu lf ly nv nw lh mc nx ny lj nz bi translated">对Polyfill进行编码</h2><p id="d955" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">首先，我们来看看当前的浏览器是否支持<code class="fe mn mo mp mq b">Array.prototype.forEach</code>。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="5770" class="mv ku in mq b gy mw mx l my mz">const isForEachSupported = !Array.prototype.forEach;</span></pre><p id="ea15" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">如果支持<code class="fe mn mo mp mq b">.forEach</code>，我们就让本机实现保持原样吧。如果它不被支持，那么我们需要添加我们的定制实现。</p><p id="5095" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">让我们将<code class="fe mn mo mp mq b">Array.prototype.forEach</code>绑定到我们的实现中。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="3d8e" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated"><em class="oc">免责声明:为简洁起见，我省略了</em><code class="fe mn mo mp mq b">thisArg</code><em class="oc"/><code class="fe mn mo mp mq b">Array.prototype.forEach</code><em class="oc">。</em></p><p id="e2a7" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">我们现在可以用自己的实现来支持没有<code class="fe mn mo mp mq b">Array.prototype.forEach</code>的浏览器。</p><h2 id="76c7" class="mv ku in bd kv np nq dn kz nr ns dp ld lu nt nu lf ly nv nw lh mc nx ny lj nz bi translated">导入Polyfill</h2><p id="fede" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">为了完成它，我们需要在我们的HTML文件中导入polyfill。polyfill文件必须在任何使用<code class="fe mn mo mp mq b">Array.prototype.forEach</code>的文件或脚本标签之前。假设以下是我们的初始HTML文件:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="0986" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">而上面的polyfill是在<code class="fe mn mo mp mq b">forEachPolyfill.js</code>。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="d6f4" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated"><strong class="ln io">恭喜恭喜！你写了你的第一封聚合邮件！</strong>然而，并非所有的聚合填充都以相同的方式完成，也不具有相同的难度。例如，看看这些<a class="ae ks" href="https://github.com/taylorhakes/promise-polyfill" rel="noopener ugc nofollow" target="_blank"> ES6承诺</a>和<a class="ae ks" href="https://github.com/github/fetch" rel="noopener ugc nofollow" target="_blank">获取</a>的聚合填充。</p><p id="50ab" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">总而言之，聚合填充包括修补环境中不支持的功能，以提供更好的向后兼容性和可用性。在本文中，我们只是尝试了一下Polyfills，如果您想深入了解，请查看<a class="ae ks" href="https://github.com/search?utf8=%E2%9C%93&amp;q=polyfill&amp;type=" rel="noopener ugc nofollow" target="_blank"> Github Polyfills </a>。</p><p id="283f" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated"><strong class="ln io">说完，感谢阅读！</strong></p><p id="c95a" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated"><em class="oc">更多内容请看</em><a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ln io"><em class="oc">plain English . io</em></strong></a></p></div></div>    
</body>
</html>