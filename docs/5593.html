<html>
<head>
<title>Implement a Search Feature with React That Works Offline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React实现一个离线工作的搜索特性</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/implement-a-search-feature-with-react-that-works-offline-ea7cbc158907?source=collection_archive---------5-----------------------#2021-11-22">https://javascript.plainenglish.io/implement-a-search-feature-with-react-that-works-offline-ea7cbc158907?source=collection_archive---------5-----------------------#2021-11-22</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="6c79" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">不要等待后端API。自己动手！</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/445ef732be0f9710412e7bc14676438f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0b8OUHXH-hUfrR6m8_EsBQ.jpeg"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@evgenit?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Evgeni Tcherkasski</a> on <a class="ae kw" href="https://unsplash.com/s/photos/search?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="252e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您正在设计一个应用程序，您需要显示一个列表或表格，其中的数据可以立即提供给您。</p><p id="2a58" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">该列表包含大约30-40条记录(或者更多)。</p><p id="d9a5" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在，您的用户需要一个搜索功能，以便他们可以轻松地过滤数据。</p><p id="f570" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">你是做什么的？</p><h1 id="afa3" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">第一选项</h1><p id="1bea" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">您可以回到后端开发人员那里，请求一个搜索API，使用数据库查询或其他方法返回匹配的数据。</p><p id="ad25" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是这使得搜索过程非常耗时。用户必须等待结果返回才能看到任何东西。</p><p id="a591" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您还必须维护API调用，以便一切按预期运行。</p><p id="6060" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">不太方便吧？</p><h1 id="7cb6" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">让我们离线做吧</h1><p id="9b9d" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">假设我们有一个用户列表。数据如下所示。你有一系列这些。</p><pre class="kh ki kj kk gu mq mr ms mt aw mu bi"><span id="a653" class="mv lu ir mr b gz mw mx l my mz">data = [<br/>   {<br/>     name: "Mohammad Faisal",<br/>     company: "Some Company",<br/>     age: 56,<br/>     address: "Dhaka, Bangladesh"<br/>   }<br/>   ... more<br/>]</span></pre><p id="a28d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">顶部有一个搜索栏，用户可以在那里搜索文本。</p><pre class="kh ki kj kk gu mq mr ms mt aw mu bi"><span id="387e" class="mv lu ir mr b gz mw mx l my mz">const [searchText , setSearchText] = useState('');</span><span id="875a" class="mv lu ir mr b gz na mx l my mz">const onTextChange = (e) =&gt; setSearchText(e.target.value);</span><span id="31cc" class="mv lu ir mr b gz na mx l my mz">return &lt;input onChange={onTextChange} /&gt;</span></pre><p id="e299" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因此，一种选择是当您的<code class="fe nb nc nd mr b">searchText</code>值改变时触发回调。</p><pre class="kh ki kj kk gu mq mr ms mt aw mu bi"><span id="bb9d" class="mv lu ir mr b gz mw mx l my mz">useEffect(() =&gt; {</span><span id="b523" class="mv lu ir mr b gz na mx l my mz">  // do the filtering here   </span><span id="ec0b" class="mv lu ir mr b gz na mx l my mz">},[searchText])</span></pre><p id="86d8" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是你如何进行搜索呢？</p><p id="09f6" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">有一些javascript函数可以帮我们完成这项工作。</p><pre class="kh ki kj kk gu mq mr ms mt aw mu bi"><span id="c92f" class="mv lu ir mr b gz mw mx l my mz">data.filter(singleUser =&gt; singleUser.name.includes(searchText))</span></pre><p id="48dd" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这很好。因此，当用户搜索文本时，列表将根据用户的<code class="fe nb nc nd mr b">name</code>属性进行过滤。</p><p id="2e83" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们也可以将此扩展到其他属性。通过一个一个的过滤。</p><pre class="kh ki kj kk gu mq mr ms mt aw mu bi"><span id="3283" class="mv lu ir mr b gz mw mx l my mz">data.filter(singleUser =&gt; {<br/>  return <br/>      singleUser.name.includes(searchText)) <strong class="mr is">|| </strong> <br/>      singleUser.address.includes(searchText))<br/>}</span></pre><p id="b8c6" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是正如你所看到的，如果你必须搜索10个字段，这可能会很快失控。你必须把所有的东西都打出来。</p><p id="196b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">不方便吧？</p><p id="561d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">让我们做得更好。</p><h1 id="bcc4" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">JSON的力量</h1><p id="6fab" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">因此，我们将利用现有的<code class="fe nb nc nd mr b">JSON.stringify()</code>和<code class="fe nb nc nd mr b">JSON.parse()</code>方法。</p><p id="3b35" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因为在一个对象内部搜索是困难的，因为我们在搜索之前可能不知道那个对象的键，所以我们不能把它们一般化。</p><p id="3553" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">所以我们将把整个对象变成一个字符串，并在其上进行搜索。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ne nf l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">useSearch.ts</figcaption></figure><p id="6f67" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您可以将这种逻辑转移到一个漂亮整洁的钩子上，以提高可用性。</p><h1 id="29c6" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">进一步改进</h1><p id="0554" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">如果用户使用正确的大写字母进行搜索，我们实现的解决方案将会工作。</p><p id="a33f" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因此，如果用户搜索<code class="fe nb nc nd mr b">faisal</code>，他们可能会同时想要两个结果</p><ul class=""><li id="52d7" class="ng nh ir kz b la lb ld le lg ni lk nj lo nk ls nl nm nn no bi translated"><code class="fe nb nc nd mr b">faisal</code>和<code class="fe nb nc nd mr b">Faisal</code></li></ul><p id="c521" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">那么我们如何解决这个问题呢？</p><p id="41a5" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们可以将字符串化的数组变成一个<code class="fe nb nc nd mr b">lower case</code>字符串。有一个javascript函数可以实现这个<code class="fe nb nc nd mr b">toLowerCase()</code></p><p id="2fe5" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">并且也将<code class="fe nb nc nd mr b">searchText</code>转换成小写来解决这个问题</p><p id="d5a6" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">最后，我们的代码将如下所示</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ne nf l"/></div></figure><p id="0d0f" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这是一个可重用的钩子，你将提供一个对象数组和一个<code class="fe nb nc nd mr b">searchText</code>，它将返回过滤后的数据。</p><p id="872e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在你有了一个功能性的离线搜索，而且速度非常快！</p></div><div class="ab cl np nq hv nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ik il im in io"><p id="05b9" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">今天到此为止！希望你学到了有趣的东西。</p><p id="06dd" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">祝您愉快！</p><p id="c228" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is">通过</strong><a class="ae kw" href="https://www.linkedin.com/in/56faisal/" rel="noopener ugc nofollow" target="_blank"><strong class="kz is">LinkedIn</strong>T5】与我联系</a></p><p id="42cc" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><em class="nw">更多内容看</em> <a class="ae kw" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> <em class="nw">说白了就是io </em> </strong> </a> <em class="nw">。报名参加我们的</em><strong class="kz is"><em class="nw"/></strong><a class="ae kw" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kz is"><em class="nw">免费每周简讯点击这里</em> </strong> </a> <em class="nw">。</em></p></div></div>    
</body>
</html>