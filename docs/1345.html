<html>
<head>
<title>Use Redux Toolkit to simplify Redux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Redux工具包简化Redux</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/use-redux-toolkit-to-simplify-redux-9f05aa9919d5?source=collection_archive---------11-----------------------#2021-03-21">https://javascript.plainenglish.io/use-redux-toolkit-to-simplify-redux-9f05aa9919d5?source=collection_archive---------11-----------------------#2021-03-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="e1c0" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">包含代码示例</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/75e1bbd679a363b9c2935e167608fd20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bs6W6c6yYS36PcD9joLVtw.png"/></div></div></figure><h1 id="7299" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated"><strong class="ak">简介</strong></h1><h2 id="8a70" class="lg kp in bd kq lh li dn ku lj lk dp ky ll lm ln la lo lp lq lc lr ls lt le lu bi translated">什么是Redux</h2><p id="9892" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated">Redux是一个用于管理应用程序状态的开源JavaScript库。它通常与React或Angular等库一起用于构建用户界面。类似于脸书的通量建筑，它是由丹阿布拉莫夫和安德鲁克拉克。</p><h2 id="2acc" class="lg kp in bd kq lh li dn ku lj lk dp ky ll lm ln la lo lp lq lc lr ls lt le lu bi translated">什么是国家管理</h2><p id="83eb" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated">状态管理是指对一个或多个用户界面控件(如文本字段、OK按钮、单选按钮等)的状态的管理。在图形用户界面中。在这种用户界面编程技术中，一个UI控件的状态依赖于其他UI控件的状态</p><h2 id="5d07" class="lg kp in bd kq lh li dn ku lj lk dp ky ll lm ln la lo lp lq lc lr ls lt le lu bi translated">什么是<a class="ae mo" href="https://redux-toolkit.js.org/introduction/getting-started" rel="noopener ugc nofollow" target="_blank"> Redux Toolkit </a></h2><p id="3e2f" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated">Redux Toolkit是一个自以为是的、包含电池的工具集，用于高效的Redux开发。</p><h2 id="6e57" class="lg kp in bd kq lh li dn ku lj lk dp ky ll lm ln la lo lp lq lc lr ls lt le lu bi translated">为什么Redux不再流行了</h2><p id="3df6" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated">React和Redux被认为是大型React应用程序中管理状态的最佳组合。然而，由于以下原因，Redux的受欢迎程度下降；</p><ul class=""><li id="624d" class="mp mq in lx b ly mr mb ms ll mt lo mu lr mv mn mw mx my mz bi translated">“配置Redux存储太复杂”</li><li id="f95c" class="mp mq in lx b ly na mb nb ll nc lo nd lr ne mn mw mx my mz bi translated">“我必须添加许多包才能让Redux做任何有用的事情”</li><li id="67db" class="mp mq in lx b ly na mb nb ll nc lo nd lr ne mn mw mx my mz bi translated">“Redux需要太多样板代码”</li></ul><h2 id="4610" class="lg kp in bd kq lh li dn ku lj lk dp ky ll lm ln la lo lp lq lc lr ls lt le lu bi translated">Redux拯救工具包</h2><p id="beaa" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated">Redux toolkit旨在解决上述问题。Redux工具包的特性包括:</p><p id="401c" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated"><strong class="lx io"> Simple: </strong>包括简化常见用例的实用程序，比如存储设置、创建reducers、不可变更新逻辑等等。</p><p id="3a4e" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated"><strong class="lx io">固执己见</strong>:为商店设置提供良好的默认设置，包括最常用的内置Redux插件。</p><p id="6ba3" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated"><strong class="lx io">功能强大:</strong>从Immer和Autodux等库获得灵感，让您编写“可变的”不可变更新逻辑，甚至自动创建完整的状态“切片”。</p><p id="93b2" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated"><strong class="lx io">有效</strong>:让您专注于应用程序所需的核心逻辑，这样您就可以用更少的代码做更多的工作。</p><h1 id="2d95" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">Redux工具包包括什么</h1><p id="83ed" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated">Redux Toolkit包括这些API:</p><ul class=""><li id="dcb3" class="mp mq in lx b ly mr mb ms ll mt lo mu lr mv mn mw mx my mz bi translated"><code class="fe ni nj nk nl b"><a class="ae mo" href="https://redux-toolkit.js.org/api/configureStore" rel="noopener ugc nofollow" target="_blank">configureStore()</a></code>:如果你熟悉原始的Redux，你会知道我们使用<code class="fe ni nj nk nl b">createStore</code>来创建实际的商店。在Redux Toolkit中，我们将使用<code class="fe ni nj nk nl b"><a class="ae mo" href="https://redux-toolkit.js.org/api/configureStore" rel="noopener ugc nofollow" target="_blank">configureStore()</a></code>来代替。它做的事情和<code class="fe ni nj nk nl b">createStore</code>一样，但是它以一种容易理解的方式自动组合一些减速器。默认情况下，它还包括<code class="fe ni nj nk nl b">redux-thunk</code>，并支持使用Redux DevTools扩展。</li><li id="8f12" class="mp mq in lx b ly na mb nb ll nc lo nd lr ne mn mw mx my mz bi translated">通过将Redux reducer函数定义为函数的查找表来处理每种动作类型，简化了Redux reducer函数的创建。它还允许您通过在reducers中编写“可变的”代码来大大简化不可变的更新逻辑。</li><li id="62b8" class="mp mq in lx b ly na mb nb ll nc lo nd lr ne mn mw mx my mz bi translated"><code class="fe ni nj nk nl b"><a class="ae mo" href="https://redux-toolkit.js.org/api/createAction" rel="noopener ugc nofollow" target="_blank">createAction()</a></code>:接受动作类型字符串并返回使用该类型的动作创建函数。</li><li id="c6cf" class="mp mq in lx b ly na mb nb ll nc lo nd lr ne mn mw mx my mz bi translated"><code class="fe ni nj nk nl b"><a class="ae mo" href="https://redux-toolkit.js.org/api/createSlice" rel="noopener ugc nofollow" target="_blank">createSlice()</a></code>:接受一个reducer函数的对象、一个切片名称、一个初始状态值，自动生成一个切片reducer，并带有相应的动作创建者和动作类型。</li><li id="4105" class="mp mq in lx b ly na mb nb ll nc lo nd lr ne mn mw mx my mz bi translated"><code class="fe ni nj nk nl b"><a class="ae mo" href="https://redux-toolkit.js.org/api/createAsyncThunk" rel="noopener ugc nofollow" target="_blank">createAsyncThunk</a></code>:接受一个动作类型字符串和一个返回承诺的函数，并基于该承诺生成一个调度<code class="fe ni nj nk nl b">pending/fulfilled/rejected</code>动作类型的thunk。</li><li id="8555" class="mp mq in lx b ly na mb nb ll nc lo nd lr ne mn mw mx my mz bi translated"><code class="fe ni nj nk nl b"><a class="ae mo" href="https://redux-toolkit.js.org/api/createEntityAdapter" rel="noopener ugc nofollow" target="_blank">createEntityAdapter</a></code>:生成一组可重用的归约器和选择器，管理存储中的规范化数据。</li><li id="c010" class="mp mq in lx b ly na mb nb ll nc lo nd lr ne mn mw mx my mz bi translated"><a class="ae mo" href="https://github.com/reduxjs/reselect" rel="noopener ugc nofollow" target="_blank">中的<code class="fe ni nj nk nl b"><a class="ae mo" href="https://redux-toolkit.js.org/api/createSelector" rel="noopener ugc nofollow" target="_blank">createSelector</a></code> <a class="ae mo" href="https://redux-toolkit.js.org/api/createSelector" rel="noopener ugc nofollow" target="_blank">实用程序</a>重新选择</a>库，重新导出以方便使用。</li></ul><h1 id="9d74" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">让我们再深入一点</h1><h2 id="f604" class="lg kp in bd kq lh li dn ku lj lk dp ky ll lm ln la lo lp lq lc lr ls lt le lu bi translated">配置存储()</h2><p id="a6bb" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated"><code class="fe ni nj nk nl b">configureStore</code>接受单个配置对象参数，具有以下选项</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="53e4" class="lg kp in bd kq lh li dn ku lj lk dp ky ll lm ln la lo lp lq lc lr ls lt le lu bi translated">getdefaultMiddleware()</h2><p id="69d4" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated">默认情况下，<code class="fe ni nj nk nl b"><a class="ae mo" href="https://soyoung210.github.io/redux-toolkit/api/configureStore" rel="noopener ugc nofollow" target="_blank">configureStore</a></code>会自动向Redux store设置添加一些中间件。</p><pre class="kd ke kf kg gt no nl np nq aw nr bi"><span id="f4ae" class="lg kp in nl b gy ns nt l nu nv">const store = configureStore({<br/>  reducer: rootReducer<br/>})<br/>// Store has one or more middleware added, because the middleware list was not customized</span></pre><p id="f314" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated">如果您想要定制中间件列表，您可以向<code class="fe ni nj nk nl b">configureStore</code>提供一组中间件函数:</p><pre class="kd ke kf kg gt no nl np nq aw nr bi"><span id="c78d" class="lg kp in nl b gy ns nt l nu nv">const store = configureStore({<br/>  reducer: rootReducer,<br/>  middleware: [thunk, logger]<br/>})<br/>// Store specifically has the thunk and logger middleware applied</span></pre><p id="f764" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated">然而，当您提供<code class="fe ni nj nk nl b">middleware</code>选项时，您需要负责定义<em class="nw">所有您想添加到商店中的中间件。<code class="fe ni nj nk nl b">configureStore</code>除了您列出的以外，我不会增加任何额外的中间件。</em></p><p id="8132" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated"><code class="fe ni nj nk nl b">getDefaultMiddleware</code>如果你想添加一些定制的中间件是有用的，但也仍然希望有默认的中间件被添加:</p><pre class="kd ke kf kg gt no nl np nq aw nr bi"><span id="fe52" class="lg kp in nl b gy ns nt l nu nv">const store = configureStore({<br/>  reducer: rootReducer,<br/>  middleware: [...getDefaultMiddleware(), logger]<br/>})<br/>// Store has all of the default middleware added, _plus_ the logger middleware</span></pre><h2 id="7e59" class="lg kp in bd kq lh li dn ku lj lk dp ky ll lm ln la lo lp lq lc lr ls lt le lu bi translated">createReducer()</h2><p id="5b4c" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated">redux<a class="ae mo" href="https://redux.js.org/basics/reducers" rel="noopener ugc nofollow" target="_blank">reduce</a>通常使用<code class="fe ni nj nk nl b">switch</code>语句来实现，每个已处理的动作类型都有一个<code class="fe ni nj nk nl b">case</code>。</p><pre class="kd ke kf kg gt no nl np nq aw nr bi"><span id="5ef6" class="lg kp in nl b gy ns nt l nu nv">function counterReducer(state = 0, action) {<br/>  switch (action.type) {<br/>    case 'increment':<br/>      return state + action.payload<br/>    case 'decrement':<br/>      return state - action.payload<br/>    default:<br/>      return stat<br/>  }<br/>}</span></pre><p id="f7eb" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated">这种方法效果很好，但容易出错，也容易遗忘<code class="fe ni nj nk nl b">default</code>情况或设置初始状态。</p><p id="2c4d" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated"><strong class="lx io">创建减速器()进行救援</strong></p><p id="af4a" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated"><code class="fe ni nj nk nl b">createReducer</code>有两个论点。第一个是初始状态。第二个是从动作类型到<em class="nw">用例缩减器</em>的对象映射，每个用例缩减器处理一个特定的动作类型。</p><pre class="kd ke kf kg gt no nl np nq aw nr bi"><span id="ca5a" class="lg kp in nl b gy ns nt l nu nv">const counterReducer = createReducer(0, {<br/>  increment: (state, action) =&gt; state + action.payload,<br/>  decrement: (state, action) =&gt; state - action.payload<br/>})</span></pre><h2 id="0694" class="lg kp in bd kq lh li dn ku lj lk dp ky ll lm ln la lo lp lq lc lr ls lt le lu bi translated">createAction()</h2><p id="2035" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated">如前所述，<code class="fe ni nj nk nl b">createAction</code>助手将这两个声明合并为一个。它采用一个动作类型，并返回该类型的动作创建者。可以在没有参数的情况下调用动作创建器，也可以将<code class="fe ni nj nk nl b">payload</code>附加到动作中。此外，动作创建者覆盖<a class="ae mo" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/toString" rel="noopener ugc nofollow" target="_blank">到字符串()</a>以便动作类型成为其字符串表示。</p><pre class="kd ke kf kg gt no nl np nq aw nr bi"><span id="afbe" class="lg kp in nl b gy ns nt l nu nv">const increment = createAction('counter/increment')<br/>const decrement = createAction('counter/decrement')<br/>const counterReducer = createReducer(0, {<br/>  [increment]: (state, action) =&gt; state + action.payload,<br/>  [decrement]: (state, action) =&gt; state - action.payload<br/>})</span></pre><h2 id="0044" class="lg kp in bd kq lh li dn ku lj lk dp ky ll lm ln la lo lp lq lc lr ls lt le lu bi translated">创建虱子()</h2><p id="4959" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated">一种接受初始状态、充满缩减器功能的对象和“切片名称”的功能，并自动生成与缩减器和状态相对应的动作创建者和动作类型。</p><p id="77e1" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated"><strong class="lx io">示例</strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="6e73" class="lg kp in bd kq lh li dn ku lj lk dp ky ll lm ln la lo lp lq lc lr ls lt le lu bi translated">createAsyncThnuk()</h2><p id="1e1b" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated">一个接受Redux操作类型字符串的函数和一个应该返回承诺的回调函数。它基于所提供的动作类型生成承诺生命周期动作类型，并返回一个thunk动作创建者，该创建者将运行承诺回调并基于返回的承诺分派生命周期动作。</p><p id="5f38" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated"><strong class="lx io">用法</strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="961b" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">结论</h1><p id="23d5" class="pw-post-body-paragraph lv lw in lx b ly lz jo ma mb mc jr md ll me mf mg lo mh mi mj lr mk ml mm mn ig bi translated">如果你开始使用reaction-redux，我会建议你使用redux工具包，因为它更容易阅读和理解。它还抽象了许多样板代码，这些代码通常会导致不必要的复杂情况，尤其是对于初学者来说。</p><p id="746c" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated">总之，Redux是一个很棒的状态管理库，它不仅仅是为React生态系统而构建的。它可以被整合到其他框架中，比如<a class="ae mo" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular </a>和<a class="ae mo" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue。</a></p><p id="02e5" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated">在他们的<a class="ae mo" href="https://redux-toolkit.js.org/introduction/getting-started" rel="noopener ugc nofollow" target="_blank"> <em class="nw">文档</em> </a>中阅读更多关于Redux Toolkit的信息</p><p id="b5fd" class="pw-post-body-paragraph lv lw in lx b ly mr jo ma mb ms jr md ll nf mf mg lo ng mi mj lr nh ml mm mn ig bi translated"><strong class="lx io">快乐编码！</strong></p></div></div>    
</body>
</html>