<html>
<head>
<title>Async/Await: The Easy Way to Fetch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Async/Await:简单的获取方式</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/async-await-the-easy-way-to-fetch-e490efd2e298?source=collection_archive---------5-----------------------#2021-07-20">https://javascript.plainenglish.io/async-await-the-easy-way-to-fetch-e490efd2e298?source=collection_archive---------5-----------------------#2021-07-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/3a585f9b14ef219c03a76cbd691962ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8vS21ULJDDzbPJNx"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@baciutudor?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tudor Baciu</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="86cd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要理解Async/Await，您首先必须理解承诺是什么以及它们是如何工作的:</p><blockquote class="ky"><p id="4b84" class="kz la in bd lb lc ld le lf lg lh kx dk translated"><em class="li"> JavaScript是单线程的，意味着两个位的脚本不能同时运行；他们不得不一个接一个地跑。承诺是表示异步操作的最终完成(或失败)及其结果值的对象。—freecodecamp.org</em></p></blockquote><p id="ecef" class="pw-post-body-paragraph ka kb in kc b kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt ln kv kw kx ig bi translated">首先，把承诺想象成一个回调函数，它在JavaScript代码中异步运行。它不必等待其他代码，其他代码也不必等待它。它自己独立执行。它用于当你需要在后台做一些需要很长时间的事情，并且你想在事情完成后马上做一些事情，而不是让其他事情等待。</p><p id="017f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我认为最好从实际意义上解释承诺，而不是像大多数教程那样:</p><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/d9b1ff5188b9a74d5877cec8ee347f95.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*_P5OWiuJszXhWT44_fEDmw.png"/></div></figure><p id="f78c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里我们有一个函数，通过从一个赋给变量(IMG URL)的URL获取图像来“加载图像”。在“获取”这些图像后，它返回一个包含响应的承诺。棘手的部分是弄清楚<code class="fe lt lu lv lw b">.then()</code>是如何工作的。</p><p id="fa9f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe lt lu lv lw b">.then()</code>还一个承诺。它需要两个参数:针对承诺成功和失败情况的回调函数。标记为<code class="fe lt lu lv lw b">r</code>的变量是最初获取的响应，这是之前完成的承诺。</p><p id="f2fb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如下所示:</p><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lx"><img src="../Images/302ff27702f50eeaca17dd130c76b43c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wKbPfcbrrN23U0mmAPOloA.png"/></div></div></figure><p id="820e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们把<code class="fe lt lu lv lw b">console.log(r)</code>改成<code class="fe lt lu lv lw b">console.log(r.json())</code>。如果刷新页面，您会在控制台中看到以下内容:</p><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ly"><img src="../Images/eed20a55b5b7989119da8413118acae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eHQf-vkhw9f_AwChTESleg.png"/></div></div></figure><p id="f861" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">意识到上面写着“承诺{ <pending> }”。现在让我们从<code class="fe lt lu lv lw b">console.log(r.json())</code>中移除<code class="fe lt lu lv lw b">console.log</code>并再次刷新页面。我们实现了承诺，现在我们得到了一个我们标记为“数据”的对象</pending></p><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lz"><img src="../Images/3406c2e3f02887096ec7df7b3b408e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s4nDGKzmQxn1uJCWle54xg.png"/></div></div></figure><p id="7877" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这里，您可以实现一个回调函数，通过使用“data”作为参数来操纵数据:</p><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/ca16f85b0d759115e71e2c34d3b8942c.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*fZgaz0A9MHCSJJ4CeOc0CQ.png"/></div></figure><p id="646e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们已经对承诺和响应有所了解，让我们用Async/Await语法重构相同的代码块:</p><figure class="lp lq lr ls gt jo gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/e1ef415b6a75efda0a2606d601424697.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*HYT4q3Mg69XkQB31S-R38g.png"/></div></figure><p id="e03e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">关键字<code class="fe lt lu lv lw b">async</code>让javaScript知道函数应该异步运行。<code class="fe lt lu lv lw b">await</code>关键字基本上是在说“等到下面的代码完成后再执行下一件事”。这和我们之前做的完全一样，只是增加了一点语法上的东西。在深入研究Async/Await之前，对<code class="fe lt lu lv lw b">fetch</code>和<code class="fe lt lu lv lw b">.then()</code>有一个基本的了解是很重要的。</p><p id="b5c2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">希望这有所帮助。</p><p id="765f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mc">更多内容看</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="mc">plain English . io</em></strong></a></p></div></div>    
</body>
</html>