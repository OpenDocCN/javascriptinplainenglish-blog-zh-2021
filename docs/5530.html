<html>
<head>
<title>Create a WhatsApp Clone with Next.js: Switch to Showing Users or Chats</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Next.js创建一个WhatsApp克隆:切换到显示用户或聊天</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-whatsapp-clone-with-next-js-part-25-switch-to-showing-users-or-chats-9718796fef7c?source=collection_archive---------16-----------------------#2021-11-16">https://javascript.plainenglish.io/create-whatsapp-clone-with-next-js-part-25-switch-to-showing-users-or-chats-9718796fef7c?source=collection_archive---------16-----------------------#2021-11-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2854" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第25部分:使用React useRef确定输入区域</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6c87d263564cfadb10d94808768116b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NwVQW8gwcluzjtwK"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@rachitank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Rachit Tank</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8d5a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在前面的部分中，我们已经可以获得聊天数组和用户数组。我们现在想做的是，如果用户点击搜索，侧边栏应该向用户显示，这样用户就可以点击它并创建一个新的聊天。</p><p id="5c24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们需要从React导入useRef，并使用useRef创建inputAreaRef。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="3f4b" class="lx ly iq lt b gy lz ma l mb mc">const inputAreaRef = useRef(null);</span></pre><p id="b2d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们将inputAreaRef放在<searchinput>组件中。</searchinput></p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="a2cd" class="lx ly iq lt b gy lz ma l mb mc">&lt;SearchInput ref={inputAreaRef} placeholder="Search or start a new chat"/&gt;</span></pre><p id="4129" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还需要创建一个名为“searchFriends”的状态，默认为false，如果searchFriends为true，则显示用户数组，否则显示聊天数组。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="2438" class="lx ly iq lt b gy lz ma l mb mc">const [searchFriends, setSearchFriends] = useState(false);</span></pre><p id="7666" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加useEffect检查输入区是否未被点击，设置搜索好友为false。否则设置搜索好友为真。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="0067" class="lx ly iq lt b gy lz ma l mb mc">useEffect(() =&gt; {</span><span id="7123" class="lx ly iq lt b gy md ma l mb mc">const checkIfClickedOutside = e =&gt; {</span><span id="7d66" class="lx ly iq lt b gy md ma l mb mc">if (!inputAreaRef.current.contains(e.target)) {</span><span id="8acc" class="lx ly iq lt b gy md ma l mb mc">console.log('Outside input area');</span><span id="9149" class="lx ly iq lt b gy md ma l mb mc">setTimeout(() =&gt; {</span><span id="f062" class="lx ly iq lt b gy md ma l mb mc">setSearchFriends(false);</span><span id="9f44" class="lx ly iq lt b gy md ma l mb mc">}, 3000);</span><span id="2000" class="lx ly iq lt b gy md ma l mb mc">} else {</span><span id="08e4" class="lx ly iq lt b gy md ma l mb mc">console.log('Inside input area');</span><span id="d5f1" class="lx ly iq lt b gy md ma l mb mc">setSearchFriends(true);</span><span id="144b" class="lx ly iq lt b gy md ma l mb mc">}</span><span id="57ef" class="lx ly iq lt b gy md ma l mb mc">}</span><span id="1e81" class="lx ly iq lt b gy md ma l mb mc">document.addEventListener("mousedown", checkIfClickedOutside)</span><span id="554d" class="lx ly iq lt b gy md ma l mb mc">return () =&gt; {</span><span id="cda2" class="lx ly iq lt b gy md ma l mb mc">document.removeEventListener("mousedown", checkIfClickedOutside)</span><span id="9e24" class="lx ly iq lt b gy md ma l mb mc">}</span><span id="e48f" class="lx ly iq lt b gy md ma l mb mc">}, [])</span></pre><p id="bca4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在呈现部分，当searchFriends为true时，它将遍历friends数组。否则，它将在chats数组中循环。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="232e" class="lx ly iq lt b gy lz ma l mb mc">{searchFriends ? &lt;&gt;</span><span id="0c5d" class="lx ly iq lt b gy md ma l mb mc">{friends.map(friend =&gt; (</span><span id="f3f5" class="lx ly iq lt b gy md ma l mb mc">&lt;Friend key={friend.id} photoURL={friend.photoURL} displayName={friend.displayName} id={friend.id} /&gt;</span><span id="2a32" class="lx ly iq lt b gy md ma l mb mc">))}</span><span id="08ad" class="lx ly iq lt b gy md ma l mb mc">&lt;/&gt; : &lt;&gt;</span><span id="f271" class="lx ly iq lt b gy md ma l mb mc">{chats.map(chat =&gt; &lt;Chat key={chat.id} id={chat.id} users={chat.users} latestMessage={chat.latestMessage} timestamp={chat.timestamp} /&gt;)}</span><span id="f175" class="lx ly iq lt b gy md ma l mb mc">&lt;/&gt;</span><span id="3ac4" class="lx ly iq lt b gy md ma l mb mc">}</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi me"><img src="../Images/b6dfb7133fdd98f306faeaa6e53910ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*CWn_v4A05_ZPNGYY5TQRLw.gif"/></div></div></figure><h1 id="4d9b" class="mf ly iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">关注我们:<a class="ae kv" href="https://www.youtube.com/channel/UCu4-4FnutvSHVo9WHvq80Ww?sub_confirmation=1" rel="noopener ugc nofollow" target="_blank"> YouTube </a>，<a class="ae kv" href="https://ckmobile.medium.com/" rel="noopener"> Medium </a>，<a class="ae kv" href="https://www.udemy.com/user/cyruschan2/" rel="noopener ugc nofollow" target="_blank"> Udemy </a>，<a class="ae kv" href="https://www.linkedin.com/company/ckmobi/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>，<a class="ae kv" href="https://twitter.com/ckmobilejavasc1" rel="noopener ugc nofollow" target="_blank"> Twitter </a>，<a class="ae kv" href="https://www.instagram.com/ckmobile8050" rel="noopener ugc nofollow" target="_blank"> Instagram </a>，<a class="ae kv" href="https://app.gumroad.com/ckmobile" rel="noopener ugc nofollow" target="_blank"> Gumroad </a></h1><p id="9e52" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">加入分支机构赚钱</p><div class="nb nc gp gr nd ne"><a href="https://ckmobile.gumroad.com/affiliates" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd ir gy z fp nj fr fs nk fu fw ip bi translated">Gumroad</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">申请成为会员很容易。填写下表，让Ckmobile知道您将如何推广他们的…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">ckmobile.gumroad.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns kp ne"/></div></div></a></div><p id="b63d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nt">更多内容看</em> <a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="nt">说白了就是</em> </strong> </a> <strong class="ky ir"> <em class="nt">。</em> </strong> <em class="nt">报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="nt">免费每周简讯这里</em> </strong> </a> <strong class="ky ir"> <em class="nt">。</em> </strong></p></div></div>    
</body>
</html>