<html>
<head>
<title>Custom Hook in React for calling API — useApi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React中用于调用API的自定义挂钩— useApi</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/custom-hook-in-react-js-for-calling-api-useapi-7de24b42729c?source=collection_archive---------1-----------------------#2021-05-19">https://javascript.plainenglish.io/custom-hook-in-react-js-for-calling-api-useapi-7de24b42729c?source=collection_archive---------1-----------------------#2021-05-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/29f24aea84d871f513c068349344e2c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*ZxUUc0S7fpy2T56RbcH3bA.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk">custom hooks useApi</figcaption></figure><figure class="jv jw jx jy gt jo"><div class="bz fp l di"><div class="jz ka l"/></div></figure><h1 id="488b" class="kb kc in bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">介绍</h1><p id="a62e" class="pw-post-body-paragraph kz la in lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">在这篇博客中，我们将了解什么是自定义钩子，并构建一个——use Api—用可重用的逻辑从API获取数据。</p><blockquote class="lx ly lz"><p id="7537" class="kz la ma lb b lc mb le lf lg mc li lj md me lm ln mf mg lq lr mh mi lu lv lw ig bi translated"><em class="in">本博客最初发表于</em><a class="ae mj" href="https://www.gyaanibuddy.com/blog/custom-hook-in-react-js-for-calling-api-useapi/" rel="noopener ugc nofollow" target="_blank">https://www . gyaanibuddy . com/blog/custom-hook-in-react-js-for-calling-API-use API/</a><br/><strong class="lb io">我也将很快发表于</strong><a class="ae mj" href="https://www.geeksforgeeks.org/" rel="noopener ugc nofollow" target="_blank"><strong class="lb io">geeks forgeeks</strong></a></p></blockquote><h1 id="8d83" class="kb kc in bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">什么是自定义挂钩？</h1><p id="c18f" class="pw-post-body-paragraph kz la in lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">自定义钩子是一个JavaScript函数，它的名字以“<strong class="lb io"> use </strong>开始，并且可以调用其他钩子。自定义挂钩允许您将一些组件逻辑提取到一个可重用的函数中。</p><blockquote class="lx ly lz"><p id="b394" class="kz la ma lb b lc mb le lf lg mc li lj md me lm ln mf mg lq lr mh mi lu lv lw ig bi translated"><em class="in">简单来说，它以react的方式编写可以在不同组件之间共享的可重用逻辑。</em></p></blockquote><h1 id="8f5e" class="kb kc in bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">我们在建造什么？</h1><p id="c9b2" class="pw-post-body-paragraph kz la in lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">我们将构建一个名为<strong class="lb io"> useApi </strong>的定制钩子，它将使通常的重复Api获取代码可重用。</p><h1 id="799f" class="kb kc in bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">我们用的是什么API？</h1><p id="c6f3" class="pw-post-body-paragraph kz la in lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">我们将使用<a class="ae mj" href="https://jsonplaceholder.typicode.com/users" rel="noopener ugc nofollow" target="_blank"><strong class="lb io">https://jsonplaceholder.typicode.com/users</strong></a>这是一个免费的在线REST API，你可以在任何时候需要一些虚假的用户数据时使用。</p><p id="f591" class="pw-post-body-paragraph kz la in lb b lc mb le lf lg mc li lj lk me lm ln lo mg lq lr ls mi lu lv lw ig bi translated">如果您访问上面提到的URL，它将返回一个用户数组。首先，用户对象的结构如下所示。</p><figure class="jv jw jx jy gt jo gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/7a314395938597e70596d43a5fbe56e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*GZ8RxE0oIXovmEZK9ocK_g.png"/></div></figure><h1 id="f47f" class="kb kc in bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">为了理解定制钩子的好处，让我们看看如何进行API调用</h1><p id="344e" class="pw-post-body-paragraph kz la in lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">我们需要的最基本的东西之一是调用从服务器获取数据的方法，当从服务器获取数据时，我们显示一个加载屏幕。我们通常需要在网站的不同地方重复这一点。</p><p id="d495" class="pw-post-body-paragraph kz la in lb b lc mb le lf lg mc li lj lk me lm ln lo mg lq lr ls mi lu lv lw ig bi translated"><em class="ma">所以我们在需要取数据的时候通常会做的是:<br/> 1。显示加载屏幕。<br/> 2。打电话给API。<br/> 3。一旦我们从服务器上得到数据。<br/> 4。停止装载。<br/> 5。基于用例呈现/使用数据。</em></p><figure class="jv jw jx jy gt jo"><div class="bz fp l di"><div class="ml ka l"/></div></figure><p id="7519" class="pw-post-body-paragraph kz la in lb b lc mb le lf lg mc li lj lk me lm ln lo mg lq lr ls mi lu lv lw ig bi translated">如果您在浏览器控制台中打印数据，这就是API返回的内容。</p><figure class="jv jw jx jy gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi mm"><img src="../Images/bc9bb8fc6e51776b0d0d1347adc2aea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HeUUzrgyx2AfLFr50N36EQ.png"/></div></div></figure><blockquote class="lx ly lz"><p id="f66b" class="kz la ma lb b lc mb le lf lg mc li lj md me lm ln mf mg lq lr mh mi lu lv lw ig bi translated">嗯，一切看起来都很好，但是想想这样一种情况，我们在代码库的不同部分有许多Api调用，在这种情况下，我们需要一次又一次地编写这个<strong class="lb io"> fetchApi </strong>函数、<strong class="lb io">加载、响应数据逻辑</strong>，也就是说，我们在重复自己。相反，我们可以做的是想出一种方法来重用逻辑。代码文件也会变得不必要的混乱。这就是为什么我们需要定制钩子。</p></blockquote><h1 id="4cb7" class="kb kc in bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">定制挂钩方法</h1><ul class=""><li id="2507" class="mr ms in lb b lc ld lg lh lk mt lo mu ls mv lw mw mx my mz bi translated">创建一个新文件“<strong class="lb io"> useApi.js </strong>”。注意，这个名字必须以“<strong class="lb io">开头，使用</strong>”。</li><li id="254c" class="mr ms in lb b lc na lg nb lk nc lo nd ls ne lw mw mx my mz bi translated">我们只是将我们的<strong class="lb io"> App.js </strong>代码粘贴到这个文件中，并做了一些修改。你可以看到的一个变化是，它返回一些变量，而不是JSX。</li></ul><figure class="jv jw jx jy gt jo"><div class="bz fp l di"><div class="ml ka l"/></div></figure><p id="122f" class="pw-post-body-paragraph kz la in lb b lc mb le lf lg mc li lj lk me lm ln lo mg lq lr ls mi lu lv lw ig bi translated">要理解我们为什么需要这个文件，可以把它想象成一个包含<strong class="lb io">可重用代码</strong>的文件。这是我们提取代码的地方，这些代码会在任何地方重复出现，但是现在都在一个文件中。</p><p id="d078" class="pw-post-body-paragraph kz la in lb b lc mb le lf lg mc li lj lk me lm ln lo mg lq lr ls mi lu lv lw ig bi translated">我们现在需要做的就是在App.js中调用这个<strong class="lb io"> useApi </strong>，并<strong class="lb io">移除</strong>获取逻辑，因为我们已经将它提取到我们的自定义钩子<strong class="lb io"> useApi中。</strong></p><p id="8cd0" class="pw-post-body-paragraph kz la in lb b lc mb le lf lg mc li lj lk me lm ln lo mg lq lr ls mi lu lv lw ig bi translated"><strong class="lb io">新App.js </strong></p><figure class="jv jw jx jy gt jo"><div class="bz fp l di"><div class="ml ka l"/></div></figure><p id="3bcc" class="pw-post-body-paragraph kz la in lb b lc mb le lf lg mc li lj lk me lm ln lo mg lq lr ls mi lu lv lw ig bi translated">我们清楚地看到代码行数减少了，代码看起来更整洁了。这就是定制钩子的力量。</p><p id="f211" class="pw-post-body-paragraph kz la in lb b lc mb le lf lg mc li lj lk me lm ln lo mg lq lr ls mi lu lv lw ig bi translated">您可以通过添加fetch API的不同参数(如方法、头、主体等)来使这个钩子高度可定制，但是现在，为了便于理解定制钩子的需要和概念，我将保持它的简单性。</p></div><div class="ab cl nf ng hr nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ig ih ii ij ik"><p id="56f6" class="pw-post-body-paragraph kz la in lb b lc mb le lf lg mc li lj lk me lm ln lo mg lq lr ls mi lu lv lw ig bi translated"><strong class="lb io">搞定！<br/> </strong> <em class="ma">本博客到此为止。如果你觉得这个博客有帮助，鼓掌并与你的朋友分享。</em></p><p id="8a12" class="pw-post-body-paragraph kz la in lb b lc mb le lf lg mc li lj lk me lm ln lo mg lq lr ls mi lu lv lw ig bi translated"><strong class="lb io">参考文献:<br/> </strong>协同进化反应过来:</p><div class="nm nn gp gr no np"><a href="https://www.youtube.com/channel/UC80PWRj_ZU8Zu0HSMNVwKWw" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd io gy z fp nu fr fs nv fu fw im bi translated">共同进化</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">web开发最新技术教程！</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">www.youtube.com</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od jp np"/></div></div></a></div><p id="2506" class="pw-post-body-paragraph kz la in lb b lc mb le lf lg mc li lj lk me lm ln lo mg lq lr ls mi lu lv lw ig bi translated">本·阿瓦德反应过来:</p><figure class="jv jw jx jy gt jo"><div class="bz fp l di"><div class="oe ka l"/></div></figure><p id="67db" class="pw-post-body-paragraph kz la in lb b lc mb le lf lg mc li lj lk me lm ln lo mg lq lr ls mi lu lv lw ig bi translated"><em class="ma">更多内容请看</em><a class="ae mj" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="ma">plain English . io</em></a></p></div></div>    
</body>
</html>