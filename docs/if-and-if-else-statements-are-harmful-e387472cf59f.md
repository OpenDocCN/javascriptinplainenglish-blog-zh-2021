# If 和 If/Else 语句“被认为有害”

> 原文：<https://javascript.plainenglish.io/if-and-if-else-statements-are-harmful-e387472cf59f?source=collection_archive---------9----------------------->

编程错误往往属于某一类。程序员的错误有一个模式，大约 90%的错误都属于这个简单的模式。**同一条件在代码的多个部分重复出现。**这是一个控制两段或多段不同代码的条件。

最初看起来并不明显的代码片段，因为它们被**时间**的维度所分隔。

![](img/6c09047538cb617842c36ed4d1f11242.png)

Photo by [Fabrizio Verrecchia](https://unsplash.com/@fabrizioverrecchia?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

# Goto 被认为有害

这是一个众所周知的概念，即程序中 bug 的数量与其中的`goto`语句的数量成正比。当我们看一个我们在代码中描述的程序时，我们看着它，把它想成一系列固定的步骤，但这在大部分 bug 的情况下是不正确的。

第 X 行，第 Y 列，我们指着代码说，“看，就是这个！”但是老实说，我们缺少了一些理解的成分，那就是**时间**。

但是如果我们按照调试器的过程，我们会看到有一个 **time** 元素改变了函数执行的参数。这在使用`goto`语句的代码中尤其可怕。代码开始跳跃。

程序员用`for`、`continue`、`break`、三元运算符(`(x) ? y : z`)和`return`语句限制了这些“跳转”的版本。这些概念通常不被认为是有害的，但是有可能无意中用嵌套的`if`语句和`else`语句重现`goto`语句的问题。

> *“时间操作可以创建时间分支。不稳定的空间开口。空间悖论！时间循环！你是想一遍又一遍地重复同样的时刻，还是想永远不存在？”*
> 
> *—莫尔多男爵，《奇异博士(2016)》*

# 一个函数应该做一件事

理想情况下，一个函数应该以可测试的方式做一件事情。如果一个函数中有一个 else 语句，那么根据定义，它现在不是在做一件事，而是在做另一件事。明白了吗？然后它在做两件事，一件是积极的，另一件是消极的。

负数应该总是触发默认值返回，这样函数就不会做多件事。为了确定分支是否必要，首先需要进行所有参数的计算。一些额外的代码，以确保代码的工作与这些计算的运营商也可以这样做。

如果代码不能一起计算，则需要将错误返回给任何输入的值或返回的默认值(视情况而定)。那些定义条件的设置，而不是功能块的执行，才是应该使用`if`语句的地方。

# 保护条款，垃圾进垃圾出

编写、编辑或调试代码的人有责任记住代码跳转到的位置、时间、原因以及值。随着复杂性的增加，这增加了人为错误的机会。因此，我们希望通过使不完整或不兼容的值无法继续通过代码流来最小化认知负荷。

Any defect throws an error.

对此的解决方案是，不要试图修改值或分支代码，而是简单地拒绝它。JavaScript 没有提供硬类型系统，但是如果使用了一个值，可以用`if`语句和`typeof`来检查它的类型是否正确。然后，在继续并创建新的条件之前，该函数可以以默认值退出。

然后计算这些新值，函数应该退出。这个模型中没有 else 语句，因为代码路由条件只在定义过程中涉及。在这一点上，else 是无用的语法。**人类程序员不再需要进行与条件相反的心理环境转换。**

条件越接近程序的入口，不管是函数还是整个程序，它就能越快地解决它认为有问题的东西，并把它转移到它应该流动的地方。