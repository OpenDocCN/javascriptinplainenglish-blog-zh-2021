<html>
<head>
<title>Stop Using React Forms and Consider Using Formik Instead</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止使用React表单，考虑改用Formik</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/stop-using-react-forms-and-consider-using-formik-instead-d19d1b047366?source=collection_archive---------6-----------------------#2021-06-23">https://javascript.plainenglish.io/stop-using-react-forms-and-consider-using-formik-instead-d19d1b047366?source=collection_archive---------6-----------------------#2021-06-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9a89" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">较少的样板代码使它成为更好的选择</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d6e04e49ccc04c3aeefa17f99226f3f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tksuRS2d6Sxa1d38"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@wocintechchat?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Christina @ wocintechchat.com</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1c0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之前，我写过关于<a class="ae kv" href="https://betterprogramming.pub/stop-using-redux-consider-easy-peasy-if-you-want-3214c41bcce5" rel="noopener ugc nofollow" target="_blank">停止使用Redux——如果你想要</a>,请考虑简单，读者非常喜欢。所以我想向我的读者介绍一种替代的React表单。</p><p id="3e15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这根本不是一个有助于我获得的晋升。只是在你的web开发之旅中帮助你的一个选择。</p><p id="4a06" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么，我们开始吧。</p><p id="6cb7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个网站总是需要一个注册，关注我们，或订阅我们的形式。这是在网站所有者和用户之间建立联系的最好方式之一。</p><p id="6771" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">毫无疑问，我们可以将谷歌表单集成到我们的网站中，甚至使用React文档中解释的<a class="ae kv" href="https://reactjs.org/docs/forms.html#controlled-components" rel="noopener ugc nofollow" target="_blank">控制的</a>或<a class="ae kv" href="https://reactjs.org/docs/uncontrolled-components.html" rel="noopener ugc nofollow" target="_blank">不控制的</a>组件。</p><p id="ed1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但老实说，我不喜欢在我的网站上使用谷歌表单。现在，第二个选项是使用受控或非受控组件来创建表单。</p><p id="4af5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简单地说，受控组件是输入形式，其中值被改变并以反应状态保存，无论它是类组件还是功能组件。</p><p id="243b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">React文档用这样一个简单的例子来解释它:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="cffd" class="lx ly iq lt b gy lz ma l mb mc">class NameForm extends React.Component {<br/>  constructor(props) {<br/>    super(props);<br/>    this.state = {value: ''};<br/>    this.handleChange = this.handleChange.bind(this);<br/>    this.handleSubmit = this.handleSubmit.bind(this);<br/>}<br/><br/>handleChange(event) {    <br/>  this.setState({value: event.target.value});  <br/>}</span><span id="1ddb" class="lx ly iq lt b gy md ma l mb mc">handleSubmit(event) {<br/>  alert('A name was submitted: ' + this.state.value);<br/>  event.preventDefault();<br/>}<br/><br/>render() {<br/>   return (<br/>    &lt;form onSubmit={this.handleSubmit}&gt;        <br/>     &lt;label&gt; Name:<br/>     &lt;input type="text" value={this.state.value} <br/>      onChange={this.handleChange} /&gt;        <br/>     &lt;/label&gt;<br/>     &lt;input type="submit" value="Submit" /&gt;<br/>    &lt;/form&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="86e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们使用状态和onChange处理程序来保存表单细节。</p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><p id="c5a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在不受控制的组件中，数据由DOM自己处理，使用ref从DOM获取表单细节。</p><p id="4f32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">React文档用最简单的例子解释了这一点:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="48c5" class="lx ly iq lt b gy lz ma l mb mc">class NameForm extends React.Component {<br/>  constructor(props) {<br/>    super(props);<br/>    this.handleSubmit = this.handleSubmit.bind(this);<br/>    this.input = React.createRef();  }<br/><br/>  handleSubmit(event) {<br/>    alert('A name was submitted: ' + this.input.current.value);    event.preventDefault();<br/>  }<br/><br/>  render() {<br/>    return (<br/>      &lt;form onSubmit={this.handleSubmit}&gt;<br/>        &lt;label&gt;<br/>          Name:<br/>          &lt;input type="text" ref={this.input} /&gt;        <br/>        &lt;/label&gt;<br/>        &lt;input type="submit" value="Submit" /&gt;<br/>      &lt;/form&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="7703" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">毫无疑问，这两种方法都很棒，我们可以用它们做任何事情。但是它由许多样板文件组成，在超过5个字段后看起来很奇怪。因此，我了解了Formik，实际上，是React文档向我推荐了Formik。</p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h1 id="0f09" class="ml ly iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">学习Formik</h1><p id="c6d4" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf ne lh li lj nf ll lm ln ng lp lq lr ij bi translated">我为我的一个客户创建了一个网站，并希望使用任何方法将用户数据发布到他们的后端。</p><p id="7663" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以我尝试了Formik，并在几分钟内实现了它。</p><p id="f4be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于其格式良好的文档，它很容易学习和实现。</p><p id="460c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">福米克解释说，他们帮助开发人员解决了3个最烦人的问题:</p><ol class=""><li id="6f41" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated">获取表单状态内外的值</li><li id="1d6f" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">验证和错误消息</li><li id="0bec" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">处理表单提交</li></ol><p id="cefc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">他们处理得很顺利。</p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h1 id="cd83" class="ml ly iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">Formik入门</h1><p id="91e3" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf ne lh li lj nf ll lm ln ng lp lq lr ij bi translated">要开始使用Formik，您必须将其安装在react应用程序中。</p><p id="b5a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="5413" class="lx ly iq lt b gy lz ma l mb mc">npm install formik — save</span></pre><p id="ab08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者使用:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="0cb8" class="lx ly iq lt b gy lz ma l mb mc">yarn add formik</span></pre><p id="3842" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">福米克可以在几分钟内学会。让我们从Formik文档中提供的一个例子开始，然后根据我们的需要修改它:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="161a" class="lx ly iq lt b gy lz ma l mb mc">import React from 'react';<br/>import { useFormik } from 'formik';</span><span id="9d43" class="lx ly iq lt b gy md ma l mb mc">const SignupForm = () =&gt; {</span><span id="c4f8" class="lx ly iq lt b gy md ma l mb mc">   const formik = useFormik({<br/>     initialValues: { email: '',},<br/>     onSubmit: values =&gt; {<br/>       alert(JSON.stringify(values, null, 2));<br/>   },});</span><span id="1a43" class="lx ly iq lt b gy md ma l mb mc">   return (<br/>    &lt;form onSubmit={formik.handleSubmit}&gt;<br/>       &lt;label htmlFor="email"&gt;Email Address&lt;/label&gt;</span><span id="44f2" class="lx ly iq lt b gy md ma l mb mc">       &lt;input <br/>         id="email"<br/>         name="email"<br/>         type="email"<br/>         onChange={formik.handleChange}<br/>         value={formik.values.email}<br/>       /&gt;</span><span id="bffd" class="lx ly iq lt b gy md ma l mb mc">       &lt;button type="submit"&gt;Submit&lt;/button&gt;<br/>     &lt;/form&gt;</span><span id="1a8b" class="lx ly iq lt b gy md ma l mb mc">   );};</span></pre><p id="9af8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们添加了一个电子邮件输入和另一个提交按钮输入。</p><p id="67c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在form标签中，我们已经提到，当用户输入他们的电子邮件并提交时，Formik将显示一个带有用户电子邮件的警告。</p><p id="d010" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简单地说，它将更新useFormik中的<code class="fe nv nw nx lt b">initialValues</code>。</p><p id="a13a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nv nw nx lt b">handleChange </code>会这样工作:</p><p id="baab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在类组件中:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="ac2a" class="lx ly iq lt b gy lz ma l mb mc">constructor(props) {<br/>    super(props);<br/>    this.state = {value: ''};<br/>}</span><span id="fb22" class="lx ly iq lt b gy md ma l mb mc">handleChange(event) {    <br/>  this.setState({value: event.target.value});  <br/>}</span></pre><p id="262b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在功能组件中:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="4f33" class="lx ly iq lt b gy lz ma l mb mc">const [values, setValues] = React.useState({});</span><span id="c87f" class="lx ly iq lt b gy md ma l mb mc">const handleChange = e =&gt; {<br/>     setValues(prevValues =&gt; ({<br/>     ...prevValues,<br/>     [e.target.name]: e.target.value<br/>});}</span></pre><p id="023f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很简单。</p><p id="2ad4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是通常，一个表单包含两个以上的字段来获取用户详细信息。</p><p id="18d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，让我们开始吧。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h1 id="c1f5" class="ml ly iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">Formik中的验证</h1><p id="6916" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf ne lh li lj nf ll lm ln ng lp lq lr ij bi translated">您已经在表单中看到，有些字段是必需填写的，而其他字段是可选的。</p><p id="52a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您如何验证这一点？通过定义一个验证函数。</p><p id="282e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以这样做:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="370f" class="lx ly iq lt b gy lz ma l mb mc">const validate = values =&gt; {</span><span id="f647" class="lx ly iq lt b gy md ma l mb mc">   const errors = {};</span><span id="825c" class="lx ly iq lt b gy md ma l mb mc">   if (!values.firstName) {<br/>     errors.firstName = 'Required';<br/>   } else if (values.firstName.length &gt; 15) {<br/>     errors.firstName = 'Must be 15 characters or less';<br/>   }</span><span id="14f6" class="lx ly iq lt b gy md ma l mb mc">   if (!values.lastName) {<br/>     errors.lastName = 'Required';<br/>   } else if (values.lastName.length &gt; 20) { <br/>     errors.lastName = 'Must be 20 characters or less';<br/>   }</span><span id="b665" class="lx ly iq lt b gy md ma l mb mc">   if (!values.email) {<br/>     errors.email = 'Required';<br/>     } else if (!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(values.email)) {<br/>       errors.email = 'Invalid email address';<br/>     }</span><span id="adea" class="lx ly iq lt b gy md ma l mb mc">   return errors;<br/>};</span></pre><p id="1af2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它将验证用户的名字、姓氏和电子邮件，如果用户输入了错误的内容，它将显示一个错误。</p><p id="96f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">整个代码是这样的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h1 id="47e9" class="ml ly iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">用“是”验证</h1><p id="399d" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf ne lh li lj nf ll lm ln ng lp lq lr ij bi translated">您可以如上所示或使用Yup来验证用户。这是你自己的选择。</p><p id="9b1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要使用Yup，你必须安装它。</p><p id="5392" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用NPM</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="d42a" class="lx ly iq lt b gy lz ma l mb mc">npm install yup — save</span></pre><p id="e776" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者使用纱线</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="24ca" class="lx ly iq lt b gy lz ma l mb mc">yarn add yup</span></pre><p id="aa04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这很简单，只需删除你的验证函数，并用Yup定义验证。</p><p id="c555" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">代码将如下所示</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h1 id="b22d" class="ml ly iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">减少Formik中的样板文件</h1><p id="b15a" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf ne lh li lj nf ll lm ln ng lp lq lr ij bi translated">最后，让我们通过定义一些Formik组件来减少样板文件。</p><p id="120c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用formik、Field、Form和来自Formik的ErrorMessage，并在我们的功能组件中定义它。</p><p id="1b71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如下图所示</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h1 id="76eb" class="ml ly iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">让我们结束吧</h1><p id="37da" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf ne lh li lj nf ll lm ln ng lp lq lr ij bi translated">Formik是使用验证和处理表单提交的好方法。感谢贾里德·帕尔默介绍了这样一个处理表单的好方法。</p><p id="e81f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">试试用那个。最后，选择权在你——谢谢。</p><p id="80cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注:</strong>这里的例子直接取自<a class="ae kv" href="https://formik.org/docs/overview" rel="noopener ugc nofollow" target="_blank">文档</a>，以便于解释。因此，所有的荣誉都属于创建文档的创建者。</p><p id="38de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="oa">更多内容请看</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oa">plain English . io</em></strong></a></p></div></div>    
</body>
</html>