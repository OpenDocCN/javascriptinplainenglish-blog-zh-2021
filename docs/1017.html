<html>
<head>
<title>Vue Enterprise Patterns — How to Build Components With Design System Variants</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue企业模式——如何用设计系统变体构建组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/vue-enterprise-patterns-how-to-build-components-with-design-system-variants-and-share-variant-928dd4f338cf?source=collection_archive---------15-----------------------#2021-03-03">https://javascript.plainenglish.io/vue-enterprise-patterns-how-to-build-components-with-design-system-variants-and-share-variant-928dd4f338cf?source=collection_archive---------15-----------------------#2021-03-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a615" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">并使用变体样式提供程序共享变体样式</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8fdc793236a3406be85b36a7fb8e9580.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZiMDBVFccUBJHbzWph6KsA.png"/></div></div></figure><p id="2f3c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">本文原载于<a class="ae ln" href="https://theroadtoenterprise.com/blog/how-to-build-components-with-design-system-variants-and-share-variant-styles-using-variant-style-provider" rel="noopener ugc nofollow" target="_blank">企业之路</a> <a class="ae ln" href="https://theroadtoenterprise.com/blog/how-to-build-components-with-design-system-variants-and-share-variant-styles-using-variant-style-provider).*" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="a736" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">许多项目，尤其是较大的项目，都有一个设计系统来指导组件的外观和感觉。我们以纽扣为例。下面你可以看到在<a class="ae ln" href="https://figma.com" rel="noopener ugc nofollow" target="_blank"> Figma </a>中完成的不同按钮变体的快速设计。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/fb34feb99c55a43241ce537695eb2c19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SpnCY_0rL895pgrY.png"/></div></figure><p id="d1af" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于网站上的主要操作，按钮可以有不同的变体，如主要和次要。也可以有像警告或危险这样的变体，它们应该让用户对他们将要采取的行动保持谨慎。有多种方法可以实现变体。我想和你分享如何使用CSS变量和模块以高效和干净的方式实现这一点。</p><p id="e93e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本教程中，我们将涵盖:</p><ul class=""><li id="b413" class="lw lx iq kt b ku kv kx ky la ly le lz li ma lm mb mc md me bi translated">如何基于设计系统创建带有变体的按钮和标签组件。</li><li id="3997" class="lw lx iq kt b ku mf kx mg la mh le mi li mj lm mb mc md me bi translated">如何利用CSS变量和CSS模块实现组件变体？</li><li id="b9e1" class="lw lx iq kt b ku mf kx mg la mh le mi li mj lm mb mc md me bi translated">如何使用VariantStyleProvider组件在多个组件之间共享变体样式。</li></ul><h1 id="6595" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">项目设置</h1><p id="e768" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated">你可以在这里找到GitHub库和完整的代码示例<a class="ae ln" href="https://github.com/ThomasFindlay/build-vue-component-with-variants-using-css-variables" rel="noopener ugc nofollow" target="_blank">。我已经使用</a><a class="ae ln" href="https://vitejs.dev" rel="noopener ugc nofollow" target="_blank"> Vite </a>为本教程搭建了一个新项目。如果您想学习本教程，您可以通过运行下面显示的命令之一，用Vite创建一个新项目:</p><p id="c2c3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">与NPM:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="4864" class="nm ml iq ni b gy nn no l np nq">$ npm init @vitejs/app</span></pre><p id="a15d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">带纱线:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="9825" class="nm ml iq ni b gy nn no l np nq">$ yarn create @vitejs/app</span></pre><p id="ccec" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">创建项目后，安装依赖项并启动开发服务器。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="a307" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们从创建一个新的<code class="fe nr ns nt ni b">BaseButton.vue</code>组件开始。</p><p id="510c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">src/components/base button . vue</strong></p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="4143" class="nm ml iq ni b gy nn no l np nq">&lt;template&gt;<br/>  &lt;button :class="[$style.baseButton]" v-bind="$attrs"&gt;<br/>    &lt;slot /&gt;<br/>  &lt;/button&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>export default {<br/>  props: {<br/>    variant: {<br/>      type: String,<br/>      validators: value =&gt;<br/>        ['primary', 'secondary', 'warning', 'danger'].includes(value),<br/>    },<br/>  },<br/>}<br/>&lt;/script&gt;<br/><br/>&lt;style module&gt;<br/>.baseButton {<br/>  border: none;<br/>  background: transparent;<br/>  padding: 0.6rem 1rem;<br/>}<br/>&lt;/style&gt;</span></pre><p id="e46c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是一个非常简单的组件，只有一个道具— <code class="fe nr ns nt ni b">variant</code>。现在，让我们替换<code class="fe nr ns nt ni b">App.vue</code>组件的内容，并为每个变体添加四个按钮。</p><p id="8dbc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> src/App.vue </strong></p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="2381" class="nm ml iq ni b gy nn no l np nq">&lt;template&gt;<br/>  &lt;div :class="$style.container"&gt;<br/>    &lt;BaseButton variant="primary"&gt; Primary &lt;/BaseButton&gt;<br/>    &lt;BaseButton variant="secondary"&gt; Secondary &lt;/BaseButton&gt;<br/>    &lt;BaseButton variant="warning"&gt; Warning &lt;/BaseButton&gt;<br/>    &lt;BaseButton variant="danger"&gt; Danger &lt;/BaseButton&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>import BaseButton from './components/BaseButton.vue'<br/>export default {<br/>  components: {<br/>    BaseButton,<br/>  },<br/>}<br/>&lt;/script&gt;<br/><br/>&lt;style module&gt;<br/>.container {<br/>  width: 300px;<br/>  margin: 2rem auto;<br/>  display: grid;<br/>  gap: 1.5rem;<br/>  grid-template-columns: repeat(4, 1fr);<br/>  justify-content: center;<br/>}<br/>&lt;/style&gt;</span></pre><p id="f09b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">正如你在上面看到的，我们为每个变量渲染了四个<code class="fe nr ns nt ni b">BaseButton</code>组件:主要、次要、警告和危险。</p><p id="6cb9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下图显示了按钮目前的样子。主要的一个是重点，所以有一个默认的轮廓颜色显示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/59ba28b7c4575c19de4c4b78c1548a7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/0*sXCsk_wiUrX4WqQa.png"/></div></figure><p id="4f71" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我知道这还不算什么，但我们会实现的。我们有了一个基本的设置，所以让我们为<code class="fe nr ns nt ni b">BaseButton</code>组件中的每个变量添加CSS变量和样式。注意，我们没有使用作用域样式(<code class="fe nr ns nt ni b">&lt;style scoped&gt;</code>)。相反，我们使用CSS模块:<code class="fe nr ns nt ni b">&lt;style module&gt;</code>。以这种方式定义的任何样式都暴露给<code class="fe nr ns nt ni b">$style</code>属性下的组件。</p><h1 id="e850" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">CSS变量和BaseButton组件变量</h1><p id="0aff" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated">首先，创建一个名为<code class="fe nr ns nt ni b">variables.css</code>的新文件，并添加如下所示的CSS变量。</p><p id="cea2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">src/styles/variables . CSS</strong></p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="99ca" class="nm ml iq ni b gy nn no l np nq">:root {<br/>  --primary-text-color: #eff6ff;<br/>  --primary-bg-color: #1d4ed8;<br/>  --secondary-text-color: #1d4ed8;<br/>  --secondary-bg-color: #eff6ff;<br/>  --warning-text-color: #c2410c;<br/>  --warning-bg-color: #fff7ed;<br/>  --danger-text-color: #b91c1c;<br/>  --danger-bg-color: #fee2e2;<br/>}</span></pre><p id="d30c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在<code class="fe nr ns nt ni b">main.js</code>文件中导入<code class="fe nr ns nt ni b">variables.css</code>文件，因为应用程序中的组件需要能够访问它们。</p><p id="047d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> src/main.js </strong></p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="9dc9" class="nm ml iq ni b gy nn no l np nq">import { createApp } from 'vue'<br/>import './styles/variables.css'<br/>import App from './App.vue'<br/><br/>createApp(App).mount('#app')</span></pre><p id="5b8c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，我们需要更新<code class="fe nr ns nt ni b">BaseButton</code>组件。我们需要做三件事:</p><ol class=""><li id="21b5" class="lw lx iq kt b ku kv kx ky la ly le lz li ma lm nv mc md me bi translated">基于<code class="fe nr ns nt ni b">variant</code>道具添加变体样式。</li><li id="7bfb" class="lw lx iq kt b ku mf kx mg la mh le mi li mj lm nv mc md me bi translated">将<code class="fe nr ns nt ni b">color</code>和<code class="fe nr ns nt ni b">background-color</code>属性添加到<code class="fe nr ns nt ni b">baseButton</code>类。</li><li id="5655" class="lw lx iq kt b ku mf kx mg la mh le mi li mj lm nv mc md me bi translated">为每个变量类添加CSS变量。</li></ol><p id="7a4a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">src/components/base button . vue</strong></p><p id="cd08" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，更改传递给<code class="fe nr ns nt ni b">button</code>元素的类。除了<code class="fe nr ns nt ni b">baseButton</code>类，它还应该接收一个适当的变量类。该等级将由<code class="fe nr ns nt ni b">variant</code>道具决定。</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="716d" class="nm ml iq ni b gy nn no l np nq">&lt;template&gt;<br/>  &lt;button :class="[$style.baseButton, $style[variant]]" v-bind="$attrs"&gt;<br/>    &lt;slot /&gt;<br/>  &lt;/button&gt;<br/>&lt;/template&gt;</span></pre><p id="b86d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，我们将<code class="fe nr ns nt ni b">color</code>和<code class="fe nr ns nt ni b">background-color</code>属性添加到<code class="fe nr ns nt ni b">baseButton</code>类中。这些属性将有值的<code class="fe nr ns nt ni b">--btn-text-color</code>和<code class="fe nr ns nt ni b">--btn-bg-color</code>变量。这些将由每个变量类设置，并将对应于在<code class="fe nr ns nt ni b">variables.css</code>文件中定义的CSS变量。</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="7390" class="nm ml iq ni b gy nn no l np nq">&lt;style module&gt;<br/>.baseButton {<br/>  border: none;<br/>  padding: 0.6rem 1rem;<br/>  color: var(--btn-text-color);<br/>  background-color: var(--btn-bg-color);<br/>}<br/><br/>.primary {<br/>  --btn-text-color: var(--primary-text-color);<br/>  --btn-bg-color: var(--primary-bg-color);<br/>}<br/><br/>.secondary {<br/>  --btn-text-color: var(--secondary-text-color);<br/>  --btn-bg-color: var(--secondary-bg-color);<br/>}<br/><br/>.warning {<br/>  --btn-text-color: var(--warning-text-color);<br/>  --btn-bg-color: var(--warning-bg-color);<br/>}<br/><br/>.danger {<br/>  --btn-text-color: var(--danger-text-color);<br/>  --btn-bg-color: var(--danger-bg-color);<br/>}<br/>&lt;/style&gt;</span></pre><p id="b127" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">太好了，由<code class="fe nr ns nt ni b">App.vue</code>组件渲染的每个按钮现在都应该应用了适当的颜色，如下图所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/7473014eb8f8c70ea4c526b96c72a44b.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/0*hMMcFbJ0OQh-7MAf.png"/></div></figure><p id="1f3e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您愿意，您可以为不同的状态添加更多的变量，例如悬停、活动或禁用。</p><p id="18df" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们已经实现了第一个目标。我们现在有了一个支持多种变体的按钮组件。但是如果我们需要创建另一个也应该支持相同变体的组件呢？例如，一个标签组件？让我们看看如何处理它。</p><h1 id="c246" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">带有变体的BaseTag组件</h1><p id="c0ea" class="pw-post-body-paragraph kr ks iq kt b ku nc jr kw kx nd ju kz la ne lc ld le nf lg lh li ng lk ll lm ij bi translated">让我们从创建一个<code class="fe nr ns nt ni b">BaseTag.vue</code>组件并更新<code class="fe nr ns nt ni b">App.vue</code>组件来呈现每个变体的标签开始。</p><p id="5e39" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">src/components/base tag . vue</strong></p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="71dc" class="nm ml iq ni b gy nn no l np nq">&lt;template&gt;<br/>  &lt;div :class="[$style.baseTag, $style[variant]]" v-bind="$attrs"&gt;<br/>    &lt;slot /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>export default {<br/>  props: {<br/>    variant: {<br/>      type: String,<br/>      validators: value =&gt;<br/>        ['primary', 'secondary', 'warning', 'danger'].includes(value),<br/>    },<br/>  },<br/>}<br/>&lt;/script&gt;<br/><br/>&lt;style module&gt;<br/>.baseTag {<br/>  border: none;<br/>  border-radius: 1.5rem;<br/>  padding: 0.6rem 1rem;<br/>  color: var(--tag-text-color);<br/>  background: var(--tag-bg-color);<br/>}<br/><br/>.primary {<br/>  --tag-text-color: var(--primary-text-color);<br/>  --tag-bg-color: var(--primary-bg-color);<br/>}<br/><br/>.secondary {<br/>  --tag-text-color: var(--secondary-text-color);<br/>  --tag-bg-color: var(--secondary-bg-color);<br/>}<br/><br/>.warning {<br/>  --tag-text-color: var(--warning-text-color);<br/>  --tag-bg-color: var(--warning-bg-color);<br/>}<br/><br/>.danger {<br/>  --tag-text-color: var(--danger-text-color);<br/>  --tag-bg-color: var(--danger-bg-color);<br/>}<br/>&lt;/style&gt;</span></pre><p id="b37a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> src/App.vue </strong></p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="1272" class="nm ml iq ni b gy nn no l np nq">&lt;template&gt;<br/>  &lt;div :class="$style.container"&gt;<br/>    &lt;BaseButton variant="primary"&gt; Primary &lt;/BaseButton&gt;<br/>    &lt;BaseButton variant="secondary"&gt; Secondary &lt;/BaseButton&gt;<br/>    &lt;BaseButton variant="warning"&gt; Warning &lt;/BaseButton&gt;<br/>    &lt;BaseButton variant="danger"&gt; Danger &lt;/BaseButton&gt;<br/>  &lt;/div&gt;<br/>  &lt;div :class="$style.container"&gt;<br/>    &lt;BaseTag variant="primary"&gt; Primary &lt;/BaseTag&gt;<br/>    &lt;BaseTag variant="secondary"&gt; Secondary &lt;/BaseTag&gt;<br/>    &lt;BaseTag variant="warning"&gt; Warning &lt;/BaseTag&gt;<br/>    &lt;BaseTag variant="danger"&gt; Danger &lt;/BaseTag&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>import BaseButton from './components/BaseButton.vue'<br/>import BaseTag from './components/BaseTag.vue'<br/>export default {<br/>  components: {<br/>    BaseButton,<br/>    BaseTag,<br/>  },<br/>}<br/>&lt;/script&gt;</span></pre><p id="ff00" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">更新后，您应该会在屏幕上看到四个按钮和四个标签，如下图所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/b8cdf200a1bdf213c140e79beb65863c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/0*gHxF_AkWkB-SFT7x.png"/></div></figure><p id="7922" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">很管用，对吧？然而，你发现<code class="fe nr ns nt ni b">BaseButton</code>和<code class="fe nr ns nt ni b">BaseTag</code>的组件有多相似了吗？它们几乎是一样的，而且我们在样式上有相当多的代码重复。还有一个不同的问题。如果我们有两个以上有变体的组件，比如说20个，然后我们需要引入更多的变体或者更新现有的变体到不同的CSS变量，那该怎么办？每一个有变体的组件都需要单独更新。我们可以通过从<code class="fe nr ns nt ni b">BaseButton</code>和<code class="fe nr ns nt ni b">BaseTag</code>组件中取出变体样式来解决这些问题。相反，我们将创建一个新的组件，它将管理变量并通过<code class="fe nr ns nt ni b">slots</code>传递适当的样式。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/e5c208c61d1bd602591ce646a9b007a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nDpW5GEZcm1SDAEy"/></div></div></figure><p id="a0c0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您想学习开发Vue应用程序的高级模式、技术和最佳实践吗？看看这本最先进的Vue书籍<a class="ae ln" href="https://theroadtoenterprise.com/?utm_source=medium&amp;utm_medium=article&amp;utm_campaign=variant-style-provider" rel="noopener ugc nofollow" target="_blank">Vue——企业之路</a>。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="e18a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">CSS模块的一个真正伟大之处是我们可以轻松地传递和编写样式。这正是我们现在要做的。从创建一个名为<code class="fe nr ns nt ni b">VariantStyleProvider.vue</code>的新组件开始。该组件将做3件事:</p><ol class=""><li id="f264" class="lw lx iq kt b ku kv kx ky la ly le lz li ma lm nv mc md me bi translated">接受一个<code class="fe nr ns nt ni b">variant</code>道具</li><li id="f5a4" class="lw lx iq kt b ku mf kx mg la mh le mi li mj lm nv mc md me bi translated">定义<code class="fe nr ns nt ni b">color</code>和<code class="fe nr ns nt ni b">background-color</code>属性的变体样式</li><li id="2d7f" class="lw lx iq kt b ku mf kx mg la mh le mi li mj lm nv mc md me bi translated">呈现一个槽并向其传递<code class="fe nr ns nt ni b">baseVariant</code>和一个适当的<code class="fe nr ns nt ni b">variant</code>类。</li></ol><p id="393a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">src/components/variantstyleprovider . vue</strong></p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="2ff5" class="nm ml iq ni b gy nn no l np nq">&lt;template&gt;<br/>  &lt;slot :variantStyle="[$style.baseVariant, $style[variant]]" /&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>export default {<br/>  props: {<br/>    variant: {<br/>      type: String,<br/>      validators: value =&gt;<br/>        ['primary', 'secondary', 'warning', 'danger'].includes(value),<br/>    },<br/>  },<br/>}<br/>&lt;/script&gt;<br/><br/>&lt;style module&gt;<br/>.baseVariant {<br/>  color: var(--variant-text-color);<br/>  background-color: var(--variant-bg-color);<br/>}<br/><br/>.primary {<br/>  --variant-text-color: var(--primary-text-color);<br/>  --variant-bg-color: var(--primary-bg-color);<br/>}<br/><br/>.secondary {<br/>  --variant-text-color: var(--secondary-text-color);<br/>  --variant-bg-color: var(--secondary-bg-color);<br/>}<br/><br/>.warning {<br/>  --variant-text-color: var(--warning-text-color);<br/>  --variant-bg-color: var(--warning-bg-color);<br/>}<br/><br/>.danger {<br/>  --variant-text-color: var(--danger-text-color);<br/>  --variant-bg-color: var(--danger-bg-color);<br/>}<br/>&lt;/style&gt;</span></pre><p id="ac82" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">由于<code class="fe nr ns nt ni b">VariantStyleProvider</code>组件现在处理变体样式，我们将能够从<code class="fe nr ns nt ni b">BaseButton</code>和<code class="fe nr ns nt ni b">BaseTag</code>组件中移除它们。除了移除样式，我们还需要导入<code class="fe nr ns nt ni b">VariantStyleProvider</code>并使用从它传递过来的<code class="fe nr ns nt ni b">variantStyle</code>。下面你可以看到两个组件的最终版本。</p><p id="93c1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">src/components/base button . vue</strong></p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="5a7b" class="nm ml iq ni b gy nn no l np nq">&lt;template&gt;<br/>  &lt;VariantStyleProvider :variant="variant"&gt;<br/>    &lt;template #default="{ variantStyle }"&gt;<br/>      &lt;button :class="[$style.baseButton, variantStyle]" v-bind="$attrs"&gt;<br/>        &lt;slot /&gt;<br/>      &lt;/button&gt;<br/>    &lt;/template&gt;<br/>  &lt;/VariantStyleProvider&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>import VariantStyleProvider from './VariantStyleProvider.vue'<br/><br/>export default {<br/>  components: {<br/>    VariantStyleProvider,<br/>  },<br/>  props: {<br/>    variant: {<br/>      type: String,<br/>      validators: value =&gt;<br/>        ['primary', 'secondary', 'warning', 'danger'].includes(value),<br/>    },<br/>  },<br/>}<br/>&lt;/script&gt;<br/><br/>&lt;style module&gt;<br/>.baseButton {<br/>  border: none;<br/>  padding: 0.6rem 1rem;<br/>}<br/>&lt;/style&gt;</span></pre><p id="1ec6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">src/components/base tag . vue</strong></p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="eb15" class="nm ml iq ni b gy nn no l np nq">&lt;template&gt;<br/>  &lt;VariantStyleProvider :variant="variant"&gt;<br/>    &lt;template #default="{ variantStyle }"&gt;<br/>      &lt;div :class="[$style.baseTag, variantStyle]" v-bind="$attrs"&gt;<br/>        &lt;slot /&gt;<br/>      &lt;/div&gt;<br/>    &lt;/template&gt;<br/>  &lt;/VariantStyleProvider&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>import VariantStyleProvider from './VariantStyleProvider.vue'<br/><br/>export default {<br/>  components: {<br/>    VariantStyleProvider,<br/>  },<br/>  props: {<br/>    variant: {<br/>      type: String,<br/>      validators: value =&gt;<br/>        ['primary', 'secondary', 'warning', 'danger'].includes(value),<br/>    },<br/>  },<br/>}<br/>&lt;/script&gt;<br/><br/>&lt;style module&gt;<br/>.baseTag {<br/>  border: none;<br/>  border-radius: 1.5rem;<br/>  padding: 0.6rem 1rem;<br/>}<br/>&lt;/style&gt;</span></pre><p id="d1b4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这两种成分现在都干净多了。我们设法删除了不必要的代码重复，因为变体样式是在<code class="fe nr ns nt ni b">VariantStyleProvider</code>组件中管理的。这种模式对维护和扩展变体很有帮助。如果你需要更新它们或者添加新的，你只需要关注两个文件:<code class="fe nr ns nt ni b">variables.css</code>和<code class="fe nr ns nt ni b">VariantStyleProvider.vue</code>，而不是手动更新每一个使用变体的组件。</p><p id="a970" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我希望你喜欢这篇文章。如果您想学习更多与Vue相关的高级模式、技术和最佳实践，您可能想看看<a class="ae ln" href="https://theroadtoenterprise.com/?utm_source=medium&amp;utm_medium=article&amp;utm_campaign=variant-style-provider" rel="noopener ugc nofollow" target="_blank">“Vue—通往企业之路”</a>这本书。</p></div></div>    
</body>
</html>