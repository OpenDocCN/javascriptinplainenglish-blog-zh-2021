<html>
<head>
<title>How to create a collapsable panel with smooth animations in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中创建带有平滑动画的可折叠面板</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-a-collapsable-panel-with-smooth-animations-in-react-bb10c22edb5e?source=collection_archive---------3-----------------------#2021-01-23">https://javascript.plainenglish.io/how-to-create-a-collapsable-panel-with-smooth-animations-in-react-bb10c22edb5e?source=collection_archive---------3-----------------------#2021-01-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="82d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">collapsable panel是一个非常流行的UI组件，它已经包含在许多UI库中，所以当您需要使用它时，找到它并不是那么困难。但作为一个好奇的开发者，有时我只想重新发明轮子，这一次，它是可折叠的面板。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="95dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可折叠面板可以折叠或展开，我们可以使用名为'<strong class="jp ir"> <em class="ks"> isCollapsed </em> </strong>'的React状态来跟踪这个UI状态信息，并相应地呈现UI，就像下面的代码一样:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ky kz l"/></div></figure><p id="b4e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它非常简单，任何具有React基础知识的人都可以构建它。但是，当您在项目中使用这个基本的可折叠面板组件时，您会发现它在折叠状态和展开状态之间切换，没有任何动画。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi la"><img src="../Images/f6be280aa0e04c7515415675f53603c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/1*NAKFjNV9i8yIg5mGPxhJ4Q.gif"/></div></figure><p id="7119" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个人都喜欢流畅的动画，为什么我们不多花一点时间来实现它呢？</p><p id="6c23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">说到在React中实现动画，我的首选库是<a class="ae ld" href="https://github.com/pmndrs/react-spring" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="ks">React Spring</em></strong></a>，因为:</p><ul class=""><li id="d099" class="le lf iq jp b jq jr ju jv jy lg kc lh kg li kk lj lk ll lm bi translated">它功能强大且易于使用</li><li id="dda0" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk lj lk ll lm bi translated">它比大多数React动画库具有更好的性能，因为它应用动画而不依赖React逐帧渲染更新</li></ul><p id="d1a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们用React Spring重构之前的代码，然后我将讨论重构后的代码中的变化。</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ky kz l"/></div></figure><ol class=""><li id="5958" class="le lf iq jp b jq jr ju jv jy lg kc lh kg li kk ls lk ll lm bi translated">我们进口反动弹簧</li><li id="5f28" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk ls lk ll lm bi translated">我们移除了<strong class="jp ir"><em class="ks">ToggleButtonWrapper</em></strong>样式的组件，因为它只包含“transform”属性，我们将使用React Spring来制作动画</li><li id="5504" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk ls lk ll lm bi translated">我们指定<strong class="jp ir"> <em class="ks"> PanelContent </em> </strong>是<strong class="jp ir"> <em class="ks"> animated.div </em> </strong>的一个样式化组件，并且我们从其中移除了“高度”CSS属性，因为该属性稍后将由React Spring制作动画</li><li id="99b8" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk ls lk ll lm bi translated">我们为切换按钮包装和面板内容创建动画样式</li><li id="f500" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk ls lk ll lm bi translated">我们将动画样式应用于切换按钮包装</li><li id="69fa" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk ls lk ll lm bi translated">我们将动画样式应用于面板内容</li></ol><p id="4d60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们看看我们的可折叠面板在现实生活中是如何工作的:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi la"><img src="../Images/f8b23247b877fed1dd6cc4cb6f6e1b07.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/1*3lKdzHuuiqhh5SD8OfNuWg.gif"/></div></figure><p id="abcc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如您所看到的，切换按钮现在有一个漂亮的旋转动画，但是内容面板仍然在折叠和展开状态之间跳跃，没有任何动画。为什么？</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/49c4ef9a7dc7edc9a844defc95b4fc91.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*m1dR1pITshVeg3PCGdU5ng.png"/></div></figure><p id="3b00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">原来，用<strong class="jp ir"> <em class="ks"> useSpring、</em></strong>we<strong class="jp ir"><em class="ks"/></strong><em class="ks">不能动画化'</em><strong class="jp ir"><em class="ks">auto</em></strong><em class="ks">' CSS属性，相反，我们需要给它一个精确的值。但是，我们如何获得内容面板的高度值，因为不同的面板可以有不同的内容，高度也可以不同？</em></p><p id="fc82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">幸运的是，我们有<a class="ae ld" href="https://github.com/pmndrs/react-use-measure" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="ks">【反应-使用-测量】</em> </strong> </a> <strong class="jp ir"> <em class="ks"> </em> </strong>前来救援。这是一个小工具，将测量边界(例如宽度，高度，顶部，左侧)的看法，我们参考。让我们把它引入到我们的代码中，然后看一下变化。</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ky kz l"/></div></figure><ol class=""><li id="5ead" class="le lf iq jp b jq jr ju jv jy lg kc lh kg li kk ls lk ll lm bi translated">我们引入反应-使用-测量</li><li id="5b2f" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk ls lk ll lm bi translated">我们使用<strong class="jp ir"> <em class="ks"> useMeasure() </em> </strong>钩子来获取引用和被引用组件的边界</li><li id="4c37" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk ls lk ll lm bi translated">我们从<strong class="jp ir"><em class="ks">use measure()</em></strong><em class="ks">钩子返回的<em class="ks">【界限】</em>  <em class="ks">对象中得到<strong class="jp ir"><em class="ks">PanelContentInner</em></strong>组件<strong class="jp ir"> <em class="ks"> </em> </strong>的高度，然后我们用这个高度作为</em><strong class="jp ir"><em class="ks">panel content</em></strong>组件<strong class="jp ir"> <em class="ks"> </em>的高度</strong></em></li><li id="7069" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk ls lk ll lm bi translated">我们将包含内容的<strong class="jp ir"><em class="ks">PanelContentInner</em></strong>组件设置为引用组件</li></ol><p id="e56d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您的关注，让我们看看我们的最终产品:)</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi la"><img src="../Images/912d50bb42a642a06bdd2f2f68cbec95.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/1*4DsovycWkPQo-vh3Ae4hqw.gif"/></div></figure></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="bd47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你觉得这篇文章有帮助，请访问<a class="ae ld" href="https://www.youtube.com/channel/UCoQ7C3JajfBOIjp7yWDj8Yg" rel="noopener ugc nofollow" target="_blank">我的YouTube频道</a>，在那里你也可以找到一些有用的编程技巧。</p></div></div>    
</body>
</html>