<html>
<head>
<title>Turn Google Sheets into a REST API and use it with React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Google Sheets转换成REST API，并与React一起使用</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-turn-google-sheets-into-a-rest-api-and-use-it-with-react-application-1823a585320?source=collection_archive---------4-----------------------#2021-02-14">https://javascript.plainenglish.io/how-to-turn-google-sheets-into-a-rest-api-and-use-it-with-react-application-1823a585320?source=collection_archive---------4-----------------------#2021-02-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="80ef" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">向API发布数据从来都不容易。但是您使用过React将表单数据发布到Google Sheets吗？如果没有，那么这个教程是给你的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/085ee4df4daa3c1a5e13cb54b8a555af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BDVTh8vvTNBAk3M4QUDkTw.png"/></div></div></figure><p id="0fce" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">今天，我们将讨论如何像REST APIs一样将表单数据从React发布到Google Sheets。</p><h1 id="d303" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">创建React应用程序</h1><p id="ed1a" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">要开始，键入<code class="fe lx ly lz ma b">npx create-react-app react-googlesheets</code>来设置项目目录。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mb"><img src="../Images/21a7cd6236a67a2a65783399a17657cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*z9H1mmeqOm6NkQU1.png"/></div></div></figure><p id="2649" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们清除<strong class="jm io"> <em class="mc"> app.js </em> </strong>文件中一些不必要的代码。</p><pre class="kj kk kl km gt md ma me mf aw mg bi"><span id="514b" class="mh kv in ma b gy mi mj l mk ml">import './App.css';</span><span id="c8b1" class="mh kv in ma b gy mm mj l mk ml">function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;header className="App-header"&gt;<br/>        <br/>      &lt;/header&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="262a" class="mh kv in ma b gy mm mj l mk ml">export default App;</span></pre><p id="6f62" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将以下代码粘贴到您的<strong class="jm io"> <em class="mc"> app.js </em> </strong>文件中。</p><h1 id="8b08" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">安装语义用户界面</h1><p id="0ee9" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">语义UI是一个框架，用于设计和开发美观且响应迅速的布局。它有按钮、容器、列表、输入等组件。</p><p id="2907" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要在React应用程序中安装语义UI，请使用以下命令。</p><pre class="kj kk kl km gt md ma me mf aw mg bi"><span id="df94" class="mh kv in ma b gy mi mj l mk ml">npm install semantic-ui-react semantic-ui-css</span></pre><p id="50f9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">安装完成后，打开index.js文件，将下面的导入粘贴到顶部。</p><pre class="kj kk kl km gt md ma me mf aw mg bi"><span id="92b5" class="mh kv in ma b gy mi mj l mk ml">import 'semantic-ui-css/semantic.min.css'</span></pre><p id="64c7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，使用命令<strong class="jm io"> <em class="mc"> npm start运行应用程序。</em>T12】</strong></p><h1 id="d781" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">创建一些输入框</h1><p id="6064" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">让我们创建一个表单和输入框，从React应用程序中获取姓名、年龄、工资和爱好等信息。</p><p id="3983" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里，我们从<em class="mc"> semantic-ui-react </em>库中导入按钮、表单、容器和标题，并创建表单字段。</p><pre class="kj kk kl km gt md ma me mf aw mg bi"><span id="92ff" class="mh kv in ma b gy mi mj l mk ml">import React, { Component } from 'react'<br/>import { Button, Form, Container, Header } from 'semantic-ui-react'<br/>import './App.css';</span><span id="06ab" class="mh kv in ma b gy mm mj l mk ml">export default class App extends Component {<br/>  render() {<br/>    return (<br/>      &lt;Container fluid className="container"&gt;<br/>        &lt;Header as='h2'&gt;React Google Sheets!&lt;/Header&gt;<br/>        &lt;Form className="form"&gt;<br/>          &lt;Form.Field&gt;<br/>            &lt;label&gt;Name&lt;/label&gt;<br/>            &lt;input placeholder='Enter your name' /&gt;<br/>          &lt;/Form.Field&gt;<br/>          &lt;Form.Field&gt;<br/>            &lt;label&gt;Age&lt;/label&gt;<br/>            &lt;input placeholder='Enter your age' /&gt;<br/>          &lt;/Form.Field&gt;<br/>          &lt;Form.Field&gt;<br/>            &lt;label&gt;Salary&lt;/label&gt;<br/>            &lt;input placeholder='Enter your salary' /&gt;<br/>          &lt;/Form.Field&gt;<br/>          &lt;Form.Field&gt;<br/>            &lt;label&gt;Hobby&lt;/label&gt;<br/>            &lt;input placeholder='Enter your hobby' /&gt;<br/>          &lt;/Form.Field&gt;<br/>          <br/>          &lt;Button color="blue" type='submit'&gt;Submit&lt;/Button&gt;<br/>        &lt;/Form&gt;<br/>      &lt;/Container&gt;<br/>    )<br/>  }<br/>}<br/></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/4d423dac0bcca69017633e7c7c200e5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/0*7MO63SGZYxV86D6Z.png"/></div></figure><p id="06af" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是我们的产出。</p><p id="a555" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们完成了用户界面。让我们添加一些功能。</p><p id="8c60" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，让我们在构造函数中为我们的四个表单字段创建状态。</p><pre class="kj kk kl km gt md ma me mf aw mg bi"><span id="7de9" class="mh kv in ma b gy mi mj l mk ml">import React, { Component } from 'react'<br/>import { Button, Form, Container, Header } from 'semantic-ui-react'<br/>import './App.css';</span><span id="185f" class="mh kv in ma b gy mm mj l mk ml">export default class App extends Component {<br/>  constructor(props) {<br/>    super(props)<br/>  <br/>    this.state = {<br/>       name: '',<br/>       age: '',<br/>       salary: '',<br/>       hobby: ''<br/>    }<br/>  }</span><span id="8ddc" class="mh kv in ma b gy mm mj l mk ml">changeHandler = (e) =&gt; {<br/>    this.setState({[e.target.name] : e.target.value})<br/>  }</span><span id="caff" class="mh kv in ma b gy mm mj l mk ml">submitHandler = e =&gt; {<br/>    e.preventDefault();<br/>    console.log(this.state);<br/>  }<br/>  <br/>  render() {<br/>    const { name, age, salary, hobby } = this.state;    (*)<br/>    return (<br/>      &lt;Container fluid className="container"&gt;<br/>        &lt;Header as='h2'&gt;React Google Sheets!&lt;/Header&gt;<br/>        &lt;Form className="form" onSubmit={this.submitHandler}&gt;<br/>          &lt;Form.Field&gt;<br/>            &lt;label&gt;Name&lt;/label&gt;<br/>            &lt;input placeholder='Enter your name' type="text" name = "name" value = {name} onChange={this.changeHandler}/&gt;<br/>          &lt;/Form.Field&gt;<br/>          &lt;Form.Field&gt;<br/>            &lt;label&gt;Age&lt;/label&gt;<br/>            &lt;input placeholder='Enter your age' type="number" name = "age" value = {age} onChange={this.changeHandler}/&gt;<br/>          &lt;/Form.Field&gt;<br/>          &lt;Form.Field&gt;<br/>            &lt;label&gt;Salary&lt;/label&gt;<br/>            &lt;input placeholder='Enter your salary' type="number" name = "salary" value = {salary} onChange={this.changeHandler}/&gt;<br/>          &lt;/Form.Field&gt;<br/>          &lt;Form.Field&gt;<br/>            &lt;label&gt;Hobby&lt;/label&gt;<br/>            &lt;input placeholder='Enter your hobby' type="text" name = "hobby" value = {hobby} onChange={this.changeHandler}/&gt;<br/>          &lt;/Form.Field&gt;<br/>          <br/>          &lt;Button color="blue" type='submit'&gt;Submit&lt;/Button&gt;<br/>        &lt;/Form&gt;<br/>      &lt;/Container&gt;<br/>    )<br/>  }<br/>}</span></pre><p id="9000" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这里，我们有四个表单域和它们各自的状态。我们还有一个changeHandler方法来跟踪输入值的变化。</p><p id="f8ad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们在render方法中析构状态，并将它们的值添加到输入的value属性中(行*)。</p><p id="2edc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们最不需要的是onSubmit处理程序。在form标记上，添加onSubmit事件并分配submitHandler方法。</p><p id="5456" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">填写表格并单击提交。你将在控制台中输入数据。</p><p id="3ca2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">就是这样，我们有一个表单，将姓名、年龄、工资和爱好记录到控制台中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/ab7724ef3a888dc8b49c8d616ff49411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*n8YNqAgjVh6HFOSc.png"/></div></div></figure><h1 id="bcd0" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">将数据发布到Google Sheets</h1><p id="dc56" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">让我们把Google sheets改成REST API。</p><p id="07bc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将把数据作为REST API发布到Google Sheets，为此，我们需要安装<em class="mc"> Axios </em>。它是一个可以用来向API发送请求的库，就像<em class="mc"> fetch一样。</em></p><p id="2f45" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在文件、新建和电子表格下打开一个新的电子表格。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/bc3cf318435d5c8a3f6fcab5b2f32178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*D0Jy-WWSIiWyYhJJ.png"/></div></div></figure><p id="97bd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将工作表重命名为您选择的任何名称。</p><p id="b111" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">单击屏幕右上角的共享按钮，并将权限编辑为公开。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/0af8c7e16ccf1bb0f630bdb7f5118ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wUuCkGYggZBN-_Nl.png"/></div></div></figure><p id="e924" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">复制链接并前往<a class="ae mr" href="https://sheet.best/" rel="noopener ugc nofollow" target="_blank">https://sheet.best/</a>创建你的免费账户。</p><p id="0aa0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建一个新连接，并将复制的URL粘贴到连接URL框中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/31f8ed31ea7b25156304e1c8ab458d0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*h6TxD24o8gDHm1br.png"/></div></div></figure><p id="65a7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">点击连接。您将被重定向到您的连接页面。在这里，你可以看到你所有的连接。单击新连接的详细信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/b8d464f6a05613ba82eef8f5d4fde889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BTQQI6K3H6_XYw2J.png"/></div></div></figure><p id="78d5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">复制<em class="mc">连接网址</em>。此URL将用作发送POST请求的端点。</p><p id="f282" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，让我们安装一个<em class="mc"> xios </em>。在您的终端中键入<code class="fe lx ly lz ma b">npm install axios</code>来安装该软件包。</p><p id="7ecc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">安装完成后，将其导入到文件的顶部。我们将在<code class="fe lx ly lz ma b">submitHandler</code>函数中发出POST请求。</p><pre class="kj kk kl km gt md ma me mf aw mg bi"><span id="e76e" class="mh kv in ma b gy mi mj l mk ml">submitHandler = e =&gt; {<br/>    e.preventDefault();<br/>    console.log(this.state);</span><span id="271a" class="mh kv in ma b gy mm mj l mk ml">axios.post('url', this.state)<br/>    .then(response =&gt; {<br/>      console.log(response);<br/>    })<br/>  }</span></pre><p id="8d57" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">用上面的代码替换<code class="fe lx ly lz ma b">submitHandler</code>函数。这里，我们使用<strong class="jm io"> <em class="mc"> axios </em> </strong>将数据发送到URL，并使用<code class="fe lx ly lz ma b">.<em class="mc">then</em></code>关键字在控制台中获取响应。</p><p id="c7fd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">粘贴从<strong class="jm io"> <em class="mc"> sheet.best </em> </strong>中复制的URL端点，并粘贴在URL的位置。</p><pre class="kj kk kl km gt md ma me mf aw mg bi"><span id="76d5" class="mh kv in ma b gy mi mj l mk ml">submitHandler = e =&gt; {<br/>    e.preventDefault();<br/>    console.log(this.state);</span><span id="c0d6" class="mh kv in ma b gy mm mj l mk ml">axios.post('<a class="ae mr" href="https://sheet.best/api/sheets/a6e67deb-2f00-43c3-89d3-b331341d53ed'" rel="noopener ugc nofollow" target="_blank">https://sheet.best/api/sheets/a6e67deb-2f00-43c3-89d3-b331341d53ed'</a>, this.state)<br/>    .then(response =&gt; {<br/>      console.log(response);<br/>    })<br/>  }</span></pre><p id="e69a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，打开Google Sheets，将一些空白字段重命名为下图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/f9cec4a87af7e70af45bf06941f763f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GHcGrbzFHNoVB_mD.png"/></div></div></figure><p id="bca7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，运行React应用程序并填写输入字段。您将看到数据正在被填充到您的Google Sheets中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/b05fad28fa5abca520b988feb71a5d9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gBsUFtQPBudO7bxn.png"/></div></div></figure><h2 id="dfba" class="mh kv in bd kw mw mx dn la my mz dp le jv na nb li jz nc nd lm kd ne nf lq ng bi translated">结论</h2><p id="0fbf" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated"><em class="mc">那都是乡亲们。现在您知道如何将Google Sheets转换成REST API了。现在，你可以在谷歌表单中输入数据并做出反应。</em></p><p id="b407" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">或者，您可以在Github上找到代码并进行实验。</p><p id="4031" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">github:<a class="ae mr" href="https://github.com/nishant-666/React-GoogleSheets" rel="noopener ugc nofollow" target="_blank">https://github.com/nishant-666/React-GoogleSheets</a></p><p id="82cc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">快乐学习。</p></div></div>    
</body>
</html>