<html>
<head>
<title>How to Pass Parameters with Express Middleware</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Express中间件传递参数</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/ways-to-pass-parameter-in-express-middleware-cc0d9d088be4?source=collection_archive---------2-----------------------#2021-08-14">https://javascript.plainenglish.io/ways-to-pass-parameter-in-express-middleware-cc0d9d088be4?source=collection_archive---------2-----------------------#2021-08-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/df74c7163f11b532e5c316d0809dde07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YMy_SmtDWMZNbmxu"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@samich_18?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Samantha Borges</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="bb88" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">介绍</h1><p id="46a8" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">嘿，今天我们将讨论如何在Express中间件中传递参数。我们将明确讨论两种方式。第一种是使用静态和异步方法，第二种是常规变量。敬请关注最后。那些不喜欢多读书的人，<a class="ae jz" href="https://github.com/Piyush-Use-Personal/middlewares-sample" rel="noopener ugc nofollow" target="_blank">这里的</a>是这个的源代码</p><h1 id="a667" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">形式定义</h1><p id="0a74" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">这是对中间件的正式描述，中间件是一种在API端点和控制器之间调用的方法。您可以添加任意数量的中间件。例如，检查授权、速率限制、减速等等。它将包含一个常规的HTTP请求和响应，以及传递给下一个调用者的回调</p><h1 id="93c4" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">开始</h1><p id="0004" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">我不会深入讲解如何设置express之类的东西，所以我把它留给你。有这些简单的任务</p><ul class=""><li id="2824" class="lw lx in la b lb ly lf lz lj ma ln mb lr mc lv md me mf mg bi translated">创建服务器文件</li><li id="97a4" class="lw lx in la b lb mh lf mi lj mj ln mk lr ml lv md me mf mg bi translated">分配端口</li><li id="efa3" class="lw lx in la b lb mh lf mi lj mj ln mk lr ml lv md me mf mg bi translated">听那个港口</li></ul><p id="1960" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated">至少做到这一点，我们就可以走了</p><h2 id="bea9" class="mp kb in bd kc mq mr dn kg ms mt dp kk lj mu mv ko ln mw mx ks lr my mz kw na bi translated">方法1</h2><p id="f1fc" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">让我们开始我们的第一步。我们需要首先创建一个端点</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/1f19959b817240ff8a1211a58c977dd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LlJrR7YQMXjE8EYkGQKo-Q.png"/></div></div></figure><p id="ec32" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated">这是一条没有中间件的路由。如果我运行服务器并转到端点<code class="fe ng nh ni nj b">localhost:&lt;port&gt;/static</code>,我会看到角色未定义的消息。我们将在中间件中添加角色</p><p id="5297" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated">现在让我们创建一个名为<code class="fe ng nh ni nj b">middleware</code>的文件夹，并在其中归档为<code class="fe ng nh ni nj b">static.js</code>。您可以根据自己的选择对其进行重命名，这是该文件的内容</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/6b258770502311ab6d02eb42946de9c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KHj7c_fO9ZOLBhHw50UymA.png"/></div></div></figure><p id="c02e" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated">让我先解释一下代码，这里我们创建了一个名为<code class="fe ng nh ni nj b">Authentication</code>的类，并添加了一个静态方法<code class="fe ng nh ni nj b">ensureRole</code>，该方法将一个参数作为<code class="fe ng nh ni nj b">role</code>。现在最酷的部分来了，我们从静态方法中返回了另一个异步方法，看起来像一个路由。由于角色有一个上限范围，我们可以很容易地访问内部方法中的变量。</p><p id="fdfd" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated">优点:你可以通过这种方式传递任意数量的参数</p><p id="a20b" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated">让我们转到端点，并在中间添加这个中间件，如下所示</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/92021436b726313d1387a54ecffedb28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7e0472JCdsespjw9s2pG1A.png"/></div></div></figure><p id="397c" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated">现在，如果我们回到浏览器中的端点，您将会看到角色不再是未定义的，而是包含了一个客户</p><h2 id="8a92" class="mp kb in bd kc mq mr dn kg ms mt dp kk lj mu mv ko ln mw mx ks lr my mz kw na bi translated">方法2</h2><p id="ec38" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">到了创建第二个端点的时候了，让我们使用上面相同的方法创建一个简单的路由。这是路线的参考</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/0078e3e30ce2b167def422e8b00e1a7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L4Wil-eKOerd21zQlD6Eag.png"/></div></div></figure><p id="6360" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated">我将它命名为<code class="fe ng nh ni nj b">/fixed</code>,但是你可以随意命名。就像上面的路线走这条路线会给一个空的角色所以不要浪费你的时间</p><p id="76a2" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated">让我们移动到中间件文件夹并创建另一个文件<code class="fe ng nh ni nj b">fixed.js</code>。将内容放入文件</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/2c414b83f873e1cd95213042f96dafba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cZvoe6VN7eVu6mJYpDwjTw.png"/></div></div></figure><p id="5887" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated">这里我们有一个名为<code class="fe ng nh ni nj b">Authentication</code>的类，有趣的是我们不再仅仅坚持3个参数，而是向实际的中间件角色传递一个参数</p><p id="c7b5" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated"><strong class="la io">劣势</strong>:参数数量非常有限</p><p id="a6a1" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated">让我们更新路由，并在中间放置任何中间件。</p><p id="5ff9" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated"><em class="nl">注意</em>:你可以改变导入方法，因为我没有展示我是如何需要这些文件的</p><figure class="nc nd ne nf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/96e31842898ac01a79595aa2d4fcff52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eNdWcRaMTyPJ1-4Z3lagQA.png"/></div></div></figure><p id="81bc" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated">现在，如果您返回到路由，您将看到角色已经更新，您可以通过替换其中的方法将其更改为任何内容。这看起来比上面的方法干净多了，但是它受限于假设要传递的参数数量</p><h2 id="a76e" class="mp kb in bd kc mq mr dn kg ms mt dp kk lj mu mv ko ln mw mx ks lr my mz kw na bi translated">结论</h2><p id="b870" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">希望这篇文章能帮助你得到你想要的东西，如果你错过了文章的开头，那么这里是源代码的<a class="ae jz" href="https://github.com/Piyush-Use-Personal/middlewares-sample" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="ec5c" class="pw-post-body-paragraph ky kz in la b lb ly ld le lf lz lh li lj mm ll lm ln mn lp lq lr mo lt lu lv ig bi translated"><em class="nl">更多内容请看</em><a class="ae jz" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="la io"><em class="nl">plain English . io</em></strong></a></p></div></div>    
</body>
</html>