<html>
<head>
<title>How to Manage Login and SignUp with Firebase Authentification.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Firebase身份验证管理登录和注册？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-manage-login-and-signup-with-firebase-authentification-fa2413d18934?source=collection_archive---------7-----------------------#2021-11-18">https://javascript.plainenglish.io/how-to-manage-login-and-signup-with-firebase-authentification-fa2413d18934?source=collection_archive---------7-----------------------#2021-11-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><h2 id="a809" class="il im in bd b dl io ip iq ir is it dk iu translated" aria-label="kicker paragraph">火焰基座和角形尖端</h2><div class=""/><div class=""><h2 id="6cbc" class="pw-subtitle-paragraph jt iw in bd b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk dk translated">通过AngularFire使用Firebase身份验证正确管理您的用户连接。</h2></div><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/6e41d9c41fe3126e0317e4d564dcc49e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WFukEbIXajubCJX6"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Photo by <a class="ae lb" href="https://unsplash.com/@mr_williams_photography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Micah Williams</a> on <a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9670" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">这篇文章是关于使用Firebase身份验证管理应用程序上的登录和注册。这不是很有趣吗？</p><p id="43e2" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">不应该写一整篇文章来讨论如何让用户创建我们应用程序的帐户，或者让他们使用Firebase身份验证登录。对于许多人来说，这似乎是Firebase文档中最简单的部分，也许他们是对的🤷‍♂️.</p><p id="7f0b" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">相信我，虽然这可能很简单，但当涉及到检查用户是否已经存在于Firebase中以避免关于两个本应独立的帐户的冲突时，许多开发人员都会遇到问题。在这里，有几种做法被用来解决这个问题，但在我看来，并不是所有的做法都值得推荐。</p><p id="fa71" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">写这篇文章的我自己也遇到了同样的问题，我在Google上找到的一些答案并没有让我满意，所以我写这篇文章，希望基于Firebase本身的文档为您提供一个最佳的解决方案。</p><h1 id="d9f3" class="ly lz in bd ma mb mc md me mf mg mh mi kc mj kd mk kf ml kg mm ki mn kj mo mp bi translated">怎么解决？</h1><p id="a197" class="pw-post-body-paragraph lc ld in le b lf mq jx lh li mr ka lk ll ms ln lo lp mt lr ls lt mu lv lw lx ig bi translated">我在网上看到有两个解决这个问题的流程，一个我称之为最差，一个我称之为最细。我将在下面的句子中向你解释它们，向你展示我建议你不要使用的方法，以及当你面临这个问题时我强烈建议你使用的方法。</p><h2 id="2ce5" class="mv lz in bd ma mw mx dn me my mz dp mi ll na nb mk lp nc nd mm lt ne nf mo it bi translated"><strong class="ak"> a .检查用户是否在Firestore中(</strong>错误提示)</h2><p id="2b64" class="pw-post-body-paragraph lc ld in le b lf mq jx lh li mr ka lk ll ms ln lo lp mt lr ls lt mu lv lw lx ig bi translated">在登录的情况下，该解决方案建议通过收集用户的电子邮件来连接用户，以便在Firestore中进行检查；如果存在，我们通过Firebase Auth连接他，在相反的情况下，我们要求他创建一个帐户。</p><p id="e23c" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">在注册的情况下，用户的电子邮件被再次检索并在Firestore中检查；如果不存在，则创建帐户；如果是，用户被告知该电子邮件已经注册，他/她应该使用另一个电子邮件或登录。</p><p id="2c7d" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">这肯定会过去，但却引起<strong class="le ix"><em class="ng"/></strong>三个顾虑:</p><ol class=""><li id="8e44" class="nh ni in le b lf lg li lj ll nj lp nk lt nl lx nm nn no np bi translated"><strong class="le ix">在不必要的时候，您将为此阅读付费，</strong></li><li id="6eb9" class="nh ni in le b lf nq li nr ll ns lp nt lt nu lx nm nn no np bi translated">不必要的阅读需要比大多数用户更多的耐心。</li><li id="766c" class="nh ni in le b lf nq li nr ll ns lp nt lt nu lx nm nn no np bi translated"><strong class="le ix">当您应该使用单点登录(如与Google连接)时，连接和注册管理不善；</strong> <em class="ng">因为在用户登录并选择其连接方式之前，您无法访问该电子邮件地址。</em></li></ol><h2 id="c213" class="mv lz in bd ma mw mx dn me my mz dp mi ll na nb mk lp nc nd mm lt ne nf mo it bi translated">b.请教Auth，他就是解决方案！(好建议)</h2><p id="4b2e" class="pw-post-body-paragraph lc ld in le b lf mq jx lh li mr ka lk ll ms ln lo lp mt lr ls lt mu lv lw lx ig bi translated">对于登录和注册，直接使用Firebase身份验证。在这一部分中，我将一步一步地向您介绍要实现良好的认证管理应该做些什么。</p><p id="7950" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">为了一个好的演示，我将开发一个应用程序。该应用程序将在以下版本中开发:</p><ol class=""><li id="2f7d" class="nh ni in le b lf lg li lj ll nj lp nk lt nl lx nm nn no np bi translated"><a class="ae lb" href="https://angular.io/docs" rel="noopener ugc nofollow" target="_blank"> Angular (v12.2.7) </a>这是一个用于前端应用开发的JavaScript框架。</li><li id="a485" class="nh ni in le b lf nq li nr ll ns lp nt lt nu lx nm nn no np bi translated"><a class="ae lb" href="https://github.com/angular/angularfire" rel="noopener ugc nofollow" target="_blank"> AngularFire(7.0.4) </a>这是Firebase的官方角度库。</li></ol><p id="d75d" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">为了让我们更容易理解，我将该解决方案分为三个基本阶段:注册、登录和LoginWithProvider(本例中为Google)。我鼓励你通过给定的链接阅读角和角火文档，以熟悉它们。</p><blockquote class="nv nw nx"><p id="eedf" class="lc ld ng le b lf lg jx lh li lj ka lk ny lm ln lo nz lq lr ls oa lu lv lw lx ig bi translated">通过<code class="fe ob oc od oe b">npm i @angular/fire</code>在你的电脑上安装AngularFire，但是要把它添加到你的项目中，你需要做<code class="fe ob oc od oe b">ng add @angular/fire</code></p></blockquote><p id="9ff5" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">项目中AngularFire的初始化是通过集成AngularFireModule : <code class="fe ob oc od oe b">AngularFireModule.initializeApp(environment.firebase)</code>来完成的，对于这个例子，我添加了AngularFireAuth和AngularFireAuthGuard来进行身份验证。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="of og l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">app.module.ts</figcaption></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="of og l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">environment.ts</figcaption></figure><p id="0291" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">我已经创建了一个服务，它允许我们为这里的例子实现我们需要的不同特性。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="of og l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">auth.service.ts</figcaption></figure><blockquote class="nv nw nx"><p id="9de4" class="lc ld ng le b lf lg jx lh li lj ka lk ny lm ln lo nz lq lr ls oa lu lv lw lx ig bi translated">这个主题中的一个小妙处是下面的代码</p></blockquote><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="of og l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">style.css</figcaption></figure><h2 id="3eaa" class="mv lz in bd ma mw mx dn me my mz dp mi ll na nb mk lp nc nd mm lt ne nf mo it bi translated">b.1 .注册(通过电子邮件)</h2><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oh"><img src="../Images/cf5fe56e136531e739aa279c1b408ca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n8Z8ojorYTlhsPRWYa4HQQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">sign-up page</figcaption></figure><p id="4abb" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">这是页面的HTML代码，在上面的代码中可以找到全局样式(style.css)</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="of og l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">sign-up.component.html</figcaption></figure><p id="a775" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">要使用电子邮件和密码管理注册，只需接受这两个参数，然后执行createUserWithEmailAndPassword方法就足够了。一个承诺将会得到回报:</p><p id="5143" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">1️⃣如果成功:你重定向用户到所需的页面；对我们来说，它是主页。</p><p id="902d" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">出错时的2️⃣:您有四个选项<code class="fe ob oc od oe b">email-already-in-use</code>、<code class="fe ob oc od oe b">invalid-email</code>、<code class="fe ob oc od oe b">operation-not-allowed</code>和<code class="fe ob oc od oe b">weak-password</code>。这四种可能性也给了你在代码中行动的自由。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="of og l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">sign-up.component.ts</figcaption></figure><h2 id="ae5e" class="mv lz in bd ma mw mx dn me my mz dp mi ll na nb mk lp nc nd mm lt ne nf mo it bi translated">b.2 .登录(使用电子邮件)</h2><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oh"><img src="../Images/00d6e1ad77171dc2205b134e7d129722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kVmUxcuWZzR8_ItbvYhBkw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">login page</figcaption></figure><p id="2cd9" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">这是页面的html代码，在上面的代码中可以找到全局样式(style.css)</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="of og l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">login.component.html</figcaption></figure><p id="d1b7" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">这次要使用电子邮件和密码来管理连接，只需接受两个参数，然后执行signInWithEmailAndPassword方法就足够了。一个承诺将会得到回报:</p><p id="0dae" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">成功时的1️⃣:你再次将用户重定向到想要的页面；对我们来说，这是主页。</p><p id="6561" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">出错时的2️⃣:您有四个选项<code class="fe ob oc od oe b">invalid-email</code>、<code class="fe ob oc od oe b">user-disabled</code>、<code class="fe ob oc od oe b">user-not-found</code>和<code class="fe ob oc od oe b">wrong-password</code>。这四种可能性为您的代码提供了自由的操作范围。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="of og l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">login.component.ts</figcaption></figure><h2 id="0e08" class="mv lz in bd ma mw mx dn me my mz dp mi ll na nb mk lp nc nd mm lt ne nf mo it bi translated">b.3 .向提供商登录</h2><div class="km kn ko kp gt ab cb"><figure class="oi kq oj ok ol om on paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/ef2ecd8e2d95723a458abd3b6bf2e3b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*kVmUxcuWZzR8_ItbvYhBkw.png"/></div></figure><figure class="oi kq oo ok ol om on paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/fcbf537d98bf8f1c7c0df4a3ae4a2608.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*n8Z8ojorYTlhsPRWYa4HQQ.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk op di oq or">Login With Google</figcaption></figure></div><p id="f8ad" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">至于在这种情况下连接到像Google这样的Firebase提供商，您必须非常小心。您首先必须实现允许您访问提供者的方法，然后通过您的按钮调用它；连接后，不要犹豫，做你想做的。</p><p id="b468" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">但是这个动作会产生两个错误:<em class="ng">当你已经存在的时候作为新用户登录或者当他是新用户的时候作为老用户登录。</em></p><p id="5149" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">要解决这个问题，检查连接的用户就足够了。Firebase返回登录元数据，因此您可以比较帐户的创建日期和上次登录的日期；如果它们相等，则是新用户，如果不相等，则该用户已经存在于Firebase身份验证中。</p><blockquote class="nv nw nx"><p id="5e74" class="lc ld ng le b lf lg jx lh li lj ka lk ny lm ln lo nz lq lr ls oa lu lv lw lx ig bi translated"><strong class="le ix">注</strong>:该零件的代码可以在前面两个中找到</p></blockquote></div><div class="ab cl os ot hr ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="ig ih ii ij ik"><h1 id="3472" class="ly lz in bd ma mb oz md me mf pa mh mi kc pb kd mk kf pc kg mm ki pd kj mo mp bi translated">临终遗言</h1><p id="bdd3" class="pw-post-body-paragraph lc ld in le b lf mq jx lh li mr ka lk ll ms ln lo lp mt lr ls lt mu lv lw lx ig bi translated">我不能以谈论一个我认为引起这种担忧的主要因素来结束这篇文章。身份验证和Firestore不应混淆，后者允许在对这些用户进行身份验证后存储数据。当然，我们使用相同的uid来链接经过身份验证的用户和我们放在Firestore中的其他数据；我们应该明白，没有经过认证，任何用户都不能进入Firestore。</p><blockquote class="nv nw nx"><p id="b06a" class="lc ld ng le b lf lg jx lh li lj ka lk ny lm ln lo nz lq lr ls oa lu lv lw lx ig bi translated">如果你想更仔细地查看源代码，可以点击下面的<a class="ae lb" href="https://github.com/ShekMak/firebase-auth-management.git" rel="noopener ugc nofollow" target="_blank"> <strong class="le ix">链接</strong> </a></p></blockquote></div><div class="ab cl os ot hr ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="ig ih ii ij ik"><h1 id="9972" class="ly lz in bd ma mb oz md me mf pa mh mi kc pb kd mk kf pc kg mm ki pd kj mo mp bi translated">参考</h1><div class="pe pf gp gr pg ph"><a href="https://firebase.google.com/docs/reference/js/v8/firebase.auth.Auth" rel="noopener  ugc nofollow" target="_blank"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd ix gy z fp pm fr fs pn fu fw iw bi translated">Auth | JavaScript SDK | Firebase</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">认证参考</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">firebase.google.com</p></div></div><div class="pq l"><div class="pr l ps pt pu pq pv kv ph"/></div></div></a></div><div class="pe pf gp gr pg ph"><a href="https://stackoverflow.com/questions/51562995/how-can-i-check-if-user-exists-in-firebase" rel="noopener  ugc nofollow" target="_blank"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd ix gy z fp pm fr fs pn fu fw iw bi translated">如何检查Firebase中是否存在用户？</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">感谢贡献一个堆栈溢出的答案！请务必回答问题。提供详细信息并分享…</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">stackoverflow.com</p></div></div><div class="pq l"><div class="pw l ps pt pu pq pv kv ph"/></div></div></a></div><div class="pe pf gp gr pg ph"><a href="https://firebase.google.com/docs/auth/web/google-signin" rel="noopener  ugc nofollow" target="_blank"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd ix gy z fp pm fr fs pn fu fw iw bi translated">使用带有JavaScript | Firebase的Google登录进行身份验证</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">您可以让您的用户使用他们的Google帐户通过Firebase进行身份验证，方法是将Google登录集成到您的…</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">firebase.google.com</p></div></div><div class="pq l"><div class="px l ps pt pu pq pv kv ph"/></div></div></a></div><div class="pe pf gp gr pg ph"><a href="https://github.com/ShekMak/firebase-auth-management.git" rel="noopener  ugc nofollow" target="_blank"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd ix gy z fp pm fr fs pn fu fw iw bi translated">GitHub-shek mak/firebase-auth-management</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">此项目是使用Angular CLI版本12.2.7生成的。为开发服务器运行ng serve。导航到…</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">github.com</p></div></div><div class="pq l"><div class="py l ps pt pu pq pv kv ph"/></div></div></a></div><p id="020c" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated"><em class="ng">更多内容请看</em><a class="ae lb" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="le ix"><em class="ng">plain English . io</em></strong></a></p></div></div>    
</body>
</html>