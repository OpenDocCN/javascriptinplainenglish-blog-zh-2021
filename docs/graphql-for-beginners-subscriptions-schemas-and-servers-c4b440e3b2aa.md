# é¢å‘åˆå­¦è€…çš„ GraphQL:è®¢é˜…ã€æ¨¡å¼å’ŒæœåŠ¡å™¨

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/graphql-for-beginners-subscriptions-schemas-and-servers-c4b440e3b2aa?source=collection_archive---------16----------------------->

## GraphQL åˆå­¦è€…å‹å¥½ç³»åˆ—ğŸ”°è®©æˆ‘ä»¬ä»åœæ­¢çš„åœ°æ–¹ç»§ç»­ï¼ç¬¬ 2 éƒ¨åˆ†:GraphQL æ¨¡å¼ã€è®¢é˜…å’ŒæœåŠ¡å™¨

![](img/441364829aedcbee08890722eb18b79b.png)

æ¬¢è¿å›åˆ° [GraphQL åˆå­¦è€…](https://lo-victoria.com/series/graphql)ï¼è¿™æ˜¯ä¸€ä¸ªå¯¹åˆå­¦è€…å‹å¥½çš„ç³»åˆ—ï¼Œä»‹ç»äº† GraphQL çš„åŸºæœ¬æ¦‚å¿µï¼Œä»¥åŠå¦‚ä½•å°†å…¶è¿æ¥åˆ°å‰ç«¯æ¡†æ¶ï¼Œå¦‚ä½¿ç”¨ Apollo çš„ Reactã€‚åœ¨æœ¬ç³»åˆ—ç»“æŸæ—¶ï¼Œæ‚¨å°†èƒ½å¤Ÿä½¿ç”¨ GraphQLã€React å’Œ Apollo æ„å»ºä¸€ä¸ªç®€å•çš„èŠå¤©åº”ç”¨ç¨‹åºã€‚

*å…ˆç¹ä¸ºå¿«:*

![](img/1a40af14119a83c6dcda6d28e9bb9b26.png)

å¦‚æœæ‚¨è¿˜æ²¡æœ‰é˜…è¯»ç¬¬ 1 éƒ¨åˆ†ï¼Œè¯·åœ¨è¿™é‡Œé˜…è¯»[ã€‚](https://victoria2666.medium.com/graphql-for-beginners-introduction-90c78a56a96e?sk=ee4885321344329d8af3096f9074427b)

# ææ¬¾

åœ¨ç¬¬ 1 éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº† GraphQL æ”¯æŒçš„ä¸¤ç§æ“ä½œ:æŸ¥è¯¢å’Œçªå˜ã€‚ç¬¬ä¸‰ç§ç±»å‹è¢«ç§°ä¸ºè®¢é˜…ã€‚

è®¢é˜…æ˜¯ç”¨äºåœ¨æŒ‡å®šäº‹ä»¶æ—¶å°†æ•°æ®ä»æœåŠ¡å™¨æ¨é€åˆ°å®¢æˆ·ç«¯çš„æ“ä½œã€‚åƒæŸ¥è¯¢ä¸€æ ·ï¼Œå®ƒä»¬è·å–æ•°æ®å¹¶è¿”å›æ•°æ®ï¼Œä½†åªåœ¨å‘ç”Ÿç‰¹å®šå˜åŒ–æ—¶ã€‚å› æ­¤ï¼Œè®¢é˜…é€šè¿‡ä¸ GraphQL æœåŠ¡å™¨çš„æ´»åŠ¨è¿æ¥(å³é€šè¿‡ WebSocket)æ¥å·¥ä½œï¼Œå®ƒå°†ä¾¦å¬ç‰¹å®šçš„äº‹ä»¶ï¼Œå¹¶åœ¨äº‹ä»¶è¢«è§¦å‘æ—¶è¿”å›æ•°æ®ã€‚

# å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„

è®©æˆ‘ä»¬å›åˆ°æˆ‘ä»¬çš„é›ªç‰™æ»‘é›ªåœº API ç¤ºä¾‹ï¼Œä½äº:[snowtooth.moonhighway.com](https://snowtooth.moonhighway.com/)ã€‚

åœ¨ Docs é¢æ¿ä¸­çš„ Subscriptions ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ª API æœ‰ä¸¤ä¸ªå¯ç”¨çš„è®¢é˜…æ“ä½œã€‚è®©æˆ‘ä»¬ç‚¹å‡»`LiftStatusChange`ï¼Œå®ƒç›‘å¬ Lift ä¸­çš„çŠ¶æ€å˜åŒ–å¹¶è¿”å› Lift å¯¹è±¡ã€‚

![](img/f50b2ab78555e10464c1840735fc233c.png)

è®©æˆ‘ä»¬é¦–å…ˆè®¢é˜…è¿™ä¸ªæ“ä½œï¼Œç„¶åæ›´æ”¹ä¸€ä¸ªç”µæ¢¯çš„çŠ¶æ€ï¼Œçœ‹çœ‹è®¢é˜…æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

åœ¨ä¸‹å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå•å‡»æ‰§è¡ŒæŒ‰é’®æ—¶ï¼Œæ“ä½œç»§ç»­è¿è¡Œï¼Œå•è¯â€œListeningâ€æ˜¾ç¤ºåœ¨åº•éƒ¨ï¼Œè¡¨ç¤ºè®¢é˜…ç°åœ¨æ­£åœ¨ç§¯æç­‰å¾…ä¸€ä¸ª`LiftStatusChange`äº‹ä»¶ã€‚

![](img/f1115f6d9952f7dd00bf08c48867d963.png)

ç°åœ¨è®©æˆ‘ä»¬ç”¨å˜å¼‚`setLiftStatus`æ¥æ”¹å˜å‡é™æœºçš„çŠ¶æ€ã€‚

> é˜…è¯»[ç¬¬ 1 éƒ¨åˆ†](https://victoria2666.medium.com/graphql-for-beginners-introduction-90c78a56a96e?sk=ee4885321344329d8af3096f9074427b)äº†è§£æ›´å¤šå…³äºçªå˜çš„ç»†èŠ‚

![](img/bb44629ee5413c1004714b360aaa9812.png)

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘å°† id ä¸º`astra-express`çš„ç”µæ¢¯æ›´æ”¹ä¸º HOLD çŠ¶æ€ã€‚å›åˆ° subscription é€‰é¡¹å¡ï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªæ•°æ®å¯¹è±¡å·²ç»è¿”å›ï¼Œå› ä¸ºä¾¦å¬å™¨æ£€æµ‹åˆ°äº†ä¸€ä¸ª Lift çŠ¶æ€æ›´æ”¹ã€‚

![](img/a719370369bb5bf0f6d654d3979e6786.png)

å¹¶æ­£ç¡®è¿”å›ç”µæ¢¯çŠ¶æ€æ”¹å˜çš„æ•°æ®:`astra-express`ã€‚

# ä¸ºä»€ä¹ˆä½¿ç”¨è®¢é˜…ï¼Ÿ

è®¢é˜…æ˜¯æœ‰ç”¨çš„ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å®æ—¶æ›´æ–°æ•°æ®ç»™æˆ‘ä»¬çš„å®¢æˆ·ã€‚

åœ¨æˆ‘ä»¬å°†è¦æ„å»ºçš„èŠå¤©åº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä½¿ç”¨æŸ¥è¯¢æ„å‘³ç€æˆ‘ä»¬éœ€è¦åœ¨æ¯æ¬¡ç”¨æˆ·å‘å¸ƒæ¶ˆæ¯æ—¶è·å–å¹¶è¿”å›èŠå¤©æ•°æ®ã€‚ç›¸åï¼Œè®¢é˜…å°†å…è®¸æ–°å‘å¸ƒçš„æ¶ˆæ¯åœ¨ä¾¦å¬å™¨æ£€æµ‹åˆ°æ–°æ¶ˆæ¯å‘å¸ƒæ—¶è‡ªåŠ¨è¿”å›ã€‚

# è®¡åˆ’

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ä»ç°æœ‰çš„ GraphQL APIs(å¦‚ [hashnode API](https://api.hashnode.com/) å’Œ [Snow Tooth Ski Resort API](https://snowtooth.moonhighway.com/) )ä¸­äº†è§£äº† GraphQL æŸ¥è¯¢ã€å˜å¼‚å’Œè®¢é˜…ã€‚

å¯¹äºæˆ‘ä»¬çš„èŠå¤©åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦ä»å¤´å¼€å§‹æ„å»ºè‡ªå·±çš„ GraphQL APIã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªæ¨¡å¼ã€‚æ¨¡å¼æ˜¯ GraphQL API çš„è“å›¾ã€‚å®ƒå®šä¹‰äº†ç»„æˆ API çš„ç±»å‹å’Œå®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚å­¦ä¹ æ¨¡å¼å®šä¹‰è¯­è¨€(SDL)å°†å…è®¸æ‚¨ä¸º GraphQL APIs åˆ›å»ºå¥å£®çš„ç±»å‹ç³»ç»Ÿã€‚

# è¿™éƒ½æ˜¯å…³äºç±»å‹çš„

ä¸ºäº†æ„å»ºæ¨¡å¼ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å®šä¹‰ç±»å‹çš„ç±»åˆ«ã€‚ç±»å‹å¯ä»¥æ˜¯ä»¥ä¸‹ç±»åˆ«ä¹‹ä¸€:

## 1.æ ‡é‡ç±»å‹

å›é¡¾æœ¬ç³»åˆ—çš„ç¬¬ 1 éƒ¨åˆ†ï¼Œæ ‡é‡ç±»å‹æœ‰ IDã€Floatã€Intã€String æˆ– Booleanã€‚

## 2.å¯¹è±¡ç±»å‹

æœ‰è‡ªå·±å±æ€§(å­—æ®µ)çš„ç±»å‹ï¼Œæ¯ä¸ªå­—æ®µä¹Ÿæœ‰è‡ªå·±çš„ç±»å‹ã€‚

## 3.æŸ¥è¯¢ç±»å‹

å…¥å£ç‚¹è¿›è¡ŒæŸ¥è¯¢ï¼Œå¹¶å®šä¹‰ä»è¯¥æŸ¥è¯¢è¿”å›çš„æ•°æ®ã€‚

## 4.çªå˜ç±»å‹

åˆ›å»ºæˆ–æ›´æ–°æ•°æ®çš„å…¥å£ç‚¹ï¼Œç„¶åè¿”å›æŒ‡å®šçš„æ•°æ®ã€‚

## 5.è®¢é˜…ç±»å‹

å…è®¸è®¢é˜…ç‰¹å®šäº‹ä»¶æˆ–ç‰¹å®šæ•°æ®æ›´æ”¹çš„å…¥å£ç‚¹ã€‚

## 6.æšä¸¾ç±»å‹

ç±»å‹å€¼çš„é¢„å®šä¹‰å’Œå—é™é€‰é¡¹åˆ—è¡¨ã€‚

## 7.è¾“å…¥ç±»å‹

å…è®¸ä¼ é€’ä¸€ä¸ªå¯¹è±¡ä½œä¸ºæŸ¥è¯¢/å˜å¼‚çš„å‚æ•°ã€‚

## 8.å·¥ä¼šç±»å‹

å…è®¸å­—æ®µè¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªå¯¹è±¡ç±»å‹ã€‚

## 9.æ¥å£ç±»å‹

å¯ä»¥ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå¯¹è±¡ç±»å‹å®ç°çš„ä¸€ç»„å±æ€§(å­—æ®µ)ã€‚

# ä¸€ä¸ªä¾‹å­

æˆ‘ä»¬çš„é›ªç‰™æ»‘é›ªåœº API æœ‰ä¸€ä¸ª Lift å¯¹è±¡ç±»å‹ã€‚å®ƒçš„ç±»å‹å°†åœ¨æ¨¡å¼ä¸­å®šä¹‰ã€‚â€œæ–‡æ¡£â€é¢æ¿æ˜¾ç¤ºäº†è¯¥ç±»å‹çš„å¤–è§‚ã€‚

![](img/9a8e82c4726df2506d1337984a2e6aba.png)

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒçš„ä¸€äº›å±æ€§åƒ`id`å’Œ`name`æ˜¯æ ‡é‡ç±»å‹ã€‚è€Œå…¶ä»–çš„åƒ`status`è¿”å›`LiftStatus`ï¼Œä¸€ä¸ªæšä¸¾ç±»å‹ã€‚

![](img/67af12efa5a534f7b8339d0c43adf5aa.png)

æ–¹æ‹¬å·è¡¨ç¤ºè¿”å›å€¼å°†æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚æ‰€ä»¥`trailAccess`è¿”å›ä¸€ç»„è¸ªè¿¹ç±»å‹ã€‚å¹¶ä¸”è¸ªè¿¹ç±»å‹æ˜¯å…·æœ‰å…¶è‡ªèº«å±æ€§çš„å¯¹è±¡ç±»å‹ã€‚

![](img/aaa8fdd0d8f88d921d8232fedb88845d.png)

# SDL å°æŠ„

åœ¨æœ¬ç³»åˆ—çš„ä¸‹ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä¸ºæˆ‘ä»¬çš„èŠå¤©åº”ç”¨ç¨‹åºé¡¹ç›®æ„å»ºæˆ‘ä»¬è‡ªå·±çš„æ¨¡å¼ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥ç®€å•æµè§ˆä¸€ä¸‹è¿™ä¸ªæœ‰ç”¨çš„ SDL å°æŠ„ã€‚

![](img/9820aebf772ee9dcb0bb05013a792058.png)

# æœåŠ¡å™¨

ä¸ºäº†è®©å®¢æˆ·ç«¯ä» GraphQL API æŸ¥è¯¢æ•°æ®ï¼ŒGraphQL æœåŠ¡å™¨å°†æ˜¯ä¸€ä¸ªç®€å•ä¸”å¸¸è§çš„è§£å†³æ–¹æ¡ˆã€‚å®ƒç”±ä¸¤ä»¶äº‹ç»„æˆ:

1.  GraphQL æ¨¡å¼
2.  è§£æå™¨åŠŸèƒ½

å¦‚å‰æ‰€è¿°ï¼Œæ¨¡å¼æè¿°äº† API ä¸­çš„ç±»å‹(å³ç±»å‹åç§°ã€å…¶å±æ€§å’Œæ¯ä¸ªå±æ€§çš„ç±»å‹)ã€‚

è§£æå™¨å‡½æ•°å‘Šè¯‰ API åœ¨è¯¥ç±»å‹çš„æ¯ä¸ªå±æ€§ä¸­è¿”å›ä»€ä¹ˆä»¥åŠå¦‚ä½•è¿”å›æ•°æ®ã€‚å› æ­¤ï¼Œæ¨¡å¼ä¸­çš„æ¯ä¸ªå±æ€§(å­—æ®µ)éƒ½ç”±ä¸€ä¸ªè§£æå™¨å‡½æ•°æ”¯æŒï¼Œè¯¥å‡½æ•°è´Ÿè´£è¿”å›è¯¥å­—æ®µä¸­çš„æ•°æ®ã€‚

![](img/54648c8e8552aba042bb09b050aaf671.png)

# ä¸€ä¸ªä¾‹å­

åœ¨ Snow Tooth API ä¸­ï¼Œæœ‰ä¸€ä¸ªæŸ¥è¯¢ç±»å‹`allLifts`è¿”å›ä¸€ä¸ª Lift å¯¹è±¡æ•°ç»„ã€‚ç±»å‹æ¨¡å¼çœ‹èµ·æ¥åƒè¿™æ ·:

```
type Query {
   allLifts: [Lift!]!
}
```

å­—æ®µ`allLifts`å°†æœ‰ä¸€ä¸ªè§£æå‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
allLifts: () =>{
  return lifts;
}
```

åœ¨æ„å»ºèŠå¤©åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•æ›´è¯¦ç»†åœ°æ„é€ è§£æå™¨å‡½æ•°ã€‚è¿™åªæ˜¯ GraphQL æœåŠ¡å™¨åŠå…¶è§£æå™¨åŠŸèƒ½å¦‚ä½•å·¥ä½œçš„ä¸€èˆ¬æ¦‚å¿µã€‚

# é€‰æ‹©æ‚¨çš„ GraphQL æœåŠ¡å™¨

è®¾ç½® GraphQL æœåŠ¡å™¨æœ‰è®¸å¤šé€‰é¡¹ã€‚è¿™ç¯‡[æ–‡ç« ](https://dev.to/yeeiodev/differences-between-express-graphql-apollo-and-graphql-yoga-3m82)æ¯”è¾ƒäº† GraphQL æœåŠ¡å™¨çš„ 3 ç§æœ€å¸¸è§é€‰æ‹©:

1.  å¿«é€Ÿ+å¿«é€Ÿ-å›¾è¡¨ ql +å›¾è¡¨ ql
2.  apollo-server + graphql
3.  graph QL-ç‘œä¼½

åœ¨æœ¬ç³»åˆ—çš„ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`graphql-yoga`æ¥è®¾ç½®èŠå¤©åº”ç”¨ç¨‹åºçš„ GraphQL æœåŠ¡å™¨ã€‚ä½†æ˜¯ä½ å¯ä»¥è‡ªç”±æ¢ç´¢ä¸åŒçš„é€‰æ‹©ï¼Œåœ¨ä½ çš„ç©ºé—²æ—¶é—´äº²è‡ªå°è¯•ã€‚

# å¾…ç»­

æ„Ÿè°¢é˜…è¯»è¿™ç¯‡æ–‡ç« ã€‚å¸Œæœ›åˆ°ç›®å‰ä¸ºæ­¢æœ‰æ‰€å¸®åŠ©ã€‚ç°åœ¨æˆ‘ä»¬ç»ˆäºäº†è§£äº†è¿™ä¸ªé¡¹ç›®æ‰€éœ€çš„å…³äº GraphQL çš„æ‰€æœ‰æ¦‚å¿µï¼Œåœ¨ä¸‹ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å¼€å§‹æ„å»ºæˆ‘ä»¬çš„èŠå¤©åº”ç”¨ç¨‹åºï¼

ç‚¹å‡»è¿™é‡Œé˜…è¯»[ç¬¬ 3 éƒ¨åˆ†:è®¾ç½® GraphQL æœåŠ¡å™¨](https://victoria2666.medium.com/graphql-for-beginners-setting-up-graphql-server-ba48a3cbc184?sk=330d2a07f119d5734ae2424a417eecd1)ï¼

åŒæ—¶ï¼Œå¦‚æœæ‚¨æƒ³æ›´æ·±å…¥åœ°æ¢ç´¢æœ¬æ–‡ä¸­çš„æ¦‚å¿µï¼Œè¯·æŸ¥çœ‹ä¸‹é¢çš„é˜…è¯»æ›´å¤šéƒ¨åˆ†ã€‚æ•¬è¯·æœŸå¾…ï¼

# é˜…è¯»æ›´å¤š

*   [ç¬¬ 1 éƒ¨åˆ†:GraphQL ç®€ä»‹](https://victoria2666.medium.com/graphql-for-beginners-introduction-90c78a56a96e?sk=ee4885321344329d8af3096f9074427b)
*   [ç¬¬ 3 éƒ¨åˆ†:è®¾ç½® GraphQL æœåŠ¡å™¨](https://victoria2666.medium.com/graphql-for-beginners-setting-up-graphql-server-ba48a3cbc184?sk=330d2a07f119d5734ae2424a417eecd1)
*   [ç¬¬ 4 éƒ¨åˆ†:ç”¨ GraphQL å’Œ Apollo React æ„å»ºä¸€ä¸ªå®æ—¶èŠå¤©åº”ç”¨](https://lo-victoria.com/graphql-for-beginners-build-real-time-chat-app-with-apollo-client-and-react)
*   [è®¢é˜…](https://www.apollographql.com/docs/react/data/subscriptions/)
*   [å…³äºæ¨¡å¼çš„æ›´å¤šä¿¡æ¯](https://www.apollographql.com/docs/apollo-server/schema/schema/)
*   [ä¸åŒ GraphQL æœåŠ¡å™¨å¯¹æ¯”æ–‡ç« ](https://dev.to/yeeiodev/differences-between-express-graphql-apollo-and-graphql-yoga-3m82)
*   GitHub å›è´­é¡¹ç›®:ã€https://github.com/victoria-lo/devthoughts T3