<html>
<head>
<title>Firebase Auth with React Typescript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有反应类型脚本的Firebase Auth</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/firebase-auth-with-react-typescript-4b9d9605fa53?source=collection_archive---------0-----------------------#2021-05-20">https://javascript.plainenglish.io/firebase-auth-with-react-typescript-4b9d9605fa53?source=collection_archive---------0-----------------------#2021-05-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="436b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本文中，我们将建立一个用TypeScript编写的生产就绪的React应用程序，使用Firebase Auth对用户进行身份验证。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/359334e0ab0e09a4b440dccaba5775dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1PHQzsqaS4nOee-Go5_jcQ.png"/></div></div></figure><h2 id="1c02" class="ku kv in bd kw kx ky dn kz la lb dp lc jv ld le lf jz lg lh li kd lj lk ll lm bi translated">这些是我们的主要目标:</h2><ol class=""><li id="f392" class="ln lo in jm b jn lp jr lq jv lr jz ls kd lt kh lu lv lw lx bi translated">使用TypeScript实现类型安全。</li><li id="8f36" class="ln lo in jm b jn ly jr lz jv ma jz mb kd mc kh lu lv lw lx bi translated">使用路由器保护来保护路由。</li><li id="45b8" class="ln lo in jm b jn ly jr lz jv ma jz mb kd mc kh lu lv lw lx bi translated">保护和安全访问Firebase凭证。</li><li id="107f" class="ln lo in jm b jn ly jr lz jv ma jz mb kd mc kh lu lv lw lx bi translated">使用Firebase的社会认证。</li><li id="d504" class="ln lo in jm b jn ly jr lz jv ma jz mb kd mc kh lu lv lw lx bi translated">对已验证用户对象的全局访问。</li></ol><h2 id="e2b7" class="ku kv in bd kw kx ky dn kz la lb dp lc jv ld le lf jz lg lh li kd lj lk ll lm bi translated">先决条件。</h2><p id="6eda" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">一、<a class="ae mg" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">节点</a>安装完毕。</p><p id="1e8e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">二。<a class="ae mg" href="https://reactjs.org/docs/getting-started.html" rel="noopener ugc nofollow" target="_blank">反应的基本知识</a></p><h1 id="31df" class="mh kv in bd kw mi mj mk kz ml mm mn lc mo mp mq lf mr ms mt li mu mv mw ll mx bi translated">项目设置</h1><p id="2844" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">首先，我们将运行这个命令来创建react-typescript应用程序。</p><p id="4b10" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe my mz na nb b">npx create-react-app <strong class="jm io">APPLICATION_NAME</strong> --template typescript</code></p><p id="5622" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">安装依赖项:</strong></p><pre class="kj kk kl km gt nc nb nd ne aw nf bi"><span id="5297" class="ku kv in nb b gy ng nh l ni nj">npm install react-router-dom</span></pre><p id="617c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae mg" href="https://reactrouter.com/web/guides/quick-start" rel="noopener ugc nofollow" target="_blank"> react-router-dom </a>模块将帮助我们在应用程序中设置路由，并在以后使我们能够保护路由。</p><p id="215c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">cd放入项目文件夹并为应用程序提供服务:</p><pre class="kj kk kl km gt nc nb nd ne aw nf bi"><span id="ec2e" class="ku kv in nb b gy ng nh l ni nj">npm start</span></pre><p id="61e0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在可以在<a class="ae mg" href="https://localhost:3000" rel="noopener ugc nofollow" target="_blank"> https://localhost:3000 </a>上访问该应用程序</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/1d28dd9fc49e2ef34cd1e1d18d9cf50c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MgRn5QlS7FPje97Oe-un6w.png"/></div></div></figure><h1 id="4204" class="mh kv in bd kw mi mj mk kz ml mm mn lc mo mp mq lf mr ms mt li mu mv mw ll mx bi translated">Firebase项目设置</h1><p id="be10" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">接下来，我们需要建立一个新的Firebase项目来验证用户。<br/>在<a class="ae mg" href="https://console.firebase.google.com/u/0/" rel="noopener ugc nofollow" target="_blank"> Firebase控制台</a>中，创建一个新项目:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/3140343854c2dbb5ef46037961c8f21e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NujxugFOoj8WqqMGT-08BA.jpeg"/></div></div></figure><p id="f7c7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">安装Firebase依赖项:</strong></p><p id="e212" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在项目的根目录下，安装firebase:</p><pre class="kj kk kl km gt nc nb nd ne aw nf bi"><span id="52e6" class="ku kv in nb b gy ng nh l ni nj">npm install firebase</span></pre><h1 id="875f" class="mh kv in bd kw mi mj mk kz ml mm mn lc mo mp mq lf mr ms mt li mu mv mw ll mx bi translated">Firebase配置设置</h1><p id="cb01" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">接下来，我们需要从firebase获取项目凭证，并在我们的应用程序中安全地访问凭证。</p><p id="e6d5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">I)注册Firebase SDK应用程序</p><p id="d927" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要从firebase获取项目凭证，请转到Firebase控制台，然后单击<strong class="jm io">项目概述</strong>(位于左侧菜单的最顶端)。在菜单选择上，选择<strong class="jm io">项目设置。</strong>在项目设置页面选择web，这是我们正在工作的平台，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/2a564d7df6e7ce5cffc309f905319bc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q4wYIGHWnZ81iQflqRuI3A.png"/></div></div></figure><p id="123c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">继续注册应用程序并获取凭证，如下所示。(复制详细信息，因为我们将在接下来的步骤中使用凭据。)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/8192dffaf800946d76bac83383fba734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AnTswzWC7ar5ivUz_ilvhg.png"/></div></div></figure><p id="cb14" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> ii)启用Firebase认证</strong></p><p id="2412" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了使用社交登录，我们需要启用firebase身份验证。在您的<a class="ae mg" href="https://console.firebase.google.com/u/0/" rel="noopener ugc nofollow" target="_blank"> Firebase控制台</a>中，选择左侧菜单中的认证并进入<strong class="jm io">入门</strong>，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/b5b472db6d51f0228272e3c35571206f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jfnwN2QFjNPLGKCgARrYZA.png"/></div></div></figure><p id="9718" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，您可以选择要使用的提供程序，并继续启用它们。对于这个例子，我们将使用<strong class="jm io"> Google认证。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/a22ea663b11ae9799a415b07f858ec55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mv9f7gfQCI2XKEs19Yk_OQ.png"/></div></div></figure><p id="7793" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> iii)创造。环境文件</strong></p><p id="f40c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了保护您的firebase凭证并安全访问它们，我们会将它们存储在内存中，为此，我们需要创建一个<strong class="jm io">。env </strong>文件放在我们项目文件夹的根目录下。<br/>曾经的<strong class="jm io">。/env </strong>文件已经创建，粘贴下面的细节并用您之前从Firebase控制台获得的凭证替换这些值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="e496" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注意:</strong>记住要排除。通过将Git中的<strong class="jm io"> /env </strong>文件添加到<strong class="jm io">来提交它。gitignore </strong>文件。</p><p id="abe4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">iv)创建配置文件。</p><p id="0af3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<strong class="jm io">中。/src </strong>文件夹中，我们将创建一个配置文件来保存我们所有的全局配置。<br/>中的<strong class="jm io">。/src/config </strong>文件夹创建一个<strong class="jm io"> config.ts </strong>文件，该文件将从内存中导入firebase配置，并将其用于我们的应用程序。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="3699" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">v)创建firebase.ts文件</p><p id="6c14" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">既然我们可以安全地访问firebase凭证，我们将需要在我们的应用程序中初始化firebase，然后作为提供者提供社交登录方法。这些都是在如下所示的<strong class="jm io"> firebase.ts </strong>文件中完成的。</p><p id="a578" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<strong class="jm io">里。/src/config </strong>文件夹，创建一个<strong class="jm io"> firebase.ts </strong>文件，并粘贴以下详细信息:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="a472" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的代码中，我们使用了谷歌和脸书的提供者，这取决于您之前在Firebase控制台中启用的提供者。</p><h1 id="9037" class="mh kv in bd kw mi mj mk kz ml mm mn lc mo mp mq lf mr ms mt li mu mv mw ll mx bi translated">受保护和不受保护的页面设置</h1><p id="d061" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">我们将创建两个页面，一个受保护(<strong class="jm io"> CartPage.tsx </strong>)，另两个不受保护(<strong class="jm io"> HomePage.tsx，SignUpPage.tsx </strong>)，并启用路由。</p><p id="9744" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> i)创建页面文件夹</strong></p><p id="b10d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，创建一个<strong class="jm io">。/src/pages </strong>文件夹来包含应用程序的所有页面。</p><p id="fa54" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> ii)创建主页</strong></p><p id="046b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在pages文件夹中创建一个<strong class="jm io"> HomePage.tsx </strong>并粘贴下面的内容。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="55c1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上面的代码用一个链接按钮定义了一个基本的react函数组件，它路由到受保护的<strong class="jm io"> CartPage.tsx </strong></p><p id="13f6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> iii)创建接口文件夹</strong></p><p id="5bb9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的代码中，我们在组件文件中定义了<strong class="jm io">页面接口</strong>。然而，我们需要能够在整个应用程序中重用接口。为此，我们需要创建一个.<strong class="jm io"> /src/interfaces </strong>文件夹来包含所有的类型定义。</p><p id="0046" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> iv)创建页面界面文件</strong></p><p id="94ae" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<strong class="jm io">中。/src/interface </strong>文件夹创建一个<strong class="jm io"> page.interface.ts </strong>文件，粘贴以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="feca" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注意:</strong>替换<strong class="jm io"> HomePage.tsx </strong>中的界面，使用我们上面定义的界面。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="3f12" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> v)创建CarPage.tsx </strong></p><p id="f09c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<strong class="jm io">中。/src/pages </strong>文件夹创建一个<strong class="jm io"> CartPage.tsx </strong>文件并粘贴以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="ba8a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">上面的代码定义了一个React功能组件，带有一个返回到<strong class="jm io">主页的链接。</strong></p><p id="e090" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> vi)创建SignUpPage.tsx </strong></p><p id="2d3e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将首先创建一个<strong class="jm io">认证文件夹</strong>来包含所有的认证页面。在<strong class="jm io">中。/src </strong>文件夹下创建一个<strong class="jm io">。/src/auth </strong>文件夹。<br/>然后创建<strong class="jm io"> SignUpPage.tsx </strong>文件，该文件将包含社交登录，使我们能够注册应用程序。现在，我们将设置页面模板，稍后介绍社交登录。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><h1 id="5533" class="mh kv in bd kw mi mj mk kz ml mm mn lc mo mp mq lf mr ms mt li mu mv mw ll mx bi translated">授权模块</h1><p id="72f6" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">现在我们已经定义了所有的页面，我们将继续设置身份验证和路由逻辑。</p><p id="3b1e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我)创建一个授权模块。</p><p id="594b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">认证模块文件夹将包含所有关于认证的逻辑。在<strong class="jm io">中。/src/modules </strong>文件夹，创建一个<strong class="jm io"> auth </strong>文件夹。</p><p id="0e6f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> ii)创建index.ts认证模块入口文件</strong></p><p id="9c91" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<strong class="jm io">中。/src/modules/auth文件夹，</strong>创建一个<strong class="jm io"> index.ts </strong>文件作为身份验证模块的入口点，并粘贴以下详细信息:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="8fc0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该文件包含使用社交登录提供者对用户进行身份验证的逻辑。</p><p id="b29c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> iii)创建AuthRouter.tsx文件</strong></p><p id="1291" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<strong class="jm io">中。/src/modules/auth </strong>文件夹创建一个<strong class="jm io"> AuthRoute.tsx </strong>文件，并粘贴以下详细信息:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="c4a6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该组件文件将作为所有页面的包装器，并将未经验证的用户重新路由到<strong class="jm io">注册页面。</strong></p><h1 id="3cc0" class="mh kv in bd kw mi mj mk kz ml mm mn lc mo mp mq lf mr ms mt li mu mv mw ll mx bi translated">路由和路由器配置</h1><p id="e3a6" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">现在我们已经定义了所有的<strong class="jm io">页面模板</strong>和<strong class="jm io">认证模块</strong>，我们将根据用户的认证状态来实现动态路由。</p><p id="74f5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我)创建route.interface.tsx </p><p id="2832" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在<strong class="jm io">中。/src/interfaces </strong>文件夹中，创建一个<strong class="jm io"> route.interface.ts </strong>文件，该文件将包含路由的类型定义，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="fd4e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注意:</strong>受保护的布尔变量将决定页面是否受保护。</p><p id="0fdc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> ii)创建routes.ts配置文件</strong></p><p id="8cb4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，我们将创建包含所有路由定义的路由配置文件。在<strong class="jm io">中。/src/config </strong>文件夹，创建一个<strong class="jm io"> routes.ts </strong>文件，粘贴以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="dc20" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的配置文件中，我们将<strong class="jm io">主页</strong>和<strong class="jm io">注册页面</strong>定义为不受保护，而<strong class="jm io">卡丁车页面</strong>将要求用户通过身份验证才能访问该页面。</p><h1 id="7890" class="mh kv in bd kw mi mj mk kz ml mm mn lc mo mp mq lf mr ms mt li mu mv mw ll mx bi translated">应用程序路由配置</h1><p id="2ebd" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">现在我们已经定义了<strong class="jm io">路由</strong>和<strong class="jm io">路由配置</strong>，我们将通过在<strong class="jm io">更新我们的根组件来将所有组件集合在一起。/src/App.tsx </strong></p><p id="0d49" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">替换<strong class="jm io">的内容。/src/App.tsx </strong>内容如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="4410" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的代码片段中，我们使用<a class="ae mg" href="https://reactjs.org/docs/hooks-effect.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> useEffect </strong> </a>钩子来跟踪和更新用户的auth状态。在render方法中，我们映射路线列表，并根据路线的<strong class="jm io"> protected </strong>属性进行渲染。</p><p id="2de0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，您应该能够测试所有页面路由:</p><p id="091b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">无保护</strong> —主页:(http://localhost:3000)</p><p id="15f1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">受保护的</strong>—cart page:(<a class="ae mg" href="http://localhost:3000/auth/signup" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/</a>cart)</p><p id="eeb1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">无保护</strong> —注册页面:(<a class="ae mg" href="http://localhost:3000/auth/signup" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/auth/sign up</a>)</p><h1 id="a484" class="mh kv in bd kw mi mj mk kz ml mm mn lc mo mp mq lf mr ms mt li mu mv mw ll mx bi translated">用户认证</h1><p id="1b4e" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">既然我们已经定义了<strong class="jm io"> routes </strong>和<strong class="jm io"> routGaurd </strong>，我们将继续更新<strong class="jm io">注册页面</strong>以验证用户，从而能够访问受保护的页面。</p><p id="40ea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">更新<strong class="jm io">。/src/pages/auth/sign up page . tsx</strong>文件，内容如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="c221" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的代码片段中，我们使用了<strong class="jm io">signingwithssocialmedia</strong>模块，并通过一个社交登录提供者来验证用户。</p><p id="4399" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这就是你的<strong class="jm io">注册页面</strong>应该看起来的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/9fd259f37b13ed619208d6e9efbc7e65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1UBR6t3qh2IuBg_oxGcdZA.png"/></div></div></figure><p id="8597" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在使用google注册时，当禁用注册按钮时，会出现一个弹出窗口，等待用户的凭证。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/52260eb4f47d7ca2aa92eb9e5efc120a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XJt4c_neuKR4nJhzLUw02w.png"/></div></div></figure><p id="90a9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一旦用户通过身份验证，他们将能够访问受保护的页面。</p><h1 id="47a2" class="mh kv in bd kw mi mj mk kz ml mm mn lc mo mp mq lf mr ms mt li mu mv mw ll mx bi translated"><strong class="ak">访问用户对象。</strong></h1><p id="0a1f" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">要访问任何经过身份验证的页面上的用户对象，请使用下面的代码片段:</p><pre class="kj kk kl km gt nc nb nd ne aw nf bi"><span id="a45d" class="ku kv in nb b gy ng nh l ni nj">import { auth } from '../config/firebase';<br/>console.log(auth.currentUser)</span></pre><p id="f784" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们首先导入<strong class="jm io"> auth </strong>模块，在react组件中，我们可以访问用户对象作为<strong class="jm io"> auth.currentUser </strong></p><h1 id="324e" class="mh kv in bd kw mi mj mk kz ml mm mn lc mo mp mq lf mr ms mt li mu mv mw ll mx bi translated"><strong class="ak">结论</strong></h1><p id="0d5d" class="pw-post-body-paragraph jk jl in jm b jn lp jp jq jr lq jt ju jv md jx jy jz me kb kc kd mf kf kg kh ig bi translated">希望你学到了新东西。请留下您的意见和建议。</p><p id="7a56" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该项目的源代码可以在以下位置找到:</p><div class="nu nv gp gr nw nx"><a href="https://github.com/GeoffMahugu/react-firebase.git" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd io gy z fp oc fr fs od fu fw im bi translated">GeoffMahugu/react-firebase</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">这是一个使用firebase作为后端的react应用程序</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">github.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol ks nx"/></div></div></a></div><p id="763c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="om">更多内容尽在</em><a class="ae mg" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="om">plain English . io</em></a></p></div></div>    
</body>
</html>