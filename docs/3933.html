<html>
<head>
<title>Persist Data Client-side with localStorage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用本地存储在客户端保存数据</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/persisting-data-client-side-with-localstorage-f72d96dba7b9?source=collection_archive---------18-----------------------#2021-08-06">https://javascript.plainenglish.io/persisting-data-client-side-with-localstorage-f72d96dba7b9?source=collection_archive---------18-----------------------#2021-08-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/1a8de465dc4f3aab87a4b166d675e5e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SGeazie5O9aebep0"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@joshstyle?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">JOSHUA COLEMAN</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="2685" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">什么是localStorage？</h1><p id="8229" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">你问什么是本地存储？嗯，localStorage只是一个Javascript对象。但这还不是全部。它是美国开发者用来在客户端本地存储数据的Web存储API的一部分。localStorage对象是用于在客户机(浏览器)上存储数据的两个对象之一。这些是<code class="fe lw lx ly lz b">localStorage</code>和<code class="fe lw lx ly lz b">sessionStorage</code>对象。</p><p id="0be0" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">这两种类型的存储对象之间的主要区别在于，localStorage用于在浏览器打开时存储数据，也用于在浏览器未打开时存储数据，这意味着在浏览器关闭后数据会被持久化。使用sessionStorage，您的数据存储仅在浏览器仍然打开时可用。</p><p id="0ce4" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">那么为什么要使用localStorage或者sessionStorage呢？</p><p id="af6d" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">在HTML5出现之前，只有cookies被用来存储数据。Cookies在每次请求时都发送到服务器，它们提供的存储空间(大约4kb)和安全性都比localStorage和sessionStorage低。使用localStorage，存储数据最多有5MB的空间，并且没有到期日期。</p><h1 id="9354" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">何时使用localStorage</h1><p id="4ab2" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">每当您希望客户端数据持久化，这样它就不会像会话一样在页面重新加载时消失，那么localStorage就是一个很好的选择。例如，如果您正在构建一个chrome扩展，您可能希望您的扩展能够存储数据并在页面刷新时可用。</p><h1 id="7725" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">如何使用本地存储</h1><p id="a88d" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">要使用localStorage，我们必须首先通过全局<code class="fe lw lx ly lz b">window</code>对象访问它。当我们从<code class="fe lw lx ly lz b">window</code>对象调用localStorage时，我们得到的是<code class="fe lw lx ly lz b">Storage</code>对象的一个实例，它允许我们设置、获取和删除会话和本地存储类型的数据项。</p><pre class="mf mg mh mi gt mj lz mk ml aw mm bi"><span id="a057" class="mn kb in lz b gy mo mp l mq mr">&gt; window.localStorage<br/>► Storage {length: 0}</span></pre><p id="c962" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">为了简单起见，我们在这里只使用一个变量来引用我们的<code class="fe lw lx ly lz b">window.localStorage</code>。</p><pre class="mf mg mh mi gt mj lz mk ml aw mm bi"><span id="e23d" class="mn kb in lz b gy mo mp l mq mr">const myLocalStorage = window.localStorage</span></pre><p id="f9f2" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">要开始使用我们的localStorage，让我们快速浏览一下它可用的五种不同方法。</p><ul class=""><li id="a209" class="ms mt in la b lb ma lf mb lj mu ln mv lr mw lv mx my mz na bi translated"><code class="fe lw lx ly lz b">setItem()</code>设置要存储为本地存储字符串的键/值对</li><li id="ad38" class="ms mt in la b lb nb lf nc lj nd ln ne lr nf lv mx my mz na bi translated"><code class="fe lw lx ly lz b">getItem()</code>通过引用键从localStorage获取数据项</li><li id="7d1c" class="ms mt in la b lb nb lf nc lj nd ln ne lr nf lv mx my mz na bi translated"><code class="fe lw lx ly lz b">removeItem()</code>通过键从本地存储中删除特定数据项</li><li id="d3e4" class="ms mt in la b lb nb lf nc lj nd ln ne lr nf lv mx my mz na bi translated">完全清除本地存储</li><li id="9c29" class="ms mt in la b lb nb lf nc lj nd ln ne lr nf lv mx my mz na bi translated"><code class="fe lw lx ly lz b">key()</code>接受一个索引号来获取本地存储中的一个键的名称</li></ul><p id="e4ae" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">让我们使用<code class="fe lw lx ly lz b">myLocalStorage</code>来看看这些方法中的一些。</p><pre class="mf mg mh mi gt mj lz mk ml aw mm bi"><span id="63b2" class="mn kb in lz b gy mo mp l mq mr">// set up localStorage key and value<br/>myLocalStorage.setItem("Name", "Tim Berners-Lee");</span><span id="b19c" class="mn kb in lz b gy ng mp l mq mr">// retrieve the Name value<br/>myLocalStorage.getItem("Name"); // Tim Berners-Lee</span><span id="f3ff" class="mn kb in lz b gy ng mp l mq mr">// access the Name key<br/>myLocalStorage.key(0) // Name</span></pre><p id="f34b" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">现在我们的localStorage如下所示:</p><pre class="mf mg mh mi gt mj lz mk ml aw mm bi"><span id="5dbe" class="mn kb in lz b gy mo mp l mq mr">► Storage {Name: "Tim Berners-Lee", length: 1}</span></pre><p id="7625" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">然后，如果我们想从本地存储中删除数据，我们可以使用<code class="fe lw lx ly lz b">removeItem()</code>方法删除特定的数据项或<code class="fe lw lx ly lz b">clear()</code>，这将完全清空存储。在这种情况下，两者的作用是一样的，因为我们只需要删除一个键/值对。</p><pre class="mf mg mh mi gt mj lz mk ml aw mm bi"><span id="39b7" class="mn kb in lz b gy mo mp l mq mr">myLocalStorage.removeItem("Name")<br/>// Or<br/>myLocalStorage.clear()</span></pre><p id="f4da" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">这将从<code class="fe lw lx ly lz b">myLocalStorage</code>中删除我们的键/值对:</p><pre class="mf mg mh mi gt mj lz mk ml aw mm bi"><span id="1815" class="mn kb in lz b gy mo mp l mq mr">► Storage {length: 0}</span></pre><p id="b75f" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">如果我们想在<code class="fe lw lx ly lz b">myLocalStorage</code>中存储其他数据类型，而不仅仅是硬编码字符串作为值，会怎么样？这就是<code class="fe lw lx ly lz b"><a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify" rel="noopener ugc nofollow" target="_blank">JSON.stringify()</a></code>和<code class="fe lw lx ly lz b"><a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse" rel="noopener ugc nofollow" target="_blank">JSON.parse()</a></code>的用武之地。让我们将之前的数据项存储为添加了另一个属性的对象，然后将该对象转换为JSON字符串并将其传递给<code class="fe lw lx ly lz b">setItem()</code>:</p><pre class="mf mg mh mi gt mj lz mk ml aw mm bi"><span id="ca53" class="mn kb in lz b gy mo mp l mq mr">const inventorOfTheWeb = {<br/>    name: "Tim Berners-Lee",<br/>    organization: "W3C"<br/>}</span><span id="9d2f" class="mn kb in lz b gy ng mp l mq mr">localStorage.setItem("person", JSON.stringify(inventorOfTheWeb))</span></pre><p id="9fd6" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">现在，我们的存储将如下所示:</p><pre class="mf mg mh mi gt mj lz mk ml aw mm bi"><span id="3808" class="mn kb in lz b gy mo mp l mq mr">► Storage {person: <br/>"{'name':'Tim Berners-Lee','organization':'W3C'}", length: 1}</span></pre><p id="9282" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">如果我们需要从存储中检索我们的<code class="fe lw lx ly lz b">person</code>，我们可以使用<code class="fe lw lx ly lz b">JSON.parse()</code>解析它，将它构造回一个对象:</p><pre class="mf mg mh mi gt mj lz mk ml aw mm bi"><span id="7673" class="mn kb in lz b gy mo mp l mq mr">let storedPerson = JSON.parse(localStorage.getItem("person"))</span></pre><h1 id="840b" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="1add" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在本文中，我们回顾了使用localStorage在web上存储数据的基础知识。我们还简要提到了会话存储和cookies的其他数据存储方式。</p><p id="ebda" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">其中每一种都有自己的用例，所以在为应用程序选择实现哪一种时，将取决于您的具体情况。</p><p id="5919" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated">如果您需要在客户端存储没有截止日期的数据，并且需要更大的存储容量，那么本地存储可能是一个不错的选择！</p><p id="ee92" class="pw-post-body-paragraph ky kz in la b lb ma ld le lf mb lh li lj mc ll lm ln md lp lq lr me lt lu lv ig bi translated"><em class="nh">更多内容请看</em><a class="ae jz" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="la io"><em class="nh">plain English . io</em></strong></a></p></div></div>    
</body>
</html>