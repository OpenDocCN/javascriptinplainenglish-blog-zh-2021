<html>
<head>
<title>Using forwardRef with React hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用带有反作用钩子的forwardRef</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/using-forwardref-with-react-hooks-9d0d096ad810?source=collection_archive---------1-----------------------#2021-01-05">https://javascript.plainenglish.io/using-forwardref-with-react-hooks-9d0d096ad810?source=collection_archive---------1-----------------------#2021-01-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/7fa50771b98deff47736196e386aaac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SFIOt5R0EL8SwUZO3Lo3PQ.png"/></div></div></figure><p id="ed49" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">forwardRef钩子允许React用户将Ref传递给子组件。引用可以通过<code class="fe kt ku kv kw b">useRef</code>或<code class="fe kt ku kv kw b">createRef</code>创建和引用，然后传入父组件。当需要在父组件中访问引用时，使用forwardRef而不是useRef很有用。</p><h1 id="9cb3" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">使用forwardRef</h1><p id="7e10" class="pw-post-body-paragraph jv jw in jx b jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko lz kq kr ks ig bi translated">参考文献<strong class="jx io">不能作为道具</strong>传递给功能组件。</p><p id="8fa4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这将失败:</p><pre class="ma mb mc md gt me kw mf mg aw mh bi"><span id="2958" class="mi ky in kw b gy mj mk l ml mm">import React, {useRef} from 'react';</span><span id="1ffa" class="mi ky in kw b gy mn mk l ml mm"><strong class="kw io">//DON'T DO THIS</strong><br/>export function ParentComponent() {<br/>    const nodeRef = useRef(null);</span><span id="2c30" class="mi ky in kw b gy mn mk l ml mm">return (<br/>       &lt;ChildComponent ref={nodeRef}<br/>       )</span><span id="3d45" class="mi ky in kw b gy mn mk l ml mm">}</span><span id="676f" class="mi ky in kw b gy mn mk l ml mm">export function ChildComponent(props) {<br/>return (<br/>     &lt;div ref={props.nodeRef}&gt;<br/>         &lt;p&gt;Don't pass refs like this&lt;/p&gt;<br/>     &lt;/div&gt;<br/>    )<br/>}</span></pre><p id="7109" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这会<strong class="jx io">起作用</strong>:</p><pre class="ma mb mc md gt me kw mf mg aw mh bi"><span id="4525" class="mi ky in kw b gy mj mk l ml mm">import React, {useRef, forwardRef} from 'react';</span><span id="35d9" class="mi ky in kw b gy mn mk l ml mm"><strong class="kw io">//DO THIS</strong><br/>export function ParentComponent() {<br/>    const nodeRef = useRef(null);</span><span id="9c49" class="mi ky in kw b gy mn mk l ml mm">    return (<br/>       &lt;ChildComponent ref={nodeRef}<br/>       )</span><span id="2a91" class="mi ky in kw b gy mn mk l ml mm">};</span><span id="2096" class="mi ky in kw b gy mn mk l ml mm">export function ChildComponent forwardRef((props, ref) {<br/>    return (<br/>        &lt;div ref={ref}&gt;<br/>           &lt;p&gt;Pass refs like this&lt;/p&gt;<br/>        &lt;/div&gt;<br/>    )<br/>});</span></pre><p id="5366" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="mo">请注意，子组件用括号括起来，并且ref与props分开使用forwardRef。</em></p><h1 id="d80c" class="kx ky in bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">forwardRef代码示例</h1><p id="4691" class="pw-post-body-paragraph jv jw in jx b jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko lz kq kr ks ig bi translated">在这个例子中，我们将在父组件中创建一个引用，这样我们就可以使用它来设置状态，并将该引用转发给子组件。这是forwardRef的一个常见用例。</p><p id="35ab" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是一个简单的代码，一个父页面，它有一个打开模态的按钮和两个功能:<code class="fe kt ku kv kw b">toggleModal</code>，用于使用按钮打开和关闭模态，和<code class="fe kt ku kv kw b">handleOutsideClick</code>，所以模态可以通过点击它外面来关闭。</p><h2 id="7279" class="mi ky in bd kz mp mq dn ld mr ms dp lh kg mt mu ll kk mv mw lp ko mx my lt mz bi translated"><strong class="ak"> &gt;母构件</strong></h2><pre class="ma mb mc md gt me kw mf mg aw mh bi"><span id="3454" class="mi ky in kw b gy mj mk l ml mm">import React, { useRef, useState } from 'react;<br/>import ChildModal from './Child';</span><span id="a86f" class="mi ky in kw b gy mn mk l ml mm">export function Parent() {<br/>     const [modal, setModal] = useState(false);</span><span id="dd3a" class="mi ky in kw b gy mn mk l ml mm">     const modalRef = useRef(null);</span><span id="96be" class="mi ky in kw b gy mn mk l ml mm">     const toggleModal = () =&gt; {<br/>        setModal(!modal);<br/>     }</span><span id="272b" class="mi ky in kw b gy mn mk l ml mm">     const handleOutsideClick = (e) =&gt; {<br/>      if(modalRef.current &amp;&amp; !modalRef.current.contains(e.target)) {<br/>        setModal(false);<br/>       }<br/>    }</span><span id="cf5c" class="mi ky in kw b gy mn mk l ml mm">    return (<br/>       &lt;div className="page" onClick={() =&gt; handleOutsideClick()}&gt;<br/>            &lt;h3&gt;Page title&lt;/h3&gt; <br/>            &lt;p&gt;Generic page with a button to open a modal&lt;/p&gt;<br/>            &lt;button type="button" onClick={() =&gt; toggleModal()}&gt;<br/>              Open modal<br/>            &lt;button/&gt;<br/>           {modal &amp;&amp;<br/>             &lt;ChildModal ref={modalRef} toggleModal={toggleModal}/&gt;<br/>            }       <br/>       &lt;/div&gt;<br/>     )<br/>} </span></pre><h2 id="cad8" class="mi ky in bd kz mp mq dn ld mr ms dp lh kg mt mu ll kk mv mw lp ko mx my lt mz bi translated">子组件</h2><pre class="ma mb mc md gt me kw mf mg aw mh bi"><span id="8776" class="mi ky in kw b gy mj mk l ml mm">import React, { forwardRef } from 'react;</span><span id="776d" class="mi ky in kw b gy mn mk l ml mm">export function ChildModal forwardRef((props, ref) {<br/>    return (<br/>        &lt;div className="modal" ref={ref}&gt;<br/>           &lt;p&gt;This is an info modal&lt;/p&gt;<br/>           &lt;button type="button" onClick={() =&gt; toggleModal()}&gt;<br/>              Close modal<br/>            &lt;button/&gt;<br/>       &lt;/div&gt;<br/>    )<br/>});</span></pre><p id="747f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是<code class="fe kt ku kv kw b">forwardRef</code>的语法，有一个例子。更多资源可在此处找到:</p><ul class=""><li id="d305" class="na nb in jx b jy jz kc kd kg nc kk nd ko ne ks nf ng nh ni bi translated">向前反应参考<a class="ae nj" href="https://reactjs.org/docs/forwarding-refs.html" rel="noopener ugc nofollow" target="_blank">文档</a>和<a class="ae nj" href="https://reactjs.org/docs/hooks-reference.html" rel="noopener ugc nofollow" target="_blank"> API参考</a>。</li><li id="81a6" class="na nb in jx b jy nk kc nl kg nm kk nn ko no ks nf ng nh ni bi translated"><a class="ae nj" href="https://blog.bitsrc.io/understanding-ref-forwarding-in-react-80accd93ed74" rel="noopener ugc nofollow" target="_blank">了解反应中的转发参考文献</a>。</li><li id="df9d" class="na nb in jx b jy nk kc nl kg nm kk nn ko no ks nf ng nh ni bi translated">视频:本·阿瓦德的<a class="ae nj" href="https://www.youtube.com/watch?v=p7OCG_osB0E" rel="noopener ugc nofollow" target="_blank"> forwardRef教程</a>和<a class="ae nj" href="https://www.youtube.com/watch?v=W6AJ-gRupCs" rel="noopener ugc nofollow" target="_blank"> useRef教程</a>。</li></ul></div></div>    
</body>
</html>