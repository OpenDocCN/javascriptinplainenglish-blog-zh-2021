<html>
<head>
<title>Simplify Backend Development with Prisma</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Prisma简化后端开发</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/simplifying-backend-development-with-prisma-564200f31943?source=collection_archive---------7-----------------------#2021-06-26">https://javascript.plainenglish.io/simplifying-backend-development-with-prisma-564200f31943?source=collection_archive---------7-----------------------#2021-06-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/8c7e59fc24702e0137d8f8ec9caefa60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yv-YXzGZ3AzR3re7fe9KgA.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@pepegombos?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Peter Gombos</a> on <a class="ae jz" href="https://unsplash.com/@pepegombos?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8c16" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您是在Node.js生态系统中工作的后端或全栈开发人员，您可能使用过不同的数据库访问工具。</p><p id="ce9e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您正在使用MySQL之类的SQL数据库，您可能会熟悉<a class="ae jz" href="https://en.wikipedia.org/wiki/Object%E2%80%93relational_mapping" rel="noopener ugc nofollow" target="_blank"> <em class="ky"> ORM </em>(对象关系映射器)</a>库，如<a class="ae jz" href="https://sequelize.org/" rel="noopener ugc nofollow" target="_blank"> Sequelize </a>、<a class="ae jz" href="https://typeorm.io/" rel="noopener ugc nofollow" target="_blank"> Typeorm </a>、<em class="ky">查询构建器</em>如<a class="ae jz" href="http://knexjs.org/" rel="noopener ugc nofollow" target="_blank"> Knex </a>或本地数据库驱动程序如<a class="ae jz" href="https://github.com/mysqljs/mysql" rel="noopener ugc nofollow" target="_blank"> mysql </a>，它们将有助于<em class="ky">编写原始SQL查询</em>。</p><p id="ad6b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这些工具或方法各有利弊。</p><p id="d322" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我发现在这些工具中,<a class="ae jz" href="https://www.prisma.io/?utm_source=Prisma%20Ambassador&amp;utm_medium=Blog%20post&amp;utm_campaign=Prisma%20AP%20Pasindu%20Dilshan" rel="noopener ugc nofollow" target="_blank"> Prisma </a>对开发者更友好。</p><p id="0a1e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这篇文章中，我将向初学者介绍Prisma，并让您了解我们如何开发灵活且可伸缩的后端。</p></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><h1 id="810b" class="lg lh in bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">Prisma是什么？</h1><blockquote class="me mf mg"><p id="a97e" class="ka kb ky kc b kd ke kf kg kh ki kj kk mh km kn ko mi kq kr ks mj ku kv kw kx ig bi translated"><strong class="kc io"> Prisma是开源的下一代ORM，可以让你轻松管理&amp;与数据库的交互。</strong></p></blockquote><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/b3d6f036a51983409b020b77e7e1abe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h7H7_ifastIBuFUny8PnZA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Visit <a class="ae jz" href="https://www.prisma.io/?utm_source=Prisma%20Ambassador&amp;utm_medium=Blog%20post&amp;utm_campaign=Prisma%20AP%20Pasindu%20Dilshan" rel="noopener ugc nofollow" target="_blank">Prisma.io</a></figcaption></figure><p id="73c0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当前的Prisma版本由3个主要部分组成</p><ol class=""><li id="85c3" class="mp mq in kc b kd ke kh ki kl mr kp ms kt mt kx mu mv mw mx bi translated">Prisma Migrate:一个必要的数据库模式迁移工具。</li><li id="54e5" class="mp mq in kc b kd my kh mz kl na kp nb kt nc kx mu mv mw mx bi translated">Prisma Client:一个自动生成的类型安全的查询生成器。</li><li id="2eb0" class="mp mq in kc b kd my kh mz kl na kp nb kt nc kx mu mv mw mx bi translated">Prisma Studio:数据库数据的可视化编辑器。</li></ol><p id="5015" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">没有进一步的解释，让我们开始构建一些东西，这样Prisma背后的想法将更加明显。</p><h1 id="cb77" class="lg lh in bd li lj nd ll lm ln ne lp lq lr nf lt lu lv ng lx ly lz nh mb mc md bi translated">让我们开始吧</h1><p id="0624" class="pw-post-body-paragraph ka kb in kc b kd ni kf kg kh nj kj kk kl nk kn ko kp nl kr ks kt nm kv kw kx ig bi translated">我们将考虑一个非常基本的博客文章场景，其中用户创建了一篇博客文章。</p><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nn"><img src="../Images/a17a2255fedaede9f79c1d36e10fc812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uPrKJZgdgmjmbimimyvZ5A.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Entity Relationship Diagram (ERD)</figcaption></figure><ul class=""><li id="5acf" class="mp mq in kc b kd ke kh ki kl mr kp ms kt mt kx no mv mw mx bi translated">为了简单起见，只有两个实体:用户和帖子。</li><li id="cb53" class="mp mq in kc b kd my kh mz kl na kp nb kt nc kx no mv mw mx bi translated">所有数据都将存储在MySQL数据库中。</li><li id="126b" class="mp mq in kc b kd my kh mz kl na kp nb kt nc kx no mv mw mx bi translated">为了简单起见，也放弃了诸如认证之类的特性。</li></ul><p id="dd46" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最后将构建一个用于数据库查询的最小类型脚本。</p><p id="5b31" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你需要在你的开发环境中设置MySQL的指南，请查看Prisma的数据指南。</p><div class="np nq gp gr nr ns"><a href="https://www.prisma.io/dataguide/mysql/5-ways-to-host-mysql" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd io gy z fp nx fr fs ny fu fw im bi translated">托管MySQL数据库的5种方法| Prisma的数据指南</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">有很多方法可以让MySQL服务器为您的项目运行。您可以安装和管理一个…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">www.prisma.io</p></div></div><div class="ob l"><div class="oc l od oe of ob og jt ns"/></div></div></a></div><p id="5699" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您在这里找到的所有代码都可以在下面的库中找到。对于本文中涉及的每个主题，它都分为不同的分支。</p><div class="np nq gp gr nr ns"><a href="https://github.com/Pasi-D/Prisma-Starter" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd io gy z fp nx fr fs ny fu fw im bi translated">PASI-D/Prisma-启动器</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">一个简单的项目旨在展示使用Prisma ◭先决条件的简单性，如果你没有安装节点…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">github.com</p></div></div><div class="ob l"><div class="oh l od oe of ob og jt ns"/></div></div></a></div><p id="f9c2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们将从一个简单的Typescript脚本开始&amp;首先安装Prisma。你可以在<a class="ae jz" href="https://github.com/Pasi-D/Prisma-Starter/tree/0-Initial-Script" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="ky">0-Initial-Script</em></strong></a>分支中找到起始代码。</p><h1 id="3d5d" class="lg lh in bd li lj nd ll lm ln ne lp lq lr nf lt lu lv ng lx ly lz nh mb mc md bi translated">1.设置Prisma</h1><p id="e83f" class="pw-post-body-paragraph ka kb in kc b kd ni kf kg kh nj kj kk kl nk kn ko kp nl kr ks kt nm kv kw kx ig bi translated">首先，我们需要安装Prisma作为开发依赖项，这样我们就可以在项目中使用Prisma CLI命令。</p><pre class="ml mm mn mo gt oi oj ok ol aw om bi"><span id="a4df" class="on lh in oj b gy oo op l oq or">$ npm install prisma --save-dev</span></pre><p id="e6e8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您现在可以在目录中调用Prisma CLI，方法是在它前面加上<a class="ae jz" href="https://docs.npmjs.com/cli/v7/commands/npx" rel="noopener ugc nofollow" target="_blank"> <em class="ky"> npx </em> </a>。让我们用下面的命令初始化Prisma模式文件。</p><pre class="ml mm mn mo gt oi oj ok ol aw om bi"><span id="c528" class="on lh in oj b gy oo op l oq or">$ npx prisma init</span></pre><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div class="gh gi os"><img src="../Images/04da5e89f96b0d43eaae5ca5829cbb80.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*xIv4gyYw2-TrE1E7T-qwsQ.png"/></div></figure><p id="6e32" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这将创建一个带有<strong class="kc io"><em class="ky">schema . Prisma</em></strong>文件和<em class="ky">的Prisma目录。env </em>文件。</p><p id="fbdf" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你可以移动这个<em class="ky">。env </em>文件到根目录，即与<em class="ky"> package.json </em>相同的级别。</p><h2 id="1d3a" class="on lh in bd li ot ou dn lm ov ow dp lq kl ox oy lu kp oz pa ly kt pb pc mc pd bi translated">等等，什么是Prisma模式？</h2><blockquote class="me mf mg"><p id="e013" class="ka kb ky kc b kd ke kf kg kh ki kj kk mh km kn ko mi kq kr ks mj ku kv kw kx ig bi translated">risma模式是Prisma设置中的主要配置文件。它是数据库模式和应用程序模型的真实来源。</p></blockquote><p id="ece7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您可以使用Prisma模式，</p><ul class=""><li id="aab7" class="mp mq in kc b kd ke kh ki kl mr kp ms kt mt kx no mv mw mx bi translated">生成正确的数据源客户端代码(Prisma客户端)。这充当了数据的查询构建器。</li><li id="efa6" class="mp mq in kc b kd my kh mz kl na kp nb kt nc kx no mv mw mx bi translated">生成迁移以更新数据库模式。</li></ul><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pf"><img src="../Images/5522b04d4316e7cc66971ff687e32ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CzqDRuQbyvo9jGOppQSzLA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">How our Prisma.schema will look like in the end</figcaption></figure><p id="69a9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Prisma模式由以下部分组成</p><ol class=""><li id="0b46" class="mp mq in kc b kd ke kh ki kl mr kp ms kt mt kx mu mv mw mx bi translated">数据源:定义与数据源的连接。</li><li id="5052" class="mp mq in kc b kd my kh mz kl na kp nb kt nc kx mu mv mw mx bi translated">生成器:根据数据模型定义客户端需要生成的内容。</li><li id="6ae9" class="mp mq in kc b kd my kh mz kl na kp nb kt nc kx mu mv mw mx bi translated">数据模型定义:您的应用模型</li></ol><p id="4192" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky">生成的默认模式使用PostgreSQL作为</em> <strong class="kc io"> <em class="ky">提供者</em> </strong> <em class="ky">。所以，要做的第一件事是切换到“mysql”。</em></p><pre class="ml mm mn mo gt oi oj ok ol aw om bi"><span id="4ccd" class="on lh in oj b gy oo op l oq or">datasource db {<br/>  provider = "mysql"<br/>  url      = env("DATABASE_URL")<br/>}</span></pre><p id="0485" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了连接到我们的数据库，<strong class="kc io"> <em class="ky"> url </em> </strong>字段需要更改。你可以<a class="ae jz" href="https://www.prisma.io/docs/concepts/more/environment-variables" rel="noopener ugc nofollow" target="_blank">将其设置为一个环境变量</a>，而不是硬编码。</p><p id="ed48" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这需要以下面的通用格式来指定。</p><pre class="ml mm mn mo gt oi oj ok ol aw om bi"><span id="b2df" class="on lh in oj b gy oo op l oq or">DATABASE_URL=mysql://USER:PASSWORD@HOST:PORT/DATABASE</span></pre><h1 id="9396" class="lg lh in bd li lj nd ll lm ln ne lp lq lr nf lt lu lv ng lx ly lz nh mb mc md bi translated">2.使用迁移创建数据库模式</h1><blockquote class="me mf mg"><p id="7f92" class="ka kb ky kc b kd ke kf kg kh ki kj kk mh km kn ko mi kq kr ks mj ku kv kw kx ig bi translated"><strong class="kc io">使用</strong><a class="ae jz" href="https://www.prisma.io/docs/concepts/components/prisma-migrate/" rel="noopener ugc nofollow" target="_blank"><strong class="kc io">Prisma Migrate</strong></a><strong class="kc io">您可以使您的Prisma模式与您的数据库模式保持同步。它还可以帮助您维护数据库中的现有数据。</strong></p></blockquote><p id="08c6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们开始改变Prisma模式以适应我们的场景。我们可以开始编写我们的数据模型。</p><pre class="ml mm mn mo gt oi oj ok ol aw om bi"><span id="c31e" class="on lh in oj b gy oo op l oq or">model User {<br/>  id        Int     @id @default(autoincrement()) <br/>  username  String  @unique <br/>  email     String  @unique <br/>  posts     Post[] <br/>}</span><span id="b0f4" class="on lh in oj b gy pg op l oq or">model Post { <br/>  id        Int     @id @default(autoincrement()) <br/>  title     String <br/>  content   String? <br/>  authorId  Int <br/>  author    User?   @relation(fields: [authorId], references: [id]) <br/>}</span></pre><p id="a358" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果这个模型看起来有点乏味&amp;很难理解它将如何映射到我们的数据库模式，下面的可视化表示将会帮助你。</p><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ph"><img src="../Images/62988b56ae7be0af6a0193e1702692e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FwXtbO8b5qthfWmDM-2OTw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Mapping between Prisma Schema &amp; Database Entities(Tables)</figcaption></figure><p id="7217" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们的Prisma模式有几个属性来表示表字段应该是什么样子。</p><ul class=""><li id="1b1e" class="mp mq in kc b kd ke kh ki kl mr kp ms kt mt kx no mv mw mx bi translated">@id —主键</li><li id="8ad3" class="mp mq in kc b kd my kh mz kl na kp nb kt nc kx no mv mw mx bi translated">@unique —唯一键</li><li id="ec54" class="mp mq in kc b kd my kh mz kl na kp nb kt nc kx no mv mw mx bi translated">@default —默认值</li><li id="b5d8" class="mp mq in kc b kd my kh mz kl na kp nb kt nc kx no mv mw mx bi translated">@relation —两个表之间的关系</li></ul><p id="7ebe" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您可以在Prisma模式参考的<a class="ae jz" href="https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference/#attributes" rel="noopener ugc nofollow" target="_blank">属性部分找到更多详细信息。</a></p><p id="59fc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了产生迁移，</p><pre class="ml mm mn mo gt oi oj ok ol aw om bi"><span id="6bcd" class="on lh in oj b gy oo op l oq or">$ npx prisma migrate dev --name init</span></pre><p id="ffbe" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这份遗嘱，</p><ol class=""><li id="6ea6" class="mp mq in kc b kd ke kh ki kl mr kp ms kt mt kx mu mv mw mx bi translated">为此迁移生成SQL迁移文件。</li><li id="6eeb" class="mp mq in kc b kd my kh mz kl na kp nb kt nc kx mu mv mw mx bi translated">对数据库运行生成的迁移文件。</li><li id="c27a" class="mp mq in kc b kd my kh mz kl na kp nb kt nc kx mu mv mw mx bi translated">生成Prisma客户端，如果不可用，在<em class="ky"> package.json </em>依赖列表中更新。</li></ol><p id="9f7a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您需要对数据库模式进行更改，您只需对Prisma模式进行相应的更改，然后运行Prisma migration命令。</p><p id="3d81" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你使用过<a class="ae jz" href="https://typeorm.io/" rel="noopener ugc nofollow" target="_blank"> TypeORM </a>，这个过程可能会很熟悉。TypeORM还可以根据您所做的模式更改自动生成迁移文件。不同之处在于，在TypeORM中，你需要管理单独的模型文件，这些文件与迁移文件相映射。使用Prisma，您只需修改Prisma模式文件中的模型。</p><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pi"><img src="../Images/418040c77e2316efcb0772de600930aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Wm9ZauRcCMTORlXZcomGAg.gif"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Comparison between Prisma &amp; Other ORMs in terms of Migration</figcaption></figure><p id="9362" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们将在以后的文章中更深入地探讨使用Prisma进行数据库迁移。</p><p id="6cc7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Prisma还有几个改变游戏规则的人🚀</p><h1 id="dd2c" class="lg lh in bd li lj nd ll lm ln ne lp lq lr nf lt lu lv ng lx ly lz nh mb mc md bi translated">3.数据库自省</h1><blockquote class="me mf mg"><p id="1ef6" class="ka kb ky kc b kd ke kf kg kh ki kj kk mh km kn ko mi kq kr ks mj ku kv kw kx ig bi translated"><strong class="kc io"> Prisma能够为现有的数据库模式生成Prisma模式的数据模型。这是用</strong> <a class="ae jz" href="https://www.prisma.io/docs/concepts/components/introspection" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io">自省</strong> </a> <strong class="kc io">完成的。</strong></p></blockquote><p id="4df3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">假设您不想使用Prisma迁移&amp;您正在使用普通SQL或任何其他迁移工具进行迁移。使用Prisma，您可以重新检查您的数据库并重新生成Prisma模式，然后在您的Prisma客户端中反映这些变化(我们将在前面看到)。</p><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pj"><img src="../Images/25aa84f15879d7778ce6e17e5f735572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8XAp2fpbwZ9LcNbeXm9tFw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk"><a class="ae jz" href="https://www.prisma.io/docs/concepts/overview/what-is-prisma#sql-migrations-and-introspection" rel="noopener ugc nofollow" target="_blank">If for some reasons, you can not or do not want to use Prisma Migrate, you can still use introspection to update your Prisma schema from your database schema.</a></figcaption></figure><blockquote class="pk"><p id="d83a" class="pl pm in bd pn po pp pq pr ps pt kx dk translated">通过这种方式，你可以逐步将Prisma应用到现有的应用程序中，而无需做出巨大的妥协。</p></blockquote><h1 id="de8a" class="lg lh in bd li lj nd ll lm ln ne lp lq lr pu lt lu lv pv lx ly lz pw mb mc md bi translated">4.Prisma客户端</h1><blockquote class="me mf mg"><p id="2601" class="ka kb ky kc b kd ke kf kg kh ki kj kk mh km kn ko mi kq kr ks mj ku kv kw kx ig bi translated"><a class="ae jz" href="https://www.prisma.io/docs/concepts/components/prisma-client" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> Prisma客户端</strong> </a> <strong class="kc io">在编写您的应用程序逻辑中起着关键作用。这是一个自动生成的类型安全查询生成器。</strong></p></blockquote><p id="02fe" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果Prisma client不在你的package.json依赖列表中，最好安装<em class="ky"> @prisma/client </em>包作为依赖。</p><pre class="ml mm mn mo gt oi oj ok ol aw om bi"><span id="f47b" class="on lh in oj b gy oo op l oq or">npm install @prisma/client</span></pre><p id="0286" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">每当prisma模式被修改时，您需要调用<strong class="kc io"><em class="ky">Prisma generate</em></strong>来反映您的Prisma客户端中的那些变化。</p><p id="4fef" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们在<strong class="kc io"> <em class="ky"> app.ts </em> </strong>中进行数据查询的修改。</p><p id="106b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky">(附言:在你的控制台</em> <strong class="kc io"> <em class="ky"> npm运行</em> </strong> <em class="ky">将运行脚本)</em></p><p id="bdab" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，您需要导入生成的Prisma客户端并创建一个Prisma对象。</p><pre class="ml mm mn mo gt oi oj ok ol aw om bi"><span id="6447" class="on lh in oj b gy oo op l oq or">import { PrismaClient } from "@prisma/client";</span><span id="2f75" class="on lh in oj b gy pg op l oq or">const prisma = new PrismaClient();</span></pre><p id="f217" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">创建用户记录</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="px py l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">If your IDE has <strong class="ak">IntelliSense, </strong>code completion will be there.</figcaption></figure><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi pz"><img src="../Images/6012839ee856ac82662ed86d4c3446f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Kp8W-BGMsvHvgrSYuiapng.gif"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">All types are auto-generated based on the shape of model(s).</figcaption></figure><p id="2f6d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要创建多个帖子</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="px py l"/></div></figure><p id="dc3c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">创建具有帖子的用户</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="px py l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Its really easy to interpret &amp; understand this query as you write the code.</figcaption></figure><p id="e84f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">查询所有用户。</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="px py l"/></div></figure><p id="e5e5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">通过电子邮件找到用户，但只需要用户名和文章标题。</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="px py l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">There is 100% type-safety in using Prisma client. This is awesome for developer experience 😀</figcaption></figure><blockquote class="pk"><p id="b9d7" class="pl pm in bd pn po pp pq pr ps pt kx dk translated">因为类型是基于我们在Prisma schema中定义的数据模型自动生成的，所以从编写应用程序逻辑到管理代码库的每个方面都变得容易得多。我们根本不需要编写任何样板代码。</p></blockquote><h1 id="2c81" class="lg lh in bd li lj nd ll lm ln ne lp lq lr pu lt lu lv pv lx ly lz pw mb mc md bi translated">5.种子数据</h1><p id="72da" class="pw-post-body-paragraph ka kb in kc b kd ni kf kg kh nj kj kk kl nk kn ko kp nl kr ks kt nm kv kw kx ig bi translated">在某些情况下，一旦我们创建了数据库模式，我们就需要用要处理的记录更新一些数据库表。要做到这一点，我们可以播种我们的数据库。<br/> Prisma具有集成的播种功能。</p><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi qa"><img src="../Images/f4016747df876bedc01f2c485cff1085.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KoUKP9twY3U38vwAv1ELkw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Prisma db seed is still in preview</figcaption></figure><p id="3913" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://github.com/prisma/prisma/releases/tag/2.25.0" rel="noopener ugc nofollow" target="_blank">目前</a>，这仍然是一个预览功能&amp;，不建议在生产环境中使用。</p><p id="fe92" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这将在即将发布的Prisma版本中完全可用。</p><p id="effa" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在要做的是，首先我们需要<a class="ae jz" href="https://www.npmjs.com/package/ts-node" rel="noopener ugc nofollow" target="_blank"><em class="ky">ts-node</em></a>&amp;<a class="ae jz" href="https://www.npmjs.com/package/@types/node" rel="noopener ugc nofollow" target="_blank">节点类型</a>作为dev依赖项。</p><pre class="ml mm mn mo gt oi oj ok ol aw om bi"><span id="f88d" class="on lh in oj b gy oo op l oq or">npm install ts-node @types/node --save-dev</span></pre><p id="2e49" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们需要如下修改package.json脚本。</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="px py l"/></div></figure><p id="89c6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">种子文件需要与Prisma架构文件位于同一位置。下面给出一个例子。</p><figure class="ml mm mn mo gt jo"><div class="bz fp l di"><div class="px py l"/></div></figure><p id="cb01" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了播种这些数据，</p><pre class="ml mm mn mo gt oi oj ok ol aw om bi"><span id="a9b4" class="on lh in oj b gy oo op l oq or">$ npx prisma db seed — preview-feature</span></pre><h1 id="b032" class="lg lh in bd li lj nd ll lm ln ne lp lq lr nf lt lu lv ng lx ly lz nh mb mc md bi translated">6.Prisma工作室</h1><figure class="ml mm mn mo gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi qb"><img src="../Images/918eda20950e6fdeda295365cd567160.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*urulXYiPyxCaHVjkGiGsgQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Data stored can be visualized with Prisma Studio</figcaption></figure><p id="de32" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Prisma studio是数据库中数据的可视化工作室。</p><p id="c0d4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你可以运行它，</p><pre class="ml mm mn mo gt oi oj ok ol aw om bi"><span id="97a9" class="on lh in oj b gy oo op l oq or">$ npx prisma studio</span></pre><p id="25e7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">通过这种方式，你可能不需要集成一个数据库管理工具，例如<a class="ae jz" href="https://www.phpmyadmin.net/" rel="noopener ugc nofollow" target="_blank"> phpMyAdmin </a>来可视化你的数据。</p></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><h1 id="7179" class="lg lh in bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">结论</h1><p id="41fa" class="pw-post-body-paragraph ka kb in kc b kd ni kf kg kh nj kj kk kl nk kn ko kp nl kr ks kt nm kv kw kx ig bi translated">Prisma有很多ORM的特性，这无疑让开发人员的生活变得更加轻松。</p><p id="b12d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">除了我们已经讨论过的，还有许多更强大的特性将会在未来加入。对MongoDB &amp; SQL Server的支持，模式可视化只是其中的一小部分。您可以在<a class="ae jz" href="https://www.notion.so/prismaio/Prisma-Roadmap-50766227b779464ab98899accb98295f" rel="noopener ugc nofollow" target="_blank"> Prisma Roadmap </a>查看未来计划。Prisma还拥有来自全球各地的蓬勃发展的开发人员社区。</p><p id="3d5a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">希望这篇文章能帮助你理解Prisma的基本流程&amp;为什么它是后端开发的一个如此强大的工具。如果您有任何问题或反馈，请在下面评论。</p><p id="53a9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">感谢阅读！</p><p id="458f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky">更多内容看</em><a class="ae jz" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="ky">plain English . io</em></strong></a></p></div></div>    
</body>
</html>