<html>
<head>
<title>How to Get Your User’s Current Location with the Geolocation API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用地理定位API获取用户的当前位置</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/geolocation-api-d62df2b374ca?source=collection_archive---------9-----------------------#2021-04-16">https://javascript.plainenglish.io/geolocation-api-d62df2b374ca?source=collection_archive---------9-----------------------#2021-04-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="f2ad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了给网站的访问者提供更好的用户体验，有时你需要知道他们的位置。</p><p id="c75a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本文中，我将向您展示如何确定用户的地理坐标(经度和纬度)。为此，我使用了地理定位API。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/eff9d40b9d554d902da0bd53ad69ef2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pryeCSoY3jcoAJs55JN6NA.jpeg"/></div></div></figure><blockquote class="ku kv kw"><p id="3176" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated">此功能仅在部分或所有受支持的浏览器中的安全上下文(HTTPS)中可用。</p></blockquote><h1 id="1062" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">安全性</h1><p id="c93b" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">地理定位API通过请求许可来报告位置信息来保护用户的隐私。因此，用户的操作系统会在第一次请求时弹出一个对话框，要求用户允许共享位置信息。用户可以接受或拒绝请求。</p><h1 id="4dd4" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">怎么用？</strong></h1><p id="564a" class="pw-post-body-paragraph jk jl in jm b jn lz jp jq jr ma jt ju jv mb jx jy jz mc kb kc kd md kf kg kh ig bi translated">从一个简单的HTML div容器开始，显示坐标的结果。以及一个带有事件处理程序onclick的按钮，它触发一个函数来获取这些坐标。</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="6b2e" class="mj lc in mf b gy mk ml l mm mn">&lt;button onclick='getLocation()'&gt; Get my current location &lt;/button&gt;<br/>&lt;div id = "location"&gt;&lt;/div&gt;</span><span id="c610" class="mj lc in mf b gy mo ml l mm mn">&lt;script&gt;<br/>   let current_location = document.getElementById("location");<br/>&lt;/script&gt;</span></pre><p id="9b02" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们需要调用全局“navigator”对象。它返回一个地理位置对象，该对象提供对设备位置的访问。</p><blockquote class="ku kv kw"><p id="b540" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated">如果navigation.geolocation的类型== undefined，这意味着您的浏览器不支持此功能。</p></blockquote><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="edfc" class="mj lc in mf b gy mk ml l mm mn">if(navigator.geolocation){ //do something } <br/>else { //browser does not support this feature }</span></pre><p id="002e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了访问设备的当前位置，我们需要使用返回地理位置对象的<code class="fe mp mq mr mf b">getCurrentPosition method()</code>。它需要1个<strong class="jm io">必需的</strong>参数(成功)和一个可选的(错误)参数来处理提供用户位置数据的两种许可可能性:授权或拒绝。</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="513e" class="mj lc in mf b gy mk ml l mm mn">const getLocation = () =&gt; {<br/>  if(navigator.geolocation)<br/>    navigator.geolocation.getCurrentPosition(success, error);<br/>  else <br/>    current_location.textContent = `Your browser does not support this feature`;<br/>}</span></pre><p id="fd8c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">成功:</strong>一个回调函数。它接受一个参数<em class="kx"> GeolocationPosition </em>对象。</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="bd1a" class="mj lc in mf b gy mk ml l mm mn">const success = (position) =&gt; {<br/>  const longitude = position.coords.longitude;<br/>  const latitude = position.coords.latitude;<br/>  <br/>  current_location.textContent = `Longitude = ${longitude} \n latitude = ${latitude}`;<br/>}</span></pre><p id="92e6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">错误:一个</strong>回调函数。它采用一个参数<em class="kx">GeolocationPositionError</em>对象，该对象表示使用地理定位设备时出错的原因。</p><blockquote class="ku kv kw"><p id="e570" class="jk jl kx jm b jn jo jp jq jr js jt ju ky jw jx jy kz ka kb kc la ke kf kg kh ig bi translated">geolocationpositionerror . message返回人类可读的错误消息。</p></blockquote><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="4169" class="mj lc in mf b gy mk ml l mm mn">const error = (error) =&gt; {<br/>  current_location.textContent = `Couldn't access your location \n Reason: ${error.message}`;<br/>}</span></pre><h1 id="6058" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">决赛成绩</h1><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="bf6a" class="mj lc in mf b gy mk ml l mm mn">&lt;button onclick = "getLocation()"&gt;Get my current location&lt;/button&gt;<br/>&lt;div id = "location"&gt;&lt;/div&gt;</span><span id="8cb6" class="mj lc in mf b gy mo ml l mm mn">&lt;script&gt;</span><span id="4fdc" class="mj lc in mf b gy mo ml l mm mn">let current_location = document.getElementById("location");</span><span id="66dd" class="mj lc in mf b gy mo ml l mm mn">const success = (position) =&gt; {<br/>  const longitude = position.coords.longitude;<br/>  const latitude = position.coords.latitude;<br/>  <br/>  current_location.textContent = `Longitute = ${longitude} \n latitude = ${latitude}`;<br/>}</span><span id="99b3" class="mj lc in mf b gy mo ml l mm mn">const error = (error) =&gt; {<br/>  current_location.textContent = `Couldn't access your location \n Reason: ${PositionError.message}`;<br/>}</span><span id="c1d4" class="mj lc in mf b gy mo ml l mm mn">const getLocation = () =&gt; {<br/>  if(navigator.geolocation)<br/>    navigator.geolocation.getCurrentPosition(success,error);<br/>  else <br/>    current_location.textContent = `Your browser does not support this feature`;<br/>}</span><span id="68c8" class="mj lc in mf b gy mo ml l mm mn">&lt;/script&gt;</span></pre><p id="372a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你觉得我还有什么要补充的吗？欢迎评论或写回复！</p><p id="c33d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> <em class="kx">随时通过</em> </strong> <a class="ae ms" href="https://www.linkedin.com/in/hiba-abdel-karim/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="kx">在LinkedIn上关注我</em> </strong> </a> <strong class="jm io"> <em class="kx">了解我更多信息。</em> </strong></p><p id="287d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="kx">更多内容请看</em><a class="ae ms" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="kx">plain English . io</em></a></p></div></div>    
</body>
</html>